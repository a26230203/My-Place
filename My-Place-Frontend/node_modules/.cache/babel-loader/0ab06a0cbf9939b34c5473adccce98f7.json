{"ast":null,"code":"/**\n * Copyright (c) Tiny Technologies, Inc. All rights reserved.\n * Licensed under the LGPL or a commercial license.\n * For LGPL see License.txt in the project root for license information.\n * For commercial licenses see https://www.tiny.cloud/\n *\n * Version: 5.8.2 (2021-06-23)\n */\n(function () {\n  'use strict';\n\n  var global = tinymce.util.Tools.resolve('tinymce.PluginManager');\n\n  var typeOf = function (x) {\n    var t = typeof x;\n\n    if (x === null) {\n      return 'null';\n    } else if (t === 'object' && (Array.prototype.isPrototypeOf(x) || x.constructor && x.constructor.name === 'Array')) {\n      return 'array';\n    } else if (t === 'object' && (String.prototype.isPrototypeOf(x) || x.constructor && x.constructor.name === 'String')) {\n      return 'string';\n    } else {\n      return t;\n    }\n  };\n\n  var isType = function (type) {\n    return function (value) {\n      return typeOf(value) === type;\n    };\n  };\n\n  var isSimpleType = function (type) {\n    return function (value) {\n      return typeof value === type;\n    };\n  };\n\n  var isString = isType('string');\n  var isObject = isType('object');\n  var isArray = isType('array');\n  var isBoolean = isSimpleType('boolean');\n  var isFunction = isSimpleType('function');\n  var isNumber = isSimpleType('number');\n\n  var noop = function () {};\n\n  var constant = function (value) {\n    return function () {\n      return value;\n    };\n  };\n\n  var not = function (f) {\n    return function (t) {\n      return !f(t);\n    };\n  };\n\n  var never = constant(false);\n  var always = constant(true);\n\n  var none = function () {\n    return NONE;\n  };\n\n  var NONE = function () {\n    var eq = function (o) {\n      return o.isNone();\n    };\n\n    var call = function (thunk) {\n      return thunk();\n    };\n\n    var id = function (n) {\n      return n;\n    };\n\n    var me = {\n      fold: function (n, _s) {\n        return n();\n      },\n      is: never,\n      isSome: never,\n      isNone: always,\n      getOr: id,\n      getOrThunk: call,\n      getOrDie: function (msg) {\n        throw new Error(msg || 'error: getOrDie called on none.');\n      },\n      getOrNull: constant(null),\n      getOrUndefined: constant(undefined),\n      or: id,\n      orThunk: call,\n      map: none,\n      each: noop,\n      bind: none,\n      exists: never,\n      forall: always,\n      filter: none,\n      equals: eq,\n      equals_: eq,\n      toArray: function () {\n        return [];\n      },\n      toString: constant('none()')\n    };\n    return me;\n  }();\n\n  var some = function (a) {\n    var constant_a = constant(a);\n\n    var self = function () {\n      return me;\n    };\n\n    var bind = function (f) {\n      return f(a);\n    };\n\n    var me = {\n      fold: function (n, s) {\n        return s(a);\n      },\n      is: function (v) {\n        return a === v;\n      },\n      isSome: always,\n      isNone: never,\n      getOr: constant_a,\n      getOrThunk: constant_a,\n      getOrDie: constant_a,\n      getOrNull: constant_a,\n      getOrUndefined: constant_a,\n      or: self,\n      orThunk: self,\n      map: function (f) {\n        return some(f(a));\n      },\n      each: function (f) {\n        f(a);\n      },\n      bind: bind,\n      exists: bind,\n      forall: bind,\n      filter: function (f) {\n        return f(a) ? me : NONE;\n      },\n      toArray: function () {\n        return [a];\n      },\n      toString: function () {\n        return 'some(' + a + ')';\n      },\n      equals: function (o) {\n        return o.is(a);\n      },\n      equals_: function (o, elementEq) {\n        return o.fold(never, function (b) {\n          return elementEq(a, b);\n        });\n      }\n    };\n    return me;\n  };\n\n  var from = function (value) {\n    return value === null || value === undefined ? NONE : some(value);\n  };\n\n  var Optional = {\n    some: some,\n    none: none,\n    from: from\n  };\n  var nativeSlice = Array.prototype.slice;\n  var nativePush = Array.prototype.push;\n\n  var map = function (xs, f) {\n    var len = xs.length;\n    var r = new Array(len);\n\n    for (var i = 0; i < len; i++) {\n      var x = xs[i];\n      r[i] = f(x, i);\n    }\n\n    return r;\n  };\n\n  var each = function (xs, f) {\n    for (var i = 0, len = xs.length; i < len; i++) {\n      var x = xs[i];\n      f(x, i);\n    }\n  };\n\n  var filter = function (xs, pred) {\n    var r = [];\n\n    for (var i = 0, len = xs.length; i < len; i++) {\n      var x = xs[i];\n\n      if (pred(x, i)) {\n        r.push(x);\n      }\n    }\n\n    return r;\n  };\n\n  var groupBy = function (xs, f) {\n    if (xs.length === 0) {\n      return [];\n    } else {\n      var wasType = f(xs[0]);\n      var r = [];\n      var group = [];\n\n      for (var i = 0, len = xs.length; i < len; i++) {\n        var x = xs[i];\n        var type = f(x);\n\n        if (type !== wasType) {\n          r.push(group);\n          group = [];\n        }\n\n        wasType = type;\n        group.push(x);\n      }\n\n      if (group.length !== 0) {\n        r.push(group);\n      }\n\n      return r;\n    }\n  };\n\n  var foldl = function (xs, f, acc) {\n    each(xs, function (x) {\n      acc = f(acc, x);\n    });\n    return acc;\n  };\n\n  var findUntil = function (xs, pred, until) {\n    for (var i = 0, len = xs.length; i < len; i++) {\n      var x = xs[i];\n\n      if (pred(x, i)) {\n        return Optional.some(x);\n      } else if (until(x, i)) {\n        break;\n      }\n    }\n\n    return Optional.none();\n  };\n\n  var find = function (xs, pred) {\n    return findUntil(xs, pred, never);\n  };\n\n  var flatten = function (xs) {\n    var r = [];\n\n    for (var i = 0, len = xs.length; i < len; ++i) {\n      if (!isArray(xs[i])) {\n        throw new Error('Arr.flatten item ' + i + ' was not an array, input: ' + xs);\n      }\n\n      nativePush.apply(r, xs[i]);\n    }\n\n    return r;\n  };\n\n  var bind = function (xs, f) {\n    return flatten(map(xs, f));\n  };\n\n  var reverse = function (xs) {\n    var r = nativeSlice.call(xs, 0);\n    r.reverse();\n    return r;\n  };\n\n  var get = function (xs, i) {\n    return i >= 0 && i < xs.length ? Optional.some(xs[i]) : Optional.none();\n  };\n\n  var head = function (xs) {\n    return get(xs, 0);\n  };\n\n  var last = function (xs) {\n    return get(xs, xs.length - 1);\n  };\n\n  var __assign = function () {\n    __assign = Object.assign || function __assign(t) {\n      for (var s, i = 1, n = arguments.length; i < n; i++) {\n        s = arguments[i];\n\n        for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\n      }\n\n      return t;\n    };\n\n    return __assign.apply(this, arguments);\n  };\n\n  function __spreadArrays() {\n    for (var s = 0, i = 0, il = arguments.length; i < il; i++) s += arguments[i].length;\n\n    for (var r = Array(s), k = 0, i = 0; i < il; i++) for (var a = arguments[i], j = 0, jl = a.length; j < jl; j++, k++) r[k] = a[j];\n\n    return r;\n  }\n\n  var cached = function (f) {\n    var called = false;\n    var r;\n    return function () {\n      var args = [];\n\n      for (var _i = 0; _i < arguments.length; _i++) {\n        args[_i] = arguments[_i];\n      }\n\n      if (!called) {\n        called = true;\n        r = f.apply(null, args);\n      }\n\n      return r;\n    };\n  };\n\n  var DeviceType = function (os, browser, userAgent, mediaMatch) {\n    var isiPad = os.isiOS() && /ipad/i.test(userAgent) === true;\n    var isiPhone = os.isiOS() && !isiPad;\n    var isMobile = os.isiOS() || os.isAndroid();\n    var isTouch = isMobile || mediaMatch('(pointer:coarse)');\n    var isTablet = isiPad || !isiPhone && isMobile && mediaMatch('(min-device-width:768px)');\n    var isPhone = isiPhone || isMobile && !isTablet;\n    var iOSwebview = browser.isSafari() && os.isiOS() && /safari/i.test(userAgent) === false;\n    var isDesktop = !isPhone && !isTablet && !iOSwebview;\n    return {\n      isiPad: constant(isiPad),\n      isiPhone: constant(isiPhone),\n      isTablet: constant(isTablet),\n      isPhone: constant(isPhone),\n      isTouch: constant(isTouch),\n      isAndroid: os.isAndroid,\n      isiOS: os.isiOS,\n      isWebView: constant(iOSwebview),\n      isDesktop: constant(isDesktop)\n    };\n  };\n\n  var firstMatch = function (regexes, s) {\n    for (var i = 0; i < regexes.length; i++) {\n      var x = regexes[i];\n\n      if (x.test(s)) {\n        return x;\n      }\n    }\n\n    return undefined;\n  };\n\n  var find$1 = function (regexes, agent) {\n    var r = firstMatch(regexes, agent);\n\n    if (!r) {\n      return {\n        major: 0,\n        minor: 0\n      };\n    }\n\n    var group = function (i) {\n      return Number(agent.replace(r, '$' + i));\n    };\n\n    return nu(group(1), group(2));\n  };\n\n  var detect = function (versionRegexes, agent) {\n    var cleanedAgent = String(agent).toLowerCase();\n\n    if (versionRegexes.length === 0) {\n      return unknown();\n    }\n\n    return find$1(versionRegexes, cleanedAgent);\n  };\n\n  var unknown = function () {\n    return nu(0, 0);\n  };\n\n  var nu = function (major, minor) {\n    return {\n      major: major,\n      minor: minor\n    };\n  };\n\n  var Version = {\n    nu: nu,\n    detect: detect,\n    unknown: unknown\n  };\n\n  var detect$1 = function (candidates, userAgent) {\n    var agent = String(userAgent).toLowerCase();\n    return find(candidates, function (candidate) {\n      return candidate.search(agent);\n    });\n  };\n\n  var detectBrowser = function (browsers, userAgent) {\n    return detect$1(browsers, userAgent).map(function (browser) {\n      var version = Version.detect(browser.versionRegexes, userAgent);\n      return {\n        current: browser.name,\n        version: version\n      };\n    });\n  };\n\n  var detectOs = function (oses, userAgent) {\n    return detect$1(oses, userAgent).map(function (os) {\n      var version = Version.detect(os.versionRegexes, userAgent);\n      return {\n        current: os.name,\n        version: version\n      };\n    });\n  };\n\n  var UaString = {\n    detectBrowser: detectBrowser,\n    detectOs: detectOs\n  };\n\n  var contains = function (str, substr) {\n    return str.indexOf(substr) !== -1;\n  };\n\n  var blank = function (r) {\n    return function (s) {\n      return s.replace(r, '');\n    };\n  };\n\n  var trim = blank(/^\\s+|\\s+$/g);\n\n  var isNotEmpty = function (s) {\n    return s.length > 0;\n  };\n\n  var isEmpty = function (s) {\n    return !isNotEmpty(s);\n  };\n\n  var normalVersionRegex = /.*?version\\/\\ ?([0-9]+)\\.([0-9]+).*/;\n\n  var checkContains = function (target) {\n    return function (uastring) {\n      return contains(uastring, target);\n    };\n  };\n\n  var browsers = [{\n    name: 'Edge',\n    versionRegexes: [/.*?edge\\/ ?([0-9]+)\\.([0-9]+)$/],\n    search: function (uastring) {\n      return contains(uastring, 'edge/') && contains(uastring, 'chrome') && contains(uastring, 'safari') && contains(uastring, 'applewebkit');\n    }\n  }, {\n    name: 'Chrome',\n    versionRegexes: [/.*?chrome\\/([0-9]+)\\.([0-9]+).*/, normalVersionRegex],\n    search: function (uastring) {\n      return contains(uastring, 'chrome') && !contains(uastring, 'chromeframe');\n    }\n  }, {\n    name: 'IE',\n    versionRegexes: [/.*?msie\\ ?([0-9]+)\\.([0-9]+).*/, /.*?rv:([0-9]+)\\.([0-9]+).*/],\n    search: function (uastring) {\n      return contains(uastring, 'msie') || contains(uastring, 'trident');\n    }\n  }, {\n    name: 'Opera',\n    versionRegexes: [normalVersionRegex, /.*?opera\\/([0-9]+)\\.([0-9]+).*/],\n    search: checkContains('opera')\n  }, {\n    name: 'Firefox',\n    versionRegexes: [/.*?firefox\\/\\ ?([0-9]+)\\.([0-9]+).*/],\n    search: checkContains('firefox')\n  }, {\n    name: 'Safari',\n    versionRegexes: [normalVersionRegex, /.*?cpu os ([0-9]+)_([0-9]+).*/],\n    search: function (uastring) {\n      return (contains(uastring, 'safari') || contains(uastring, 'mobile/')) && contains(uastring, 'applewebkit');\n    }\n  }];\n  var oses = [{\n    name: 'Windows',\n    search: checkContains('win'),\n    versionRegexes: [/.*?windows\\ nt\\ ?([0-9]+)\\.([0-9]+).*/]\n  }, {\n    name: 'iOS',\n    search: function (uastring) {\n      return contains(uastring, 'iphone') || contains(uastring, 'ipad');\n    },\n    versionRegexes: [/.*?version\\/\\ ?([0-9]+)\\.([0-9]+).*/, /.*cpu os ([0-9]+)_([0-9]+).*/, /.*cpu iphone os ([0-9]+)_([0-9]+).*/]\n  }, {\n    name: 'Android',\n    search: checkContains('android'),\n    versionRegexes: [/.*?android\\ ?([0-9]+)\\.([0-9]+).*/]\n  }, {\n    name: 'OSX',\n    search: checkContains('mac os x'),\n    versionRegexes: [/.*?mac\\ os\\ x\\ ?([0-9]+)_([0-9]+).*/]\n  }, {\n    name: 'Linux',\n    search: checkContains('linux'),\n    versionRegexes: []\n  }, {\n    name: 'Solaris',\n    search: checkContains('sunos'),\n    versionRegexes: []\n  }, {\n    name: 'FreeBSD',\n    search: checkContains('freebsd'),\n    versionRegexes: []\n  }, {\n    name: 'ChromeOS',\n    search: checkContains('cros'),\n    versionRegexes: [/.*?chrome\\/([0-9]+)\\.([0-9]+).*/]\n  }];\n  var PlatformInfo = {\n    browsers: constant(browsers),\n    oses: constant(oses)\n  };\n  var edge = 'Edge';\n  var chrome = 'Chrome';\n  var ie = 'IE';\n  var opera = 'Opera';\n  var firefox = 'Firefox';\n  var safari = 'Safari';\n\n  var unknown$1 = function () {\n    return nu$1({\n      current: undefined,\n      version: Version.unknown()\n    });\n  };\n\n  var nu$1 = function (info) {\n    var current = info.current;\n    var version = info.version;\n\n    var isBrowser = function (name) {\n      return function () {\n        return current === name;\n      };\n    };\n\n    return {\n      current: current,\n      version: version,\n      isEdge: isBrowser(edge),\n      isChrome: isBrowser(chrome),\n      isIE: isBrowser(ie),\n      isOpera: isBrowser(opera),\n      isFirefox: isBrowser(firefox),\n      isSafari: isBrowser(safari)\n    };\n  };\n\n  var Browser = {\n    unknown: unknown$1,\n    nu: nu$1,\n    edge: constant(edge),\n    chrome: constant(chrome),\n    ie: constant(ie),\n    opera: constant(opera),\n    firefox: constant(firefox),\n    safari: constant(safari)\n  };\n  var windows = 'Windows';\n  var ios = 'iOS';\n  var android = 'Android';\n  var linux = 'Linux';\n  var osx = 'OSX';\n  var solaris = 'Solaris';\n  var freebsd = 'FreeBSD';\n  var chromeos = 'ChromeOS';\n\n  var unknown$2 = function () {\n    return nu$2({\n      current: undefined,\n      version: Version.unknown()\n    });\n  };\n\n  var nu$2 = function (info) {\n    var current = info.current;\n    var version = info.version;\n\n    var isOS = function (name) {\n      return function () {\n        return current === name;\n      };\n    };\n\n    return {\n      current: current,\n      version: version,\n      isWindows: isOS(windows),\n      isiOS: isOS(ios),\n      isAndroid: isOS(android),\n      isOSX: isOS(osx),\n      isLinux: isOS(linux),\n      isSolaris: isOS(solaris),\n      isFreeBSD: isOS(freebsd),\n      isChromeOS: isOS(chromeos)\n    };\n  };\n\n  var OperatingSystem = {\n    unknown: unknown$2,\n    nu: nu$2,\n    windows: constant(windows),\n    ios: constant(ios),\n    android: constant(android),\n    linux: constant(linux),\n    osx: constant(osx),\n    solaris: constant(solaris),\n    freebsd: constant(freebsd),\n    chromeos: constant(chromeos)\n  };\n\n  var detect$2 = function (userAgent, mediaMatch) {\n    var browsers = PlatformInfo.browsers();\n    var oses = PlatformInfo.oses();\n    var browser = UaString.detectBrowser(browsers, userAgent).fold(Browser.unknown, Browser.nu);\n    var os = UaString.detectOs(oses, userAgent).fold(OperatingSystem.unknown, OperatingSystem.nu);\n    var deviceType = DeviceType(os, browser, userAgent, mediaMatch);\n    return {\n      browser: browser,\n      os: os,\n      deviceType: deviceType\n    };\n  };\n\n  var PlatformDetection = {\n    detect: detect$2\n  };\n\n  var mediaMatch = function (query) {\n    return window.matchMedia(query).matches;\n  };\n\n  var platform = cached(function () {\n    return PlatformDetection.detect(navigator.userAgent, mediaMatch);\n  });\n\n  var detect$3 = function () {\n    return platform();\n  };\n\n  var compareDocumentPosition = function (a, b, match) {\n    return (a.compareDocumentPosition(b) & match) !== 0;\n  };\n\n  var documentPositionContainedBy = function (a, b) {\n    return compareDocumentPosition(a, b, Node.DOCUMENT_POSITION_CONTAINED_BY);\n  };\n\n  var ELEMENT = 1;\n\n  var fromHtml = function (html, scope) {\n    var doc = scope || document;\n    var div = doc.createElement('div');\n    div.innerHTML = html;\n\n    if (!div.hasChildNodes() || div.childNodes.length > 1) {\n      console.error('HTML does not have a single root node', html);\n      throw new Error('HTML must have a single root node');\n    }\n\n    return fromDom(div.childNodes[0]);\n  };\n\n  var fromTag = function (tag, scope) {\n    var doc = scope || document;\n    var node = doc.createElement(tag);\n    return fromDom(node);\n  };\n\n  var fromText = function (text, scope) {\n    var doc = scope || document;\n    var node = doc.createTextNode(text);\n    return fromDom(node);\n  };\n\n  var fromDom = function (node) {\n    if (node === null || node === undefined) {\n      throw new Error('Node cannot be null or undefined');\n    }\n\n    return {\n      dom: node\n    };\n  };\n\n  var fromPoint = function (docElm, x, y) {\n    return Optional.from(docElm.dom.elementFromPoint(x, y)).map(fromDom);\n  };\n\n  var SugarElement = {\n    fromHtml: fromHtml,\n    fromTag: fromTag,\n    fromText: fromText,\n    fromDom: fromDom,\n    fromPoint: fromPoint\n  };\n\n  var is = function (element, selector) {\n    var dom = element.dom;\n\n    if (dom.nodeType !== ELEMENT) {\n      return false;\n    } else {\n      var elem = dom;\n\n      if (elem.matches !== undefined) {\n        return elem.matches(selector);\n      } else if (elem.msMatchesSelector !== undefined) {\n        return elem.msMatchesSelector(selector);\n      } else if (elem.webkitMatchesSelector !== undefined) {\n        return elem.webkitMatchesSelector(selector);\n      } else if (elem.mozMatchesSelector !== undefined) {\n        return elem.mozMatchesSelector(selector);\n      } else {\n        throw new Error('Browser lacks native selectors');\n      }\n    }\n  };\n\n  var eq = function (e1, e2) {\n    return e1.dom === e2.dom;\n  };\n\n  var regularContains = function (e1, e2) {\n    var d1 = e1.dom;\n    var d2 = e2.dom;\n    return d1 === d2 ? false : d1.contains(d2);\n  };\n\n  var ieContains = function (e1, e2) {\n    return documentPositionContainedBy(e1.dom, e2.dom);\n  };\n\n  var contains$1 = function (e1, e2) {\n    return detect$3().browser.isIE() ? ieContains(e1, e2) : regularContains(e1, e2);\n  };\n\n  var is$1 = is;\n  var global$1 = tinymce.util.Tools.resolve('tinymce.dom.RangeUtils');\n  var global$2 = tinymce.util.Tools.resolve('tinymce.dom.TreeWalker');\n  var global$3 = tinymce.util.Tools.resolve('tinymce.util.VK');\n  var keys = Object.keys;\n\n  var each$1 = function (obj, f) {\n    var props = keys(obj);\n\n    for (var k = 0, len = props.length; k < len; k++) {\n      var i = props[k];\n      var x = obj[i];\n      f(x, i);\n    }\n  };\n\n  var objAcc = function (r) {\n    return function (x, i) {\n      r[i] = x;\n    };\n  };\n\n  var internalFilter = function (obj, pred, onTrue, onFalse) {\n    var r = {};\n    each$1(obj, function (x, i) {\n      (pred(x, i) ? onTrue : onFalse)(x, i);\n    });\n    return r;\n  };\n\n  var filter$1 = function (obj, pred) {\n    var t = {};\n    internalFilter(obj, pred, objAcc(t), noop);\n    return t;\n  };\n\n  var Global = typeof window !== 'undefined' ? window : Function('return this;')();\n\n  var name = function (element) {\n    var r = element.dom.nodeName;\n    return r.toLowerCase();\n  };\n\n  var type = function (element) {\n    return element.dom.nodeType;\n  };\n\n  var isType$1 = function (t) {\n    return function (element) {\n      return type(element) === t;\n    };\n  };\n\n  var isElement = isType$1(ELEMENT);\n\n  var rawSet = function (dom, key, value) {\n    if (isString(value) || isBoolean(value) || isNumber(value)) {\n      dom.setAttribute(key, value + '');\n    } else {\n      console.error('Invalid call to Attribute.set. Key ', key, ':: Value ', value, ':: Element ', dom);\n      throw new Error('Attribute value was not simple');\n    }\n  };\n\n  var setAll = function (element, attrs) {\n    var dom = element.dom;\n    each$1(attrs, function (v, k) {\n      rawSet(dom, k, v);\n    });\n  };\n\n  var clone = function (element) {\n    return foldl(element.dom.attributes, function (acc, attr) {\n      acc[attr.name] = attr.value;\n      return acc;\n    }, {});\n  };\n\n  var parent = function (element) {\n    return Optional.from(element.dom.parentNode).map(SugarElement.fromDom);\n  };\n\n  var children = function (element) {\n    return map(element.dom.childNodes, SugarElement.fromDom);\n  };\n\n  var child = function (element, index) {\n    var cs = element.dom.childNodes;\n    return Optional.from(cs[index]).map(SugarElement.fromDom);\n  };\n\n  var firstChild = function (element) {\n    return child(element, 0);\n  };\n\n  var lastChild = function (element) {\n    return child(element, element.dom.childNodes.length - 1);\n  };\n\n  var before = function (marker, element) {\n    var parent$1 = parent(marker);\n    parent$1.each(function (v) {\n      v.dom.insertBefore(element.dom, marker.dom);\n    });\n  };\n\n  var append = function (parent, element) {\n    parent.dom.appendChild(element.dom);\n  };\n\n  var before$1 = function (marker, elements) {\n    each(elements, function (x) {\n      before(marker, x);\n    });\n  };\n\n  var append$1 = function (parent, elements) {\n    each(elements, function (x) {\n      append(parent, x);\n    });\n  };\n\n  var remove = function (element) {\n    var dom = element.dom;\n\n    if (dom.parentNode !== null) {\n      dom.parentNode.removeChild(dom);\n    }\n  };\n\n  var clone$1 = function (original, isDeep) {\n    return SugarElement.fromDom(original.dom.cloneNode(isDeep));\n  };\n\n  var deep = function (original) {\n    return clone$1(original, true);\n  };\n\n  var shallowAs = function (original, tag) {\n    var nu = SugarElement.fromTag(tag);\n    var attributes = clone(original);\n    setAll(nu, attributes);\n    return nu;\n  };\n\n  var mutate = function (original, tag) {\n    var nu = shallowAs(original, tag);\n    before(original, nu);\n    var children$1 = children(original);\n    append$1(nu, children$1);\n    remove(original);\n    return nu;\n  };\n\n  var global$4 = tinymce.util.Tools.resolve('tinymce.dom.DOMUtils');\n  var global$5 = tinymce.util.Tools.resolve('tinymce.util.Tools');\n\n  var matchNodeName = function (name) {\n    return function (node) {\n      return node && node.nodeName.toLowerCase() === name;\n    };\n  };\n\n  var matchNodeNames = function (regex) {\n    return function (node) {\n      return node && regex.test(node.nodeName);\n    };\n  };\n\n  var isTextNode = function (node) {\n    return node && node.nodeType === 3;\n  };\n\n  var isListNode = matchNodeNames(/^(OL|UL|DL)$/);\n  var isOlUlNode = matchNodeNames(/^(OL|UL)$/);\n  var isOlNode = matchNodeName('ol');\n  var isListItemNode = matchNodeNames(/^(LI|DT|DD)$/);\n  var isDlItemNode = matchNodeNames(/^(DT|DD)$/);\n  var isTableCellNode = matchNodeNames(/^(TH|TD)$/);\n  var isBr = matchNodeName('br');\n\n  var isFirstChild = function (node) {\n    return node.parentNode.firstChild === node;\n  };\n\n  var isTextBlock = function (editor, node) {\n    return node && !!editor.schema.getTextBlockElements()[node.nodeName];\n  };\n\n  var isBlock = function (node, blockElements) {\n    return node && node.nodeName in blockElements;\n  };\n\n  var isBogusBr = function (dom, node) {\n    if (!isBr(node)) {\n      return false;\n    }\n\n    return dom.isBlock(node.nextSibling) && !isBr(node.previousSibling);\n  };\n\n  var isEmpty$1 = function (dom, elm, keepBookmarks) {\n    var empty = dom.isEmpty(elm);\n\n    if (keepBookmarks && dom.select('span[data-mce-type=bookmark]', elm).length > 0) {\n      return false;\n    }\n\n    return empty;\n  };\n\n  var isChildOfBody = function (dom, elm) {\n    return dom.isChildOf(elm, dom.getRoot());\n  };\n\n  var shouldIndentOnTab = function (editor) {\n    return editor.getParam('lists_indent_on_tab', true);\n  };\n\n  var getForcedRootBlock = function (editor) {\n    var block = editor.getParam('forced_root_block', 'p');\n\n    if (block === false) {\n      return '';\n    } else if (block === true) {\n      return 'p';\n    } else {\n      return block;\n    }\n  };\n\n  var getForcedRootBlockAttrs = function (editor) {\n    return editor.getParam('forced_root_block_attrs', {});\n  };\n\n  var createTextBlock = function (editor, contentNode) {\n    var dom = editor.dom;\n    var blockElements = editor.schema.getBlockElements();\n    var fragment = dom.createFragment();\n    var blockName = getForcedRootBlock(editor);\n    var node, textBlock, hasContentNode;\n\n    if (blockName) {\n      textBlock = dom.create(blockName);\n\n      if (textBlock.tagName === blockName.toUpperCase()) {\n        dom.setAttribs(textBlock, getForcedRootBlockAttrs(editor));\n      }\n\n      if (!isBlock(contentNode.firstChild, blockElements)) {\n        fragment.appendChild(textBlock);\n      }\n    }\n\n    if (contentNode) {\n      while (node = contentNode.firstChild) {\n        var nodeName = node.nodeName;\n\n        if (!hasContentNode && (nodeName !== 'SPAN' || node.getAttribute('data-mce-type') !== 'bookmark')) {\n          hasContentNode = true;\n        }\n\n        if (isBlock(node, blockElements)) {\n          fragment.appendChild(node);\n          textBlock = null;\n        } else {\n          if (blockName) {\n            if (!textBlock) {\n              textBlock = dom.create(blockName);\n              fragment.appendChild(textBlock);\n            }\n\n            textBlock.appendChild(node);\n          } else {\n            fragment.appendChild(node);\n          }\n        }\n      }\n    }\n\n    if (!blockName) {\n      fragment.appendChild(dom.create('br'));\n    } else {\n      if (!hasContentNode) {\n        textBlock.appendChild(dom.create('br', {\n          'data-mce-bogus': '1'\n        }));\n      }\n    }\n\n    return fragment;\n  };\n\n  var DOM = global$4.DOM;\n\n  var splitList = function (editor, ul, li) {\n    var removeAndKeepBookmarks = function (targetNode) {\n      global$5.each(bookmarks, function (node) {\n        targetNode.parentNode.insertBefore(node, li.parentNode);\n      });\n      DOM.remove(targetNode);\n    };\n\n    var bookmarks = DOM.select('span[data-mce-type=\"bookmark\"]', ul);\n    var newBlock = createTextBlock(editor, li);\n    var tmpRng = DOM.createRng();\n    tmpRng.setStartAfter(li);\n    tmpRng.setEndAfter(ul);\n    var fragment = tmpRng.extractContents();\n\n    for (var node = fragment.firstChild; node; node = node.firstChild) {\n      if (node.nodeName === 'LI' && editor.dom.isEmpty(node)) {\n        DOM.remove(node);\n        break;\n      }\n    }\n\n    if (!editor.dom.isEmpty(fragment)) {\n      DOM.insertAfter(fragment, ul);\n    }\n\n    DOM.insertAfter(newBlock, ul);\n\n    if (isEmpty$1(editor.dom, li.parentNode)) {\n      removeAndKeepBookmarks(li.parentNode);\n    }\n\n    DOM.remove(li);\n\n    if (isEmpty$1(editor.dom, ul)) {\n      DOM.remove(ul);\n    }\n  };\n\n  var outdentDlItem = function (editor, item) {\n    if (is$1(item, 'dd')) {\n      mutate(item, 'dt');\n    } else if (is$1(item, 'dt')) {\n      parent(item).each(function (dl) {\n        return splitList(editor, dl.dom, item.dom);\n      });\n    }\n  };\n\n  var indentDlItem = function (item) {\n    if (is$1(item, 'dt')) {\n      mutate(item, 'dd');\n    }\n  };\n\n  var dlIndentation = function (editor, indentation, dlItems) {\n    if (indentation === 'Indent') {\n      each(dlItems, indentDlItem);\n    } else {\n      each(dlItems, function (item) {\n        return outdentDlItem(editor, item);\n      });\n    }\n  };\n\n  var getNormalizedPoint = function (container, offset) {\n    if (isTextNode(container)) {\n      return {\n        container: container,\n        offset: offset\n      };\n    }\n\n    var node = global$1.getNode(container, offset);\n\n    if (isTextNode(node)) {\n      return {\n        container: node,\n        offset: offset >= container.childNodes.length ? node.data.length : 0\n      };\n    } else if (node.previousSibling && isTextNode(node.previousSibling)) {\n      return {\n        container: node.previousSibling,\n        offset: node.previousSibling.data.length\n      };\n    } else if (node.nextSibling && isTextNode(node.nextSibling)) {\n      return {\n        container: node.nextSibling,\n        offset: 0\n      };\n    }\n\n    return {\n      container: container,\n      offset: offset\n    };\n  };\n\n  var normalizeRange = function (rng) {\n    var outRng = rng.cloneRange();\n    var rangeStart = getNormalizedPoint(rng.startContainer, rng.startOffset);\n    outRng.setStart(rangeStart.container, rangeStart.offset);\n    var rangeEnd = getNormalizedPoint(rng.endContainer, rng.endOffset);\n    outRng.setEnd(rangeEnd.container, rangeEnd.offset);\n    return outRng;\n  };\n\n  var global$6 = tinymce.util.Tools.resolve('tinymce.dom.DomQuery');\n\n  var getParentList = function (editor, node) {\n    var selectionStart = node || editor.selection.getStart(true);\n    return editor.dom.getParent(selectionStart, 'OL,UL,DL', getClosestListRootElm(editor, selectionStart));\n  };\n\n  var isParentListSelected = function (parentList, selectedBlocks) {\n    return parentList && selectedBlocks.length === 1 && selectedBlocks[0] === parentList;\n  };\n\n  var findSubLists = function (parentList) {\n    return global$5.grep(parentList.querySelectorAll('ol,ul,dl'), function (elm) {\n      return isListNode(elm);\n    });\n  };\n\n  var getSelectedSubLists = function (editor) {\n    var parentList = getParentList(editor);\n    var selectedBlocks = editor.selection.getSelectedBlocks();\n\n    if (isParentListSelected(parentList, selectedBlocks)) {\n      return findSubLists(parentList);\n    } else {\n      return global$5.grep(selectedBlocks, function (elm) {\n        return isListNode(elm) && parentList !== elm;\n      });\n    }\n  };\n\n  var findParentListItemsNodes = function (editor, elms) {\n    var listItemsElms = global$5.map(elms, function (elm) {\n      var parentLi = editor.dom.getParent(elm, 'li,dd,dt', getClosestListRootElm(editor, elm));\n      return parentLi ? parentLi : elm;\n    });\n    return global$6.unique(listItemsElms);\n  };\n\n  var getSelectedListItems = function (editor) {\n    var selectedBlocks = editor.selection.getSelectedBlocks();\n    return global$5.grep(findParentListItemsNodes(editor, selectedBlocks), function (block) {\n      return isListItemNode(block);\n    });\n  };\n\n  var getSelectedDlItems = function (editor) {\n    return filter(getSelectedListItems(editor), isDlItemNode);\n  };\n\n  var getClosestListRootElm = function (editor, elm) {\n    var parentTableCell = editor.dom.getParents(elm, 'TD,TH');\n    var root = parentTableCell.length > 0 ? parentTableCell[0] : editor.getBody();\n    return root;\n  };\n\n  var findLastParentListNode = function (editor, elm) {\n    var parentLists = editor.dom.getParents(elm, 'ol,ul', getClosestListRootElm(editor, elm));\n    return last(parentLists);\n  };\n\n  var getSelectedLists = function (editor) {\n    var firstList = findLastParentListNode(editor, editor.selection.getStart());\n    var subsequentLists = filter(editor.selection.getSelectedBlocks(), isOlUlNode);\n    return firstList.toArray().concat(subsequentLists);\n  };\n\n  var getSelectedListRoots = function (editor) {\n    var selectedLists = getSelectedLists(editor);\n    return getUniqueListRoots(editor, selectedLists);\n  };\n\n  var getUniqueListRoots = function (editor, lists) {\n    var listRoots = map(lists, function (list) {\n      return findLastParentListNode(editor, list).getOr(list);\n    });\n    return global$6.unique(listRoots);\n  };\n\n  var lift2 = function (oa, ob, f) {\n    return oa.isSome() && ob.isSome() ? Optional.some(f(oa.getOrDie(), ob.getOrDie())) : Optional.none();\n  };\n\n  var fromElements = function (elements, scope) {\n    var doc = scope || document;\n    var fragment = doc.createDocumentFragment();\n    each(elements, function (element) {\n      fragment.appendChild(element.dom);\n    });\n    return SugarElement.fromDom(fragment);\n  };\n\n  var fireListEvent = function (editor, action, element) {\n    return editor.fire('ListMutation', {\n      action: action,\n      element: element\n    });\n  };\n\n  var isSupported = function (dom) {\n    return dom.style !== undefined && isFunction(dom.style.getPropertyValue);\n  };\n\n  var internalSet = function (dom, property, value) {\n    if (!isString(value)) {\n      console.error('Invalid call to CSS.set. Property ', property, ':: Value ', value, ':: Element ', dom);\n      throw new Error('CSS value must be a string: ' + value);\n    }\n\n    if (isSupported(dom)) {\n      dom.style.setProperty(property, value);\n    }\n  };\n\n  var set = function (element, property, value) {\n    var dom = element.dom;\n    internalSet(dom, property, value);\n  };\n\n  var joinSegment = function (parent, child) {\n    append(parent.item, child.list);\n  };\n\n  var joinSegments = function (segments) {\n    for (var i = 1; i < segments.length; i++) {\n      joinSegment(segments[i - 1], segments[i]);\n    }\n  };\n\n  var appendSegments = function (head$1, tail) {\n    lift2(last(head$1), head(tail), joinSegment);\n  };\n\n  var createSegment = function (scope, listType) {\n    var segment = {\n      list: SugarElement.fromTag(listType, scope),\n      item: SugarElement.fromTag('li', scope)\n    };\n    append(segment.list, segment.item);\n    return segment;\n  };\n\n  var createSegments = function (scope, entry, size) {\n    var segments = [];\n\n    for (var i = 0; i < size; i++) {\n      segments.push(createSegment(scope, entry.listType));\n    }\n\n    return segments;\n  };\n\n  var populateSegments = function (segments, entry) {\n    for (var i = 0; i < segments.length - 1; i++) {\n      set(segments[i].item, 'list-style-type', 'none');\n    }\n\n    last(segments).each(function (segment) {\n      setAll(segment.list, entry.listAttributes);\n      setAll(segment.item, entry.itemAttributes);\n      append$1(segment.item, entry.content);\n    });\n  };\n\n  var normalizeSegment = function (segment, entry) {\n    if (name(segment.list) !== entry.listType) {\n      segment.list = mutate(segment.list, entry.listType);\n    }\n\n    setAll(segment.list, entry.listAttributes);\n  };\n\n  var createItem = function (scope, attr, content) {\n    var item = SugarElement.fromTag('li', scope);\n    setAll(item, attr);\n    append$1(item, content);\n    return item;\n  };\n\n  var appendItem = function (segment, item) {\n    append(segment.list, item);\n    segment.item = item;\n  };\n\n  var writeShallow = function (scope, cast, entry) {\n    var newCast = cast.slice(0, entry.depth);\n    last(newCast).each(function (segment) {\n      var item = createItem(scope, entry.itemAttributes, entry.content);\n      appendItem(segment, item);\n      normalizeSegment(segment, entry);\n    });\n    return newCast;\n  };\n\n  var writeDeep = function (scope, cast, entry) {\n    var segments = createSegments(scope, entry, entry.depth - cast.length);\n    joinSegments(segments);\n    populateSegments(segments, entry);\n    appendSegments(cast, segments);\n    return cast.concat(segments);\n  };\n\n  var composeList = function (scope, entries) {\n    var cast = foldl(entries, function (cast, entry) {\n      return entry.depth > cast.length ? writeDeep(scope, cast, entry) : writeShallow(scope, cast, entry);\n    }, []);\n    return head(cast).map(function (segment) {\n      return segment.list;\n    });\n  };\n\n  var isList = function (el) {\n    return is$1(el, 'OL,UL');\n  };\n\n  var hasFirstChildList = function (el) {\n    return firstChild(el).map(isList).getOr(false);\n  };\n\n  var hasLastChildList = function (el) {\n    return lastChild(el).map(isList).getOr(false);\n  };\n\n  var isIndented = function (entry) {\n    return entry.depth > 0;\n  };\n\n  var isSelected = function (entry) {\n    return entry.isSelected;\n  };\n\n  var cloneItemContent = function (li) {\n    var children$1 = children(li);\n    var content = hasLastChildList(li) ? children$1.slice(0, -1) : children$1;\n    return map(content, deep);\n  };\n\n  var createEntry = function (li, depth, isSelected) {\n    return parent(li).filter(isElement).map(function (list) {\n      return {\n        depth: depth,\n        dirty: false,\n        isSelected: isSelected,\n        content: cloneItemContent(li),\n        itemAttributes: clone(li),\n        listAttributes: clone(list),\n        listType: name(list)\n      };\n    });\n  };\n\n  var indentEntry = function (indentation, entry) {\n    switch (indentation) {\n      case 'Indent':\n        entry.depth++;\n        break;\n\n      case 'Outdent':\n        entry.depth--;\n        break;\n\n      case 'Flatten':\n        entry.depth = 0;\n    }\n\n    entry.dirty = true;\n  };\n\n  var cloneListProperties = function (target, source) {\n    target.listType = source.listType;\n    target.listAttributes = __assign({}, source.listAttributes);\n  };\n\n  var cleanListProperties = function (entry) {\n    entry.listAttributes = filter$1(entry.listAttributes, function (_value, key) {\n      return key !== 'start';\n    });\n  };\n\n  var closestSiblingEntry = function (entries, start) {\n    var depth = entries[start].depth;\n\n    var matches = function (entry) {\n      return entry.depth === depth && !entry.dirty;\n    };\n\n    var until = function (entry) {\n      return entry.depth < depth;\n    };\n\n    return findUntil(reverse(entries.slice(0, start)), matches, until).orThunk(function () {\n      return findUntil(entries.slice(start + 1), matches, until);\n    });\n  };\n\n  var normalizeEntries = function (entries) {\n    each(entries, function (entry, i) {\n      closestSiblingEntry(entries, i).fold(function () {\n        if (entry.dirty) {\n          cleanListProperties(entry);\n        }\n      }, function (matchingEntry) {\n        return cloneListProperties(entry, matchingEntry);\n      });\n    });\n    return entries;\n  };\n\n  var Cell = function (initial) {\n    var value = initial;\n\n    var get = function () {\n      return value;\n    };\n\n    var set = function (v) {\n      value = v;\n    };\n\n    return {\n      get: get,\n      set: set\n    };\n  };\n\n  var parseItem = function (depth, itemSelection, selectionState, item) {\n    return firstChild(item).filter(isList).fold(function () {\n      itemSelection.each(function (selection) {\n        if (eq(selection.start, item)) {\n          selectionState.set(true);\n        }\n      });\n      var currentItemEntry = createEntry(item, depth, selectionState.get());\n      itemSelection.each(function (selection) {\n        if (eq(selection.end, item)) {\n          selectionState.set(false);\n        }\n      });\n      var childListEntries = lastChild(item).filter(isList).map(function (list) {\n        return parseList(depth, itemSelection, selectionState, list);\n      }).getOr([]);\n      return currentItemEntry.toArray().concat(childListEntries);\n    }, function (list) {\n      return parseList(depth, itemSelection, selectionState, list);\n    });\n  };\n\n  var parseList = function (depth, itemSelection, selectionState, list) {\n    return bind(children(list), function (element) {\n      var parser = isList(element) ? parseList : parseItem;\n      var newDepth = depth + 1;\n      return parser(newDepth, itemSelection, selectionState, element);\n    });\n  };\n\n  var parseLists = function (lists, itemSelection) {\n    var selectionState = Cell(false);\n    var initialDepth = 0;\n    return map(lists, function (list) {\n      return {\n        sourceList: list,\n        entries: parseList(initialDepth, itemSelection, selectionState, list)\n      };\n    });\n  };\n\n  var outdentedComposer = function (editor, entries) {\n    var normalizedEntries = normalizeEntries(entries);\n    return map(normalizedEntries, function (entry) {\n      var content = fromElements(entry.content);\n      return SugarElement.fromDom(createTextBlock(editor, content.dom));\n    });\n  };\n\n  var indentedComposer = function (editor, entries) {\n    var normalizedEntries = normalizeEntries(entries);\n    return composeList(editor.contentDocument, normalizedEntries).toArray();\n  };\n\n  var composeEntries = function (editor, entries) {\n    return bind(groupBy(entries, isIndented), function (entries) {\n      var groupIsIndented = head(entries).map(isIndented).getOr(false);\n      return groupIsIndented ? indentedComposer(editor, entries) : outdentedComposer(editor, entries);\n    });\n  };\n\n  var indentSelectedEntries = function (entries, indentation) {\n    each(filter(entries, isSelected), function (entry) {\n      return indentEntry(indentation, entry);\n    });\n  };\n\n  var getItemSelection = function (editor) {\n    var selectedListItems = map(getSelectedListItems(editor), SugarElement.fromDom);\n    return lift2(find(selectedListItems, not(hasFirstChildList)), find(reverse(selectedListItems), not(hasFirstChildList)), function (start, end) {\n      return {\n        start: start,\n        end: end\n      };\n    });\n  };\n\n  var listIndentation = function (editor, lists, indentation) {\n    var entrySets = parseLists(lists, getItemSelection(editor));\n    each(entrySets, function (entrySet) {\n      indentSelectedEntries(entrySet.entries, indentation);\n      var composedLists = composeEntries(editor, entrySet.entries);\n      each(composedLists, function (composedList) {\n        fireListEvent(editor, indentation === 'Indent' ? 'IndentList' : 'OutdentList', composedList.dom);\n      });\n      before$1(entrySet.sourceList, composedLists);\n      remove(entrySet.sourceList);\n    });\n  };\n\n  var selectionIndentation = function (editor, indentation) {\n    var lists = map(getSelectedListRoots(editor), SugarElement.fromDom);\n    var dlItems = map(getSelectedDlItems(editor), SugarElement.fromDom);\n    var isHandled = false;\n\n    if (lists.length || dlItems.length) {\n      var bookmark = editor.selection.getBookmark();\n      listIndentation(editor, lists, indentation);\n      dlIndentation(editor, indentation, dlItems);\n      editor.selection.moveToBookmark(bookmark);\n      editor.selection.setRng(normalizeRange(editor.selection.getRng()));\n      editor.nodeChanged();\n      isHandled = true;\n    }\n\n    return isHandled;\n  };\n\n  var indentListSelection = function (editor) {\n    return selectionIndentation(editor, 'Indent');\n  };\n\n  var outdentListSelection = function (editor) {\n    return selectionIndentation(editor, 'Outdent');\n  };\n\n  var flattenListSelection = function (editor) {\n    return selectionIndentation(editor, 'Flatten');\n  };\n\n  var global$7 = tinymce.util.Tools.resolve('tinymce.dom.BookmarkManager');\n  var DOM$1 = global$4.DOM;\n\n  var createBookmark = function (rng) {\n    var bookmark = {};\n\n    var setupEndPoint = function (start) {\n      var offsetNode, container, offset;\n      container = rng[start ? 'startContainer' : 'endContainer'];\n      offset = rng[start ? 'startOffset' : 'endOffset'];\n\n      if (container.nodeType === 1) {\n        offsetNode = DOM$1.create('span', {\n          'data-mce-type': 'bookmark'\n        });\n\n        if (container.hasChildNodes()) {\n          offset = Math.min(offset, container.childNodes.length - 1);\n\n          if (start) {\n            container.insertBefore(offsetNode, container.childNodes[offset]);\n          } else {\n            DOM$1.insertAfter(offsetNode, container.childNodes[offset]);\n          }\n        } else {\n          container.appendChild(offsetNode);\n        }\n\n        container = offsetNode;\n        offset = 0;\n      }\n\n      bookmark[start ? 'startContainer' : 'endContainer'] = container;\n      bookmark[start ? 'startOffset' : 'endOffset'] = offset;\n    };\n\n    setupEndPoint(true);\n\n    if (!rng.collapsed) {\n      setupEndPoint();\n    }\n\n    return bookmark;\n  };\n\n  var resolveBookmark = function (bookmark) {\n    var restoreEndPoint = function (start) {\n      var container, offset, node;\n\n      var nodeIndex = function (container) {\n        var node = container.parentNode.firstChild,\n            idx = 0;\n\n        while (node) {\n          if (node === container) {\n            return idx;\n          }\n\n          if (node.nodeType !== 1 || node.getAttribute('data-mce-type') !== 'bookmark') {\n            idx++;\n          }\n\n          node = node.nextSibling;\n        }\n\n        return -1;\n      };\n\n      container = node = bookmark[start ? 'startContainer' : 'endContainer'];\n      offset = bookmark[start ? 'startOffset' : 'endOffset'];\n\n      if (!container) {\n        return;\n      }\n\n      if (container.nodeType === 1) {\n        offset = nodeIndex(container);\n        container = container.parentNode;\n        DOM$1.remove(node);\n\n        if (!container.hasChildNodes() && DOM$1.isBlock(container)) {\n          container.appendChild(DOM$1.create('br'));\n        }\n      }\n\n      bookmark[start ? 'startContainer' : 'endContainer'] = container;\n      bookmark[start ? 'startOffset' : 'endOffset'] = offset;\n    };\n\n    restoreEndPoint(true);\n    restoreEndPoint();\n    var rng = DOM$1.createRng();\n    rng.setStart(bookmark.startContainer, bookmark.startOffset);\n\n    if (bookmark.endContainer) {\n      rng.setEnd(bookmark.endContainer, bookmark.endOffset);\n    }\n\n    return normalizeRange(rng);\n  };\n\n  var listToggleActionFromListName = function (listName) {\n    switch (listName) {\n      case 'UL':\n        return 'ToggleUlList';\n\n      case 'OL':\n        return 'ToggleOlList';\n\n      case 'DL':\n        return 'ToggleDLList';\n    }\n  };\n\n  var isCustomList = function (list) {\n    return /\\btox\\-/.test(list.className);\n  };\n\n  var listState = function (editor, listName, activate) {\n    var nodeChangeHandler = function (e) {\n      var inList = findUntil(e.parents, isListNode, isTableCellNode).filter(function (list) {\n        return list.nodeName === listName && !isCustomList(list);\n      }).isSome();\n      activate(inList);\n    };\n\n    var parents = editor.dom.getParents(editor.selection.getNode());\n    nodeChangeHandler({\n      parents: parents\n    });\n    editor.on('NodeChange', nodeChangeHandler);\n    return function () {\n      return editor.off('NodeChange', nodeChangeHandler);\n    };\n  };\n\n  var updateListStyle = function (dom, el, detail) {\n    var type = detail['list-style-type'] ? detail['list-style-type'] : null;\n    dom.setStyle(el, 'list-style-type', type);\n  };\n\n  var setAttribs = function (elm, attrs) {\n    global$5.each(attrs, function (value, key) {\n      elm.setAttribute(key, value);\n    });\n  };\n\n  var updateListAttrs = function (dom, el, detail) {\n    setAttribs(el, detail['list-attributes']);\n    global$5.each(dom.select('li', el), function (li) {\n      setAttribs(li, detail['list-item-attributes']);\n    });\n  };\n\n  var updateListWithDetails = function (dom, el, detail) {\n    updateListStyle(dom, el, detail);\n    updateListAttrs(dom, el, detail);\n  };\n\n  var removeStyles = function (dom, element, styles) {\n    global$5.each(styles, function (style) {\n      var _a;\n\n      return dom.setStyle(element, (_a = {}, _a[style] = '', _a));\n    });\n  };\n\n  var getEndPointNode = function (editor, rng, start, root) {\n    var container = rng[start ? 'startContainer' : 'endContainer'];\n    var offset = rng[start ? 'startOffset' : 'endOffset'];\n\n    if (container.nodeType === 1) {\n      container = container.childNodes[Math.min(offset, container.childNodes.length - 1)] || container;\n    }\n\n    if (!start && isBr(container.nextSibling)) {\n      container = container.nextSibling;\n    }\n\n    while (container.parentNode !== root) {\n      if (isTextBlock(editor, container)) {\n        return container;\n      }\n\n      if (/^(TD|TH)$/.test(container.parentNode.nodeName)) {\n        return container;\n      }\n\n      container = container.parentNode;\n    }\n\n    return container;\n  };\n\n  var getSelectedTextBlocks = function (editor, rng, root) {\n    var textBlocks = [],\n        dom = editor.dom;\n    var startNode = getEndPointNode(editor, rng, true, root);\n    var endNode = getEndPointNode(editor, rng, false, root);\n    var block;\n    var siblings = [];\n\n    for (var node = startNode; node; node = node.nextSibling) {\n      siblings.push(node);\n\n      if (node === endNode) {\n        break;\n      }\n    }\n\n    global$5.each(siblings, function (node) {\n      if (isTextBlock(editor, node)) {\n        textBlocks.push(node);\n        block = null;\n        return;\n      }\n\n      if (dom.isBlock(node) || isBr(node)) {\n        if (isBr(node)) {\n          dom.remove(node);\n        }\n\n        block = null;\n        return;\n      }\n\n      var nextSibling = node.nextSibling;\n\n      if (global$7.isBookmarkNode(node)) {\n        if (isListNode(nextSibling) || isTextBlock(editor, nextSibling) || !nextSibling && node.parentNode === root) {\n          block = null;\n          return;\n        }\n      }\n\n      if (!block) {\n        block = dom.create('p');\n        node.parentNode.insertBefore(block, node);\n        textBlocks.push(block);\n      }\n\n      block.appendChild(node);\n    });\n    return textBlocks;\n  };\n\n  var hasCompatibleStyle = function (dom, sib, detail) {\n    var sibStyle = dom.getStyle(sib, 'list-style-type');\n    var detailStyle = detail ? detail['list-style-type'] : '';\n    detailStyle = detailStyle === null ? '' : detailStyle;\n    return sibStyle === detailStyle;\n  };\n\n  var applyList = function (editor, listName, detail) {\n    var rng = editor.selection.getRng();\n    var listItemName = 'LI';\n    var root = getClosestListRootElm(editor, editor.selection.getStart(true));\n    var dom = editor.dom;\n\n    if (dom.getContentEditable(editor.selection.getNode()) === 'false') {\n      return;\n    }\n\n    listName = listName.toUpperCase();\n\n    if (listName === 'DL') {\n      listItemName = 'DT';\n    }\n\n    var bookmark = createBookmark(rng);\n    var selectedTextBlocks = getSelectedTextBlocks(editor, rng, root);\n    global$5.each(selectedTextBlocks, function (block) {\n      var listBlock;\n      var sibling = block.previousSibling;\n      var parent = block.parentNode;\n\n      if (!isListItemNode(parent)) {\n        if (sibling && isListNode(sibling) && sibling.nodeName === listName && hasCompatibleStyle(dom, sibling, detail)) {\n          listBlock = sibling;\n          block = dom.rename(block, listItemName);\n          sibling.appendChild(block);\n        } else {\n          listBlock = dom.create(listName);\n          block.parentNode.insertBefore(listBlock, block);\n          listBlock.appendChild(block);\n          block = dom.rename(block, listItemName);\n        }\n\n        removeStyles(dom, block, ['margin', 'margin-right', 'margin-bottom', 'margin-left', 'margin-top', 'padding', 'padding-right', 'padding-bottom', 'padding-left', 'padding-top']);\n        updateListWithDetails(dom, listBlock, detail);\n        mergeWithAdjacentLists(editor.dom, listBlock);\n      }\n    });\n    editor.selection.setRng(resolveBookmark(bookmark));\n  };\n\n  var isValidLists = function (list1, list2) {\n    return list1 && list2 && isListNode(list1) && list1.nodeName === list2.nodeName;\n  };\n\n  var hasSameListStyle = function (dom, list1, list2) {\n    var targetStyle = dom.getStyle(list1, 'list-style-type', true);\n    var style = dom.getStyle(list2, 'list-style-type', true);\n    return targetStyle === style;\n  };\n\n  var hasSameClasses = function (elm1, elm2) {\n    return elm1.className === elm2.className;\n  };\n\n  var shouldMerge = function (dom, list1, list2) {\n    return isValidLists(list1, list2) && hasSameListStyle(dom, list1, list2) && hasSameClasses(list1, list2);\n  };\n\n  var mergeWithAdjacentLists = function (dom, listBlock) {\n    var sibling, node;\n    sibling = listBlock.nextSibling;\n\n    if (shouldMerge(dom, listBlock, sibling)) {\n      while (node = sibling.firstChild) {\n        listBlock.appendChild(node);\n      }\n\n      dom.remove(sibling);\n    }\n\n    sibling = listBlock.previousSibling;\n\n    if (shouldMerge(dom, listBlock, sibling)) {\n      while (node = sibling.lastChild) {\n        listBlock.insertBefore(node, listBlock.firstChild);\n      }\n\n      dom.remove(sibling);\n    }\n  };\n\n  var updateList = function (editor, list, listName, detail) {\n    if (list.nodeName !== listName) {\n      var newList = editor.dom.rename(list, listName);\n      updateListWithDetails(editor.dom, newList, detail);\n      fireListEvent(editor, listToggleActionFromListName(listName), newList);\n    } else {\n      updateListWithDetails(editor.dom, list, detail);\n      fireListEvent(editor, listToggleActionFromListName(listName), list);\n    }\n  };\n\n  var toggleMultipleLists = function (editor, parentList, lists, listName, detail) {\n    var parentIsList = isListNode(parentList);\n\n    if (parentIsList && parentList.nodeName === listName && !hasListStyleDetail(detail)) {\n      flattenListSelection(editor);\n    } else {\n      applyList(editor, listName, detail);\n      var bookmark = createBookmark(editor.selection.getRng(true));\n      var allLists = parentIsList ? __spreadArrays([parentList], lists) : lists;\n      global$5.each(allLists, function (elm) {\n        updateList(editor, elm, listName, detail);\n      });\n      editor.selection.setRng(resolveBookmark(bookmark));\n    }\n  };\n\n  var hasListStyleDetail = function (detail) {\n    return 'list-style-type' in detail;\n  };\n\n  var toggleSingleList = function (editor, parentList, listName, detail) {\n    if (parentList === editor.getBody()) {\n      return;\n    }\n\n    if (parentList) {\n      if (parentList.nodeName === listName && !hasListStyleDetail(detail) && !isCustomList(parentList)) {\n        flattenListSelection(editor);\n      } else {\n        var bookmark = createBookmark(editor.selection.getRng(true));\n        updateListWithDetails(editor.dom, parentList, detail);\n        var newList = editor.dom.rename(parentList, listName);\n        mergeWithAdjacentLists(editor.dom, newList);\n        editor.selection.setRng(resolveBookmark(bookmark));\n        applyList(editor, listName, detail);\n        fireListEvent(editor, listToggleActionFromListName(listName), newList);\n      }\n    } else {\n      applyList(editor, listName, detail);\n      fireListEvent(editor, listToggleActionFromListName(listName), parentList);\n    }\n  };\n\n  var toggleList = function (editor, listName, _detail) {\n    var parentList = getParentList(editor);\n    var selectedSubLists = getSelectedSubLists(editor);\n    var detail = isObject(_detail) ? _detail : {};\n\n    if (selectedSubLists.length > 0) {\n      toggleMultipleLists(editor, parentList, selectedSubLists, listName, detail);\n    } else {\n      toggleSingleList(editor, parentList, listName, detail);\n    }\n  };\n\n  var DOM$2 = global$4.DOM;\n\n  var normalizeList = function (dom, ul) {\n    var sibling;\n    var parentNode = ul.parentNode;\n\n    if (parentNode.nodeName === 'LI' && parentNode.firstChild === ul) {\n      sibling = parentNode.previousSibling;\n\n      if (sibling && sibling.nodeName === 'LI') {\n        sibling.appendChild(ul);\n\n        if (isEmpty$1(dom, parentNode)) {\n          DOM$2.remove(parentNode);\n        }\n      } else {\n        DOM$2.setStyle(parentNode, 'listStyleType', 'none');\n      }\n    }\n\n    if (isListNode(parentNode)) {\n      sibling = parentNode.previousSibling;\n\n      if (sibling && sibling.nodeName === 'LI') {\n        sibling.appendChild(ul);\n      }\n    }\n  };\n\n  var normalizeLists = function (dom, element) {\n    global$5.each(global$5.grep(dom.select('ol,ul', element)), function (ul) {\n      normalizeList(dom, ul);\n    });\n  };\n\n  var findNextCaretContainer = function (editor, rng, isForward, root) {\n    var node = rng.startContainer;\n    var offset = rng.startOffset;\n\n    if (isTextNode(node) && (isForward ? offset < node.data.length : offset > 0)) {\n      return node;\n    }\n\n    var nonEmptyBlocks = editor.schema.getNonEmptyElements();\n\n    if (node.nodeType === 1) {\n      node = global$1.getNode(node, offset);\n    }\n\n    var walker = new global$2(node, root);\n\n    if (isForward) {\n      if (isBogusBr(editor.dom, node)) {\n        walker.next();\n      }\n    }\n\n    while (node = walker[isForward ? 'next' : 'prev2']()) {\n      if (node.nodeName === 'LI' && !node.hasChildNodes()) {\n        return node;\n      }\n\n      if (nonEmptyBlocks[node.nodeName]) {\n        return node;\n      }\n\n      if (isTextNode(node) && node.data.length > 0) {\n        return node;\n      }\n    }\n  };\n\n  var hasOnlyOneBlockChild = function (dom, elm) {\n    var childNodes = elm.childNodes;\n    return childNodes.length === 1 && !isListNode(childNodes[0]) && dom.isBlock(childNodes[0]);\n  };\n\n  var unwrapSingleBlockChild = function (dom, elm) {\n    if (hasOnlyOneBlockChild(dom, elm)) {\n      dom.remove(elm.firstChild, true);\n    }\n  };\n\n  var moveChildren = function (dom, fromElm, toElm) {\n    var node;\n    var targetElm = hasOnlyOneBlockChild(dom, toElm) ? toElm.firstChild : toElm;\n    unwrapSingleBlockChild(dom, fromElm);\n\n    if (!isEmpty$1(dom, fromElm, true)) {\n      while (node = fromElm.firstChild) {\n        targetElm.appendChild(node);\n      }\n    }\n  };\n\n  var mergeLiElements = function (dom, fromElm, toElm) {\n    var listNode;\n    var ul = fromElm.parentNode;\n\n    if (!isChildOfBody(dom, fromElm) || !isChildOfBody(dom, toElm)) {\n      return;\n    }\n\n    if (isListNode(toElm.lastChild)) {\n      listNode = toElm.lastChild;\n    }\n\n    if (ul === toElm.lastChild) {\n      if (isBr(ul.previousSibling)) {\n        dom.remove(ul.previousSibling);\n      }\n    }\n\n    var node = toElm.lastChild;\n\n    if (node && isBr(node) && fromElm.hasChildNodes()) {\n      dom.remove(node);\n    }\n\n    if (isEmpty$1(dom, toElm, true)) {\n      dom.$(toElm).empty();\n    }\n\n    moveChildren(dom, fromElm, toElm);\n\n    if (listNode) {\n      toElm.appendChild(listNode);\n    }\n\n    var contains = contains$1(SugarElement.fromDom(toElm), SugarElement.fromDom(fromElm));\n    var nestedLists = contains ? dom.getParents(fromElm, isListNode, toElm) : [];\n    dom.remove(fromElm);\n    each(nestedLists, function (list) {\n      if (isEmpty$1(dom, list) && list !== dom.getRoot()) {\n        dom.remove(list);\n      }\n    });\n  };\n\n  var mergeIntoEmptyLi = function (editor, fromLi, toLi) {\n    editor.dom.$(toLi).empty();\n    mergeLiElements(editor.dom, fromLi, toLi);\n    editor.selection.setCursorLocation(toLi, 0);\n  };\n\n  var mergeForward = function (editor, rng, fromLi, toLi) {\n    var dom = editor.dom;\n\n    if (dom.isEmpty(toLi)) {\n      mergeIntoEmptyLi(editor, fromLi, toLi);\n    } else {\n      var bookmark = createBookmark(rng);\n      mergeLiElements(dom, fromLi, toLi);\n      editor.selection.setRng(resolveBookmark(bookmark));\n    }\n  };\n\n  var mergeBackward = function (editor, rng, fromLi, toLi) {\n    var bookmark = createBookmark(rng);\n    mergeLiElements(editor.dom, fromLi, toLi);\n    var resolvedBookmark = resolveBookmark(bookmark);\n    editor.selection.setRng(resolvedBookmark);\n  };\n\n  var backspaceDeleteFromListToListCaret = function (editor, isForward) {\n    var dom = editor.dom,\n        selection = editor.selection;\n    var selectionStartElm = selection.getStart();\n    var root = getClosestListRootElm(editor, selectionStartElm);\n    var li = dom.getParent(selection.getStart(), 'LI', root);\n\n    if (li) {\n      var ul = li.parentNode;\n\n      if (ul === editor.getBody() && isEmpty$1(dom, ul)) {\n        return true;\n      }\n\n      var rng_1 = normalizeRange(selection.getRng());\n      var otherLi_1 = dom.getParent(findNextCaretContainer(editor, rng_1, isForward, root), 'LI', root);\n\n      if (otherLi_1 && otherLi_1 !== li) {\n        editor.undoManager.transact(function () {\n          if (isForward) {\n            mergeForward(editor, rng_1, otherLi_1, li);\n          } else {\n            if (isFirstChild(li)) {\n              outdentListSelection(editor);\n            } else {\n              mergeBackward(editor, rng_1, li, otherLi_1);\n            }\n          }\n        });\n        return true;\n      } else if (!otherLi_1) {\n        if (!isForward && rng_1.startOffset === 0 && rng_1.endOffset === 0) {\n          editor.undoManager.transact(function () {\n            flattenListSelection(editor);\n          });\n          return true;\n        }\n      }\n    }\n\n    return false;\n  };\n\n  var removeBlock = function (dom, block, root) {\n    var parentBlock = dom.getParent(block.parentNode, dom.isBlock, root);\n    dom.remove(block);\n\n    if (parentBlock && dom.isEmpty(parentBlock)) {\n      dom.remove(parentBlock);\n    }\n  };\n\n  var backspaceDeleteIntoListCaret = function (editor, isForward) {\n    var dom = editor.dom;\n    var selectionStartElm = editor.selection.getStart();\n    var root = getClosestListRootElm(editor, selectionStartElm);\n    var block = dom.getParent(selectionStartElm, dom.isBlock, root);\n\n    if (block && dom.isEmpty(block)) {\n      var rng = normalizeRange(editor.selection.getRng());\n      var otherLi_2 = dom.getParent(findNextCaretContainer(editor, rng, isForward, root), 'LI', root);\n\n      if (otherLi_2) {\n        editor.undoManager.transact(function () {\n          removeBlock(dom, block, root);\n          mergeWithAdjacentLists(dom, otherLi_2.parentNode);\n          editor.selection.select(otherLi_2, true);\n          editor.selection.collapse(isForward);\n        });\n        return true;\n      }\n    }\n\n    return false;\n  };\n\n  var backspaceDeleteCaret = function (editor, isForward) {\n    return backspaceDeleteFromListToListCaret(editor, isForward) || backspaceDeleteIntoListCaret(editor, isForward);\n  };\n\n  var backspaceDeleteRange = function (editor) {\n    var selectionStartElm = editor.selection.getStart();\n    var root = getClosestListRootElm(editor, selectionStartElm);\n    var startListParent = editor.dom.getParent(selectionStartElm, 'LI,DT,DD', root);\n\n    if (startListParent || getSelectedListItems(editor).length > 0) {\n      editor.undoManager.transact(function () {\n        editor.execCommand('Delete');\n        normalizeLists(editor.dom, editor.getBody());\n      });\n      return true;\n    }\n\n    return false;\n  };\n\n  var backspaceDelete = function (editor, isForward) {\n    return editor.selection.isCollapsed() ? backspaceDeleteCaret(editor, isForward) : backspaceDeleteRange(editor);\n  };\n\n  var setup = function (editor) {\n    editor.on('keydown', function (e) {\n      if (e.keyCode === global$3.BACKSPACE) {\n        if (backspaceDelete(editor, false)) {\n          e.preventDefault();\n        }\n      } else if (e.keyCode === global$3.DELETE) {\n        if (backspaceDelete(editor, true)) {\n          e.preventDefault();\n        }\n      }\n    });\n  };\n\n  var get$1 = function (editor) {\n    return {\n      backspaceDelete: function (isForward) {\n        backspaceDelete(editor, isForward);\n      }\n    };\n  };\n\n  var updateList$1 = function (editor, update) {\n    var parentList = getParentList(editor);\n    editor.undoManager.transact(function () {\n      if (isObject(update.styles)) {\n        editor.dom.setStyles(parentList, update.styles);\n      }\n\n      if (isObject(update.attrs)) {\n        each$1(update.attrs, function (v, k) {\n          return editor.dom.setAttrib(parentList, k, v);\n        });\n      }\n    });\n  };\n\n  var parseAlphabeticBase26 = function (str) {\n    var chars = reverse(trim(str).split(''));\n    var values = map(chars, function (char, i) {\n      var charValue = char.toUpperCase().charCodeAt(0) - 'A'.charCodeAt(0) + 1;\n      return Math.pow(26, i) * charValue;\n    });\n    return foldl(values, function (sum, v) {\n      return sum + v;\n    }, 0);\n  };\n\n  var composeAlphabeticBase26 = function (value) {\n    value--;\n\n    if (value < 0) {\n      return '';\n    } else {\n      var remainder = value % 26;\n      var quotient = Math.floor(value / 26);\n      var rest = composeAlphabeticBase26(quotient);\n      var char = String.fromCharCode('A'.charCodeAt(0) + remainder);\n      return rest + char;\n    }\n  };\n\n  var isUppercase = function (str) {\n    return /^[A-Z]+$/.test(str);\n  };\n\n  var isLowercase = function (str) {\n    return /^[a-z]+$/.test(str);\n  };\n\n  var isNumeric = function (str) {\n    return /^[0-9]+$/.test(str);\n  };\n\n  var deduceListType = function (start) {\n    if (isNumeric(start)) {\n      return 2;\n    } else if (isUppercase(start)) {\n      return 0;\n    } else if (isLowercase(start)) {\n      return 1;\n    } else if (isEmpty(start)) {\n      return 3;\n    } else {\n      return 4;\n    }\n  };\n\n  var parseStartValue = function (start) {\n    switch (deduceListType(start)) {\n      case 2:\n        return Optional.some({\n          listStyleType: Optional.none(),\n          start: start\n        });\n\n      case 0:\n        return Optional.some({\n          listStyleType: Optional.some('upper-alpha'),\n          start: parseAlphabeticBase26(start).toString()\n        });\n\n      case 1:\n        return Optional.some({\n          listStyleType: Optional.some('lower-alpha'),\n          start: parseAlphabeticBase26(start).toString()\n        });\n\n      case 3:\n        return Optional.some({\n          listStyleType: Optional.none(),\n          start: ''\n        });\n\n      case 4:\n        return Optional.none();\n    }\n  };\n\n  var parseDetail = function (detail) {\n    var start = parseInt(detail.start, 10);\n\n    if (detail.listStyleType.is('upper-alpha')) {\n      return composeAlphabeticBase26(start);\n    } else if (detail.listStyleType.is('lower-alpha')) {\n      return composeAlphabeticBase26(start).toLowerCase();\n    } else {\n      return detail.start;\n    }\n  };\n\n  var open = function (editor) {\n    var currentList = getParentList(editor);\n\n    if (!isOlNode(currentList)) {\n      return;\n    }\n\n    editor.windowManager.open({\n      title: 'List Properties',\n      body: {\n        type: 'panel',\n        items: [{\n          type: 'input',\n          name: 'start',\n          label: 'Start list at number',\n          inputMode: 'numeric'\n        }]\n      },\n      initialData: {\n        start: parseDetail({\n          start: editor.dom.getAttrib(currentList, 'start', '1'),\n          listStyleType: Optional.some(editor.dom.getStyle(currentList, 'list-style-type'))\n        })\n      },\n      buttons: [{\n        type: 'cancel',\n        name: 'cancel',\n        text: 'Cancel'\n      }, {\n        type: 'submit',\n        name: 'save',\n        text: 'Save',\n        primary: true\n      }],\n      onSubmit: function (api) {\n        var data = api.getData();\n        parseStartValue(data.start).each(function (detail) {\n          editor.execCommand('mceListUpdate', false, {\n            attrs: {\n              start: detail.start === '1' ? '' : detail.start\n            },\n            styles: {\n              'list-style-type': detail.listStyleType.getOr('')\n            }\n          });\n        });\n        api.close();\n      }\n    });\n  };\n\n  var queryListCommandState = function (editor, listName) {\n    return function () {\n      var parentList = getParentList(editor);\n      return parentList && parentList.nodeName === listName;\n    };\n  };\n\n  var registerDialog = function (editor) {\n    editor.addCommand('mceListProps', function () {\n      open(editor);\n    });\n  };\n\n  var register = function (editor) {\n    editor.on('BeforeExecCommand', function (e) {\n      var cmd = e.command.toLowerCase();\n\n      if (cmd === 'indent') {\n        indentListSelection(editor);\n      } else if (cmd === 'outdent') {\n        outdentListSelection(editor);\n      }\n    });\n    editor.addCommand('InsertUnorderedList', function (ui, detail) {\n      toggleList(editor, 'UL', detail);\n    });\n    editor.addCommand('InsertOrderedList', function (ui, detail) {\n      toggleList(editor, 'OL', detail);\n    });\n    editor.addCommand('InsertDefinitionList', function (ui, detail) {\n      toggleList(editor, 'DL', detail);\n    });\n    editor.addCommand('RemoveList', function () {\n      flattenListSelection(editor);\n    });\n    registerDialog(editor);\n    editor.addCommand('mceListUpdate', function (ui, detail) {\n      if (isObject(detail)) {\n        updateList$1(editor, detail);\n      }\n    });\n    editor.addQueryStateHandler('InsertUnorderedList', queryListCommandState(editor, 'UL'));\n    editor.addQueryStateHandler('InsertOrderedList', queryListCommandState(editor, 'OL'));\n    editor.addQueryStateHandler('InsertDefinitionList', queryListCommandState(editor, 'DL'));\n  };\n\n  var setupTabKey = function (editor) {\n    editor.on('keydown', function (e) {\n      if (e.keyCode !== global$3.TAB || global$3.metaKeyPressed(e)) {\n        return;\n      }\n\n      editor.undoManager.transact(function () {\n        if (e.shiftKey ? outdentListSelection(editor) : indentListSelection(editor)) {\n          e.preventDefault();\n        }\n      });\n    });\n  };\n\n  var setup$1 = function (editor) {\n    if (shouldIndentOnTab(editor)) {\n      setupTabKey(editor);\n    }\n\n    setup(editor);\n  };\n\n  var register$1 = function (editor) {\n    var exec = function (command) {\n      return function () {\n        return editor.execCommand(command);\n      };\n    };\n\n    if (!editor.hasPlugin('advlist')) {\n      editor.ui.registry.addToggleButton('numlist', {\n        icon: 'ordered-list',\n        active: false,\n        tooltip: 'Numbered list',\n        onAction: exec('InsertOrderedList'),\n        onSetup: function (api) {\n          return listState(editor, 'OL', api.setActive);\n        }\n      });\n      editor.ui.registry.addToggleButton('bullist', {\n        icon: 'unordered-list',\n        active: false,\n        tooltip: 'Bullet list',\n        onAction: exec('InsertUnorderedList'),\n        onSetup: function (api) {\n          return listState(editor, 'UL', api.setActive);\n        }\n      });\n    }\n  };\n\n  var register$2 = function (editor) {\n    var listProperties = {\n      text: 'List properties...',\n      icon: 'ordered-list',\n      onAction: function () {\n        return editor.execCommand('mceListProps');\n      },\n      onSetup: function (api) {\n        return listState(editor, 'OL', function (active) {\n          return api.setDisabled(!active);\n        });\n      }\n    };\n    editor.ui.registry.addMenuItem('listprops', listProperties);\n    editor.ui.registry.addContextMenu('lists', {\n      update: function (node) {\n        var parentList = getParentList(editor, node);\n        return isOlNode(parentList) ? ['listprops'] : [];\n      }\n    });\n  };\n\n  function Plugin() {\n    global.add('lists', function (editor) {\n      if (editor.hasPlugin('rtc', true) === false) {\n        setup$1(editor);\n        register(editor);\n      } else {\n        registerDialog(editor);\n      }\n\n      register$1(editor);\n      register$2(editor);\n      return get$1(editor);\n    });\n  }\n\n  Plugin();\n})();","map":{"version":3,"sources":["/home/lin/phase5/My-Place-Frontend/my-place/node_modules/tinymce/plugins/lists/plugin.js"],"names":["global","tinymce","util","Tools","resolve","typeOf","x","t","Array","prototype","isPrototypeOf","constructor","name","String","isType","type","value","isSimpleType","isString","isObject","isArray","isBoolean","isFunction","isNumber","noop","constant","not","f","never","always","none","NONE","eq","o","isNone","call","thunk","id","n","me","fold","_s","is","isSome","getOr","getOrThunk","getOrDie","msg","Error","getOrNull","getOrUndefined","undefined","or","orThunk","map","each","bind","exists","forall","filter","equals","equals_","toArray","toString","some","a","constant_a","self","s","v","elementEq","b","from","Optional","nativeSlice","slice","nativePush","push","xs","len","length","r","i","pred","groupBy","wasType","group","foldl","acc","findUntil","until","find","flatten","apply","reverse","get","head","last","__assign","Object","assign","arguments","p","hasOwnProperty","__spreadArrays","il","k","j","jl","cached","called","args","_i","DeviceType","os","browser","userAgent","mediaMatch","isiPad","isiOS","test","isiPhone","isMobile","isAndroid","isTouch","isTablet","isPhone","iOSwebview","isSafari","isDesktop","isWebView","firstMatch","regexes","find$1","agent","major","minor","Number","replace","nu","detect","versionRegexes","cleanedAgent","toLowerCase","unknown","Version","detect$1","candidates","candidate","search","detectBrowser","browsers","version","current","detectOs","oses","UaString","contains","str","substr","indexOf","blank","trim","isNotEmpty","isEmpty","normalVersionRegex","checkContains","target","uastring","PlatformInfo","edge","chrome","ie","opera","firefox","safari","unknown$1","nu$1","info","isBrowser","isEdge","isChrome","isIE","isOpera","isFirefox","Browser","windows","ios","android","linux","osx","solaris","freebsd","chromeos","unknown$2","nu$2","isOS","isWindows","isOSX","isLinux","isSolaris","isFreeBSD","isChromeOS","OperatingSystem","detect$2","deviceType","PlatformDetection","query","window","matchMedia","matches","platform","navigator","detect$3","compareDocumentPosition","match","documentPositionContainedBy","Node","DOCUMENT_POSITION_CONTAINED_BY","ELEMENT","fromHtml","html","scope","doc","document","div","createElement","innerHTML","hasChildNodes","childNodes","console","error","fromDom","fromTag","tag","node","fromText","text","createTextNode","dom","fromPoint","docElm","y","elementFromPoint","SugarElement","element","selector","nodeType","elem","msMatchesSelector","webkitMatchesSelector","mozMatchesSelector","e1","e2","regularContains","d1","d2","ieContains","contains$1","is$1","global$1","global$2","global$3","keys","each$1","obj","props","objAcc","internalFilter","onTrue","onFalse","filter$1","Global","Function","nodeName","isType$1","isElement","rawSet","key","setAttribute","setAll","attrs","clone","attributes","attr","parent","parentNode","children","child","index","cs","firstChild","lastChild","before","marker","parent$1","insertBefore","append","appendChild","before$1","elements","append$1","remove","removeChild","clone$1","original","isDeep","cloneNode","deep","shallowAs","mutate","children$1","global$4","global$5","matchNodeName","matchNodeNames","regex","isTextNode","isListNode","isOlUlNode","isOlNode","isListItemNode","isDlItemNode","isTableCellNode","isBr","isFirstChild","isTextBlock","editor","schema","getTextBlockElements","isBlock","blockElements","isBogusBr","nextSibling","previousSibling","isEmpty$1","elm","keepBookmarks","empty","select","isChildOfBody","isChildOf","getRoot","shouldIndentOnTab","getParam","getForcedRootBlock","block","getForcedRootBlockAttrs","createTextBlock","contentNode","getBlockElements","fragment","createFragment","blockName","textBlock","hasContentNode","create","tagName","toUpperCase","setAttribs","getAttribute","DOM","splitList","ul","li","removeAndKeepBookmarks","targetNode","bookmarks","newBlock","tmpRng","createRng","setStartAfter","setEndAfter","extractContents","insertAfter","outdentDlItem","item","dl","indentDlItem","dlIndentation","indentation","dlItems","getNormalizedPoint","container","offset","getNode","data","normalizeRange","rng","outRng","cloneRange","rangeStart","startContainer","startOffset","setStart","rangeEnd","endContainer","endOffset","setEnd","global$6","getParentList","selectionStart","selection","getStart","getParent","getClosestListRootElm","isParentListSelected","parentList","selectedBlocks","findSubLists","grep","querySelectorAll","getSelectedSubLists","getSelectedBlocks","findParentListItemsNodes","elms","listItemsElms","parentLi","unique","getSelectedListItems","getSelectedDlItems","parentTableCell","getParents","root","getBody","findLastParentListNode","parentLists","getSelectedLists","firstList","subsequentLists","concat","getSelectedListRoots","selectedLists","getUniqueListRoots","lists","listRoots","list","lift2","oa","ob","fromElements","createDocumentFragment","fireListEvent","action","fire","isSupported","style","getPropertyValue","internalSet","property","setProperty","set","joinSegment","joinSegments","segments","appendSegments","head$1","tail","createSegment","listType","segment","createSegments","entry","size","populateSegments","listAttributes","itemAttributes","content","normalizeSegment","createItem","appendItem","writeShallow","cast","newCast","depth","writeDeep","composeList","entries","isList","el","hasFirstChildList","hasLastChildList","isIndented","isSelected","cloneItemContent","createEntry","dirty","indentEntry","cloneListProperties","source","cleanListProperties","_value","closestSiblingEntry","start","normalizeEntries","matchingEntry","Cell","initial","parseItem","itemSelection","selectionState","currentItemEntry","end","childListEntries","parseList","parser","newDepth","parseLists","initialDepth","sourceList","outdentedComposer","normalizedEntries","indentedComposer","contentDocument","composeEntries","groupIsIndented","indentSelectedEntries","getItemSelection","selectedListItems","listIndentation","entrySets","entrySet","composedLists","composedList","selectionIndentation","isHandled","bookmark","getBookmark","moveToBookmark","setRng","getRng","nodeChanged","indentListSelection","outdentListSelection","flattenListSelection","global$7","DOM$1","createBookmark","setupEndPoint","offsetNode","Math","min","collapsed","resolveBookmark","restoreEndPoint","nodeIndex","idx","listToggleActionFromListName","listName","isCustomList","className","listState","activate","nodeChangeHandler","e","inList","parents","on","off","updateListStyle","detail","setStyle","updateListAttrs","updateListWithDetails","removeStyles","styles","_a","getEndPointNode","getSelectedTextBlocks","textBlocks","startNode","endNode","siblings","isBookmarkNode","hasCompatibleStyle","sib","sibStyle","getStyle","detailStyle","applyList","listItemName","getContentEditable","selectedTextBlocks","listBlock","sibling","rename","mergeWithAdjacentLists","isValidLists","list1","list2","hasSameListStyle","targetStyle","hasSameClasses","elm1","elm2","shouldMerge","updateList","newList","toggleMultipleLists","parentIsList","hasListStyleDetail","allLists","toggleSingleList","toggleList","_detail","selectedSubLists","DOM$2","normalizeList","normalizeLists","findNextCaretContainer","isForward","nonEmptyBlocks","getNonEmptyElements","walker","next","hasOnlyOneBlockChild","unwrapSingleBlockChild","moveChildren","fromElm","toElm","targetElm","mergeLiElements","listNode","$","nestedLists","mergeIntoEmptyLi","fromLi","toLi","setCursorLocation","mergeForward","mergeBackward","resolvedBookmark","backspaceDeleteFromListToListCaret","selectionStartElm","rng_1","otherLi_1","undoManager","transact","removeBlock","parentBlock","backspaceDeleteIntoListCaret","otherLi_2","collapse","backspaceDeleteCaret","backspaceDeleteRange","startListParent","execCommand","backspaceDelete","isCollapsed","setup","keyCode","BACKSPACE","preventDefault","DELETE","get$1","updateList$1","update","setStyles","setAttrib","parseAlphabeticBase26","chars","split","values","char","charValue","charCodeAt","pow","sum","composeAlphabeticBase26","remainder","quotient","floor","rest","fromCharCode","isUppercase","isLowercase","isNumeric","deduceListType","parseStartValue","listStyleType","parseDetail","parseInt","open","currentList","windowManager","title","body","items","label","inputMode","initialData","getAttrib","buttons","primary","onSubmit","api","getData","close","queryListCommandState","registerDialog","addCommand","register","cmd","command","ui","addQueryStateHandler","setupTabKey","TAB","metaKeyPressed","shiftKey","setup$1","register$1","exec","hasPlugin","registry","addToggleButton","icon","active","tooltip","onAction","onSetup","setActive","register$2","listProperties","setDisabled","addMenuItem","addContextMenu","Plugin","add"],"mappings":"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","sourcesContent":["/**\n * Copyright (c) Tiny Technologies, Inc. All rights reserved.\n * Licensed under the LGPL or a commercial license.\n * For LGPL see License.txt in the project root for license information.\n * For commercial licenses see https://www.tiny.cloud/\n *\n * Version: 5.8.2 (2021-06-23)\n */\n(function () {\n    'use strict';\n\n    var global = tinymce.util.Tools.resolve('tinymce.PluginManager');\n\n    var typeOf = function (x) {\n      var t = typeof x;\n      if (x === null) {\n        return 'null';\n      } else if (t === 'object' && (Array.prototype.isPrototypeOf(x) || x.constructor && x.constructor.name === 'Array')) {\n        return 'array';\n      } else if (t === 'object' && (String.prototype.isPrototypeOf(x) || x.constructor && x.constructor.name === 'String')) {\n        return 'string';\n      } else {\n        return t;\n      }\n    };\n    var isType = function (type) {\n      return function (value) {\n        return typeOf(value) === type;\n      };\n    };\n    var isSimpleType = function (type) {\n      return function (value) {\n        return typeof value === type;\n      };\n    };\n    var isString = isType('string');\n    var isObject = isType('object');\n    var isArray = isType('array');\n    var isBoolean = isSimpleType('boolean');\n    var isFunction = isSimpleType('function');\n    var isNumber = isSimpleType('number');\n\n    var noop = function () {\n    };\n    var constant = function (value) {\n      return function () {\n        return value;\n      };\n    };\n    var not = function (f) {\n      return function (t) {\n        return !f(t);\n      };\n    };\n    var never = constant(false);\n    var always = constant(true);\n\n    var none = function () {\n      return NONE;\n    };\n    var NONE = function () {\n      var eq = function (o) {\n        return o.isNone();\n      };\n      var call = function (thunk) {\n        return thunk();\n      };\n      var id = function (n) {\n        return n;\n      };\n      var me = {\n        fold: function (n, _s) {\n          return n();\n        },\n        is: never,\n        isSome: never,\n        isNone: always,\n        getOr: id,\n        getOrThunk: call,\n        getOrDie: function (msg) {\n          throw new Error(msg || 'error: getOrDie called on none.');\n        },\n        getOrNull: constant(null),\n        getOrUndefined: constant(undefined),\n        or: id,\n        orThunk: call,\n        map: none,\n        each: noop,\n        bind: none,\n        exists: never,\n        forall: always,\n        filter: none,\n        equals: eq,\n        equals_: eq,\n        toArray: function () {\n          return [];\n        },\n        toString: constant('none()')\n      };\n      return me;\n    }();\n    var some = function (a) {\n      var constant_a = constant(a);\n      var self = function () {\n        return me;\n      };\n      var bind = function (f) {\n        return f(a);\n      };\n      var me = {\n        fold: function (n, s) {\n          return s(a);\n        },\n        is: function (v) {\n          return a === v;\n        },\n        isSome: always,\n        isNone: never,\n        getOr: constant_a,\n        getOrThunk: constant_a,\n        getOrDie: constant_a,\n        getOrNull: constant_a,\n        getOrUndefined: constant_a,\n        or: self,\n        orThunk: self,\n        map: function (f) {\n          return some(f(a));\n        },\n        each: function (f) {\n          f(a);\n        },\n        bind: bind,\n        exists: bind,\n        forall: bind,\n        filter: function (f) {\n          return f(a) ? me : NONE;\n        },\n        toArray: function () {\n          return [a];\n        },\n        toString: function () {\n          return 'some(' + a + ')';\n        },\n        equals: function (o) {\n          return o.is(a);\n        },\n        equals_: function (o, elementEq) {\n          return o.fold(never, function (b) {\n            return elementEq(a, b);\n          });\n        }\n      };\n      return me;\n    };\n    var from = function (value) {\n      return value === null || value === undefined ? NONE : some(value);\n    };\n    var Optional = {\n      some: some,\n      none: none,\n      from: from\n    };\n\n    var nativeSlice = Array.prototype.slice;\n    var nativePush = Array.prototype.push;\n    var map = function (xs, f) {\n      var len = xs.length;\n      var r = new Array(len);\n      for (var i = 0; i < len; i++) {\n        var x = xs[i];\n        r[i] = f(x, i);\n      }\n      return r;\n    };\n    var each = function (xs, f) {\n      for (var i = 0, len = xs.length; i < len; i++) {\n        var x = xs[i];\n        f(x, i);\n      }\n    };\n    var filter = function (xs, pred) {\n      var r = [];\n      for (var i = 0, len = xs.length; i < len; i++) {\n        var x = xs[i];\n        if (pred(x, i)) {\n          r.push(x);\n        }\n      }\n      return r;\n    };\n    var groupBy = function (xs, f) {\n      if (xs.length === 0) {\n        return [];\n      } else {\n        var wasType = f(xs[0]);\n        var r = [];\n        var group = [];\n        for (var i = 0, len = xs.length; i < len; i++) {\n          var x = xs[i];\n          var type = f(x);\n          if (type !== wasType) {\n            r.push(group);\n            group = [];\n          }\n          wasType = type;\n          group.push(x);\n        }\n        if (group.length !== 0) {\n          r.push(group);\n        }\n        return r;\n      }\n    };\n    var foldl = function (xs, f, acc) {\n      each(xs, function (x) {\n        acc = f(acc, x);\n      });\n      return acc;\n    };\n    var findUntil = function (xs, pred, until) {\n      for (var i = 0, len = xs.length; i < len; i++) {\n        var x = xs[i];\n        if (pred(x, i)) {\n          return Optional.some(x);\n        } else if (until(x, i)) {\n          break;\n        }\n      }\n      return Optional.none();\n    };\n    var find = function (xs, pred) {\n      return findUntil(xs, pred, never);\n    };\n    var flatten = function (xs) {\n      var r = [];\n      for (var i = 0, len = xs.length; i < len; ++i) {\n        if (!isArray(xs[i])) {\n          throw new Error('Arr.flatten item ' + i + ' was not an array, input: ' + xs);\n        }\n        nativePush.apply(r, xs[i]);\n      }\n      return r;\n    };\n    var bind = function (xs, f) {\n      return flatten(map(xs, f));\n    };\n    var reverse = function (xs) {\n      var r = nativeSlice.call(xs, 0);\n      r.reverse();\n      return r;\n    };\n    var get = function (xs, i) {\n      return i >= 0 && i < xs.length ? Optional.some(xs[i]) : Optional.none();\n    };\n    var head = function (xs) {\n      return get(xs, 0);\n    };\n    var last = function (xs) {\n      return get(xs, xs.length - 1);\n    };\n\n    var __assign = function () {\n      __assign = Object.assign || function __assign(t) {\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\n          s = arguments[i];\n          for (var p in s)\n            if (Object.prototype.hasOwnProperty.call(s, p))\n              t[p] = s[p];\n        }\n        return t;\n      };\n      return __assign.apply(this, arguments);\n    };\n    function __spreadArrays() {\n      for (var s = 0, i = 0, il = arguments.length; i < il; i++)\n        s += arguments[i].length;\n      for (var r = Array(s), k = 0, i = 0; i < il; i++)\n        for (var a = arguments[i], j = 0, jl = a.length; j < jl; j++, k++)\n          r[k] = a[j];\n      return r;\n    }\n\n    var cached = function (f) {\n      var called = false;\n      var r;\n      return function () {\n        var args = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n          args[_i] = arguments[_i];\n        }\n        if (!called) {\n          called = true;\n          r = f.apply(null, args);\n        }\n        return r;\n      };\n    };\n\n    var DeviceType = function (os, browser, userAgent, mediaMatch) {\n      var isiPad = os.isiOS() && /ipad/i.test(userAgent) === true;\n      var isiPhone = os.isiOS() && !isiPad;\n      var isMobile = os.isiOS() || os.isAndroid();\n      var isTouch = isMobile || mediaMatch('(pointer:coarse)');\n      var isTablet = isiPad || !isiPhone && isMobile && mediaMatch('(min-device-width:768px)');\n      var isPhone = isiPhone || isMobile && !isTablet;\n      var iOSwebview = browser.isSafari() && os.isiOS() && /safari/i.test(userAgent) === false;\n      var isDesktop = !isPhone && !isTablet && !iOSwebview;\n      return {\n        isiPad: constant(isiPad),\n        isiPhone: constant(isiPhone),\n        isTablet: constant(isTablet),\n        isPhone: constant(isPhone),\n        isTouch: constant(isTouch),\n        isAndroid: os.isAndroid,\n        isiOS: os.isiOS,\n        isWebView: constant(iOSwebview),\n        isDesktop: constant(isDesktop)\n      };\n    };\n\n    var firstMatch = function (regexes, s) {\n      for (var i = 0; i < regexes.length; i++) {\n        var x = regexes[i];\n        if (x.test(s)) {\n          return x;\n        }\n      }\n      return undefined;\n    };\n    var find$1 = function (regexes, agent) {\n      var r = firstMatch(regexes, agent);\n      if (!r) {\n        return {\n          major: 0,\n          minor: 0\n        };\n      }\n      var group = function (i) {\n        return Number(agent.replace(r, '$' + i));\n      };\n      return nu(group(1), group(2));\n    };\n    var detect = function (versionRegexes, agent) {\n      var cleanedAgent = String(agent).toLowerCase();\n      if (versionRegexes.length === 0) {\n        return unknown();\n      }\n      return find$1(versionRegexes, cleanedAgent);\n    };\n    var unknown = function () {\n      return nu(0, 0);\n    };\n    var nu = function (major, minor) {\n      return {\n        major: major,\n        minor: minor\n      };\n    };\n    var Version = {\n      nu: nu,\n      detect: detect,\n      unknown: unknown\n    };\n\n    var detect$1 = function (candidates, userAgent) {\n      var agent = String(userAgent).toLowerCase();\n      return find(candidates, function (candidate) {\n        return candidate.search(agent);\n      });\n    };\n    var detectBrowser = function (browsers, userAgent) {\n      return detect$1(browsers, userAgent).map(function (browser) {\n        var version = Version.detect(browser.versionRegexes, userAgent);\n        return {\n          current: browser.name,\n          version: version\n        };\n      });\n    };\n    var detectOs = function (oses, userAgent) {\n      return detect$1(oses, userAgent).map(function (os) {\n        var version = Version.detect(os.versionRegexes, userAgent);\n        return {\n          current: os.name,\n          version: version\n        };\n      });\n    };\n    var UaString = {\n      detectBrowser: detectBrowser,\n      detectOs: detectOs\n    };\n\n    var contains = function (str, substr) {\n      return str.indexOf(substr) !== -1;\n    };\n    var blank = function (r) {\n      return function (s) {\n        return s.replace(r, '');\n      };\n    };\n    var trim = blank(/^\\s+|\\s+$/g);\n    var isNotEmpty = function (s) {\n      return s.length > 0;\n    };\n    var isEmpty = function (s) {\n      return !isNotEmpty(s);\n    };\n\n    var normalVersionRegex = /.*?version\\/\\ ?([0-9]+)\\.([0-9]+).*/;\n    var checkContains = function (target) {\n      return function (uastring) {\n        return contains(uastring, target);\n      };\n    };\n    var browsers = [\n      {\n        name: 'Edge',\n        versionRegexes: [/.*?edge\\/ ?([0-9]+)\\.([0-9]+)$/],\n        search: function (uastring) {\n          return contains(uastring, 'edge/') && contains(uastring, 'chrome') && contains(uastring, 'safari') && contains(uastring, 'applewebkit');\n        }\n      },\n      {\n        name: 'Chrome',\n        versionRegexes: [\n          /.*?chrome\\/([0-9]+)\\.([0-9]+).*/,\n          normalVersionRegex\n        ],\n        search: function (uastring) {\n          return contains(uastring, 'chrome') && !contains(uastring, 'chromeframe');\n        }\n      },\n      {\n        name: 'IE',\n        versionRegexes: [\n          /.*?msie\\ ?([0-9]+)\\.([0-9]+).*/,\n          /.*?rv:([0-9]+)\\.([0-9]+).*/\n        ],\n        search: function (uastring) {\n          return contains(uastring, 'msie') || contains(uastring, 'trident');\n        }\n      },\n      {\n        name: 'Opera',\n        versionRegexes: [\n          normalVersionRegex,\n          /.*?opera\\/([0-9]+)\\.([0-9]+).*/\n        ],\n        search: checkContains('opera')\n      },\n      {\n        name: 'Firefox',\n        versionRegexes: [/.*?firefox\\/\\ ?([0-9]+)\\.([0-9]+).*/],\n        search: checkContains('firefox')\n      },\n      {\n        name: 'Safari',\n        versionRegexes: [\n          normalVersionRegex,\n          /.*?cpu os ([0-9]+)_([0-9]+).*/\n        ],\n        search: function (uastring) {\n          return (contains(uastring, 'safari') || contains(uastring, 'mobile/')) && contains(uastring, 'applewebkit');\n        }\n      }\n    ];\n    var oses = [\n      {\n        name: 'Windows',\n        search: checkContains('win'),\n        versionRegexes: [/.*?windows\\ nt\\ ?([0-9]+)\\.([0-9]+).*/]\n      },\n      {\n        name: 'iOS',\n        search: function (uastring) {\n          return contains(uastring, 'iphone') || contains(uastring, 'ipad');\n        },\n        versionRegexes: [\n          /.*?version\\/\\ ?([0-9]+)\\.([0-9]+).*/,\n          /.*cpu os ([0-9]+)_([0-9]+).*/,\n          /.*cpu iphone os ([0-9]+)_([0-9]+).*/\n        ]\n      },\n      {\n        name: 'Android',\n        search: checkContains('android'),\n        versionRegexes: [/.*?android\\ ?([0-9]+)\\.([0-9]+).*/]\n      },\n      {\n        name: 'OSX',\n        search: checkContains('mac os x'),\n        versionRegexes: [/.*?mac\\ os\\ x\\ ?([0-9]+)_([0-9]+).*/]\n      },\n      {\n        name: 'Linux',\n        search: checkContains('linux'),\n        versionRegexes: []\n      },\n      {\n        name: 'Solaris',\n        search: checkContains('sunos'),\n        versionRegexes: []\n      },\n      {\n        name: 'FreeBSD',\n        search: checkContains('freebsd'),\n        versionRegexes: []\n      },\n      {\n        name: 'ChromeOS',\n        search: checkContains('cros'),\n        versionRegexes: [/.*?chrome\\/([0-9]+)\\.([0-9]+).*/]\n      }\n    ];\n    var PlatformInfo = {\n      browsers: constant(browsers),\n      oses: constant(oses)\n    };\n\n    var edge = 'Edge';\n    var chrome = 'Chrome';\n    var ie = 'IE';\n    var opera = 'Opera';\n    var firefox = 'Firefox';\n    var safari = 'Safari';\n    var unknown$1 = function () {\n      return nu$1({\n        current: undefined,\n        version: Version.unknown()\n      });\n    };\n    var nu$1 = function (info) {\n      var current = info.current;\n      var version = info.version;\n      var isBrowser = function (name) {\n        return function () {\n          return current === name;\n        };\n      };\n      return {\n        current: current,\n        version: version,\n        isEdge: isBrowser(edge),\n        isChrome: isBrowser(chrome),\n        isIE: isBrowser(ie),\n        isOpera: isBrowser(opera),\n        isFirefox: isBrowser(firefox),\n        isSafari: isBrowser(safari)\n      };\n    };\n    var Browser = {\n      unknown: unknown$1,\n      nu: nu$1,\n      edge: constant(edge),\n      chrome: constant(chrome),\n      ie: constant(ie),\n      opera: constant(opera),\n      firefox: constant(firefox),\n      safari: constant(safari)\n    };\n\n    var windows = 'Windows';\n    var ios = 'iOS';\n    var android = 'Android';\n    var linux = 'Linux';\n    var osx = 'OSX';\n    var solaris = 'Solaris';\n    var freebsd = 'FreeBSD';\n    var chromeos = 'ChromeOS';\n    var unknown$2 = function () {\n      return nu$2({\n        current: undefined,\n        version: Version.unknown()\n      });\n    };\n    var nu$2 = function (info) {\n      var current = info.current;\n      var version = info.version;\n      var isOS = function (name) {\n        return function () {\n          return current === name;\n        };\n      };\n      return {\n        current: current,\n        version: version,\n        isWindows: isOS(windows),\n        isiOS: isOS(ios),\n        isAndroid: isOS(android),\n        isOSX: isOS(osx),\n        isLinux: isOS(linux),\n        isSolaris: isOS(solaris),\n        isFreeBSD: isOS(freebsd),\n        isChromeOS: isOS(chromeos)\n      };\n    };\n    var OperatingSystem = {\n      unknown: unknown$2,\n      nu: nu$2,\n      windows: constant(windows),\n      ios: constant(ios),\n      android: constant(android),\n      linux: constant(linux),\n      osx: constant(osx),\n      solaris: constant(solaris),\n      freebsd: constant(freebsd),\n      chromeos: constant(chromeos)\n    };\n\n    var detect$2 = function (userAgent, mediaMatch) {\n      var browsers = PlatformInfo.browsers();\n      var oses = PlatformInfo.oses();\n      var browser = UaString.detectBrowser(browsers, userAgent).fold(Browser.unknown, Browser.nu);\n      var os = UaString.detectOs(oses, userAgent).fold(OperatingSystem.unknown, OperatingSystem.nu);\n      var deviceType = DeviceType(os, browser, userAgent, mediaMatch);\n      return {\n        browser: browser,\n        os: os,\n        deviceType: deviceType\n      };\n    };\n    var PlatformDetection = { detect: detect$2 };\n\n    var mediaMatch = function (query) {\n      return window.matchMedia(query).matches;\n    };\n    var platform = cached(function () {\n      return PlatformDetection.detect(navigator.userAgent, mediaMatch);\n    });\n    var detect$3 = function () {\n      return platform();\n    };\n\n    var compareDocumentPosition = function (a, b, match) {\n      return (a.compareDocumentPosition(b) & match) !== 0;\n    };\n    var documentPositionContainedBy = function (a, b) {\n      return compareDocumentPosition(a, b, Node.DOCUMENT_POSITION_CONTAINED_BY);\n    };\n\n    var ELEMENT = 1;\n\n    var fromHtml = function (html, scope) {\n      var doc = scope || document;\n      var div = doc.createElement('div');\n      div.innerHTML = html;\n      if (!div.hasChildNodes() || div.childNodes.length > 1) {\n        console.error('HTML does not have a single root node', html);\n        throw new Error('HTML must have a single root node');\n      }\n      return fromDom(div.childNodes[0]);\n    };\n    var fromTag = function (tag, scope) {\n      var doc = scope || document;\n      var node = doc.createElement(tag);\n      return fromDom(node);\n    };\n    var fromText = function (text, scope) {\n      var doc = scope || document;\n      var node = doc.createTextNode(text);\n      return fromDom(node);\n    };\n    var fromDom = function (node) {\n      if (node === null || node === undefined) {\n        throw new Error('Node cannot be null or undefined');\n      }\n      return { dom: node };\n    };\n    var fromPoint = function (docElm, x, y) {\n      return Optional.from(docElm.dom.elementFromPoint(x, y)).map(fromDom);\n    };\n    var SugarElement = {\n      fromHtml: fromHtml,\n      fromTag: fromTag,\n      fromText: fromText,\n      fromDom: fromDom,\n      fromPoint: fromPoint\n    };\n\n    var is = function (element, selector) {\n      var dom = element.dom;\n      if (dom.nodeType !== ELEMENT) {\n        return false;\n      } else {\n        var elem = dom;\n        if (elem.matches !== undefined) {\n          return elem.matches(selector);\n        } else if (elem.msMatchesSelector !== undefined) {\n          return elem.msMatchesSelector(selector);\n        } else if (elem.webkitMatchesSelector !== undefined) {\n          return elem.webkitMatchesSelector(selector);\n        } else if (elem.mozMatchesSelector !== undefined) {\n          return elem.mozMatchesSelector(selector);\n        } else {\n          throw new Error('Browser lacks native selectors');\n        }\n      }\n    };\n\n    var eq = function (e1, e2) {\n      return e1.dom === e2.dom;\n    };\n    var regularContains = function (e1, e2) {\n      var d1 = e1.dom;\n      var d2 = e2.dom;\n      return d1 === d2 ? false : d1.contains(d2);\n    };\n    var ieContains = function (e1, e2) {\n      return documentPositionContainedBy(e1.dom, e2.dom);\n    };\n    var contains$1 = function (e1, e2) {\n      return detect$3().browser.isIE() ? ieContains(e1, e2) : regularContains(e1, e2);\n    };\n    var is$1 = is;\n\n    var global$1 = tinymce.util.Tools.resolve('tinymce.dom.RangeUtils');\n\n    var global$2 = tinymce.util.Tools.resolve('tinymce.dom.TreeWalker');\n\n    var global$3 = tinymce.util.Tools.resolve('tinymce.util.VK');\n\n    var keys = Object.keys;\n    var each$1 = function (obj, f) {\n      var props = keys(obj);\n      for (var k = 0, len = props.length; k < len; k++) {\n        var i = props[k];\n        var x = obj[i];\n        f(x, i);\n      }\n    };\n    var objAcc = function (r) {\n      return function (x, i) {\n        r[i] = x;\n      };\n    };\n    var internalFilter = function (obj, pred, onTrue, onFalse) {\n      var r = {};\n      each$1(obj, function (x, i) {\n        (pred(x, i) ? onTrue : onFalse)(x, i);\n      });\n      return r;\n    };\n    var filter$1 = function (obj, pred) {\n      var t = {};\n      internalFilter(obj, pred, objAcc(t), noop);\n      return t;\n    };\n\n    var Global = typeof window !== 'undefined' ? window : Function('return this;')();\n\n    var name = function (element) {\n      var r = element.dom.nodeName;\n      return r.toLowerCase();\n    };\n    var type = function (element) {\n      return element.dom.nodeType;\n    };\n    var isType$1 = function (t) {\n      return function (element) {\n        return type(element) === t;\n      };\n    };\n    var isElement = isType$1(ELEMENT);\n\n    var rawSet = function (dom, key, value) {\n      if (isString(value) || isBoolean(value) || isNumber(value)) {\n        dom.setAttribute(key, value + '');\n      } else {\n        console.error('Invalid call to Attribute.set. Key ', key, ':: Value ', value, ':: Element ', dom);\n        throw new Error('Attribute value was not simple');\n      }\n    };\n    var setAll = function (element, attrs) {\n      var dom = element.dom;\n      each$1(attrs, function (v, k) {\n        rawSet(dom, k, v);\n      });\n    };\n    var clone = function (element) {\n      return foldl(element.dom.attributes, function (acc, attr) {\n        acc[attr.name] = attr.value;\n        return acc;\n      }, {});\n    };\n\n    var parent = function (element) {\n      return Optional.from(element.dom.parentNode).map(SugarElement.fromDom);\n    };\n    var children = function (element) {\n      return map(element.dom.childNodes, SugarElement.fromDom);\n    };\n    var child = function (element, index) {\n      var cs = element.dom.childNodes;\n      return Optional.from(cs[index]).map(SugarElement.fromDom);\n    };\n    var firstChild = function (element) {\n      return child(element, 0);\n    };\n    var lastChild = function (element) {\n      return child(element, element.dom.childNodes.length - 1);\n    };\n\n    var before = function (marker, element) {\n      var parent$1 = parent(marker);\n      parent$1.each(function (v) {\n        v.dom.insertBefore(element.dom, marker.dom);\n      });\n    };\n    var append = function (parent, element) {\n      parent.dom.appendChild(element.dom);\n    };\n\n    var before$1 = function (marker, elements) {\n      each(elements, function (x) {\n        before(marker, x);\n      });\n    };\n    var append$1 = function (parent, elements) {\n      each(elements, function (x) {\n        append(parent, x);\n      });\n    };\n\n    var remove = function (element) {\n      var dom = element.dom;\n      if (dom.parentNode !== null) {\n        dom.parentNode.removeChild(dom);\n      }\n    };\n\n    var clone$1 = function (original, isDeep) {\n      return SugarElement.fromDom(original.dom.cloneNode(isDeep));\n    };\n    var deep = function (original) {\n      return clone$1(original, true);\n    };\n    var shallowAs = function (original, tag) {\n      var nu = SugarElement.fromTag(tag);\n      var attributes = clone(original);\n      setAll(nu, attributes);\n      return nu;\n    };\n    var mutate = function (original, tag) {\n      var nu = shallowAs(original, tag);\n      before(original, nu);\n      var children$1 = children(original);\n      append$1(nu, children$1);\n      remove(original);\n      return nu;\n    };\n\n    var global$4 = tinymce.util.Tools.resolve('tinymce.dom.DOMUtils');\n\n    var global$5 = tinymce.util.Tools.resolve('tinymce.util.Tools');\n\n    var matchNodeName = function (name) {\n      return function (node) {\n        return node && node.nodeName.toLowerCase() === name;\n      };\n    };\n    var matchNodeNames = function (regex) {\n      return function (node) {\n        return node && regex.test(node.nodeName);\n      };\n    };\n    var isTextNode = function (node) {\n      return node && node.nodeType === 3;\n    };\n    var isListNode = matchNodeNames(/^(OL|UL|DL)$/);\n    var isOlUlNode = matchNodeNames(/^(OL|UL)$/);\n    var isOlNode = matchNodeName('ol');\n    var isListItemNode = matchNodeNames(/^(LI|DT|DD)$/);\n    var isDlItemNode = matchNodeNames(/^(DT|DD)$/);\n    var isTableCellNode = matchNodeNames(/^(TH|TD)$/);\n    var isBr = matchNodeName('br');\n    var isFirstChild = function (node) {\n      return node.parentNode.firstChild === node;\n    };\n    var isTextBlock = function (editor, node) {\n      return node && !!editor.schema.getTextBlockElements()[node.nodeName];\n    };\n    var isBlock = function (node, blockElements) {\n      return node && node.nodeName in blockElements;\n    };\n    var isBogusBr = function (dom, node) {\n      if (!isBr(node)) {\n        return false;\n      }\n      return dom.isBlock(node.nextSibling) && !isBr(node.previousSibling);\n    };\n    var isEmpty$1 = function (dom, elm, keepBookmarks) {\n      var empty = dom.isEmpty(elm);\n      if (keepBookmarks && dom.select('span[data-mce-type=bookmark]', elm).length > 0) {\n        return false;\n      }\n      return empty;\n    };\n    var isChildOfBody = function (dom, elm) {\n      return dom.isChildOf(elm, dom.getRoot());\n    };\n\n    var shouldIndentOnTab = function (editor) {\n      return editor.getParam('lists_indent_on_tab', true);\n    };\n    var getForcedRootBlock = function (editor) {\n      var block = editor.getParam('forced_root_block', 'p');\n      if (block === false) {\n        return '';\n      } else if (block === true) {\n        return 'p';\n      } else {\n        return block;\n      }\n    };\n    var getForcedRootBlockAttrs = function (editor) {\n      return editor.getParam('forced_root_block_attrs', {});\n    };\n\n    var createTextBlock = function (editor, contentNode) {\n      var dom = editor.dom;\n      var blockElements = editor.schema.getBlockElements();\n      var fragment = dom.createFragment();\n      var blockName = getForcedRootBlock(editor);\n      var node, textBlock, hasContentNode;\n      if (blockName) {\n        textBlock = dom.create(blockName);\n        if (textBlock.tagName === blockName.toUpperCase()) {\n          dom.setAttribs(textBlock, getForcedRootBlockAttrs(editor));\n        }\n        if (!isBlock(contentNode.firstChild, blockElements)) {\n          fragment.appendChild(textBlock);\n        }\n      }\n      if (contentNode) {\n        while (node = contentNode.firstChild) {\n          var nodeName = node.nodeName;\n          if (!hasContentNode && (nodeName !== 'SPAN' || node.getAttribute('data-mce-type') !== 'bookmark')) {\n            hasContentNode = true;\n          }\n          if (isBlock(node, blockElements)) {\n            fragment.appendChild(node);\n            textBlock = null;\n          } else {\n            if (blockName) {\n              if (!textBlock) {\n                textBlock = dom.create(blockName);\n                fragment.appendChild(textBlock);\n              }\n              textBlock.appendChild(node);\n            } else {\n              fragment.appendChild(node);\n            }\n          }\n        }\n      }\n      if (!blockName) {\n        fragment.appendChild(dom.create('br'));\n      } else {\n        if (!hasContentNode) {\n          textBlock.appendChild(dom.create('br', { 'data-mce-bogus': '1' }));\n        }\n      }\n      return fragment;\n    };\n\n    var DOM = global$4.DOM;\n    var splitList = function (editor, ul, li) {\n      var removeAndKeepBookmarks = function (targetNode) {\n        global$5.each(bookmarks, function (node) {\n          targetNode.parentNode.insertBefore(node, li.parentNode);\n        });\n        DOM.remove(targetNode);\n      };\n      var bookmarks = DOM.select('span[data-mce-type=\"bookmark\"]', ul);\n      var newBlock = createTextBlock(editor, li);\n      var tmpRng = DOM.createRng();\n      tmpRng.setStartAfter(li);\n      tmpRng.setEndAfter(ul);\n      var fragment = tmpRng.extractContents();\n      for (var node = fragment.firstChild; node; node = node.firstChild) {\n        if (node.nodeName === 'LI' && editor.dom.isEmpty(node)) {\n          DOM.remove(node);\n          break;\n        }\n      }\n      if (!editor.dom.isEmpty(fragment)) {\n        DOM.insertAfter(fragment, ul);\n      }\n      DOM.insertAfter(newBlock, ul);\n      if (isEmpty$1(editor.dom, li.parentNode)) {\n        removeAndKeepBookmarks(li.parentNode);\n      }\n      DOM.remove(li);\n      if (isEmpty$1(editor.dom, ul)) {\n        DOM.remove(ul);\n      }\n    };\n\n    var outdentDlItem = function (editor, item) {\n      if (is$1(item, 'dd')) {\n        mutate(item, 'dt');\n      } else if (is$1(item, 'dt')) {\n        parent(item).each(function (dl) {\n          return splitList(editor, dl.dom, item.dom);\n        });\n      }\n    };\n    var indentDlItem = function (item) {\n      if (is$1(item, 'dt')) {\n        mutate(item, 'dd');\n      }\n    };\n    var dlIndentation = function (editor, indentation, dlItems) {\n      if (indentation === 'Indent') {\n        each(dlItems, indentDlItem);\n      } else {\n        each(dlItems, function (item) {\n          return outdentDlItem(editor, item);\n        });\n      }\n    };\n\n    var getNormalizedPoint = function (container, offset) {\n      if (isTextNode(container)) {\n        return {\n          container: container,\n          offset: offset\n        };\n      }\n      var node = global$1.getNode(container, offset);\n      if (isTextNode(node)) {\n        return {\n          container: node,\n          offset: offset >= container.childNodes.length ? node.data.length : 0\n        };\n      } else if (node.previousSibling && isTextNode(node.previousSibling)) {\n        return {\n          container: node.previousSibling,\n          offset: node.previousSibling.data.length\n        };\n      } else if (node.nextSibling && isTextNode(node.nextSibling)) {\n        return {\n          container: node.nextSibling,\n          offset: 0\n        };\n      }\n      return {\n        container: container,\n        offset: offset\n      };\n    };\n    var normalizeRange = function (rng) {\n      var outRng = rng.cloneRange();\n      var rangeStart = getNormalizedPoint(rng.startContainer, rng.startOffset);\n      outRng.setStart(rangeStart.container, rangeStart.offset);\n      var rangeEnd = getNormalizedPoint(rng.endContainer, rng.endOffset);\n      outRng.setEnd(rangeEnd.container, rangeEnd.offset);\n      return outRng;\n    };\n\n    var global$6 = tinymce.util.Tools.resolve('tinymce.dom.DomQuery');\n\n    var getParentList = function (editor, node) {\n      var selectionStart = node || editor.selection.getStart(true);\n      return editor.dom.getParent(selectionStart, 'OL,UL,DL', getClosestListRootElm(editor, selectionStart));\n    };\n    var isParentListSelected = function (parentList, selectedBlocks) {\n      return parentList && selectedBlocks.length === 1 && selectedBlocks[0] === parentList;\n    };\n    var findSubLists = function (parentList) {\n      return global$5.grep(parentList.querySelectorAll('ol,ul,dl'), function (elm) {\n        return isListNode(elm);\n      });\n    };\n    var getSelectedSubLists = function (editor) {\n      var parentList = getParentList(editor);\n      var selectedBlocks = editor.selection.getSelectedBlocks();\n      if (isParentListSelected(parentList, selectedBlocks)) {\n        return findSubLists(parentList);\n      } else {\n        return global$5.grep(selectedBlocks, function (elm) {\n          return isListNode(elm) && parentList !== elm;\n        });\n      }\n    };\n    var findParentListItemsNodes = function (editor, elms) {\n      var listItemsElms = global$5.map(elms, function (elm) {\n        var parentLi = editor.dom.getParent(elm, 'li,dd,dt', getClosestListRootElm(editor, elm));\n        return parentLi ? parentLi : elm;\n      });\n      return global$6.unique(listItemsElms);\n    };\n    var getSelectedListItems = function (editor) {\n      var selectedBlocks = editor.selection.getSelectedBlocks();\n      return global$5.grep(findParentListItemsNodes(editor, selectedBlocks), function (block) {\n        return isListItemNode(block);\n      });\n    };\n    var getSelectedDlItems = function (editor) {\n      return filter(getSelectedListItems(editor), isDlItemNode);\n    };\n    var getClosestListRootElm = function (editor, elm) {\n      var parentTableCell = editor.dom.getParents(elm, 'TD,TH');\n      var root = parentTableCell.length > 0 ? parentTableCell[0] : editor.getBody();\n      return root;\n    };\n    var findLastParentListNode = function (editor, elm) {\n      var parentLists = editor.dom.getParents(elm, 'ol,ul', getClosestListRootElm(editor, elm));\n      return last(parentLists);\n    };\n    var getSelectedLists = function (editor) {\n      var firstList = findLastParentListNode(editor, editor.selection.getStart());\n      var subsequentLists = filter(editor.selection.getSelectedBlocks(), isOlUlNode);\n      return firstList.toArray().concat(subsequentLists);\n    };\n    var getSelectedListRoots = function (editor) {\n      var selectedLists = getSelectedLists(editor);\n      return getUniqueListRoots(editor, selectedLists);\n    };\n    var getUniqueListRoots = function (editor, lists) {\n      var listRoots = map(lists, function (list) {\n        return findLastParentListNode(editor, list).getOr(list);\n      });\n      return global$6.unique(listRoots);\n    };\n\n    var lift2 = function (oa, ob, f) {\n      return oa.isSome() && ob.isSome() ? Optional.some(f(oa.getOrDie(), ob.getOrDie())) : Optional.none();\n    };\n\n    var fromElements = function (elements, scope) {\n      var doc = scope || document;\n      var fragment = doc.createDocumentFragment();\n      each(elements, function (element) {\n        fragment.appendChild(element.dom);\n      });\n      return SugarElement.fromDom(fragment);\n    };\n\n    var fireListEvent = function (editor, action, element) {\n      return editor.fire('ListMutation', {\n        action: action,\n        element: element\n      });\n    };\n\n    var isSupported = function (dom) {\n      return dom.style !== undefined && isFunction(dom.style.getPropertyValue);\n    };\n\n    var internalSet = function (dom, property, value) {\n      if (!isString(value)) {\n        console.error('Invalid call to CSS.set. Property ', property, ':: Value ', value, ':: Element ', dom);\n        throw new Error('CSS value must be a string: ' + value);\n      }\n      if (isSupported(dom)) {\n        dom.style.setProperty(property, value);\n      }\n    };\n    var set = function (element, property, value) {\n      var dom = element.dom;\n      internalSet(dom, property, value);\n    };\n\n    var joinSegment = function (parent, child) {\n      append(parent.item, child.list);\n    };\n    var joinSegments = function (segments) {\n      for (var i = 1; i < segments.length; i++) {\n        joinSegment(segments[i - 1], segments[i]);\n      }\n    };\n    var appendSegments = function (head$1, tail) {\n      lift2(last(head$1), head(tail), joinSegment);\n    };\n    var createSegment = function (scope, listType) {\n      var segment = {\n        list: SugarElement.fromTag(listType, scope),\n        item: SugarElement.fromTag('li', scope)\n      };\n      append(segment.list, segment.item);\n      return segment;\n    };\n    var createSegments = function (scope, entry, size) {\n      var segments = [];\n      for (var i = 0; i < size; i++) {\n        segments.push(createSegment(scope, entry.listType));\n      }\n      return segments;\n    };\n    var populateSegments = function (segments, entry) {\n      for (var i = 0; i < segments.length - 1; i++) {\n        set(segments[i].item, 'list-style-type', 'none');\n      }\n      last(segments).each(function (segment) {\n        setAll(segment.list, entry.listAttributes);\n        setAll(segment.item, entry.itemAttributes);\n        append$1(segment.item, entry.content);\n      });\n    };\n    var normalizeSegment = function (segment, entry) {\n      if (name(segment.list) !== entry.listType) {\n        segment.list = mutate(segment.list, entry.listType);\n      }\n      setAll(segment.list, entry.listAttributes);\n    };\n    var createItem = function (scope, attr, content) {\n      var item = SugarElement.fromTag('li', scope);\n      setAll(item, attr);\n      append$1(item, content);\n      return item;\n    };\n    var appendItem = function (segment, item) {\n      append(segment.list, item);\n      segment.item = item;\n    };\n    var writeShallow = function (scope, cast, entry) {\n      var newCast = cast.slice(0, entry.depth);\n      last(newCast).each(function (segment) {\n        var item = createItem(scope, entry.itemAttributes, entry.content);\n        appendItem(segment, item);\n        normalizeSegment(segment, entry);\n      });\n      return newCast;\n    };\n    var writeDeep = function (scope, cast, entry) {\n      var segments = createSegments(scope, entry, entry.depth - cast.length);\n      joinSegments(segments);\n      populateSegments(segments, entry);\n      appendSegments(cast, segments);\n      return cast.concat(segments);\n    };\n    var composeList = function (scope, entries) {\n      var cast = foldl(entries, function (cast, entry) {\n        return entry.depth > cast.length ? writeDeep(scope, cast, entry) : writeShallow(scope, cast, entry);\n      }, []);\n      return head(cast).map(function (segment) {\n        return segment.list;\n      });\n    };\n\n    var isList = function (el) {\n      return is$1(el, 'OL,UL');\n    };\n    var hasFirstChildList = function (el) {\n      return firstChild(el).map(isList).getOr(false);\n    };\n    var hasLastChildList = function (el) {\n      return lastChild(el).map(isList).getOr(false);\n    };\n\n    var isIndented = function (entry) {\n      return entry.depth > 0;\n    };\n    var isSelected = function (entry) {\n      return entry.isSelected;\n    };\n    var cloneItemContent = function (li) {\n      var children$1 = children(li);\n      var content = hasLastChildList(li) ? children$1.slice(0, -1) : children$1;\n      return map(content, deep);\n    };\n    var createEntry = function (li, depth, isSelected) {\n      return parent(li).filter(isElement).map(function (list) {\n        return {\n          depth: depth,\n          dirty: false,\n          isSelected: isSelected,\n          content: cloneItemContent(li),\n          itemAttributes: clone(li),\n          listAttributes: clone(list),\n          listType: name(list)\n        };\n      });\n    };\n\n    var indentEntry = function (indentation, entry) {\n      switch (indentation) {\n      case 'Indent':\n        entry.depth++;\n        break;\n      case 'Outdent':\n        entry.depth--;\n        break;\n      case 'Flatten':\n        entry.depth = 0;\n      }\n      entry.dirty = true;\n    };\n\n    var cloneListProperties = function (target, source) {\n      target.listType = source.listType;\n      target.listAttributes = __assign({}, source.listAttributes);\n    };\n    var cleanListProperties = function (entry) {\n      entry.listAttributes = filter$1(entry.listAttributes, function (_value, key) {\n        return key !== 'start';\n      });\n    };\n    var closestSiblingEntry = function (entries, start) {\n      var depth = entries[start].depth;\n      var matches = function (entry) {\n        return entry.depth === depth && !entry.dirty;\n      };\n      var until = function (entry) {\n        return entry.depth < depth;\n      };\n      return findUntil(reverse(entries.slice(0, start)), matches, until).orThunk(function () {\n        return findUntil(entries.slice(start + 1), matches, until);\n      });\n    };\n    var normalizeEntries = function (entries) {\n      each(entries, function (entry, i) {\n        closestSiblingEntry(entries, i).fold(function () {\n          if (entry.dirty) {\n            cleanListProperties(entry);\n          }\n        }, function (matchingEntry) {\n          return cloneListProperties(entry, matchingEntry);\n        });\n      });\n      return entries;\n    };\n\n    var Cell = function (initial) {\n      var value = initial;\n      var get = function () {\n        return value;\n      };\n      var set = function (v) {\n        value = v;\n      };\n      return {\n        get: get,\n        set: set\n      };\n    };\n\n    var parseItem = function (depth, itemSelection, selectionState, item) {\n      return firstChild(item).filter(isList).fold(function () {\n        itemSelection.each(function (selection) {\n          if (eq(selection.start, item)) {\n            selectionState.set(true);\n          }\n        });\n        var currentItemEntry = createEntry(item, depth, selectionState.get());\n        itemSelection.each(function (selection) {\n          if (eq(selection.end, item)) {\n            selectionState.set(false);\n          }\n        });\n        var childListEntries = lastChild(item).filter(isList).map(function (list) {\n          return parseList(depth, itemSelection, selectionState, list);\n        }).getOr([]);\n        return currentItemEntry.toArray().concat(childListEntries);\n      }, function (list) {\n        return parseList(depth, itemSelection, selectionState, list);\n      });\n    };\n    var parseList = function (depth, itemSelection, selectionState, list) {\n      return bind(children(list), function (element) {\n        var parser = isList(element) ? parseList : parseItem;\n        var newDepth = depth + 1;\n        return parser(newDepth, itemSelection, selectionState, element);\n      });\n    };\n    var parseLists = function (lists, itemSelection) {\n      var selectionState = Cell(false);\n      var initialDepth = 0;\n      return map(lists, function (list) {\n        return {\n          sourceList: list,\n          entries: parseList(initialDepth, itemSelection, selectionState, list)\n        };\n      });\n    };\n\n    var outdentedComposer = function (editor, entries) {\n      var normalizedEntries = normalizeEntries(entries);\n      return map(normalizedEntries, function (entry) {\n        var content = fromElements(entry.content);\n        return SugarElement.fromDom(createTextBlock(editor, content.dom));\n      });\n    };\n    var indentedComposer = function (editor, entries) {\n      var normalizedEntries = normalizeEntries(entries);\n      return composeList(editor.contentDocument, normalizedEntries).toArray();\n    };\n    var composeEntries = function (editor, entries) {\n      return bind(groupBy(entries, isIndented), function (entries) {\n        var groupIsIndented = head(entries).map(isIndented).getOr(false);\n        return groupIsIndented ? indentedComposer(editor, entries) : outdentedComposer(editor, entries);\n      });\n    };\n    var indentSelectedEntries = function (entries, indentation) {\n      each(filter(entries, isSelected), function (entry) {\n        return indentEntry(indentation, entry);\n      });\n    };\n    var getItemSelection = function (editor) {\n      var selectedListItems = map(getSelectedListItems(editor), SugarElement.fromDom);\n      return lift2(find(selectedListItems, not(hasFirstChildList)), find(reverse(selectedListItems), not(hasFirstChildList)), function (start, end) {\n        return {\n          start: start,\n          end: end\n        };\n      });\n    };\n    var listIndentation = function (editor, lists, indentation) {\n      var entrySets = parseLists(lists, getItemSelection(editor));\n      each(entrySets, function (entrySet) {\n        indentSelectedEntries(entrySet.entries, indentation);\n        var composedLists = composeEntries(editor, entrySet.entries);\n        each(composedLists, function (composedList) {\n          fireListEvent(editor, indentation === 'Indent' ? 'IndentList' : 'OutdentList', composedList.dom);\n        });\n        before$1(entrySet.sourceList, composedLists);\n        remove(entrySet.sourceList);\n      });\n    };\n\n    var selectionIndentation = function (editor, indentation) {\n      var lists = map(getSelectedListRoots(editor), SugarElement.fromDom);\n      var dlItems = map(getSelectedDlItems(editor), SugarElement.fromDom);\n      var isHandled = false;\n      if (lists.length || dlItems.length) {\n        var bookmark = editor.selection.getBookmark();\n        listIndentation(editor, lists, indentation);\n        dlIndentation(editor, indentation, dlItems);\n        editor.selection.moveToBookmark(bookmark);\n        editor.selection.setRng(normalizeRange(editor.selection.getRng()));\n        editor.nodeChanged();\n        isHandled = true;\n      }\n      return isHandled;\n    };\n    var indentListSelection = function (editor) {\n      return selectionIndentation(editor, 'Indent');\n    };\n    var outdentListSelection = function (editor) {\n      return selectionIndentation(editor, 'Outdent');\n    };\n    var flattenListSelection = function (editor) {\n      return selectionIndentation(editor, 'Flatten');\n    };\n\n    var global$7 = tinymce.util.Tools.resolve('tinymce.dom.BookmarkManager');\n\n    var DOM$1 = global$4.DOM;\n    var createBookmark = function (rng) {\n      var bookmark = {};\n      var setupEndPoint = function (start) {\n        var offsetNode, container, offset;\n        container = rng[start ? 'startContainer' : 'endContainer'];\n        offset = rng[start ? 'startOffset' : 'endOffset'];\n        if (container.nodeType === 1) {\n          offsetNode = DOM$1.create('span', { 'data-mce-type': 'bookmark' });\n          if (container.hasChildNodes()) {\n            offset = Math.min(offset, container.childNodes.length - 1);\n            if (start) {\n              container.insertBefore(offsetNode, container.childNodes[offset]);\n            } else {\n              DOM$1.insertAfter(offsetNode, container.childNodes[offset]);\n            }\n          } else {\n            container.appendChild(offsetNode);\n          }\n          container = offsetNode;\n          offset = 0;\n        }\n        bookmark[start ? 'startContainer' : 'endContainer'] = container;\n        bookmark[start ? 'startOffset' : 'endOffset'] = offset;\n      };\n      setupEndPoint(true);\n      if (!rng.collapsed) {\n        setupEndPoint();\n      }\n      return bookmark;\n    };\n    var resolveBookmark = function (bookmark) {\n      var restoreEndPoint = function (start) {\n        var container, offset, node;\n        var nodeIndex = function (container) {\n          var node = container.parentNode.firstChild, idx = 0;\n          while (node) {\n            if (node === container) {\n              return idx;\n            }\n            if (node.nodeType !== 1 || node.getAttribute('data-mce-type') !== 'bookmark') {\n              idx++;\n            }\n            node = node.nextSibling;\n          }\n          return -1;\n        };\n        container = node = bookmark[start ? 'startContainer' : 'endContainer'];\n        offset = bookmark[start ? 'startOffset' : 'endOffset'];\n        if (!container) {\n          return;\n        }\n        if (container.nodeType === 1) {\n          offset = nodeIndex(container);\n          container = container.parentNode;\n          DOM$1.remove(node);\n          if (!container.hasChildNodes() && DOM$1.isBlock(container)) {\n            container.appendChild(DOM$1.create('br'));\n          }\n        }\n        bookmark[start ? 'startContainer' : 'endContainer'] = container;\n        bookmark[start ? 'startOffset' : 'endOffset'] = offset;\n      };\n      restoreEndPoint(true);\n      restoreEndPoint();\n      var rng = DOM$1.createRng();\n      rng.setStart(bookmark.startContainer, bookmark.startOffset);\n      if (bookmark.endContainer) {\n        rng.setEnd(bookmark.endContainer, bookmark.endOffset);\n      }\n      return normalizeRange(rng);\n    };\n\n    var listToggleActionFromListName = function (listName) {\n      switch (listName) {\n      case 'UL':\n        return 'ToggleUlList';\n      case 'OL':\n        return 'ToggleOlList';\n      case 'DL':\n        return 'ToggleDLList';\n      }\n    };\n\n    var isCustomList = function (list) {\n      return /\\btox\\-/.test(list.className);\n    };\n    var listState = function (editor, listName, activate) {\n      var nodeChangeHandler = function (e) {\n        var inList = findUntil(e.parents, isListNode, isTableCellNode).filter(function (list) {\n          return list.nodeName === listName && !isCustomList(list);\n        }).isSome();\n        activate(inList);\n      };\n      var parents = editor.dom.getParents(editor.selection.getNode());\n      nodeChangeHandler({ parents: parents });\n      editor.on('NodeChange', nodeChangeHandler);\n      return function () {\n        return editor.off('NodeChange', nodeChangeHandler);\n      };\n    };\n\n    var updateListStyle = function (dom, el, detail) {\n      var type = detail['list-style-type'] ? detail['list-style-type'] : null;\n      dom.setStyle(el, 'list-style-type', type);\n    };\n    var setAttribs = function (elm, attrs) {\n      global$5.each(attrs, function (value, key) {\n        elm.setAttribute(key, value);\n      });\n    };\n    var updateListAttrs = function (dom, el, detail) {\n      setAttribs(el, detail['list-attributes']);\n      global$5.each(dom.select('li', el), function (li) {\n        setAttribs(li, detail['list-item-attributes']);\n      });\n    };\n    var updateListWithDetails = function (dom, el, detail) {\n      updateListStyle(dom, el, detail);\n      updateListAttrs(dom, el, detail);\n    };\n    var removeStyles = function (dom, element, styles) {\n      global$5.each(styles, function (style) {\n        var _a;\n        return dom.setStyle(element, (_a = {}, _a[style] = '', _a));\n      });\n    };\n    var getEndPointNode = function (editor, rng, start, root) {\n      var container = rng[start ? 'startContainer' : 'endContainer'];\n      var offset = rng[start ? 'startOffset' : 'endOffset'];\n      if (container.nodeType === 1) {\n        container = container.childNodes[Math.min(offset, container.childNodes.length - 1)] || container;\n      }\n      if (!start && isBr(container.nextSibling)) {\n        container = container.nextSibling;\n      }\n      while (container.parentNode !== root) {\n        if (isTextBlock(editor, container)) {\n          return container;\n        }\n        if (/^(TD|TH)$/.test(container.parentNode.nodeName)) {\n          return container;\n        }\n        container = container.parentNode;\n      }\n      return container;\n    };\n    var getSelectedTextBlocks = function (editor, rng, root) {\n      var textBlocks = [], dom = editor.dom;\n      var startNode = getEndPointNode(editor, rng, true, root);\n      var endNode = getEndPointNode(editor, rng, false, root);\n      var block;\n      var siblings = [];\n      for (var node = startNode; node; node = node.nextSibling) {\n        siblings.push(node);\n        if (node === endNode) {\n          break;\n        }\n      }\n      global$5.each(siblings, function (node) {\n        if (isTextBlock(editor, node)) {\n          textBlocks.push(node);\n          block = null;\n          return;\n        }\n        if (dom.isBlock(node) || isBr(node)) {\n          if (isBr(node)) {\n            dom.remove(node);\n          }\n          block = null;\n          return;\n        }\n        var nextSibling = node.nextSibling;\n        if (global$7.isBookmarkNode(node)) {\n          if (isListNode(nextSibling) || isTextBlock(editor, nextSibling) || !nextSibling && node.parentNode === root) {\n            block = null;\n            return;\n          }\n        }\n        if (!block) {\n          block = dom.create('p');\n          node.parentNode.insertBefore(block, node);\n          textBlocks.push(block);\n        }\n        block.appendChild(node);\n      });\n      return textBlocks;\n    };\n    var hasCompatibleStyle = function (dom, sib, detail) {\n      var sibStyle = dom.getStyle(sib, 'list-style-type');\n      var detailStyle = detail ? detail['list-style-type'] : '';\n      detailStyle = detailStyle === null ? '' : detailStyle;\n      return sibStyle === detailStyle;\n    };\n    var applyList = function (editor, listName, detail) {\n      var rng = editor.selection.getRng();\n      var listItemName = 'LI';\n      var root = getClosestListRootElm(editor, editor.selection.getStart(true));\n      var dom = editor.dom;\n      if (dom.getContentEditable(editor.selection.getNode()) === 'false') {\n        return;\n      }\n      listName = listName.toUpperCase();\n      if (listName === 'DL') {\n        listItemName = 'DT';\n      }\n      var bookmark = createBookmark(rng);\n      var selectedTextBlocks = getSelectedTextBlocks(editor, rng, root);\n      global$5.each(selectedTextBlocks, function (block) {\n        var listBlock;\n        var sibling = block.previousSibling;\n        var parent = block.parentNode;\n        if (!isListItemNode(parent)) {\n          if (sibling && isListNode(sibling) && sibling.nodeName === listName && hasCompatibleStyle(dom, sibling, detail)) {\n            listBlock = sibling;\n            block = dom.rename(block, listItemName);\n            sibling.appendChild(block);\n          } else {\n            listBlock = dom.create(listName);\n            block.parentNode.insertBefore(listBlock, block);\n            listBlock.appendChild(block);\n            block = dom.rename(block, listItemName);\n          }\n          removeStyles(dom, block, [\n            'margin',\n            'margin-right',\n            'margin-bottom',\n            'margin-left',\n            'margin-top',\n            'padding',\n            'padding-right',\n            'padding-bottom',\n            'padding-left',\n            'padding-top'\n          ]);\n          updateListWithDetails(dom, listBlock, detail);\n          mergeWithAdjacentLists(editor.dom, listBlock);\n        }\n      });\n      editor.selection.setRng(resolveBookmark(bookmark));\n    };\n    var isValidLists = function (list1, list2) {\n      return list1 && list2 && isListNode(list1) && list1.nodeName === list2.nodeName;\n    };\n    var hasSameListStyle = function (dom, list1, list2) {\n      var targetStyle = dom.getStyle(list1, 'list-style-type', true);\n      var style = dom.getStyle(list2, 'list-style-type', true);\n      return targetStyle === style;\n    };\n    var hasSameClasses = function (elm1, elm2) {\n      return elm1.className === elm2.className;\n    };\n    var shouldMerge = function (dom, list1, list2) {\n      return isValidLists(list1, list2) && hasSameListStyle(dom, list1, list2) && hasSameClasses(list1, list2);\n    };\n    var mergeWithAdjacentLists = function (dom, listBlock) {\n      var sibling, node;\n      sibling = listBlock.nextSibling;\n      if (shouldMerge(dom, listBlock, sibling)) {\n        while (node = sibling.firstChild) {\n          listBlock.appendChild(node);\n        }\n        dom.remove(sibling);\n      }\n      sibling = listBlock.previousSibling;\n      if (shouldMerge(dom, listBlock, sibling)) {\n        while (node = sibling.lastChild) {\n          listBlock.insertBefore(node, listBlock.firstChild);\n        }\n        dom.remove(sibling);\n      }\n    };\n    var updateList = function (editor, list, listName, detail) {\n      if (list.nodeName !== listName) {\n        var newList = editor.dom.rename(list, listName);\n        updateListWithDetails(editor.dom, newList, detail);\n        fireListEvent(editor, listToggleActionFromListName(listName), newList);\n      } else {\n        updateListWithDetails(editor.dom, list, detail);\n        fireListEvent(editor, listToggleActionFromListName(listName), list);\n      }\n    };\n    var toggleMultipleLists = function (editor, parentList, lists, listName, detail) {\n      var parentIsList = isListNode(parentList);\n      if (parentIsList && parentList.nodeName === listName && !hasListStyleDetail(detail)) {\n        flattenListSelection(editor);\n      } else {\n        applyList(editor, listName, detail);\n        var bookmark = createBookmark(editor.selection.getRng(true));\n        var allLists = parentIsList ? __spreadArrays([parentList], lists) : lists;\n        global$5.each(allLists, function (elm) {\n          updateList(editor, elm, listName, detail);\n        });\n        editor.selection.setRng(resolveBookmark(bookmark));\n      }\n    };\n    var hasListStyleDetail = function (detail) {\n      return 'list-style-type' in detail;\n    };\n    var toggleSingleList = function (editor, parentList, listName, detail) {\n      if (parentList === editor.getBody()) {\n        return;\n      }\n      if (parentList) {\n        if (parentList.nodeName === listName && !hasListStyleDetail(detail) && !isCustomList(parentList)) {\n          flattenListSelection(editor);\n        } else {\n          var bookmark = createBookmark(editor.selection.getRng(true));\n          updateListWithDetails(editor.dom, parentList, detail);\n          var newList = editor.dom.rename(parentList, listName);\n          mergeWithAdjacentLists(editor.dom, newList);\n          editor.selection.setRng(resolveBookmark(bookmark));\n          applyList(editor, listName, detail);\n          fireListEvent(editor, listToggleActionFromListName(listName), newList);\n        }\n      } else {\n        applyList(editor, listName, detail);\n        fireListEvent(editor, listToggleActionFromListName(listName), parentList);\n      }\n    };\n    var toggleList = function (editor, listName, _detail) {\n      var parentList = getParentList(editor);\n      var selectedSubLists = getSelectedSubLists(editor);\n      var detail = isObject(_detail) ? _detail : {};\n      if (selectedSubLists.length > 0) {\n        toggleMultipleLists(editor, parentList, selectedSubLists, listName, detail);\n      } else {\n        toggleSingleList(editor, parentList, listName, detail);\n      }\n    };\n\n    var DOM$2 = global$4.DOM;\n    var normalizeList = function (dom, ul) {\n      var sibling;\n      var parentNode = ul.parentNode;\n      if (parentNode.nodeName === 'LI' && parentNode.firstChild === ul) {\n        sibling = parentNode.previousSibling;\n        if (sibling && sibling.nodeName === 'LI') {\n          sibling.appendChild(ul);\n          if (isEmpty$1(dom, parentNode)) {\n            DOM$2.remove(parentNode);\n          }\n        } else {\n          DOM$2.setStyle(parentNode, 'listStyleType', 'none');\n        }\n      }\n      if (isListNode(parentNode)) {\n        sibling = parentNode.previousSibling;\n        if (sibling && sibling.nodeName === 'LI') {\n          sibling.appendChild(ul);\n        }\n      }\n    };\n    var normalizeLists = function (dom, element) {\n      global$5.each(global$5.grep(dom.select('ol,ul', element)), function (ul) {\n        normalizeList(dom, ul);\n      });\n    };\n\n    var findNextCaretContainer = function (editor, rng, isForward, root) {\n      var node = rng.startContainer;\n      var offset = rng.startOffset;\n      if (isTextNode(node) && (isForward ? offset < node.data.length : offset > 0)) {\n        return node;\n      }\n      var nonEmptyBlocks = editor.schema.getNonEmptyElements();\n      if (node.nodeType === 1) {\n        node = global$1.getNode(node, offset);\n      }\n      var walker = new global$2(node, root);\n      if (isForward) {\n        if (isBogusBr(editor.dom, node)) {\n          walker.next();\n        }\n      }\n      while (node = walker[isForward ? 'next' : 'prev2']()) {\n        if (node.nodeName === 'LI' && !node.hasChildNodes()) {\n          return node;\n        }\n        if (nonEmptyBlocks[node.nodeName]) {\n          return node;\n        }\n        if (isTextNode(node) && node.data.length > 0) {\n          return node;\n        }\n      }\n    };\n    var hasOnlyOneBlockChild = function (dom, elm) {\n      var childNodes = elm.childNodes;\n      return childNodes.length === 1 && !isListNode(childNodes[0]) && dom.isBlock(childNodes[0]);\n    };\n    var unwrapSingleBlockChild = function (dom, elm) {\n      if (hasOnlyOneBlockChild(dom, elm)) {\n        dom.remove(elm.firstChild, true);\n      }\n    };\n    var moveChildren = function (dom, fromElm, toElm) {\n      var node;\n      var targetElm = hasOnlyOneBlockChild(dom, toElm) ? toElm.firstChild : toElm;\n      unwrapSingleBlockChild(dom, fromElm);\n      if (!isEmpty$1(dom, fromElm, true)) {\n        while (node = fromElm.firstChild) {\n          targetElm.appendChild(node);\n        }\n      }\n    };\n    var mergeLiElements = function (dom, fromElm, toElm) {\n      var listNode;\n      var ul = fromElm.parentNode;\n      if (!isChildOfBody(dom, fromElm) || !isChildOfBody(dom, toElm)) {\n        return;\n      }\n      if (isListNode(toElm.lastChild)) {\n        listNode = toElm.lastChild;\n      }\n      if (ul === toElm.lastChild) {\n        if (isBr(ul.previousSibling)) {\n          dom.remove(ul.previousSibling);\n        }\n      }\n      var node = toElm.lastChild;\n      if (node && isBr(node) && fromElm.hasChildNodes()) {\n        dom.remove(node);\n      }\n      if (isEmpty$1(dom, toElm, true)) {\n        dom.$(toElm).empty();\n      }\n      moveChildren(dom, fromElm, toElm);\n      if (listNode) {\n        toElm.appendChild(listNode);\n      }\n      var contains = contains$1(SugarElement.fromDom(toElm), SugarElement.fromDom(fromElm));\n      var nestedLists = contains ? dom.getParents(fromElm, isListNode, toElm) : [];\n      dom.remove(fromElm);\n      each(nestedLists, function (list) {\n        if (isEmpty$1(dom, list) && list !== dom.getRoot()) {\n          dom.remove(list);\n        }\n      });\n    };\n    var mergeIntoEmptyLi = function (editor, fromLi, toLi) {\n      editor.dom.$(toLi).empty();\n      mergeLiElements(editor.dom, fromLi, toLi);\n      editor.selection.setCursorLocation(toLi, 0);\n    };\n    var mergeForward = function (editor, rng, fromLi, toLi) {\n      var dom = editor.dom;\n      if (dom.isEmpty(toLi)) {\n        mergeIntoEmptyLi(editor, fromLi, toLi);\n      } else {\n        var bookmark = createBookmark(rng);\n        mergeLiElements(dom, fromLi, toLi);\n        editor.selection.setRng(resolveBookmark(bookmark));\n      }\n    };\n    var mergeBackward = function (editor, rng, fromLi, toLi) {\n      var bookmark = createBookmark(rng);\n      mergeLiElements(editor.dom, fromLi, toLi);\n      var resolvedBookmark = resolveBookmark(bookmark);\n      editor.selection.setRng(resolvedBookmark);\n    };\n    var backspaceDeleteFromListToListCaret = function (editor, isForward) {\n      var dom = editor.dom, selection = editor.selection;\n      var selectionStartElm = selection.getStart();\n      var root = getClosestListRootElm(editor, selectionStartElm);\n      var li = dom.getParent(selection.getStart(), 'LI', root);\n      if (li) {\n        var ul = li.parentNode;\n        if (ul === editor.getBody() && isEmpty$1(dom, ul)) {\n          return true;\n        }\n        var rng_1 = normalizeRange(selection.getRng());\n        var otherLi_1 = dom.getParent(findNextCaretContainer(editor, rng_1, isForward, root), 'LI', root);\n        if (otherLi_1 && otherLi_1 !== li) {\n          editor.undoManager.transact(function () {\n            if (isForward) {\n              mergeForward(editor, rng_1, otherLi_1, li);\n            } else {\n              if (isFirstChild(li)) {\n                outdentListSelection(editor);\n              } else {\n                mergeBackward(editor, rng_1, li, otherLi_1);\n              }\n            }\n          });\n          return true;\n        } else if (!otherLi_1) {\n          if (!isForward && rng_1.startOffset === 0 && rng_1.endOffset === 0) {\n            editor.undoManager.transact(function () {\n              flattenListSelection(editor);\n            });\n            return true;\n          }\n        }\n      }\n      return false;\n    };\n    var removeBlock = function (dom, block, root) {\n      var parentBlock = dom.getParent(block.parentNode, dom.isBlock, root);\n      dom.remove(block);\n      if (parentBlock && dom.isEmpty(parentBlock)) {\n        dom.remove(parentBlock);\n      }\n    };\n    var backspaceDeleteIntoListCaret = function (editor, isForward) {\n      var dom = editor.dom;\n      var selectionStartElm = editor.selection.getStart();\n      var root = getClosestListRootElm(editor, selectionStartElm);\n      var block = dom.getParent(selectionStartElm, dom.isBlock, root);\n      if (block && dom.isEmpty(block)) {\n        var rng = normalizeRange(editor.selection.getRng());\n        var otherLi_2 = dom.getParent(findNextCaretContainer(editor, rng, isForward, root), 'LI', root);\n        if (otherLi_2) {\n          editor.undoManager.transact(function () {\n            removeBlock(dom, block, root);\n            mergeWithAdjacentLists(dom, otherLi_2.parentNode);\n            editor.selection.select(otherLi_2, true);\n            editor.selection.collapse(isForward);\n          });\n          return true;\n        }\n      }\n      return false;\n    };\n    var backspaceDeleteCaret = function (editor, isForward) {\n      return backspaceDeleteFromListToListCaret(editor, isForward) || backspaceDeleteIntoListCaret(editor, isForward);\n    };\n    var backspaceDeleteRange = function (editor) {\n      var selectionStartElm = editor.selection.getStart();\n      var root = getClosestListRootElm(editor, selectionStartElm);\n      var startListParent = editor.dom.getParent(selectionStartElm, 'LI,DT,DD', root);\n      if (startListParent || getSelectedListItems(editor).length > 0) {\n        editor.undoManager.transact(function () {\n          editor.execCommand('Delete');\n          normalizeLists(editor.dom, editor.getBody());\n        });\n        return true;\n      }\n      return false;\n    };\n    var backspaceDelete = function (editor, isForward) {\n      return editor.selection.isCollapsed() ? backspaceDeleteCaret(editor, isForward) : backspaceDeleteRange(editor);\n    };\n    var setup = function (editor) {\n      editor.on('keydown', function (e) {\n        if (e.keyCode === global$3.BACKSPACE) {\n          if (backspaceDelete(editor, false)) {\n            e.preventDefault();\n          }\n        } else if (e.keyCode === global$3.DELETE) {\n          if (backspaceDelete(editor, true)) {\n            e.preventDefault();\n          }\n        }\n      });\n    };\n\n    var get$1 = function (editor) {\n      return {\n        backspaceDelete: function (isForward) {\n          backspaceDelete(editor, isForward);\n        }\n      };\n    };\n\n    var updateList$1 = function (editor, update) {\n      var parentList = getParentList(editor);\n      editor.undoManager.transact(function () {\n        if (isObject(update.styles)) {\n          editor.dom.setStyles(parentList, update.styles);\n        }\n        if (isObject(update.attrs)) {\n          each$1(update.attrs, function (v, k) {\n            return editor.dom.setAttrib(parentList, k, v);\n          });\n        }\n      });\n    };\n\n    var parseAlphabeticBase26 = function (str) {\n      var chars = reverse(trim(str).split(''));\n      var values = map(chars, function (char, i) {\n        var charValue = char.toUpperCase().charCodeAt(0) - 'A'.charCodeAt(0) + 1;\n        return Math.pow(26, i) * charValue;\n      });\n      return foldl(values, function (sum, v) {\n        return sum + v;\n      }, 0);\n    };\n    var composeAlphabeticBase26 = function (value) {\n      value--;\n      if (value < 0) {\n        return '';\n      } else {\n        var remainder = value % 26;\n        var quotient = Math.floor(value / 26);\n        var rest = composeAlphabeticBase26(quotient);\n        var char = String.fromCharCode('A'.charCodeAt(0) + remainder);\n        return rest + char;\n      }\n    };\n    var isUppercase = function (str) {\n      return /^[A-Z]+$/.test(str);\n    };\n    var isLowercase = function (str) {\n      return /^[a-z]+$/.test(str);\n    };\n    var isNumeric = function (str) {\n      return /^[0-9]+$/.test(str);\n    };\n    var deduceListType = function (start) {\n      if (isNumeric(start)) {\n        return 2;\n      } else if (isUppercase(start)) {\n        return 0;\n      } else if (isLowercase(start)) {\n        return 1;\n      } else if (isEmpty(start)) {\n        return 3;\n      } else {\n        return 4;\n      }\n    };\n    var parseStartValue = function (start) {\n      switch (deduceListType(start)) {\n      case 2:\n        return Optional.some({\n          listStyleType: Optional.none(),\n          start: start\n        });\n      case 0:\n        return Optional.some({\n          listStyleType: Optional.some('upper-alpha'),\n          start: parseAlphabeticBase26(start).toString()\n        });\n      case 1:\n        return Optional.some({\n          listStyleType: Optional.some('lower-alpha'),\n          start: parseAlphabeticBase26(start).toString()\n        });\n      case 3:\n        return Optional.some({\n          listStyleType: Optional.none(),\n          start: ''\n        });\n      case 4:\n        return Optional.none();\n      }\n    };\n    var parseDetail = function (detail) {\n      var start = parseInt(detail.start, 10);\n      if (detail.listStyleType.is('upper-alpha')) {\n        return composeAlphabeticBase26(start);\n      } else if (detail.listStyleType.is('lower-alpha')) {\n        return composeAlphabeticBase26(start).toLowerCase();\n      } else {\n        return detail.start;\n      }\n    };\n\n    var open = function (editor) {\n      var currentList = getParentList(editor);\n      if (!isOlNode(currentList)) {\n        return;\n      }\n      editor.windowManager.open({\n        title: 'List Properties',\n        body: {\n          type: 'panel',\n          items: [{\n              type: 'input',\n              name: 'start',\n              label: 'Start list at number',\n              inputMode: 'numeric'\n            }]\n        },\n        initialData: {\n          start: parseDetail({\n            start: editor.dom.getAttrib(currentList, 'start', '1'),\n            listStyleType: Optional.some(editor.dom.getStyle(currentList, 'list-style-type'))\n          })\n        },\n        buttons: [\n          {\n            type: 'cancel',\n            name: 'cancel',\n            text: 'Cancel'\n          },\n          {\n            type: 'submit',\n            name: 'save',\n            text: 'Save',\n            primary: true\n          }\n        ],\n        onSubmit: function (api) {\n          var data = api.getData();\n          parseStartValue(data.start).each(function (detail) {\n            editor.execCommand('mceListUpdate', false, {\n              attrs: { start: detail.start === '1' ? '' : detail.start },\n              styles: { 'list-style-type': detail.listStyleType.getOr('') }\n            });\n          });\n          api.close();\n        }\n      });\n    };\n\n    var queryListCommandState = function (editor, listName) {\n      return function () {\n        var parentList = getParentList(editor);\n        return parentList && parentList.nodeName === listName;\n      };\n    };\n    var registerDialog = function (editor) {\n      editor.addCommand('mceListProps', function () {\n        open(editor);\n      });\n    };\n    var register = function (editor) {\n      editor.on('BeforeExecCommand', function (e) {\n        var cmd = e.command.toLowerCase();\n        if (cmd === 'indent') {\n          indentListSelection(editor);\n        } else if (cmd === 'outdent') {\n          outdentListSelection(editor);\n        }\n      });\n      editor.addCommand('InsertUnorderedList', function (ui, detail) {\n        toggleList(editor, 'UL', detail);\n      });\n      editor.addCommand('InsertOrderedList', function (ui, detail) {\n        toggleList(editor, 'OL', detail);\n      });\n      editor.addCommand('InsertDefinitionList', function (ui, detail) {\n        toggleList(editor, 'DL', detail);\n      });\n      editor.addCommand('RemoveList', function () {\n        flattenListSelection(editor);\n      });\n      registerDialog(editor);\n      editor.addCommand('mceListUpdate', function (ui, detail) {\n        if (isObject(detail)) {\n          updateList$1(editor, detail);\n        }\n      });\n      editor.addQueryStateHandler('InsertUnorderedList', queryListCommandState(editor, 'UL'));\n      editor.addQueryStateHandler('InsertOrderedList', queryListCommandState(editor, 'OL'));\n      editor.addQueryStateHandler('InsertDefinitionList', queryListCommandState(editor, 'DL'));\n    };\n\n    var setupTabKey = function (editor) {\n      editor.on('keydown', function (e) {\n        if (e.keyCode !== global$3.TAB || global$3.metaKeyPressed(e)) {\n          return;\n        }\n        editor.undoManager.transact(function () {\n          if (e.shiftKey ? outdentListSelection(editor) : indentListSelection(editor)) {\n            e.preventDefault();\n          }\n        });\n      });\n    };\n    var setup$1 = function (editor) {\n      if (shouldIndentOnTab(editor)) {\n        setupTabKey(editor);\n      }\n      setup(editor);\n    };\n\n    var register$1 = function (editor) {\n      var exec = function (command) {\n        return function () {\n          return editor.execCommand(command);\n        };\n      };\n      if (!editor.hasPlugin('advlist')) {\n        editor.ui.registry.addToggleButton('numlist', {\n          icon: 'ordered-list',\n          active: false,\n          tooltip: 'Numbered list',\n          onAction: exec('InsertOrderedList'),\n          onSetup: function (api) {\n            return listState(editor, 'OL', api.setActive);\n          }\n        });\n        editor.ui.registry.addToggleButton('bullist', {\n          icon: 'unordered-list',\n          active: false,\n          tooltip: 'Bullet list',\n          onAction: exec('InsertUnorderedList'),\n          onSetup: function (api) {\n            return listState(editor, 'UL', api.setActive);\n          }\n        });\n      }\n    };\n\n    var register$2 = function (editor) {\n      var listProperties = {\n        text: 'List properties...',\n        icon: 'ordered-list',\n        onAction: function () {\n          return editor.execCommand('mceListProps');\n        },\n        onSetup: function (api) {\n          return listState(editor, 'OL', function (active) {\n            return api.setDisabled(!active);\n          });\n        }\n      };\n      editor.ui.registry.addMenuItem('listprops', listProperties);\n      editor.ui.registry.addContextMenu('lists', {\n        update: function (node) {\n          var parentList = getParentList(editor, node);\n          return isOlNode(parentList) ? ['listprops'] : [];\n        }\n      });\n    };\n\n    function Plugin () {\n      global.add('lists', function (editor) {\n        if (editor.hasPlugin('rtc', true) === false) {\n          setup$1(editor);\n          register(editor);\n        } else {\n          registerDialog(editor);\n        }\n        register$1(editor);\n        register$2(editor);\n        return get$1(editor);\n      });\n    }\n\n    Plugin();\n\n}());\n"]},"metadata":{},"sourceType":"script"}