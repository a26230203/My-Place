{"ast":null,"code":"/**\n * Copyright (c) Tiny Technologies, Inc. All rights reserved.\n * Licensed under the LGPL or a commercial license.\n * For LGPL see License.txt in the project root for license information.\n * For commercial licenses see https://www.tiny.cloud/\n *\n * Version: 5.8.2 (2021-06-23)\n */\n(function () {\n  'use strict';\n\n  var global = tinymce.util.Tools.resolve('tinymce.PluginManager');\n  var global$1 = tinymce.util.Tools.resolve('tinymce.Env');\n\n  var getAutoLinkPattern = function (editor) {\n    return editor.getParam('autolink_pattern', /^(https?:\\/\\/|ssh:\\/\\/|ftp:\\/\\/|file:\\/|www\\.|(?:mailto:)?[A-Z0-9._%+\\-]+@(?!.*@))(.+)$/i);\n  };\n\n  var getDefaultLinkTarget = function (editor) {\n    return editor.getParam('default_link_target', false);\n  };\n\n  var getDefaultLinkProtocol = function (editor) {\n    return editor.getParam('link_default_protocol', 'http', 'string');\n  };\n\n  var rangeEqualsDelimiterOrSpace = function (rangeString, delimiter) {\n    return rangeString === delimiter || rangeString === ' ' || rangeString.charCodeAt(0) === 160;\n  };\n\n  var handleEclipse = function (editor) {\n    parseCurrentLine(editor, -1, '(');\n  };\n\n  var handleSpacebar = function (editor) {\n    parseCurrentLine(editor, 0, '');\n  };\n\n  var handleEnter = function (editor) {\n    parseCurrentLine(editor, -1, '');\n  };\n\n  var scopeIndex = function (container, index) {\n    if (index < 0) {\n      index = 0;\n    }\n\n    if (container.nodeType === 3) {\n      var len = container.data.length;\n\n      if (index > len) {\n        index = len;\n      }\n    }\n\n    return index;\n  };\n\n  var setStart = function (rng, container, offset) {\n    if (container.nodeType !== 1 || container.hasChildNodes()) {\n      rng.setStart(container, scopeIndex(container, offset));\n    } else {\n      rng.setStartBefore(container);\n    }\n  };\n\n  var setEnd = function (rng, container, offset) {\n    if (container.nodeType !== 1 || container.hasChildNodes()) {\n      rng.setEnd(container, scopeIndex(container, offset));\n    } else {\n      rng.setEndAfter(container);\n    }\n  };\n\n  var parseCurrentLine = function (editor, endOffset, delimiter) {\n    var end, endContainer, bookmark, text, prev, len, rngText;\n    var autoLinkPattern = getAutoLinkPattern(editor);\n    var defaultLinkTarget = getDefaultLinkTarget(editor);\n\n    if (editor.selection.getNode().tagName === 'A') {\n      return;\n    }\n\n    var rng = editor.selection.getRng().cloneRange();\n\n    if (rng.startOffset < 5) {\n      prev = rng.endContainer.previousSibling;\n\n      if (!prev) {\n        if (!rng.endContainer.firstChild || !rng.endContainer.firstChild.nextSibling) {\n          return;\n        }\n\n        prev = rng.endContainer.firstChild.nextSibling;\n      }\n\n      len = prev.length;\n      setStart(rng, prev, len);\n      setEnd(rng, prev, len);\n\n      if (rng.endOffset < 5) {\n        return;\n      }\n\n      end = rng.endOffset;\n      endContainer = prev;\n    } else {\n      endContainer = rng.endContainer;\n\n      if (endContainer.nodeType !== 3 && endContainer.firstChild) {\n        while (endContainer.nodeType !== 3 && endContainer.firstChild) {\n          endContainer = endContainer.firstChild;\n        }\n\n        if (endContainer.nodeType === 3) {\n          setStart(rng, endContainer, 0);\n          setEnd(rng, endContainer, endContainer.nodeValue.length);\n        }\n      }\n\n      if (rng.endOffset === 1) {\n        end = 2;\n      } else {\n        end = rng.endOffset - 1 - endOffset;\n      }\n    }\n\n    var start = end;\n\n    do {\n      setStart(rng, endContainer, end >= 2 ? end - 2 : 0);\n      setEnd(rng, endContainer, end >= 1 ? end - 1 : 0);\n      end -= 1;\n      rngText = rng.toString();\n    } while (rngText !== ' ' && rngText !== '' && rngText.charCodeAt(0) !== 160 && end - 2 >= 0 && rngText !== delimiter);\n\n    if (rangeEqualsDelimiterOrSpace(rng.toString(), delimiter)) {\n      setStart(rng, endContainer, end);\n      setEnd(rng, endContainer, start);\n      end += 1;\n    } else if (rng.startOffset === 0) {\n      setStart(rng, endContainer, 0);\n      setEnd(rng, endContainer, start);\n    } else {\n      setStart(rng, endContainer, end);\n      setEnd(rng, endContainer, start);\n    }\n\n    text = rng.toString();\n\n    if (text.charAt(text.length - 1) === '.') {\n      setEnd(rng, endContainer, start - 1);\n    }\n\n    text = rng.toString().trim();\n    var matches = text.match(autoLinkPattern);\n    var protocol = getDefaultLinkProtocol(editor);\n\n    if (matches) {\n      if (matches[1] === 'www.') {\n        matches[1] = protocol + '://www.';\n      } else if (/@$/.test(matches[1]) && !/^mailto:/.test(matches[1])) {\n        matches[1] = 'mailto:' + matches[1];\n      }\n\n      bookmark = editor.selection.getBookmark();\n      editor.selection.setRng(rng);\n      editor.execCommand('createlink', false, matches[1] + matches[2]);\n\n      if (defaultLinkTarget !== false) {\n        editor.dom.setAttrib(editor.selection.getNode(), 'target', defaultLinkTarget);\n      }\n\n      editor.selection.moveToBookmark(bookmark);\n      editor.nodeChanged();\n    }\n  };\n\n  var setup = function (editor) {\n    var autoUrlDetectState;\n    editor.on('keydown', function (e) {\n      if (e.keyCode === 13) {\n        return handleEnter(editor);\n      }\n    });\n\n    if (global$1.browser.isIE()) {\n      editor.on('focus', function () {\n        if (!autoUrlDetectState) {\n          autoUrlDetectState = true;\n\n          try {\n            editor.execCommand('AutoUrlDetect', false, true);\n          } catch (ex) {}\n        }\n      });\n      return;\n    }\n\n    editor.on('keypress', function (e) {\n      if (e.keyCode === 41) {\n        return handleEclipse(editor);\n      }\n    });\n    editor.on('keyup', function (e) {\n      if (e.keyCode === 32) {\n        return handleSpacebar(editor);\n      }\n    });\n  };\n\n  function Plugin() {\n    global.add('autolink', function (editor) {\n      setup(editor);\n    });\n  }\n\n  Plugin();\n})();","map":{"version":3,"sources":["/home/lin/phase5/My-Place-Frontend/my-place/node_modules/tinymce/plugins/autolink/plugin.js"],"names":["global","tinymce","util","Tools","resolve","global$1","getAutoLinkPattern","editor","getParam","getDefaultLinkTarget","getDefaultLinkProtocol","rangeEqualsDelimiterOrSpace","rangeString","delimiter","charCodeAt","handleEclipse","parseCurrentLine","handleSpacebar","handleEnter","scopeIndex","container","index","nodeType","len","data","length","setStart","rng","offset","hasChildNodes","setStartBefore","setEnd","setEndAfter","endOffset","end","endContainer","bookmark","text","prev","rngText","autoLinkPattern","defaultLinkTarget","selection","getNode","tagName","getRng","cloneRange","startOffset","previousSibling","firstChild","nextSibling","nodeValue","start","toString","charAt","trim","matches","match","protocol","test","getBookmark","setRng","execCommand","dom","setAttrib","moveToBookmark","nodeChanged","setup","autoUrlDetectState","on","e","keyCode","browser","isIE","ex","Plugin","add"],"mappings":"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","sourcesContent":["/**\n * Copyright (c) Tiny Technologies, Inc. All rights reserved.\n * Licensed under the LGPL or a commercial license.\n * For LGPL see License.txt in the project root for license information.\n * For commercial licenses see https://www.tiny.cloud/\n *\n * Version: 5.8.2 (2021-06-23)\n */\n(function () {\n    'use strict';\n\n    var global = tinymce.util.Tools.resolve('tinymce.PluginManager');\n\n    var global$1 = tinymce.util.Tools.resolve('tinymce.Env');\n\n    var getAutoLinkPattern = function (editor) {\n      return editor.getParam('autolink_pattern', /^(https?:\\/\\/|ssh:\\/\\/|ftp:\\/\\/|file:\\/|www\\.|(?:mailto:)?[A-Z0-9._%+\\-]+@(?!.*@))(.+)$/i);\n    };\n    var getDefaultLinkTarget = function (editor) {\n      return editor.getParam('default_link_target', false);\n    };\n    var getDefaultLinkProtocol = function (editor) {\n      return editor.getParam('link_default_protocol', 'http', 'string');\n    };\n\n    var rangeEqualsDelimiterOrSpace = function (rangeString, delimiter) {\n      return rangeString === delimiter || rangeString === ' ' || rangeString.charCodeAt(0) === 160;\n    };\n    var handleEclipse = function (editor) {\n      parseCurrentLine(editor, -1, '(');\n    };\n    var handleSpacebar = function (editor) {\n      parseCurrentLine(editor, 0, '');\n    };\n    var handleEnter = function (editor) {\n      parseCurrentLine(editor, -1, '');\n    };\n    var scopeIndex = function (container, index) {\n      if (index < 0) {\n        index = 0;\n      }\n      if (container.nodeType === 3) {\n        var len = container.data.length;\n        if (index > len) {\n          index = len;\n        }\n      }\n      return index;\n    };\n    var setStart = function (rng, container, offset) {\n      if (container.nodeType !== 1 || container.hasChildNodes()) {\n        rng.setStart(container, scopeIndex(container, offset));\n      } else {\n        rng.setStartBefore(container);\n      }\n    };\n    var setEnd = function (rng, container, offset) {\n      if (container.nodeType !== 1 || container.hasChildNodes()) {\n        rng.setEnd(container, scopeIndex(container, offset));\n      } else {\n        rng.setEndAfter(container);\n      }\n    };\n    var parseCurrentLine = function (editor, endOffset, delimiter) {\n      var end, endContainer, bookmark, text, prev, len, rngText;\n      var autoLinkPattern = getAutoLinkPattern(editor);\n      var defaultLinkTarget = getDefaultLinkTarget(editor);\n      if (editor.selection.getNode().tagName === 'A') {\n        return;\n      }\n      var rng = editor.selection.getRng().cloneRange();\n      if (rng.startOffset < 5) {\n        prev = rng.endContainer.previousSibling;\n        if (!prev) {\n          if (!rng.endContainer.firstChild || !rng.endContainer.firstChild.nextSibling) {\n            return;\n          }\n          prev = rng.endContainer.firstChild.nextSibling;\n        }\n        len = prev.length;\n        setStart(rng, prev, len);\n        setEnd(rng, prev, len);\n        if (rng.endOffset < 5) {\n          return;\n        }\n        end = rng.endOffset;\n        endContainer = prev;\n      } else {\n        endContainer = rng.endContainer;\n        if (endContainer.nodeType !== 3 && endContainer.firstChild) {\n          while (endContainer.nodeType !== 3 && endContainer.firstChild) {\n            endContainer = endContainer.firstChild;\n          }\n          if (endContainer.nodeType === 3) {\n            setStart(rng, endContainer, 0);\n            setEnd(rng, endContainer, endContainer.nodeValue.length);\n          }\n        }\n        if (rng.endOffset === 1) {\n          end = 2;\n        } else {\n          end = rng.endOffset - 1 - endOffset;\n        }\n      }\n      var start = end;\n      do {\n        setStart(rng, endContainer, end >= 2 ? end - 2 : 0);\n        setEnd(rng, endContainer, end >= 1 ? end - 1 : 0);\n        end -= 1;\n        rngText = rng.toString();\n      } while (rngText !== ' ' && rngText !== '' && rngText.charCodeAt(0) !== 160 && end - 2 >= 0 && rngText !== delimiter);\n      if (rangeEqualsDelimiterOrSpace(rng.toString(), delimiter)) {\n        setStart(rng, endContainer, end);\n        setEnd(rng, endContainer, start);\n        end += 1;\n      } else if (rng.startOffset === 0) {\n        setStart(rng, endContainer, 0);\n        setEnd(rng, endContainer, start);\n      } else {\n        setStart(rng, endContainer, end);\n        setEnd(rng, endContainer, start);\n      }\n      text = rng.toString();\n      if (text.charAt(text.length - 1) === '.') {\n        setEnd(rng, endContainer, start - 1);\n      }\n      text = rng.toString().trim();\n      var matches = text.match(autoLinkPattern);\n      var protocol = getDefaultLinkProtocol(editor);\n      if (matches) {\n        if (matches[1] === 'www.') {\n          matches[1] = protocol + '://www.';\n        } else if (/@$/.test(matches[1]) && !/^mailto:/.test(matches[1])) {\n          matches[1] = 'mailto:' + matches[1];\n        }\n        bookmark = editor.selection.getBookmark();\n        editor.selection.setRng(rng);\n        editor.execCommand('createlink', false, matches[1] + matches[2]);\n        if (defaultLinkTarget !== false) {\n          editor.dom.setAttrib(editor.selection.getNode(), 'target', defaultLinkTarget);\n        }\n        editor.selection.moveToBookmark(bookmark);\n        editor.nodeChanged();\n      }\n    };\n    var setup = function (editor) {\n      var autoUrlDetectState;\n      editor.on('keydown', function (e) {\n        if (e.keyCode === 13) {\n          return handleEnter(editor);\n        }\n      });\n      if (global$1.browser.isIE()) {\n        editor.on('focus', function () {\n          if (!autoUrlDetectState) {\n            autoUrlDetectState = true;\n            try {\n              editor.execCommand('AutoUrlDetect', false, true);\n            } catch (ex) {\n            }\n          }\n        });\n        return;\n      }\n      editor.on('keypress', function (e) {\n        if (e.keyCode === 41) {\n          return handleEclipse(editor);\n        }\n      });\n      editor.on('keyup', function (e) {\n        if (e.keyCode === 32) {\n          return handleSpacebar(editor);\n        }\n      });\n    };\n\n    function Plugin () {\n      global.add('autolink', function (editor) {\n        setup(editor);\n      });\n    }\n\n    Plugin();\n\n}());\n"]},"metadata":{},"sourceType":"script"}