{"ast":null,"code":"var _jsxFileName = \"/home/lin/phase5/My-Place-Frontend/my-place/src/Component/test.js\";\nimport React, { Component } from 'react';\nimport { Upload, message, Icon, Modal, Radio, Card } from 'antd';\nimport config from '../../../../config';\nimport { getCookie } from 'Utils/publicFunc';\nimport './UploadPhoto.scss';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nclass UploadPhoto extends Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      showModal: false,\n      previewImage: '',\n      fileList: [],\n      value: ''\n    };\n    this.handleChange = this.handleChange.bind(this);\n    this.handleCancel = this.handleCancel.bind(this);\n    this.beforeUpload = this.beforeUpload.bind(this);\n    this.onChangeRadioSelect = this.onChangeRadioSelect.bind(this);\n  }\n\n  handleChange(info) {\n    let {\n      file,\n      fileList\n    } = info;\n\n    if (file.status == 'error') {\n      Modal.error({\n        centered: true,\n        title: '上传失败',\n        content: file.response.message\n      });\n      return;\n    }\n\n    fileList = fileList.map(file => {\n      if (file.response) {\n        file.url = file.response.downloadPath;\n      }\n\n      return file;\n    });\n    fileList = fileList.filter(file => {\n      return file.status === 'done';\n    });\n    this.setState({\n      fileList: [...fileList]\n    }, () => {\n      if (file.status == 'done') {\n        message.success('上传成功');\n        const {\n          businessType\n        } = this.props;\n        file.response.businessType = businessType;\n        file.response.code = null;\n        file.response.extraCode = 'N';\n\n        if (this.props.addAttachment) {\n          window.console.log('调用');\n          this.props.addAttachment(file.response);\n        }\n      }\n    });\n  }\n\n  handleRemove(file) {\n    if (this.props.removeAttachment) {\n      this.props.removeAttachment(file.response);\n    }\n  }\n\n  handleCancel() {\n    this.setState({\n      showModal: false\n    });\n  }\n\n  handlePreview(url) {\n    this.setState({\n      previewImage: url,\n      showModal: true\n    });\n  }\n\n  beforeUpload(file) {\n    const {\n      fileSize = 200 * 1024\n    } = this.props;\n    const isJPG = file.type === 'image/jpeg';\n    const isPNG = file.type === 'image/png';\n\n    if (!isJPG && !isPNG) {\n      file.status = 'error';\n      message.error('只能上传格式jpg或png的图片');\n      return false;\n    }\n\n    if (file.size > fileSize) {\n      file.status = 'error';\n      message.error(`图片大小不能大于${parseInt(fileSize / 1024)}kb`);\n      return false;\n    }\n  }\n\n  onChangeRadioSelect(e) {\n    this.setState({\n      value: e.target.value\n    }, () => {\n      if (this.props.callToMainImg) {\n        e.target.info.response.extraCode = 'Y';\n        this.props.callToMainImg(e.target.info.response);\n      }\n    });\n  }\n\n  render() {\n    const {\n      showModal,\n      previewImage\n    } = this.state;\n    let {\n      fileType,\n      defaultFileList,\n      preview\n    } = this.props;\n    window.console.log(defaultFileList);\n    let extraFlag = null;\n\n    if (defaultFileList && defaultFileList.length > 0) {\n      extraFlag = defaultFileList.find(item => item.extraCode == 'Y');\n      extraFlag = extraFlag ? extraFlag.uid : null;\n    }\n\n    const uploadProps = {\n      action: `${config.server}/attachment/uploadCompressPicture/${fileType}?width=500&height=500`,\n      onChange: this.handleChange,\n      onPreview: this.handlePreview,\n      onRemove: this.handleRemove,\n      beforeUpload: this.beforeUpload,\n      listType: 'picture-card',\n      headers: {\n        'Authorization': `bearer ${getCookie('token')}`\n      },\n      defaultFileList: null\n    };\n\n    const uploadButton = /*#__PURE__*/_jsxDEV(\"div\", {\n      children: [/*#__PURE__*/_jsxDEV(Icon, {\n        type: \"plus\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 122,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"\",\n        children: '上传图片'\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 123,\n        columnNumber: 17\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 121,\n      columnNumber: 13\n    }, this);\n\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      className: 'uploadPhoto',\n      children: [/*#__PURE__*/_jsxDEV(\"span\", {\n        style: {\n          display: defaultFileList.length > 0 ? 'inline-block' : 'none'\n        },\n        children: '设为主图'\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 128,\n        columnNumber: 16\n      }, this), /*#__PURE__*/_jsxDEV(Radio.Group, {\n        onChange: this.onChangeRadioSelect,\n        style: {\n          display: defaultFileList.length === 0 ? 'none' : 'inline-block'\n        },\n        value: extraFlag,\n        children: defaultFileList.map(item => {\n          return /*#__PURE__*/_jsxDEV(\"div\", {\n            style: {\n              display: 'inline-block',\n              marginRight: '5px'\n            },\n            children: [/*#__PURE__*/_jsxDEV(Card, {\n              bodyStyle: {\n                padding: '5px'\n              },\n              children: [/*#__PURE__*/_jsxDEV(Icon, {\n                className: \"del-picture\",\n                onClick: this.handleRemove.bind(this, item),\n                style: {\n                  display: preview ? 'none' : 'block'\n                },\n                type: \"close\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 140,\n                columnNumber: 41\n              }, this), /*#__PURE__*/_jsxDEV(\"img\", {\n                alt: \"\\u56FE\\u7247\",\n                onClick: this.handlePreview.bind(this, item.url),\n                src: item.url,\n                style: {\n                  width: '80px',\n                  height: '80px'\n                }\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 145,\n                columnNumber: 41\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 139,\n              columnNumber: 37\n            }, this), /*#__PURE__*/_jsxDEV(Radio, {\n              disabled: preview,\n              info: item,\n              value: item.uid\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 151,\n              columnNumber: 35\n            }, this)]\n          }, item.uid, true, {\n            fileName: _jsxFileName,\n            lineNumber: 136,\n            columnNumber: 31\n          }, this);\n        })\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 129,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(Upload, { ...uploadProps,\n        children: preview ? '' : uploadButton\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 160,\n        columnNumber: 21\n      }, this), /*#__PURE__*/_jsxDEV(Modal, {\n        footer: null,\n        onCancel: this.handleCancel,\n        visible: showModal,\n        children: /*#__PURE__*/_jsxDEV(\"img\", {\n          alt: \"\",\n          src: previewImage,\n          style: {\n            width: '100%'\n          }\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 170,\n          columnNumber: 21\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 165,\n        columnNumber: 17\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 127,\n      columnNumber: 13\n    }, this);\n  }\n\n}\n\nexport default UploadPhoto;","map":{"version":3,"sources":["/home/lin/phase5/My-Place-Frontend/my-place/src/Component/test.js"],"names":["React","Component","Upload","message","Icon","Modal","Radio","Card","config","getCookie","UploadPhoto","constructor","props","state","showModal","previewImage","fileList","value","handleChange","bind","handleCancel","beforeUpload","onChangeRadioSelect","info","file","status","error","centered","title","content","response","map","url","downloadPath","filter","setState","success","businessType","code","extraCode","addAttachment","window","console","log","handleRemove","removeAttachment","handlePreview","fileSize","isJPG","type","isPNG","size","parseInt","e","target","callToMainImg","render","fileType","defaultFileList","preview","extraFlag","length","find","item","uid","uploadProps","action","server","onChange","onPreview","onRemove","listType","headers","uploadButton","display","marginRight","padding","width","height"],"mappings":"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","sourcesContent":["\nimport React, { Component } from 'react';\nimport { Upload, message, Icon, Modal, Radio, Card } from 'antd';\nimport config from '../../../../config';\nimport { getCookie } from 'Utils/publicFunc';\nimport './UploadPhoto.scss';\n \nclass UploadPhoto extends Component {\n    constructor(props) {\n        super(props);\n        this.state = {\n            showModal: false,\n            previewImage: '',\n            fileList: [],\n            value:''\n        };\n        this.handleChange = this.handleChange.bind(this);\n        this.handleCancel = this.handleCancel.bind(this);\n        this.beforeUpload = this.beforeUpload.bind(this);\n        this.onChangeRadioSelect=this.onChangeRadioSelect.bind(this);\n    }\n    handleChange(info) {\n        let { file, fileList } = info;\n        if (file.status == 'error') {\n            Modal.error({\n                centered: true,\n                title: '上传失败',\n                content: file.response.message\n            });\n            return;\n        }\n        fileList = fileList.map((file) => {\n            if (file.response) {\n                file.url = file.response.downloadPath;\n            }\n            return file;\n        });\n        fileList = fileList.filter((file) => {\n            return file.status === 'done';\n        });\n        this.setState({\n            fileList: [...fileList]\n        }, () => {\n            if (file.status == 'done') {\n                message.success('上传成功');\n                const { businessType } = this.props;\n                file.response.businessType = businessType;\n                file.response.code = null;\n                file.response.extraCode='N';\n                if (this.props.addAttachment) {\n                    window.console.log('调用');\n                    this.props.addAttachment(file.response);\n                }\n            }\n        });\n    }\n    handleRemove(file) {\n        if (this.props.removeAttachment) {\n            this.props.removeAttachment(file.response);\n        }\n    }\n    handleCancel() {\n        this.setState({\n            showModal: false\n        });\n    }\n    handlePreview(url) {\n        this.setState({\n            previewImage: url,\n            showModal: true\n        });\n    }\n \n    beforeUpload(file) {\n      const {fileSize = 200 * 1024} = this.props;\n      const isJPG = file.type === 'image/jpeg';\n      const isPNG = file.type === 'image/png';\n      if (!isJPG && !isPNG) {\n        file.status = 'error';\n        message.error('只能上传格式jpg或png的图片');\n        return false;\n      }\n      if (file.size > fileSize) {\n        file.status = 'error';\n        message.error(`图片大小不能大于${parseInt(fileSize/1024)}kb`);\n        return false;\n      }\n    }\n \n    onChangeRadioSelect(e){\n        this.setState({value:e.target.value},() => {\n            if(this.props.callToMainImg){\n                e.target.info.response.extraCode='Y';\n                this.props.callToMainImg(e.target.info.response);\n            }\n        });\n    }\n \n    render() {\n        const { showModal, previewImage } = this.state;\n        let { fileType, defaultFileList,preview} = this.props;\n        window.console.log(defaultFileList);\n        let extraFlag=null;\n        if(defaultFileList&&defaultFileList.length>0){\n           extraFlag= defaultFileList.find((item) => item.extraCode=='Y');\n           extraFlag=extraFlag ? extraFlag.uid : null;\n        }\n        const uploadProps = {\n            action: `${config.server}/attachment/uploadCompressPicture/${fileType}?width=500&height=500`,\n            onChange: this.handleChange,\n            onPreview: this.handlePreview,\n            onRemove: this.handleRemove,\n            beforeUpload: this.beforeUpload,\n            listType: 'picture-card',\n            headers: {\n                'Authorization': `bearer ${getCookie('token')}`\n            },\n            defaultFileList:null\n        };\n        const uploadButton = (\n            <div>\n                <Icon type=\"plus\" />\n                <div className=\"\">{'上传图片'}</div>\n            </div>\n        );\n        return (\n            <div className={'uploadPhoto'}>\n               <span style={{display:defaultFileList.length>0?'inline-block':'none'}}>{'设为主图'}</span>\n                <Radio.Group onChange={this.onChangeRadioSelect}\n                    style={{display: defaultFileList.length === 0 ? 'none' : 'inline-block'}}\n                    value={extraFlag}\n                >\n                    {\n                        defaultFileList.map((item) => {\n                            return (\n                              <div key={item.uid}\n                                  style={{display: 'inline-block', marginRight: '5px'}}\n                              >\n                                    <Card bodyStyle={{ padding: '5px' }}>\n                                        <Icon className=\"del-picture\"\n                                            onClick={this.handleRemove.bind(this, item)}\n                                            style={{display: preview ? 'none' : 'block'}}\n                                            type=\"close\"\n                                        />\n                                        <img alt=\"图片\"\n                                            onClick={this.handlePreview.bind(this, item.url)}\n                                            src={item.url}\n                                            style={{ width: '80px', height: '80px' }}\n                                        />\n                                    </Card>\n                                  <Radio disabled={preview}\n                                      info={item}\n                                      value={item.uid}\n                                  />\n                      </div>\n                            );\n                        })\n                    }\n               </Radio.Group>\n                    <Upload\n                        {...uploadProps}\n                    >\n                        {preview ? '' : uploadButton}\n                    </Upload>\n                <Modal\n                    footer={null}\n                    onCancel={this.handleCancel}\n                    visible={showModal}\n                >\n                    <img\n                        alt=\"\"\n                        src={previewImage}\n                        style={{ width: '100%' }}\n                    />\n                </Modal>\n            </div>\n        );\n    }\n}\n \nexport default UploadPhoto;\n"]},"metadata":{},"sourceType":"module"}