{"ast":null,"code":"/**\n * Copyright (c) Tiny Technologies, Inc. All rights reserved.\n * Licensed under the LGPL or a commercial license.\n * For LGPL see License.txt in the project root for license information.\n * For commercial licenses see https://www.tiny.cloud/\n *\n * Version: 5.8.2 (2021-06-23)\n */\n(function () {\n  'use strict';\n\n  var typeOf = function (x) {\n    var t = typeof x;\n\n    if (x === null) {\n      return 'null';\n    } else if (t === 'object' && (Array.prototype.isPrototypeOf(x) || x.constructor && x.constructor.name === 'Array')) {\n      return 'array';\n    } else if (t === 'object' && (String.prototype.isPrototypeOf(x) || x.constructor && x.constructor.name === 'String')) {\n      return 'string';\n    } else {\n      return t;\n    }\n  };\n\n  var isType = function (type) {\n    return function (value) {\n      return typeOf(value) === type;\n    };\n  };\n\n  var isSimpleType = function (type) {\n    return function (value) {\n      return typeof value === type;\n    };\n  };\n\n  var eq = function (t) {\n    return function (a) {\n      return t === a;\n    };\n  };\n\n  var isString = isType('string');\n  var isObject = isType('object');\n  var isArray = isType('array');\n  var isBoolean = isSimpleType('boolean');\n  var isUndefined = eq(undefined);\n\n  var isNullable = function (a) {\n    return a === null || a === undefined;\n  };\n\n  var isNonNullable = function (a) {\n    return !isNullable(a);\n  };\n\n  var isFunction = isSimpleType('function');\n  var isNumber = isSimpleType('number');\n\n  var isArrayOf = function (value, pred) {\n    if (isArray(value)) {\n      for (var i = 0, len = value.length; i < len; ++i) {\n        if (!pred(value[i])) {\n          return false;\n        }\n      }\n\n      return true;\n    }\n\n    return false;\n  };\n\n  var noop = function () {};\n\n  var noarg = function (f) {\n    return function () {\n      return f();\n    };\n  };\n\n  var compose = function (fa, fb) {\n    return function () {\n      var args = [];\n\n      for (var _i = 0; _i < arguments.length; _i++) {\n        args[_i] = arguments[_i];\n      }\n\n      return fa(fb.apply(null, args));\n    };\n  };\n\n  var compose1 = function (fbc, fab) {\n    return function (a) {\n      return fbc(fab(a));\n    };\n  };\n\n  var constant = function (value) {\n    return function () {\n      return value;\n    };\n  };\n\n  var identity = function (x) {\n    return x;\n  };\n\n  function curry(fn) {\n    var initialArgs = [];\n\n    for (var _i = 1; _i < arguments.length; _i++) {\n      initialArgs[_i - 1] = arguments[_i];\n    }\n\n    return function () {\n      var restArgs = [];\n\n      for (var _i = 0; _i < arguments.length; _i++) {\n        restArgs[_i] = arguments[_i];\n      }\n\n      var all = initialArgs.concat(restArgs);\n      return fn.apply(null, all);\n    };\n  }\n\n  var not = function (f) {\n    return function (t) {\n      return !f(t);\n    };\n  };\n\n  var die = function (msg) {\n    return function () {\n      throw new Error(msg);\n    };\n  };\n\n  var never = constant(false);\n  var always = constant(true);\n  var global$1 = tinymce.util.Tools.resolve('tinymce.ThemeManager');\n\n  var __assign = function () {\n    __assign = Object.assign || function __assign(t) {\n      for (var s, i = 1, n = arguments.length; i < n; i++) {\n        s = arguments[i];\n\n        for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\n      }\n\n      return t;\n    };\n\n    return __assign.apply(this, arguments);\n  };\n\n  function __rest(s, e) {\n    var t = {};\n\n    for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0) t[p] = s[p];\n\n    if (s != null && typeof Object.getOwnPropertySymbols === 'function') for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) {\n      if (e.indexOf(p[i]) < 0 && Object.prototype.propertyIsEnumerable.call(s, p[i])) t[p[i]] = s[p[i]];\n    }\n    return t;\n  }\n\n  function __spreadArrays() {\n    for (var s = 0, i = 0, il = arguments.length; i < il; i++) s += arguments[i].length;\n\n    for (var r = Array(s), k = 0, i = 0; i < il; i++) for (var a = arguments[i], j = 0, jl = a.length; j < jl; j++, k++) r[k] = a[j];\n\n    return r;\n  }\n\n  var none = function () {\n    return NONE;\n  };\n\n  var NONE = function () {\n    var eq = function (o) {\n      return o.isNone();\n    };\n\n    var call = function (thunk) {\n      return thunk();\n    };\n\n    var id = function (n) {\n      return n;\n    };\n\n    var me = {\n      fold: function (n, _s) {\n        return n();\n      },\n      is: never,\n      isSome: never,\n      isNone: always,\n      getOr: id,\n      getOrThunk: call,\n      getOrDie: function (msg) {\n        throw new Error(msg || 'error: getOrDie called on none.');\n      },\n      getOrNull: constant(null),\n      getOrUndefined: constant(undefined),\n      or: id,\n      orThunk: call,\n      map: none,\n      each: noop,\n      bind: none,\n      exists: never,\n      forall: always,\n      filter: none,\n      equals: eq,\n      equals_: eq,\n      toArray: function () {\n        return [];\n      },\n      toString: constant('none()')\n    };\n    return me;\n  }();\n\n  var some = function (a) {\n    var constant_a = constant(a);\n\n    var self = function () {\n      return me;\n    };\n\n    var bind = function (f) {\n      return f(a);\n    };\n\n    var me = {\n      fold: function (n, s) {\n        return s(a);\n      },\n      is: function (v) {\n        return a === v;\n      },\n      isSome: always,\n      isNone: never,\n      getOr: constant_a,\n      getOrThunk: constant_a,\n      getOrDie: constant_a,\n      getOrNull: constant_a,\n      getOrUndefined: constant_a,\n      or: self,\n      orThunk: self,\n      map: function (f) {\n        return some(f(a));\n      },\n      each: function (f) {\n        f(a);\n      },\n      bind: bind,\n      exists: bind,\n      forall: bind,\n      filter: function (f) {\n        return f(a) ? me : NONE;\n      },\n      toArray: function () {\n        return [a];\n      },\n      toString: function () {\n        return 'some(' + a + ')';\n      },\n      equals: function (o) {\n        return o.is(a);\n      },\n      equals_: function (o, elementEq) {\n        return o.fold(never, function (b) {\n          return elementEq(a, b);\n        });\n      }\n    };\n    return me;\n  };\n\n  var from = function (value) {\n    return value === null || value === undefined ? NONE : some(value);\n  };\n\n  var Optional = {\n    some: some,\n    none: none,\n    from: from\n  };\n  var nativeSlice = Array.prototype.slice;\n  var nativeIndexOf = Array.prototype.indexOf;\n  var nativePush = Array.prototype.push;\n\n  var rawIndexOf = function (ts, t) {\n    return nativeIndexOf.call(ts, t);\n  };\n\n  var indexOf = function (xs, x) {\n    var r = rawIndexOf(xs, x);\n    return r === -1 ? Optional.none() : Optional.some(r);\n  };\n\n  var contains = function (xs, x) {\n    return rawIndexOf(xs, x) > -1;\n  };\n\n  var exists = function (xs, pred) {\n    for (var i = 0, len = xs.length; i < len; i++) {\n      var x = xs[i];\n\n      if (pred(x, i)) {\n        return true;\n      }\n    }\n\n    return false;\n  };\n\n  var range = function (num, f) {\n    var r = [];\n\n    for (var i = 0; i < num; i++) {\n      r.push(f(i));\n    }\n\n    return r;\n  };\n\n  var chunk = function (array, size) {\n    var r = [];\n\n    for (var i = 0; i < array.length; i += size) {\n      var s = nativeSlice.call(array, i, i + size);\n      r.push(s);\n    }\n\n    return r;\n  };\n\n  var map = function (xs, f) {\n    var len = xs.length;\n    var r = new Array(len);\n\n    for (var i = 0; i < len; i++) {\n      var x = xs[i];\n      r[i] = f(x, i);\n    }\n\n    return r;\n  };\n\n  var each = function (xs, f) {\n    for (var i = 0, len = xs.length; i < len; i++) {\n      var x = xs[i];\n      f(x, i);\n    }\n  };\n\n  var eachr = function (xs, f) {\n    for (var i = xs.length - 1; i >= 0; i--) {\n      var x = xs[i];\n      f(x, i);\n    }\n  };\n\n  var partition = function (xs, pred) {\n    var pass = [];\n    var fail = [];\n\n    for (var i = 0, len = xs.length; i < len; i++) {\n      var x = xs[i];\n      var arr = pred(x, i) ? pass : fail;\n      arr.push(x);\n    }\n\n    return {\n      pass: pass,\n      fail: fail\n    };\n  };\n\n  var filter = function (xs, pred) {\n    var r = [];\n\n    for (var i = 0, len = xs.length; i < len; i++) {\n      var x = xs[i];\n\n      if (pred(x, i)) {\n        r.push(x);\n      }\n    }\n\n    return r;\n  };\n\n  var foldr = function (xs, f, acc) {\n    eachr(xs, function (x) {\n      acc = f(acc, x);\n    });\n    return acc;\n  };\n\n  var foldl = function (xs, f, acc) {\n    each(xs, function (x) {\n      acc = f(acc, x);\n    });\n    return acc;\n  };\n\n  var findUntil = function (xs, pred, until) {\n    for (var i = 0, len = xs.length; i < len; i++) {\n      var x = xs[i];\n\n      if (pred(x, i)) {\n        return Optional.some(x);\n      } else if (until(x, i)) {\n        break;\n      }\n    }\n\n    return Optional.none();\n  };\n\n  var find = function (xs, pred) {\n    return findUntil(xs, pred, never);\n  };\n\n  var findIndex = function (xs, pred) {\n    for (var i = 0, len = xs.length; i < len; i++) {\n      var x = xs[i];\n\n      if (pred(x, i)) {\n        return Optional.some(i);\n      }\n    }\n\n    return Optional.none();\n  };\n\n  var flatten = function (xs) {\n    var r = [];\n\n    for (var i = 0, len = xs.length; i < len; ++i) {\n      if (!isArray(xs[i])) {\n        throw new Error('Arr.flatten item ' + i + ' was not an array, input: ' + xs);\n      }\n\n      nativePush.apply(r, xs[i]);\n    }\n\n    return r;\n  };\n\n  var bind = function (xs, f) {\n    return flatten(map(xs, f));\n  };\n\n  var forall = function (xs, pred) {\n    for (var i = 0, len = xs.length; i < len; ++i) {\n      var x = xs[i];\n\n      if (pred(x, i) !== true) {\n        return false;\n      }\n    }\n\n    return true;\n  };\n\n  var reverse = function (xs) {\n    var r = nativeSlice.call(xs, 0);\n    r.reverse();\n    return r;\n  };\n\n  var difference = function (a1, a2) {\n    return filter(a1, function (x) {\n      return !contains(a2, x);\n    });\n  };\n\n  var mapToObject = function (xs, f) {\n    var r = {};\n\n    for (var i = 0, len = xs.length; i < len; i++) {\n      var x = xs[i];\n      r[String(x)] = f(x, i);\n    }\n\n    return r;\n  };\n\n  var sort = function (xs, comparator) {\n    var copy = nativeSlice.call(xs, 0);\n    copy.sort(comparator);\n    return copy;\n  };\n\n  var get = function (xs, i) {\n    return i >= 0 && i < xs.length ? Optional.some(xs[i]) : Optional.none();\n  };\n\n  var head = function (xs) {\n    return get(xs, 0);\n  };\n\n  var last = function (xs) {\n    return get(xs, xs.length - 1);\n  };\n\n  var from$1 = isFunction(Array.from) ? Array.from : function (x) {\n    return nativeSlice.call(x);\n  };\n\n  var findMap = function (arr, f) {\n    for (var i = 0; i < arr.length; i++) {\n      var r = f(arr[i], i);\n\n      if (r.isSome()) {\n        return r;\n      }\n    }\n\n    return Optional.none();\n  };\n\n  var value = function (o) {\n    var is = function (v) {\n      return o === v;\n    };\n\n    var or = function (_opt) {\n      return value(o);\n    };\n\n    var orThunk = function (_f) {\n      return value(o);\n    };\n\n    var map = function (f) {\n      return value(f(o));\n    };\n\n    var mapError = function (_f) {\n      return value(o);\n    };\n\n    var each = function (f) {\n      f(o);\n    };\n\n    var bind = function (f) {\n      return f(o);\n    };\n\n    var fold = function (_, onValue) {\n      return onValue(o);\n    };\n\n    var exists = function (f) {\n      return f(o);\n    };\n\n    var forall = function (f) {\n      return f(o);\n    };\n\n    var toOptional = function () {\n      return Optional.some(o);\n    };\n\n    return {\n      is: is,\n      isValue: always,\n      isError: never,\n      getOr: constant(o),\n      getOrThunk: constant(o),\n      getOrDie: constant(o),\n      or: or,\n      orThunk: orThunk,\n      fold: fold,\n      map: map,\n      mapError: mapError,\n      each: each,\n      bind: bind,\n      exists: exists,\n      forall: forall,\n      toOptional: toOptional\n    };\n  };\n\n  var error = function (message) {\n    var getOrThunk = function (f) {\n      return f();\n    };\n\n    var getOrDie = function () {\n      return die(String(message))();\n    };\n\n    var or = function (opt) {\n      return opt;\n    };\n\n    var orThunk = function (f) {\n      return f();\n    };\n\n    var map = function (_f) {\n      return error(message);\n    };\n\n    var mapError = function (f) {\n      return error(f(message));\n    };\n\n    var bind = function (_f) {\n      return error(message);\n    };\n\n    var fold = function (onError, _) {\n      return onError(message);\n    };\n\n    return {\n      is: never,\n      isValue: never,\n      isError: always,\n      getOr: identity,\n      getOrThunk: getOrThunk,\n      getOrDie: getOrDie,\n      or: or,\n      orThunk: orThunk,\n      fold: fold,\n      map: map,\n      mapError: mapError,\n      each: noop,\n      bind: bind,\n      exists: never,\n      forall: always,\n      toOptional: Optional.none\n    };\n  };\n\n  var fromOption = function (opt, err) {\n    return opt.fold(function () {\n      return error(err);\n    }, value);\n  };\n\n  var Result = {\n    value: value,\n    error: error,\n    fromOption: fromOption\n  };\n  var SimpleResultType;\n\n  (function (SimpleResultType) {\n    SimpleResultType[SimpleResultType['Error'] = 0] = 'Error';\n    SimpleResultType[SimpleResultType['Value'] = 1] = 'Value';\n  })(SimpleResultType || (SimpleResultType = {}));\n\n  var fold = function (res, onError, onValue) {\n    return res.stype === SimpleResultType.Error ? onError(res.serror) : onValue(res.svalue);\n  };\n\n  var partition$1 = function (results) {\n    var values = [];\n    var errors = [];\n    each(results, function (obj) {\n      fold(obj, function (err) {\n        return errors.push(err);\n      }, function (val) {\n        return values.push(val);\n      });\n    });\n    return {\n      values: values,\n      errors: errors\n    };\n  };\n\n  var mapError = function (res, f) {\n    if (res.stype === SimpleResultType.Error) {\n      return {\n        stype: SimpleResultType.Error,\n        serror: f(res.serror)\n      };\n    } else {\n      return res;\n    }\n  };\n\n  var map$1 = function (res, f) {\n    if (res.stype === SimpleResultType.Value) {\n      return {\n        stype: SimpleResultType.Value,\n        svalue: f(res.svalue)\n      };\n    } else {\n      return res;\n    }\n  };\n\n  var bind$1 = function (res, f) {\n    if (res.stype === SimpleResultType.Value) {\n      return f(res.svalue);\n    } else {\n      return res;\n    }\n  };\n\n  var bindError = function (res, f) {\n    if (res.stype === SimpleResultType.Error) {\n      return f(res.serror);\n    } else {\n      return res;\n    }\n  };\n\n  var svalue = function (v) {\n    return {\n      stype: SimpleResultType.Value,\n      svalue: v\n    };\n  };\n\n  var serror = function (e) {\n    return {\n      stype: SimpleResultType.Error,\n      serror: e\n    };\n  };\n\n  var toResult = function (res) {\n    return fold(res, Result.error, Result.value);\n  };\n\n  var fromResult = function (res) {\n    return res.fold(serror, svalue);\n  };\n\n  var SimpleResult = {\n    fromResult: fromResult,\n    toResult: toResult,\n    svalue: svalue,\n    partition: partition$1,\n    serror: serror,\n    bind: bind$1,\n    bindError: bindError,\n    map: map$1,\n    mapError: mapError,\n    fold: fold\n  };\n  var keys = Object.keys;\n  var hasOwnProperty = Object.hasOwnProperty;\n\n  var each$1 = function (obj, f) {\n    var props = keys(obj);\n\n    for (var k = 0, len = props.length; k < len; k++) {\n      var i = props[k];\n      var x = obj[i];\n      f(x, i);\n    }\n  };\n\n  var map$2 = function (obj, f) {\n    return tupleMap(obj, function (x, i) {\n      return {\n        k: i,\n        v: f(x, i)\n      };\n    });\n  };\n\n  var tupleMap = function (obj, f) {\n    var r = {};\n    each$1(obj, function (x, i) {\n      var tuple = f(x, i);\n      r[tuple.k] = tuple.v;\n    });\n    return r;\n  };\n\n  var objAcc = function (r) {\n    return function (x, i) {\n      r[i] = x;\n    };\n  };\n\n  var internalFilter = function (obj, pred, onTrue, onFalse) {\n    var r = {};\n    each$1(obj, function (x, i) {\n      (pred(x, i) ? onTrue : onFalse)(x, i);\n    });\n    return r;\n  };\n\n  var filter$1 = function (obj, pred) {\n    var t = {};\n    internalFilter(obj, pred, objAcc(t), noop);\n    return t;\n  };\n\n  var mapToArray = function (obj, f) {\n    var r = [];\n    each$1(obj, function (value, name) {\n      r.push(f(value, name));\n    });\n    return r;\n  };\n\n  var find$1 = function (obj, pred) {\n    var props = keys(obj);\n\n    for (var k = 0, len = props.length; k < len; k++) {\n      var i = props[k];\n      var x = obj[i];\n\n      if (pred(x, i, obj)) {\n        return Optional.some(x);\n      }\n    }\n\n    return Optional.none();\n  };\n\n  var values = function (obj) {\n    return mapToArray(obj, function (v) {\n      return v;\n    });\n  };\n\n  var get$1 = function (obj, key) {\n    return has(obj, key) ? Optional.from(obj[key]) : Optional.none();\n  };\n\n  var has = function (obj, key) {\n    return hasOwnProperty.call(obj, key);\n  };\n\n  var hasNonNullableKey = function (obj, key) {\n    return has(obj, key) && obj[key] !== undefined && obj[key] !== null;\n  };\n\n  var generate = function (cases) {\n    if (!isArray(cases)) {\n      throw new Error('cases must be an array');\n    }\n\n    if (cases.length === 0) {\n      throw new Error('there must be at least one case');\n    }\n\n    var constructors = [];\n    var adt = {};\n    each(cases, function (acase, count) {\n      var keys$1 = keys(acase);\n\n      if (keys$1.length !== 1) {\n        throw new Error('one and only one name per case');\n      }\n\n      var key = keys$1[0];\n      var value = acase[key];\n\n      if (adt[key] !== undefined) {\n        throw new Error('duplicate key detected:' + key);\n      } else if (key === 'cata') {\n        throw new Error('cannot have a case named cata (sorry)');\n      } else if (!isArray(value)) {\n        throw new Error('case arguments must be an array');\n      }\n\n      constructors.push(key);\n\n      adt[key] = function () {\n        var args = [];\n\n        for (var _i = 0; _i < arguments.length; _i++) {\n          args[_i] = arguments[_i];\n        }\n\n        var argLength = args.length;\n\n        if (argLength !== value.length) {\n          throw new Error('Wrong number of arguments to case ' + key + '. Expected ' + value.length + ' (' + value + '), got ' + argLength);\n        }\n\n        var match = function (branches) {\n          var branchKeys = keys(branches);\n\n          if (constructors.length !== branchKeys.length) {\n            throw new Error('Wrong number of arguments to match. Expected: ' + constructors.join(',') + '\\nActual: ' + branchKeys.join(','));\n          }\n\n          var allReqd = forall(constructors, function (reqKey) {\n            return contains(branchKeys, reqKey);\n          });\n\n          if (!allReqd) {\n            throw new Error('Not all branches were specified when using match. Specified: ' + branchKeys.join(', ') + '\\nRequired: ' + constructors.join(', '));\n          }\n\n          return branches[key].apply(null, args);\n        };\n\n        return {\n          fold: function () {\n            var foldArgs = [];\n\n            for (var _i = 0; _i < arguments.length; _i++) {\n              foldArgs[_i] = arguments[_i];\n            }\n\n            if (foldArgs.length !== cases.length) {\n              throw new Error('Wrong number of arguments to fold. Expected ' + cases.length + ', got ' + foldArgs.length);\n            }\n\n            var target = foldArgs[count];\n            return target.apply(null, args);\n          },\n          match: match,\n          log: function (label) {\n            console.log(label, {\n              constructors: constructors,\n              constructor: key,\n              params: args\n            });\n          }\n        };\n      };\n    });\n    return adt;\n  };\n\n  var Adt = {\n    generate: generate\n  };\n  var hasOwnProperty$1 = Object.prototype.hasOwnProperty;\n\n  var shallow = function (old, nu) {\n    return nu;\n  };\n\n  var deep = function (old, nu) {\n    var bothObjects = isObject(old) && isObject(nu);\n    return bothObjects ? deepMerge(old, nu) : nu;\n  };\n\n  var baseMerge = function (merger) {\n    return function () {\n      var objects = [];\n\n      for (var _i = 0; _i < arguments.length; _i++) {\n        objects[_i] = arguments[_i];\n      }\n\n      if (objects.length === 0) {\n        throw new Error('Can\\'t merge zero objects');\n      }\n\n      var ret = {};\n\n      for (var j = 0; j < objects.length; j++) {\n        var curObject = objects[j];\n\n        for (var key in curObject) {\n          if (hasOwnProperty$1.call(curObject, key)) {\n            ret[key] = merger(ret[key], curObject[key]);\n          }\n        }\n      }\n\n      return ret;\n    };\n  };\n\n  var deepMerge = baseMerge(deep);\n  var merge = baseMerge(shallow);\n\n  var cached = function (f) {\n    var called = false;\n    var r;\n    return function () {\n      var args = [];\n\n      for (var _i = 0; _i < arguments.length; _i++) {\n        args[_i] = arguments[_i];\n      }\n\n      if (!called) {\n        called = true;\n        r = f.apply(null, args);\n      }\n\n      return r;\n    };\n  };\n\n  var adt = Adt.generate([{\n    strict: []\n  }, {\n    defaultedThunk: ['fallbackThunk']\n  }, {\n    asOption: []\n  }, {\n    asDefaultedOptionThunk: ['fallbackThunk']\n  }, {\n    mergeWithThunk: ['baseThunk']\n  }]);\n\n  var defaulted = function (fallback) {\n    return adt.defaultedThunk(constant(fallback));\n  };\n\n  var mergeWith = function (base) {\n    return adt.mergeWithThunk(constant(base));\n  };\n\n  var strict = adt.strict;\n  var asOption = adt.asOption;\n  var defaultedThunk = adt.defaultedThunk;\n  var asDefaultedOptionThunk = adt.asDefaultedOptionThunk;\n  var mergeWithThunk = adt.mergeWithThunk;\n  var comparison = Adt.generate([{\n    bothErrors: ['error1', 'error2']\n  }, {\n    firstError: ['error1', 'value2']\n  }, {\n    secondError: ['value1', 'error2']\n  }, {\n    bothValues: ['value1', 'value2']\n  }]);\n\n  var partition$2 = function (results) {\n    var errors = [];\n    var values = [];\n    each(results, function (result) {\n      result.fold(function (err) {\n        errors.push(err);\n      }, function (value) {\n        values.push(value);\n      });\n    });\n    return {\n      errors: errors,\n      values: values\n    };\n  };\n\n  var exclude = function (obj, fields) {\n    var r = {};\n    each$1(obj, function (v, k) {\n      if (!contains(fields, k)) {\n        r[k] = v;\n      }\n    });\n    return r;\n  };\n\n  var wrap = function (key, value) {\n    var _a;\n\n    return _a = {}, _a[key] = value, _a;\n  };\n\n  var wrapAll = function (keyvalues) {\n    var r = {};\n    each(keyvalues, function (kv) {\n      r[kv.key] = kv.value;\n    });\n    return r;\n  };\n\n  var exclude$1 = function (obj, fields) {\n    return exclude(obj, fields);\n  };\n\n  var wrap$1 = function (key, value) {\n    return wrap(key, value);\n  };\n\n  var wrapAll$1 = function (keyvalues) {\n    return wrapAll(keyvalues);\n  };\n\n  var mergeValues = function (values, base) {\n    return values.length === 0 ? Result.value(base) : Result.value(deepMerge(base, merge.apply(undefined, values)));\n  };\n\n  var mergeErrors = function (errors) {\n    return Result.error(flatten(errors));\n  };\n\n  var consolidate = function (objs, base) {\n    var partitions = partition$2(objs);\n    return partitions.errors.length > 0 ? mergeErrors(partitions.errors) : mergeValues(partitions.values, base);\n  };\n\n  var mergeValues$1 = function (values, base) {\n    return values.length > 0 ? SimpleResult.svalue(deepMerge(base, merge.apply(undefined, values))) : SimpleResult.svalue(base);\n  };\n\n  var mergeErrors$1 = function (errors) {\n    return compose(SimpleResult.serror, flatten)(errors);\n  };\n\n  var consolidateObj = function (objects, base) {\n    var partition = SimpleResult.partition(objects);\n    return partition.errors.length > 0 ? mergeErrors$1(partition.errors) : mergeValues$1(partition.values, base);\n  };\n\n  var consolidateArr = function (objects) {\n    var partitions = SimpleResult.partition(objects);\n    return partitions.errors.length > 0 ? mergeErrors$1(partitions.errors) : SimpleResult.svalue(partitions.values);\n  };\n\n  var ResultCombine = {\n    consolidateObj: consolidateObj,\n    consolidateArr: consolidateArr\n  };\n\n  var formatObj = function (input) {\n    return isObject(input) && keys(input).length > 100 ? ' removed due to size' : JSON.stringify(input, null, 2);\n  };\n\n  var formatErrors = function (errors) {\n    var es = errors.length > 10 ? errors.slice(0, 10).concat([{\n      path: [],\n      getErrorInfo: function () {\n        return '... (only showing first ten failures)';\n      }\n    }]) : errors;\n    return map(es, function (e) {\n      return 'Failed path: (' + e.path.join(' > ') + ')\\n' + e.getErrorInfo();\n    });\n  };\n\n  var nu = function (path, getErrorInfo) {\n    return SimpleResult.serror([{\n      path: path,\n      getErrorInfo: getErrorInfo\n    }]);\n  };\n\n  var missingStrict = function (path, key, obj) {\n    return nu(path, function () {\n      return 'Could not find valid *strict* value for \"' + key + '\" in ' + formatObj(obj);\n    });\n  };\n\n  var missingKey = function (path, key) {\n    return nu(path, function () {\n      return 'Choice schema did not contain choice key: \"' + key + '\"';\n    });\n  };\n\n  var missingBranch = function (path, branches, branch) {\n    return nu(path, function () {\n      return 'The chosen schema: \"' + branch + '\" did not exist in branches: ' + formatObj(branches);\n    });\n  };\n\n  var unsupportedFields = function (path, unsupported) {\n    return nu(path, function () {\n      return 'There are unsupported fields: [' + unsupported.join(', ') + '] specified';\n    });\n  };\n\n  var custom = function (path, err) {\n    return nu(path, function () {\n      return err;\n    });\n  };\n\n  var adt$1 = Adt.generate([{\n    field: ['key', 'okey', 'presence', 'prop']\n  }, {\n    state: ['okey', 'instantiator']\n  }]);\n\n  var strictAccess = function (path, obj, key) {\n    return get$1(obj, key).fold(function () {\n      return missingStrict(path, key, obj);\n    }, SimpleResult.svalue);\n  };\n\n  var fallbackAccess = function (obj, key, fallbackThunk) {\n    var v = get$1(obj, key).fold(function () {\n      return fallbackThunk(obj);\n    }, identity);\n    return SimpleResult.svalue(v);\n  };\n\n  var optionAccess = function (obj, key) {\n    return SimpleResult.svalue(get$1(obj, key));\n  };\n\n  var optionDefaultedAccess = function (obj, key, fallback) {\n    var opt = get$1(obj, key).map(function (val) {\n      return val === true ? fallback(obj) : val;\n    });\n    return SimpleResult.svalue(opt);\n  };\n\n  var cExtractOne = function (path, obj, field, strength) {\n    return field.fold(function (key, okey, presence, prop) {\n      var bundle = function (av) {\n        var result = prop.extract(path.concat([key]), strength, av);\n        return SimpleResult.map(result, function (res) {\n          return wrap(okey, strength(res));\n        });\n      };\n\n      var bundleAsOption = function (optValue) {\n        return optValue.fold(function () {\n          var outcome = wrap(okey, strength(Optional.none()));\n          return SimpleResult.svalue(outcome);\n        }, function (ov) {\n          var result = prop.extract(path.concat([key]), strength, ov);\n          return SimpleResult.map(result, function (res) {\n            return wrap(okey, strength(Optional.some(res)));\n          });\n        });\n      };\n\n      return function () {\n        return presence.fold(function () {\n          return SimpleResult.bind(strictAccess(path, obj, key), bundle);\n        }, function (fallbackThunk) {\n          return SimpleResult.bind(fallbackAccess(obj, key, fallbackThunk), bundle);\n        }, function () {\n          return SimpleResult.bind(optionAccess(obj, key), bundleAsOption);\n        }, function (fallbackThunk) {\n          return SimpleResult.bind(optionDefaultedAccess(obj, key, fallbackThunk), bundleAsOption);\n        }, function (baseThunk) {\n          var base = baseThunk(obj);\n          var result = SimpleResult.map(fallbackAccess(obj, key, constant({})), function (v) {\n            return deepMerge(base, v);\n          });\n          return SimpleResult.bind(result, bundle);\n        });\n      }();\n    }, function (okey, instantiator) {\n      var state = instantiator(obj);\n      return SimpleResult.svalue(wrap(okey, strength(state)));\n    });\n  };\n\n  var cExtract = function (path, obj, fields, strength) {\n    var results = map(fields, function (field) {\n      return cExtractOne(path, obj, field, strength);\n    });\n    return ResultCombine.consolidateObj(results, {});\n  };\n\n  var valueThunk = function (getDelegate) {\n    var extract = function (path, strength, val) {\n      return getDelegate().extract(path, strength, val);\n    };\n\n    var toString = function () {\n      return getDelegate().toString();\n    };\n\n    return {\n      extract: extract,\n      toString: toString\n    };\n  };\n\n  var value$1 = function (validator) {\n    var extract = function (path, strength, val) {\n      return SimpleResult.bindError(validator(val, strength), function (err) {\n        return custom(path, err);\n      });\n    };\n\n    var toString = function () {\n      return 'val';\n    };\n\n    return {\n      extract: extract,\n      toString: toString\n    };\n  };\n\n  var getSetKeys = function (obj) {\n    return keys(filter$1(obj, function (value) {\n      return value !== undefined && value !== null;\n    }));\n  };\n\n  var objOfOnly = function (fields) {\n    var delegate = objOf(fields);\n    var fieldNames = foldr(fields, function (acc, f) {\n      return f.fold(function (key) {\n        return deepMerge(acc, wrap$1(key, true));\n      }, constant(acc));\n    }, {});\n\n    var extract = function (path, strength, o) {\n      var keys = isBoolean(o) ? [] : getSetKeys(o);\n      var extra = filter(keys, function (k) {\n        return !hasNonNullableKey(fieldNames, k);\n      });\n      return extra.length === 0 ? delegate.extract(path, strength, o) : unsupportedFields(path, extra);\n    };\n\n    return {\n      extract: extract,\n      toString: delegate.toString\n    };\n  };\n\n  var objOf = function (fields) {\n    var extract = function (path, strength, o) {\n      return cExtract(path, o, fields, strength);\n    };\n\n    var toString = function () {\n      var fieldStrings = map(fields, function (field) {\n        return field.fold(function (key, okey, presence, prop) {\n          return key + ' -> ' + prop.toString();\n        }, function (okey, _instantiator) {\n          return 'state(' + okey + ')';\n        });\n      });\n      return 'obj{\\n' + fieldStrings.join('\\n') + '}';\n    };\n\n    return {\n      extract: extract,\n      toString: toString\n    };\n  };\n\n  var arrOf = function (prop) {\n    var extract = function (path, strength, array) {\n      var results = map(array, function (a, i) {\n        return prop.extract(path.concat(['[' + i + ']']), strength, a);\n      });\n      return ResultCombine.consolidateArr(results);\n    };\n\n    var toString = function () {\n      return 'array(' + prop.toString() + ')';\n    };\n\n    return {\n      extract: extract,\n      toString: toString\n    };\n  };\n\n  var oneOf = function (props) {\n    var extract = function (path, strength, val) {\n      var errors = [];\n\n      for (var _i = 0, props_1 = props; _i < props_1.length; _i++) {\n        var prop = props_1[_i];\n        var res = prop.extract(path, strength, val);\n\n        if (res.stype === SimpleResultType.Value) {\n          return res;\n        }\n\n        errors.push(res);\n      }\n\n      return ResultCombine.consolidateArr(errors);\n    };\n\n    var toString = function () {\n      return 'oneOf(' + map(props, function (prop) {\n        return prop.toString();\n      }).join(', ') + ')';\n    };\n\n    return {\n      extract: extract,\n      toString: toString\n    };\n  };\n\n  var setOf = function (validator, prop) {\n    var validateKeys = function (path, keys) {\n      return arrOf(value$1(validator)).extract(path, identity, keys);\n    };\n\n    var extract = function (path, strength, o) {\n      var keys$1 = keys(o);\n      var validatedKeys = validateKeys(path, keys$1);\n      return SimpleResult.bind(validatedKeys, function (validKeys) {\n        var schema = map(validKeys, function (vk) {\n          return adt$1.field(vk, vk, strict(), prop);\n        });\n        return objOf(schema).extract(path, strength, o);\n      });\n    };\n\n    var toString = function () {\n      return 'setOf(' + prop.toString() + ')';\n    };\n\n    return {\n      extract: extract,\n      toString: toString\n    };\n  };\n\n  var thunk = function (desc, processor) {\n    var getP = cached(function () {\n      return processor();\n    });\n\n    var extract = function (path, strength, val) {\n      return getP().extract(path, strength, val);\n    };\n\n    var toString = function () {\n      return getP().toString();\n    };\n\n    return {\n      extract: extract,\n      toString: toString\n    };\n  };\n\n  var anyValue = constant(value$1(SimpleResult.svalue));\n  var arrOfObj = compose(arrOf, objOf);\n  var state = adt$1.state;\n  var field = adt$1.field;\n\n  var chooseFrom = function (path, strength, input, branches, ch) {\n    var fields = get$1(branches, ch);\n    return fields.fold(function () {\n      return missingBranch(path, branches, ch);\n    }, function (vp) {\n      return vp.extract(path.concat(['branch: ' + ch]), strength, input);\n    });\n  };\n\n  var choose = function (key, branches) {\n    var extract = function (path, strength, input) {\n      var choice = get$1(input, key);\n      return choice.fold(function () {\n        return missingKey(path, key);\n      }, function (chosen) {\n        return chooseFrom(path, strength, input, branches, chosen);\n      });\n    };\n\n    var toString = function () {\n      return 'chooseOn(' + key + '). Possible values: ' + keys(branches);\n    };\n\n    return {\n      extract: extract,\n      toString: toString\n    };\n  };\n\n  var _anyValue = value$1(SimpleResult.svalue);\n\n  var arrOfObj$1 = function (objFields) {\n    return arrOfObj(objFields);\n  };\n\n  var arrOfVal = function () {\n    return arrOf(_anyValue);\n  };\n\n  var valueThunkOf = valueThunk;\n\n  var valueOf = function (validator) {\n    return value$1(function (v) {\n      return validator(v).fold(SimpleResult.serror, SimpleResult.svalue);\n    });\n  };\n\n  var setOf$1 = function (validator, prop) {\n    return setOf(function (v) {\n      return SimpleResult.fromResult(validator(v));\n    }, prop);\n  };\n\n  var extract = function (label, prop, strength, obj) {\n    var res = prop.extract([label], strength, obj);\n    return SimpleResult.mapError(res, function (errs) {\n      return {\n        input: obj,\n        errors: errs\n      };\n    });\n  };\n\n  var asRaw = function (label, prop, obj) {\n    return SimpleResult.toResult(extract(label, prop, identity, obj));\n  };\n\n  var getOrDie = function (extraction) {\n    return extraction.fold(function (errInfo) {\n      throw new Error(formatError(errInfo));\n    }, identity);\n  };\n\n  var asRawOrDie = function (label, prop, obj) {\n    return getOrDie(asRaw(label, prop, obj));\n  };\n\n  var formatError = function (errInfo) {\n    return 'Errors: \\n' + formatErrors(errInfo.errors).join('\\n') + '\\n\\nInput object: ' + formatObj(errInfo.input);\n  };\n\n  var chooseProcessor = function (key, branches) {\n    return choose(key, branches);\n  };\n\n  var choose$1 = function (key, branches) {\n    return choose(key, map$2(branches, objOf));\n  };\n\n  var thunkOf = function (desc, schema) {\n    return thunk(desc, schema);\n  };\n\n  var anyValue$1 = constant(_anyValue);\n\n  var typedValue = function (validator, expectedType) {\n    return value$1(function (a) {\n      var actualType = typeof a;\n      return validator(a) ? SimpleResult.svalue(a) : SimpleResult.serror('Expected type: ' + expectedType + ' but got: ' + actualType);\n    });\n  };\n\n  var number = typedValue(isNumber, 'number');\n  var string = typedValue(isString, 'string');\n  var boolean = typedValue(isBoolean, 'boolean');\n  var functionProcessor = typedValue(isFunction, 'function');\n\n  var isPostMessageable = function (val) {\n    var every = function (iter, callbackFn) {\n      var result = iter.next();\n\n      while (!result.done) {\n        if (!callbackFn(result.value)) {\n          return false;\n        }\n\n        result = iter.next();\n      }\n\n      return true;\n    };\n\n    if (Object(val) !== val) {\n      return true;\n    }\n\n    switch ({}.toString.call(val).slice(8, -1)) {\n      case 'Boolean':\n      case 'Number':\n      case 'String':\n      case 'Date':\n      case 'RegExp':\n      case 'Blob':\n      case 'FileList':\n      case 'ImageData':\n      case 'ImageBitmap':\n      case 'ArrayBuffer':\n        return true;\n\n      case 'Array':\n      case 'Object':\n        return Object.keys(val).every(function (prop) {\n          return isPostMessageable(val[prop]);\n        });\n\n      case 'Map':\n        return every(val.keys(), isPostMessageable) && every(val.values(), isPostMessageable);\n\n      case 'Set':\n        return every(val.keys(), isPostMessageable);\n\n      default:\n        return false;\n    }\n  };\n\n  var postMessageable = value$1(function (a) {\n    return isPostMessageable(a) ? SimpleResult.svalue(a) : SimpleResult.serror('Expected value to be acceptable for sending via postMessage');\n  });\n\n  var validateEnum = function (values) {\n    return valueOf(function (value) {\n      return contains(values, value) ? Result.value(value) : Result.error('Unsupported value: \"' + value + '\", choose one of \"' + values.join(', ') + '\".');\n    });\n  };\n\n  var strict$1 = function (key) {\n    return field(key, key, strict(), anyValue());\n  };\n\n  var strictOf = function (key, schema) {\n    return field(key, key, strict(), schema);\n  };\n\n  var strictNumber = function (key) {\n    return strictOf(key, number);\n  };\n\n  var strictString = function (key) {\n    return strictOf(key, string);\n  };\n\n  var strictStringEnum = function (key, values) {\n    return field(key, key, strict(), validateEnum(values));\n  };\n\n  var strictBoolean = function (key) {\n    return strictOf(key, boolean);\n  };\n\n  var strictFunction = function (key) {\n    return strictOf(key, functionProcessor);\n  };\n\n  var forbid = function (key, message) {\n    return field(key, key, asOption(), value$1(function (_v) {\n      return SimpleResult.serror('The field: ' + key + ' is forbidden. ' + message);\n    }));\n  };\n\n  var strictObjOf = function (key, objSchema) {\n    return field(key, key, strict(), objOf(objSchema));\n  };\n\n  var strictArrayOfObj = function (key, objFields) {\n    return field(key, key, strict(), arrOfObj(objFields));\n  };\n\n  var strictArrayOf = function (key, schema) {\n    return field(key, key, strict(), arrOf(schema));\n  };\n\n  var option = function (key) {\n    return field(key, key, asOption(), anyValue());\n  };\n\n  var optionOf = function (key, schema) {\n    return field(key, key, asOption(), schema);\n  };\n\n  var optionNumber = function (key) {\n    return optionOf(key, number);\n  };\n\n  var optionString = function (key) {\n    return optionOf(key, string);\n  };\n\n  var optionFunction = function (key) {\n    return optionOf(key, functionProcessor);\n  };\n\n  var optionArrayOf = function (key, schema) {\n    return optionOf(key, arrOf(schema));\n  };\n\n  var optionObjOf = function (key, objSchema) {\n    return optionOf(key, objOf(objSchema));\n  };\n\n  var optionObjOfOnly = function (key, objSchema) {\n    return optionOf(key, objOfOnly(objSchema));\n  };\n\n  var defaulted$1 = function (key, fallback) {\n    return field(key, key, defaulted(fallback), anyValue());\n  };\n\n  var defaultedOf = function (key, fallback, schema) {\n    return field(key, key, defaulted(fallback), schema);\n  };\n\n  var defaultedNumber = function (key, fallback) {\n    return defaultedOf(key, fallback, number);\n  };\n\n  var defaultedString = function (key, fallback) {\n    return defaultedOf(key, fallback, string);\n  };\n\n  var defaultedStringEnum = function (key, fallback, values) {\n    return defaultedOf(key, fallback, validateEnum(values));\n  };\n\n  var defaultedBoolean = function (key, fallback) {\n    return defaultedOf(key, fallback, boolean);\n  };\n\n  var defaultedFunction = function (key, fallback) {\n    return defaultedOf(key, fallback, functionProcessor);\n  };\n\n  var defaultedPostMsg = function (key, fallback) {\n    return defaultedOf(key, fallback, postMessageable);\n  };\n\n  var defaultedArrayOf = function (key, fallback, schema) {\n    return defaultedOf(key, fallback, arrOf(schema));\n  };\n\n  var defaultedObjOf = function (key, fallback, objSchema) {\n    return defaultedOf(key, fallback, objOf(objSchema));\n  };\n\n  var state$1 = function (okey, instantiator) {\n    return state(okey, instantiator);\n  };\n\n  var Cell = function (initial) {\n    var value = initial;\n\n    var get = function () {\n      return value;\n    };\n\n    var set = function (v) {\n      value = v;\n    };\n\n    return {\n      get: get,\n      set: set\n    };\n  };\n\n  var fromHtml = function (html, scope) {\n    var doc = scope || document;\n    var div = doc.createElement('div');\n    div.innerHTML = html;\n\n    if (!div.hasChildNodes() || div.childNodes.length > 1) {\n      console.error('HTML does not have a single root node', html);\n      throw new Error('HTML must have a single root node');\n    }\n\n    return fromDom(div.childNodes[0]);\n  };\n\n  var fromTag = function (tag, scope) {\n    var doc = scope || document;\n    var node = doc.createElement(tag);\n    return fromDom(node);\n  };\n\n  var fromText = function (text, scope) {\n    var doc = scope || document;\n    var node = doc.createTextNode(text);\n    return fromDom(node);\n  };\n\n  var fromDom = function (node) {\n    if (node === null || node === undefined) {\n      throw new Error('Node cannot be null or undefined');\n    }\n\n    return {\n      dom: node\n    };\n  };\n\n  var fromPoint = function (docElm, x, y) {\n    return Optional.from(docElm.dom.elementFromPoint(x, y)).map(fromDom);\n  };\n\n  var SugarElement = {\n    fromHtml: fromHtml,\n    fromTag: fromTag,\n    fromText: fromText,\n    fromDom: fromDom,\n    fromPoint: fromPoint\n  };\n\n  var DeviceType = function (os, browser, userAgent, mediaMatch) {\n    var isiPad = os.isiOS() && /ipad/i.test(userAgent) === true;\n    var isiPhone = os.isiOS() && !isiPad;\n    var isMobile = os.isiOS() || os.isAndroid();\n    var isTouch = isMobile || mediaMatch('(pointer:coarse)');\n    var isTablet = isiPad || !isiPhone && isMobile && mediaMatch('(min-device-width:768px)');\n    var isPhone = isiPhone || isMobile && !isTablet;\n    var iOSwebview = browser.isSafari() && os.isiOS() && /safari/i.test(userAgent) === false;\n    var isDesktop = !isPhone && !isTablet && !iOSwebview;\n    return {\n      isiPad: constant(isiPad),\n      isiPhone: constant(isiPhone),\n      isTablet: constant(isTablet),\n      isPhone: constant(isPhone),\n      isTouch: constant(isTouch),\n      isAndroid: os.isAndroid,\n      isiOS: os.isiOS,\n      isWebView: constant(iOSwebview),\n      isDesktop: constant(isDesktop)\n    };\n  };\n\n  var firstMatch = function (regexes, s) {\n    for (var i = 0; i < regexes.length; i++) {\n      var x = regexes[i];\n\n      if (x.test(s)) {\n        return x;\n      }\n    }\n\n    return undefined;\n  };\n\n  var find$2 = function (regexes, agent) {\n    var r = firstMatch(regexes, agent);\n\n    if (!r) {\n      return {\n        major: 0,\n        minor: 0\n      };\n    }\n\n    var group = function (i) {\n      return Number(agent.replace(r, '$' + i));\n    };\n\n    return nu$1(group(1), group(2));\n  };\n\n  var detect = function (versionRegexes, agent) {\n    var cleanedAgent = String(agent).toLowerCase();\n\n    if (versionRegexes.length === 0) {\n      return unknown();\n    }\n\n    return find$2(versionRegexes, cleanedAgent);\n  };\n\n  var unknown = function () {\n    return nu$1(0, 0);\n  };\n\n  var nu$1 = function (major, minor) {\n    return {\n      major: major,\n      minor: minor\n    };\n  };\n\n  var Version = {\n    nu: nu$1,\n    detect: detect,\n    unknown: unknown\n  };\n\n  var detect$1 = function (candidates, userAgent) {\n    var agent = String(userAgent).toLowerCase();\n    return find(candidates, function (candidate) {\n      return candidate.search(agent);\n    });\n  };\n\n  var detectBrowser = function (browsers, userAgent) {\n    return detect$1(browsers, userAgent).map(function (browser) {\n      var version = Version.detect(browser.versionRegexes, userAgent);\n      return {\n        current: browser.name,\n        version: version\n      };\n    });\n  };\n\n  var detectOs = function (oses, userAgent) {\n    return detect$1(oses, userAgent).map(function (os) {\n      var version = Version.detect(os.versionRegexes, userAgent);\n      return {\n        current: os.name,\n        version: version\n      };\n    });\n  };\n\n  var UaString = {\n    detectBrowser: detectBrowser,\n    detectOs: detectOs\n  };\n\n  var checkRange = function (str, substr, start) {\n    return substr === '' || str.length >= substr.length && str.substr(start, start + substr.length) === substr;\n  };\n\n  var contains$1 = function (str, substr) {\n    return str.indexOf(substr) !== -1;\n  };\n\n  var endsWith = function (str, suffix) {\n    return checkRange(str, suffix, str.length - suffix.length);\n  };\n\n  var blank = function (r) {\n    return function (s) {\n      return s.replace(r, '');\n    };\n  };\n\n  var trim = blank(/^\\s+|\\s+$/g);\n  var normalVersionRegex = /.*?version\\/\\ ?([0-9]+)\\.([0-9]+).*/;\n\n  var checkContains = function (target) {\n    return function (uastring) {\n      return contains$1(uastring, target);\n    };\n  };\n\n  var browsers = [{\n    name: 'Edge',\n    versionRegexes: [/.*?edge\\/ ?([0-9]+)\\.([0-9]+)$/],\n    search: function (uastring) {\n      return contains$1(uastring, 'edge/') && contains$1(uastring, 'chrome') && contains$1(uastring, 'safari') && contains$1(uastring, 'applewebkit');\n    }\n  }, {\n    name: 'Chrome',\n    versionRegexes: [/.*?chrome\\/([0-9]+)\\.([0-9]+).*/, normalVersionRegex],\n    search: function (uastring) {\n      return contains$1(uastring, 'chrome') && !contains$1(uastring, 'chromeframe');\n    }\n  }, {\n    name: 'IE',\n    versionRegexes: [/.*?msie\\ ?([0-9]+)\\.([0-9]+).*/, /.*?rv:([0-9]+)\\.([0-9]+).*/],\n    search: function (uastring) {\n      return contains$1(uastring, 'msie') || contains$1(uastring, 'trident');\n    }\n  }, {\n    name: 'Opera',\n    versionRegexes: [normalVersionRegex, /.*?opera\\/([0-9]+)\\.([0-9]+).*/],\n    search: checkContains('opera')\n  }, {\n    name: 'Firefox',\n    versionRegexes: [/.*?firefox\\/\\ ?([0-9]+)\\.([0-9]+).*/],\n    search: checkContains('firefox')\n  }, {\n    name: 'Safari',\n    versionRegexes: [normalVersionRegex, /.*?cpu os ([0-9]+)_([0-9]+).*/],\n    search: function (uastring) {\n      return (contains$1(uastring, 'safari') || contains$1(uastring, 'mobile/')) && contains$1(uastring, 'applewebkit');\n    }\n  }];\n  var oses = [{\n    name: 'Windows',\n    search: checkContains('win'),\n    versionRegexes: [/.*?windows\\ nt\\ ?([0-9]+)\\.([0-9]+).*/]\n  }, {\n    name: 'iOS',\n    search: function (uastring) {\n      return contains$1(uastring, 'iphone') || contains$1(uastring, 'ipad');\n    },\n    versionRegexes: [/.*?version\\/\\ ?([0-9]+)\\.([0-9]+).*/, /.*cpu os ([0-9]+)_([0-9]+).*/, /.*cpu iphone os ([0-9]+)_([0-9]+).*/]\n  }, {\n    name: 'Android',\n    search: checkContains('android'),\n    versionRegexes: [/.*?android\\ ?([0-9]+)\\.([0-9]+).*/]\n  }, {\n    name: 'OSX',\n    search: checkContains('mac os x'),\n    versionRegexes: [/.*?mac\\ os\\ x\\ ?([0-9]+)_([0-9]+).*/]\n  }, {\n    name: 'Linux',\n    search: checkContains('linux'),\n    versionRegexes: []\n  }, {\n    name: 'Solaris',\n    search: checkContains('sunos'),\n    versionRegexes: []\n  }, {\n    name: 'FreeBSD',\n    search: checkContains('freebsd'),\n    versionRegexes: []\n  }, {\n    name: 'ChromeOS',\n    search: checkContains('cros'),\n    versionRegexes: [/.*?chrome\\/([0-9]+)\\.([0-9]+).*/]\n  }];\n  var PlatformInfo = {\n    browsers: constant(browsers),\n    oses: constant(oses)\n  };\n  var edge = 'Edge';\n  var chrome = 'Chrome';\n  var ie = 'IE';\n  var opera = 'Opera';\n  var firefox = 'Firefox';\n  var safari = 'Safari';\n\n  var unknown$1 = function () {\n    return nu$2({\n      current: undefined,\n      version: Version.unknown()\n    });\n  };\n\n  var nu$2 = function (info) {\n    var current = info.current;\n    var version = info.version;\n\n    var isBrowser = function (name) {\n      return function () {\n        return current === name;\n      };\n    };\n\n    return {\n      current: current,\n      version: version,\n      isEdge: isBrowser(edge),\n      isChrome: isBrowser(chrome),\n      isIE: isBrowser(ie),\n      isOpera: isBrowser(opera),\n      isFirefox: isBrowser(firefox),\n      isSafari: isBrowser(safari)\n    };\n  };\n\n  var Browser = {\n    unknown: unknown$1,\n    nu: nu$2,\n    edge: constant(edge),\n    chrome: constant(chrome),\n    ie: constant(ie),\n    opera: constant(opera),\n    firefox: constant(firefox),\n    safari: constant(safari)\n  };\n  var windows = 'Windows';\n  var ios = 'iOS';\n  var android = 'Android';\n  var linux = 'Linux';\n  var osx = 'OSX';\n  var solaris = 'Solaris';\n  var freebsd = 'FreeBSD';\n  var chromeos = 'ChromeOS';\n\n  var unknown$2 = function () {\n    return nu$3({\n      current: undefined,\n      version: Version.unknown()\n    });\n  };\n\n  var nu$3 = function (info) {\n    var current = info.current;\n    var version = info.version;\n\n    var isOS = function (name) {\n      return function () {\n        return current === name;\n      };\n    };\n\n    return {\n      current: current,\n      version: version,\n      isWindows: isOS(windows),\n      isiOS: isOS(ios),\n      isAndroid: isOS(android),\n      isOSX: isOS(osx),\n      isLinux: isOS(linux),\n      isSolaris: isOS(solaris),\n      isFreeBSD: isOS(freebsd),\n      isChromeOS: isOS(chromeos)\n    };\n  };\n\n  var OperatingSystem = {\n    unknown: unknown$2,\n    nu: nu$3,\n    windows: constant(windows),\n    ios: constant(ios),\n    android: constant(android),\n    linux: constant(linux),\n    osx: constant(osx),\n    solaris: constant(solaris),\n    freebsd: constant(freebsd),\n    chromeos: constant(chromeos)\n  };\n\n  var detect$2 = function (userAgent, mediaMatch) {\n    var browsers = PlatformInfo.browsers();\n    var oses = PlatformInfo.oses();\n    var browser = UaString.detectBrowser(browsers, userAgent).fold(Browser.unknown, Browser.nu);\n    var os = UaString.detectOs(oses, userAgent).fold(OperatingSystem.unknown, OperatingSystem.nu);\n    var deviceType = DeviceType(os, browser, userAgent, mediaMatch);\n    return {\n      browser: browser,\n      os: os,\n      deviceType: deviceType\n    };\n  };\n\n  var PlatformDetection = {\n    detect: detect$2\n  };\n\n  var mediaMatch = function (query) {\n    return window.matchMedia(query).matches;\n  };\n\n  var platform = cached(function () {\n    return PlatformDetection.detect(navigator.userAgent, mediaMatch);\n  });\n\n  var detect$3 = function () {\n    return platform();\n  };\n\n  var compareDocumentPosition = function (a, b, match) {\n    return (a.compareDocumentPosition(b) & match) !== 0;\n  };\n\n  var documentPositionContainedBy = function (a, b) {\n    return compareDocumentPosition(a, b, Node.DOCUMENT_POSITION_CONTAINED_BY);\n  };\n\n  var DOCUMENT = 9;\n  var DOCUMENT_FRAGMENT = 11;\n  var ELEMENT = 1;\n  var TEXT = 3;\n\n  var is = function (element, selector) {\n    var dom = element.dom;\n\n    if (dom.nodeType !== ELEMENT) {\n      return false;\n    } else {\n      var elem = dom;\n\n      if (elem.matches !== undefined) {\n        return elem.matches(selector);\n      } else if (elem.msMatchesSelector !== undefined) {\n        return elem.msMatchesSelector(selector);\n      } else if (elem.webkitMatchesSelector !== undefined) {\n        return elem.webkitMatchesSelector(selector);\n      } else if (elem.mozMatchesSelector !== undefined) {\n        return elem.mozMatchesSelector(selector);\n      } else {\n        throw new Error('Browser lacks native selectors');\n      }\n    }\n  };\n\n  var bypassSelector = function (dom) {\n    return dom.nodeType !== ELEMENT && dom.nodeType !== DOCUMENT && dom.nodeType !== DOCUMENT_FRAGMENT || dom.childElementCount === 0;\n  };\n\n  var all = function (selector, scope) {\n    var base = scope === undefined ? document : scope.dom;\n    return bypassSelector(base) ? [] : map(base.querySelectorAll(selector), SugarElement.fromDom);\n  };\n\n  var one = function (selector, scope) {\n    var base = scope === undefined ? document : scope.dom;\n    return bypassSelector(base) ? Optional.none() : Optional.from(base.querySelector(selector)).map(SugarElement.fromDom);\n  };\n\n  var eq$1 = function (e1, e2) {\n    return e1.dom === e2.dom;\n  };\n\n  var regularContains = function (e1, e2) {\n    var d1 = e1.dom;\n    var d2 = e2.dom;\n    return d1 === d2 ? false : d1.contains(d2);\n  };\n\n  var ieContains = function (e1, e2) {\n    return documentPositionContainedBy(e1.dom, e2.dom);\n  };\n\n  var contains$2 = function (e1, e2) {\n    return detect$3().browser.isIE() ? ieContains(e1, e2) : regularContains(e1, e2);\n  };\n\n  var ensureIsRoot = function (isRoot) {\n    return isFunction(isRoot) ? isRoot : never;\n  };\n\n  var ancestor = function (scope, transform, isRoot) {\n    var element = scope.dom;\n    var stop = ensureIsRoot(isRoot);\n\n    while (element.parentNode) {\n      element = element.parentNode;\n      var el = SugarElement.fromDom(element);\n      var transformed = transform(el);\n\n      if (transformed.isSome()) {\n        return transformed;\n      } else if (stop(el)) {\n        break;\n      }\n    }\n\n    return Optional.none();\n  };\n\n  var closest = function (scope, transform, isRoot) {\n    var current = transform(scope);\n    var stop = ensureIsRoot(isRoot);\n    return current.orThunk(function () {\n      return stop(scope) ? Optional.none() : ancestor(scope, transform, stop);\n    });\n  };\n\n  var isSource = function (component, simulatedEvent) {\n    return eq$1(component.element, simulatedEvent.event.target);\n  };\n\n  var nu$4 = function (parts) {\n    if (!hasNonNullableKey(parts, 'can') && !hasNonNullableKey(parts, 'abort') && !hasNonNullableKey(parts, 'run')) {\n      throw new Error('EventHandler defined by: ' + JSON.stringify(parts, null, 2) + ' does not have can, abort, or run!');\n    }\n\n    return asRawOrDie('Extracting event.handler', objOfOnly([defaulted$1('can', always), defaulted$1('abort', never), defaulted$1('run', noop)]), parts);\n  };\n\n  var all$1 = function (handlers, f) {\n    return function () {\n      var args = [];\n\n      for (var _i = 0; _i < arguments.length; _i++) {\n        args[_i] = arguments[_i];\n      }\n\n      return foldl(handlers, function (acc, handler) {\n        return acc && f(handler).apply(undefined, args);\n      }, true);\n    };\n  };\n\n  var any = function (handlers, f) {\n    return function () {\n      var args = [];\n\n      for (var _i = 0; _i < arguments.length; _i++) {\n        args[_i] = arguments[_i];\n      }\n\n      return foldl(handlers, function (acc, handler) {\n        return acc || f(handler).apply(undefined, args);\n      }, false);\n    };\n  };\n\n  var read = function (handler) {\n    return isFunction(handler) ? {\n      can: always,\n      abort: never,\n      run: handler\n    } : handler;\n  };\n\n  var fuse = function (handlers) {\n    var can = all$1(handlers, function (handler) {\n      return handler.can;\n    });\n    var abort = any(handlers, function (handler) {\n      return handler.abort;\n    });\n\n    var run = function () {\n      var args = [];\n\n      for (var _i = 0; _i < arguments.length; _i++) {\n        args[_i] = arguments[_i];\n      }\n\n      each(handlers, function (handler) {\n        handler.run.apply(undefined, args);\n      });\n    };\n\n    return nu$4({\n      can: can,\n      abort: abort,\n      run: run\n    });\n  };\n\n  var constant$1 = constant;\n  var touchstart = constant$1('touchstart');\n  var touchmove = constant$1('touchmove');\n  var touchend = constant$1('touchend');\n  var touchcancel = constant$1('touchcancel');\n  var mousedown = constant$1('mousedown');\n  var mousemove = constant$1('mousemove');\n  var mouseout = constant$1('mouseout');\n  var mouseup = constant$1('mouseup');\n  var mouseover = constant$1('mouseover');\n  var focusin = constant$1('focusin');\n  var focusout = constant$1('focusout');\n  var keydown = constant$1('keydown');\n  var keyup = constant$1('keyup');\n  var input = constant$1('input');\n  var change = constant$1('change');\n  var click = constant$1('click');\n  var transitionend = constant$1('transitionend');\n  var selectstart = constant$1('selectstart');\n\n  var prefixName = function (name) {\n    return constant('alloy.' + name);\n  };\n\n  var alloy = {\n    tap: prefixName('tap')\n  };\n  var focus = prefixName('focus');\n  var postBlur = prefixName('blur.post');\n  var postPaste = prefixName('paste.post');\n  var receive = prefixName('receive');\n  var execute = prefixName('execute');\n  var focusItem = prefixName('focus.item');\n  var tap = alloy.tap;\n  var longpress = prefixName('longpress');\n  var sandboxClose = prefixName('sandbox.close');\n  var typeaheadCancel = prefixName('typeahead.cancel');\n  var systemInit = prefixName('system.init');\n  var documentTouchmove = prefixName('system.touchmove');\n  var documentTouchend = prefixName('system.touchend');\n  var windowScroll = prefixName('system.scroll');\n  var windowResize = prefixName('system.resize');\n  var attachedToDom = prefixName('system.attached');\n  var detachedFromDom = prefixName('system.detached');\n  var dismissRequested = prefixName('system.dismissRequested');\n  var repositionRequested = prefixName('system.repositionRequested');\n  var focusShifted = prefixName('focusmanager.shifted');\n  var slotVisibility = prefixName('slotcontainer.visibility');\n  var changeTab = prefixName('change.tab');\n  var dismissTab = prefixName('dismiss.tab');\n  var highlight = prefixName('highlight');\n  var dehighlight = prefixName('dehighlight');\n\n  var emit = function (component, event) {\n    dispatchWith(component, component.element, event, {});\n  };\n\n  var emitWith = function (component, event, properties) {\n    dispatchWith(component, component.element, event, properties);\n  };\n\n  var emitExecute = function (component) {\n    emit(component, execute());\n  };\n\n  var dispatch = function (component, target, event) {\n    dispatchWith(component, target, event, {});\n  };\n\n  var dispatchWith = function (component, target, event, properties) {\n    var data = __assign({\n      target: target\n    }, properties);\n\n    component.getSystem().triggerEvent(event, target, data);\n  };\n\n  var dispatchEvent = function (component, target, event, simulatedEvent) {\n    component.getSystem().triggerEvent(event, target, simulatedEvent.event);\n  };\n\n  var derive = function (configs) {\n    return wrapAll$1(configs);\n  };\n\n  var abort = function (name, predicate) {\n    return {\n      key: name,\n      value: nu$4({\n        abort: predicate\n      })\n    };\n  };\n\n  var can = function (name, predicate) {\n    return {\n      key: name,\n      value: nu$4({\n        can: predicate\n      })\n    };\n  };\n\n  var preventDefault = function (name) {\n    return {\n      key: name,\n      value: nu$4({\n        run: function (component, simulatedEvent) {\n          simulatedEvent.event.prevent();\n        }\n      })\n    };\n  };\n\n  var run = function (name, handler) {\n    return {\n      key: name,\n      value: nu$4({\n        run: handler\n      })\n    };\n  };\n\n  var runActionExtra = function (name, action, extra) {\n    return {\n      key: name,\n      value: nu$4({\n        run: function (component, simulatedEvent) {\n          action.apply(undefined, [component, simulatedEvent].concat(extra));\n        }\n      })\n    };\n  };\n\n  var runOnName = function (name) {\n    return function (handler) {\n      return run(name, handler);\n    };\n  };\n\n  var runOnSourceName = function (name) {\n    return function (handler) {\n      return {\n        key: name,\n        value: nu$4({\n          run: function (component, simulatedEvent) {\n            if (isSource(component, simulatedEvent)) {\n              handler(component, simulatedEvent);\n            }\n          }\n        })\n      };\n    };\n  };\n\n  var redirectToUid = function (name, uid) {\n    return run(name, function (component, simulatedEvent) {\n      component.getSystem().getByUid(uid).each(function (redirectee) {\n        dispatchEvent(redirectee, redirectee.element, name, simulatedEvent);\n      });\n    });\n  };\n\n  var redirectToPart = function (name, detail, partName) {\n    var uid = detail.partUids[partName];\n    return redirectToUid(name, uid);\n  };\n\n  var runWithTarget = function (name, f) {\n    return run(name, function (component, simulatedEvent) {\n      var ev = simulatedEvent.event;\n      var target = component.getSystem().getByDom(ev.target).fold(function () {\n        var closest$1 = closest(ev.target, function (el) {\n          return component.getSystem().getByDom(el).toOptional();\n        }, never);\n        return closest$1.getOr(component);\n      }, function (c) {\n        return c;\n      });\n      f(component, target, simulatedEvent);\n    });\n  };\n\n  var cutter = function (name) {\n    return run(name, function (component, simulatedEvent) {\n      simulatedEvent.cut();\n    });\n  };\n\n  var stopper = function (name) {\n    return run(name, function (component, simulatedEvent) {\n      simulatedEvent.stop();\n    });\n  };\n\n  var runOnSource = function (name, f) {\n    return runOnSourceName(name)(f);\n  };\n\n  var runOnAttached = runOnSourceName(attachedToDom());\n  var runOnDetached = runOnSourceName(detachedFromDom());\n  var runOnInit = runOnSourceName(systemInit());\n  var runOnExecute = runOnName(execute());\n  var Global = typeof window !== 'undefined' ? window : Function('return this;')();\n\n  var name = function (element) {\n    var r = element.dom.nodeName;\n    return r.toLowerCase();\n  };\n\n  var type = function (element) {\n    return element.dom.nodeType;\n  };\n\n  var isType$1 = function (t) {\n    return function (element) {\n      return type(element) === t;\n    };\n  };\n\n  var isElement = isType$1(ELEMENT);\n  var isText = isType$1(TEXT);\n  var isDocument = isType$1(DOCUMENT);\n  var isDocumentFragment = isType$1(DOCUMENT_FRAGMENT);\n\n  var owner = function (element) {\n    return SugarElement.fromDom(element.dom.ownerDocument);\n  };\n\n  var documentOrOwner = function (dos) {\n    return isDocument(dos) ? dos : owner(dos);\n  };\n\n  var documentElement = function (element) {\n    return SugarElement.fromDom(documentOrOwner(element).dom.documentElement);\n  };\n\n  var defaultView = function (element) {\n    return SugarElement.fromDom(documentOrOwner(element).dom.defaultView);\n  };\n\n  var parent = function (element) {\n    return Optional.from(element.dom.parentNode).map(SugarElement.fromDom);\n  };\n\n  var parentNode = function (element) {\n    return parent(element);\n  };\n\n  var offsetParent = function (element) {\n    return Optional.from(element.dom.offsetParent).map(SugarElement.fromDom);\n  };\n\n  var nextSibling = function (element) {\n    return Optional.from(element.dom.nextSibling).map(SugarElement.fromDom);\n  };\n\n  var children = function (element) {\n    return map(element.dom.childNodes, SugarElement.fromDom);\n  };\n\n  var child = function (element, index) {\n    var cs = element.dom.childNodes;\n    return Optional.from(cs[index]).map(SugarElement.fromDom);\n  };\n\n  var firstChild = function (element) {\n    return child(element, 0);\n  };\n\n  var isShadowRoot = function (dos) {\n    return isDocumentFragment(dos) && isNonNullable(dos.dom.host);\n  };\n\n  var supported = isFunction(Element.prototype.attachShadow) && isFunction(Node.prototype.getRootNode);\n  var isSupported = constant(supported);\n  var getRootNode = supported ? function (e) {\n    return SugarElement.fromDom(e.dom.getRootNode());\n  } : documentOrOwner;\n\n  var getContentContainer = function (dos) {\n    return isShadowRoot(dos) ? dos : SugarElement.fromDom(documentOrOwner(dos).dom.body);\n  };\n\n  var isInShadowRoot = function (e) {\n    return getShadowRoot(e).isSome();\n  };\n\n  var getShadowRoot = function (e) {\n    var r = getRootNode(e);\n    return isShadowRoot(r) ? Optional.some(r) : Optional.none();\n  };\n\n  var getShadowHost = function (e) {\n    return SugarElement.fromDom(e.dom.host);\n  };\n\n  var getOriginalEventTarget = function (event) {\n    if (isSupported() && isNonNullable(event.target)) {\n      var el = SugarElement.fromDom(event.target);\n\n      if (isElement(el) && isOpenShadowHost(el)) {\n        if (event.composed && event.composedPath) {\n          var composedPath = event.composedPath();\n\n          if (composedPath) {\n            return head(composedPath);\n          }\n        }\n      }\n    }\n\n    return Optional.from(event.target);\n  };\n\n  var isOpenShadowHost = function (element) {\n    return isNonNullable(element.dom.shadowRoot);\n  };\n\n  var before = function (marker, element) {\n    var parent$1 = parent(marker);\n    parent$1.each(function (v) {\n      v.dom.insertBefore(element.dom, marker.dom);\n    });\n  };\n\n  var after = function (marker, element) {\n    var sibling = nextSibling(marker);\n    sibling.fold(function () {\n      var parent$1 = parent(marker);\n      parent$1.each(function (v) {\n        append(v, element);\n      });\n    }, function (v) {\n      before(v, element);\n    });\n  };\n\n  var prepend = function (parent, element) {\n    var firstChild$1 = firstChild(parent);\n    firstChild$1.fold(function () {\n      append(parent, element);\n    }, function (v) {\n      parent.dom.insertBefore(element.dom, v.dom);\n    });\n  };\n\n  var append = function (parent, element) {\n    parent.dom.appendChild(element.dom);\n  };\n\n  var appendAt = function (parent, element, index) {\n    child(parent, index).fold(function () {\n      append(parent, element);\n    }, function (v) {\n      before(v, element);\n    });\n  };\n\n  var before$1 = function (marker, elements) {\n    each(elements, function (x) {\n      before(marker, x);\n    });\n  };\n\n  var append$1 = function (parent, elements) {\n    each(elements, function (x) {\n      append(parent, x);\n    });\n  };\n\n  var empty = function (element) {\n    element.dom.textContent = '';\n    each(children(element), function (rogue) {\n      remove(rogue);\n    });\n  };\n\n  var remove = function (element) {\n    var dom = element.dom;\n\n    if (dom.parentNode !== null) {\n      dom.parentNode.removeChild(dom);\n    }\n  };\n\n  var unwrap = function (wrapper) {\n    var children$1 = children(wrapper);\n\n    if (children$1.length > 0) {\n      before$1(wrapper, children$1);\n    }\n\n    remove(wrapper);\n  };\n\n  var fromHtml$1 = function (html, scope) {\n    var doc = scope || document;\n    var div = doc.createElement('div');\n    div.innerHTML = html;\n    return children(SugarElement.fromDom(div));\n  };\n\n  var get$2 = function (element) {\n    return element.dom.innerHTML;\n  };\n\n  var set = function (element, content) {\n    var owner$1 = owner(element);\n    var docDom = owner$1.dom;\n    var fragment = SugarElement.fromDom(docDom.createDocumentFragment());\n    var contentElements = fromHtml$1(content, docDom);\n    append$1(fragment, contentElements);\n    empty(element);\n    append(element, fragment);\n  };\n\n  var getOuter = function (element) {\n    var container = SugarElement.fromTag('div');\n    var clone = SugarElement.fromDom(element.dom.cloneNode(true));\n    append(container, clone);\n    return get$2(container);\n  };\n\n  var rawSet = function (dom, key, value) {\n    if (isString(value) || isBoolean(value) || isNumber(value)) {\n      dom.setAttribute(key, value + '');\n    } else {\n      console.error('Invalid call to Attribute.set. Key ', key, ':: Value ', value, ':: Element ', dom);\n      throw new Error('Attribute value was not simple');\n    }\n  };\n\n  var set$1 = function (element, key, value) {\n    rawSet(element.dom, key, value);\n  };\n\n  var setAll = function (element, attrs) {\n    var dom = element.dom;\n    each$1(attrs, function (v, k) {\n      rawSet(dom, k, v);\n    });\n  };\n\n  var get$3 = function (element, key) {\n    var v = element.dom.getAttribute(key);\n    return v === null ? undefined : v;\n  };\n\n  var getOpt = function (element, key) {\n    return Optional.from(get$3(element, key));\n  };\n\n  var has$1 = function (element, key) {\n    var dom = element.dom;\n    return dom && dom.hasAttribute ? dom.hasAttribute(key) : false;\n  };\n\n  var remove$1 = function (element, key) {\n    element.dom.removeAttribute(key);\n  };\n\n  var clone = function (original, isDeep) {\n    return SugarElement.fromDom(original.dom.cloneNode(isDeep));\n  };\n\n  var shallow$1 = function (original) {\n    return clone(original, false);\n  };\n\n  var getHtml = function (element) {\n    if (isShadowRoot(element)) {\n      return '#shadow-root';\n    } else {\n      var clone = shallow$1(element);\n      return getOuter(clone);\n    }\n  };\n\n  var element = function (elem) {\n    return getHtml(elem);\n  };\n\n  var isRecursive = function (component, originator, target) {\n    return eq$1(originator, component.element) && !eq$1(originator, target);\n  };\n\n  var events = derive([can(focus(), function (component, simulatedEvent) {\n    var event = simulatedEvent.event;\n    var originator = event.originator;\n    var target = event.target;\n\n    if (isRecursive(component, originator, target)) {\n      console.warn(focus() + ' did not get interpreted by the desired target. ' + '\\nOriginator: ' + element(originator) + '\\nTarget: ' + element(target) + '\\nCheck the ' + focus() + ' event handlers');\n      return false;\n    } else {\n      return true;\n    }\n  })]);\n  var DefaultEvents = /*#__PURE__*/Object.freeze({\n    __proto__: null,\n    events: events\n  });\n  var unique = 0;\n\n  var generate$1 = function (prefix) {\n    var date = new Date();\n    var time = date.getTime();\n    var random = Math.floor(Math.random() * 1000000000);\n    unique++;\n    return prefix + '_' + random + unique + String(time);\n  };\n\n  var prefix = constant('alloy-id-');\n  var idAttr = constant('data-alloy-id');\n  var prefix$1 = prefix();\n  var idAttr$1 = idAttr();\n\n  var write = function (label, elem) {\n    var id = generate$1(prefix$1 + label);\n    writeOnly(elem, id);\n    return id;\n  };\n\n  var writeOnly = function (elem, uid) {\n    Object.defineProperty(elem.dom, idAttr$1, {\n      value: uid,\n      writable: true\n    });\n  };\n\n  var read$1 = function (elem) {\n    var id = isElement(elem) ? elem.dom[idAttr$1] : null;\n    return Optional.from(id);\n  };\n\n  var generate$2 = function (prefix) {\n    return generate$1(prefix);\n  };\n\n  var make = identity;\n\n  var NoContextApi = function (getComp) {\n    var fail = function (event) {\n      return function () {\n        throw new Error('The component must be in a context to send: ' + event + (getComp ? '\\n' + element(getComp().element) + ' is not in context.' : ''));\n      };\n    };\n\n    return {\n      debugInfo: constant('fake'),\n      triggerEvent: fail('triggerEvent'),\n      triggerFocus: fail('triggerFocus'),\n      triggerEscape: fail('triggerEscape'),\n      build: fail('build'),\n      addToWorld: fail('addToWorld'),\n      removeFromWorld: fail('removeFromWorld'),\n      addToGui: fail('addToGui'),\n      removeFromGui: fail('removeFromGui'),\n      getByUid: fail('getByUid'),\n      getByDom: fail('getByDom'),\n      broadcast: fail('broadcast'),\n      broadcastOn: fail('broadcastOn'),\n      broadcastEvent: fail('broadcastEvent'),\n      isConnected: never\n    };\n  };\n\n  var singleton = NoContextApi();\n\n  var markAsBehaviourApi = function (f, apiName, apiFunction) {\n    var delegate = apiFunction.toString();\n    var endIndex = delegate.indexOf(')') + 1;\n    var openBracketIndex = delegate.indexOf('(');\n    var parameters = delegate.substring(openBracketIndex + 1, endIndex - 1).split(/,\\s*/);\n\n    f.toFunctionAnnotation = function () {\n      return {\n        name: apiName,\n        parameters: cleanParameters(parameters.slice(0, 1).concat(parameters.slice(3)))\n      };\n    };\n\n    return f;\n  };\n\n  var cleanParameters = function (parameters) {\n    return map(parameters, function (p) {\n      return endsWith(p, '/*') ? p.substring(0, p.length - '/*'.length) : p;\n    });\n  };\n\n  var markAsExtraApi = function (f, extraName) {\n    var delegate = f.toString();\n    var endIndex = delegate.indexOf(')') + 1;\n    var openBracketIndex = delegate.indexOf('(');\n    var parameters = delegate.substring(openBracketIndex + 1, endIndex - 1).split(/,\\s*/);\n\n    f.toFunctionAnnotation = function () {\n      return {\n        name: extraName,\n        parameters: cleanParameters(parameters)\n      };\n    };\n\n    return f;\n  };\n\n  var markAsSketchApi = function (f, apiFunction) {\n    var delegate = apiFunction.toString();\n    var endIndex = delegate.indexOf(')') + 1;\n    var openBracketIndex = delegate.indexOf('(');\n    var parameters = delegate.substring(openBracketIndex + 1, endIndex - 1).split(/,\\s*/);\n\n    f.toFunctionAnnotation = function () {\n      return {\n        name: 'OVERRIDE',\n        parameters: cleanParameters(parameters.slice(1))\n      };\n    };\n\n    return f;\n  };\n\n  var premadeTag = generate$1('alloy-premade');\n\n  var premade = function (comp) {\n    return wrap$1(premadeTag, comp);\n  };\n\n  var getPremade = function (spec) {\n    return get$1(spec, premadeTag);\n  };\n\n  var makeApi = function (f) {\n    return markAsSketchApi(function (component) {\n      var rest = [];\n\n      for (var _i = 1; _i < arguments.length; _i++) {\n        rest[_i - 1] = arguments[_i];\n      }\n\n      return f.apply(void 0, __spreadArrays([component.getApis(), component], rest));\n    }, f);\n  };\n\n  var NoState = {\n    init: function () {\n      return nu$5({\n        readState: function () {\n          return 'No State required';\n        }\n      });\n    }\n  };\n\n  var nu$5 = function (spec) {\n    return spec;\n  };\n\n  var generateFrom = function (spec, all) {\n    var schema = map(all, function (a) {\n      return optionObjOf(a.name(), [strict$1('config'), defaulted$1('state', NoState)]);\n    });\n    var validated = asRaw('component.behaviours', objOf(schema), spec.behaviours).fold(function (errInfo) {\n      throw new Error(formatError(errInfo) + '\\nComplete spec:\\n' + JSON.stringify(spec, null, 2));\n    }, function (v) {\n      return v;\n    });\n    return {\n      list: all,\n      data: map$2(validated, function (optBlobThunk) {\n        var output = optBlobThunk.map(function (blob) {\n          return {\n            config: blob.config,\n            state: blob.state.init(blob.config)\n          };\n        });\n        return function () {\n          return output;\n        };\n      })\n    };\n  };\n\n  var getBehaviours = function (bData) {\n    return bData.list;\n  };\n\n  var getData = function (bData) {\n    return bData.data;\n  };\n\n  var byInnerKey = function (data, tuple) {\n    var r = {};\n    each$1(data, function (detail, key) {\n      each$1(detail, function (value, indexKey) {\n        var chain = get$1(r, indexKey).getOr([]);\n        r[indexKey] = chain.concat([tuple(key, value)]);\n      });\n    });\n    return r;\n  };\n\n  var nu$6 = function (s) {\n    return {\n      classes: s.classes !== undefined ? s.classes : [],\n      attributes: s.attributes !== undefined ? s.attributes : {},\n      styles: s.styles !== undefined ? s.styles : {}\n    };\n  };\n\n  var merge$1 = function (defnA, mod) {\n    return __assign(__assign({}, defnA), {\n      attributes: __assign(__assign({}, defnA.attributes), mod.attributes),\n      styles: __assign(__assign({}, defnA.styles), mod.styles),\n      classes: defnA.classes.concat(mod.classes)\n    });\n  };\n\n  var combine = function (info, baseMod, behaviours, base) {\n    var modsByBehaviour = __assign({}, baseMod);\n\n    each(behaviours, function (behaviour) {\n      modsByBehaviour[behaviour.name()] = behaviour.exhibit(info, base);\n    });\n    var byAspect = byInnerKey(modsByBehaviour, function (name, modification) {\n      return {\n        name: name,\n        modification: modification\n      };\n    });\n\n    var combineObjects = function (objects) {\n      return foldr(objects, function (b, a) {\n        return __assign(__assign({}, a.modification), b);\n      }, {});\n    };\n\n    var combinedClasses = foldr(byAspect.classes, function (b, a) {\n      return a.modification.concat(b);\n    }, []);\n    var combinedAttributes = combineObjects(byAspect.attributes);\n    var combinedStyles = combineObjects(byAspect.styles);\n    return nu$6({\n      classes: combinedClasses,\n      attributes: combinedAttributes,\n      styles: combinedStyles\n    });\n  };\n\n  var sortKeys = function (label, keyName, array, order) {\n    try {\n      var sorted = sort(array, function (a, b) {\n        var aKey = a[keyName];\n        var bKey = b[keyName];\n        var aIndex = order.indexOf(aKey);\n        var bIndex = order.indexOf(bKey);\n\n        if (aIndex === -1) {\n          throw new Error('The ordering for ' + label + ' does not have an entry for ' + aKey + '.\\nOrder specified: ' + JSON.stringify(order, null, 2));\n        }\n\n        if (bIndex === -1) {\n          throw new Error('The ordering for ' + label + ' does not have an entry for ' + bKey + '.\\nOrder specified: ' + JSON.stringify(order, null, 2));\n        }\n\n        if (aIndex < bIndex) {\n          return -1;\n        } else if (bIndex < aIndex) {\n          return 1;\n        } else {\n          return 0;\n        }\n      });\n      return Result.value(sorted);\n    } catch (err) {\n      return Result.error([err]);\n    }\n  };\n\n  var uncurried = function (handler, purpose) {\n    return {\n      handler: handler,\n      purpose: purpose\n    };\n  };\n\n  var curried = function (handler, purpose) {\n    return {\n      cHandler: handler,\n      purpose: purpose\n    };\n  };\n\n  var curryArgs = function (descHandler, extraArgs) {\n    return curried(curry.apply(undefined, [descHandler.handler].concat(extraArgs)), descHandler.purpose);\n  };\n\n  var getCurried = function (descHandler) {\n    return descHandler.cHandler;\n  };\n\n  var behaviourTuple = function (name, handler) {\n    return {\n      name: name,\n      handler: handler\n    };\n  };\n\n  var nameToHandlers = function (behaviours, info) {\n    var r = {};\n    each(behaviours, function (behaviour) {\n      r[behaviour.name()] = behaviour.handlers(info);\n    });\n    return r;\n  };\n\n  var groupByEvents = function (info, behaviours, base) {\n    var behaviourEvents = __assign(__assign({}, base), nameToHandlers(behaviours, info));\n\n    return byInnerKey(behaviourEvents, behaviourTuple);\n  };\n\n  var combine$1 = function (info, eventOrder, behaviours, base) {\n    var byEventName = groupByEvents(info, behaviours, base);\n    return combineGroups(byEventName, eventOrder);\n  };\n\n  var assemble = function (rawHandler) {\n    var handler = read(rawHandler);\n    return function (component, simulatedEvent) {\n      var rest = [];\n\n      for (var _i = 2; _i < arguments.length; _i++) {\n        rest[_i - 2] = arguments[_i];\n      }\n\n      var args = [component, simulatedEvent].concat(rest);\n\n      if (handler.abort.apply(undefined, args)) {\n        simulatedEvent.stop();\n      } else if (handler.can.apply(undefined, args)) {\n        handler.run.apply(undefined, args);\n      }\n    };\n  };\n\n  var missingOrderError = function (eventName, tuples) {\n    return Result.error(['The event (' + eventName + ') has more than one behaviour that listens to it.\\nWhen this occurs, you must ' + 'specify an event ordering for the behaviours in your spec (e.g. [ \"listing\", \"toggling\" ]).\\nThe behaviours that ' + 'can trigger it are: ' + JSON.stringify(map(tuples, function (c) {\n      return c.name;\n    }), null, 2)]);\n  };\n\n  var fuse$1 = function (tuples, eventOrder, eventName) {\n    var order = eventOrder[eventName];\n\n    if (!order) {\n      return missingOrderError(eventName, tuples);\n    } else {\n      return sortKeys('Event: ' + eventName, 'name', tuples, order).map(function (sortedTuples) {\n        var handlers = map(sortedTuples, function (tuple) {\n          return tuple.handler;\n        });\n        return fuse(handlers);\n      });\n    }\n  };\n\n  var combineGroups = function (byEventName, eventOrder) {\n    var r = mapToArray(byEventName, function (tuples, eventName) {\n      var combined = tuples.length === 1 ? Result.value(tuples[0].handler) : fuse$1(tuples, eventOrder, eventName);\n      return combined.map(function (handler) {\n        var assembled = assemble(handler);\n        var purpose = tuples.length > 1 ? filter(eventOrder[eventName], function (o) {\n          return exists(tuples, function (t) {\n            return t.name === o;\n          });\n        }).join(' > ') : tuples[0].name;\n        return wrap$1(eventName, uncurried(assembled, purpose));\n      });\n    });\n    return consolidate(r, {});\n  };\n\n  var baseBehaviour = 'alloy.base.behaviour';\n\n  var toInfo = function (spec) {\n    var _a;\n\n    return asRaw('custom.definition', objOf([field('dom', 'dom', strict(), objOf([strict$1('tag'), defaulted$1('styles', {}), defaulted$1('classes', []), defaulted$1('attributes', {}), option('value'), option('innerHtml')])), strict$1('components'), strict$1('uid'), defaulted$1('events', {}), defaulted$1('apis', {}), field('eventOrder', 'eventOrder', mergeWith((_a = {}, _a[execute()] = ['disabling', baseBehaviour, 'toggling', 'typeaheadevents'], _a[focus()] = [baseBehaviour, 'focusing', 'keying'], _a[systemInit()] = [baseBehaviour, 'disabling', 'toggling', 'representing'], _a[input()] = [baseBehaviour, 'representing', 'streaming', 'invalidating'], _a[detachedFromDom()] = [baseBehaviour, 'representing', 'item-events', 'tooltipping'], _a[mousedown()] = ['focusing', baseBehaviour, 'item-type-events'], _a[touchstart()] = ['focusing', baseBehaviour, 'item-type-events'], _a[mouseover()] = ['item-type-events', 'tooltipping'], _a[receive()] = ['receiving', 'reflecting', 'tooltipping'], _a)), anyValue$1()), option('domModification')]), spec);\n  };\n\n  var toDefinition = function (detail) {\n    return __assign(__assign({}, detail.dom), {\n      uid: detail.uid,\n      domChildren: map(detail.components, function (comp) {\n        return comp.element;\n      })\n    });\n  };\n\n  var toModification = function (detail) {\n    return detail.domModification.fold(function () {\n      return nu$6({});\n    }, nu$6);\n  };\n\n  var toEvents = function (info) {\n    return info.events;\n  };\n\n  var read$2 = function (element, attr) {\n    var value = get$3(element, attr);\n    return value === undefined || value === '' ? [] : value.split(' ');\n  };\n\n  var add = function (element, attr, id) {\n    var old = read$2(element, attr);\n    var nu = old.concat([id]);\n    set$1(element, attr, nu.join(' '));\n    return true;\n  };\n\n  var remove$2 = function (element, attr, id) {\n    var nu = filter(read$2(element, attr), function (v) {\n      return v !== id;\n    });\n\n    if (nu.length > 0) {\n      set$1(element, attr, nu.join(' '));\n    } else {\n      remove$1(element, attr);\n    }\n\n    return false;\n  };\n\n  var supports = function (element) {\n    return element.dom.classList !== undefined;\n  };\n\n  var get$4 = function (element) {\n    return read$2(element, 'class');\n  };\n\n  var add$1 = function (element, clazz) {\n    return add(element, 'class', clazz);\n  };\n\n  var remove$3 = function (element, clazz) {\n    return remove$2(element, 'class', clazz);\n  };\n\n  var add$2 = function (element, clazz) {\n    if (supports(element)) {\n      element.dom.classList.add(clazz);\n    } else {\n      add$1(element, clazz);\n    }\n  };\n\n  var cleanClass = function (element) {\n    var classList = supports(element) ? element.dom.classList : get$4(element);\n\n    if (classList.length === 0) {\n      remove$1(element, 'class');\n    }\n  };\n\n  var remove$4 = function (element, clazz) {\n    if (supports(element)) {\n      var classList = element.dom.classList;\n      classList.remove(clazz);\n    } else {\n      remove$3(element, clazz);\n    }\n\n    cleanClass(element);\n  };\n\n  var has$2 = function (element, clazz) {\n    return supports(element) && element.dom.classList.contains(clazz);\n  };\n\n  var add$3 = function (element, classes) {\n    each(classes, function (x) {\n      add$2(element, x);\n    });\n  };\n\n  var remove$5 = function (element, classes) {\n    each(classes, function (x) {\n      remove$4(element, x);\n    });\n  };\n\n  var isSupported$1 = function (dom) {\n    return dom.style !== undefined && isFunction(dom.style.getPropertyValue);\n  };\n\n  var inBody = function (element) {\n    var dom = isText(element) ? element.dom.parentNode : element.dom;\n\n    if (dom === undefined || dom === null || dom.ownerDocument === null) {\n      return false;\n    }\n\n    var doc = dom.ownerDocument;\n    return getShadowRoot(SugarElement.fromDom(dom)).fold(function () {\n      return doc.body.contains(dom);\n    }, compose1(inBody, getShadowHost));\n  };\n\n  var body = function () {\n    return getBody(SugarElement.fromDom(document));\n  };\n\n  var getBody = function (doc) {\n    var b = doc.dom.body;\n\n    if (b === null || b === undefined) {\n      throw new Error('Body is not available yet');\n    }\n\n    return SugarElement.fromDom(b);\n  };\n\n  var internalSet = function (dom, property, value) {\n    if (!isString(value)) {\n      console.error('Invalid call to CSS.set. Property ', property, ':: Value ', value, ':: Element ', dom);\n      throw new Error('CSS value must be a string: ' + value);\n    }\n\n    if (isSupported$1(dom)) {\n      dom.style.setProperty(property, value);\n    }\n  };\n\n  var internalRemove = function (dom, property) {\n    if (isSupported$1(dom)) {\n      dom.style.removeProperty(property);\n    }\n  };\n\n  var set$2 = function (element, property, value) {\n    var dom = element.dom;\n    internalSet(dom, property, value);\n  };\n\n  var setAll$1 = function (element, css) {\n    var dom = element.dom;\n    each$1(css, function (v, k) {\n      internalSet(dom, k, v);\n    });\n  };\n\n  var setOptions = function (element, css) {\n    var dom = element.dom;\n    each$1(css, function (v, k) {\n      v.fold(function () {\n        internalRemove(dom, k);\n      }, function (value) {\n        internalSet(dom, k, value);\n      });\n    });\n  };\n\n  var get$5 = function (element, property) {\n    var dom = element.dom;\n    var styles = window.getComputedStyle(dom);\n    var r = styles.getPropertyValue(property);\n    return r === '' && !inBody(element) ? getUnsafeProperty(dom, property) : r;\n  };\n\n  var getUnsafeProperty = function (dom, property) {\n    return isSupported$1(dom) ? dom.style.getPropertyValue(property) : '';\n  };\n\n  var getRaw = function (element, property) {\n    var dom = element.dom;\n    var raw = getUnsafeProperty(dom, property);\n    return Optional.from(raw).filter(function (r) {\n      return r.length > 0;\n    });\n  };\n\n  var getAllRaw = function (element) {\n    var css = {};\n    var dom = element.dom;\n\n    if (isSupported$1(dom)) {\n      for (var i = 0; i < dom.style.length; i++) {\n        var ruleName = dom.style.item(i);\n        css[ruleName] = dom.style[ruleName];\n      }\n    }\n\n    return css;\n  };\n\n  var isValidValue = function (tag, property, value) {\n    var element = SugarElement.fromTag(tag);\n    set$2(element, property, value);\n    var style = getRaw(element, property);\n    return style.isSome();\n  };\n\n  var remove$6 = function (element, property) {\n    var dom = element.dom;\n    internalRemove(dom, property);\n\n    if (getOpt(element, 'style').map(trim).is('')) {\n      remove$1(element, 'style');\n    }\n  };\n\n  var reflow = function (e) {\n    return e.dom.offsetWidth;\n  };\n\n  var get$6 = function (element) {\n    return element.dom.value;\n  };\n\n  var set$3 = function (element, value) {\n    if (value === undefined) {\n      throw new Error('Value.set was undefined');\n    }\n\n    element.dom.value = value;\n  };\n\n  var renderToDom = function (definition) {\n    var subject = SugarElement.fromTag(definition.tag);\n    setAll(subject, definition.attributes);\n    add$3(subject, definition.classes);\n    setAll$1(subject, definition.styles);\n    definition.innerHtml.each(function (html) {\n      return set(subject, html);\n    });\n    var children = definition.domChildren;\n    append$1(subject, children);\n    definition.value.each(function (value) {\n      set$3(subject, value);\n    });\n\n    if (!definition.uid) {\n      debugger;\n    }\n\n    writeOnly(subject, definition.uid);\n    return subject;\n  };\n\n  var getBehaviours$1 = function (spec) {\n    var behaviours = get$1(spec, 'behaviours').getOr({});\n    var keys$1 = filter(keys(behaviours), function (k) {\n      return behaviours[k] !== undefined;\n    });\n    return map(keys$1, function (k) {\n      return behaviours[k].me;\n    });\n  };\n\n  var generateFrom$1 = function (spec, all) {\n    return generateFrom(spec, all);\n  };\n\n  var generate$3 = function (spec) {\n    var all = getBehaviours$1(spec);\n    return generateFrom$1(spec, all);\n  };\n\n  var getDomDefinition = function (info, bList, bData) {\n    var definition = toDefinition(info);\n    var infoModification = toModification(info);\n    var baseModification = {\n      'alloy.base.modification': infoModification\n    };\n    var modification = bList.length > 0 ? combine(bData, baseModification, bList, definition) : infoModification;\n    return merge$1(definition, modification);\n  };\n\n  var getEvents = function (info, bList, bData) {\n    var baseEvents = {\n      'alloy.base.behaviour': toEvents(info)\n    };\n    return combine$1(bData, info.eventOrder, bList, baseEvents).getOrDie();\n  };\n\n  var build = function (spec) {\n    var getMe = function () {\n      return me;\n    };\n\n    var systemApi = Cell(singleton);\n    var info = getOrDie(toInfo(spec));\n    var bBlob = generate$3(spec);\n    var bList = getBehaviours(bBlob);\n    var bData = getData(bBlob);\n    var modDefinition = getDomDefinition(info, bList, bData);\n    var item = renderToDom(modDefinition);\n    var events = getEvents(info, bList, bData);\n    var subcomponents = Cell(info.components);\n\n    var connect = function (newApi) {\n      systemApi.set(newApi);\n    };\n\n    var disconnect = function () {\n      systemApi.set(NoContextApi(getMe));\n    };\n\n    var syncComponents = function () {\n      var children$1 = children(item);\n      var subs = bind(children$1, function (child) {\n        return systemApi.get().getByDom(child).fold(function () {\n          return [];\n        }, function (c) {\n          return [c];\n        });\n      });\n      subcomponents.set(subs);\n    };\n\n    var config = function (behaviour) {\n      var b = bData;\n      var f = isFunction(b[behaviour.name()]) ? b[behaviour.name()] : function () {\n        throw new Error('Could not find ' + behaviour.name() + ' in ' + JSON.stringify(spec, null, 2));\n      };\n      return f();\n    };\n\n    var hasConfigured = function (behaviour) {\n      return isFunction(bData[behaviour.name()]);\n    };\n\n    var getApis = function () {\n      return info.apis;\n    };\n\n    var readState = function (behaviourName) {\n      return bData[behaviourName]().map(function (b) {\n        return b.state.readState();\n      }).getOr('not enabled');\n    };\n\n    var me = {\n      getSystem: systemApi.get,\n      config: config,\n      hasConfigured: hasConfigured,\n      spec: spec,\n      readState: readState,\n      getApis: getApis,\n      connect: connect,\n      disconnect: disconnect,\n      element: item,\n      syncComponents: syncComponents,\n      components: subcomponents.get,\n      events: events\n    };\n    return me;\n  };\n\n  var buildSubcomponents = function (spec) {\n    var components = get$1(spec, 'components').getOr([]);\n    return map(components, build$1);\n  };\n\n  var buildFromSpec = function (userSpec) {\n    var _a = make(userSpec),\n        specEvents = _a.events,\n        spec = __rest(_a, ['events']);\n\n    var components = buildSubcomponents(spec);\n\n    var completeSpec = __assign(__assign({}, spec), {\n      events: __assign(__assign({}, DefaultEvents), specEvents),\n      components: components\n    });\n\n    return Result.value(build(completeSpec));\n  };\n\n  var text = function (textContent) {\n    var element = SugarElement.fromText(textContent);\n    return external({\n      element: element\n    });\n  };\n\n  var external = function (spec) {\n    var extSpec = asRawOrDie('external.component', objOfOnly([strict$1('element'), option('uid')]), spec);\n    var systemApi = Cell(NoContextApi());\n\n    var connect = function (newApi) {\n      systemApi.set(newApi);\n    };\n\n    var disconnect = function () {\n      systemApi.set(NoContextApi(function () {\n        return me;\n      }));\n    };\n\n    extSpec.uid.each(function (uid) {\n      writeOnly(extSpec.element, uid);\n    });\n    var me = {\n      getSystem: systemApi.get,\n      config: Optional.none,\n      hasConfigured: never,\n      connect: connect,\n      disconnect: disconnect,\n      getApis: function () {\n        return {};\n      },\n      element: extSpec.element,\n      spec: spec,\n      readState: constant('No state'),\n      syncComponents: noop,\n      components: constant([]),\n      events: {}\n    };\n    return premade(me);\n  };\n\n  var uids = generate$2;\n\n  var build$1 = function (spec) {\n    return getPremade(spec).fold(function () {\n      var userSpecWithUid = spec.hasOwnProperty('uid') ? spec : __assign({\n        uid: uids('')\n      }, spec);\n      return buildFromSpec(userSpecWithUid).getOrDie();\n    }, function (prebuilt) {\n      return prebuilt;\n    });\n  };\n\n  var premade$1 = premade;\n\n  var Dimension = function (name, getOffset) {\n    var set = function (element, h) {\n      if (!isNumber(h) && !h.match(/^[0-9]+$/)) {\n        throw new Error(name + '.set accepts only positive integer values. Value was ' + h);\n      }\n\n      var dom = element.dom;\n\n      if (isSupported$1(dom)) {\n        dom.style[name] = h + 'px';\n      }\n    };\n\n    var get = function (element) {\n      var r = getOffset(element);\n\n      if (r <= 0 || r === null) {\n        var css = get$5(element, name);\n        return parseFloat(css) || 0;\n      }\n\n      return r;\n    };\n\n    var getOuter = get;\n\n    var aggregate = function (element, properties) {\n      return foldl(properties, function (acc, property) {\n        var val = get$5(element, property);\n        var value = val === undefined ? 0 : parseInt(val, 10);\n        return isNaN(value) ? acc : acc + value;\n      }, 0);\n    };\n\n    var max = function (element, value, properties) {\n      var cumulativeInclusions = aggregate(element, properties);\n      var absoluteMax = value > cumulativeInclusions ? value - cumulativeInclusions : 0;\n      return absoluteMax;\n    };\n\n    return {\n      set: set,\n      get: get,\n      getOuter: getOuter,\n      aggregate: aggregate,\n      max: max\n    };\n  };\n\n  var api = Dimension('height', function (element) {\n    var dom = element.dom;\n    return inBody(element) ? dom.getBoundingClientRect().height : dom.offsetHeight;\n  });\n\n  var get$7 = function (element) {\n    return api.get(element);\n  };\n\n  var getOuter$1 = function (element) {\n    return api.getOuter(element);\n  };\n\n  var setMax = function (element, value) {\n    var inclusions = ['margin-top', 'border-top-width', 'padding-top', 'padding-bottom', 'border-bottom-width', 'margin-bottom'];\n    var absMax = api.max(element, value, inclusions);\n    set$2(element, 'max-height', absMax + 'px');\n  };\n\n  var r = function (left, top) {\n    var translate = function (x, y) {\n      return r(left + x, top + y);\n    };\n\n    return {\n      left: left,\n      top: top,\n      translate: translate\n    };\n  };\n\n  var SugarPosition = r;\n\n  var boxPosition = function (dom) {\n    var box = dom.getBoundingClientRect();\n    return SugarPosition(box.left, box.top);\n  };\n\n  var firstDefinedOrZero = function (a, b) {\n    if (a !== undefined) {\n      return a;\n    } else {\n      return b !== undefined ? b : 0;\n    }\n  };\n\n  var absolute = function (element) {\n    var doc = element.dom.ownerDocument;\n    var body = doc.body;\n    var win = doc.defaultView;\n    var html = doc.documentElement;\n\n    if (body === element.dom) {\n      return SugarPosition(body.offsetLeft, body.offsetTop);\n    }\n\n    var scrollTop = firstDefinedOrZero(win === null || win === void 0 ? void 0 : win.pageYOffset, html.scrollTop);\n    var scrollLeft = firstDefinedOrZero(win === null || win === void 0 ? void 0 : win.pageXOffset, html.scrollLeft);\n    var clientTop = firstDefinedOrZero(html.clientTop, body.clientTop);\n    var clientLeft = firstDefinedOrZero(html.clientLeft, body.clientLeft);\n    return viewport(element).translate(scrollLeft - clientLeft, scrollTop - clientTop);\n  };\n\n  var viewport = function (element) {\n    var dom = element.dom;\n    var doc = dom.ownerDocument;\n    var body = doc.body;\n\n    if (body === dom) {\n      return SugarPosition(body.offsetLeft, body.offsetTop);\n    }\n\n    if (!inBody(element)) {\n      return SugarPosition(0, 0);\n    }\n\n    return boxPosition(dom);\n  };\n\n  var api$1 = Dimension('width', function (element) {\n    return element.dom.offsetWidth;\n  });\n\n  var set$4 = function (element, h) {\n    return api$1.set(element, h);\n  };\n\n  var get$8 = function (element) {\n    return api$1.get(element);\n  };\n\n  var getOuter$2 = function (element) {\n    return api$1.getOuter(element);\n  };\n\n  var setMax$1 = function (element, value) {\n    var inclusions = ['margin-left', 'border-left-width', 'padding-left', 'padding-right', 'border-right-width', 'margin-right'];\n    var absMax = api$1.max(element, value, inclusions);\n    set$2(element, 'max-width', absMax + 'px');\n  };\n\n  var mkEvent = function (target, x, y, stop, prevent, kill, raw) {\n    return {\n      target: target,\n      x: x,\n      y: y,\n      stop: stop,\n      prevent: prevent,\n      kill: kill,\n      raw: raw\n    };\n  };\n\n  var fromRawEvent = function (rawEvent) {\n    var target = SugarElement.fromDom(getOriginalEventTarget(rawEvent).getOr(rawEvent.target));\n\n    var stop = function () {\n      return rawEvent.stopPropagation();\n    };\n\n    var prevent = function () {\n      return rawEvent.preventDefault();\n    };\n\n    var kill = compose(prevent, stop);\n    return mkEvent(target, rawEvent.clientX, rawEvent.clientY, stop, prevent, kill, rawEvent);\n  };\n\n  var handle = function (filter, handler) {\n    return function (rawEvent) {\n      if (filter(rawEvent)) {\n        handler(fromRawEvent(rawEvent));\n      }\n    };\n  };\n\n  var binder = function (element, event, filter, handler, useCapture) {\n    var wrapped = handle(filter, handler);\n    element.dom.addEventListener(event, wrapped, useCapture);\n    return {\n      unbind: curry(unbind, element, event, wrapped, useCapture)\n    };\n  };\n\n  var bind$2 = function (element, event, filter, handler) {\n    return binder(element, event, filter, handler, false);\n  };\n\n  var capture = function (element, event, filter, handler) {\n    return binder(element, event, filter, handler, true);\n  };\n\n  var unbind = function (element, event, handler, useCapture) {\n    element.dom.removeEventListener(event, handler, useCapture);\n  };\n\n  var get$9 = function (_DOC) {\n    var doc = _DOC !== undefined ? _DOC.dom : document;\n    var x = doc.body.scrollLeft || doc.documentElement.scrollLeft;\n    var y = doc.body.scrollTop || doc.documentElement.scrollTop;\n    return SugarPosition(x, y);\n  };\n\n  var to = function (x, y, _DOC) {\n    var doc = _DOC !== undefined ? _DOC.dom : document;\n    var win = doc.defaultView;\n\n    if (win) {\n      win.scrollTo(x, y);\n    }\n  };\n\n  var get$a = function (_win) {\n    var win = _win === undefined ? window : _win;\n    return Optional.from(win['visualViewport']);\n  };\n\n  var bounds = function (x, y, width, height) {\n    return {\n      x: x,\n      y: y,\n      width: width,\n      height: height,\n      right: x + width,\n      bottom: y + height\n    };\n  };\n\n  var getBounds = function (_win) {\n    var win = _win === undefined ? window : _win;\n    var doc = win.document;\n    var scroll = get$9(SugarElement.fromDom(doc));\n    return get$a(win).fold(function () {\n      var html = win.document.documentElement;\n      var width = html.clientWidth;\n      var height = html.clientHeight;\n      return bounds(scroll.left, scroll.top, width, height);\n    }, function (visualViewport) {\n      return bounds(Math.max(visualViewport.pageLeft, scroll.left), Math.max(visualViewport.pageTop, scroll.top), visualViewport.width, visualViewport.height);\n    });\n  };\n\n  var walkUp = function (navigation, doc) {\n    var frame = navigation.view(doc);\n    return frame.fold(constant([]), function (f) {\n      var parent = navigation.owner(f);\n      var rest = walkUp(navigation, parent);\n      return [f].concat(rest);\n    });\n  };\n\n  var pathTo = function (element, navigation) {\n    var d = navigation.owner(element);\n    var paths = walkUp(navigation, d);\n    return Optional.some(paths);\n  };\n\n  var view = function (doc) {\n    var _a;\n\n    var element = doc.dom === document ? Optional.none() : Optional.from((_a = doc.dom.defaultView) === null || _a === void 0 ? void 0 : _a.frameElement);\n    return element.map(SugarElement.fromDom);\n  };\n\n  var owner$1 = function (element) {\n    return owner(element);\n  };\n\n  var Navigation = /*#__PURE__*/Object.freeze({\n    __proto__: null,\n    view: view,\n    owner: owner$1\n  });\n\n  var find$3 = function (element) {\n    var doc = SugarElement.fromDom(document);\n    var scroll = get$9(doc);\n    var path = pathTo(element, Navigation);\n    return path.fold(curry(absolute, element), function (frames) {\n      var offset = viewport(element);\n      var r = foldr(frames, function (b, a) {\n        var loc = viewport(a);\n        return {\n          left: b.left + loc.left,\n          top: b.top + loc.top\n        };\n      }, {\n        left: 0,\n        top: 0\n      });\n      return SugarPosition(r.left + offset.left + scroll.left, r.top + offset.top + scroll.top);\n    });\n  };\n\n  var pointed = function (point, width, height) {\n    return {\n      point: point,\n      width: width,\n      height: height\n    };\n  };\n\n  var rect = function (x, y, width, height) {\n    return {\n      x: x,\n      y: y,\n      width: width,\n      height: height\n    };\n  };\n\n  var bounds$1 = function (x, y, width, height) {\n    return {\n      x: x,\n      y: y,\n      width: width,\n      height: height,\n      right: x + width,\n      bottom: y + height\n    };\n  };\n\n  var box = function (element) {\n    var xy = absolute(element);\n    var w = getOuter$2(element);\n    var h = getOuter$1(element);\n    return bounds$1(xy.left, xy.top, w, h);\n  };\n\n  var absolute$1 = function (element) {\n    var position = find$3(element);\n    var width = getOuter$2(element);\n    var height = getOuter$1(element);\n    return bounds$1(position.left, position.top, width, height);\n  };\n\n  var win = function () {\n    return getBounds(window);\n  };\n\n  function ClosestOrAncestor(is, ancestor, scope, a, isRoot) {\n    if (is(scope, a)) {\n      return Optional.some(scope);\n    } else if (isFunction(isRoot) && isRoot(scope)) {\n      return Optional.none();\n    } else {\n      return ancestor(scope, a, isRoot);\n    }\n  }\n\n  var ancestor$1 = function (scope, predicate, isRoot) {\n    var element = scope.dom;\n    var stop = isFunction(isRoot) ? isRoot : never;\n\n    while (element.parentNode) {\n      element = element.parentNode;\n      var el = SugarElement.fromDom(element);\n\n      if (predicate(el)) {\n        return Optional.some(el);\n      } else if (stop(el)) {\n        break;\n      }\n    }\n\n    return Optional.none();\n  };\n\n  var closest$1 = function (scope, predicate, isRoot) {\n    var is = function (s, test) {\n      return test(s);\n    };\n\n    return ClosestOrAncestor(is, ancestor$1, scope, predicate, isRoot);\n  };\n\n  var descendant = function (scope, predicate) {\n    var descend = function (node) {\n      for (var i = 0; i < node.childNodes.length; i++) {\n        var child_1 = SugarElement.fromDom(node.childNodes[i]);\n\n        if (predicate(child_1)) {\n          return Optional.some(child_1);\n        }\n\n        var res = descend(node.childNodes[i]);\n\n        if (res.isSome()) {\n          return res;\n        }\n      }\n\n      return Optional.none();\n    };\n\n    return descend(scope.dom);\n  };\n\n  var closest$2 = function (scope, predicate, isRoot) {\n    return closest$1(scope, predicate, isRoot).isSome();\n  };\n\n  var ancestor$2 = function (scope, selector, isRoot) {\n    return ancestor$1(scope, function (e) {\n      return is(e, selector);\n    }, isRoot);\n  };\n\n  var descendant$1 = function (scope, selector) {\n    return one(selector, scope);\n  };\n\n  var closest$3 = function (scope, selector, isRoot) {\n    var is$1 = function (element, selector) {\n      return is(element, selector);\n    };\n\n    return ClosestOrAncestor(is$1, ancestor$2, scope, selector, isRoot);\n  };\n\n  var find$4 = function (queryElem) {\n    var dependent = closest$1(queryElem, function (elem) {\n      if (!isElement(elem)) {\n        return false;\n      }\n\n      var id = get$3(elem, 'id');\n      return id !== undefined && id.indexOf('aria-owns') > -1;\n    });\n    return dependent.bind(function (dep) {\n      var id = get$3(dep, 'id');\n      var dos = getRootNode(dep);\n      return descendant$1(dos, '[aria-owns=\"' + id + '\"]');\n    });\n  };\n\n  var manager = function () {\n    var ariaId = generate$1('aria-owns');\n\n    var link = function (elem) {\n      set$1(elem, 'aria-owns', ariaId);\n    };\n\n    var unlink = function (elem) {\n      remove$1(elem, 'aria-owns');\n    };\n\n    return {\n      id: ariaId,\n      link: link,\n      unlink: unlink\n    };\n  };\n\n  var isAriaPartOf = function (component, queryElem) {\n    return find$4(queryElem).exists(function (owner) {\n      return isPartOf(component, owner);\n    });\n  };\n\n  var isPartOf = function (component, queryElem) {\n    return closest$2(queryElem, function (el) {\n      return eq$1(el, component.element);\n    }, never) || isAriaPartOf(component, queryElem);\n  };\n\n  var unknown$3 = 'unknown';\n  var EventConfiguration;\n\n  (function (EventConfiguration) {\n    EventConfiguration[EventConfiguration['STOP'] = 0] = 'STOP';\n    EventConfiguration[EventConfiguration['NORMAL'] = 1] = 'NORMAL';\n    EventConfiguration[EventConfiguration['LOGGING'] = 2] = 'LOGGING';\n  })(EventConfiguration || (EventConfiguration = {}));\n\n  var eventConfig = Cell({});\n\n  var makeEventLogger = function (eventName, initialTarget) {\n    var sequence = [];\n    var startTime = new Date().getTime();\n    return {\n      logEventCut: function (_name, target, purpose) {\n        sequence.push({\n          outcome: 'cut',\n          target: target,\n          purpose: purpose\n        });\n      },\n      logEventStopped: function (_name, target, purpose) {\n        sequence.push({\n          outcome: 'stopped',\n          target: target,\n          purpose: purpose\n        });\n      },\n      logNoParent: function (_name, target, purpose) {\n        sequence.push({\n          outcome: 'no-parent',\n          target: target,\n          purpose: purpose\n        });\n      },\n      logEventNoHandlers: function (_name, target) {\n        sequence.push({\n          outcome: 'no-handlers-left',\n          target: target\n        });\n      },\n      logEventResponse: function (_name, target, purpose) {\n        sequence.push({\n          outcome: 'response',\n          purpose: purpose,\n          target: target\n        });\n      },\n      write: function () {\n        var finishTime = new Date().getTime();\n\n        if (contains(['mousemove', 'mouseover', 'mouseout', systemInit()], eventName)) {\n          return;\n        }\n\n        console.log(eventName, {\n          event: eventName,\n          time: finishTime - startTime,\n          target: initialTarget.dom,\n          sequence: map(sequence, function (s) {\n            if (!contains(['cut', 'stopped', 'response'], s.outcome)) {\n              return s.outcome;\n            } else {\n              return '{' + s.purpose + '} ' + s.outcome + ' at (' + element(s.target) + ')';\n            }\n          })\n        });\n      }\n    };\n  };\n\n  var processEvent = function (eventName, initialTarget, f) {\n    var status = get$1(eventConfig.get(), eventName).orThunk(function () {\n      var patterns = keys(eventConfig.get());\n      return findMap(patterns, function (p) {\n        return eventName.indexOf(p) > -1 ? Optional.some(eventConfig.get()[p]) : Optional.none();\n      });\n    }).getOr(EventConfiguration.NORMAL);\n\n    switch (status) {\n      case EventConfiguration.NORMAL:\n        return f(noLogger());\n\n      case EventConfiguration.LOGGING:\n        {\n          var logger = makeEventLogger(eventName, initialTarget);\n          var output = f(logger);\n          logger.write();\n          return output;\n        }\n\n      case EventConfiguration.STOP:\n        return true;\n    }\n  };\n\n  var path = ['alloy/data/Fields', 'alloy/debugging/Debugging'];\n\n  var getTrace = function () {\n    var err = new Error();\n\n    if (err.stack !== undefined) {\n      var lines = err.stack.split('\\n');\n      return find(lines, function (line) {\n        return line.indexOf('alloy') > 0 && !exists(path, function (p) {\n          return line.indexOf(p) > -1;\n        });\n      }).getOr(unknown$3);\n    } else {\n      return unknown$3;\n    }\n  };\n\n  var ignoreEvent = {\n    logEventCut: noop,\n    logEventStopped: noop,\n    logNoParent: noop,\n    logEventNoHandlers: noop,\n    logEventResponse: noop,\n    write: noop\n  };\n\n  var monitorEvent = function (eventName, initialTarget, f) {\n    return processEvent(eventName, initialTarget, f);\n  };\n\n  var noLogger = constant(ignoreEvent);\n  var menuFields = constant([strict$1('menu'), strict$1('selectedMenu')]);\n  var itemFields = constant([strict$1('item'), strict$1('selectedItem')]);\n  var schema = constant(objOf(itemFields().concat(menuFields())));\n  var itemSchema = constant(objOf(itemFields()));\n\n  var _initSize = strictObjOf('initSize', [strict$1('numColumns'), strict$1('numRows')]);\n\n  var itemMarkers = function () {\n    return strictOf('markers', itemSchema());\n  };\n\n  var tieredMenuMarkers = function () {\n    return strictObjOf('markers', [strict$1('backgroundMenu')].concat(menuFields()).concat(itemFields()));\n  };\n\n  var markers = function (required) {\n    return strictObjOf('markers', map(required, strict$1));\n  };\n\n  var onPresenceHandler = function (label, fieldName, presence) {\n    var trace = getTrace();\n    return field(fieldName, fieldName, presence, valueOf(function (f) {\n      return Result.value(function () {\n        var args = [];\n\n        for (var _i = 0; _i < arguments.length; _i++) {\n          args[_i] = arguments[_i];\n        }\n\n        return f.apply(undefined, args);\n      });\n    }));\n  };\n\n  var onHandler = function (fieldName) {\n    return onPresenceHandler('onHandler', fieldName, defaulted(noop));\n  };\n\n  var onKeyboardHandler = function (fieldName) {\n    return onPresenceHandler('onKeyboardHandler', fieldName, defaulted(Optional.none));\n  };\n\n  var onStrictHandler = function (fieldName) {\n    return onPresenceHandler('onHandler', fieldName, strict());\n  };\n\n  var onStrictKeyboardHandler = function (fieldName) {\n    return onPresenceHandler('onKeyboardHandler', fieldName, strict());\n  };\n\n  var output = function (name, value) {\n    return state$1(name, constant(value));\n  };\n\n  var snapshot = function (name) {\n    return state$1(name, identity);\n  };\n\n  var initSize = constant(_initSize);\n\n  var nu$7 = function (x, y, bubble, direction, boundsRestriction, label) {\n    return {\n      x: x,\n      y: y,\n      bubble: bubble,\n      direction: direction,\n      boundsRestriction: boundsRestriction,\n      label: label\n    };\n  };\n\n  var adt$2 = Adt.generate([{\n    southeast: []\n  }, {\n    southwest: []\n  }, {\n    northeast: []\n  }, {\n    northwest: []\n  }, {\n    south: []\n  }, {\n    north: []\n  }, {\n    east: []\n  }, {\n    west: []\n  }]);\n\n  var cata = function (subject, southeast, southwest, northeast, northwest, south, north, east, west) {\n    return subject.fold(southeast, southwest, northeast, northwest, south, north, east, west);\n  };\n\n  var cataVertical = function (subject, south, middle, north) {\n    return subject.fold(south, south, north, north, south, north, middle, middle);\n  };\n\n  var cataHorizontal = function (subject, east, middle, west) {\n    return subject.fold(east, west, east, west, middle, middle, east, west);\n  };\n\n  var southeast = adt$2.southeast;\n  var southwest = adt$2.southwest;\n  var northeast = adt$2.northeast;\n  var northwest = adt$2.northwest;\n  var south = adt$2.south;\n  var north = adt$2.north;\n  var east = adt$2.east;\n  var west = adt$2.west;\n\n  var getRestriction = function (anchor, restriction) {\n    switch (restriction) {\n      case 1:\n        return anchor.x;\n\n      case 0:\n        return anchor.x + anchor.width;\n\n      case 2:\n        return anchor.y;\n\n      case 3:\n        return anchor.y + anchor.height;\n    }\n  };\n\n  var boundsRestriction = function (anchor, restrictions) {\n    return mapToObject(['left', 'right', 'top', 'bottom'], function (dir) {\n      return get$1(restrictions, dir).map(function (restriction) {\n        return getRestriction(anchor, restriction);\n      });\n    });\n  };\n\n  var adjustBounds = function (bounds, boundsRestrictions, bubbleOffsets) {\n    var applyRestriction = function (dir, current) {\n      var bubbleOffset = dir === 'top' || dir === 'bottom' ? bubbleOffsets.top : bubbleOffsets.left;\n      return get$1(boundsRestrictions, dir).bind(identity).bind(function (restriction) {\n        if (dir === 'left' || dir === 'top') {\n          return restriction >= current ? Optional.some(restriction) : Optional.none();\n        } else {\n          return restriction <= current ? Optional.some(restriction) : Optional.none();\n        }\n      }).map(function (restriction) {\n        return restriction + bubbleOffset;\n      }).getOr(current);\n    };\n\n    var adjustedLeft = applyRestriction('left', bounds.x);\n    var adjustedTop = applyRestriction('top', bounds.y);\n    var adjustedRight = applyRestriction('right', bounds.right);\n    var adjustedBottom = applyRestriction('bottom', bounds.bottom);\n    return bounds$1(adjustedLeft, adjustedTop, adjustedRight - adjustedLeft, adjustedBottom - adjustedTop);\n  };\n\n  var eastX = function (anchor) {\n    return anchor.x;\n  };\n\n  var middleX = function (anchor, element) {\n    return anchor.x + anchor.width / 2 - element.width / 2;\n  };\n\n  var westX = function (anchor, element) {\n    return anchor.x + anchor.width - element.width;\n  };\n\n  var northY = function (anchor, element) {\n    return anchor.y - element.height;\n  };\n\n  var southY = function (anchor) {\n    return anchor.y + anchor.height;\n  };\n\n  var centreY = function (anchor, element) {\n    return anchor.y + anchor.height / 2 - element.height / 2;\n  };\n\n  var eastEdgeX = function (anchor) {\n    return anchor.x + anchor.width;\n  };\n\n  var westEdgeX = function (anchor, element) {\n    return anchor.x - element.width;\n  };\n\n  var southeast$1 = function (anchor, element, bubbles) {\n    return nu$7(eastX(anchor), southY(anchor), bubbles.southeast(), southeast(), boundsRestriction(anchor, {\n      left: 1,\n      top: 3\n    }), 'layout-se');\n  };\n\n  var southwest$1 = function (anchor, element, bubbles) {\n    return nu$7(westX(anchor, element), southY(anchor), bubbles.southwest(), southwest(), boundsRestriction(anchor, {\n      right: 0,\n      top: 3\n    }), 'layout-sw');\n  };\n\n  var northeast$1 = function (anchor, element, bubbles) {\n    return nu$7(eastX(anchor), northY(anchor, element), bubbles.northeast(), northeast(), boundsRestriction(anchor, {\n      left: 1,\n      bottom: 2\n    }), 'layout-ne');\n  };\n\n  var northwest$1 = function (anchor, element, bubbles) {\n    return nu$7(westX(anchor, element), northY(anchor, element), bubbles.northwest(), northwest(), boundsRestriction(anchor, {\n      right: 0,\n      bottom: 2\n    }), 'layout-nw');\n  };\n\n  var north$1 = function (anchor, element, bubbles) {\n    return nu$7(middleX(anchor, element), northY(anchor, element), bubbles.north(), north(), boundsRestriction(anchor, {\n      bottom: 2\n    }), 'layout-n');\n  };\n\n  var south$1 = function (anchor, element, bubbles) {\n    return nu$7(middleX(anchor, element), southY(anchor), bubbles.south(), south(), boundsRestriction(anchor, {\n      top: 3\n    }), 'layout-s');\n  };\n\n  var east$1 = function (anchor, element, bubbles) {\n    return nu$7(eastEdgeX(anchor), centreY(anchor, element), bubbles.east(), east(), boundsRestriction(anchor, {\n      left: 0\n    }), 'layout-e');\n  };\n\n  var west$1 = function (anchor, element, bubbles) {\n    return nu$7(westEdgeX(anchor, element), centreY(anchor, element), bubbles.west(), west(), boundsRestriction(anchor, {\n      right: 1\n    }), 'layout-w');\n  };\n\n  var all$2 = function () {\n    return [southeast$1, southwest$1, northeast$1, northwest$1, south$1, north$1, east$1, west$1];\n  };\n\n  var allRtl = function () {\n    return [southwest$1, southeast$1, northwest$1, northeast$1, south$1, north$1, east$1, west$1];\n  };\n\n  var aboveOrBelow = function () {\n    return [northeast$1, northwest$1, southeast$1, southwest$1, north$1, south$1];\n  };\n\n  var aboveOrBelowRtl = function () {\n    return [northwest$1, northeast$1, southwest$1, southeast$1, north$1, south$1];\n  };\n\n  var belowOrAbove = function () {\n    return [southeast$1, southwest$1, northeast$1, northwest$1, south$1, north$1];\n  };\n\n  var belowOrAboveRtl = function () {\n    return [southwest$1, southeast$1, northwest$1, northeast$1, south$1, north$1];\n  };\n\n  var chooseChannels = function (channels, message) {\n    return message.universal ? channels : filter(channels, function (ch) {\n      return contains(message.channels, ch);\n    });\n  };\n\n  var events$1 = function (receiveConfig) {\n    return derive([run(receive(), function (component, message) {\n      var channelMap = receiveConfig.channels;\n      var channels = keys(channelMap);\n      var receivingData = message;\n      var targetChannels = chooseChannels(channels, receivingData);\n      each(targetChannels, function (ch) {\n        var channelInfo = channelMap[ch];\n        var channelSchema = channelInfo.schema;\n        var data = asRawOrDie('channel[' + ch + '] data\\nReceiver: ' + element(component.element), channelSchema, receivingData.data);\n        channelInfo.onReceive(component, data);\n      });\n    })]);\n  };\n\n  var ActiveReceiving = /*#__PURE__*/Object.freeze({\n    __proto__: null,\n    events: events$1\n  });\n  var ReceivingSchema = [strictOf('channels', setOf$1(Result.value, objOfOnly([onStrictHandler('onReceive'), defaulted$1('schema', anyValue$1())])))];\n\n  var executeEvent = function (bConfig, bState, executor) {\n    return runOnExecute(function (component) {\n      executor(component, bConfig, bState);\n    });\n  };\n\n  var loadEvent = function (bConfig, bState, f) {\n    return runOnInit(function (component, _simulatedEvent) {\n      f(component, bConfig, bState);\n    });\n  };\n\n  var create = function (schema, name, active, apis, extra, state) {\n    var configSchema = objOfOnly(schema);\n    var schemaSchema = optionObjOf(name, [optionObjOfOnly('config', schema)]);\n    return doCreate(configSchema, schemaSchema, name, active, apis, extra, state);\n  };\n\n  var createModes = function (modes, name, active, apis, extra, state) {\n    var configSchema = modes;\n    var schemaSchema = optionObjOf(name, [optionOf('config', modes)]);\n    return doCreate(configSchema, schemaSchema, name, active, apis, extra, state);\n  };\n\n  var wrapApi = function (bName, apiFunction, apiName) {\n    var f = function (component) {\n      var rest = [];\n\n      for (var _i = 1; _i < arguments.length; _i++) {\n        rest[_i - 1] = arguments[_i];\n      }\n\n      var args = [component].concat(rest);\n      return component.config({\n        name: constant(bName)\n      }).fold(function () {\n        throw new Error('We could not find any behaviour configuration for: ' + bName + '. Using API: ' + apiName);\n      }, function (info) {\n        var rest = Array.prototype.slice.call(args, 1);\n        return apiFunction.apply(undefined, [component, info.config, info.state].concat(rest));\n      });\n    };\n\n    return markAsBehaviourApi(f, apiName, apiFunction);\n  };\n\n  var revokeBehaviour = function (name) {\n    return {\n      key: name,\n      value: undefined\n    };\n  };\n\n  var doCreate = function (configSchema, schemaSchema, name, active, apis, extra, state) {\n    var getConfig = function (info) {\n      return hasNonNullableKey(info, name) ? info[name]() : Optional.none();\n    };\n\n    var wrappedApis = map$2(apis, function (apiF, apiName) {\n      return wrapApi(name, apiF, apiName);\n    });\n    var wrappedExtra = map$2(extra, function (extraF, extraName) {\n      return markAsExtraApi(extraF, extraName);\n    });\n\n    var me = __assign(__assign(__assign({}, wrappedExtra), wrappedApis), {\n      revoke: curry(revokeBehaviour, name),\n      config: function (spec) {\n        var prepared = asRawOrDie(name + '-config', configSchema, spec);\n        return {\n          key: name,\n          value: {\n            config: prepared,\n            me: me,\n            configAsRaw: cached(function () {\n              return asRawOrDie(name + '-config', configSchema, spec);\n            }),\n            initialConfig: spec,\n            state: state\n          }\n        };\n      },\n      schema: constant(schemaSchema),\n      exhibit: function (info, base) {\n        return getConfig(info).bind(function (behaviourInfo) {\n          return get$1(active, 'exhibit').map(function (exhibitor) {\n            return exhibitor(base, behaviourInfo.config, behaviourInfo.state);\n          });\n        }).getOr(nu$6({}));\n      },\n      name: constant(name),\n      handlers: function (info) {\n        return getConfig(info).map(function (behaviourInfo) {\n          var getEvents = get$1(active, 'events').getOr(function () {\n            return {};\n          });\n          return getEvents(behaviourInfo.config, behaviourInfo.state);\n        }).getOr({});\n      }\n    });\n\n    return me;\n  };\n\n  var derive$1 = function (capabilities) {\n    return wrapAll$1(capabilities);\n  };\n\n  var simpleSchema = objOfOnly([strict$1('fields'), strict$1('name'), defaulted$1('active', {}), defaulted$1('apis', {}), defaulted$1('state', NoState), defaulted$1('extra', {})]);\n\n  var create$1 = function (data) {\n    var value = asRawOrDie('Creating behaviour: ' + data.name, simpleSchema, data);\n    return create(value.fields, value.name, value.active, value.apis, value.extra, value.state);\n  };\n\n  var modeSchema = objOfOnly([strict$1('branchKey'), strict$1('branches'), strict$1('name'), defaulted$1('active', {}), defaulted$1('apis', {}), defaulted$1('state', NoState), defaulted$1('extra', {})]);\n\n  var createModes$1 = function (data) {\n    var value = asRawOrDie('Creating behaviour: ' + data.name, modeSchema, data);\n    return createModes(choose$1(value.branchKey, value.branches), value.name, value.active, value.apis, value.extra, value.state);\n  };\n\n  var revoke = constant(undefined);\n  var Receiving = create$1({\n    fields: ReceivingSchema,\n    name: 'receiving',\n    active: ActiveReceiving\n  });\n\n  var exhibit = function (base, posConfig) {\n    return nu$6({\n      classes: [],\n      styles: posConfig.useFixed() ? {} : {\n        position: 'relative'\n      }\n    });\n  };\n\n  var ActivePosition = /*#__PURE__*/Object.freeze({\n    __proto__: null,\n    exhibit: exhibit\n  });\n\n  var getDocument = function () {\n    return SugarElement.fromDom(document);\n  };\n\n  var focus$1 = function (element) {\n    return element.dom.focus();\n  };\n\n  var blur = function (element) {\n    return element.dom.blur();\n  };\n\n  var hasFocus = function (element) {\n    var root = getRootNode(element).dom;\n    return element.dom === root.activeElement;\n  };\n\n  var active = function (root) {\n    if (root === void 0) {\n      root = getDocument();\n    }\n\n    return Optional.from(root.dom.activeElement).map(SugarElement.fromDom);\n  };\n\n  var search = function (element) {\n    return active(getRootNode(element)).filter(function (e) {\n      return element.dom.contains(e.dom);\n    });\n  };\n\n  var preserve = function (f, container) {\n    var dos = getRootNode(container);\n    var refocus = active(dos).bind(function (focused) {\n      var hasFocus = function (elem) {\n        return eq$1(focused, elem);\n      };\n\n      return hasFocus(container) ? Optional.some(container) : descendant(container, hasFocus);\n    });\n    var result = f(container);\n    refocus.each(function (oldFocus) {\n      active(dos).filter(function (newFocus) {\n        return eq$1(newFocus, oldFocus);\n      }).fold(function () {\n        focus$1(oldFocus);\n      }, noop);\n    });\n    return result;\n  };\n\n  var NuPositionCss = function (position, left, top, right, bottom) {\n    return {\n      position: position,\n      left: left,\n      top: top,\n      right: right,\n      bottom: bottom\n    };\n  };\n\n  var applyPositionCss = function (element, position) {\n    var addPx = function (num) {\n      return num + 'px';\n    };\n\n    setOptions(element, {\n      position: Optional.some(position.position),\n      left: position.left.map(addPx),\n      top: position.top.map(addPx),\n      right: position.right.map(addPx),\n      bottom: position.bottom.map(addPx)\n    });\n  };\n\n  var adt$3 = Adt.generate([{\n    none: []\n  }, {\n    relative: ['x', 'y', 'width', 'height']\n  }, {\n    fixed: ['x', 'y', 'width', 'height']\n  }]);\n\n  var positionWithDirection = function (posName, decision, x, y, width, height) {\n    var decisionX = decision.x - x;\n    var decisionY = decision.y - y;\n    var decisionWidth = decision.width;\n    var decisionHeight = decision.height;\n    var decisionRight = width - (decisionX + decisionWidth);\n    var decisionBottom = height - (decisionY + decisionHeight);\n    var left = Optional.some(decisionX);\n    var top = Optional.some(decisionY);\n    var right = Optional.some(decisionRight);\n    var bottom = Optional.some(decisionBottom);\n    var none = Optional.none();\n    return cata(decision.direction, function () {\n      return NuPositionCss(posName, left, top, none, none);\n    }, function () {\n      return NuPositionCss(posName, none, top, right, none);\n    }, function () {\n      return NuPositionCss(posName, left, none, none, bottom);\n    }, function () {\n      return NuPositionCss(posName, none, none, right, bottom);\n    }, function () {\n      return NuPositionCss(posName, left, top, none, none);\n    }, function () {\n      return NuPositionCss(posName, left, none, none, bottom);\n    }, function () {\n      return NuPositionCss(posName, left, top, none, none);\n    }, function () {\n      return NuPositionCss(posName, none, top, right, none);\n    });\n  };\n\n  var reposition = function (origin, decision) {\n    return origin.fold(function () {\n      return NuPositionCss('absolute', Optional.some(decision.x), Optional.some(decision.y), Optional.none(), Optional.none());\n    }, function (x, y, width, height) {\n      return positionWithDirection('absolute', decision, x, y, width, height);\n    }, function (x, y, width, height) {\n      return positionWithDirection('fixed', decision, x, y, width, height);\n    });\n  };\n\n  var toBox = function (origin, element) {\n    var rel = curry(find$3, element);\n    var position = origin.fold(rel, rel, function () {\n      var scroll = get$9();\n      return find$3(element).translate(-scroll.left, -scroll.top);\n    });\n    var width = getOuter$2(element);\n    var height = getOuter$1(element);\n    return bounds$1(position.left, position.top, width, height);\n  };\n\n  var viewport$1 = function (origin, getBounds) {\n    return getBounds.fold(function () {\n      return origin.fold(win, win, bounds$1);\n    }, function (b) {\n      return origin.fold(b, b, function () {\n        var bounds = b();\n        var pos = translate(origin, bounds.x, bounds.y);\n        return bounds$1(pos.left, pos.top, bounds.width, bounds.height);\n      });\n    });\n  };\n\n  var translate = function (origin, x, y) {\n    var pos = SugarPosition(x, y);\n\n    var removeScroll = function () {\n      var outerScroll = get$9();\n      return pos.translate(-outerScroll.left, -outerScroll.top);\n    };\n\n    return origin.fold(constant(pos), constant(pos), removeScroll);\n  };\n\n  var cata$1 = function (subject, onNone, onRelative, onFixed) {\n    return subject.fold(onNone, onRelative, onFixed);\n  };\n\n  var none$1 = adt$3.none;\n  var relative = adt$3.relative;\n  var fixed = adt$3.fixed;\n\n  var anchor = function (anchorBox, origin) {\n    return {\n      anchorBox: anchorBox,\n      origin: origin\n    };\n  };\n\n  var box$1 = function (anchorBox, origin) {\n    return anchor(anchorBox, origin);\n  };\n\n  var cycleBy = function (value, delta, min, max) {\n    var r = value + delta;\n\n    if (r > max) {\n      return min;\n    } else if (r < min) {\n      return max;\n    } else {\n      return r;\n    }\n  };\n\n  var clamp = function (value, min, max) {\n    return Math.min(Math.max(value, min), max);\n  };\n\n  var adt$4 = Adt.generate([{\n    fit: ['reposition']\n  }, {\n    nofit: ['reposition', 'deltaW', 'deltaH']\n  }]);\n\n  var calcReposition = function (newX, newY, width, height, bounds) {\n    var boundsX = bounds.x;\n    var boundsY = bounds.y;\n    var boundsWidth = bounds.width;\n    var boundsHeight = bounds.height;\n    var xInBounds = newX >= boundsX;\n    var yInBounds = newY >= boundsY;\n    var originInBounds = xInBounds && yInBounds;\n    var xFit = newX + width <= boundsX + boundsWidth;\n    var yFit = newY + height <= boundsY + boundsHeight;\n    var sizeInBounds = xFit && yFit;\n    var deltaW = Math.abs(Math.min(width, xInBounds ? boundsX + boundsWidth - newX : boundsX - (newX + width)));\n    var deltaH = Math.abs(Math.min(height, yInBounds ? boundsY + boundsHeight - newY : boundsY - (newY + height)));\n    var maxX = Math.max(bounds.x, bounds.right - width);\n    var maxY = Math.max(bounds.y, bounds.bottom - height);\n    var limitX = clamp(newX, bounds.x, maxX);\n    var limitY = clamp(newY, bounds.y, maxY);\n    return {\n      originInBounds: originInBounds,\n      sizeInBounds: sizeInBounds,\n      limitX: limitX,\n      limitY: limitY,\n      deltaW: deltaW,\n      deltaH: deltaH\n    };\n  };\n\n  var attempt = function (candidate, width, height, bounds) {\n    var candidateX = candidate.x;\n    var candidateY = candidate.y;\n    var bubbleOffsets = candidate.bubble.offset;\n    var bubbleLeft = bubbleOffsets.left;\n    var bubbleTop = bubbleOffsets.top;\n    var adjustedBounds = adjustBounds(bounds, candidate.boundsRestriction, bubbleOffsets);\n    var boundsY = adjustedBounds.y;\n    var boundsBottom = adjustedBounds.bottom;\n    var boundsX = adjustedBounds.x;\n    var boundsRight = adjustedBounds.right;\n    var newX = candidateX + bubbleLeft;\n    var newY = candidateY + bubbleTop;\n\n    var _a = calcReposition(newX, newY, width, height, adjustedBounds),\n        originInBounds = _a.originInBounds,\n        sizeInBounds = _a.sizeInBounds,\n        limitX = _a.limitX,\n        limitY = _a.limitY,\n        deltaW = _a.deltaW,\n        deltaH = _a.deltaH;\n\n    var upAvailable = constant(limitY + deltaH - boundsY);\n    var downAvailable = constant(boundsBottom - limitY);\n    var maxHeight = cataVertical(candidate.direction, downAvailable, downAvailable, upAvailable);\n    var westAvailable = constant(limitX + deltaW - boundsX);\n    var eastAvailable = constant(boundsRight - limitX);\n    var maxWidth = cataHorizontal(candidate.direction, eastAvailable, eastAvailable, westAvailable);\n    var reposition = {\n      x: limitX,\n      y: limitY,\n      width: deltaW,\n      height: deltaH,\n      maxHeight: maxHeight,\n      maxWidth: maxWidth,\n      direction: candidate.direction,\n      classes: {\n        on: candidate.bubble.classesOn,\n        off: candidate.bubble.classesOff\n      },\n      label: candidate.label,\n      candidateYforTest: newY\n    };\n    return originInBounds && sizeInBounds ? adt$4.fit(reposition) : adt$4.nofit(reposition, deltaW, deltaH);\n  };\n\n  var attempts = function (candidates, anchorBox, elementBox, bubbles, bounds) {\n    var panelWidth = elementBox.width;\n    var panelHeight = elementBox.height;\n\n    var attemptBestFit = function (layout, reposition, deltaW, deltaH) {\n      var next = layout(anchorBox, elementBox, bubbles);\n      var attemptLayout = attempt(next, panelWidth, panelHeight, bounds);\n      return attemptLayout.fold(adt$4.fit, function (newReposition, newDeltaW, newDeltaH) {\n        var improved = newDeltaH > deltaH || newDeltaW > deltaW;\n        return improved ? adt$4.nofit(newReposition, newDeltaW, newDeltaH) : adt$4.nofit(reposition, deltaW, deltaH);\n      });\n    };\n\n    var abc = foldl(candidates, function (b, a) {\n      var bestNext = curry(attemptBestFit, a);\n      return b.fold(adt$4.fit, bestNext);\n    }, adt$4.nofit({\n      x: anchorBox.x,\n      y: anchorBox.y,\n      width: elementBox.width,\n      height: elementBox.height,\n      maxHeight: elementBox.height,\n      maxWidth: elementBox.width,\n      direction: southeast(),\n      classes: {\n        on: [],\n        off: []\n      },\n      label: 'none',\n      candidateYforTest: anchorBox.y\n    }, -1, -1));\n    return abc.fold(identity, identity);\n  };\n\n  var elementSize = function (p) {\n    return {\n      width: getOuter$2(p),\n      height: getOuter$1(p)\n    };\n  };\n\n  var layout = function (anchorBox, element, bubbles, options) {\n    remove$6(element, 'max-height');\n    remove$6(element, 'max-width');\n    var elementBox = elementSize(element);\n    return attempts(options.preference, anchorBox, elementBox, bubbles, options.bounds);\n  };\n\n  var setClasses = function (element, decision) {\n    var classInfo = decision.classes;\n    remove$5(element, classInfo.off);\n    add$3(element, classInfo.on);\n  };\n\n  var setHeight = function (element, decision, options) {\n    var maxHeightFunction = options.maxHeightFunction;\n    maxHeightFunction(element, decision.maxHeight);\n  };\n\n  var setWidth = function (element, decision, options) {\n    var maxWidthFunction = options.maxWidthFunction;\n    maxWidthFunction(element, decision.maxWidth);\n  };\n\n  var position = function (element, decision, options) {\n    applyPositionCss(element, reposition(options.origin, decision));\n  };\n\n  var setMaxHeight = function (element, maxHeight) {\n    setMax(element, Math.floor(maxHeight));\n  };\n\n  var anchored = constant(function (element, available) {\n    setMaxHeight(element, available);\n    setAll$1(element, {\n      'overflow-x': 'hidden',\n      'overflow-y': 'auto'\n    });\n  });\n  var expandable = constant(function (element, available) {\n    setMaxHeight(element, available);\n  });\n\n  var defaultOr = function (options, key, dephault) {\n    return options[key] === undefined ? dephault : options[key];\n  };\n\n  var simple = function (anchor, element, bubble, layouts, getBounds, overrideOptions) {\n    var maxHeightFunction = defaultOr(overrideOptions, 'maxHeightFunction', anchored());\n    var maxWidthFunction = defaultOr(overrideOptions, 'maxWidthFunction', noop);\n    var anchorBox = anchor.anchorBox;\n    var origin = anchor.origin;\n    var options = {\n      bounds: viewport$1(origin, getBounds),\n      origin: origin,\n      preference: layouts,\n      maxHeightFunction: maxHeightFunction,\n      maxWidthFunction: maxWidthFunction\n    };\n    go(anchorBox, element, bubble, options);\n  };\n\n  var go = function (anchorBox, element, bubble, options) {\n    var decision = layout(anchorBox, element, bubble, options);\n    position(element, decision, options);\n    setClasses(element, decision);\n    setHeight(element, decision, options);\n    setWidth(element, decision, options);\n  };\n\n  var allAlignments = ['valignCentre', 'alignLeft', 'alignRight', 'alignCentre', 'top', 'bottom', 'left', 'right'];\n\n  var nu$8 = function (width, yoffset, classes) {\n    var getClasses = function (prop) {\n      return get$1(classes, prop).getOr([]);\n    };\n\n    var make = function (xDelta, yDelta, alignmentsOn) {\n      var alignmentsOff = difference(allAlignments, alignmentsOn);\n      return {\n        offset: SugarPosition(xDelta, yDelta),\n        classesOn: bind(alignmentsOn, getClasses),\n        classesOff: bind(alignmentsOff, getClasses)\n      };\n    };\n\n    return {\n      southeast: function () {\n        return make(-width, yoffset, ['top', 'alignLeft']);\n      },\n      southwest: function () {\n        return make(width, yoffset, ['top', 'alignRight']);\n      },\n      south: function () {\n        return make(-width / 2, yoffset, ['top', 'alignCentre']);\n      },\n      northeast: function () {\n        return make(-width, -yoffset, ['bottom', 'alignLeft']);\n      },\n      northwest: function () {\n        return make(width, -yoffset, ['bottom', 'alignRight']);\n      },\n      north: function () {\n        return make(-width / 2, -yoffset, ['bottom', 'alignCentre']);\n      },\n      east: function () {\n        return make(width, -yoffset / 2, ['valignCentre', 'left']);\n      },\n      west: function () {\n        return make(-width, -yoffset / 2, ['valignCentre', 'right']);\n      },\n      innerNorthwest: function () {\n        return make(-width, yoffset, ['top', 'alignRight']);\n      },\n      innerNortheast: function () {\n        return make(width, yoffset, ['top', 'alignLeft']);\n      },\n      innerNorth: function () {\n        return make(-width / 2, yoffset, ['top', 'alignCentre']);\n      },\n      innerSouthwest: function () {\n        return make(-width, -yoffset, ['bottom', 'alignRight']);\n      },\n      innerSoutheast: function () {\n        return make(width, -yoffset, ['bottom', 'alignLeft']);\n      },\n      innerSouth: function () {\n        return make(-width / 2, -yoffset, ['bottom', 'alignCentre']);\n      },\n      innerWest: function () {\n        return make(width, -yoffset / 2, ['valignCentre', 'right']);\n      },\n      innerEast: function () {\n        return make(-width, -yoffset / 2, ['valignCentre', 'left']);\n      }\n    };\n  };\n\n  var fallback = function () {\n    return nu$8(0, 0, {});\n  };\n\n  var nu$9 = function (x) {\n    return x;\n  };\n\n  var onDirection = function (isLtr, isRtl) {\n    return function (element) {\n      return getDirection(element) === 'rtl' ? isRtl : isLtr;\n    };\n  };\n\n  var getDirection = function (element) {\n    return get$5(element, 'direction') === 'rtl' ? 'rtl' : 'ltr';\n  };\n\n  var AttributeValue;\n\n  (function (AttributeValue) {\n    AttributeValue['TopToBottom'] = 'toptobottom';\n    AttributeValue['BottomToTop'] = 'bottomtotop';\n  })(AttributeValue || (AttributeValue = {}));\n\n  var Attribute = 'data-alloy-vertical-dir';\n\n  var isBottomToTopDir = function (el) {\n    return closest$2(el, function (current) {\n      return isElement(current) && get$3(current, 'data-alloy-vertical-dir') === AttributeValue.BottomToTop;\n    });\n  };\n\n  var schema$1 = function () {\n    return optionObjOf('layouts', [strict$1('onLtr'), strict$1('onRtl'), option('onBottomLtr'), option('onBottomRtl')]);\n  };\n\n  var get$b = function (elem, info, defaultLtr, defaultRtl, defaultBottomLtr, defaultBottomRtl, dirElement) {\n    var isBottomToTop = dirElement.map(isBottomToTopDir).getOr(false);\n    var customLtr = info.layouts.map(function (ls) {\n      return ls.onLtr(elem);\n    });\n    var customRtl = info.layouts.map(function (ls) {\n      return ls.onRtl(elem);\n    });\n    var ltr = isBottomToTop ? info.layouts.bind(function (ls) {\n      return ls.onBottomLtr.map(function (f) {\n        return f(elem);\n      });\n    }).or(customLtr).getOr(defaultBottomLtr) : customLtr.getOr(defaultLtr);\n    var rtl = isBottomToTop ? info.layouts.bind(function (ls) {\n      return ls.onBottomRtl.map(function (f) {\n        return f(elem);\n      });\n    }).or(customRtl).getOr(defaultBottomRtl) : customRtl.getOr(defaultRtl);\n    var f = onDirection(ltr, rtl);\n    return f(elem);\n  };\n\n  var placement = function (component, anchorInfo, origin) {\n    var hotspot = anchorInfo.hotspot;\n    var anchorBox = toBox(origin, hotspot.element);\n    var layouts = get$b(component.element, anchorInfo, belowOrAbove(), belowOrAboveRtl(), aboveOrBelow(), aboveOrBelowRtl(), Optional.some(anchorInfo.hotspot.element));\n    return Optional.some(nu$9({\n      anchorBox: anchorBox,\n      bubble: anchorInfo.bubble.getOr(fallback()),\n      overrides: anchorInfo.overrides,\n      layouts: layouts,\n      placer: Optional.none()\n    }));\n  };\n\n  var HotspotAnchor = [strict$1('hotspot'), option('bubble'), defaulted$1('overrides', {}), schema$1(), output('placement', placement)];\n\n  var placement$1 = function (component, anchorInfo, origin) {\n    var pos = translate(origin, anchorInfo.x, anchorInfo.y);\n    var anchorBox = bounds$1(pos.left, pos.top, anchorInfo.width, anchorInfo.height);\n    var layouts = get$b(component.element, anchorInfo, all$2(), allRtl(), all$2(), allRtl(), Optional.none());\n    return Optional.some(nu$9({\n      anchorBox: anchorBox,\n      bubble: anchorInfo.bubble,\n      overrides: anchorInfo.overrides,\n      layouts: layouts,\n      placer: Optional.none()\n    }));\n  };\n\n  var MakeshiftAnchor = [strict$1('x'), strict$1('y'), defaulted$1('height', 0), defaulted$1('width', 0), defaulted$1('bubble', fallback()), defaulted$1('overrides', {}), schema$1(), output('placement', placement$1)];\n  var adt$5 = Adt.generate([{\n    screen: ['point']\n  }, {\n    absolute: ['point', 'scrollLeft', 'scrollTop']\n  }]);\n\n  var toFixed = function (pos) {\n    return pos.fold(identity, function (point, scrollLeft, scrollTop) {\n      return point.translate(-scrollLeft, -scrollTop);\n    });\n  };\n\n  var toAbsolute = function (pos) {\n    return pos.fold(identity, identity);\n  };\n\n  var sum = function (points) {\n    return foldl(points, function (b, a) {\n      return b.translate(a.left, a.top);\n    }, SugarPosition(0, 0));\n  };\n\n  var sumAsFixed = function (positions) {\n    var points = map(positions, toFixed);\n    return sum(points);\n  };\n\n  var sumAsAbsolute = function (positions) {\n    var points = map(positions, toAbsolute);\n    return sum(points);\n  };\n\n  var screen = adt$5.screen;\n  var absolute$2 = adt$5.absolute;\n\n  var getOffset = function (component, origin, anchorInfo) {\n    var win = defaultView(anchorInfo.root).dom;\n\n    var hasSameOwner = function (frame) {\n      var frameOwner = owner(frame);\n      var compOwner = owner(component.element);\n      return eq$1(frameOwner, compOwner);\n    };\n\n    return Optional.from(win.frameElement).map(SugarElement.fromDom).filter(hasSameOwner).map(absolute);\n  };\n\n  var getRootPoint = function (component, origin, anchorInfo) {\n    var doc = owner(component.element);\n    var outerScroll = get$9(doc);\n    var offset = getOffset(component, origin, anchorInfo).getOr(outerScroll);\n    return absolute$2(offset, outerScroll.left, outerScroll.top);\n  };\n\n  var capRect = function (left, top, width, height) {\n    var newLeft = left,\n        newTop = top,\n        newWidth = width,\n        newHeight = height;\n\n    if (left < 0) {\n      newLeft = 0;\n      newWidth = width + left;\n    }\n\n    if (top < 0) {\n      newTop = 0;\n      newHeight = height + top;\n    }\n\n    var point = screen(SugarPosition(newLeft, newTop));\n    return Optional.some(pointed(point, newWidth, newHeight));\n  };\n\n  var calcNewAnchor = function (optBox, rootPoint, anchorInfo, origin, elem) {\n    return optBox.map(function (box) {\n      var points = [rootPoint, box.point];\n      var topLeft = cata$1(origin, function () {\n        return sumAsAbsolute(points);\n      }, function () {\n        return sumAsAbsolute(points);\n      }, function () {\n        return sumAsFixed(points);\n      });\n      var anchorBox = rect(topLeft.left, topLeft.top, box.width, box.height);\n      var layoutsLtr = anchorInfo.showAbove ? aboveOrBelow() : belowOrAbove();\n      var layoutsRtl = anchorInfo.showAbove ? aboveOrBelowRtl() : belowOrAboveRtl();\n      var layouts = get$b(elem, anchorInfo, layoutsLtr, layoutsRtl, layoutsLtr, layoutsRtl, Optional.none());\n      return nu$9({\n        anchorBox: anchorBox,\n        bubble: anchorInfo.bubble.getOr(fallback()),\n        overrides: anchorInfo.overrides,\n        layouts: layouts,\n        placer: Optional.none()\n      });\n    });\n  };\n\n  var placement$2 = function (component, anchorInfo, origin) {\n    var rootPoint = getRootPoint(component, origin, anchorInfo);\n    return anchorInfo.node.filter(inBody).bind(function (target) {\n      var rect = target.dom.getBoundingClientRect();\n      var nodeBox = capRect(rect.left, rect.top, rect.width, rect.height);\n      var elem = anchorInfo.node.getOr(component.element);\n      return calcNewAnchor(nodeBox, rootPoint, anchorInfo, origin, elem);\n    });\n  };\n\n  var NodeAnchor = [strict$1('node'), strict$1('root'), option('bubble'), schema$1(), defaulted$1('overrides', {}), defaulted$1('showAbove', false), output('placement', placement$2)];\n  var zeroWidth = '\\uFEFF';\n  var nbsp = '\\xA0';\n\n  var create$2 = function (start, soffset, finish, foffset) {\n    return {\n      start: start,\n      soffset: soffset,\n      finish: finish,\n      foffset: foffset\n    };\n  };\n\n  var SimRange = {\n    create: create$2\n  };\n  var adt$6 = Adt.generate([{\n    before: ['element']\n  }, {\n    on: ['element', 'offset']\n  }, {\n    after: ['element']\n  }]);\n\n  var cata$2 = function (subject, onBefore, onOn, onAfter) {\n    return subject.fold(onBefore, onOn, onAfter);\n  };\n\n  var getStart = function (situ) {\n    return situ.fold(identity, identity, identity);\n  };\n\n  var before$2 = adt$6.before;\n  var on = adt$6.on;\n  var after$1 = adt$6.after;\n  var Situ = {\n    before: before$2,\n    on: on,\n    after: after$1,\n    cata: cata$2,\n    getStart: getStart\n  };\n  var adt$7 = Adt.generate([{\n    domRange: ['rng']\n  }, {\n    relative: ['startSitu', 'finishSitu']\n  }, {\n    exact: ['start', 'soffset', 'finish', 'foffset']\n  }]);\n\n  var exactFromRange = function (simRange) {\n    return adt$7.exact(simRange.start, simRange.soffset, simRange.finish, simRange.foffset);\n  };\n\n  var getStart$1 = function (selection) {\n    return selection.match({\n      domRange: function (rng) {\n        return SugarElement.fromDom(rng.startContainer);\n      },\n      relative: function (startSitu, _finishSitu) {\n        return Situ.getStart(startSitu);\n      },\n      exact: function (start, _soffset, _finish, _foffset) {\n        return start;\n      }\n    });\n  };\n\n  var domRange = adt$7.domRange;\n  var relative$1 = adt$7.relative;\n  var exact = adt$7.exact;\n\n  var getWin = function (selection) {\n    var start = getStart$1(selection);\n    return defaultView(start);\n  };\n\n  var range$1 = SimRange.create;\n  var SimSelection = {\n    domRange: domRange,\n    relative: relative$1,\n    exact: exact,\n    exactFromRange: exactFromRange,\n    getWin: getWin,\n    range: range$1\n  };\n\n  var setStart = function (rng, situ) {\n    situ.fold(function (e) {\n      rng.setStartBefore(e.dom);\n    }, function (e, o) {\n      rng.setStart(e.dom, o);\n    }, function (e) {\n      rng.setStartAfter(e.dom);\n    });\n  };\n\n  var setFinish = function (rng, situ) {\n    situ.fold(function (e) {\n      rng.setEndBefore(e.dom);\n    }, function (e, o) {\n      rng.setEnd(e.dom, o);\n    }, function (e) {\n      rng.setEndAfter(e.dom);\n    });\n  };\n\n  var relativeToNative = function (win, startSitu, finishSitu) {\n    var range = win.document.createRange();\n    setStart(range, startSitu);\n    setFinish(range, finishSitu);\n    return range;\n  };\n\n  var exactToNative = function (win, start, soffset, finish, foffset) {\n    var rng = win.document.createRange();\n    rng.setStart(start.dom, soffset);\n    rng.setEnd(finish.dom, foffset);\n    return rng;\n  };\n\n  var toRect = function (rect) {\n    return {\n      left: rect.left,\n      top: rect.top,\n      right: rect.right,\n      bottom: rect.bottom,\n      width: rect.width,\n      height: rect.height\n    };\n  };\n\n  var getFirstRect = function (rng) {\n    var rects = rng.getClientRects();\n    var rect = rects.length > 0 ? rects[0] : rng.getBoundingClientRect();\n    return rect.width > 0 || rect.height > 0 ? Optional.some(rect).map(toRect) : Optional.none();\n  };\n\n  var adt$8 = Adt.generate([{\n    ltr: ['start', 'soffset', 'finish', 'foffset']\n  }, {\n    rtl: ['start', 'soffset', 'finish', 'foffset']\n  }]);\n\n  var fromRange = function (win, type, range) {\n    return type(SugarElement.fromDom(range.startContainer), range.startOffset, SugarElement.fromDom(range.endContainer), range.endOffset);\n  };\n\n  var getRanges = function (win, selection) {\n    return selection.match({\n      domRange: function (rng) {\n        return {\n          ltr: constant(rng),\n          rtl: Optional.none\n        };\n      },\n      relative: function (startSitu, finishSitu) {\n        return {\n          ltr: cached(function () {\n            return relativeToNative(win, startSitu, finishSitu);\n          }),\n          rtl: cached(function () {\n            return Optional.some(relativeToNative(win, finishSitu, startSitu));\n          })\n        };\n      },\n      exact: function (start, soffset, finish, foffset) {\n        return {\n          ltr: cached(function () {\n            return exactToNative(win, start, soffset, finish, foffset);\n          }),\n          rtl: cached(function () {\n            return Optional.some(exactToNative(win, finish, foffset, start, soffset));\n          })\n        };\n      }\n    });\n  };\n\n  var doDiagnose = function (win, ranges) {\n    var rng = ranges.ltr();\n\n    if (rng.collapsed) {\n      var reversed = ranges.rtl().filter(function (rev) {\n        return rev.collapsed === false;\n      });\n      return reversed.map(function (rev) {\n        return adt$8.rtl(SugarElement.fromDom(rev.endContainer), rev.endOffset, SugarElement.fromDom(rev.startContainer), rev.startOffset);\n      }).getOrThunk(function () {\n        return fromRange(win, adt$8.ltr, rng);\n      });\n    } else {\n      return fromRange(win, adt$8.ltr, rng);\n    }\n  };\n\n  var diagnose = function (win, selection) {\n    var ranges = getRanges(win, selection);\n    return doDiagnose(win, ranges);\n  };\n\n  var asLtrRange = function (win, selection) {\n    var diagnosis = diagnose(win, selection);\n    return diagnosis.match({\n      ltr: function (start, soffset, finish, foffset) {\n        var rng = win.document.createRange();\n        rng.setStart(start.dom, soffset);\n        rng.setEnd(finish.dom, foffset);\n        return rng;\n      },\n      rtl: function (start, soffset, finish, foffset) {\n        var rng = win.document.createRange();\n        rng.setStart(finish.dom, foffset);\n        rng.setEnd(start.dom, soffset);\n        return rng;\n      }\n    });\n  };\n\n  var ltr = adt$8.ltr;\n  var rtl = adt$8.rtl;\n\n  var NodeValue = function (is, name) {\n    var get = function (element) {\n      if (!is(element)) {\n        throw new Error('Can only get ' + name + ' value of a ' + name + ' node');\n      }\n\n      return getOption(element).getOr('');\n    };\n\n    var getOption = function (element) {\n      return is(element) ? Optional.from(element.dom.nodeValue) : Optional.none();\n    };\n\n    var set = function (element, value) {\n      if (!is(element)) {\n        throw new Error('Can only set raw ' + name + ' value of a ' + name + ' node');\n      }\n\n      element.dom.nodeValue = value;\n    };\n\n    return {\n      get: get,\n      getOption: getOption,\n      set: set\n    };\n  };\n\n  var api$2 = NodeValue(isText, 'text');\n\n  var get$c = function (element) {\n    return api$2.get(element);\n  };\n\n  var getOption = function (element) {\n    return api$2.getOption(element);\n  };\n\n  var getEnd = function (element) {\n    return name(element) === 'img' ? 1 : getOption(element).fold(function () {\n      return children(element).length;\n    }, function (v) {\n      return v.length;\n    });\n  };\n\n  var isTextNodeWithCursorPosition = function (el) {\n    return getOption(el).filter(function (text) {\n      return text.trim().length !== 0 || text.indexOf(nbsp) > -1;\n    }).isSome();\n  };\n\n  var elementsWithCursorPosition = ['img', 'br'];\n\n  var isCursorPosition = function (elem) {\n    var hasCursorPosition = isTextNodeWithCursorPosition(elem);\n    return hasCursorPosition || contains(elementsWithCursorPosition, name(elem));\n  };\n\n  var last$1 = function (element) {\n    return descendantRtl(element, isCursorPosition);\n  };\n\n  var descendantRtl = function (scope, predicate) {\n    var descend = function (element) {\n      var children$1 = children(element);\n\n      for (var i = children$1.length - 1; i >= 0; i--) {\n        var child = children$1[i];\n\n        if (predicate(child)) {\n          return Optional.some(child);\n        }\n\n        var res = descend(child);\n\n        if (res.isSome()) {\n          return res;\n        }\n      }\n\n      return Optional.none();\n    };\n\n    return descend(scope);\n  };\n\n  var descendants = function (scope, selector) {\n    return all(selector, scope);\n  };\n\n  var makeRange = function (start, soffset, finish, foffset) {\n    var doc = owner(start);\n    var rng = doc.dom.createRange();\n    rng.setStart(start.dom, soffset);\n    rng.setEnd(finish.dom, foffset);\n    return rng;\n  };\n\n  var after$2 = function (start, soffset, finish, foffset) {\n    var r = makeRange(start, soffset, finish, foffset);\n    var same = eq$1(start, finish) && soffset === foffset;\n    return r.collapsed && !same;\n  };\n\n  var getNativeSelection = function (win) {\n    return Optional.from(win.getSelection());\n  };\n\n  var readRange = function (selection) {\n    if (selection.rangeCount > 0) {\n      var firstRng = selection.getRangeAt(0);\n      var lastRng = selection.getRangeAt(selection.rangeCount - 1);\n      return Optional.some(SimRange.create(SugarElement.fromDom(firstRng.startContainer), firstRng.startOffset, SugarElement.fromDom(lastRng.endContainer), lastRng.endOffset));\n    } else {\n      return Optional.none();\n    }\n  };\n\n  var doGetExact = function (selection) {\n    if (selection.anchorNode === null || selection.focusNode === null) {\n      return readRange(selection);\n    } else {\n      var anchor = SugarElement.fromDom(selection.anchorNode);\n      var focus_1 = SugarElement.fromDom(selection.focusNode);\n      return after$2(anchor, selection.anchorOffset, focus_1, selection.focusOffset) ? Optional.some(SimRange.create(anchor, selection.anchorOffset, focus_1, selection.focusOffset)) : readRange(selection);\n    }\n  };\n\n  var getExact = function (win) {\n    return getNativeSelection(win).filter(function (sel) {\n      return sel.rangeCount > 0;\n    }).bind(doGetExact);\n  };\n\n  var getFirstRect$1 = function (win, selection) {\n    var rng = asLtrRange(win, selection);\n    return getFirstRect(rng);\n  };\n\n  var point = function (element, offset) {\n    return {\n      element: element,\n      offset: offset\n    };\n  };\n\n  var descendOnce = function (element, offset) {\n    var children$1 = children(element);\n\n    if (children$1.length === 0) {\n      return point(element, offset);\n    } else if (offset < children$1.length) {\n      return point(children$1[offset], 0);\n    } else {\n      var last = children$1[children$1.length - 1];\n      var len = isText(last) ? get$c(last).length : children(last).length;\n      return point(last, len);\n    }\n  };\n\n  var descendOnce$1 = function (element, offset) {\n    return isText(element) ? point(element, offset) : descendOnce(element, offset);\n  };\n\n  var getAnchorSelection = function (win, anchorInfo) {\n    var getSelection = anchorInfo.getSelection.getOrThunk(function () {\n      return function () {\n        return getExact(win);\n      };\n    });\n    return getSelection().map(function (sel) {\n      var modStart = descendOnce$1(sel.start, sel.soffset);\n      var modFinish = descendOnce$1(sel.finish, sel.foffset);\n      return SimSelection.range(modStart.element, modStart.offset, modFinish.element, modFinish.offset);\n    });\n  };\n\n  var placement$3 = function (component, anchorInfo, origin) {\n    var win = defaultView(anchorInfo.root).dom;\n    var rootPoint = getRootPoint(component, origin, anchorInfo);\n    var selectionBox = getAnchorSelection(win, anchorInfo).bind(function (sel) {\n      var optRect = getFirstRect$1(win, SimSelection.exactFromRange(sel)).orThunk(function () {\n        var x = SugarElement.fromText(zeroWidth);\n        before(sel.start, x);\n        return getFirstRect$1(win, SimSelection.exact(x, 0, x, 1)).map(function (rect) {\n          remove(x);\n          return rect;\n        });\n      });\n      return optRect.bind(function (rawRect) {\n        return capRect(rawRect.left, rawRect.top, rawRect.width, rawRect.height);\n      });\n    });\n    var targetElement = getAnchorSelection(win, anchorInfo).bind(function (sel) {\n      return isElement(sel.start) ? Optional.some(sel.start) : parentNode(sel.start);\n    });\n    var elem = targetElement.getOr(component.element);\n    return calcNewAnchor(selectionBox, rootPoint, anchorInfo, origin, elem);\n  };\n\n  var SelectionAnchor = [option('getSelection'), strict$1('root'), option('bubble'), schema$1(), defaulted$1('overrides', {}), defaulted$1('showAbove', false), output('placement', placement$3)];\n\n  var eastX$1 = function (anchor) {\n    return anchor.x + anchor.width;\n  };\n\n  var westX$1 = function (anchor, element) {\n    return anchor.x - element.width;\n  };\n\n  var northY$1 = function (anchor, element) {\n    return anchor.y - element.height + anchor.height;\n  };\n\n  var southY$1 = function (anchor) {\n    return anchor.y;\n  };\n\n  var southeast$2 = function (anchor, element, bubbles) {\n    return nu$7(eastX$1(anchor), southY$1(anchor), bubbles.southeast(), southeast(), boundsRestriction(anchor, {\n      left: 0,\n      top: 2\n    }), 'link-layout-se');\n  };\n\n  var southwest$2 = function (anchor, element, bubbles) {\n    return nu$7(westX$1(anchor, element), southY$1(anchor), bubbles.southwest(), southwest(), boundsRestriction(anchor, {\n      right: 1,\n      top: 2\n    }), 'link-layout-sw');\n  };\n\n  var northeast$2 = function (anchor, element, bubbles) {\n    return nu$7(eastX$1(anchor), northY$1(anchor, element), bubbles.northeast(), northeast(), boundsRestriction(anchor, {\n      left: 0,\n      bottom: 3\n    }), 'link-layout-ne');\n  };\n\n  var northwest$2 = function (anchor, element, bubbles) {\n    return nu$7(westX$1(anchor, element), northY$1(anchor, element), bubbles.northwest(), northwest(), boundsRestriction(anchor, {\n      right: 1,\n      bottom: 3\n    }), 'link-layout-nw');\n  };\n\n  var all$3 = function () {\n    return [southeast$2, southwest$2, northeast$2, northwest$2];\n  };\n\n  var allRtl$1 = function () {\n    return [southwest$2, southeast$2, northwest$2, northeast$2];\n  };\n\n  var placement$4 = function (component, submenuInfo, origin) {\n    var anchorBox = toBox(origin, submenuInfo.item.element);\n    var layouts = get$b(component.element, submenuInfo, all$3(), allRtl$1(), all$3(), allRtl$1(), Optional.none());\n    return Optional.some(nu$9({\n      anchorBox: anchorBox,\n      bubble: fallback(),\n      overrides: submenuInfo.overrides,\n      layouts: layouts,\n      placer: Optional.none()\n    }));\n  };\n\n  var SubmenuAnchor = [strict$1('item'), schema$1(), defaulted$1('overrides', {}), output('placement', placement$4)];\n  var AnchorSchema = choose$1('anchor', {\n    selection: SelectionAnchor,\n    node: NodeAnchor,\n    hotspot: HotspotAnchor,\n    submenu: SubmenuAnchor,\n    makeshift: MakeshiftAnchor\n  });\n\n  var getFixedOrigin = function () {\n    var html = document.documentElement;\n    return fixed(0, 0, html.clientWidth, html.clientHeight);\n  };\n\n  var getRelativeOrigin = function (component) {\n    var position = absolute(component.element);\n    var bounds = component.element.dom.getBoundingClientRect();\n    return relative(position.left, position.top, bounds.width, bounds.height);\n  };\n\n  var place = function (component, origin, anchoring, getBounds, placee) {\n    var anchor = box$1(anchoring.anchorBox, origin);\n    simple(anchor, placee.element, anchoring.bubble, anchoring.layouts, getBounds, anchoring.overrides);\n  };\n\n  var position$1 = function (component, posConfig, posState, anchor, placee) {\n    positionWithin(component, posConfig, posState, anchor, placee, Optional.none());\n  };\n\n  var positionWithin = function (component, posConfig, posState, anchor, placee, boxElement) {\n    var boundsBox = boxElement.map(box);\n    return positionWithinBounds(component, posConfig, posState, anchor, placee, boundsBox);\n  };\n\n  var positionWithinBounds = function (component, posConfig, posState, anchor, placee, bounds) {\n    var anchorage = asRawOrDie('positioning anchor.info', AnchorSchema, anchor);\n    preserve(function () {\n      set$2(placee.element, 'position', 'fixed');\n      var oldVisibility = getRaw(placee.element, 'visibility');\n      set$2(placee.element, 'visibility', 'hidden');\n      var origin = posConfig.useFixed() ? getFixedOrigin() : getRelativeOrigin(component);\n      var placer = anchorage.placement;\n      var getBounds = bounds.map(constant).or(posConfig.getBounds);\n      placer(component, anchorage, origin).each(function (anchoring) {\n        var doPlace = anchoring.placer.getOr(place);\n        doPlace(component, origin, anchoring, getBounds, placee);\n      });\n      oldVisibility.fold(function () {\n        remove$6(placee.element, 'visibility');\n      }, function (vis) {\n        set$2(placee.element, 'visibility', vis);\n      });\n\n      if (getRaw(placee.element, 'left').isNone() && getRaw(placee.element, 'top').isNone() && getRaw(placee.element, 'right').isNone() && getRaw(placee.element, 'bottom').isNone() && getRaw(placee.element, 'position').is('fixed')) {\n        remove$6(placee.element, 'position');\n      }\n    }, placee.element);\n  };\n\n  var getMode = function (component, pConfig, _pState) {\n    return pConfig.useFixed() ? 'fixed' : 'absolute';\n  };\n\n  var PositionApis = /*#__PURE__*/Object.freeze({\n    __proto__: null,\n    position: position$1,\n    positionWithin: positionWithin,\n    positionWithinBounds: positionWithinBounds,\n    getMode: getMode\n  });\n  var PositionSchema = [defaulted$1('useFixed', never), option('getBounds')];\n  var Positioning = create$1({\n    fields: PositionSchema,\n    name: 'positioning',\n    active: ActivePosition,\n    apis: PositionApis\n  });\n\n  var fireDetaching = function (component) {\n    emit(component, detachedFromDom());\n    var children = component.components();\n    each(children, fireDetaching);\n  };\n\n  var fireAttaching = function (component) {\n    var children = component.components();\n    each(children, fireAttaching);\n    emit(component, attachedToDom());\n  };\n\n  var attach = function (parent, child) {\n    append(parent.element, child.element);\n  };\n\n  var detachChildren = function (component) {\n    each(component.components(), function (childComp) {\n      return remove(childComp.element);\n    });\n    empty(component.element);\n    component.syncComponents();\n  };\n\n  var replaceChildren = function (component, newChildren) {\n    var subs = component.components();\n    detachChildren(component);\n    var deleted = difference(subs, newChildren);\n    each(deleted, function (comp) {\n      fireDetaching(comp);\n      component.getSystem().removeFromWorld(comp);\n    });\n    each(newChildren, function (childComp) {\n      if (!childComp.getSystem().isConnected()) {\n        component.getSystem().addToWorld(childComp);\n        attach(component, childComp);\n\n        if (inBody(component.element)) {\n          fireAttaching(childComp);\n        }\n      } else {\n        attach(component, childComp);\n      }\n\n      component.syncComponents();\n    });\n  };\n\n  var attach$1 = function (parent, child) {\n    attachWith(parent, child, append);\n  };\n\n  var attachWith = function (parent, child, insertion) {\n    parent.getSystem().addToWorld(child);\n    insertion(parent.element, child.element);\n\n    if (inBody(parent.element)) {\n      fireAttaching(child);\n    }\n\n    parent.syncComponents();\n  };\n\n  var doDetach = function (component) {\n    fireDetaching(component);\n    remove(component.element);\n    component.getSystem().removeFromWorld(component);\n  };\n\n  var detach = function (component) {\n    var parent$1 = parent(component.element).bind(function (p) {\n      return component.getSystem().getByDom(p).toOptional();\n    });\n    doDetach(component);\n    parent$1.each(function (p) {\n      p.syncComponents();\n    });\n  };\n\n  var detachChildren$1 = function (component) {\n    var subs = component.components();\n    each(subs, doDetach);\n    empty(component.element);\n    component.syncComponents();\n  };\n\n  var attachSystem = function (element, guiSystem) {\n    attachSystemWith(element, guiSystem, append);\n  };\n\n  var attachSystemAfter = function (element, guiSystem) {\n    attachSystemWith(element, guiSystem, after);\n  };\n\n  var attachSystemWith = function (element, guiSystem, inserter) {\n    inserter(element, guiSystem.element);\n    var children$1 = children(guiSystem.element);\n    each(children$1, function (child) {\n      guiSystem.getByDom(child).each(fireAttaching);\n    });\n  };\n\n  var detachSystem = function (guiSystem) {\n    var children$1 = children(guiSystem.element);\n    each(children$1, function (child) {\n      guiSystem.getByDom(child).each(fireDetaching);\n    });\n    remove(guiSystem.element);\n  };\n\n  var rebuild = function (sandbox, sConfig, sState, data) {\n    sState.get().each(function (_data) {\n      detachChildren$1(sandbox);\n    });\n    var point = sConfig.getAttachPoint(sandbox);\n    attach$1(point, sandbox);\n    var built = sandbox.getSystem().build(data);\n    attach$1(sandbox, built);\n    sState.set(built);\n    return built;\n  };\n\n  var open = function (sandbox, sConfig, sState, data) {\n    var newState = rebuild(sandbox, sConfig, sState, data);\n    sConfig.onOpen(sandbox, newState);\n    return newState;\n  };\n\n  var setContent = function (sandbox, sConfig, sState, data) {\n    return sState.get().map(function () {\n      return rebuild(sandbox, sConfig, sState, data);\n    });\n  };\n\n  var openWhileCloaked = function (sandbox, sConfig, sState, data, transaction) {\n    cloak(sandbox, sConfig);\n    open(sandbox, sConfig, sState, data);\n    transaction();\n    decloak(sandbox, sConfig);\n  };\n\n  var close = function (sandbox, sConfig, sState) {\n    sState.get().each(function (data) {\n      detachChildren$1(sandbox);\n      detach(sandbox);\n      sConfig.onClose(sandbox, data);\n      sState.clear();\n    });\n  };\n\n  var isOpen = function (_sandbox, _sConfig, sState) {\n    return sState.isOpen();\n  };\n\n  var isPartOf$1 = function (sandbox, sConfig, sState, queryElem) {\n    return isOpen(sandbox, sConfig, sState) && sState.get().exists(function (data) {\n      return sConfig.isPartOf(sandbox, data, queryElem);\n    });\n  };\n\n  var getState = function (_sandbox, _sConfig, sState) {\n    return sState.get();\n  };\n\n  var store = function (sandbox, cssKey, attr, newValue) {\n    getRaw(sandbox.element, cssKey).fold(function () {\n      remove$1(sandbox.element, attr);\n    }, function (v) {\n      set$1(sandbox.element, attr, v);\n    });\n    set$2(sandbox.element, cssKey, newValue);\n  };\n\n  var restore = function (sandbox, cssKey, attr) {\n    getOpt(sandbox.element, attr).fold(function () {\n      return remove$6(sandbox.element, cssKey);\n    }, function (oldValue) {\n      return set$2(sandbox.element, cssKey, oldValue);\n    });\n  };\n\n  var cloak = function (sandbox, sConfig, _sState) {\n    var sink = sConfig.getAttachPoint(sandbox);\n    set$2(sandbox.element, 'position', Positioning.getMode(sink));\n    store(sandbox, 'visibility', sConfig.cloakVisibilityAttr, 'hidden');\n  };\n\n  var hasPosition = function (element) {\n    return exists(['top', 'left', 'right', 'bottom'], function (pos) {\n      return getRaw(element, pos).isSome();\n    });\n  };\n\n  var decloak = function (sandbox, sConfig, _sState) {\n    if (!hasPosition(sandbox.element)) {\n      remove$6(sandbox.element, 'position');\n    }\n\n    restore(sandbox, 'visibility', sConfig.cloakVisibilityAttr);\n  };\n\n  var SandboxApis = /*#__PURE__*/Object.freeze({\n    __proto__: null,\n    cloak: cloak,\n    decloak: decloak,\n    open: open,\n    openWhileCloaked: openWhileCloaked,\n    close: close,\n    isOpen: isOpen,\n    isPartOf: isPartOf$1,\n    getState: getState,\n    setContent: setContent\n  });\n\n  var events$2 = function (sandboxConfig, sandboxState) {\n    return derive([run(sandboxClose(), function (sandbox, _simulatedEvent) {\n      close(sandbox, sandboxConfig, sandboxState);\n    })]);\n  };\n\n  var ActiveSandbox = /*#__PURE__*/Object.freeze({\n    __proto__: null,\n    events: events$2\n  });\n  var SandboxSchema = [onHandler('onOpen'), onHandler('onClose'), strict$1('isPartOf'), strict$1('getAttachPoint'), defaulted$1('cloakVisibilityAttr', 'data-precloak-visibility')];\n\n  var init = function () {\n    var contents = Cell(Optional.none());\n    var readState = constant('not-implemented');\n\n    var isOpen = function () {\n      return contents.get().isSome();\n    };\n\n    var set = function (comp) {\n      contents.set(Optional.some(comp));\n    };\n\n    var get = function () {\n      return contents.get();\n    };\n\n    var clear = function () {\n      contents.set(Optional.none());\n    };\n\n    return nu$5({\n      readState: readState,\n      isOpen: isOpen,\n      clear: clear,\n      set: set,\n      get: get\n    });\n  };\n\n  var SandboxState = /*#__PURE__*/Object.freeze({\n    __proto__: null,\n    init: init\n  });\n  var Sandboxing = create$1({\n    fields: SandboxSchema,\n    name: 'sandboxing',\n    active: ActiveSandbox,\n    apis: SandboxApis,\n    state: SandboxState\n  });\n  var dismissPopups = constant('dismiss.popups');\n  var repositionPopups = constant('reposition.popups');\n  var mouseReleased = constant('mouse.released');\n  var schema$2 = objOfOnly([defaulted$1('isExtraPart', never), optionObjOf('fireEventInstead', [defaulted$1('event', dismissRequested())])]);\n\n  var receivingChannel = function (rawSpec) {\n    var _a;\n\n    var detail = asRawOrDie('Dismissal', schema$2, rawSpec);\n    return _a = {}, _a[dismissPopups()] = {\n      schema: objOfOnly([strict$1('target')]),\n      onReceive: function (sandbox, data) {\n        if (Sandboxing.isOpen(sandbox)) {\n          var isPart = Sandboxing.isPartOf(sandbox, data.target) || detail.isExtraPart(sandbox, data.target);\n\n          if (!isPart) {\n            detail.fireEventInstead.fold(function () {\n              return Sandboxing.close(sandbox);\n            }, function (fe) {\n              return emit(sandbox, fe.event);\n            });\n          }\n        }\n      }\n    }, _a;\n  };\n\n  var schema$3 = objOfOnly([optionObjOf('fireEventInstead', [defaulted$1('event', repositionRequested())]), strictFunction('doReposition')]);\n\n  var receivingChannel$1 = function (rawSpec) {\n    var _a;\n\n    var detail = asRawOrDie('Reposition', schema$3, rawSpec);\n    return _a = {}, _a[repositionPopups()] = {\n      onReceive: function (sandbox) {\n        if (Sandboxing.isOpen(sandbox)) {\n          detail.fireEventInstead.fold(function () {\n            return detail.doReposition(sandbox);\n          }, function (fe) {\n            return emit(sandbox, fe.event);\n          });\n        }\n      }\n    }, _a;\n  };\n\n  var onLoad = function (component, repConfig, repState) {\n    repConfig.store.manager.onLoad(component, repConfig, repState);\n  };\n\n  var onUnload = function (component, repConfig, repState) {\n    repConfig.store.manager.onUnload(component, repConfig, repState);\n  };\n\n  var setValue = function (component, repConfig, repState, data) {\n    repConfig.store.manager.setValue(component, repConfig, repState, data);\n  };\n\n  var getValue = function (component, repConfig, repState) {\n    return repConfig.store.manager.getValue(component, repConfig, repState);\n  };\n\n  var getState$1 = function (component, repConfig, repState) {\n    return repState;\n  };\n\n  var RepresentApis = /*#__PURE__*/Object.freeze({\n    __proto__: null,\n    onLoad: onLoad,\n    onUnload: onUnload,\n    setValue: setValue,\n    getValue: getValue,\n    getState: getState$1\n  });\n\n  var events$3 = function (repConfig, repState) {\n    var es = repConfig.resetOnDom ? [runOnAttached(function (comp, _se) {\n      onLoad(comp, repConfig, repState);\n    }), runOnDetached(function (comp, _se) {\n      onUnload(comp, repConfig, repState);\n    })] : [loadEvent(repConfig, repState, onLoad)];\n    return derive(es);\n  };\n\n  var ActiveRepresenting = /*#__PURE__*/Object.freeze({\n    __proto__: null,\n    events: events$3\n  });\n\n  var memory = function () {\n    var data = Cell(null);\n\n    var readState = function () {\n      return {\n        mode: 'memory',\n        value: data.get()\n      };\n    };\n\n    var isNotSet = function () {\n      return data.get() === null;\n    };\n\n    var clear = function () {\n      data.set(null);\n    };\n\n    return nu$5({\n      set: data.set,\n      get: data.get,\n      isNotSet: isNotSet,\n      clear: clear,\n      readState: readState\n    });\n  };\n\n  var manual = function () {\n    var readState = noop;\n    return nu$5({\n      readState: readState\n    });\n  };\n\n  var dataset = function () {\n    var dataByValue = Cell({});\n    var dataByText = Cell({});\n\n    var readState = function () {\n      return {\n        mode: 'dataset',\n        dataByValue: dataByValue.get(),\n        dataByText: dataByText.get()\n      };\n    };\n\n    var clear = function () {\n      dataByValue.set({});\n      dataByText.set({});\n    };\n\n    var lookup = function (itemString) {\n      return get$1(dataByValue.get(), itemString).orThunk(function () {\n        return get$1(dataByText.get(), itemString);\n      });\n    };\n\n    var update = function (items) {\n      var currentDataByValue = dataByValue.get();\n      var currentDataByText = dataByText.get();\n      var newDataByValue = {};\n      var newDataByText = {};\n      each(items, function (item) {\n        newDataByValue[item.value] = item;\n        get$1(item, 'meta').each(function (meta) {\n          get$1(meta, 'text').each(function (text) {\n            newDataByText[text] = item;\n          });\n        });\n      });\n      dataByValue.set(__assign(__assign({}, currentDataByValue), newDataByValue));\n      dataByText.set(__assign(__assign({}, currentDataByText), newDataByText));\n    };\n\n    return nu$5({\n      readState: readState,\n      lookup: lookup,\n      update: update,\n      clear: clear\n    });\n  };\n\n  var init$1 = function (spec) {\n    return spec.store.manager.state(spec);\n  };\n\n  var RepresentState = /*#__PURE__*/Object.freeze({\n    __proto__: null,\n    memory: memory,\n    dataset: dataset,\n    manual: manual,\n    init: init$1\n  });\n\n  var setValue$1 = function (component, repConfig, repState, data) {\n    var store = repConfig.store;\n    repState.update([data]);\n    store.setValue(component, data);\n    repConfig.onSetValue(component, data);\n  };\n\n  var getValue$1 = function (component, repConfig, repState) {\n    var store = repConfig.store;\n    var key = store.getDataKey(component);\n    return repState.lookup(key).fold(function () {\n      return store.getFallbackEntry(key);\n    }, function (data) {\n      return data;\n    });\n  };\n\n  var onLoad$1 = function (component, repConfig, repState) {\n    var store = repConfig.store;\n    store.initialValue.each(function (data) {\n      setValue$1(component, repConfig, repState, data);\n    });\n  };\n\n  var onUnload$1 = function (component, repConfig, repState) {\n    repState.clear();\n  };\n\n  var DatasetStore = [option('initialValue'), strict$1('getFallbackEntry'), strict$1('getDataKey'), strict$1('setValue'), output('manager', {\n    setValue: setValue$1,\n    getValue: getValue$1,\n    onLoad: onLoad$1,\n    onUnload: onUnload$1,\n    state: dataset\n  })];\n\n  var getValue$2 = function (component, repConfig, _repState) {\n    return repConfig.store.getValue(component);\n  };\n\n  var setValue$2 = function (component, repConfig, _repState, data) {\n    repConfig.store.setValue(component, data);\n    repConfig.onSetValue(component, data);\n  };\n\n  var onLoad$2 = function (component, repConfig, _repState) {\n    repConfig.store.initialValue.each(function (data) {\n      repConfig.store.setValue(component, data);\n    });\n  };\n\n  var ManualStore = [strict$1('getValue'), defaulted$1('setValue', noop), option('initialValue'), output('manager', {\n    setValue: setValue$2,\n    getValue: getValue$2,\n    onLoad: onLoad$2,\n    onUnload: noop,\n    state: NoState.init\n  })];\n\n  var setValue$3 = function (component, repConfig, repState, data) {\n    repState.set(data);\n    repConfig.onSetValue(component, data);\n  };\n\n  var getValue$3 = function (component, repConfig, repState) {\n    return repState.get();\n  };\n\n  var onLoad$3 = function (component, repConfig, repState) {\n    repConfig.store.initialValue.each(function (initVal) {\n      if (repState.isNotSet()) {\n        repState.set(initVal);\n      }\n    });\n  };\n\n  var onUnload$2 = function (component, repConfig, repState) {\n    repState.clear();\n  };\n\n  var MemoryStore = [option('initialValue'), output('manager', {\n    setValue: setValue$3,\n    getValue: getValue$3,\n    onLoad: onLoad$3,\n    onUnload: onUnload$2,\n    state: memory\n  })];\n  var RepresentSchema = [defaultedOf('store', {\n    mode: 'memory'\n  }, choose$1('mode', {\n    memory: MemoryStore,\n    manual: ManualStore,\n    dataset: DatasetStore\n  })), onHandler('onSetValue'), defaulted$1('resetOnDom', false)];\n  var Representing = create$1({\n    fields: RepresentSchema,\n    name: 'representing',\n    active: ActiveRepresenting,\n    apis: RepresentApis,\n    extra: {\n      setValueFrom: function (component, source) {\n        var value = Representing.getValue(source);\n        Representing.setValue(component, value);\n      }\n    },\n    state: RepresentState\n  });\n\n  var field$1 = function (name, forbidden) {\n    return defaultedObjOf(name, {}, map(forbidden, function (f) {\n      return forbid(f.name(), 'Cannot configure ' + f.name() + ' for ' + name);\n    }).concat([state$1('dump', identity)]));\n  };\n\n  var get$d = function (data) {\n    return data.dump;\n  };\n\n  var augment = function (data, original) {\n    return __assign(__assign({}, data.dump), derive$1(original));\n  };\n\n  var SketchBehaviours = {\n    field: field$1,\n    augment: augment,\n    get: get$d\n  };\n  var _placeholder = 'placeholder';\n  var adt$9 = Adt.generate([{\n    single: ['required', 'valueThunk']\n  }, {\n    multiple: ['required', 'valueThunks']\n  }]);\n\n  var isSubstituted = function (spec) {\n    return has(spec, 'uiType');\n  };\n\n  var subPlaceholder = function (owner, detail, compSpec, placeholders) {\n    if (owner.exists(function (o) {\n      return o !== compSpec.owner;\n    })) {\n      return adt$9.single(true, constant(compSpec));\n    }\n\n    return get$1(placeholders, compSpec.name).fold(function () {\n      throw new Error('Unknown placeholder component: ' + compSpec.name + '\\nKnown: [' + keys(placeholders) + ']\\nNamespace: ' + owner.getOr('none') + '\\nSpec: ' + JSON.stringify(compSpec, null, 2));\n    }, function (newSpec) {\n      return newSpec.replace();\n    });\n  };\n\n  var scan = function (owner, detail, compSpec, placeholders) {\n    if (isSubstituted(compSpec) && compSpec.uiType === _placeholder) {\n      return subPlaceholder(owner, detail, compSpec, placeholders);\n    } else {\n      return adt$9.single(false, constant(compSpec));\n    }\n  };\n\n  var substitute = function (owner, detail, compSpec, placeholders) {\n    var base = scan(owner, detail, compSpec, placeholders);\n    return base.fold(function (req, valueThunk) {\n      var value = isSubstituted(compSpec) ? valueThunk(detail, compSpec.config, compSpec.validated) : valueThunk(detail);\n      var childSpecs = get$1(value, 'components').getOr([]);\n      var substituted = bind(childSpecs, function (c) {\n        return substitute(owner, detail, c, placeholders);\n      });\n      return [__assign(__assign({}, value), {\n        components: substituted\n      })];\n    }, function (req, valuesThunk) {\n      if (isSubstituted(compSpec)) {\n        var values = valuesThunk(detail, compSpec.config, compSpec.validated);\n        var preprocessor = compSpec.validated.preprocess.getOr(identity);\n        return preprocessor(values);\n      } else {\n        return valuesThunk(detail);\n      }\n    });\n  };\n\n  var substituteAll = function (owner, detail, components, placeholders) {\n    return bind(components, function (c) {\n      return substitute(owner, detail, c, placeholders);\n    });\n  };\n\n  var oneReplace = function (label, replacements) {\n    var called = false;\n\n    var used = function () {\n      return called;\n    };\n\n    var replace = function () {\n      if (called) {\n        throw new Error('Trying to use the same placeholder more than once: ' + label);\n      }\n\n      called = true;\n      return replacements;\n    };\n\n    var required = function () {\n      return replacements.fold(function (req, _) {\n        return req;\n      }, function (req, _) {\n        return req;\n      });\n    };\n\n    return {\n      name: constant(label),\n      required: required,\n      used: used,\n      replace: replace\n    };\n  };\n\n  var substitutePlaces = function (owner, detail, components, placeholders) {\n    var ps = map$2(placeholders, function (ph, name) {\n      return oneReplace(name, ph);\n    });\n    var outcome = substituteAll(owner, detail, components, ps);\n    each$1(ps, function (p) {\n      if (p.used() === false && p.required()) {\n        throw new Error('Placeholder: ' + p.name() + ' was not found in components list\\nNamespace: ' + owner.getOr('none') + '\\nComponents: ' + JSON.stringify(detail.components, null, 2));\n      }\n    });\n    return outcome;\n  };\n\n  var single = adt$9.single;\n  var multiple = adt$9.multiple;\n  var placeholder = constant(_placeholder);\n  var adt$a = Adt.generate([{\n    required: ['data']\n  }, {\n    external: ['data']\n  }, {\n    optional: ['data']\n  }, {\n    group: ['data']\n  }]);\n  var fFactory = defaulted$1('factory', {\n    sketch: identity\n  });\n  var fSchema = defaulted$1('schema', []);\n  var fName = strict$1('name');\n  var fPname = field('pname', 'pname', defaultedThunk(function (typeSpec) {\n    return '<alloy.' + generate$1(typeSpec.name) + '>';\n  }), anyValue$1());\n  var fGroupSchema = state$1('schema', function () {\n    return [option('preprocess')];\n  });\n  var fDefaults = defaulted$1('defaults', constant({}));\n  var fOverrides = defaulted$1('overrides', constant({}));\n  var requiredSpec = objOf([fFactory, fSchema, fName, fPname, fDefaults, fOverrides]);\n  var externalSpec = objOf([fFactory, fSchema, fName, fDefaults, fOverrides]);\n  var optionalSpec = objOf([fFactory, fSchema, fName, fPname, fDefaults, fOverrides]);\n  var groupSpec = objOf([fFactory, fGroupSchema, fName, strict$1('unit'), fPname, fDefaults, fOverrides]);\n\n  var asNamedPart = function (part) {\n    return part.fold(Optional.some, Optional.none, Optional.some, Optional.some);\n  };\n\n  var name$1 = function (part) {\n    var get = function (data) {\n      return data.name;\n    };\n\n    return part.fold(get, get, get, get);\n  };\n\n  var asCommon = function (part) {\n    return part.fold(identity, identity, identity, identity);\n  };\n\n  var convert = function (adtConstructor, partSchema) {\n    return function (spec) {\n      var data = asRawOrDie('Converting part type', partSchema, spec);\n      return adtConstructor(data);\n    };\n  };\n\n  var required = convert(adt$a.required, requiredSpec);\n  var external$1 = convert(adt$a.external, externalSpec);\n  var optional = convert(adt$a.optional, optionalSpec);\n  var group = convert(adt$a.group, groupSpec);\n  var original = constant('entirety');\n  var PartType = /*#__PURE__*/Object.freeze({\n    __proto__: null,\n    required: required,\n    external: external$1,\n    optional: optional,\n    group: group,\n    asNamedPart: asNamedPart,\n    name: name$1,\n    asCommon: asCommon,\n    original: original\n  });\n\n  var combine$2 = function (detail, data, partSpec, partValidated) {\n    return deepMerge(data.defaults(detail, partSpec, partValidated), partSpec, {\n      uid: detail.partUids[data.name]\n    }, data.overrides(detail, partSpec, partValidated));\n  };\n\n  var subs = function (owner, detail, parts) {\n    var internals = {};\n    var externals = {};\n    each(parts, function (part) {\n      part.fold(function (data) {\n        internals[data.pname] = single(true, function (detail, partSpec, partValidated) {\n          return data.factory.sketch(combine$2(detail, data, partSpec, partValidated));\n        });\n      }, function (data) {\n        var partSpec = detail.parts[data.name];\n        externals[data.name] = constant(data.factory.sketch(combine$2(detail, data, partSpec[original()]), partSpec));\n      }, function (data) {\n        internals[data.pname] = single(false, function (detail, partSpec, partValidated) {\n          return data.factory.sketch(combine$2(detail, data, partSpec, partValidated));\n        });\n      }, function (data) {\n        internals[data.pname] = multiple(true, function (detail, _partSpec, _partValidated) {\n          var units = detail[data.name];\n          return map(units, function (u) {\n            return data.factory.sketch(deepMerge(data.defaults(detail, u, _partValidated), u, data.overrides(detail, u)));\n          });\n        });\n      });\n    });\n    return {\n      internals: constant(internals),\n      externals: constant(externals)\n    };\n  };\n\n  var generate$4 = function (owner, parts) {\n    var r = {};\n    each(parts, function (part) {\n      asNamedPart(part).each(function (np) {\n        var g = doGenerateOne(owner, np.pname);\n\n        r[np.name] = function (config) {\n          var validated = asRawOrDie('Part: ' + np.name + ' in ' + owner, objOf(np.schema), config);\n          return __assign(__assign({}, g), {\n            config: config,\n            validated: validated\n          });\n        };\n      });\n    });\n    return r;\n  };\n\n  var doGenerateOne = function (owner, pname) {\n    return {\n      uiType: placeholder(),\n      owner: owner,\n      name: pname\n    };\n  };\n\n  var generateOne = function (owner, pname, config) {\n    return {\n      uiType: placeholder(),\n      owner: owner,\n      name: pname,\n      config: config,\n      validated: {}\n    };\n  };\n\n  var schemas = function (parts) {\n    return bind(parts, function (part) {\n      return part.fold(Optional.none, Optional.some, Optional.none, Optional.none).map(function (data) {\n        return strictObjOf(data.name, data.schema.concat([snapshot(original())]));\n      }).toArray();\n    });\n  };\n\n  var names = function (parts) {\n    return map(parts, name$1);\n  };\n\n  var substitutes = function (owner, detail, parts) {\n    return subs(owner, detail, parts);\n  };\n\n  var components = function (owner, detail, internals) {\n    return substitutePlaces(Optional.some(owner), detail, detail.components, internals);\n  };\n\n  var getPart = function (component, detail, partKey) {\n    var uid = detail.partUids[partKey];\n    return component.getSystem().getByUid(uid).toOptional();\n  };\n\n  var getPartOrDie = function (component, detail, partKey) {\n    return getPart(component, detail, partKey).getOrDie('Could not find part: ' + partKey);\n  };\n\n  var getParts = function (component, detail, partKeys) {\n    var r = {};\n    var uids = detail.partUids;\n    var system = component.getSystem();\n    each(partKeys, function (pk) {\n      r[pk] = constant(system.getByUid(uids[pk]));\n    });\n    return r;\n  };\n\n  var getAllParts = function (component, detail) {\n    var system = component.getSystem();\n    return map$2(detail.partUids, function (pUid, _k) {\n      return constant(system.getByUid(pUid));\n    });\n  };\n\n  var getAllPartNames = function (detail) {\n    return keys(detail.partUids);\n  };\n\n  var getPartsOrDie = function (component, detail, partKeys) {\n    var r = {};\n    var uids = detail.partUids;\n    var system = component.getSystem();\n    each(partKeys, function (pk) {\n      r[pk] = constant(system.getByUid(uids[pk]).getOrDie());\n    });\n    return r;\n  };\n\n  var defaultUids = function (baseUid, partTypes) {\n    var partNames = names(partTypes);\n    return wrapAll$1(map(partNames, function (pn) {\n      return {\n        key: pn,\n        value: baseUid + '-' + pn\n      };\n    }));\n  };\n\n  var defaultUidsSchema = function (partTypes) {\n    return field('partUids', 'partUids', mergeWithThunk(function (spec) {\n      return defaultUids(spec.uid, partTypes);\n    }), anyValue$1());\n  };\n\n  var AlloyParts = /*#__PURE__*/Object.freeze({\n    __proto__: null,\n    generate: generate$4,\n    generateOne: generateOne,\n    schemas: schemas,\n    names: names,\n    substitutes: substitutes,\n    components: components,\n    defaultUids: defaultUids,\n    defaultUidsSchema: defaultUidsSchema,\n    getAllParts: getAllParts,\n    getAllPartNames: getAllPartNames,\n    getPart: getPart,\n    getPartOrDie: getPartOrDie,\n    getParts: getParts,\n    getPartsOrDie: getPartsOrDie\n  });\n\n  var base = function (partSchemas, partUidsSchemas) {\n    var ps = partSchemas.length > 0 ? [strictObjOf('parts', partSchemas)] : [];\n    return ps.concat([strict$1('uid'), defaulted$1('dom', {}), defaulted$1('components', []), snapshot('originalSpec'), defaulted$1('debug.sketcher', {})]).concat(partUidsSchemas);\n  };\n\n  var asRawOrDie$1 = function (label, schema, spec, partSchemas, partUidsSchemas) {\n    var baseS = base(partSchemas, partUidsSchemas);\n    return asRawOrDie(label + ' [SpecSchema]', objOfOnly(baseS.concat(schema)), spec);\n  };\n\n  var single$1 = function (owner, schema, factory, spec) {\n    var specWithUid = supplyUid(spec);\n    var detail = asRawOrDie$1(owner, schema, specWithUid, [], []);\n    return factory(detail, specWithUid);\n  };\n\n  var composite = function (owner, schema, partTypes, factory, spec) {\n    var specWithUid = supplyUid(spec);\n    var partSchemas = schemas(partTypes);\n    var partUidsSchema = defaultUidsSchema(partTypes);\n    var detail = asRawOrDie$1(owner, schema, specWithUid, partSchemas, [partUidsSchema]);\n    var subs = substitutes(owner, detail, partTypes);\n    var components$1 = components(owner, detail, subs.internals());\n    return factory(detail, components$1, specWithUid, subs.externals());\n  };\n\n  var hasUid = function (spec) {\n    return has(spec, 'uid');\n  };\n\n  var supplyUid = function (spec) {\n    return hasUid(spec) ? spec : __assign(__assign({}, spec), {\n      uid: generate$2('uid')\n    });\n  };\n\n  var isSketchSpec = function (spec) {\n    return spec.uid !== undefined;\n  };\n\n  var singleSchema = objOfOnly([strict$1('name'), strict$1('factory'), strict$1('configFields'), defaulted$1('apis', {}), defaulted$1('extraApis', {})]);\n  var compositeSchema = objOfOnly([strict$1('name'), strict$1('factory'), strict$1('configFields'), strict$1('partFields'), defaulted$1('apis', {}), defaulted$1('extraApis', {})]);\n\n  var single$2 = function (rawConfig) {\n    var config = asRawOrDie('Sketcher for ' + rawConfig.name, singleSchema, rawConfig);\n\n    var sketch = function (spec) {\n      return single$1(config.name, config.configFields, config.factory, spec);\n    };\n\n    var apis = map$2(config.apis, makeApi);\n    var extraApis = map$2(config.extraApis, function (f, k) {\n      return markAsExtraApi(f, k);\n    });\n    return __assign(__assign({\n      name: config.name,\n      configFields: config.configFields,\n      sketch: sketch\n    }, apis), extraApis);\n  };\n\n  var composite$1 = function (rawConfig) {\n    var config = asRawOrDie('Sketcher for ' + rawConfig.name, compositeSchema, rawConfig);\n\n    var sketch = function (spec) {\n      return composite(config.name, config.configFields, config.partFields, config.factory, spec);\n    };\n\n    var parts = generate$4(config.name, config.partFields);\n    var apis = map$2(config.apis, makeApi);\n    var extraApis = map$2(config.extraApis, function (f, k) {\n      return markAsExtraApi(f, k);\n    });\n    return __assign(__assign({\n      name: config.name,\n      partFields: config.partFields,\n      configFields: config.configFields,\n      sketch: sketch,\n      parts: parts\n    }, apis), extraApis);\n  };\n\n  var cat = function (arr) {\n    var r = [];\n\n    var push = function (x) {\n      r.push(x);\n    };\n\n    for (var i = 0; i < arr.length; i++) {\n      arr[i].each(push);\n    }\n\n    return r;\n  };\n\n  var sequence = function (arr) {\n    var r = [];\n\n    for (var i = 0; i < arr.length; i++) {\n      var x = arr[i];\n\n      if (x.isSome()) {\n        r.push(x.getOrDie());\n      } else {\n        return Optional.none();\n      }\n    }\n\n    return Optional.some(r);\n  };\n\n  var lift2 = function (oa, ob, f) {\n    return oa.isSome() && ob.isSome() ? Optional.some(f(oa.getOrDie(), ob.getOrDie())) : Optional.none();\n  };\n\n  var lift3 = function (oa, ob, oc, f) {\n    return oa.isSome() && ob.isSome() && oc.isSome() ? Optional.some(f(oa.getOrDie(), ob.getOrDie(), oc.getOrDie())) : Optional.none();\n  };\n\n  var mapFrom = function (a, f) {\n    return a !== undefined && a !== null ? Optional.some(f(a)) : Optional.none();\n  };\n\n  var someIf = function (b, a) {\n    return b ? Optional.some(a) : Optional.none();\n  };\n\n  var inside = function (target) {\n    return name(target) === 'input' && get$3(target, 'type') !== 'radio' || name(target) === 'textarea';\n  };\n\n  var getCurrent = function (component, composeConfig, _composeState) {\n    return composeConfig.find(component);\n  };\n\n  var ComposeApis = /*#__PURE__*/Object.freeze({\n    __proto__: null,\n    getCurrent: getCurrent\n  });\n  var ComposeSchema = [strict$1('find')];\n  var Composing = create$1({\n    fields: ComposeSchema,\n    name: 'composing',\n    apis: ComposeApis\n  });\n\n  var dehighlightAllExcept = function (component, hConfig, hState, skip) {\n    var highlighted = descendants(component.element, '.' + hConfig.highlightClass);\n    each(highlighted, function (h) {\n      if (!exists(skip, function (skipComp) {\n        return skipComp.element === h;\n      })) {\n        remove$4(h, hConfig.highlightClass);\n        component.getSystem().getByDom(h).each(function (target) {\n          hConfig.onDehighlight(component, target);\n          emit(target, dehighlight());\n        });\n      }\n    });\n  };\n\n  var dehighlightAll = function (component, hConfig, hState) {\n    return dehighlightAllExcept(component, hConfig, hState, []);\n  };\n\n  var dehighlight$1 = function (component, hConfig, hState, target) {\n    if (isHighlighted(component, hConfig, hState, target)) {\n      remove$4(target.element, hConfig.highlightClass);\n      hConfig.onDehighlight(component, target);\n      emit(target, dehighlight());\n    }\n  };\n\n  var highlight$1 = function (component, hConfig, hState, target) {\n    dehighlightAllExcept(component, hConfig, hState, [target]);\n\n    if (!isHighlighted(component, hConfig, hState, target)) {\n      add$2(target.element, hConfig.highlightClass);\n      hConfig.onHighlight(component, target);\n      emit(target, highlight());\n    }\n  };\n\n  var highlightFirst = function (component, hConfig, hState) {\n    getFirst(component, hConfig).each(function (firstComp) {\n      highlight$1(component, hConfig, hState, firstComp);\n    });\n  };\n\n  var highlightLast = function (component, hConfig, hState) {\n    getLast(component, hConfig).each(function (lastComp) {\n      highlight$1(component, hConfig, hState, lastComp);\n    });\n  };\n\n  var highlightAt = function (component, hConfig, hState, index) {\n    getByIndex(component, hConfig, hState, index).fold(function (err) {\n      throw err;\n    }, function (firstComp) {\n      highlight$1(component, hConfig, hState, firstComp);\n    });\n  };\n\n  var highlightBy = function (component, hConfig, hState, predicate) {\n    var candidates = getCandidates(component, hConfig);\n    var targetComp = find(candidates, predicate);\n    targetComp.each(function (c) {\n      highlight$1(component, hConfig, hState, c);\n    });\n  };\n\n  var isHighlighted = function (component, hConfig, hState, queryTarget) {\n    return has$2(queryTarget.element, hConfig.highlightClass);\n  };\n\n  var getHighlighted = function (component, hConfig, _hState) {\n    return descendant$1(component.element, '.' + hConfig.highlightClass).bind(function (e) {\n      return component.getSystem().getByDom(e).toOptional();\n    });\n  };\n\n  var getByIndex = function (component, hConfig, hState, index) {\n    var items = descendants(component.element, '.' + hConfig.itemClass);\n    return Optional.from(items[index]).fold(function () {\n      return Result.error(new Error('No element found with index ' + index));\n    }, component.getSystem().getByDom);\n  };\n\n  var getFirst = function (component, hConfig, _hState) {\n    return descendant$1(component.element, '.' + hConfig.itemClass).bind(function (e) {\n      return component.getSystem().getByDom(e).toOptional();\n    });\n  };\n\n  var getLast = function (component, hConfig, _hState) {\n    var items = descendants(component.element, '.' + hConfig.itemClass);\n    var last = items.length > 0 ? Optional.some(items[items.length - 1]) : Optional.none();\n    return last.bind(function (c) {\n      return component.getSystem().getByDom(c).toOptional();\n    });\n  };\n\n  var getDelta = function (component, hConfig, hState, delta) {\n    var items = descendants(component.element, '.' + hConfig.itemClass);\n    var current = findIndex(items, function (item) {\n      return has$2(item, hConfig.highlightClass);\n    });\n    return current.bind(function (selected) {\n      var dest = cycleBy(selected, delta, 0, items.length - 1);\n      return component.getSystem().getByDom(items[dest]).toOptional();\n    });\n  };\n\n  var getPrevious = function (component, hConfig, hState) {\n    return getDelta(component, hConfig, hState, -1);\n  };\n\n  var getNext = function (component, hConfig, hState) {\n    return getDelta(component, hConfig, hState, +1);\n  };\n\n  var getCandidates = function (component, hConfig, _hState) {\n    var items = descendants(component.element, '.' + hConfig.itemClass);\n    return cat(map(items, function (i) {\n      return component.getSystem().getByDom(i).toOptional();\n    }));\n  };\n\n  var HighlightApis = /*#__PURE__*/Object.freeze({\n    __proto__: null,\n    dehighlightAll: dehighlightAll,\n    dehighlight: dehighlight$1,\n    highlight: highlight$1,\n    highlightFirst: highlightFirst,\n    highlightLast: highlightLast,\n    highlightAt: highlightAt,\n    highlightBy: highlightBy,\n    isHighlighted: isHighlighted,\n    getHighlighted: getHighlighted,\n    getFirst: getFirst,\n    getLast: getLast,\n    getPrevious: getPrevious,\n    getNext: getNext,\n    getCandidates: getCandidates\n  });\n  var HighlightSchema = [strict$1('highlightClass'), strict$1('itemClass'), onHandler('onHighlight'), onHandler('onDehighlight')];\n  var Highlighting = create$1({\n    fields: HighlightSchema,\n    name: 'highlighting',\n    apis: HighlightApis\n  });\n  var BACKSPACE = [8];\n  var TAB = [9];\n  var ENTER = [13];\n  var ESCAPE = [27];\n  var SPACE = [32];\n  var LEFT = [37];\n  var UP = [38];\n  var RIGHT = [39];\n  var DOWN = [40];\n\n  var cyclePrev = function (values, index, predicate) {\n    var before = reverse(values.slice(0, index));\n    var after = reverse(values.slice(index + 1));\n    return find(before.concat(after), predicate);\n  };\n\n  var tryPrev = function (values, index, predicate) {\n    var before = reverse(values.slice(0, index));\n    return find(before, predicate);\n  };\n\n  var cycleNext = function (values, index, predicate) {\n    var before = values.slice(0, index);\n    var after = values.slice(index + 1);\n    return find(after.concat(before), predicate);\n  };\n\n  var tryNext = function (values, index, predicate) {\n    var after = values.slice(index + 1);\n    return find(after, predicate);\n  };\n\n  var inSet = function (keys) {\n    return function (event) {\n      var raw = event.raw;\n      return contains(keys, raw.which);\n    };\n  };\n\n  var and = function (preds) {\n    return function (event) {\n      return forall(preds, function (pred) {\n        return pred(event);\n      });\n    };\n  };\n\n  var isShift = function (event) {\n    var raw = event.raw;\n    return raw.shiftKey === true;\n  };\n\n  var isControl = function (event) {\n    var raw = event.raw;\n    return raw.ctrlKey === true;\n  };\n\n  var isNotShift = not(isShift);\n\n  var rule = function (matches, action) {\n    return {\n      matches: matches,\n      classification: action\n    };\n  };\n\n  var choose$2 = function (transitions, event) {\n    var transition = find(transitions, function (t) {\n      return t.matches(event);\n    });\n    return transition.map(function (t) {\n      return t.classification;\n    });\n  };\n\n  var reportFocusShifting = function (component, prevFocus, newFocus) {\n    var noChange = prevFocus.exists(function (p) {\n      return newFocus.exists(function (n) {\n        return eq$1(n, p);\n      });\n    });\n\n    if (!noChange) {\n      emitWith(component, focusShifted(), {\n        prevFocus: prevFocus,\n        newFocus: newFocus\n      });\n    }\n  };\n\n  var dom = function () {\n    var get = function (component) {\n      return search(component.element);\n    };\n\n    var set = function (component, focusee) {\n      var prevFocus = get(component);\n      component.getSystem().triggerFocus(focusee, component.element);\n      var newFocus = get(component);\n      reportFocusShifting(component, prevFocus, newFocus);\n    };\n\n    return {\n      get: get,\n      set: set\n    };\n  };\n\n  var highlights = function () {\n    var get = function (component) {\n      return Highlighting.getHighlighted(component).map(function (item) {\n        return item.element;\n      });\n    };\n\n    var set = function (component, element) {\n      var prevFocus = get(component);\n      component.getSystem().getByDom(element).fold(noop, function (item) {\n        Highlighting.highlight(component, item);\n      });\n      var newFocus = get(component);\n      reportFocusShifting(component, prevFocus, newFocus);\n    };\n\n    return {\n      get: get,\n      set: set\n    };\n  };\n\n  var FocusInsideModes;\n\n  (function (FocusInsideModes) {\n    FocusInsideModes['OnFocusMode'] = 'onFocus';\n    FocusInsideModes['OnEnterOrSpaceMode'] = 'onEnterOrSpace';\n    FocusInsideModes['OnApiMode'] = 'onApi';\n  })(FocusInsideModes || (FocusInsideModes = {}));\n\n  var typical = function (infoSchema, stateInit, getKeydownRules, getKeyupRules, optFocusIn) {\n    var schema = function () {\n      return infoSchema.concat([defaulted$1('focusManager', dom()), defaultedOf('focusInside', 'onFocus', valueOf(function (val) {\n        return contains(['onFocus', 'onEnterOrSpace', 'onApi'], val) ? Result.value(val) : Result.error('Invalid value for focusInside');\n      })), output('handler', me), output('state', stateInit), output('sendFocusIn', optFocusIn)]);\n    };\n\n    var processKey = function (component, simulatedEvent, getRules, keyingConfig, keyingState) {\n      var rules = getRules(component, simulatedEvent, keyingConfig, keyingState);\n      return choose$2(rules, simulatedEvent.event).bind(function (rule) {\n        return rule(component, simulatedEvent, keyingConfig, keyingState);\n      });\n    };\n\n    var toEvents = function (keyingConfig, keyingState) {\n      var onFocusHandler = keyingConfig.focusInside !== FocusInsideModes.OnFocusMode ? Optional.none() : optFocusIn(keyingConfig).map(function (focusIn) {\n        return run(focus(), function (component, simulatedEvent) {\n          focusIn(component, keyingConfig, keyingState);\n          simulatedEvent.stop();\n        });\n      });\n\n      var tryGoInsideComponent = function (component, simulatedEvent) {\n        var isEnterOrSpace = inSet(SPACE.concat(ENTER))(simulatedEvent.event);\n\n        if (keyingConfig.focusInside === FocusInsideModes.OnEnterOrSpaceMode && isEnterOrSpace && isSource(component, simulatedEvent)) {\n          optFocusIn(keyingConfig).each(function (focusIn) {\n            focusIn(component, keyingConfig, keyingState);\n            simulatedEvent.stop();\n          });\n        }\n      };\n\n      var keyboardEvents = [run(keydown(), function (component, simulatedEvent) {\n        processKey(component, simulatedEvent, getKeydownRules, keyingConfig, keyingState).fold(function () {\n          tryGoInsideComponent(component, simulatedEvent);\n        }, function (_) {\n          simulatedEvent.stop();\n        });\n      }), run(keyup(), function (component, simulatedEvent) {\n        processKey(component, simulatedEvent, getKeyupRules, keyingConfig, keyingState).each(function (_) {\n          simulatedEvent.stop();\n        });\n      })];\n      return derive(onFocusHandler.toArray().concat(keyboardEvents));\n    };\n\n    var me = {\n      schema: schema,\n      processKey: processKey,\n      toEvents: toEvents\n    };\n    return me;\n  };\n\n  var create$3 = function (cyclicField) {\n    var schema = [option('onEscape'), option('onEnter'), defaulted$1('selector', '[data-alloy-tabstop=\"true\"]:not(:disabled)'), defaulted$1('firstTabstop', 0), defaulted$1('useTabstopAt', always), option('visibilitySelector')].concat([cyclicField]);\n\n    var isVisible = function (tabbingConfig, element) {\n      var target = tabbingConfig.visibilitySelector.bind(function (sel) {\n        return closest$3(element, sel);\n      }).getOr(element);\n      return get$7(target) > 0;\n    };\n\n    var findInitial = function (component, tabbingConfig) {\n      var tabstops = descendants(component.element, tabbingConfig.selector);\n      var visibles = filter(tabstops, function (elem) {\n        return isVisible(tabbingConfig, elem);\n      });\n      return Optional.from(visibles[tabbingConfig.firstTabstop]);\n    };\n\n    var findCurrent = function (component, tabbingConfig) {\n      return tabbingConfig.focusManager.get(component).bind(function (elem) {\n        return closest$3(elem, tabbingConfig.selector);\n      });\n    };\n\n    var isTabstop = function (tabbingConfig, element) {\n      return isVisible(tabbingConfig, element) && tabbingConfig.useTabstopAt(element);\n    };\n\n    var focusIn = function (component, tabbingConfig, _tabbingState) {\n      findInitial(component, tabbingConfig).each(function (target) {\n        tabbingConfig.focusManager.set(component, target);\n      });\n    };\n\n    var goFromTabstop = function (component, tabstops, stopIndex, tabbingConfig, cycle) {\n      return cycle(tabstops, stopIndex, function (elem) {\n        return isTabstop(tabbingConfig, elem);\n      }).fold(function () {\n        return tabbingConfig.cyclic ? Optional.some(true) : Optional.none();\n      }, function (target) {\n        tabbingConfig.focusManager.set(component, target);\n        return Optional.some(true);\n      });\n    };\n\n    var go = function (component, _simulatedEvent, tabbingConfig, cycle) {\n      var tabstops = descendants(component.element, tabbingConfig.selector);\n      return findCurrent(component, tabbingConfig).bind(function (tabstop) {\n        var optStopIndex = findIndex(tabstops, curry(eq$1, tabstop));\n        return optStopIndex.bind(function (stopIndex) {\n          return goFromTabstop(component, tabstops, stopIndex, tabbingConfig, cycle);\n        });\n      });\n    };\n\n    var goBackwards = function (component, simulatedEvent, tabbingConfig) {\n      var navigate = tabbingConfig.cyclic ? cyclePrev : tryPrev;\n      return go(component, simulatedEvent, tabbingConfig, navigate);\n    };\n\n    var goForwards = function (component, simulatedEvent, tabbingConfig) {\n      var navigate = tabbingConfig.cyclic ? cycleNext : tryNext;\n      return go(component, simulatedEvent, tabbingConfig, navigate);\n    };\n\n    var execute = function (component, simulatedEvent, tabbingConfig) {\n      return tabbingConfig.onEnter.bind(function (f) {\n        return f(component, simulatedEvent);\n      });\n    };\n\n    var exit = function (component, simulatedEvent, tabbingConfig) {\n      return tabbingConfig.onEscape.bind(function (f) {\n        return f(component, simulatedEvent);\n      });\n    };\n\n    var getKeydownRules = constant([rule(and([isShift, inSet(TAB)]), goBackwards), rule(inSet(TAB), goForwards), rule(inSet(ESCAPE), exit), rule(and([isNotShift, inSet(ENTER)]), execute)]);\n    var getKeyupRules = constant([]);\n    return typical(schema, NoState.init, getKeydownRules, getKeyupRules, function () {\n      return Optional.some(focusIn);\n    });\n  };\n\n  var AcyclicType = create$3(state$1('cyclic', never));\n  var CyclicType = create$3(state$1('cyclic', always));\n\n  var doDefaultExecute = function (component, _simulatedEvent, focused) {\n    dispatch(component, focused, execute());\n    return Optional.some(true);\n  };\n\n  var defaultExecute = function (component, simulatedEvent, focused) {\n    var isComplex = inside(focused) && inSet(SPACE)(simulatedEvent.event);\n    return isComplex ? Optional.none() : doDefaultExecute(component, simulatedEvent, focused);\n  };\n\n  var stopEventForFirefox = function (_component, _simulatedEvent) {\n    return Optional.some(true);\n  };\n\n  var schema$4 = [defaulted$1('execute', defaultExecute), defaulted$1('useSpace', false), defaulted$1('useEnter', true), defaulted$1('useControlEnter', false), defaulted$1('useDown', false)];\n\n  var execute$1 = function (component, simulatedEvent, executeConfig) {\n    return executeConfig.execute(component, simulatedEvent, component.element);\n  };\n\n  var getKeydownRules = function (component, _simulatedEvent, executeConfig, _executeState) {\n    var spaceExec = executeConfig.useSpace && !inside(component.element) ? SPACE : [];\n    var enterExec = executeConfig.useEnter ? ENTER : [];\n    var downExec = executeConfig.useDown ? DOWN : [];\n    var execKeys = spaceExec.concat(enterExec).concat(downExec);\n    return [rule(inSet(execKeys), execute$1)].concat(executeConfig.useControlEnter ? [rule(and([isControl, inSet(ENTER)]), execute$1)] : []);\n  };\n\n  var getKeyupRules = function (component, _simulatedEvent, executeConfig, _executeState) {\n    return executeConfig.useSpace && !inside(component.element) ? [rule(inSet(SPACE), stopEventForFirefox)] : [];\n  };\n\n  var ExecutionType = typical(schema$4, NoState.init, getKeydownRules, getKeyupRules, function () {\n    return Optional.none();\n  });\n\n  var flatgrid = function () {\n    var dimensions = Cell(Optional.none());\n\n    var setGridSize = function (numRows, numColumns) {\n      dimensions.set(Optional.some({\n        numRows: numRows,\n        numColumns: numColumns\n      }));\n    };\n\n    var getNumRows = function () {\n      return dimensions.get().map(function (d) {\n        return d.numRows;\n      });\n    };\n\n    var getNumColumns = function () {\n      return dimensions.get().map(function (d) {\n        return d.numColumns;\n      });\n    };\n\n    return nu$5({\n      readState: function () {\n        return dimensions.get().map(function (d) {\n          return {\n            numRows: String(d.numRows),\n            numColumns: String(d.numColumns)\n          };\n        }).getOr({\n          numRows: '?',\n          numColumns: '?'\n        });\n      },\n      setGridSize: setGridSize,\n      getNumRows: getNumRows,\n      getNumColumns: getNumColumns\n    });\n  };\n\n  var init$2 = function (spec) {\n    return spec.state(spec);\n  };\n\n  var KeyingState = /*#__PURE__*/Object.freeze({\n    __proto__: null,\n    flatgrid: flatgrid,\n    init: init$2\n  });\n\n  var useH = function (movement) {\n    return function (component, simulatedEvent, config, state) {\n      var move = movement(component.element);\n      return use(move, component, simulatedEvent, config, state);\n    };\n  };\n\n  var west$2 = function (moveLeft, moveRight) {\n    var movement = onDirection(moveLeft, moveRight);\n    return useH(movement);\n  };\n\n  var east$2 = function (moveLeft, moveRight) {\n    var movement = onDirection(moveRight, moveLeft);\n    return useH(movement);\n  };\n\n  var useV = function (move) {\n    return function (component, simulatedEvent, config, state) {\n      return use(move, component, simulatedEvent, config, state);\n    };\n  };\n\n  var use = function (move, component, simulatedEvent, config, state) {\n    var outcome = config.focusManager.get(component).bind(function (focused) {\n      return move(component.element, focused, config, state);\n    });\n    return outcome.map(function (newFocus) {\n      config.focusManager.set(component, newFocus);\n      return true;\n    });\n  };\n\n  var north$2 = useV;\n  var south$2 = useV;\n  var move = useV;\n\n  var isHidden = function (dom) {\n    return dom.offsetWidth <= 0 && dom.offsetHeight <= 0;\n  };\n\n  var isVisible = function (element) {\n    return !isHidden(element.dom);\n  };\n\n  var locate = function (candidates, predicate) {\n    return findIndex(candidates, predicate).map(function (index) {\n      return {\n        index: index,\n        candidates: candidates\n      };\n    });\n  };\n\n  var locateVisible = function (container, current, selector) {\n    var predicate = function (x) {\n      return eq$1(x, current);\n    };\n\n    var candidates = descendants(container, selector);\n    var visible = filter(candidates, isVisible);\n    return locate(visible, predicate);\n  };\n\n  var findIndex$1 = function (elements, target) {\n    return findIndex(elements, function (elem) {\n      return eq$1(target, elem);\n    });\n  };\n\n  var withGrid = function (values, index, numCols, f) {\n    var oldRow = Math.floor(index / numCols);\n    var oldColumn = index % numCols;\n    return f(oldRow, oldColumn).bind(function (address) {\n      var newIndex = address.row * numCols + address.column;\n      return newIndex >= 0 && newIndex < values.length ? Optional.some(values[newIndex]) : Optional.none();\n    });\n  };\n\n  var cycleHorizontal = function (values, index, numRows, numCols, delta) {\n    return withGrid(values, index, numCols, function (oldRow, oldColumn) {\n      var onLastRow = oldRow === numRows - 1;\n      var colsInRow = onLastRow ? values.length - oldRow * numCols : numCols;\n      var newColumn = cycleBy(oldColumn, delta, 0, colsInRow - 1);\n      return Optional.some({\n        row: oldRow,\n        column: newColumn\n      });\n    });\n  };\n\n  var cycleVertical = function (values, index, numRows, numCols, delta) {\n    return withGrid(values, index, numCols, function (oldRow, oldColumn) {\n      var newRow = cycleBy(oldRow, delta, 0, numRows - 1);\n      var onLastRow = newRow === numRows - 1;\n      var colsInRow = onLastRow ? values.length - newRow * numCols : numCols;\n      var newCol = clamp(oldColumn, 0, colsInRow - 1);\n      return Optional.some({\n        row: newRow,\n        column: newCol\n      });\n    });\n  };\n\n  var cycleRight = function (values, index, numRows, numCols) {\n    return cycleHorizontal(values, index, numRows, numCols, +1);\n  };\n\n  var cycleLeft = function (values, index, numRows, numCols) {\n    return cycleHorizontal(values, index, numRows, numCols, -1);\n  };\n\n  var cycleUp = function (values, index, numRows, numCols) {\n    return cycleVertical(values, index, numRows, numCols, -1);\n  };\n\n  var cycleDown = function (values, index, numRows, numCols) {\n    return cycleVertical(values, index, numRows, numCols, +1);\n  };\n\n  var schema$5 = [strict$1('selector'), defaulted$1('execute', defaultExecute), onKeyboardHandler('onEscape'), defaulted$1('captureTab', false), initSize()];\n\n  var focusIn = function (component, gridConfig, _gridState) {\n    descendant$1(component.element, gridConfig.selector).each(function (first) {\n      gridConfig.focusManager.set(component, first);\n    });\n  };\n\n  var findCurrent = function (component, gridConfig) {\n    return gridConfig.focusManager.get(component).bind(function (elem) {\n      return closest$3(elem, gridConfig.selector);\n    });\n  };\n\n  var execute$2 = function (component, simulatedEvent, gridConfig, _gridState) {\n    return findCurrent(component, gridConfig).bind(function (focused) {\n      return gridConfig.execute(component, simulatedEvent, focused);\n    });\n  };\n\n  var doMove = function (cycle) {\n    return function (element, focused, gridConfig, gridState) {\n      return locateVisible(element, focused, gridConfig.selector).bind(function (identified) {\n        return cycle(identified.candidates, identified.index, gridState.getNumRows().getOr(gridConfig.initSize.numRows), gridState.getNumColumns().getOr(gridConfig.initSize.numColumns));\n      });\n    };\n  };\n\n  var handleTab = function (_component, _simulatedEvent, gridConfig) {\n    return gridConfig.captureTab ? Optional.some(true) : Optional.none();\n  };\n\n  var doEscape = function (component, simulatedEvent, gridConfig) {\n    return gridConfig.onEscape(component, simulatedEvent);\n  };\n\n  var moveLeft = doMove(cycleLeft);\n  var moveRight = doMove(cycleRight);\n  var moveNorth = doMove(cycleUp);\n  var moveSouth = doMove(cycleDown);\n  var getKeydownRules$1 = constant([rule(inSet(LEFT), west$2(moveLeft, moveRight)), rule(inSet(RIGHT), east$2(moveLeft, moveRight)), rule(inSet(UP), north$2(moveNorth)), rule(inSet(DOWN), south$2(moveSouth)), rule(and([isShift, inSet(TAB)]), handleTab), rule(and([isNotShift, inSet(TAB)]), handleTab), rule(inSet(ESCAPE), doEscape), rule(inSet(SPACE.concat(ENTER)), execute$2)]);\n  var getKeyupRules$1 = constant([rule(inSet(SPACE), stopEventForFirefox)]);\n  var FlatgridType = typical(schema$5, flatgrid, getKeydownRules$1, getKeyupRules$1, function () {\n    return Optional.some(focusIn);\n  });\n\n  var horizontal = function (container, selector, current, delta) {\n    var isDisabledButton = function (candidate) {\n      return name(candidate) === 'button' && get$3(candidate, 'disabled') === 'disabled';\n    };\n\n    var tryCycle = function (initial, index, candidates) {\n      var newIndex = cycleBy(index, delta, 0, candidates.length - 1);\n\n      if (newIndex === initial) {\n        return Optional.none();\n      } else {\n        return isDisabledButton(candidates[newIndex]) ? tryCycle(initial, newIndex, candidates) : Optional.from(candidates[newIndex]);\n      }\n    };\n\n    return locateVisible(container, current, selector).bind(function (identified) {\n      var index = identified.index;\n      var candidates = identified.candidates;\n      return tryCycle(index, index, candidates);\n    });\n  };\n\n  var schema$6 = [strict$1('selector'), defaulted$1('getInitial', Optional.none), defaulted$1('execute', defaultExecute), onKeyboardHandler('onEscape'), defaulted$1('executeOnMove', false), defaulted$1('allowVertical', true)];\n\n  var findCurrent$1 = function (component, flowConfig) {\n    return flowConfig.focusManager.get(component).bind(function (elem) {\n      return closest$3(elem, flowConfig.selector);\n    });\n  };\n\n  var execute$3 = function (component, simulatedEvent, flowConfig) {\n    return findCurrent$1(component, flowConfig).bind(function (focused) {\n      return flowConfig.execute(component, simulatedEvent, focused);\n    });\n  };\n\n  var focusIn$1 = function (component, flowConfig, _state) {\n    flowConfig.getInitial(component).orThunk(function () {\n      return descendant$1(component.element, flowConfig.selector);\n    }).each(function (first) {\n      flowConfig.focusManager.set(component, first);\n    });\n  };\n\n  var moveLeft$1 = function (element, focused, info) {\n    return horizontal(element, info.selector, focused, -1);\n  };\n\n  var moveRight$1 = function (element, focused, info) {\n    return horizontal(element, info.selector, focused, +1);\n  };\n\n  var doMove$1 = function (movement) {\n    return function (component, simulatedEvent, flowConfig, flowState) {\n      return movement(component, simulatedEvent, flowConfig, flowState).bind(function () {\n        return flowConfig.executeOnMove ? execute$3(component, simulatedEvent, flowConfig) : Optional.some(true);\n      });\n    };\n  };\n\n  var doEscape$1 = function (component, simulatedEvent, flowConfig) {\n    return flowConfig.onEscape(component, simulatedEvent);\n  };\n\n  var getKeydownRules$2 = function (_component, _se, flowConfig, _flowState) {\n    var westMovers = LEFT.concat(flowConfig.allowVertical ? UP : []);\n    var eastMovers = RIGHT.concat(flowConfig.allowVertical ? DOWN : []);\n    return [rule(inSet(westMovers), doMove$1(west$2(moveLeft$1, moveRight$1))), rule(inSet(eastMovers), doMove$1(east$2(moveLeft$1, moveRight$1))), rule(inSet(ENTER), execute$3), rule(inSet(SPACE), execute$3), rule(inSet(ESCAPE), doEscape$1)];\n  };\n\n  var getKeyupRules$2 = constant([rule(inSet(SPACE), stopEventForFirefox)]);\n  var FlowType = typical(schema$6, NoState.init, getKeydownRules$2, getKeyupRules$2, function () {\n    return Optional.some(focusIn$1);\n  });\n\n  var toCell = function (matrix, rowIndex, columnIndex) {\n    return Optional.from(matrix[rowIndex]).bind(function (row) {\n      return Optional.from(row[columnIndex]).map(function (cell) {\n        return {\n          rowIndex: rowIndex,\n          columnIndex: columnIndex,\n          cell: cell\n        };\n      });\n    });\n  };\n\n  var cycleHorizontal$1 = function (matrix, rowIndex, startCol, deltaCol) {\n    var row = matrix[rowIndex];\n    var colsInRow = row.length;\n    var newColIndex = cycleBy(startCol, deltaCol, 0, colsInRow - 1);\n    return toCell(matrix, rowIndex, newColIndex);\n  };\n\n  var cycleVertical$1 = function (matrix, colIndex, startRow, deltaRow) {\n    var nextRowIndex = cycleBy(startRow, deltaRow, 0, matrix.length - 1);\n    var colsInNextRow = matrix[nextRowIndex].length;\n    var nextColIndex = clamp(colIndex, 0, colsInNextRow - 1);\n    return toCell(matrix, nextRowIndex, nextColIndex);\n  };\n\n  var moveHorizontal = function (matrix, rowIndex, startCol, deltaCol) {\n    var row = matrix[rowIndex];\n    var colsInRow = row.length;\n    var newColIndex = clamp(startCol + deltaCol, 0, colsInRow - 1);\n    return toCell(matrix, rowIndex, newColIndex);\n  };\n\n  var moveVertical = function (matrix, colIndex, startRow, deltaRow) {\n    var nextRowIndex = clamp(startRow + deltaRow, 0, matrix.length - 1);\n    var colsInNextRow = matrix[nextRowIndex].length;\n    var nextColIndex = clamp(colIndex, 0, colsInNextRow - 1);\n    return toCell(matrix, nextRowIndex, nextColIndex);\n  };\n\n  var cycleRight$1 = function (matrix, startRow, startCol) {\n    return cycleHorizontal$1(matrix, startRow, startCol, +1);\n  };\n\n  var cycleLeft$1 = function (matrix, startRow, startCol) {\n    return cycleHorizontal$1(matrix, startRow, startCol, -1);\n  };\n\n  var cycleUp$1 = function (matrix, startRow, startCol) {\n    return cycleVertical$1(matrix, startCol, startRow, -1);\n  };\n\n  var cycleDown$1 = function (matrix, startRow, startCol) {\n    return cycleVertical$1(matrix, startCol, startRow, +1);\n  };\n\n  var moveLeft$2 = function (matrix, startRow, startCol) {\n    return moveHorizontal(matrix, startRow, startCol, -1);\n  };\n\n  var moveRight$2 = function (matrix, startRow, startCol) {\n    return moveHorizontal(matrix, startRow, startCol, +1);\n  };\n\n  var moveUp = function (matrix, startRow, startCol) {\n    return moveVertical(matrix, startCol, startRow, -1);\n  };\n\n  var moveDown = function (matrix, startRow, startCol) {\n    return moveVertical(matrix, startCol, startRow, +1);\n  };\n\n  var schema$7 = [strictObjOf('selectors', [strict$1('row'), strict$1('cell')]), defaulted$1('cycles', true), defaulted$1('previousSelector', Optional.none), defaulted$1('execute', defaultExecute)];\n\n  var focusIn$2 = function (component, matrixConfig, _state) {\n    var focused = matrixConfig.previousSelector(component).orThunk(function () {\n      var selectors = matrixConfig.selectors;\n      return descendant$1(component.element, selectors.cell);\n    });\n    focused.each(function (cell) {\n      matrixConfig.focusManager.set(component, cell);\n    });\n  };\n\n  var execute$4 = function (component, simulatedEvent, matrixConfig) {\n    return search(component.element).bind(function (focused) {\n      return matrixConfig.execute(component, simulatedEvent, focused);\n    });\n  };\n\n  var toMatrix = function (rows, matrixConfig) {\n    return map(rows, function (row) {\n      return descendants(row, matrixConfig.selectors.cell);\n    });\n  };\n\n  var doMove$2 = function (ifCycle, ifMove) {\n    return function (element, focused, matrixConfig) {\n      var move = matrixConfig.cycles ? ifCycle : ifMove;\n      return closest$3(focused, matrixConfig.selectors.row).bind(function (inRow) {\n        var cellsInRow = descendants(inRow, matrixConfig.selectors.cell);\n        return findIndex$1(cellsInRow, focused).bind(function (colIndex) {\n          var allRows = descendants(element, matrixConfig.selectors.row);\n          return findIndex$1(allRows, inRow).bind(function (rowIndex) {\n            var matrix = toMatrix(allRows, matrixConfig);\n            return move(matrix, rowIndex, colIndex).map(function (next) {\n              return next.cell;\n            });\n          });\n        });\n      });\n    };\n  };\n\n  var moveLeft$3 = doMove$2(cycleLeft$1, moveLeft$2);\n  var moveRight$3 = doMove$2(cycleRight$1, moveRight$2);\n  var moveNorth$1 = doMove$2(cycleUp$1, moveUp);\n  var moveSouth$1 = doMove$2(cycleDown$1, moveDown);\n  var getKeydownRules$3 = constant([rule(inSet(LEFT), west$2(moveLeft$3, moveRight$3)), rule(inSet(RIGHT), east$2(moveLeft$3, moveRight$3)), rule(inSet(UP), north$2(moveNorth$1)), rule(inSet(DOWN), south$2(moveSouth$1)), rule(inSet(SPACE.concat(ENTER)), execute$4)]);\n  var getKeyupRules$3 = constant([rule(inSet(SPACE), stopEventForFirefox)]);\n  var MatrixType = typical(schema$7, NoState.init, getKeydownRules$3, getKeyupRules$3, function () {\n    return Optional.some(focusIn$2);\n  });\n  var schema$8 = [strict$1('selector'), defaulted$1('execute', defaultExecute), defaulted$1('moveOnTab', false)];\n\n  var execute$5 = function (component, simulatedEvent, menuConfig) {\n    return menuConfig.focusManager.get(component).bind(function (focused) {\n      return menuConfig.execute(component, simulatedEvent, focused);\n    });\n  };\n\n  var focusIn$3 = function (component, menuConfig, _state) {\n    descendant$1(component.element, menuConfig.selector).each(function (first) {\n      menuConfig.focusManager.set(component, first);\n    });\n  };\n\n  var moveUp$1 = function (element, focused, info) {\n    return horizontal(element, info.selector, focused, -1);\n  };\n\n  var moveDown$1 = function (element, focused, info) {\n    return horizontal(element, info.selector, focused, +1);\n  };\n\n  var fireShiftTab = function (component, simulatedEvent, menuConfig, menuState) {\n    return menuConfig.moveOnTab ? move(moveUp$1)(component, simulatedEvent, menuConfig, menuState) : Optional.none();\n  };\n\n  var fireTab = function (component, simulatedEvent, menuConfig, menuState) {\n    return menuConfig.moveOnTab ? move(moveDown$1)(component, simulatedEvent, menuConfig, menuState) : Optional.none();\n  };\n\n  var getKeydownRules$4 = constant([rule(inSet(UP), move(moveUp$1)), rule(inSet(DOWN), move(moveDown$1)), rule(and([isShift, inSet(TAB)]), fireShiftTab), rule(and([isNotShift, inSet(TAB)]), fireTab), rule(inSet(ENTER), execute$5), rule(inSet(SPACE), execute$5)]);\n  var getKeyupRules$4 = constant([rule(inSet(SPACE), stopEventForFirefox)]);\n  var MenuType = typical(schema$8, NoState.init, getKeydownRules$4, getKeyupRules$4, function () {\n    return Optional.some(focusIn$3);\n  });\n  var schema$9 = [onKeyboardHandler('onSpace'), onKeyboardHandler('onEnter'), onKeyboardHandler('onShiftEnter'), onKeyboardHandler('onLeft'), onKeyboardHandler('onRight'), onKeyboardHandler('onTab'), onKeyboardHandler('onShiftTab'), onKeyboardHandler('onUp'), onKeyboardHandler('onDown'), onKeyboardHandler('onEscape'), defaulted$1('stopSpaceKeyup', false), option('focusIn')];\n\n  var getKeydownRules$5 = function (component, simulatedEvent, specialInfo) {\n    return [rule(inSet(SPACE), specialInfo.onSpace), rule(and([isNotShift, inSet(ENTER)]), specialInfo.onEnter), rule(and([isShift, inSet(ENTER)]), specialInfo.onShiftEnter), rule(and([isShift, inSet(TAB)]), specialInfo.onShiftTab), rule(and([isNotShift, inSet(TAB)]), specialInfo.onTab), rule(inSet(UP), specialInfo.onUp), rule(inSet(DOWN), specialInfo.onDown), rule(inSet(LEFT), specialInfo.onLeft), rule(inSet(RIGHT), specialInfo.onRight), rule(inSet(SPACE), specialInfo.onSpace), rule(inSet(ESCAPE), specialInfo.onEscape)];\n  };\n\n  var getKeyupRules$5 = function (component, simulatedEvent, specialInfo) {\n    return specialInfo.stopSpaceKeyup ? [rule(inSet(SPACE), stopEventForFirefox)] : [];\n  };\n\n  var SpecialType = typical(schema$9, NoState.init, getKeydownRules$5, getKeyupRules$5, function (specialInfo) {\n    return specialInfo.focusIn;\n  });\n  var acyclic = AcyclicType.schema();\n  var cyclic = CyclicType.schema();\n  var flow = FlowType.schema();\n  var flatgrid$1 = FlatgridType.schema();\n  var matrix = MatrixType.schema();\n  var execution = ExecutionType.schema();\n  var menu = MenuType.schema();\n  var special = SpecialType.schema();\n  var KeyboardBranches = /*#__PURE__*/Object.freeze({\n    __proto__: null,\n    acyclic: acyclic,\n    cyclic: cyclic,\n    flow: flow,\n    flatgrid: flatgrid$1,\n    matrix: matrix,\n    execution: execution,\n    menu: menu,\n    special: special\n  });\n\n  var isFlatgridState = function (keyState) {\n    return hasNonNullableKey(keyState, 'setGridSize');\n  };\n\n  var Keying = createModes$1({\n    branchKey: 'mode',\n    branches: KeyboardBranches,\n    name: 'keying',\n    active: {\n      events: function (keyingConfig, keyingState) {\n        var handler = keyingConfig.handler;\n        return handler.toEvents(keyingConfig, keyingState);\n      }\n    },\n    apis: {\n      focusIn: function (component, keyConfig, keyState) {\n        keyConfig.sendFocusIn(keyConfig).fold(function () {\n          component.getSystem().triggerFocus(component.element, component.element);\n        }, function (sendFocusIn) {\n          sendFocusIn(component, keyConfig, keyState);\n        });\n      },\n      setGridSize: function (component, keyConfig, keyState, numRows, numColumns) {\n        if (!isFlatgridState(keyState)) {\n          console.error('Layout does not support setGridSize');\n        } else {\n          keyState.setGridSize(numRows, numColumns);\n        }\n      }\n    },\n    state: KeyingState\n  });\n\n  var set$5 = function (component, replaceConfig, replaceState, data) {\n    preserve(function () {\n      var newChildren = map(data, component.getSystem().build);\n      replaceChildren(component, newChildren);\n    }, component.element);\n  };\n\n  var insert = function (component, replaceConfig, insertion, childSpec) {\n    var child = component.getSystem().build(childSpec);\n    attachWith(component, child, insertion);\n  };\n\n  var append$2 = function (component, replaceConfig, replaceState, appendee) {\n    insert(component, replaceConfig, append, appendee);\n  };\n\n  var prepend$1 = function (component, replaceConfig, replaceState, prependee) {\n    insert(component, replaceConfig, prepend, prependee);\n  };\n\n  var remove$7 = function (component, replaceConfig, replaceState, removee) {\n    var children = contents(component);\n    var foundChild = find(children, function (child) {\n      return eq$1(removee.element, child.element);\n    });\n    foundChild.each(detach);\n  };\n\n  var contents = function (component, _replaceConfig) {\n    return component.components();\n  };\n\n  var replaceAt = function (component, replaceConfig, replaceState, replaceeIndex, replacer) {\n    var children = contents(component);\n    return Optional.from(children[replaceeIndex]).map(function (replacee) {\n      remove$7(component, replaceConfig, replaceState, replacee);\n      replacer.each(function (r) {\n        insert(component, replaceConfig, function (p, c) {\n          appendAt(p, c, replaceeIndex);\n        }, r);\n      });\n      return replacee;\n    });\n  };\n\n  var replaceBy = function (component, replaceConfig, replaceState, replaceePred, replacer) {\n    var children = contents(component);\n    return findIndex(children, replaceePred).bind(function (replaceeIndex) {\n      return replaceAt(component, replaceConfig, replaceState, replaceeIndex, replacer);\n    });\n  };\n\n  var ReplaceApis = /*#__PURE__*/Object.freeze({\n    __proto__: null,\n    append: append$2,\n    prepend: prepend$1,\n    remove: remove$7,\n    replaceAt: replaceAt,\n    replaceBy: replaceBy,\n    set: set$5,\n    contents: contents\n  });\n  var Replacing = create$1({\n    fields: [],\n    name: 'replacing',\n    apis: ReplaceApis\n  });\n\n  var events$4 = function (name, eventHandlers) {\n    var events = derive(eventHandlers);\n    return create$1({\n      fields: [strict$1('enabled')],\n      name: name,\n      active: {\n        events: constant(events)\n      }\n    });\n  };\n\n  var config = function (name, eventHandlers) {\n    var me = events$4(name, eventHandlers);\n    return {\n      key: name,\n      value: {\n        config: {},\n        me: me,\n        configAsRaw: constant({}),\n        initialConfig: {},\n        state: NoState\n      }\n    };\n  };\n\n  var focus$2 = function (component, focusConfig) {\n    if (!focusConfig.ignore) {\n      focus$1(component.element);\n      focusConfig.onFocus(component);\n    }\n  };\n\n  var blur$1 = function (component, focusConfig) {\n    if (!focusConfig.ignore) {\n      blur(component.element);\n    }\n  };\n\n  var isFocused = function (component) {\n    return hasFocus(component.element);\n  };\n\n  var FocusApis = /*#__PURE__*/Object.freeze({\n    __proto__: null,\n    focus: focus$2,\n    blur: blur$1,\n    isFocused: isFocused\n  });\n\n  var exhibit$1 = function (base, focusConfig) {\n    var mod = focusConfig.ignore ? {} : {\n      attributes: {\n        tabindex: '-1'\n      }\n    };\n    return nu$6(mod);\n  };\n\n  var events$5 = function (focusConfig) {\n    return derive([run(focus(), function (component, simulatedEvent) {\n      focus$2(component, focusConfig);\n      simulatedEvent.stop();\n    })].concat(focusConfig.stopMousedown ? [run(mousedown(), function (_, simulatedEvent) {\n      simulatedEvent.event.prevent();\n    })] : []));\n  };\n\n  var ActiveFocus = /*#__PURE__*/Object.freeze({\n    __proto__: null,\n    exhibit: exhibit$1,\n    events: events$5\n  });\n  var FocusSchema = [onHandler('onFocus'), defaulted$1('stopMousedown', false), defaulted$1('ignore', false)];\n  var Focusing = create$1({\n    fields: FocusSchema,\n    name: 'focusing',\n    active: ActiveFocus,\n    apis: FocusApis\n  });\n\n  var SetupBehaviourCellState = function (initialState) {\n    var init = function () {\n      var cell = Cell(initialState);\n\n      var get = function () {\n        return cell.get();\n      };\n\n      var set = function (newState) {\n        return cell.set(newState);\n      };\n\n      var clear = function () {\n        return cell.set(initialState);\n      };\n\n      var readState = function () {\n        return cell.get();\n      };\n\n      return {\n        get: get,\n        set: set,\n        clear: clear,\n        readState: readState\n      };\n    };\n\n    return {\n      init: init\n    };\n  };\n\n  var updateAriaState = function (component, toggleConfig, toggleState) {\n    var ariaInfo = toggleConfig.aria;\n    ariaInfo.update(component, ariaInfo, toggleState.get());\n  };\n\n  var updateClass = function (component, toggleConfig, toggleState) {\n    toggleConfig.toggleClass.each(function (toggleClass) {\n      if (toggleState.get()) {\n        add$2(component.element, toggleClass);\n      } else {\n        remove$4(component.element, toggleClass);\n      }\n    });\n  };\n\n  var toggle = function (component, toggleConfig, toggleState) {\n    set$6(component, toggleConfig, toggleState, !toggleState.get());\n  };\n\n  var on$1 = function (component, toggleConfig, toggleState) {\n    toggleState.set(true);\n    updateClass(component, toggleConfig, toggleState);\n    updateAriaState(component, toggleConfig, toggleState);\n  };\n\n  var off = function (component, toggleConfig, toggleState) {\n    toggleState.set(false);\n    updateClass(component, toggleConfig, toggleState);\n    updateAriaState(component, toggleConfig, toggleState);\n  };\n\n  var set$6 = function (component, toggleConfig, toggleState, state) {\n    var action = state ? on$1 : off;\n    action(component, toggleConfig, toggleState);\n  };\n\n  var isOn = function (component, toggleConfig, toggleState) {\n    return toggleState.get();\n  };\n\n  var onLoad$4 = function (component, toggleConfig, toggleState) {\n    set$6(component, toggleConfig, toggleState, toggleConfig.selected);\n  };\n\n  var ToggleApis = /*#__PURE__*/Object.freeze({\n    __proto__: null,\n    onLoad: onLoad$4,\n    toggle: toggle,\n    isOn: isOn,\n    on: on$1,\n    off: off,\n    set: set$6\n  });\n\n  var exhibit$2 = function () {\n    return nu$6({});\n  };\n\n  var events$6 = function (toggleConfig, toggleState) {\n    var execute = executeEvent(toggleConfig, toggleState, toggle);\n    var load = loadEvent(toggleConfig, toggleState, onLoad$4);\n    return derive(flatten([toggleConfig.toggleOnExecute ? [execute] : [], [load]]));\n  };\n\n  var ActiveToggle = /*#__PURE__*/Object.freeze({\n    __proto__: null,\n    exhibit: exhibit$2,\n    events: events$6\n  });\n\n  var updatePressed = function (component, ariaInfo, status) {\n    set$1(component.element, 'aria-pressed', status);\n\n    if (ariaInfo.syncWithExpanded) {\n      updateExpanded(component, ariaInfo, status);\n    }\n  };\n\n  var updateSelected = function (component, ariaInfo, status) {\n    set$1(component.element, 'aria-selected', status);\n  };\n\n  var updateChecked = function (component, ariaInfo, status) {\n    set$1(component.element, 'aria-checked', status);\n  };\n\n  var updateExpanded = function (component, ariaInfo, status) {\n    set$1(component.element, 'aria-expanded', status);\n  };\n\n  var ToggleSchema = [defaulted$1('selected', false), option('toggleClass'), defaulted$1('toggleOnExecute', true), defaultedOf('aria', {\n    mode: 'none'\n  }, choose$1('mode', {\n    pressed: [defaulted$1('syncWithExpanded', false), output('update', updatePressed)],\n    checked: [output('update', updateChecked)],\n    expanded: [output('update', updateExpanded)],\n    selected: [output('update', updateSelected)],\n    none: [output('update', noop)]\n  }))];\n  var Toggling = create$1({\n    fields: ToggleSchema,\n    name: 'toggling',\n    active: ActiveToggle,\n    apis: ToggleApis,\n    state: SetupBehaviourCellState(false)\n  });\n\n  var pointerEvents = function () {\n    var onClick = function (component, simulatedEvent) {\n      simulatedEvent.stop();\n      emitExecute(component);\n    };\n\n    return [run(click(), onClick), run(tap(), onClick), cutter(touchstart()), cutter(mousedown())];\n  };\n\n  var events$7 = function (optAction) {\n    var executeHandler = function (action) {\n      return runOnExecute(function (component, simulatedEvent) {\n        action(component);\n        simulatedEvent.stop();\n      });\n    };\n\n    return derive(flatten([optAction.map(executeHandler).toArray(), pointerEvents()]));\n  };\n\n  var hoverEvent = 'alloy.item-hover';\n  var focusEvent = 'alloy.item-focus';\n\n  var onHover = function (item) {\n    if (search(item.element).isNone() || Focusing.isFocused(item)) {\n      if (!Focusing.isFocused(item)) {\n        Focusing.focus(item);\n      }\n\n      emitWith(item, hoverEvent, {\n        item: item\n      });\n    }\n  };\n\n  var onFocus = function (item) {\n    emitWith(item, focusEvent, {\n      item: item\n    });\n  };\n\n  var hover = constant(hoverEvent);\n  var focus$3 = constant(focusEvent);\n\n  var builder = function (detail) {\n    return {\n      dom: detail.dom,\n      domModification: __assign(__assign({}, detail.domModification), {\n        attributes: __assign(__assign(__assign({\n          'role': detail.toggling.isSome() ? 'menuitemcheckbox' : 'menuitem'\n        }, detail.domModification.attributes), {\n          'aria-haspopup': detail.hasSubmenu\n        }), detail.hasSubmenu ? {\n          'aria-expanded': false\n        } : {})\n      }),\n      behaviours: SketchBehaviours.augment(detail.itemBehaviours, [detail.toggling.fold(Toggling.revoke, function (tConfig) {\n        return Toggling.config(__assign({\n          aria: {\n            mode: 'checked'\n          }\n        }, tConfig));\n      }), Focusing.config({\n        ignore: detail.ignoreFocus,\n        stopMousedown: detail.ignoreFocus,\n        onFocus: function (component) {\n          onFocus(component);\n        }\n      }), Keying.config({\n        mode: 'execution'\n      }), Representing.config({\n        store: {\n          mode: 'memory',\n          initialValue: detail.data\n        }\n      }), config('item-type-events', __spreadArrays(pointerEvents(), [run(mouseover(), onHover), run(focusItem(), Focusing.focus)]))]),\n      components: detail.components,\n      eventOrder: detail.eventOrder\n    };\n  };\n\n  var schema$a = [strict$1('data'), strict$1('components'), strict$1('dom'), defaulted$1('hasSubmenu', false), option('toggling'), SketchBehaviours.field('itemBehaviours', [Toggling, Focusing, Keying, Representing]), defaulted$1('ignoreFocus', false), defaulted$1('domModification', {}), output('builder', builder), defaulted$1('eventOrder', {})];\n\n  var builder$1 = function (detail) {\n    return {\n      dom: detail.dom,\n      components: detail.components,\n      events: derive([stopper(focusItem())])\n    };\n  };\n\n  var schema$b = [strict$1('dom'), strict$1('components'), output('builder', builder$1)];\n  var owner$2 = constant('item-widget');\n  var parts = constant([required({\n    name: 'widget',\n    overrides: function (detail) {\n      return {\n        behaviours: derive$1([Representing.config({\n          store: {\n            mode: 'manual',\n            getValue: function (_component) {\n              return detail.data;\n            },\n            setValue: noop\n          }\n        })])\n      };\n    }\n  })]);\n\n  var builder$2 = function (detail) {\n    var subs = substitutes(owner$2(), detail, parts());\n    var components$1 = components(owner$2(), detail, subs.internals());\n\n    var focusWidget = function (component) {\n      return getPart(component, detail, 'widget').map(function (widget) {\n        Keying.focusIn(widget);\n        return widget;\n      });\n    };\n\n    var onHorizontalArrow = function (component, simulatedEvent) {\n      return inside(simulatedEvent.event.target) ? Optional.none() : function () {\n        if (detail.autofocus) {\n          simulatedEvent.setSource(component.element);\n          return Optional.none();\n        } else {\n          return Optional.none();\n        }\n      }();\n    };\n\n    return {\n      dom: detail.dom,\n      components: components$1,\n      domModification: detail.domModification,\n      events: derive([runOnExecute(function (component, simulatedEvent) {\n        focusWidget(component).each(function (_widget) {\n          simulatedEvent.stop();\n        });\n      }), run(mouseover(), onHover), run(focusItem(), function (component, _simulatedEvent) {\n        if (detail.autofocus) {\n          focusWidget(component);\n        } else {\n          Focusing.focus(component);\n        }\n      })]),\n      behaviours: SketchBehaviours.augment(detail.widgetBehaviours, [Representing.config({\n        store: {\n          mode: 'memory',\n          initialValue: detail.data\n        }\n      }), Focusing.config({\n        ignore: detail.ignoreFocus,\n        onFocus: function (component) {\n          onFocus(component);\n        }\n      }), Keying.config({\n        mode: 'special',\n        focusIn: detail.autofocus ? function (component) {\n          focusWidget(component);\n        } : revoke(),\n        onLeft: onHorizontalArrow,\n        onRight: onHorizontalArrow,\n        onEscape: function (component, simulatedEvent) {\n          if (!Focusing.isFocused(component) && !detail.autofocus) {\n            Focusing.focus(component);\n            return Optional.some(true);\n          } else if (detail.autofocus) {\n            simulatedEvent.setSource(component.element);\n            return Optional.none();\n          } else {\n            return Optional.none();\n          }\n        }\n      })])\n    };\n  };\n\n  var schema$c = [strict$1('uid'), strict$1('data'), strict$1('components'), strict$1('dom'), defaulted$1('autofocus', false), defaulted$1('ignoreFocus', false), SketchBehaviours.field('widgetBehaviours', [Representing, Focusing, Keying]), defaulted$1('domModification', {}), defaultUidsSchema(parts()), output('builder', builder$2)];\n  var itemSchema$1 = choose$1('type', {\n    widget: schema$c,\n    item: schema$a,\n    separator: schema$b\n  });\n\n  var configureGrid = function (detail, movementInfo) {\n    return {\n      mode: 'flatgrid',\n      selector: '.' + detail.markers.item,\n      initSize: {\n        numColumns: movementInfo.initSize.numColumns,\n        numRows: movementInfo.initSize.numRows\n      },\n      focusManager: detail.focusManager\n    };\n  };\n\n  var configureMatrix = function (detail, movementInfo) {\n    return {\n      mode: 'matrix',\n      selectors: {\n        row: movementInfo.rowSelector,\n        cell: '.' + detail.markers.item\n      },\n      focusManager: detail.focusManager\n    };\n  };\n\n  var configureMenu = function (detail, movementInfo) {\n    return {\n      mode: 'menu',\n      selector: '.' + detail.markers.item,\n      moveOnTab: movementInfo.moveOnTab,\n      focusManager: detail.focusManager\n    };\n  };\n\n  var parts$1 = constant([group({\n    factory: {\n      sketch: function (spec) {\n        var itemInfo = asRawOrDie('menu.spec item', itemSchema$1, spec);\n        return itemInfo.builder(itemInfo);\n      }\n    },\n    name: 'items',\n    unit: 'item',\n    defaults: function (detail, u) {\n      return u.hasOwnProperty('uid') ? u : __assign(__assign({}, u), {\n        uid: generate$2('item')\n      });\n    },\n    overrides: function (detail, u) {\n      return {\n        type: u.type,\n        ignoreFocus: detail.fakeFocus,\n        domModification: {\n          classes: [detail.markers.item]\n        }\n      };\n    }\n  })]);\n  var schema$d = constant([strict$1('value'), strict$1('items'), strict$1('dom'), strict$1('components'), defaulted$1('eventOrder', {}), field$1('menuBehaviours', [Highlighting, Representing, Composing, Keying]), defaultedOf('movement', {\n    mode: 'menu',\n    moveOnTab: true\n  }, choose$1('mode', {\n    grid: [initSize(), output('config', configureGrid)],\n    matrix: [output('config', configureMatrix), strict$1('rowSelector')],\n    menu: [defaulted$1('moveOnTab', true), output('config', configureMenu)]\n  })), itemMarkers(), defaulted$1('fakeFocus', false), defaulted$1('focusManager', dom()), onHandler('onHighlight')]);\n  var focus$4 = constant('alloy.menu-focus');\n\n  var make$1 = function (detail, components, _spec, _externals) {\n    return {\n      uid: detail.uid,\n      dom: detail.dom,\n      markers: detail.markers,\n      behaviours: augment(detail.menuBehaviours, [Highlighting.config({\n        highlightClass: detail.markers.selectedItem,\n        itemClass: detail.markers.item,\n        onHighlight: detail.onHighlight\n      }), Representing.config({\n        store: {\n          mode: 'memory',\n          initialValue: detail.value\n        }\n      }), Composing.config({\n        find: Optional.some\n      }), Keying.config(detail.movement.config(detail, detail.movement))]),\n      events: derive([run(focus$3(), function (menu, simulatedEvent) {\n        var event = simulatedEvent.event;\n        menu.getSystem().getByDom(event.target).each(function (item) {\n          Highlighting.highlight(menu, item);\n          simulatedEvent.stop();\n          emitWith(menu, focus$4(), {\n            menu: menu,\n            item: item\n          });\n        });\n      }), run(hover(), function (menu, simulatedEvent) {\n        var item = simulatedEvent.event.item;\n        Highlighting.highlight(menu, item);\n      })]),\n      components: components,\n      eventOrder: detail.eventOrder,\n      domModification: {\n        attributes: {\n          role: 'menu'\n        }\n      }\n    };\n  };\n\n  var Menu = composite$1({\n    name: 'Menu',\n    configFields: schema$d(),\n    partFields: parts$1(),\n    factory: make$1\n  });\n\n  var transpose = function (obj) {\n    return tupleMap(obj, function (v, k) {\n      return {\n        k: v,\n        v: k\n      };\n    });\n  };\n\n  var trace = function (items, byItem, byMenu, finish) {\n    return get$1(byMenu, finish).bind(function (triggerItem) {\n      return get$1(items, triggerItem).bind(function (triggerMenu) {\n        var rest = trace(items, byItem, byMenu, triggerMenu);\n        return Optional.some([triggerMenu].concat(rest));\n      });\n    }).getOr([]);\n  };\n\n  var generate$5 = function (menus, expansions) {\n    var items = {};\n    each$1(menus, function (menuItems, menu) {\n      each(menuItems, function (item) {\n        items[item] = menu;\n      });\n    });\n    var byItem = expansions;\n    var byMenu = transpose(expansions);\n    var menuPaths = map$2(byMenu, function (_triggerItem, submenu) {\n      return [submenu].concat(trace(items, byItem, byMenu, submenu));\n    });\n    return map$2(items, function (menu) {\n      return get$1(menuPaths, menu).getOr([menu]);\n    });\n  };\n\n  var init$3 = function () {\n    var expansions = Cell({});\n    var menus = Cell({});\n    var paths = Cell({});\n    var primary = Cell(Optional.none());\n    var directory = Cell({});\n\n    var clear = function () {\n      expansions.set({});\n      menus.set({});\n      paths.set({});\n      primary.set(Optional.none());\n    };\n\n    var isClear = function () {\n      return primary.get().isNone();\n    };\n\n    var setMenuBuilt = function (menuName, built) {\n      var _a;\n\n      menus.set(__assign(__assign({}, menus.get()), (_a = {}, _a[menuName] = {\n        type: 'prepared',\n        menu: built\n      }, _a)));\n    };\n\n    var setContents = function (sPrimary, sMenus, sExpansions, dir) {\n      primary.set(Optional.some(sPrimary));\n      expansions.set(sExpansions);\n      menus.set(sMenus);\n      directory.set(dir);\n      var sPaths = generate$5(dir, sExpansions);\n      paths.set(sPaths);\n    };\n\n    var getTriggeringItem = function (menuValue) {\n      return find$1(expansions.get(), function (v, _k) {\n        return v === menuValue;\n      });\n    };\n\n    var getTriggerData = function (menuValue, getItemByValue, path) {\n      return getPreparedMenu(menuValue).bind(function (menu) {\n        return getTriggeringItem(menuValue).bind(function (triggeringItemValue) {\n          return getItemByValue(triggeringItemValue).map(function (triggeredItem) {\n            return {\n              triggeredMenu: menu,\n              triggeringItem: triggeredItem,\n              triggeringPath: path\n            };\n          });\n        });\n      });\n    };\n\n    var getTriggeringPath = function (itemValue, getItemByValue) {\n      var extraPath = filter(lookupItem(itemValue).toArray(), function (menuValue) {\n        return getPreparedMenu(menuValue).isSome();\n      });\n      return get$1(paths.get(), itemValue).bind(function (path) {\n        var revPath = reverse(extraPath.concat(path));\n        var triggers = bind(revPath, function (menuValue, menuIndex) {\n          return getTriggerData(menuValue, getItemByValue, revPath.slice(0, menuIndex + 1)).fold(function () {\n            return primary.get().is(menuValue) ? [] : [Optional.none()];\n          }, function (data) {\n            return [Optional.some(data)];\n          });\n        });\n        return sequence(triggers);\n      });\n    };\n\n    var expand = function (itemValue) {\n      return get$1(expansions.get(), itemValue).map(function (menu) {\n        var current = get$1(paths.get(), itemValue).getOr([]);\n        return [menu].concat(current);\n      });\n    };\n\n    var collapse = function (itemValue) {\n      return get$1(paths.get(), itemValue).bind(function (path) {\n        return path.length > 1 ? Optional.some(path.slice(1)) : Optional.none();\n      });\n    };\n\n    var refresh = function (itemValue) {\n      return get$1(paths.get(), itemValue);\n    };\n\n    var getPreparedMenu = function (menuValue) {\n      return lookupMenu(menuValue).bind(extractPreparedMenu);\n    };\n\n    var lookupMenu = function (menuValue) {\n      return get$1(menus.get(), menuValue);\n    };\n\n    var lookupItem = function (itemValue) {\n      return get$1(expansions.get(), itemValue);\n    };\n\n    var otherMenus = function (path) {\n      var menuValues = directory.get();\n      return difference(keys(menuValues), path);\n    };\n\n    var getPrimary = function () {\n      return primary.get().bind(getPreparedMenu);\n    };\n\n    var getMenus = function () {\n      return menus.get();\n    };\n\n    return {\n      setMenuBuilt: setMenuBuilt,\n      setContents: setContents,\n      expand: expand,\n      refresh: refresh,\n      collapse: collapse,\n      lookupMenu: lookupMenu,\n      lookupItem: lookupItem,\n      otherMenus: otherMenus,\n      getPrimary: getPrimary,\n      getMenus: getMenus,\n      clear: clear,\n      isClear: isClear,\n      getTriggeringPath: getTriggeringPath\n    };\n  };\n\n  var extractPreparedMenu = function (prep) {\n    return prep.type === 'prepared' ? Optional.some(prep.menu) : Optional.none();\n  };\n\n  var LayeredState = {\n    init: init$3,\n    extractPreparedMenu: extractPreparedMenu\n  };\n\n  var make$2 = function (detail, _rawUiSpec) {\n    var submenuParentItems = Cell(Optional.none());\n\n    var buildMenus = function (container, primaryName, menus) {\n      return map$2(menus, function (spec, name) {\n        var makeSketch = function () {\n          return Menu.sketch(__assign(__assign({}, spec), {\n            value: name,\n            markers: detail.markers,\n            fakeFocus: detail.fakeFocus,\n            onHighlight: detail.onHighlight,\n            focusManager: detail.fakeFocus ? highlights() : dom()\n          }));\n        };\n\n        return name === primaryName ? {\n          type: 'prepared',\n          menu: container.getSystem().build(makeSketch())\n        } : {\n          type: 'notbuilt',\n          nbMenu: makeSketch\n        };\n      });\n    };\n\n    var layeredState = LayeredState.init();\n\n    var setup = function (container) {\n      var componentMap = buildMenus(container, detail.data.primary, detail.data.menus);\n      var directory = toDirectory();\n      layeredState.setContents(detail.data.primary, componentMap, detail.data.expansions, directory);\n      return layeredState.getPrimary();\n    };\n\n    var getItemValue = function (item) {\n      return Representing.getValue(item).value;\n    };\n\n    var getItemByValue = function (_container, menus, itemValue) {\n      return findMap(menus, function (menu) {\n        if (!menu.getSystem().isConnected()) {\n          return Optional.none();\n        }\n\n        var candidates = Highlighting.getCandidates(menu);\n        return find(candidates, function (c) {\n          return getItemValue(c) === itemValue;\n        });\n      });\n    };\n\n    var toDirectory = function (_container) {\n      return map$2(detail.data.menus, function (data, _menuName) {\n        return bind(data.items, function (item) {\n          return item.type === 'separator' ? [] : [item.data.value];\n        });\n      });\n    };\n\n    var setActiveMenu = function (container, menu) {\n      Highlighting.highlight(container, menu);\n      Highlighting.getHighlighted(menu).orThunk(function () {\n        return Highlighting.getFirst(menu);\n      }).each(function (item) {\n        dispatch(container, item.element, focusItem());\n      });\n    };\n\n    var getMenus = function (state, menuValues) {\n      return cat(map(menuValues, function (mv) {\n        return state.lookupMenu(mv).bind(function (prep) {\n          return prep.type === 'prepared' ? Optional.some(prep.menu) : Optional.none();\n        });\n      }));\n    };\n\n    var closeOthers = function (container, state, path) {\n      var others = getMenus(state, state.otherMenus(path));\n      each(others, function (o) {\n        remove$5(o.element, [detail.markers.backgroundMenu]);\n\n        if (!detail.stayInDom) {\n          Replacing.remove(container, o);\n        }\n      });\n    };\n\n    var getSubmenuParents = function (container) {\n      return submenuParentItems.get().getOrThunk(function () {\n        var r = {};\n        var items = descendants(container.element, '.' + detail.markers.item);\n        var parentItems = filter(items, function (i) {\n          return get$3(i, 'aria-haspopup') === 'true';\n        });\n        each(parentItems, function (i) {\n          container.getSystem().getByDom(i).each(function (itemComp) {\n            var key = getItemValue(itemComp);\n            r[key] = itemComp;\n          });\n        });\n        submenuParentItems.set(Optional.some(r));\n        return r;\n      });\n    };\n\n    var updateAriaExpansions = function (container, path) {\n      var parentItems = getSubmenuParents(container);\n      each$1(parentItems, function (v, k) {\n        var expanded = contains(path, k);\n        set$1(v.element, 'aria-expanded', expanded);\n      });\n    };\n\n    var updateMenuPath = function (container, state, path) {\n      return Optional.from(path[0]).bind(function (latestMenuName) {\n        return state.lookupMenu(latestMenuName).bind(function (menuPrep) {\n          if (menuPrep.type === 'notbuilt') {\n            return Optional.none();\n          } else {\n            var activeMenu = menuPrep.menu;\n            var rest = getMenus(state, path.slice(1));\n            each(rest, function (r) {\n              add$2(r.element, detail.markers.backgroundMenu);\n            });\n\n            if (!inBody(activeMenu.element)) {\n              Replacing.append(container, premade$1(activeMenu));\n            }\n\n            remove$5(activeMenu.element, [detail.markers.backgroundMenu]);\n            setActiveMenu(container, activeMenu);\n            closeOthers(container, state, path);\n            return Optional.some(activeMenu);\n          }\n        });\n      });\n    };\n\n    var ExpandHighlightDecision;\n\n    (function (ExpandHighlightDecision) {\n      ExpandHighlightDecision[ExpandHighlightDecision['HighlightSubmenu'] = 0] = 'HighlightSubmenu';\n      ExpandHighlightDecision[ExpandHighlightDecision['HighlightParent'] = 1] = 'HighlightParent';\n    })(ExpandHighlightDecision || (ExpandHighlightDecision = {}));\n\n    var buildIfRequired = function (container, menuName, menuPrep) {\n      if (menuPrep.type === 'notbuilt') {\n        var menu = container.getSystem().build(menuPrep.nbMenu());\n        layeredState.setMenuBuilt(menuName, menu);\n        return menu;\n      } else {\n        return menuPrep.menu;\n      }\n    };\n\n    var expandRight = function (container, item, decision) {\n      if (decision === void 0) {\n        decision = ExpandHighlightDecision.HighlightSubmenu;\n      }\n\n      var value = getItemValue(item);\n      return layeredState.expand(value).bind(function (path) {\n        updateAriaExpansions(container, path);\n        return Optional.from(path[0]).bind(function (menuName) {\n          return layeredState.lookupMenu(menuName).bind(function (activeMenuPrep) {\n            var activeMenu = buildIfRequired(container, menuName, activeMenuPrep);\n\n            if (!inBody(activeMenu.element)) {\n              Replacing.append(container, premade$1(activeMenu));\n            }\n\n            detail.onOpenSubmenu(container, item, activeMenu, reverse(path));\n\n            if (decision === ExpandHighlightDecision.HighlightSubmenu) {\n              Highlighting.highlightFirst(activeMenu);\n              return updateMenuPath(container, layeredState, path);\n            } else {\n              Highlighting.dehighlightAll(activeMenu);\n              return Optional.some(item);\n            }\n          });\n        });\n      });\n    };\n\n    var collapseLeft = function (container, item) {\n      var value = getItemValue(item);\n      return layeredState.collapse(value).bind(function (path) {\n        updateAriaExpansions(container, path);\n        return updateMenuPath(container, layeredState, path).map(function (activeMenu) {\n          detail.onCollapseMenu(container, item, activeMenu);\n          return activeMenu;\n        });\n      });\n    };\n\n    var updateView = function (container, item) {\n      var value = getItemValue(item);\n      return layeredState.refresh(value).bind(function (path) {\n        updateAriaExpansions(container, path);\n        return updateMenuPath(container, layeredState, path);\n      });\n    };\n\n    var onRight = function (container, item) {\n      return inside(item.element) ? Optional.none() : expandRight(container, item, ExpandHighlightDecision.HighlightSubmenu);\n    };\n\n    var onLeft = function (container, item) {\n      return inside(item.element) ? Optional.none() : collapseLeft(container, item);\n    };\n\n    var onEscape = function (container, item) {\n      return collapseLeft(container, item).orThunk(function () {\n        return detail.onEscape(container, item).map(function () {\n          return container;\n        });\n      });\n    };\n\n    var keyOnItem = function (f) {\n      return function (container, simulatedEvent) {\n        return closest$3(simulatedEvent.getSource(), '.' + detail.markers.item).bind(function (target) {\n          return container.getSystem().getByDom(target).toOptional().bind(function (item) {\n            return f(container, item).map(always);\n          });\n        });\n      };\n    };\n\n    var events = derive([run(focus$4(), function (sandbox, simulatedEvent) {\n      var item = simulatedEvent.event.item;\n      layeredState.lookupItem(getItemValue(item)).each(function () {\n        var menu = simulatedEvent.event.menu;\n        Highlighting.highlight(sandbox, menu);\n        var value = getItemValue(simulatedEvent.event.item);\n        layeredState.refresh(value).each(function (path) {\n          return closeOthers(sandbox, layeredState, path);\n        });\n      });\n    }), runOnExecute(function (component, simulatedEvent) {\n      var target = simulatedEvent.event.target;\n      component.getSystem().getByDom(target).each(function (item) {\n        var itemValue = getItemValue(item);\n\n        if (itemValue.indexOf('collapse-item') === 0) {\n          collapseLeft(component, item);\n        }\n\n        expandRight(component, item, ExpandHighlightDecision.HighlightSubmenu).fold(function () {\n          detail.onExecute(component, item);\n        }, noop);\n      });\n    }), runOnAttached(function (container, _simulatedEvent) {\n      setup(container).each(function (primary) {\n        Replacing.append(container, premade$1(primary));\n        detail.onOpenMenu(container, primary);\n\n        if (detail.highlightImmediately) {\n          setActiveMenu(container, primary);\n        }\n      });\n    })].concat(detail.navigateOnHover ? [run(hover(), function (sandbox, simulatedEvent) {\n      var item = simulatedEvent.event.item;\n      updateView(sandbox, item);\n      expandRight(sandbox, item, ExpandHighlightDecision.HighlightParent);\n      detail.onHover(sandbox, item);\n    })] : []));\n\n    var getActiveItem = function (container) {\n      return Highlighting.getHighlighted(container).bind(Highlighting.getHighlighted);\n    };\n\n    var collapseMenuApi = function (container) {\n      getActiveItem(container).each(function (currentItem) {\n        collapseLeft(container, currentItem);\n      });\n    };\n\n    var highlightPrimary = function (container) {\n      layeredState.getPrimary().each(function (primary) {\n        setActiveMenu(container, primary);\n      });\n    };\n\n    var extractMenuFromContainer = function (container) {\n      return Optional.from(container.components()[0]).filter(function (comp) {\n        return get$3(comp.element, 'role') === 'menu';\n      });\n    };\n\n    var repositionMenus = function (container) {\n      var maybeActivePrimary = layeredState.getPrimary().bind(function (primary) {\n        return getActiveItem(container).bind(function (currentItem) {\n          var itemValue = getItemValue(currentItem);\n          var allMenus = values(layeredState.getMenus());\n          var preparedMenus = cat(map(allMenus, LayeredState.extractPreparedMenu));\n          return layeredState.getTriggeringPath(itemValue, function (v) {\n            return getItemByValue(container, preparedMenus, v);\n          });\n        }).map(function (triggeringPath) {\n          return {\n            primary: primary,\n            triggeringPath: triggeringPath\n          };\n        });\n      });\n      maybeActivePrimary.fold(function () {\n        extractMenuFromContainer(container).each(function (primaryMenu) {\n          detail.onRepositionMenu(container, primaryMenu, []);\n        });\n      }, function (_a) {\n        var primary = _a.primary,\n            triggeringPath = _a.triggeringPath;\n        detail.onRepositionMenu(container, primary, triggeringPath);\n      });\n    };\n\n    var apis = {\n      collapseMenu: collapseMenuApi,\n      highlightPrimary: highlightPrimary,\n      repositionMenus: repositionMenus\n    };\n    return {\n      uid: detail.uid,\n      dom: detail.dom,\n      markers: detail.markers,\n      behaviours: augment(detail.tmenuBehaviours, [Keying.config({\n        mode: 'special',\n        onRight: keyOnItem(onRight),\n        onLeft: keyOnItem(onLeft),\n        onEscape: keyOnItem(onEscape),\n        focusIn: function (container, _keyInfo) {\n          layeredState.getPrimary().each(function (primary) {\n            dispatch(container, primary.element, focusItem());\n          });\n        }\n      }), Highlighting.config({\n        highlightClass: detail.markers.selectedMenu,\n        itemClass: detail.markers.menu\n      }), Composing.config({\n        find: function (container) {\n          return Highlighting.getHighlighted(container);\n        }\n      }), Replacing.config({})]),\n      eventOrder: detail.eventOrder,\n      apis: apis,\n      events: events\n    };\n  };\n\n  var collapseItem = constant('collapse-item');\n\n  var tieredData = function (primary, menus, expansions) {\n    return {\n      primary: primary,\n      menus: menus,\n      expansions: expansions\n    };\n  };\n\n  var singleData = function (name, menu) {\n    return {\n      primary: name,\n      menus: wrap$1(name, menu),\n      expansions: {}\n    };\n  };\n\n  var collapseItem$1 = function (text) {\n    return {\n      value: generate$1(collapseItem()),\n      meta: {\n        text: text\n      }\n    };\n  };\n\n  var tieredMenu = single$2({\n    name: 'TieredMenu',\n    configFields: [onStrictKeyboardHandler('onExecute'), onStrictKeyboardHandler('onEscape'), onStrictHandler('onOpenMenu'), onStrictHandler('onOpenSubmenu'), onHandler('onRepositionMenu'), onHandler('onCollapseMenu'), defaulted$1('highlightImmediately', true), strictObjOf('data', [strict$1('primary'), strict$1('menus'), strict$1('expansions')]), defaulted$1('fakeFocus', false), onHandler('onHighlight'), onHandler('onHover'), tieredMenuMarkers(), strict$1('dom'), defaulted$1('navigateOnHover', true), defaulted$1('stayInDom', false), field$1('tmenuBehaviours', [Keying, Highlighting, Composing, Replacing]), defaulted$1('eventOrder', {})],\n    apis: {\n      collapseMenu: function (apis, tmenu) {\n        apis.collapseMenu(tmenu);\n      },\n      highlightPrimary: function (apis, tmenu) {\n        apis.highlightPrimary(tmenu);\n      },\n      repositionMenus: function (apis, tmenu) {\n        apis.repositionMenus(tmenu);\n      }\n    },\n    factory: make$2,\n    extraApis: {\n      tieredData: tieredData,\n      singleData: singleData,\n      collapseItem: collapseItem$1\n    }\n  });\n\n  var makeMenu = function (detail, menuSandbox, anchor, menuSpec, getBounds) {\n    var lazySink = function () {\n      return detail.lazySink(menuSandbox);\n    };\n\n    var layouts = menuSpec.type === 'horizontal' ? {\n      layouts: {\n        onLtr: function () {\n          return belowOrAbove();\n        },\n        onRtl: function () {\n          return belowOrAboveRtl();\n        }\n      }\n    } : {};\n\n    var isFirstTierSubmenu = function (triggeringPaths) {\n      return triggeringPaths.length === 2;\n    };\n\n    var getSubmenuLayouts = function (triggeringPaths) {\n      return isFirstTierSubmenu(triggeringPaths) ? layouts : {};\n    };\n\n    return tieredMenu.sketch({\n      dom: {\n        tag: 'div'\n      },\n      data: menuSpec.data,\n      markers: menuSpec.menu.markers,\n      highlightImmediately: menuSpec.menu.highlightImmediately,\n      onEscape: function () {\n        Sandboxing.close(menuSandbox);\n        detail.onEscape.map(function (handler) {\n          return handler(menuSandbox);\n        });\n        return Optional.some(true);\n      },\n      onExecute: function () {\n        return Optional.some(true);\n      },\n      onOpenMenu: function (tmenu, menu) {\n        Positioning.positionWithinBounds(lazySink().getOrDie(), anchor, menu, getBounds());\n      },\n      onOpenSubmenu: function (tmenu, item, submenu, triggeringPaths) {\n        var sink = lazySink().getOrDie();\n        Positioning.position(sink, __assign({\n          anchor: 'submenu',\n          item: item\n        }, getSubmenuLayouts(triggeringPaths)), submenu);\n      },\n      onRepositionMenu: function (tmenu, primaryMenu, submenuTriggers) {\n        var sink = lazySink().getOrDie();\n        Positioning.positionWithinBounds(sink, anchor, primaryMenu, getBounds());\n        each(submenuTriggers, function (st) {\n          var submenuLayouts = getSubmenuLayouts(st.triggeringPath);\n          Positioning.position(sink, __assign({\n            anchor: 'submenu',\n            item: st.triggeringItem\n          }, submenuLayouts), st.triggeredMenu);\n        });\n      }\n    });\n  };\n\n  var factory = function (detail, spec) {\n    var isPartOfRelated = function (sandbox, queryElem) {\n      var related = detail.getRelated(sandbox);\n      return related.exists(function (rel) {\n        return isPartOf(rel, queryElem);\n      });\n    };\n\n    var setContent = function (sandbox, thing) {\n      Sandboxing.setContent(sandbox, thing);\n    };\n\n    var showAt = function (sandbox, anchor, thing) {\n      showWithin(sandbox, anchor, thing, Optional.none());\n    };\n\n    var showWithin = function (sandbox, anchor, thing, boxElement) {\n      showWithinBounds(sandbox, anchor, thing, function () {\n        return boxElement.map(function (elem) {\n          return box(elem);\n        });\n      });\n    };\n\n    var showWithinBounds = function (sandbox, anchor, thing, getBounds) {\n      var sink = detail.lazySink(sandbox).getOrDie();\n      Sandboxing.openWhileCloaked(sandbox, thing, function () {\n        return Positioning.positionWithinBounds(sink, anchor, sandbox, getBounds());\n      });\n      Representing.setValue(sandbox, Optional.some({\n        mode: 'position',\n        anchor: anchor,\n        getBounds: getBounds\n      }));\n    };\n\n    var showMenuAt = function (sandbox, anchor, menuSpec) {\n      showMenuWithinBounds(sandbox, anchor, menuSpec, function () {\n        return Optional.none();\n      });\n    };\n\n    var showMenuWithinBounds = function (sandbox, anchor, menuSpec, getBounds) {\n      var menu = makeMenu(detail, sandbox, anchor, menuSpec, getBounds);\n      Sandboxing.open(sandbox, menu);\n      Representing.setValue(sandbox, Optional.some({\n        mode: 'menu',\n        menu: menu\n      }));\n    };\n\n    var hide = function (sandbox) {\n      if (Sandboxing.isOpen(sandbox)) {\n        Representing.setValue(sandbox, Optional.none());\n        Sandboxing.close(sandbox);\n      }\n    };\n\n    var getContent = function (sandbox) {\n      return Sandboxing.getState(sandbox);\n    };\n\n    var reposition = function (sandbox) {\n      if (Sandboxing.isOpen(sandbox)) {\n        Representing.getValue(sandbox).each(function (state) {\n          switch (state.mode) {\n            case 'menu':\n              Sandboxing.getState(sandbox).each(function (tmenu) {\n                tieredMenu.repositionMenus(tmenu);\n              });\n              break;\n\n            case 'position':\n              var sink = detail.lazySink(sandbox).getOrDie();\n              Positioning.positionWithinBounds(sink, state.anchor, sandbox, state.getBounds());\n              break;\n          }\n        });\n      }\n    };\n\n    var apis = {\n      setContent: setContent,\n      showAt: showAt,\n      showWithin: showWithin,\n      showWithinBounds: showWithinBounds,\n      showMenuAt: showMenuAt,\n      showMenuWithinBounds: showMenuWithinBounds,\n      hide: hide,\n      getContent: getContent,\n      reposition: reposition,\n      isOpen: Sandboxing.isOpen\n    };\n    return {\n      uid: detail.uid,\n      dom: detail.dom,\n      behaviours: augment(detail.inlineBehaviours, [Sandboxing.config({\n        isPartOf: function (sandbox, data, queryElem) {\n          return isPartOf(data, queryElem) || isPartOfRelated(sandbox, queryElem);\n        },\n        getAttachPoint: function (sandbox) {\n          return detail.lazySink(sandbox).getOrDie();\n        },\n        onOpen: function (sandbox) {\n          detail.onShow(sandbox);\n        },\n        onClose: function (sandbox) {\n          detail.onHide(sandbox);\n        }\n      }), Representing.config({\n        store: {\n          mode: 'memory',\n          initialValue: Optional.none()\n        }\n      }), Receiving.config({\n        channels: __assign(__assign({}, receivingChannel(__assign({\n          isExtraPart: spec.isExtraPart\n        }, detail.fireDismissalEventInstead.map(function (fe) {\n          return {\n            fireEventInstead: {\n              event: fe.event\n            }\n          };\n        }).getOr({})))), receivingChannel$1(__assign(__assign({}, detail.fireRepositionEventInstead.map(function (fe) {\n          return {\n            fireEventInstead: {\n              event: fe.event\n            }\n          };\n        }).getOr({})), {\n          doReposition: reposition\n        })))\n      })]),\n      eventOrder: detail.eventOrder,\n      apis: apis\n    };\n  };\n\n  var InlineView = single$2({\n    name: 'InlineView',\n    configFields: [strict$1('lazySink'), onHandler('onShow'), onHandler('onHide'), optionFunction('onEscape'), field$1('inlineBehaviours', [Sandboxing, Representing, Receiving]), optionObjOf('fireDismissalEventInstead', [defaulted$1('event', dismissRequested())]), optionObjOf('fireRepositionEventInstead', [defaulted$1('event', repositionRequested())]), defaulted$1('getRelated', Optional.none), defaulted$1('isExtraPart', never), defaulted$1('eventOrder', Optional.none)],\n    factory: factory,\n    apis: {\n      showAt: function (apis, component, anchor, thing) {\n        apis.showAt(component, anchor, thing);\n      },\n      showWithin: function (apis, component, anchor, thing, boxElement) {\n        apis.showWithin(component, anchor, thing, boxElement);\n      },\n      showWithinBounds: function (apis, component, anchor, thing, bounds) {\n        apis.showWithinBounds(component, anchor, thing, bounds);\n      },\n      showMenuAt: function (apis, component, anchor, menuSpec) {\n        apis.showMenuAt(component, anchor, menuSpec);\n      },\n      showMenuWithinBounds: function (apis, component, anchor, menuSpec, bounds) {\n        apis.showMenuWithinBounds(component, anchor, menuSpec, bounds);\n      },\n      hide: function (apis, component) {\n        apis.hide(component);\n      },\n      isOpen: function (apis, component) {\n        return apis.isOpen(component);\n      },\n      getContent: function (apis, component) {\n        return apis.getContent(component);\n      },\n      setContent: function (apis, component, thing) {\n        apis.setContent(component, thing);\n      },\n      reposition: function (apis, component) {\n        apis.reposition(component);\n      }\n    }\n  });\n\n  var westEdgeX$1 = function (anchor) {\n    return anchor.x;\n  };\n\n  var middleX$1 = function (anchor, element) {\n    return anchor.x + anchor.width / 2 - element.width / 2;\n  };\n\n  var eastEdgeX$1 = function (anchor, element) {\n    return anchor.x + anchor.width - element.width;\n  };\n\n  var northY$2 = function (anchor) {\n    return anchor.y;\n  };\n\n  var southY$2 = function (anchor, element) {\n    return anchor.y + anchor.height - element.height;\n  };\n\n  var southeast$3 = function (anchor, element, bubbles) {\n    return nu$7(eastEdgeX$1(anchor, element), southY$2(anchor, element), bubbles.innerSoutheast(), northwest(), boundsRestriction(anchor, {\n      right: 0,\n      bottom: 3\n    }), 'layout-inner-se');\n  };\n\n  var southwest$3 = function (anchor, element, bubbles) {\n    return nu$7(westEdgeX$1(anchor), southY$2(anchor, element), bubbles.innerSouthwest(), northeast(), boundsRestriction(anchor, {\n      left: 1,\n      bottom: 3\n    }), 'layout-inner-sw');\n  };\n\n  var northeast$3 = function (anchor, element, bubbles) {\n    return nu$7(eastEdgeX$1(anchor, element), northY$2(anchor), bubbles.innerNortheast(), southwest(), boundsRestriction(anchor, {\n      right: 0,\n      top: 2\n    }), 'layout-inner-ne');\n  };\n\n  var northwest$3 = function (anchor, element, bubbles) {\n    return nu$7(westEdgeX$1(anchor), northY$2(anchor), bubbles.innerNorthwest(), southeast(), boundsRestriction(anchor, {\n      left: 1,\n      top: 2\n    }), 'layout-inner-nw');\n  };\n\n  var north$3 = function (anchor, element, bubbles) {\n    return nu$7(middleX$1(anchor, element), northY$2(anchor), bubbles.innerNorth(), south(), boundsRestriction(anchor, {\n      top: 2\n    }), 'layout-inner-n');\n  };\n\n  var south$3 = function (anchor, element, bubbles) {\n    return nu$7(middleX$1(anchor, element), southY$2(anchor, element), bubbles.innerSouth(), north(), boundsRestriction(anchor, {\n      bottom: 3\n    }), 'layout-inner-s');\n  };\n\n  var global$2 = tinymce.util.Tools.resolve('tinymce.util.Delay');\n\n  var factory$1 = function (detail) {\n    var events = events$7(detail.action);\n    var tag = detail.dom.tag;\n\n    var lookupAttr = function (attr) {\n      return get$1(detail.dom, 'attributes').bind(function (attrs) {\n        return get$1(attrs, attr);\n      });\n    };\n\n    var getModAttributes = function () {\n      if (tag === 'button') {\n        var type = lookupAttr('type').getOr('button');\n        var roleAttrs = lookupAttr('role').map(function (role) {\n          return {\n            role: role\n          };\n        }).getOr({});\n        return __assign({\n          type: type\n        }, roleAttrs);\n      } else {\n        var role = lookupAttr('role').getOr('button');\n        return {\n          role: role\n        };\n      }\n    };\n\n    return {\n      uid: detail.uid,\n      dom: detail.dom,\n      components: detail.components,\n      events: events,\n      behaviours: SketchBehaviours.augment(detail.buttonBehaviours, [Focusing.config({}), Keying.config({\n        mode: 'execution',\n        useSpace: true,\n        useEnter: true\n      })]),\n      domModification: {\n        attributes: getModAttributes()\n      },\n      eventOrder: detail.eventOrder\n    };\n  };\n\n  var Button = single$2({\n    name: 'Button',\n    factory: factory$1,\n    configFields: [defaulted$1('uid', undefined), strict$1('dom'), defaulted$1('components', []), SketchBehaviours.field('buttonBehaviours', [Focusing, Keying]), option('action'), option('role'), defaulted$1('eventOrder', {})]\n  });\n\n  var record = function (spec) {\n    var uid = isSketchSpec(spec) && hasNonNullableKey(spec, 'uid') ? spec.uid : generate$2('memento');\n\n    var get = function (anyInSystem) {\n      return anyInSystem.getSystem().getByUid(uid).getOrDie();\n    };\n\n    var getOpt = function (anyInSystem) {\n      return anyInSystem.getSystem().getByUid(uid).toOptional();\n    };\n\n    var asSpec = function () {\n      return __assign(__assign({}, spec), {\n        uid: uid\n      });\n    };\n\n    return {\n      get: get,\n      getOpt: getOpt,\n      asSpec: asSpec\n    };\n  };\n\n  var defaultIcon = function (icons) {\n    return Optional.from(icons()['temporary-placeholder']).getOr('!not found!');\n  };\n\n  var get$e = function (name, icons) {\n    return Optional.from(icons()[name.toLowerCase()]).getOrThunk(function () {\n      return defaultIcon(icons);\n    });\n  };\n\n  var getOr = function (name, icons, fallback) {\n    return Optional.from(icons()[name.toLowerCase()]).or(fallback).getOrThunk(function () {\n      return defaultIcon(icons);\n    });\n  };\n\n  var getFirst$1 = function (names, icons) {\n    return findMap(names, function (name) {\n      return Optional.from(icons()[name.toLowerCase()]);\n    }).getOrThunk(function () {\n      return defaultIcon(icons);\n    });\n  };\n\n  var notificationIconMap = {\n    success: 'checkmark',\n    error: 'warning',\n    err: 'error',\n    warning: 'warning',\n    warn: 'warning',\n    info: 'info'\n  };\n\n  var factory$2 = function (detail) {\n    var memBannerText = record({\n      dom: {\n        tag: 'p',\n        innerHtml: detail.translationProvider(detail.text)\n      },\n      behaviours: derive$1([Replacing.config({})])\n    });\n\n    var renderPercentBar = function (percent) {\n      return {\n        dom: {\n          tag: 'div',\n          classes: ['tox-bar'],\n          attributes: {\n            style: 'width: ' + percent + '%'\n          }\n        }\n      };\n    };\n\n    var renderPercentText = function (percent) {\n      return {\n        dom: {\n          tag: 'div',\n          classes: ['tox-text'],\n          innerHtml: percent + '%'\n        }\n      };\n    };\n\n    var memBannerProgress = record({\n      dom: {\n        tag: 'div',\n        classes: detail.progress ? ['tox-progress-bar', 'tox-progress-indicator'] : ['tox-progress-bar']\n      },\n      components: [{\n        dom: {\n          tag: 'div',\n          classes: ['tox-bar-container']\n        },\n        components: [renderPercentBar(0)]\n      }, renderPercentText(0)],\n      behaviours: derive$1([Replacing.config({})])\n    });\n\n    var updateProgress = function (comp, percent) {\n      if (comp.getSystem().isConnected()) {\n        memBannerProgress.getOpt(comp).each(function (progress) {\n          Replacing.set(progress, [{\n            dom: {\n              tag: 'div',\n              classes: ['tox-bar-container']\n            },\n            components: [renderPercentBar(percent)]\n          }, renderPercentText(percent)]);\n        });\n      }\n    };\n\n    var updateText = function (comp, text$1) {\n      if (comp.getSystem().isConnected()) {\n        var banner = memBannerText.get(comp);\n        Replacing.set(banner, [text(text$1)]);\n      }\n    };\n\n    var apis = {\n      updateProgress: updateProgress,\n      updateText: updateText\n    };\n    var iconChoices = flatten([detail.icon.toArray(), detail.level.toArray(), detail.level.bind(function (level) {\n      return Optional.from(notificationIconMap[level]);\n    }).toArray()]);\n    var memButton = record(Button.sketch({\n      dom: {\n        tag: 'button',\n        classes: ['tox-notification__dismiss', 'tox-button', 'tox-button--naked', 'tox-button--icon']\n      },\n      components: [{\n        dom: {\n          tag: 'div',\n          classes: ['tox-icon'],\n          innerHtml: get$e('close', detail.iconProvider),\n          attributes: {\n            'aria-label': detail.translationProvider('Close')\n          }\n        }\n      }],\n      action: function (comp) {\n        detail.onAction(comp);\n      }\n    }));\n    var components = [{\n      dom: {\n        tag: 'div',\n        classes: ['tox-notification__icon'],\n        innerHtml: getFirst$1(iconChoices, detail.iconProvider)\n      }\n    }, {\n      dom: {\n        tag: 'div',\n        classes: ['tox-notification__body']\n      },\n      components: [memBannerText.asSpec()],\n      behaviours: derive$1([Replacing.config({})])\n    }];\n    return {\n      uid: detail.uid,\n      dom: {\n        tag: 'div',\n        attributes: {\n          role: 'alert'\n        },\n        classes: detail.level.map(function (level) {\n          return ['tox-notification', 'tox-notification--in', 'tox-notification--' + level];\n        }).getOr(['tox-notification', 'tox-notification--in'])\n      },\n      behaviours: derive$1([Focusing.config({}), config('notification-events', [run(focusin(), function (comp) {\n        memButton.getOpt(comp).each(Focusing.focus);\n      })])]),\n      components: components.concat(detail.progress ? [memBannerProgress.asSpec()] : []).concat(!detail.closeButton ? [] : [memButton.asSpec()]),\n      apis: apis\n    };\n  };\n\n  var Notification = single$2({\n    name: 'Notification',\n    factory: factory$2,\n    configFields: [option('level'), strict$1('progress'), strict$1('icon'), strict$1('onAction'), strict$1('text'), strict$1('iconProvider'), strict$1('translationProvider'), defaultedBoolean('closeButton', true)],\n    apis: {\n      updateProgress: function (apis, comp, percent) {\n        apis.updateProgress(comp, percent);\n      },\n      updateText: function (apis, comp, text) {\n        apis.updateText(comp, text);\n      }\n    }\n  });\n\n  function NotificationManagerImpl(editor, extras, uiMothership) {\n    var backstage = extras.backstage;\n\n    var getLayoutDirection = function (rel) {\n      switch (rel) {\n        case 'bc-bc':\n          return south$3;\n\n        case 'tc-tc':\n          return north$3;\n\n        case 'tc-bc':\n          return north$1;\n\n        case 'bc-tc':\n        default:\n          return south$1;\n      }\n    };\n\n    var prePositionNotifications = function (notifications) {\n      each(notifications, function (notification) {\n        return notification.moveTo(0, 0);\n      });\n    };\n\n    var positionNotifications = function (notifications) {\n      if (notifications.length > 0) {\n        head(notifications).each(function (firstItem) {\n          return firstItem.moveRel(null, 'banner');\n        });\n        each(notifications, function (notification, index) {\n          if (index > 0) {\n            notification.moveRel(notifications[index - 1].getEl(), 'bc-tc');\n          }\n        });\n      }\n    };\n\n    var reposition = function (notifications) {\n      prePositionNotifications(notifications);\n      positionNotifications(notifications);\n    };\n\n    var open = function (settings, closeCallback) {\n      var hideCloseButton = !settings.closeButton && settings.timeout && (settings.timeout > 0 || settings.timeout < 0);\n\n      var close = function () {\n        closeCallback();\n        InlineView.hide(notificationWrapper);\n      };\n\n      var notification = build$1(Notification.sketch({\n        text: settings.text,\n        level: contains(['success', 'error', 'warning', 'warn', 'info'], settings.type) ? settings.type : undefined,\n        progress: settings.progressBar === true,\n        icon: Optional.from(settings.icon),\n        closeButton: !hideCloseButton,\n        onAction: close,\n        iconProvider: backstage.shared.providers.icons,\n        translationProvider: backstage.shared.providers.translate\n      }));\n      var notificationWrapper = build$1(InlineView.sketch(__assign({\n        dom: {\n          tag: 'div',\n          classes: ['tox-notifications-container']\n        },\n        lazySink: extras.backstage.shared.getSink,\n        fireDismissalEventInstead: {}\n      }, backstage.shared.header.isPositionedAtTop() ? {} : {\n        fireRepositionEventInstead: {}\n      })));\n      uiMothership.add(notificationWrapper);\n\n      if (settings.timeout > 0) {\n        global$2.setTimeout(function () {\n          close();\n        }, settings.timeout);\n      }\n\n      return {\n        close: close,\n        moveTo: function (x, y) {\n          InlineView.showAt(notificationWrapper, {\n            anchor: 'makeshift',\n            x: x,\n            y: y\n          }, premade$1(notification));\n        },\n        moveRel: function (element, rel) {\n          if (rel !== 'banner') {\n            var layoutDirection_1 = getLayoutDirection(rel);\n            var nodeAnchor = {\n              anchor: 'node',\n              root: body(),\n              node: Optional.some(SugarElement.fromDom(element)),\n              layouts: {\n                onRtl: function () {\n                  return [layoutDirection_1];\n                },\n                onLtr: function () {\n                  return [layoutDirection_1];\n                }\n              }\n            };\n            InlineView.showAt(notificationWrapper, nodeAnchor, premade$1(notification));\n          } else {\n            InlineView.showAt(notificationWrapper, extras.backstage.shared.anchors.banner(), premade$1(notification));\n          }\n        },\n        text: function (nuText) {\n          Notification.updateText(notification, nuText);\n        },\n        settings: settings,\n        getEl: function () {\n          return notification.element.dom;\n        },\n        progressBar: {\n          value: function (percent) {\n            Notification.updateProgress(notification, percent);\n          }\n        }\n      };\n    };\n\n    var close = function (notification) {\n      notification.close();\n    };\n\n    var getArgs = function (notification) {\n      return notification.settings;\n    };\n\n    return {\n      open: open,\n      close: close,\n      reposition: reposition,\n      getArgs: getArgs\n    };\n  }\n\n  var first = function (fn, rate) {\n    var timer = null;\n\n    var cancel = function () {\n      if (timer !== null) {\n        clearTimeout(timer);\n        timer = null;\n      }\n    };\n\n    var throttle = function () {\n      var args = [];\n\n      for (var _i = 0; _i < arguments.length; _i++) {\n        args[_i] = arguments[_i];\n      }\n\n      if (timer === null) {\n        timer = setTimeout(function () {\n          fn.apply(null, args);\n          timer = null;\n        }, rate);\n      }\n    };\n\n    return {\n      cancel: cancel,\n      throttle: throttle\n    };\n  };\n\n  var last$2 = function (fn, rate) {\n    var timer = null;\n\n    var cancel = function () {\n      if (timer !== null) {\n        clearTimeout(timer);\n        timer = null;\n      }\n    };\n\n    var throttle = function () {\n      var args = [];\n\n      for (var _i = 0; _i < arguments.length; _i++) {\n        args[_i] = arguments[_i];\n      }\n\n      if (timer !== null) {\n        clearTimeout(timer);\n      }\n\n      timer = setTimeout(function () {\n        fn.apply(null, args);\n        timer = null;\n      }, rate);\n    };\n\n    return {\n      cancel: cancel,\n      throttle: throttle\n    };\n  };\n\n  var global$3 = tinymce.util.Tools.resolve('tinymce.dom.TextSeeker');\n\n  var isBoundary = function (dom, node) {\n    return dom.isBlock(node) || contains(['BR', 'IMG', 'HR', 'INPUT'], node.nodeName) || dom.getContentEditable(node) === 'false';\n  };\n\n  var repeatLeft = function (dom, node, offset, process, rootNode) {\n    var search = global$3(dom, function (node) {\n      return isBoundary(dom, node);\n    });\n    return Optional.from(search.backwards(node, offset, process, rootNode));\n  };\n\n  var autocompleteSelector = '[data-mce-autocompleter]';\n\n  var create$4 = function (editor, range) {\n    return detect$4(SugarElement.fromDom(editor.selection.getNode())).getOrThunk(function () {\n      var wrapper = SugarElement.fromHtml('<span data-mce-autocompleter=\"1\" data-mce-bogus=\"1\"></span>', editor.getDoc());\n      append(wrapper, SugarElement.fromDom(range.extractContents()));\n      range.insertNode(wrapper.dom);\n      parent(wrapper).each(function (elm) {\n        return elm.dom.normalize();\n      });\n      last$1(wrapper).map(function (last) {\n        editor.selection.setCursorLocation(last.dom, getEnd(last));\n      });\n      return wrapper;\n    });\n  };\n\n  var detect$4 = function (elm) {\n    return closest$3(elm, autocompleteSelector);\n  };\n\n  var isValidTextRange = function (rng) {\n    return rng.collapsed && rng.startContainer.nodeType === 3;\n  };\n\n  var getText = function (rng) {\n    return rng.toString().replace(/\\u00A0/g, ' ').replace(/\\uFEFF/g, '');\n  };\n\n  var isWhitespace = function (chr) {\n    return chr !== '' && ' \\xA0\\f\\n\\r\\t\\x0B'.indexOf(chr) !== -1;\n  };\n\n  var stripTriggerChar = function (text, triggerCh) {\n    return text.substring(triggerCh.length);\n  };\n\n  var findChar = function (text, index, ch) {\n    var i;\n\n    for (i = index - 1; i >= 0; i--) {\n      var char = text.charAt(i);\n\n      if (isWhitespace(char)) {\n        return Optional.none();\n      }\n\n      if (char === ch) {\n        break;\n      }\n    }\n\n    return Optional.some(i);\n  };\n\n  var findStart = function (dom, initRange, ch, minChars) {\n    if (minChars === void 0) {\n      minChars = 0;\n    }\n\n    if (!isValidTextRange(initRange)) {\n      return Optional.none();\n    }\n\n    var findTriggerChIndex = function (element, offset, text) {\n      return findChar(text, offset, ch).getOr(offset);\n    };\n\n    var root = dom.getParent(initRange.startContainer, dom.isBlock) || dom.getRoot();\n    return repeatLeft(dom, initRange.startContainer, initRange.startOffset, findTriggerChIndex, root).bind(function (spot) {\n      var range = initRange.cloneRange();\n      range.setStart(spot.container, spot.offset);\n      range.setEnd(initRange.endContainer, initRange.endOffset);\n\n      if (range.collapsed) {\n        return Optional.none();\n      }\n\n      var text = getText(range);\n      var triggerCharIndex = text.lastIndexOf(ch);\n\n      if (triggerCharIndex !== 0 || stripTriggerChar(text, ch).length < minChars) {\n        return Optional.none();\n      } else {\n        return Optional.some({\n          text: stripTriggerChar(text, ch),\n          range: range,\n          triggerChar: ch\n        });\n      }\n    });\n  };\n\n  var getContext = function (dom, initRange, ch, minChars) {\n    if (minChars === void 0) {\n      minChars = 0;\n    }\n\n    return detect$4(SugarElement.fromDom(initRange.startContainer)).fold(function () {\n      return findStart(dom, initRange, ch, minChars);\n    }, function (elm) {\n      var range = dom.createRng();\n      range.selectNode(elm.dom);\n      var text = getText(range);\n      return Optional.some({\n        range: range,\n        text: stripTriggerChar(text, ch),\n        triggerChar: ch\n      });\n    });\n  };\n\n  var setup = function (api, editor) {\n    editor.on('keypress compositionend', api.onKeypress.throttle);\n    editor.on('remove', api.onKeypress.cancel);\n\n    var redirectKeyToItem = function (item, e) {\n      emitWith(item, keydown(), {\n        raw: e\n      });\n    };\n\n    editor.on('keydown', function (e) {\n      var getItem = function () {\n        return api.getView().bind(Highlighting.getHighlighted);\n      };\n\n      if (e.which === 8) {\n        api.onKeypress.throttle(e);\n      }\n\n      if (api.isActive()) {\n        if (e.which === 27) {\n          api.cancelIfNecessary();\n        }\n\n        if (api.isMenuOpen()) {\n          if (e.which === 13) {\n            getItem().each(emitExecute);\n            e.preventDefault();\n          } else if (e.which === 40) {\n            getItem().fold(function () {\n              api.getView().each(Highlighting.highlightFirst);\n            }, function (item) {\n              redirectKeyToItem(item, e);\n            });\n            e.preventDefault();\n            e.stopImmediatePropagation();\n          } else if (e.which === 37 || e.which === 38 || e.which === 39) {\n            getItem().each(function (item) {\n              redirectKeyToItem(item, e);\n              e.preventDefault();\n              e.stopImmediatePropagation();\n            });\n          }\n        } else {\n          if (e.which === 13 || e.which === 38 || e.which === 40) {\n            api.cancelIfNecessary();\n          }\n        }\n      }\n    });\n    editor.on('NodeChange', function (e) {\n      if (api.isActive() && !api.isProcessingAction() && detect$4(SugarElement.fromDom(e.element)).isNone()) {\n        api.cancelIfNecessary();\n      }\n    });\n  };\n\n  var AutocompleterEditorEvents = {\n    setup: setup\n  };\n  var global$4 = tinymce.util.Tools.resolve('tinymce.util.Promise');\n\n  var point$1 = function (container, offset) {\n    return {\n      container: container,\n      offset: offset\n    };\n  };\n\n  var isText$1 = function (node) {\n    return node.nodeType === TEXT;\n  };\n\n  var isElement$1 = function (node) {\n    return node.nodeType === ELEMENT;\n  };\n\n  var toLast = function (node) {\n    if (isText$1(node)) {\n      return point$1(node, node.data.length);\n    } else {\n      var children = node.childNodes;\n      return children.length > 0 ? toLast(children[children.length - 1]) : point$1(node, children.length);\n    }\n  };\n\n  var toLeaf = function (node, offset) {\n    var children = node.childNodes;\n\n    if (children.length > 0 && offset < children.length) {\n      return toLeaf(children[offset], 0);\n    } else if (children.length > 0 && isElement$1(node) && children.length === offset) {\n      return toLast(children[children.length - 1]);\n    } else {\n      return point$1(node, offset);\n    }\n  };\n\n  var isPreviousCharContent = function (dom, leaf) {\n    return repeatLeft(dom, leaf.container, leaf.offset, function (element, offset) {\n      return offset === 0 ? -1 : offset;\n    }, dom.getRoot()).filter(function (spot) {\n      var char = spot.container.data.charAt(spot.offset - 1);\n      return !isWhitespace(char);\n    }).isSome();\n  };\n\n  var isStartOfWord = function (dom) {\n    return function (rng) {\n      var leaf = toLeaf(rng.startContainer, rng.startOffset);\n      return !isPreviousCharContent(dom, leaf);\n    };\n  };\n\n  var getTriggerContext = function (dom, initRange, database) {\n    return findMap(database.triggerChars, function (ch) {\n      return getContext(dom, initRange, ch);\n    });\n  };\n\n  var lookup = function (editor, getDatabase) {\n    var database = getDatabase();\n    var rng = editor.selection.getRng();\n    return getTriggerContext(editor.dom, rng, database).bind(function (context) {\n      return lookupWithContext(editor, getDatabase, context);\n    });\n  };\n\n  var lookupWithContext = function (editor, getDatabase, context, fetchOptions) {\n    if (fetchOptions === void 0) {\n      fetchOptions = {};\n    }\n\n    var database = getDatabase();\n    var rng = editor.selection.getRng();\n    var startText = rng.startContainer.nodeValue;\n    var autocompleters = filter(database.lookupByChar(context.triggerChar), function (autocompleter) {\n      return context.text.length >= autocompleter.minChars && autocompleter.matches.getOrThunk(function () {\n        return isStartOfWord(editor.dom);\n      })(context.range, startText, context.text);\n    });\n\n    if (autocompleters.length === 0) {\n      return Optional.none();\n    }\n\n    var lookupData = global$4.all(map(autocompleters, function (ac) {\n      var fetchResult = ac.fetch(context.text, ac.maxResults, fetchOptions);\n      return fetchResult.then(function (results) {\n        return {\n          matchText: context.text,\n          items: results,\n          columns: ac.columns,\n          onAction: ac.onAction,\n          highlightOn: ac.highlightOn\n        };\n      });\n    }));\n    return Optional.some({\n      lookupData: lookupData,\n      context: context\n    });\n  };\n\n  var separatorMenuItemSchema = objOf([strictString('type'), optionString('text')]);\n\n  var createSeparatorMenuItem = function (spec) {\n    return asRaw('separatormenuitem', separatorMenuItemSchema, spec);\n  };\n\n  var autocompleterItemSchema = objOf([defaulted$1('type', 'autocompleteitem'), defaulted$1('active', false), defaulted$1('disabled', false), defaulted$1('meta', {}), strictString('value'), optionString('text'), optionString('icon')]);\n  var autocompleterSchema = objOf([strictString('type'), strictString('ch'), defaultedNumber('minChars', 1), defaulted$1('columns', 1), defaultedNumber('maxResults', 10), optionFunction('matches'), strictFunction('fetch'), strictFunction('onAction'), defaultedArrayOf('highlightOn', [], string)]);\n\n  var createSeparatorItem = function (spec) {\n    return asRaw('Autocompleter.Separator', separatorMenuItemSchema, spec);\n  };\n\n  var createAutocompleterItem = function (spec) {\n    return asRaw('Autocompleter.Item', autocompleterItemSchema, spec);\n  };\n\n  var createAutocompleter = function (spec) {\n    return asRaw('Autocompleter', autocompleterSchema, spec);\n  };\n\n  var baseToolbarButtonFields = [defaultedBoolean('disabled', false), optionString('tooltip'), optionString('icon'), optionString('text'), defaultedFunction('onSetup', function () {\n    return noop;\n  })];\n  var toolbarButtonSchema = objOf([strictString('type'), strictFunction('onAction')].concat(baseToolbarButtonFields));\n\n  var createToolbarButton = function (spec) {\n    return asRaw('toolbarbutton', toolbarButtonSchema, spec);\n  };\n\n  var baseToolbarToggleButtonFields = [defaultedBoolean('active', false)].concat(baseToolbarButtonFields);\n  var toggleButtonSchema = objOf(baseToolbarToggleButtonFields.concat([strictString('type'), strictFunction('onAction')]));\n\n  var createToggleButton = function (spec) {\n    return asRaw('ToggleButton', toggleButtonSchema, spec);\n  };\n\n  var contextBarFields = [defaultedFunction('predicate', never), defaultedStringEnum('scope', 'node', ['node', 'editor']), defaultedStringEnum('position', 'selection', ['node', 'selection', 'line'])];\n  var contextButtonFields = baseToolbarButtonFields.concat([defaulted$1('type', 'contextformbutton'), defaulted$1('primary', false), strictFunction('onAction'), state$1('original', identity)]);\n  var contextToggleButtonFields = baseToolbarToggleButtonFields.concat([defaulted$1('type', 'contextformbutton'), defaulted$1('primary', false), strictFunction('onAction'), state$1('original', identity)]);\n  var launchButtonFields = baseToolbarButtonFields.concat([defaulted$1('type', 'contextformbutton')]);\n  var launchToggleButtonFields = baseToolbarToggleButtonFields.concat([defaulted$1('type', 'contextformtogglebutton')]);\n  var toggleOrNormal = choose$1('type', {\n    contextformbutton: contextButtonFields,\n    contextformtogglebutton: contextToggleButtonFields\n  });\n  var contextFormSchema = objOf([defaulted$1('type', 'contextform'), defaultedFunction('initValue', function () {\n    return '';\n  }), optionString('label'), strictArrayOf('commands', toggleOrNormal), optionOf('launch', choose$1('type', {\n    contextformbutton: launchButtonFields,\n    contextformtogglebutton: launchToggleButtonFields\n  }))].concat(contextBarFields));\n\n  var createContextForm = function (spec) {\n    return asRaw('ContextForm', contextFormSchema, spec);\n  };\n\n  var contextToolbarSchema = objOf([defaulted$1('type', 'contexttoolbar'), strictString('items')].concat(contextBarFields));\n\n  var createContextToolbar = function (spec) {\n    return asRaw('ContextToolbar', contextToolbarSchema, spec);\n  };\n\n  var stringArray = function (a) {\n    var all = {};\n    each(a, function (key) {\n      all[key] = {};\n    });\n    return keys(all);\n  };\n\n  var register = function (editor) {\n    var popups = editor.ui.registry.getAll().popups;\n    var dataset = map$2(popups, function (popup) {\n      return createAutocompleter(popup).fold(function (err) {\n        throw new Error(formatError(err));\n      }, function (x) {\n        return x;\n      });\n    });\n    var triggerChars = stringArray(mapToArray(dataset, function (v) {\n      return v.ch;\n    }));\n    var datasetValues = values(dataset);\n\n    var lookupByChar = function (ch) {\n      return filter(datasetValues, function (dv) {\n        return dv.ch === ch;\n      });\n    };\n\n    return {\n      dataset: dataset,\n      triggerChars: triggerChars,\n      lookupByChar: lookupByChar\n    };\n  };\n\n  var ItemResponse;\n\n  (function (ItemResponse) {\n    ItemResponse[ItemResponse['CLOSE_ON_EXECUTE'] = 0] = 'CLOSE_ON_EXECUTE';\n    ItemResponse[ItemResponse['BUBBLE_TO_SANDBOX'] = 1] = 'BUBBLE_TO_SANDBOX';\n  })(ItemResponse || (ItemResponse = {}));\n\n  var ItemResponse$1 = ItemResponse;\n  var navClass = 'tox-menu-nav__js';\n  var selectableClass = 'tox-collection__item';\n  var colorClass = 'tox-swatch';\n  var presetClasses = {\n    normal: navClass,\n    color: colorClass\n  };\n  var tickedClass = 'tox-collection__item--enabled';\n  var groupHeadingClass = 'tox-collection__group-heading';\n  var iconClass = 'tox-collection__item-icon';\n  var textClass = 'tox-collection__item-label';\n  var accessoryClass = 'tox-collection__item-accessory';\n  var caretClass = 'tox-collection__item-caret';\n  var checkmarkClass = 'tox-collection__item-checkmark';\n  var activeClass = 'tox-collection__item--active';\n  var iconClassRtl = 'tox-collection__item-icon-rtl';\n  var containerClass = 'tox-collection__item-container';\n  var containerColumnClass = 'tox-collection__item-container--column';\n  var containerRowClass = 'tox-collection__item-container--row';\n  var containerAlignRightClass = 'tox-collection__item-container--align-right';\n  var containerAlignLeftClass = 'tox-collection__item-container--align-left';\n  var containerValignTopClass = 'tox-collection__item-container--valign-top';\n  var containerValignMiddleClass = 'tox-collection__item-container--valign-middle';\n  var containerValignBottomClass = 'tox-collection__item-container--valign-bottom';\n\n  var classForPreset = function (presets) {\n    return get$1(presetClasses, presets).getOr(navClass);\n  };\n\n  var forMenu = function (presets) {\n    if (presets === 'color') {\n      return 'tox-swatches';\n    } else {\n      return 'tox-menu';\n    }\n  };\n\n  var classes = function (presets) {\n    return {\n      backgroundMenu: 'tox-background-menu',\n      selectedMenu: 'tox-selected-menu',\n      selectedItem: 'tox-collection__item--active',\n      hasIcons: 'tox-menu--has-icons',\n      menu: forMenu(presets),\n      tieredMenu: 'tox-tiered-menu'\n    };\n  };\n\n  var markers$1 = function (presets) {\n    var menuClasses = classes(presets);\n    return {\n      backgroundMenu: menuClasses.backgroundMenu,\n      selectedMenu: menuClasses.selectedMenu,\n      menu: menuClasses.menu,\n      selectedItem: menuClasses.selectedItem,\n      item: classForPreset(presets)\n    };\n  };\n\n  var dom$1 = function (hasIcons, columns, presets) {\n    var menuClasses = classes(presets);\n    return {\n      tag: 'div',\n      classes: flatten([[menuClasses.menu, 'tox-menu-' + columns + '-column'], hasIcons ? [menuClasses.hasIcons] : []])\n    };\n  };\n\n  var components$1 = [Menu.parts.items({})];\n\n  var part = function (hasIcons, columns, presets) {\n    var menuClasses = classes(presets);\n    var d = {\n      tag: 'div',\n      classes: flatten([[menuClasses.tieredMenu]])\n    };\n    return {\n      dom: d,\n      markers: markers$1(presets)\n    };\n  };\n\n  var chunk$1 = function (rowDom, numColumns) {\n    return function (items) {\n      var chunks = chunk(items, numColumns);\n      return map(chunks, function (c) {\n        return {\n          dom: rowDom,\n          components: c\n        };\n      });\n    };\n  };\n\n  var forSwatch = function (columns) {\n    return {\n      dom: {\n        tag: 'div',\n        classes: ['tox-menu', 'tox-swatches-menu']\n      },\n      components: [{\n        dom: {\n          tag: 'div',\n          classes: ['tox-swatches']\n        },\n        components: [Menu.parts.items({\n          preprocess: columns !== 'auto' ? chunk$1({\n            tag: 'div',\n            classes: ['tox-swatches__row']\n          }, columns) : identity\n        })]\n      }]\n    };\n  };\n\n  var forToolbar = function (columns) {\n    return {\n      dom: {\n        tag: 'div',\n        classes: ['tox-menu', 'tox-collection', 'tox-collection--toolbar', 'tox-collection--toolbar-lg']\n      },\n      components: [Menu.parts.items({\n        preprocess: chunk$1({\n          tag: 'div',\n          classes: ['tox-collection__group']\n        }, columns)\n      })]\n    };\n  };\n\n  var preprocessCollection = function (items, isSeparator) {\n    var allSplits = [];\n    var currentSplit = [];\n    each(items, function (item, i) {\n      if (isSeparator(item, i)) {\n        if (currentSplit.length > 0) {\n          allSplits.push(currentSplit);\n        }\n\n        currentSplit = [];\n\n        if (has(item.dom, 'innerHtml')) {\n          currentSplit.push(item);\n        }\n      } else {\n        currentSplit.push(item);\n      }\n    });\n\n    if (currentSplit.length > 0) {\n      allSplits.push(currentSplit);\n    }\n\n    return map(allSplits, function (s) {\n      return {\n        dom: {\n          tag: 'div',\n          classes: ['tox-collection__group']\n        },\n        components: s\n      };\n    });\n  };\n\n  var forCollection = function (columns, initItems, _hasIcons) {\n    return {\n      dom: {\n        tag: 'div',\n        classes: ['tox-menu', 'tox-collection'].concat(columns === 1 ? ['tox-collection--list'] : ['tox-collection--grid'])\n      },\n      components: [Menu.parts.items({\n        preprocess: function (items) {\n          if (columns !== 'auto' && columns > 1) {\n            return chunk$1({\n              tag: 'div',\n              classes: ['tox-collection__group']\n            }, columns)(items);\n          } else {\n            return preprocessCollection(items, function (_item, i) {\n              return initItems[i].type === 'separator';\n            });\n          }\n        }\n      })]\n    };\n  };\n\n  var forHorizontalCollection = function (initItems, _hasIcons) {\n    return {\n      dom: {\n        tag: 'div',\n        classes: ['tox-collection', 'tox-collection--horizontal']\n      },\n      components: [Menu.parts.items({\n        preprocess: function (items) {\n          return preprocessCollection(items, function (_item, i) {\n            return initItems[i].type === 'separator';\n          });\n        }\n      })]\n    };\n  };\n\n  var menuHasIcons = function (xs) {\n    return exists(xs, function (item) {\n      return 'icon' in item && item.icon !== undefined;\n    });\n  };\n\n  var handleError = function (error) {\n    console.error(formatError(error));\n    console.log(error);\n    return Optional.none();\n  };\n\n  var createHorizontalPartialMenuWithAlloyItems = function (value, _hasIcons, items, _columns, _presets) {\n    var structure = forHorizontalCollection(items);\n    return {\n      value: value,\n      dom: structure.dom,\n      components: structure.components,\n      items: items\n    };\n  };\n\n  var createPartialMenuWithAlloyItems = function (value, hasIcons, items, columns, presets) {\n    if (presets === 'color') {\n      var structure = forSwatch(columns);\n      return {\n        value: value,\n        dom: structure.dom,\n        components: structure.components,\n        items: items\n      };\n    }\n\n    if (presets === 'normal' && columns === 'auto') {\n      var structure = forCollection(columns, items);\n      return {\n        value: value,\n        dom: structure.dom,\n        components: structure.components,\n        items: items\n      };\n    }\n\n    if (presets === 'normal' && columns === 1) {\n      var structure = forCollection(1, items);\n      return {\n        value: value,\n        dom: structure.dom,\n        components: structure.components,\n        items: items\n      };\n    }\n\n    if (presets === 'normal') {\n      var structure = forCollection(columns, items);\n      return {\n        value: value,\n        dom: structure.dom,\n        components: structure.components,\n        items: items\n      };\n    }\n\n    if (presets === 'listpreview' && columns !== 'auto') {\n      var structure = forToolbar(columns);\n      return {\n        value: value,\n        dom: structure.dom,\n        components: structure.components,\n        items: items\n      };\n    }\n\n    return {\n      value: value,\n      dom: dom$1(hasIcons, columns, presets),\n      components: components$1,\n      items: items\n    };\n  };\n\n  var cardImageFields = [strictString('type'), strictString('src'), optionString('alt'), defaultedArrayOf('classes', [], string)];\n  var cardImageSchema = objOf(cardImageFields);\n  var cardTextFields = [strictString('type'), strictString('text'), optionString('name'), defaultedArrayOf('classes', ['tox-collection__item-label'], string)];\n  var cardTextSchema = objOf(cardTextFields);\n  var itemSchema$2 = valueThunkOf(function () {\n    return chooseProcessor('type', {\n      cardimage: cardImageSchema,\n      cardtext: cardTextSchema,\n      cardcontainer: cardContainerSchema\n    });\n  });\n  var cardContainerSchema = objOf([strictString('type'), defaultedString('direction', 'horizontal'), defaultedString('align', 'left'), defaultedString('valign', 'middle'), strictArrayOf('items', itemSchema$2)]);\n  var commonMenuItemFields = [defaultedBoolean('disabled', false), optionString('text'), optionString('shortcut'), field('value', 'value', defaultedThunk(function () {\n    return generate$1('menuitem-value');\n  }), anyValue$1()), defaulted$1('meta', {})];\n  var cardMenuItemSchema = objOf([strictString('type'), optionString('label'), strictArrayOf('items', itemSchema$2), defaultedFunction('onSetup', function () {\n    return noop;\n  }), defaultedFunction('onAction', noop)].concat(commonMenuItemFields));\n\n  var createCardMenuItem = function (spec) {\n    return asRaw('cardmenuitem', cardMenuItemSchema, spec);\n  };\n\n  var choiceMenuItemSchema = objOf([strictString('type'), defaultedBoolean('active', false), optionString('icon')].concat(commonMenuItemFields));\n\n  var createChoiceMenuItem = function (spec) {\n    return asRaw('choicemenuitem', choiceMenuItemSchema, spec);\n  };\n\n  var fancyTypes = ['inserttable', 'colorswatch'];\n  var fancyMenuItemSchema = objOf([strictString('type'), strictStringEnum('fancytype', fancyTypes), defaultedFunction('onAction', noop)]);\n\n  var createFancyMenuItem = function (spec) {\n    return asRaw('fancymenuitem', fancyMenuItemSchema, spec);\n  };\n\n  var menuItemSchema = objOf([strictString('type'), defaultedFunction('onSetup', function () {\n    return noop;\n  }), defaultedFunction('onAction', noop), optionString('icon')].concat(commonMenuItemFields));\n\n  var createMenuItem = function (spec) {\n    return asRaw('menuitem', menuItemSchema, spec);\n  };\n\n  var nestedMenuItemSchema = objOf([strictString('type'), strictFunction('getSubmenuItems'), defaultedFunction('onSetup', function () {\n    return noop;\n  }), optionString('icon')].concat(commonMenuItemFields));\n\n  var createNestedMenuItem = function (spec) {\n    return asRaw('nestedmenuitem', nestedMenuItemSchema, spec);\n  };\n\n  var toggleMenuItemSchema = objOf([strictString('type'), optionString('icon'), defaultedBoolean('active', false), defaultedFunction('onSetup', function () {\n    return noop;\n  }), strictFunction('onAction')].concat(commonMenuItemFields));\n\n  var createToggleMenuItem = function (spec) {\n    return asRaw('togglemenuitem', toggleMenuItemSchema, spec);\n  };\n\n  var detectSize = function (comp, margin, selectorClass) {\n    var descendants$1 = descendants(comp.element, '.' + selectorClass);\n\n    if (descendants$1.length > 0) {\n      var columnLength = findIndex(descendants$1, function (c) {\n        var thisTop = c.dom.getBoundingClientRect().top;\n        var cTop = descendants$1[0].dom.getBoundingClientRect().top;\n        return Math.abs(thisTop - cTop) > margin;\n      }).getOr(descendants$1.length);\n      return Optional.some({\n        numColumns: columnLength,\n        numRows: Math.ceil(descendants$1.length / columnLength)\n      });\n    } else {\n      return Optional.none();\n    }\n  };\n\n  var namedEvents = function (name, handlers) {\n    return derive$1([config(name, handlers)]);\n  };\n\n  var unnamedEvents = function (handlers) {\n    return namedEvents(generate$1('unnamed-events'), handlers);\n  };\n\n  var SimpleBehaviours = {\n    namedEvents: namedEvents,\n    unnamedEvents: unnamedEvents\n  };\n  var ExclusivityChannel = generate$1('tooltip.exclusive');\n  var ShowTooltipEvent = generate$1('tooltip.show');\n  var HideTooltipEvent = generate$1('tooltip.hide');\n\n  var hideAllExclusive = function (component, _tConfig, _tState) {\n    component.getSystem().broadcastOn([ExclusivityChannel], {});\n  };\n\n  var setComponents = function (component, tConfig, tState, specs) {\n    tState.getTooltip().each(function (tooltip) {\n      if (tooltip.getSystem().isConnected()) {\n        Replacing.set(tooltip, specs);\n      }\n    });\n  };\n\n  var TooltippingApis = /*#__PURE__*/Object.freeze({\n    __proto__: null,\n    hideAllExclusive: hideAllExclusive,\n    setComponents: setComponents\n  });\n\n  var events$8 = function (tooltipConfig, state) {\n    var hide = function (comp) {\n      state.getTooltip().each(function (p) {\n        detach(p);\n        tooltipConfig.onHide(comp, p);\n        state.clearTooltip();\n      });\n      state.clearTimer();\n    };\n\n    var show = function (comp) {\n      if (!state.isShowing()) {\n        hideAllExclusive(comp);\n        var sink = tooltipConfig.lazySink(comp).getOrDie();\n        var popup = comp.getSystem().build({\n          dom: tooltipConfig.tooltipDom,\n          components: tooltipConfig.tooltipComponents,\n          events: derive(tooltipConfig.mode === 'normal' ? [run(mouseover(), function (_) {\n            emit(comp, ShowTooltipEvent);\n          }), run(mouseout(), function (_) {\n            emit(comp, HideTooltipEvent);\n          })] : []),\n          behaviours: derive$1([Replacing.config({})])\n        });\n        state.setTooltip(popup);\n        attach$1(sink, popup);\n        tooltipConfig.onShow(comp, popup);\n        Positioning.position(sink, tooltipConfig.anchor(comp), popup);\n      }\n    };\n\n    return derive(flatten([[run(ShowTooltipEvent, function (comp) {\n      state.resetTimer(function () {\n        show(comp);\n      }, tooltipConfig.delay);\n    }), run(HideTooltipEvent, function (comp) {\n      state.resetTimer(function () {\n        hide(comp);\n      }, tooltipConfig.delay);\n    }), run(receive(), function (comp, message) {\n      var receivingData = message;\n\n      if (!receivingData.universal) {\n        if (contains(receivingData.channels, ExclusivityChannel)) {\n          hide(comp);\n        }\n      }\n    }), runOnDetached(function (comp) {\n      hide(comp);\n    })], tooltipConfig.mode === 'normal' ? [run(focusin(), function (comp) {\n      emit(comp, ShowTooltipEvent);\n    }), run(postBlur(), function (comp) {\n      emit(comp, HideTooltipEvent);\n    }), run(mouseover(), function (comp) {\n      emit(comp, ShowTooltipEvent);\n    }), run(mouseout(), function (comp) {\n      emit(comp, HideTooltipEvent);\n    })] : [run(highlight(), function (comp, _se) {\n      emit(comp, ShowTooltipEvent);\n    }), run(dehighlight(), function (comp) {\n      emit(comp, HideTooltipEvent);\n    })]]));\n  };\n\n  var ActiveTooltipping = /*#__PURE__*/Object.freeze({\n    __proto__: null,\n    events: events$8\n  });\n  var TooltippingSchema = [strict$1('lazySink'), strict$1('tooltipDom'), defaulted$1('exclusive', true), defaulted$1('tooltipComponents', []), defaulted$1('delay', 300), defaultedStringEnum('mode', 'normal', ['normal', 'follow-highlight']), defaulted$1('anchor', function (comp) {\n    return {\n      anchor: 'hotspot',\n      hotspot: comp,\n      layouts: {\n        onLtr: constant([south$1, north$1, southeast$1, northeast$1, southwest$1, northwest$1]),\n        onRtl: constant([south$1, north$1, southeast$1, northeast$1, southwest$1, northwest$1])\n      }\n    };\n  }), onHandler('onHide'), onHandler('onShow')];\n\n  var init$4 = function () {\n    var timer = Cell(Optional.none());\n    var popup = Cell(Optional.none());\n\n    var getTooltip = function () {\n      return popup.get();\n    };\n\n    var setTooltip = function (comp) {\n      popup.set(Optional.some(comp));\n    };\n\n    var clearTooltip = function () {\n      popup.set(Optional.none());\n    };\n\n    var clearTimer = function () {\n      timer.get().each(function (t) {\n        clearTimeout(t);\n      });\n    };\n\n    var resetTimer = function (f, delay) {\n      clearTimer();\n      timer.set(Optional.some(setTimeout(function () {\n        f();\n      }, delay)));\n    };\n\n    var isShowing = function () {\n      return popup.get().isSome();\n    };\n\n    var readState = constant('not-implemented');\n    return nu$5({\n      getTooltip: getTooltip,\n      isShowing: isShowing,\n      setTooltip: setTooltip,\n      clearTooltip: clearTooltip,\n      clearTimer: clearTimer,\n      resetTimer: resetTimer,\n      readState: readState\n    });\n  };\n\n  var TooltippingState = /*#__PURE__*/Object.freeze({\n    __proto__: null,\n    init: init$4\n  });\n  var Tooltipping = create$1({\n    fields: TooltippingSchema,\n    name: 'tooltipping',\n    active: ActiveTooltipping,\n    state: TooltippingState,\n    apis: TooltippingApis\n  });\n\n  var escape = function (text) {\n    return text.replace(/[.*+?^${}()|[\\]\\\\]/g, '\\\\$&');\n  };\n\n  var global$5 = tinymce.util.Tools.resolve('tinymce.dom.DOMUtils');\n  var global$6 = tinymce.util.Tools.resolve('tinymce.util.I18n');\n  var nativeDisabled = ['input', 'button', 'textarea', 'select'];\n\n  var onLoad$5 = function (component, disableConfig, disableState) {\n    var f = disableConfig.disabled() ? disable : enable;\n    f(component, disableConfig);\n  };\n\n  var hasNative = function (component, config) {\n    return config.useNative === true && contains(nativeDisabled, name(component.element));\n  };\n\n  var nativeIsDisabled = function (component) {\n    return has$1(component.element, 'disabled');\n  };\n\n  var nativeDisable = function (component) {\n    set$1(component.element, 'disabled', 'disabled');\n  };\n\n  var nativeEnable = function (component) {\n    remove$1(component.element, 'disabled');\n  };\n\n  var ariaIsDisabled = function (component) {\n    return get$3(component.element, 'aria-disabled') === 'true';\n  };\n\n  var ariaDisable = function (component) {\n    set$1(component.element, 'aria-disabled', 'true');\n  };\n\n  var ariaEnable = function (component) {\n    set$1(component.element, 'aria-disabled', 'false');\n  };\n\n  var disable = function (component, disableConfig, _disableState) {\n    disableConfig.disableClass.each(function (disableClass) {\n      add$2(component.element, disableClass);\n    });\n    var f = hasNative(component, disableConfig) ? nativeDisable : ariaDisable;\n    f(component);\n    disableConfig.onDisabled(component);\n  };\n\n  var enable = function (component, disableConfig, _disableState) {\n    disableConfig.disableClass.each(function (disableClass) {\n      remove$4(component.element, disableClass);\n    });\n    var f = hasNative(component, disableConfig) ? nativeEnable : ariaEnable;\n    f(component);\n    disableConfig.onEnabled(component);\n  };\n\n  var isDisabled = function (component, disableConfig) {\n    return hasNative(component, disableConfig) ? nativeIsDisabled(component) : ariaIsDisabled(component);\n  };\n\n  var set$7 = function (component, disableConfig, disableState, disabled) {\n    var f = disabled ? disable : enable;\n    f(component, disableConfig);\n  };\n\n  var DisableApis = /*#__PURE__*/Object.freeze({\n    __proto__: null,\n    enable: enable,\n    disable: disable,\n    isDisabled: isDisabled,\n    onLoad: onLoad$5,\n    set: set$7\n  });\n\n  var exhibit$3 = function (base, disableConfig) {\n    return nu$6({\n      classes: disableConfig.disabled() ? disableConfig.disableClass.toArray() : []\n    });\n  };\n\n  var events$9 = function (disableConfig, disableState) {\n    return derive([abort(execute(), function (component, _simulatedEvent) {\n      return isDisabled(component, disableConfig);\n    }), loadEvent(disableConfig, disableState, onLoad$5)]);\n  };\n\n  var ActiveDisable = /*#__PURE__*/Object.freeze({\n    __proto__: null,\n    exhibit: exhibit$3,\n    events: events$9\n  });\n  var DisableSchema = [defaultedFunction('disabled', never), defaulted$1('useNative', true), option('disableClass'), onHandler('onDisabled'), onHandler('onEnabled')];\n  var Disabling = create$1({\n    fields: DisableSchema,\n    name: 'disabling',\n    active: ActiveDisable,\n    apis: DisableApis\n  });\n  var global$7 = tinymce.util.Tools.resolve('tinymce.EditorManager');\n\n  var getSkinUrl = function (editor) {\n    var skin = editor.getParam('skin');\n    var skinUrl = editor.getParam('skin_url');\n\n    if (skin !== false) {\n      var skinName = skin ? skin : 'oxide';\n\n      if (skinUrl) {\n        skinUrl = editor.documentBaseURI.toAbsolute(skinUrl);\n      } else {\n        skinUrl = global$7.baseURL + '/skins/ui/' + skinName;\n      }\n    }\n\n    return skinUrl;\n  };\n\n  var isReadOnly = function (editor) {\n    return editor.getParam('readonly', false, 'boolean');\n  };\n\n  var isSkinDisabled = function (editor) {\n    return editor.getParam('skin') === false;\n  };\n\n  var getHeightSetting = function (editor) {\n    return editor.getParam('height', Math.max(editor.getElement().offsetHeight, 200));\n  };\n\n  var getWidthSetting = function (editor) {\n    return editor.getParam('width', global$5.DOM.getStyle(editor.getElement(), 'width'));\n  };\n\n  var getMinWidthSetting = function (editor) {\n    return Optional.from(editor.getParam('min_width')).filter(isNumber);\n  };\n\n  var getMinHeightSetting = function (editor) {\n    return Optional.from(editor.getParam('min_height')).filter(isNumber);\n  };\n\n  var getMaxWidthSetting = function (editor) {\n    return Optional.from(editor.getParam('max_width')).filter(isNumber);\n  };\n\n  var getMaxHeightSetting = function (editor) {\n    return Optional.from(editor.getParam('max_height')).filter(isNumber);\n  };\n\n  var getUserStyleFormats = function (editor) {\n    return Optional.from(editor.getParam('style_formats')).filter(isArray);\n  };\n\n  var isMergeStyleFormats = function (editor) {\n    return editor.getParam('style_formats_merge', false, 'boolean');\n  };\n\n  var getLineHeightFormats = function (editor) {\n    return editor.getParam('lineheight_formats', '1 1.1 1.2 1.3 1.4 1.5 2', 'string').split(' ');\n  };\n\n  var getRemovedMenuItems = function (editor) {\n    return editor.getParam('removed_menuitems', '');\n  };\n\n  var isMenubarEnabled = function (editor) {\n    return editor.getParam('menubar', true, 'boolean') !== false;\n  };\n\n  var isToolbarEnabled = function (editor) {\n    var toolbar = editor.getParam('toolbar', true);\n    var isToolbarTrue = toolbar === true;\n    var isToolbarString = isString(toolbar);\n    var isToolbarObjectArray = isArray(toolbar) && toolbar.length > 0;\n    return !isMultipleToolbars(editor) && (isToolbarObjectArray || isToolbarString || isToolbarTrue);\n  };\n\n  var getMultipleToolbarsSetting = function (editor) {\n    var toolbars = range(9, function (num) {\n      return editor.getParam('toolbar' + (num + 1), false, 'string');\n    });\n    var toolbarArray = filter(toolbars, function (toolbar) {\n      return typeof toolbar === 'string';\n    });\n    return toolbarArray.length > 0 ? Optional.some(toolbarArray) : Optional.none();\n  };\n\n  var isMultipleToolbars = function (editor) {\n    return getMultipleToolbarsSetting(editor).fold(function () {\n      var toolbar = editor.getParam('toolbar', [], 'string[]');\n      return toolbar.length > 0;\n    }, always);\n  };\n\n  var ToolbarMode;\n\n  (function (ToolbarMode) {\n    ToolbarMode['default'] = 'wrap';\n    ToolbarMode['floating'] = 'floating';\n    ToolbarMode['sliding'] = 'sliding';\n    ToolbarMode['scrolling'] = 'scrolling';\n  })(ToolbarMode || (ToolbarMode = {}));\n\n  var getToolbarMode = function (editor) {\n    return editor.getParam('toolbar_mode', '', 'string');\n  };\n\n  var ToolbarLocation;\n\n  (function (ToolbarLocation) {\n    ToolbarLocation['auto'] = 'auto';\n    ToolbarLocation['top'] = 'top';\n    ToolbarLocation['bottom'] = 'bottom';\n  })(ToolbarLocation || (ToolbarLocation = {}));\n\n  var getToolbarGroups = function (editor) {\n    return editor.getParam('toolbar_groups', {}, 'object');\n  };\n\n  var getToolbarLocation = function (editor) {\n    return editor.getParam('toolbar_location', ToolbarLocation.auto, 'string');\n  };\n\n  var isToolbarLocationBottom = function (editor) {\n    return getToolbarLocation(editor) === ToolbarLocation.bottom;\n  };\n\n  var fixedContainerSelector = function (editor) {\n    return editor.getParam('fixed_toolbar_container', '', 'string');\n  };\n\n  var fixedToolbarContainerTarget = function (editor) {\n    return editor.getParam('fixed_toolbar_container_target');\n  };\n\n  var isToolbarPersist = function (editor) {\n    return editor.getParam('toolbar_persist', false, 'boolean');\n  };\n\n  var fixedContainerTarget = function (editor) {\n    if (!editor.inline) {\n      return Optional.none();\n    }\n\n    var selector = fixedContainerSelector(editor);\n\n    if (selector.length > 0) {\n      return descendant$1(body(), selector);\n    }\n\n    var element = fixedToolbarContainerTarget(editor);\n\n    if (isNonNullable(element)) {\n      return Optional.some(SugarElement.fromDom(element));\n    }\n\n    return Optional.none();\n  };\n\n  var useFixedContainer = function (editor) {\n    return editor.inline && fixedContainerTarget(editor).isSome();\n  };\n\n  var getUiContainer = function (editor) {\n    var fixedContainer = fixedContainerTarget(editor);\n    return fixedContainer.getOrThunk(function () {\n      return getContentContainer(getRootNode(SugarElement.fromDom(editor.getElement())));\n    });\n  };\n\n  var isDistractionFree = function (editor) {\n    return editor.inline && !isMenubarEnabled(editor) && !isToolbarEnabled(editor) && !isMultipleToolbars(editor);\n  };\n\n  var isStickyToolbar = function (editor) {\n    var isStickyToolbar = editor.getParam('toolbar_sticky', false, 'boolean');\n    return (isStickyToolbar || editor.inline) && !useFixedContainer(editor) && !isDistractionFree(editor);\n  };\n\n  var isDraggableModal = function (editor) {\n    return editor.getParam('draggable_modal', false, 'boolean');\n  };\n\n  var getMenus = function (editor) {\n    var menu = editor.getParam('menu');\n\n    if (menu) {\n      return map$2(menu, function (menu) {\n        return __assign(__assign({}, menu), {\n          items: menu.items\n        });\n      });\n    } else {\n      return {};\n    }\n  };\n\n  var getMenubar = function (editor) {\n    return editor.getParam('menubar');\n  };\n\n  var getToolbar = function (editor) {\n    return editor.getParam('toolbar', true);\n  };\n\n  var getFilePickerCallback = function (editor) {\n    return editor.getParam('file_picker_callback');\n  };\n\n  var getFilePickerTypes = function (editor) {\n    return editor.getParam('file_picker_types');\n  };\n\n  var getFileBrowserCallbackTypes = function (editor) {\n    return editor.getParam('file_browser_callback_types');\n  };\n\n  var noTypeaheadUrls = function (editor) {\n    return editor.getParam('typeahead_urls') === false;\n  };\n\n  var getAnchorTop = function (editor) {\n    return editor.getParam('anchor_top', '#top');\n  };\n\n  var getAnchorBottom = function (editor) {\n    return editor.getParam('anchor_bottom', '#bottom');\n  };\n\n  var getFilePickerValidatorHandler = function (editor) {\n    var handler = editor.getParam('file_picker_validator_handler', undefined, 'function');\n\n    if (handler === undefined) {\n      return editor.getParam('filepicker_validator_handler', undefined, 'function');\n    } else {\n      return handler;\n    }\n  };\n\n  var ReadOnlyChannel = 'silver.readonly';\n  var ReadOnlyDataSchema = objOf([strictBoolean('readonly')]);\n\n  var broadcastReadonly = function (uiComponents, readonly) {\n    var outerContainer = uiComponents.outerContainer;\n    var target = outerContainer.element;\n\n    if (readonly) {\n      uiComponents.mothership.broadcastOn([dismissPopups()], {\n        target: target\n      });\n      uiComponents.uiMothership.broadcastOn([dismissPopups()], {\n        target: target\n      });\n    }\n\n    uiComponents.mothership.broadcastOn([ReadOnlyChannel], {\n      readonly: readonly\n    });\n    uiComponents.uiMothership.broadcastOn([ReadOnlyChannel], {\n      readonly: readonly\n    });\n  };\n\n  var setupReadonlyModeSwitch = function (editor, uiComponents) {\n    editor.on('init', function () {\n      if (editor.mode.isReadOnly()) {\n        broadcastReadonly(uiComponents, true);\n      }\n    });\n    editor.on('SwitchMode', function () {\n      return broadcastReadonly(uiComponents, editor.mode.isReadOnly());\n    });\n\n    if (isReadOnly(editor)) {\n      editor.setMode('readonly');\n    }\n  };\n\n  var receivingConfig = function () {\n    var _a;\n\n    return Receiving.config({\n      channels: (_a = {}, _a[ReadOnlyChannel] = {\n        schema: ReadOnlyDataSchema,\n        onReceive: function (comp, data) {\n          Disabling.set(comp, data.readonly);\n        }\n      }, _a)\n    });\n  };\n\n  var item = function (disabled) {\n    return Disabling.config({\n      disabled: disabled,\n      disableClass: 'tox-collection__item--state-disabled'\n    });\n  };\n\n  var button = function (disabled) {\n    return Disabling.config({\n      disabled: disabled\n    });\n  };\n\n  var splitButton = function (disabled) {\n    return Disabling.config({\n      disabled: disabled,\n      disableClass: 'tox-tbtn--disabled'\n    });\n  };\n\n  var toolbarButton = function (disabled) {\n    return Disabling.config({\n      disabled: disabled,\n      disableClass: 'tox-tbtn--disabled',\n      useNative: false\n    });\n  };\n\n  var DisablingConfigs = {\n    item: item,\n    button: button,\n    splitButton: splitButton,\n    toolbarButton: toolbarButton\n  };\n\n  var runWithApi = function (info, comp) {\n    var api = info.getApi(comp);\n    return function (f) {\n      f(api);\n    };\n  };\n\n  var onControlAttached = function (info, editorOffCell) {\n    return runOnAttached(function (comp) {\n      var run = runWithApi(info, comp);\n      run(function (api) {\n        var onDestroy = info.onSetup(api);\n\n        if (isFunction(onDestroy)) {\n          editorOffCell.set(onDestroy);\n        }\n      });\n    });\n  };\n\n  var onControlDetached = function (getApi, editorOffCell) {\n    return runOnDetached(function (comp) {\n      return runWithApi(getApi, comp)(editorOffCell.get());\n    });\n  };\n\n  var _a;\n\n  var onMenuItemExecute = function (info, itemResponse) {\n    return runOnExecute(function (comp, simulatedEvent) {\n      runWithApi(info, comp)(info.onAction);\n\n      if (!info.triggersSubmenu && itemResponse === ItemResponse$1.CLOSE_ON_EXECUTE) {\n        if (comp.getSystem().isConnected()) {\n          emit(comp, sandboxClose());\n        }\n\n        simulatedEvent.stop();\n      }\n    });\n  };\n\n  var menuItemEventOrder = (_a = {}, _a[execute()] = ['disabling', 'alloy.base.behaviour', 'toggling', 'item-events'], _a);\n\n  var componentRenderPipeline = function (xs) {\n    return bind(xs, function (o) {\n      return o.toArray();\n    });\n  };\n\n  var renderCommonItem = function (spec, structure, itemResponse, providersbackstage) {\n    var editorOffCell = Cell(noop);\n    return {\n      type: 'item',\n      dom: structure.dom,\n      components: componentRenderPipeline(structure.optComponents),\n      data: spec.data,\n      eventOrder: menuItemEventOrder,\n      hasSubmenu: spec.triggersSubmenu,\n      itemBehaviours: derive$1([config('item-events', [onMenuItemExecute(spec, itemResponse), onControlAttached(spec, editorOffCell), onControlDetached(spec, editorOffCell)]), DisablingConfigs.item(function () {\n        return spec.disabled || providersbackstage.isDisabled();\n      }), receivingConfig(), Replacing.config({})].concat(spec.itemBehaviours))\n    };\n  };\n\n  var buildData = function (source) {\n    return {\n      value: source.value,\n      meta: __assign({\n        text: source.text.getOr('')\n      }, source.meta)\n    };\n  };\n\n  var global$8 = tinymce.util.Tools.resolve('tinymce.Env');\n\n  var convertText = function (source) {\n    var mac = {\n      alt: '&#x2325;',\n      ctrl: '&#x2303;',\n      shift: '&#x21E7;',\n      meta: '&#x2318;',\n      access: '&#x2303;&#x2325;'\n    };\n    var other = {\n      meta: 'Ctrl',\n      access: 'Shift+Alt'\n    };\n    var replace = global$8.mac ? mac : other;\n    var shortcut = source.split('+');\n    var updated = map(shortcut, function (segment) {\n      var search = segment.toLowerCase().trim();\n      return has(replace, search) ? replace[search] : segment;\n    });\n    return global$8.mac ? updated.join('') : updated.join('+');\n  };\n\n  var renderIcon = function (iconHtml) {\n    return {\n      dom: {\n        tag: 'div',\n        classes: [iconClass],\n        innerHtml: iconHtml\n      }\n    };\n  };\n\n  var renderText = function (text$1) {\n    return {\n      dom: {\n        tag: 'div',\n        classes: [textClass]\n      },\n      components: [text(global$6.translate(text$1))]\n    };\n  };\n\n  var renderHtml = function (html, classes) {\n    return {\n      dom: {\n        tag: 'div',\n        classes: classes,\n        innerHtml: html\n      }\n    };\n  };\n\n  var renderStyledText = function (style, text$1) {\n    return {\n      dom: {\n        tag: 'div',\n        classes: [textClass]\n      },\n      components: [{\n        dom: {\n          tag: style.tag,\n          styles: style.styles\n        },\n        components: [text(global$6.translate(text$1))]\n      }]\n    };\n  };\n\n  var renderShortcut = function (shortcut) {\n    return {\n      dom: {\n        tag: 'div',\n        classes: [accessoryClass],\n        innerHtml: convertText(shortcut)\n      }\n    };\n  };\n\n  var renderCheckmark = function (icons) {\n    return {\n      dom: {\n        tag: 'div',\n        classes: [checkmarkClass],\n        innerHtml: get$e('checkmark', icons)\n      }\n    };\n  };\n\n  var renderSubmenuCaret = function (icons) {\n    return {\n      dom: {\n        tag: 'div',\n        classes: [caretClass],\n        innerHtml: get$e('chevron-right', icons)\n      }\n    };\n  };\n\n  var renderDownwardsCaret = function (icons) {\n    return {\n      dom: {\n        tag: 'div',\n        classes: [caretClass],\n        innerHtml: get$e('chevron-down', icons)\n      }\n    };\n  };\n\n  var renderContainer = function (container, components) {\n    var directionClass = container.direction === 'vertical' ? containerColumnClass : containerRowClass;\n    var alignClass = container.align === 'left' ? containerAlignLeftClass : containerAlignRightClass;\n\n    var getValignClass = function () {\n      switch (container.valign) {\n        case 'top':\n          return containerValignTopClass;\n\n        case 'middle':\n          return containerValignMiddleClass;\n\n        case 'bottom':\n          return containerValignBottomClass;\n      }\n    };\n\n    return {\n      dom: {\n        tag: 'div',\n        classes: [containerClass, directionClass, alignClass, getValignClass()]\n      },\n      components: components\n    };\n  };\n\n  var renderImage = function (src, classes, alt) {\n    return {\n      dom: {\n        tag: 'img',\n        classes: classes,\n        attributes: {\n          src: src,\n          alt: alt.getOr('')\n        }\n      }\n    };\n  };\n\n  var renderColorStructure = function (itemText, itemValue, iconSvg, providerBackstage) {\n    var colorPickerCommand = 'custom';\n    var removeColorCommand = 'remove';\n\n    var getDom = function () {\n      var common = colorClass;\n      var icon = iconSvg.getOr('');\n      var attributes = itemText.map(function (text) {\n        return {\n          title: providerBackstage.translate(text)\n        };\n      }).getOr({});\n      var baseDom = {\n        tag: 'div',\n        attributes: attributes,\n        classes: [common]\n      };\n\n      if (itemValue === colorPickerCommand) {\n        return __assign(__assign({}, baseDom), {\n          tag: 'button',\n          classes: __spreadArrays(baseDom.classes, ['tox-swatches__picker-btn']),\n          innerHtml: icon\n        });\n      } else if (itemValue === removeColorCommand) {\n        return __assign(__assign({}, baseDom), {\n          classes: __spreadArrays(baseDom.classes, ['tox-swatch--remove']),\n          innerHtml: icon\n        });\n      } else {\n        return __assign(__assign({}, baseDom), {\n          attributes: __assign(__assign({}, baseDom.attributes), {\n            'data-mce-color': itemValue\n          }),\n          styles: {\n            'background-color': itemValue\n          }\n        });\n      }\n    };\n\n    return {\n      dom: getDom(),\n      optComponents: []\n    };\n  };\n\n  var renderItemDomStructure = function (rtlClass, ariaLabel) {\n    var domTitle = ariaLabel.map(function (label) {\n      return {\n        attributes: {\n          title: global$6.translate(label)\n        }\n      };\n    }).getOr({});\n    return __assign({\n      tag: 'div',\n      classes: [navClass, selectableClass].concat(rtlClass ? [iconClassRtl] : [])\n    }, domTitle);\n  };\n\n  var renderNormalItemStructure = function (info, icon, renderIcons, textRender, rtlClass) {\n    var leftIcon = renderIcons ? icon.or(Optional.some('')).map(renderIcon) : Optional.none();\n    var checkmark = info.checkMark;\n    var content = info.htmlContent.fold(function () {\n      return info.textContent.map(textRender);\n    }, function (html) {\n      return Optional.some(renderHtml(html, [textClass]));\n    });\n    var menuItem = {\n      dom: renderItemDomStructure(rtlClass, info.ariaLabel),\n      optComponents: [leftIcon, content, info.shortcutContent.map(renderShortcut), checkmark, info.caret]\n    };\n    return menuItem;\n  };\n\n  var rtlIcon = ['list-num-default', 'list-num-lower-alpha', 'list-num-lower-greek', 'list-num-lower-roman', 'list-num-upper-alpha', 'list-num-upper-roman'];\n  var rtlTransform = ['list-bull-circle', 'list-bull-default', 'list-bull-square'];\n\n  var renderItemStructure = function (info, providersBackstage, renderIcons, fallbackIcon) {\n    if (fallbackIcon === void 0) {\n      fallbackIcon = Optional.none();\n    }\n\n    var getIconName = function (iconName) {\n      return iconName.map(function (name) {\n        return global$6.isRtl() && contains(rtlIcon, name) ? name + '-rtl' : name;\n      });\n    };\n\n    var needRtlClass = global$6.isRtl() && info.iconContent.exists(function (name) {\n      return contains(rtlTransform, name);\n    });\n    var icon = getIconName(info.iconContent).map(function (iconName) {\n      return getOr(iconName, providersBackstage.icons, fallbackIcon);\n    });\n    var textRender = Optional.from(info.meta).fold(function () {\n      return renderText;\n    }, function (meta) {\n      return has(meta, 'style') ? curry(renderStyledText, meta.style) : renderText;\n    });\n\n    if (info.presets === 'color') {\n      return renderColorStructure(info.ariaLabel, info.value, icon, providersBackstage);\n    } else {\n      return renderNormalItemStructure(info, icon, renderIcons, textRender, needRtlClass);\n    }\n  };\n\n  var tooltipBehaviour = function (meta, sharedBackstage) {\n    return get$1(meta, 'tooltipWorker').map(function (tooltipWorker) {\n      return [Tooltipping.config({\n        lazySink: sharedBackstage.getSink,\n        tooltipDom: {\n          tag: 'div',\n          classes: ['tox-tooltip-worker-container']\n        },\n        tooltipComponents: [],\n        anchor: function (comp) {\n          return {\n            anchor: 'submenu',\n            item: comp,\n            overrides: {\n              maxHeightFunction: expandable\n            }\n          };\n        },\n        mode: 'follow-highlight',\n        onShow: function (component, _tooltip) {\n          tooltipWorker(function (elm) {\n            Tooltipping.setComponents(component, [external({\n              element: SugarElement.fromDom(elm)\n            })]);\n          });\n        }\n      })];\n    }).getOr([]);\n  };\n\n  var encodeText = function (text) {\n    return global$5.DOM.encode(text);\n  };\n\n  var replaceText = function (text, matchText) {\n    var translated = global$6.translate(text);\n    var encoded = encodeText(translated);\n\n    if (matchText.length > 0) {\n      var escapedMatchRegex = new RegExp(escape(matchText), 'gi');\n      return encoded.replace(escapedMatchRegex, function (match) {\n        return '<span class=\"tox-autocompleter-highlight\">' + match + '</span>';\n      });\n    } else {\n      return encoded;\n    }\n  };\n\n  var renderAutocompleteItem = function (spec, matchText, useText, presets, onItemValueHandler, itemResponse, sharedBackstage, renderIcons) {\n    if (renderIcons === void 0) {\n      renderIcons = true;\n    }\n\n    var structure = renderItemStructure({\n      presets: presets,\n      textContent: Optional.none(),\n      htmlContent: useText ? spec.text.map(function (text) {\n        return replaceText(text, matchText);\n      }) : Optional.none(),\n      ariaLabel: spec.text,\n      iconContent: spec.icon,\n      shortcutContent: Optional.none(),\n      checkMark: Optional.none(),\n      caret: Optional.none(),\n      value: spec.value\n    }, sharedBackstage.providers, renderIcons, spec.icon);\n    return renderCommonItem({\n      data: buildData(spec),\n      disabled: spec.disabled,\n      getApi: constant({}),\n      onAction: function (_api) {\n        return onItemValueHandler(spec.value, spec.meta);\n      },\n      onSetup: constant(noop),\n      triggersSubmenu: false,\n      itemBehaviours: tooltipBehaviour(spec.meta, sharedBackstage)\n    }, structure, itemResponse, sharedBackstage.providers);\n  };\n\n  var render = function (items, extras) {\n    return map(items, function (item) {\n      switch (item.type) {\n        case 'cardcontainer':\n          return renderContainer(item, render(item.items, extras));\n\n        case 'cardimage':\n          return renderImage(item.src, item.classes, item.alt);\n\n        case 'cardtext':\n          var shouldHighlight = item.name.exists(function (name) {\n            return contains(extras.cardText.highlightOn, name);\n          });\n          var matchText = shouldHighlight ? Optional.from(extras.cardText.matchText).getOr('') : '';\n          return renderHtml(replaceText(item.text, matchText), item.classes);\n      }\n    });\n  };\n\n  var renderCardMenuItem = function (spec, itemResponse, sharedBackstage, extras) {\n    var getApi = function (component) {\n      return {\n        isDisabled: function () {\n          return Disabling.isDisabled(component);\n        },\n        setDisabled: function (state) {\n          Disabling.set(component, state);\n          each(descendants(component.element, '*'), function (elm) {\n            component.getSystem().getByDom(elm).each(function (comp) {\n              if (comp.hasConfigured(Disabling)) {\n                Disabling.set(comp, state);\n              }\n            });\n          });\n        }\n      };\n    };\n\n    var structure = {\n      dom: renderItemDomStructure(false, spec.label),\n      optComponents: [Optional.some({\n        dom: {\n          tag: 'div',\n          classes: [containerClass, containerRowClass]\n        },\n        components: render(spec.items, extras)\n      })]\n    };\n    return renderCommonItem({\n      data: buildData(__assign({\n        text: Optional.none()\n      }, spec)),\n      disabled: spec.disabled,\n      getApi: getApi,\n      onAction: spec.onAction,\n      onSetup: spec.onSetup,\n      triggersSubmenu: false,\n      itemBehaviours: Optional.from(extras.itemBehaviours).getOr([])\n    }, structure, itemResponse, sharedBackstage.providers);\n  };\n\n  var renderChoiceItem = function (spec, useText, presets, onItemValueHandler, isSelected, itemResponse, providersBackstage, renderIcons) {\n    if (renderIcons === void 0) {\n      renderIcons = true;\n    }\n\n    var getApi = function (component) {\n      return {\n        setActive: function (state) {\n          Toggling.set(component, state);\n        },\n        isActive: function () {\n          return Toggling.isOn(component);\n        },\n        isDisabled: function () {\n          return Disabling.isDisabled(component);\n        },\n        setDisabled: function (state) {\n          return Disabling.set(component, state);\n        }\n      };\n    };\n\n    var structure = renderItemStructure({\n      presets: presets,\n      textContent: useText ? spec.text : Optional.none(),\n      htmlContent: Optional.none(),\n      ariaLabel: spec.text,\n      iconContent: spec.icon,\n      shortcutContent: useText ? spec.shortcut : Optional.none(),\n      checkMark: useText ? Optional.some(renderCheckmark(providersBackstage.icons)) : Optional.none(),\n      caret: Optional.none(),\n      value: spec.value\n    }, providersBackstage, renderIcons);\n    return deepMerge(renderCommonItem({\n      data: buildData(spec),\n      disabled: spec.disabled,\n      getApi: getApi,\n      onAction: function (_api) {\n        return onItemValueHandler(spec.value);\n      },\n      onSetup: function (api) {\n        api.setActive(isSelected);\n        return noop;\n      },\n      triggersSubmenu: false,\n      itemBehaviours: []\n    }, structure, itemResponse, providersBackstage), {\n      toggling: {\n        toggleClass: tickedClass,\n        toggleOnExecute: false,\n        selected: spec.active\n      }\n    });\n  };\n\n  var parts$2 = generate$4(owner$2(), parts());\n\n  var hexColour = function (value) {\n    return {\n      value: value\n    };\n  };\n\n  var shorthandRegex = /^#?([a-f\\d])([a-f\\d])([a-f\\d])$/i;\n  var longformRegex = /^#?([a-f\\d]{2})([a-f\\d]{2})([a-f\\d]{2})$/i;\n\n  var isHexString = function (hex) {\n    return shorthandRegex.test(hex) || longformRegex.test(hex);\n  };\n\n  var getLongForm = function (hex) {\n    var hexString = hex.value.replace(shorthandRegex, function (m, r, g, b) {\n      return r + r + g + g + b + b;\n    });\n    return {\n      value: hexString\n    };\n  };\n\n  var extractValues = function (hex) {\n    var longForm = getLongForm(hex);\n    var splitForm = longformRegex.exec(longForm.value);\n    return splitForm === null ? ['FFFFFF', 'FF', 'FF', 'FF'] : splitForm;\n  };\n\n  var toHex = function (component) {\n    var hex = component.toString(16);\n    return (hex.length === 1 ? '0' + hex : hex).toUpperCase();\n  };\n\n  var fromRgba = function (rgbaColour) {\n    var value = toHex(rgbaColour.red) + toHex(rgbaColour.green) + toHex(rgbaColour.blue);\n    return hexColour(value);\n  };\n\n  var min = Math.min;\n  var max = Math.max;\n  var round = Math.round;\n  var rgbRegex = /^rgb\\((\\d+),\\s*(\\d+),\\s*(\\d+)\\)/;\n  var rgbaRegex = /^rgba\\((\\d+),\\s*(\\d+),\\s*(\\d+),\\s*(\\d?(?:\\.\\d+)?)\\)/;\n\n  var rgbaColour = function (red, green, blue, alpha) {\n    return {\n      red: red,\n      green: green,\n      blue: blue,\n      alpha: alpha\n    };\n  };\n\n  var isRgbaComponent = function (value) {\n    var num = parseInt(value, 10);\n    return num.toString() === value && num >= 0 && num <= 255;\n  };\n\n  var fromHsv = function (hsv) {\n    var r;\n    var g;\n    var b;\n    var hue = (hsv.hue || 0) % 360;\n    var saturation = hsv.saturation / 100;\n    var brightness = hsv.value / 100;\n    saturation = max(0, min(saturation, 1));\n    brightness = max(0, min(brightness, 1));\n\n    if (saturation === 0) {\n      r = g = b = round(255 * brightness);\n      return rgbaColour(r, g, b, 1);\n    }\n\n    var side = hue / 60;\n    var chroma = brightness * saturation;\n    var x = chroma * (1 - Math.abs(side % 2 - 1));\n    var match = brightness - chroma;\n\n    switch (Math.floor(side)) {\n      case 0:\n        r = chroma;\n        g = x;\n        b = 0;\n        break;\n\n      case 1:\n        r = x;\n        g = chroma;\n        b = 0;\n        break;\n\n      case 2:\n        r = 0;\n        g = chroma;\n        b = x;\n        break;\n\n      case 3:\n        r = 0;\n        g = x;\n        b = chroma;\n        break;\n\n      case 4:\n        r = x;\n        g = 0;\n        b = chroma;\n        break;\n\n      case 5:\n        r = chroma;\n        g = 0;\n        b = x;\n        break;\n\n      default:\n        r = g = b = 0;\n    }\n\n    r = round(255 * (r + match));\n    g = round(255 * (g + match));\n    b = round(255 * (b + match));\n    return rgbaColour(r, g, b, 1);\n  };\n\n  var fromHex = function (hexColour) {\n    var result = extractValues(hexColour);\n    var red = parseInt(result[1], 16);\n    var green = parseInt(result[2], 16);\n    var blue = parseInt(result[3], 16);\n    return rgbaColour(red, green, blue, 1);\n  };\n\n  var fromStringValues = function (red, green, blue, alpha) {\n    var r = parseInt(red, 10);\n    var g = parseInt(green, 10);\n    var b = parseInt(blue, 10);\n    var a = parseFloat(alpha);\n    return rgbaColour(r, g, b, a);\n  };\n\n  var fromString = function (rgbaString) {\n    if (rgbaString === 'transparent') {\n      return Optional.some(rgbaColour(0, 0, 0, 0));\n    }\n\n    var rgbMatch = rgbRegex.exec(rgbaString);\n\n    if (rgbMatch !== null) {\n      return Optional.some(fromStringValues(rgbMatch[1], rgbMatch[2], rgbMatch[3], '1'));\n    }\n\n    var rgbaMatch = rgbaRegex.exec(rgbaString);\n\n    if (rgbaMatch !== null) {\n      return Optional.some(fromStringValues(rgbaMatch[1], rgbaMatch[2], rgbaMatch[3], rgbaMatch[4]));\n    }\n\n    return Optional.none();\n  };\n\n  var toString = function (rgba) {\n    return 'rgba(' + rgba.red + ',' + rgba.green + ',' + rgba.blue + ',' + rgba.alpha + ')';\n  };\n\n  var red = rgbaColour(255, 0, 0, 1);\n\n  var fireSkinLoaded = function (editor) {\n    return editor.fire('SkinLoaded');\n  };\n\n  var fireSkinLoadError = function (editor, error) {\n    return editor.fire('SkinLoadError', error);\n  };\n\n  var fireResizeEditor = function (editor) {\n    return editor.fire('ResizeEditor');\n  };\n\n  var fireResizeContent = function (editor, e) {\n    return editor.fire('ResizeContent', e);\n  };\n\n  var fireScrollContent = function (editor, e) {\n    return editor.fire('ScrollContent', e);\n  };\n\n  var fireTextColorChange = function (editor, data) {\n    return editor.fire('TextColorChange', data);\n  };\n\n  var global$9 = tinymce.util.Tools.resolve('tinymce.util.LocalStorage');\n  var storageName = 'tinymce-custom-colors';\n\n  function ColorCache(max) {\n    if (max === void 0) {\n      max = 10;\n    }\n\n    var storageString = global$9.getItem(storageName);\n    var localstorage = isString(storageString) ? JSON.parse(storageString) : [];\n\n    var prune = function (list) {\n      var diff = max - list.length;\n      return diff < 0 ? list.slice(0, max) : list;\n    };\n\n    var cache = prune(localstorage);\n\n    var add = function (key) {\n      indexOf(cache, key).each(remove);\n      cache.unshift(key);\n\n      if (cache.length > max) {\n        cache.pop();\n      }\n\n      global$9.setItem(storageName, JSON.stringify(cache));\n    };\n\n    var remove = function (idx) {\n      cache.splice(idx, 1);\n    };\n\n    var state = function () {\n      return cache.slice(0);\n    };\n\n    return {\n      add: add,\n      state: state\n    };\n  }\n\n  var choiceItem = 'choiceitem';\n  var defaultColors = [{\n    type: choiceItem,\n    text: 'Light Green',\n    value: '#BFEDD2'\n  }, {\n    type: choiceItem,\n    text: 'Light Yellow',\n    value: '#FBEEB8'\n  }, {\n    type: choiceItem,\n    text: 'Light Red',\n    value: '#F8CAC6'\n  }, {\n    type: choiceItem,\n    text: 'Light Purple',\n    value: '#ECCAFA'\n  }, {\n    type: choiceItem,\n    text: 'Light Blue',\n    value: '#C2E0F4'\n  }, {\n    type: choiceItem,\n    text: 'Green',\n    value: '#2DC26B'\n  }, {\n    type: choiceItem,\n    text: 'Yellow',\n    value: '#F1C40F'\n  }, {\n    type: choiceItem,\n    text: 'Red',\n    value: '#E03E2D'\n  }, {\n    type: choiceItem,\n    text: 'Purple',\n    value: '#B96AD9'\n  }, {\n    type: choiceItem,\n    text: 'Blue',\n    value: '#3598DB'\n  }, {\n    type: choiceItem,\n    text: 'Dark Turquoise',\n    value: '#169179'\n  }, {\n    type: choiceItem,\n    text: 'Orange',\n    value: '#E67E23'\n  }, {\n    type: choiceItem,\n    text: 'Dark Red',\n    value: '#BA372A'\n  }, {\n    type: choiceItem,\n    text: 'Dark Purple',\n    value: '#843FA1'\n  }, {\n    type: choiceItem,\n    text: 'Dark Blue',\n    value: '#236FA1'\n  }, {\n    type: choiceItem,\n    text: 'Light Gray',\n    value: '#ECF0F1'\n  }, {\n    type: choiceItem,\n    text: 'Medium Gray',\n    value: '#CED4D9'\n  }, {\n    type: choiceItem,\n    text: 'Gray',\n    value: '#95A5A6'\n  }, {\n    type: choiceItem,\n    text: 'Dark Gray',\n    value: '#7E8C8D'\n  }, {\n    type: choiceItem,\n    text: 'Navy Blue',\n    value: '#34495E'\n  }, {\n    type: choiceItem,\n    text: 'Black',\n    value: '#000000'\n  }, {\n    type: choiceItem,\n    text: 'White',\n    value: '#ffffff'\n  }];\n  var colorCache = ColorCache(10);\n\n  var mapColors = function (colorMap) {\n    var colors = [];\n    var canvas = document.createElement('canvas');\n    canvas.height = 1;\n    canvas.width = 1;\n    var ctx = canvas.getContext('2d');\n\n    var byteAsHex = function (colorByte, alphaByte) {\n      var bg = 255;\n      var alpha = alphaByte / 255;\n      var colorByteWithWhiteBg = Math.round(colorByte * alpha + bg * (1 - alpha));\n      return ('0' + colorByteWithWhiteBg.toString(16)).slice(-2).toUpperCase();\n    };\n\n    var asHexColor = function (color) {\n      if (/^[0-9A-Fa-f]{6}$/.test(color)) {\n        return '#' + color.toUpperCase();\n      }\n\n      ctx.clearRect(0, 0, canvas.width, canvas.height);\n      ctx.fillStyle = '#FFFFFF';\n      ctx.fillStyle = color;\n      ctx.fillRect(0, 0, 1, 1);\n      var rgba = ctx.getImageData(0, 0, 1, 1).data;\n      var r = rgba[0],\n          g = rgba[1],\n          b = rgba[2],\n          a = rgba[3];\n      return '#' + byteAsHex(r, a) + byteAsHex(g, a) + byteAsHex(b, a);\n    };\n\n    for (var i = 0; i < colorMap.length; i += 2) {\n      colors.push({\n        text: colorMap[i + 1],\n        value: asHexColor(colorMap[i]),\n        type: 'choiceitem'\n      });\n    }\n\n    return colors;\n  };\n\n  var getColorCols = function (editor, defaultCols) {\n    return editor.getParam('color_cols', defaultCols, 'number');\n  };\n\n  var hasCustomColors = function (editor) {\n    return editor.getParam('custom_colors') !== false;\n  };\n\n  var getColorMap = function (editor) {\n    return editor.getParam('color_map');\n  };\n\n  var getColors = function (editor) {\n    var unmapped = getColorMap(editor);\n    return unmapped !== undefined ? mapColors(unmapped) : defaultColors;\n  };\n\n  var getCurrentColors = function () {\n    return map(colorCache.state(), function (color) {\n      return {\n        type: choiceItem,\n        text: color,\n        value: color\n      };\n    });\n  };\n\n  var addColor = function (color) {\n    colorCache.add(color);\n  };\n\n  var getCurrentColor = function (editor, format) {\n    var color;\n    editor.dom.getParents(editor.selection.getStart(), function (elm) {\n      var value;\n\n      if (value = elm.style[format === 'forecolor' ? 'color' : 'background-color']) {\n        color = color ? color : value;\n      }\n    });\n    return color;\n  };\n\n  var applyFormat = function (editor, format, value) {\n    editor.undoManager.transact(function () {\n      editor.focus();\n      editor.formatter.apply(format, {\n        value: value\n      });\n      editor.nodeChanged();\n    });\n  };\n\n  var removeFormat = function (editor, format) {\n    editor.undoManager.transact(function () {\n      editor.focus();\n      editor.formatter.remove(format, {\n        value: null\n      }, null, true);\n      editor.nodeChanged();\n    });\n  };\n\n  var registerCommands = function (editor) {\n    editor.addCommand('mceApplyTextcolor', function (format, value) {\n      applyFormat(editor, format, value);\n    });\n    editor.addCommand('mceRemoveTextcolor', function (format) {\n      removeFormat(editor, format);\n    });\n  };\n\n  var calcCols = function (colors) {\n    return Math.max(5, Math.ceil(Math.sqrt(colors)));\n  };\n\n  var getColorCols$1 = function (editor) {\n    var colors = getColors(editor);\n    var defaultCols = calcCols(colors.length);\n    return getColorCols(editor, defaultCols);\n  };\n\n  var getAdditionalColors = function (hasCustom) {\n    var type = 'choiceitem';\n    var remove = {\n      type: type,\n      text: 'Remove color',\n      icon: 'color-swatch-remove-color',\n      value: 'remove'\n    };\n    var custom = {\n      type: type,\n      text: 'Custom color',\n      icon: 'color-picker',\n      value: 'custom'\n    };\n    return hasCustom ? [remove, custom] : [remove];\n  };\n\n  var applyColor = function (editor, format, value, onChoice) {\n    if (value === 'custom') {\n      var dialog = colorPickerDialog(editor);\n      dialog(function (colorOpt) {\n        colorOpt.each(function (color) {\n          addColor(color);\n          editor.execCommand('mceApplyTextcolor', format, color);\n          onChoice(color);\n        });\n      }, '#000000');\n    } else if (value === 'remove') {\n      onChoice('');\n      editor.execCommand('mceRemoveTextcolor', format);\n    } else {\n      onChoice(value);\n      editor.execCommand('mceApplyTextcolor', format, value);\n    }\n  };\n\n  var getColors$1 = function (colors, hasCustom) {\n    return colors.concat(getCurrentColors().concat(getAdditionalColors(hasCustom)));\n  };\n\n  var getFetch = function (colors, hasCustom) {\n    return function (callback) {\n      callback(getColors$1(colors, hasCustom));\n    };\n  };\n\n  var setIconColor = function (splitButtonApi, name, newColor) {\n    var id = name === 'forecolor' ? 'tox-icon-text-color__color' : 'tox-icon-highlight-bg-color__color';\n    splitButtonApi.setIconFill(id, newColor);\n  };\n\n  var registerTextColorButton = function (editor, name, format, tooltip, lastColor) {\n    editor.ui.registry.addSplitButton(name, {\n      tooltip: tooltip,\n      presets: 'color',\n      icon: name === 'forecolor' ? 'text-color' : 'highlight-bg-color',\n      select: function (value) {\n        var optCurrentRgb = Optional.from(getCurrentColor(editor, format));\n        return optCurrentRgb.bind(function (currentRgb) {\n          return fromString(currentRgb).map(function (rgba) {\n            var currentHex = fromRgba(rgba).value;\n            return contains$1(value.toLowerCase(), currentHex);\n          });\n        }).getOr(false);\n      },\n      columns: getColorCols$1(editor),\n      fetch: getFetch(getColors(editor), hasCustomColors(editor)),\n      onAction: function (_splitButtonApi) {\n        if (lastColor.get() !== null) {\n          applyColor(editor, format, lastColor.get(), noop);\n        }\n      },\n      onItemAction: function (_splitButtonApi, value) {\n        applyColor(editor, format, value, function (newColor) {\n          lastColor.set(newColor);\n          fireTextColorChange(editor, {\n            name: name,\n            color: newColor\n          });\n        });\n      },\n      onSetup: function (splitButtonApi) {\n        if (lastColor.get() !== null) {\n          setIconColor(splitButtonApi, name, lastColor.get());\n        }\n\n        var handler = function (e) {\n          if (e.name === name) {\n            setIconColor(splitButtonApi, e.name, e.color);\n          }\n        };\n\n        editor.on('TextColorChange', handler);\n        return function () {\n          editor.off('TextColorChange', handler);\n        };\n      }\n    });\n  };\n\n  var registerTextColorMenuItem = function (editor, name, format, text) {\n    editor.ui.registry.addNestedMenuItem(name, {\n      text: text,\n      icon: name === 'forecolor' ? 'text-color' : 'highlight-bg-color',\n      getSubmenuItems: function () {\n        return [{\n          type: 'fancymenuitem',\n          fancytype: 'colorswatch',\n          onAction: function (data) {\n            applyColor(editor, format, data.value, noop);\n          }\n        }];\n      }\n    });\n  };\n\n  var colorPickerDialog = function (editor) {\n    return function (callback, value) {\n      var isValid = false;\n\n      var onSubmit = function (api) {\n        var data = api.getData();\n        var hex = data.colorpicker;\n\n        if (isValid) {\n          callback(Optional.from(hex));\n          api.close();\n        } else {\n          editor.windowManager.alert(editor.translate(['Invalid hex color code: {0}', hex]));\n        }\n      };\n\n      var onAction = function (_api, details) {\n        if (details.name === 'hex-valid') {\n          isValid = details.value;\n        }\n      };\n\n      var initialData = {\n        colorpicker: value\n      };\n      editor.windowManager.open({\n        title: 'Color Picker',\n        size: 'normal',\n        body: {\n          type: 'panel',\n          items: [{\n            type: 'colorpicker',\n            name: 'colorpicker',\n            label: 'Color'\n          }]\n        },\n        buttons: [{\n          type: 'cancel',\n          name: 'cancel',\n          text: 'Cancel'\n        }, {\n          type: 'submit',\n          name: 'save',\n          text: 'Save',\n          primary: true\n        }],\n        initialData: initialData,\n        onAction: onAction,\n        onSubmit: onSubmit,\n        onClose: noop,\n        onCancel: function () {\n          callback(Optional.none());\n        }\n      });\n    };\n  };\n\n  var register$1 = function (editor) {\n    registerCommands(editor);\n    var lastForeColor = Cell(null);\n    var lastBackColor = Cell(null);\n    registerTextColorButton(editor, 'forecolor', 'forecolor', 'Text color', lastForeColor);\n    registerTextColorButton(editor, 'backcolor', 'hilitecolor', 'Background color', lastBackColor);\n    registerTextColorMenuItem(editor, 'forecolor', 'forecolor', 'Text color');\n    registerTextColorMenuItem(editor, 'backcolor', 'hilitecolor', 'Background color');\n  };\n\n  var createPartialChoiceMenu = function (value, items, onItemValueHandler, columns, presets, itemResponse, select, providersBackstage) {\n    var hasIcons = menuHasIcons(items);\n    var presetItemTypes = presets !== 'color' ? 'normal' : 'color';\n    var alloyItems = createChoiceItems(items, onItemValueHandler, columns, presetItemTypes, itemResponse, select, providersBackstage);\n    return createPartialMenuWithAlloyItems(value, hasIcons, alloyItems, columns, presets);\n  };\n\n  var createChoiceItems = function (items, onItemValueHandler, columns, itemPresets, itemResponse, select, providersBackstage) {\n    return cat(map(items, function (item) {\n      if (item.type === 'choiceitem') {\n        return createChoiceMenuItem(item).fold(handleError, function (d) {\n          return Optional.some(renderChoiceItem(d, columns === 1, itemPresets, onItemValueHandler, select(item.value), itemResponse, providersBackstage, menuHasIcons(items)));\n        });\n      } else {\n        return Optional.none();\n      }\n    }));\n  };\n\n  var deriveMenuMovement = function (columns, presets) {\n    var menuMarkers = markers$1(presets);\n\n    if (columns === 1) {\n      return {\n        mode: 'menu',\n        moveOnTab: true\n      };\n    } else if (columns === 'auto') {\n      return {\n        mode: 'grid',\n        selector: '.' + menuMarkers.item,\n        initSize: {\n          numColumns: 1,\n          numRows: 1\n        }\n      };\n    } else {\n      var rowClass = presets === 'color' ? 'tox-swatches__row' : 'tox-collection__group';\n      return {\n        mode: 'matrix',\n        rowSelector: '.' + rowClass\n      };\n    }\n  };\n\n  var deriveCollectionMovement = function (columns, presets) {\n    if (columns === 1) {\n      return {\n        mode: 'menu',\n        moveOnTab: false,\n        selector: '.tox-collection__item'\n      };\n    } else if (columns === 'auto') {\n      return {\n        mode: 'flatgrid',\n        selector: '.' + 'tox-collection__item',\n        initSize: {\n          numColumns: 1,\n          numRows: 1\n        }\n      };\n    } else {\n      return {\n        mode: 'matrix',\n        selectors: {\n          row: presets === 'color' ? '.tox-swatches__row' : '.tox-collection__group',\n          cell: presets === 'color' ? '.' + colorClass : '.' + selectableClass\n        }\n      };\n    }\n  };\n\n  var renderColorSwatchItem = function (spec, backstage) {\n    var items = getColors$1(backstage.colorinput.getColors(), backstage.colorinput.hasCustomColors());\n    var columns = backstage.colorinput.getColorCols();\n    var presets = 'color';\n    var menuSpec = createPartialChoiceMenu(generate$1('menu-value'), items, function (value) {\n      spec.onAction({\n        value: value\n      });\n    }, columns, presets, ItemResponse$1.CLOSE_ON_EXECUTE, never, backstage.shared.providers);\n\n    var widgetSpec = __assign(__assign({}, menuSpec), {\n      markers: markers$1(presets),\n      movement: deriveMenuMovement(columns, presets)\n    });\n\n    return {\n      type: 'widget',\n      data: {\n        value: generate$1('widget-id')\n      },\n      dom: {\n        tag: 'div',\n        classes: ['tox-fancymenuitem']\n      },\n      autofocus: true,\n      components: [parts$2.widget(Menu.sketch(widgetSpec))]\n    };\n  };\n\n  var cellOverEvent = generate$1('cell-over');\n  var cellExecuteEvent = generate$1('cell-execute');\n\n  var makeCell = function (row, col, labelId) {\n    var _a;\n\n    var emitCellOver = function (c) {\n      return emitWith(c, cellOverEvent, {\n        row: row,\n        col: col\n      });\n    };\n\n    var emitExecute = function (c) {\n      return emitWith(c, cellExecuteEvent, {\n        row: row,\n        col: col\n      });\n    };\n\n    var onClick = function (c, se) {\n      se.stop();\n      emitExecute(c);\n    };\n\n    return build$1({\n      dom: {\n        tag: 'div',\n        attributes: (_a = {\n          role: 'button'\n        }, _a['aria-labelledby'] = labelId, _a)\n      },\n      behaviours: derive$1([config('insert-table-picker-cell', [run(mouseover(), Focusing.focus), run(execute(), emitExecute), run(click(), onClick), run(tap(), onClick)]), Toggling.config({\n        toggleClass: 'tox-insert-table-picker__selected',\n        toggleOnExecute: false\n      }), Focusing.config({\n        onFocus: emitCellOver\n      })])\n    });\n  };\n\n  var makeCells = function (labelId, numRows, numCols) {\n    var cells = [];\n\n    for (var i = 0; i < numRows; i++) {\n      var row = [];\n\n      for (var j = 0; j < numCols; j++) {\n        row.push(makeCell(i, j, labelId));\n      }\n\n      cells.push(row);\n    }\n\n    return cells;\n  };\n\n  var selectCells = function (cells, selectedRow, selectedColumn, numRows, numColumns) {\n    for (var i = 0; i < numRows; i++) {\n      for (var j = 0; j < numColumns; j++) {\n        Toggling.set(cells[i][j], i <= selectedRow && j <= selectedColumn);\n      }\n    }\n  };\n\n  var makeComponents = function (cells) {\n    return bind(cells, function (cellRow) {\n      return map(cellRow, premade$1);\n    });\n  };\n\n  var makeLabelText = function (row, col) {\n    return text(col + 1 + 'x' + (row + 1));\n  };\n\n  var renderInsertTableMenuItem = function (spec) {\n    var numRows = 10;\n    var numColumns = 10;\n    var sizeLabelId = generate$1('size-label');\n    var cells = makeCells(sizeLabelId, numRows, numColumns);\n    var memLabel = record({\n      dom: {\n        tag: 'span',\n        classes: ['tox-insert-table-picker__label'],\n        attributes: {\n          id: sizeLabelId\n        }\n      },\n      components: [text('0x0')],\n      behaviours: derive$1([Replacing.config({})])\n    });\n    return {\n      type: 'widget',\n      data: {\n        value: generate$1('widget-id')\n      },\n      dom: {\n        tag: 'div',\n        classes: ['tox-fancymenuitem']\n      },\n      autofocus: true,\n      components: [parts$2.widget({\n        dom: {\n          tag: 'div',\n          classes: ['tox-insert-table-picker']\n        },\n        components: makeComponents(cells).concat(memLabel.asSpec()),\n        behaviours: derive$1([config('insert-table-picker', [runWithTarget(cellOverEvent, function (c, t, e) {\n          var row = e.event.row;\n          var col = e.event.col;\n          selectCells(cells, row, col, numRows, numColumns);\n          Replacing.set(memLabel.get(c), [makeLabelText(row, col)]);\n        }), runWithTarget(cellExecuteEvent, function (c, _, e) {\n          spec.onAction({\n            numRows: e.event.row + 1,\n            numColumns: e.event.col + 1\n          });\n          emit(c, sandboxClose());\n        })]), Keying.config({\n          initSize: {\n            numRows: numRows,\n            numColumns: numColumns\n          },\n          mode: 'flatgrid',\n          selector: '[role=\"button\"]'\n        })])\n      })]\n    };\n  };\n\n  var fancyMenuItems = {\n    inserttable: renderInsertTableMenuItem,\n    colorswatch: renderColorSwatchItem\n  };\n\n  var valueOpt = function (obj, key) {\n    return Object.prototype.hasOwnProperty.call(obj, key) ? Optional.some(obj[key]) : Optional.none();\n  };\n\n  var renderFancyMenuItem = function (spec, backstage) {\n    return valueOpt(fancyMenuItems, spec.fancytype).map(function (render) {\n      return render(spec, backstage);\n    });\n  };\n\n  var renderNestedItem = function (spec, itemResponse, providersBackstage, renderIcons, downwardsCaret) {\n    if (renderIcons === void 0) {\n      renderIcons = true;\n    }\n\n    if (downwardsCaret === void 0) {\n      downwardsCaret = false;\n    }\n\n    var caret = downwardsCaret ? renderDownwardsCaret(providersBackstage.icons) : renderSubmenuCaret(providersBackstage.icons);\n\n    var getApi = function (component) {\n      return {\n        isDisabled: function () {\n          return Disabling.isDisabled(component);\n        },\n        setDisabled: function (state) {\n          return Disabling.set(component, state);\n        }\n      };\n    };\n\n    var structure = renderItemStructure({\n      presets: 'normal',\n      iconContent: spec.icon,\n      textContent: spec.text,\n      htmlContent: Optional.none(),\n      ariaLabel: spec.text,\n      caret: Optional.some(caret),\n      checkMark: Optional.none(),\n      shortcutContent: spec.shortcut\n    }, providersBackstage, renderIcons);\n    return renderCommonItem({\n      data: buildData(spec),\n      getApi: getApi,\n      disabled: spec.disabled,\n      onAction: noop,\n      onSetup: spec.onSetup,\n      triggersSubmenu: true,\n      itemBehaviours: []\n    }, structure, itemResponse, providersBackstage);\n  };\n\n  var renderNormalItem = function (spec, itemResponse, providersBackstage, renderIcons) {\n    if (renderIcons === void 0) {\n      renderIcons = true;\n    }\n\n    var getApi = function (component) {\n      return {\n        isDisabled: function () {\n          return Disabling.isDisabled(component);\n        },\n        setDisabled: function (state) {\n          return Disabling.set(component, state);\n        }\n      };\n    };\n\n    var structure = renderItemStructure({\n      presets: 'normal',\n      iconContent: spec.icon,\n      textContent: spec.text,\n      htmlContent: Optional.none(),\n      ariaLabel: spec.text,\n      caret: Optional.none(),\n      checkMark: Optional.none(),\n      shortcutContent: spec.shortcut\n    }, providersBackstage, renderIcons);\n    return renderCommonItem({\n      data: buildData(spec),\n      getApi: getApi,\n      disabled: spec.disabled,\n      onAction: spec.onAction,\n      onSetup: spec.onSetup,\n      triggersSubmenu: false,\n      itemBehaviours: []\n    }, structure, itemResponse, providersBackstage);\n  };\n\n  var renderSeparatorItem = function (spec) {\n    var innerHtml = spec.text.fold(function () {\n      return {};\n    }, function (text) {\n      return {\n        innerHtml: text\n      };\n    });\n    return {\n      type: 'separator',\n      dom: __assign({\n        tag: 'div',\n        classes: [selectableClass, groupHeadingClass]\n      }, innerHtml),\n      components: []\n    };\n  };\n\n  var renderToggleMenuItem = function (spec, itemResponse, providersBackstage, renderIcons) {\n    if (renderIcons === void 0) {\n      renderIcons = true;\n    }\n\n    var getApi = function (component) {\n      return {\n        setActive: function (state) {\n          Toggling.set(component, state);\n        },\n        isActive: function () {\n          return Toggling.isOn(component);\n        },\n        isDisabled: function () {\n          return Disabling.isDisabled(component);\n        },\n        setDisabled: function (state) {\n          return Disabling.set(component, state);\n        }\n      };\n    };\n\n    var structure = renderItemStructure({\n      iconContent: spec.icon,\n      textContent: spec.text,\n      htmlContent: Optional.none(),\n      ariaLabel: spec.text,\n      checkMark: Optional.some(renderCheckmark(providersBackstage.icons)),\n      caret: Optional.none(),\n      shortcutContent: spec.shortcut,\n      presets: 'normal',\n      meta: spec.meta\n    }, providersBackstage, renderIcons);\n    return deepMerge(renderCommonItem({\n      data: buildData(spec),\n      disabled: spec.disabled,\n      getApi: getApi,\n      onAction: spec.onAction,\n      onSetup: spec.onSetup,\n      triggersSubmenu: false,\n      itemBehaviours: []\n    }, structure, itemResponse, providersBackstage), {\n      toggling: {\n        toggleClass: tickedClass,\n        toggleOnExecute: false,\n        selected: spec.active\n      }\n    });\n  };\n\n  var autocomplete = renderAutocompleteItem;\n  var separator = renderSeparatorItem;\n  var normal = renderNormalItem;\n  var nested = renderNestedItem;\n  var toggle$1 = renderToggleMenuItem;\n  var fancy = renderFancyMenuItem;\n  var card = renderCardMenuItem;\n  var FocusMode;\n\n  (function (FocusMode) {\n    FocusMode[FocusMode['ContentFocus'] = 0] = 'ContentFocus';\n    FocusMode[FocusMode['UiFocus'] = 1] = 'UiFocus';\n  })(FocusMode || (FocusMode = {}));\n\n  var createMenuItemFromBridge = function (item, itemResponse, backstage, menuHasIcons, isHorizontalMenu) {\n    var providersBackstage = backstage.shared.providers;\n\n    var parseForHorizontalMenu = function (menuitem) {\n      return !isHorizontalMenu ? menuitem : __assign(__assign({}, menuitem), {\n        shortcut: Optional.none(),\n        icon: menuitem.text.isSome() ? Optional.none() : menuitem.icon\n      });\n    };\n\n    switch (item.type) {\n      case 'menuitem':\n        return createMenuItem(item).fold(handleError, function (d) {\n          return Optional.some(normal(parseForHorizontalMenu(d), itemResponse, providersBackstage, menuHasIcons));\n        });\n\n      case 'nestedmenuitem':\n        return createNestedMenuItem(item).fold(handleError, function (d) {\n          return Optional.some(nested(parseForHorizontalMenu(d), itemResponse, providersBackstage, menuHasIcons, isHorizontalMenu));\n        });\n\n      case 'togglemenuitem':\n        return createToggleMenuItem(item).fold(handleError, function (d) {\n          return Optional.some(toggle$1(parseForHorizontalMenu(d), itemResponse, providersBackstage, menuHasIcons));\n        });\n\n      case 'separator':\n        return createSeparatorMenuItem(item).fold(handleError, function (d) {\n          return Optional.some(separator(d));\n        });\n\n      case 'fancymenuitem':\n        return createFancyMenuItem(item).fold(handleError, function (d) {\n          return fancy(parseForHorizontalMenu(d), backstage);\n        });\n\n      default:\n        {\n          console.error('Unknown item in general menu', item);\n          return Optional.none();\n        }\n    }\n  };\n\n  var createAutocompleteItems = function (items, matchText, onItemValueHandler, columns, itemResponse, sharedBackstage, highlightOn) {\n    var renderText = columns === 1;\n    var renderIcons = !renderText || menuHasIcons(items);\n    return cat(map(items, function (item) {\n      switch (item.type) {\n        case 'separator':\n          return createSeparatorItem(item).fold(handleError, function (d) {\n            return Optional.some(separator(d));\n          });\n\n        case 'cardmenuitem':\n          return createCardMenuItem(item).fold(handleError, function (d) {\n            return Optional.some(card(__assign(__assign({}, d), {\n              onAction: function (api) {\n                d.onAction(api);\n                onItemValueHandler(d.value, d.meta);\n              }\n            }), itemResponse, sharedBackstage, {\n              itemBehaviours: tooltipBehaviour(d.meta, sharedBackstage),\n              cardText: {\n                matchText: matchText,\n                highlightOn: highlightOn\n              }\n            }));\n          });\n\n        case 'autocompleteitem':\n        default:\n          return createAutocompleterItem(item).fold(handleError, function (d) {\n            return Optional.some(autocomplete(d, matchText, renderText, 'normal', onItemValueHandler, itemResponse, sharedBackstage, renderIcons));\n          });\n      }\n    }));\n  };\n\n  var createPartialMenu = function (value, items, itemResponse, backstage, isHorizontalMenu) {\n    var hasIcons = menuHasIcons(items);\n    var alloyItems = cat(map(items, function (item) {\n      var itemHasIcon = function (i) {\n        return isHorizontalMenu ? !i.hasOwnProperty('text') : hasIcons;\n      };\n\n      var createItem = function (i) {\n        return createMenuItemFromBridge(i, itemResponse, backstage, itemHasIcon(i), isHorizontalMenu);\n      };\n\n      if (item.type === 'nestedmenuitem' && item.getSubmenuItems().length <= 0) {\n        return createItem(__assign(__assign({}, item), {\n          disabled: true\n        }));\n      } else {\n        return createItem(item);\n      }\n    }));\n    var createPartial = isHorizontalMenu ? createHorizontalPartialMenuWithAlloyItems : createPartialMenuWithAlloyItems;\n    return createPartial(value, hasIcons, alloyItems, 1, 'normal');\n  };\n\n  var createTieredDataFrom = function (partialMenu) {\n    return tieredMenu.singleData(partialMenu.value, partialMenu);\n  };\n\n  var createMenuFrom = function (partialMenu, columns, focusMode, presets) {\n    var focusManager = focusMode === FocusMode.ContentFocus ? highlights() : dom();\n    var movement = deriveMenuMovement(columns, presets);\n    var menuMarkers = markers$1(presets);\n    return {\n      dom: partialMenu.dom,\n      components: partialMenu.components,\n      items: partialMenu.items,\n      value: partialMenu.value,\n      markers: {\n        selectedItem: menuMarkers.selectedItem,\n        item: menuMarkers.item\n      },\n      movement: movement,\n      fakeFocus: focusMode === FocusMode.ContentFocus,\n      focusManager: focusManager,\n      menuBehaviours: SimpleBehaviours.unnamedEvents(columns !== 'auto' ? [] : [runOnAttached(function (comp, _se) {\n        detectSize(comp, 4, menuMarkers.item).each(function (_a) {\n          var numColumns = _a.numColumns,\n              numRows = _a.numRows;\n          Keying.setGridSize(comp, numRows, numColumns);\n        });\n      })])\n    };\n  };\n\n  var register$2 = function (editor, sharedBackstage) {\n    var activeAutocompleter = Cell(Optional.none());\n    var processingAction = Cell(false);\n    var autocompleter = build$1(InlineView.sketch({\n      dom: {\n        tag: 'div',\n        classes: ['tox-autocompleter']\n      },\n      components: [],\n      fireDismissalEventInstead: {},\n      inlineBehaviours: derive$1([config('dismissAutocompleter', [run(dismissRequested(), function () {\n        return cancelIfNecessary();\n      })])]),\n      lazySink: sharedBackstage.getSink\n    }));\n\n    var isMenuOpen = function () {\n      return InlineView.isOpen(autocompleter);\n    };\n\n    var isActive = function () {\n      return activeAutocompleter.get().isSome();\n    };\n\n    var hideIfNecessary = function () {\n      if (isActive()) {\n        InlineView.hide(autocompleter);\n      }\n    };\n\n    var cancelIfNecessary = function () {\n      if (isActive()) {\n        var lastElement = activeAutocompleter.get().map(function (ac) {\n          return ac.element;\n        });\n        detect$4(lastElement.getOr(SugarElement.fromDom(editor.selection.getNode()))).each(unwrap);\n        hideIfNecessary();\n        activeAutocompleter.set(Optional.none());\n        processingAction.set(false);\n      }\n    };\n\n    var getAutocompleters = cached(function () {\n      return register(editor);\n    });\n\n    var getCombinedItems = function (triggerChar, matches) {\n      var columns = findMap(matches, function (m) {\n        return Optional.from(m.columns);\n      }).getOr(1);\n      return bind(matches, function (match) {\n        var choices = match.items;\n        return createAutocompleteItems(choices, match.matchText, function (itemValue, itemMeta) {\n          var nr = editor.selection.getRng();\n          getContext(editor.dom, nr, triggerChar).fold(function () {\n            return console.error('Lost context. Cursor probably moved');\n          }, function (_a) {\n            var range = _a.range;\n            var autocompleterApi = {\n              hide: function () {\n                cancelIfNecessary();\n              },\n              reload: function (fetchOptions) {\n                hideIfNecessary();\n                load(fetchOptions);\n              }\n            };\n            processingAction.set(true);\n            match.onAction(autocompleterApi, range, itemValue, itemMeta);\n            processingAction.set(false);\n          });\n        }, columns, ItemResponse$1.BUBBLE_TO_SANDBOX, sharedBackstage, match.highlightOn);\n      });\n    };\n\n    var commenceIfNecessary = function (context) {\n      if (!isActive()) {\n        var wrapper = create$4(editor, context.range);\n        activeAutocompleter.set(Optional.some({\n          triggerChar: context.triggerChar,\n          element: wrapper,\n          matchLength: context.text.length\n        }));\n        processingAction.set(false);\n      }\n    };\n\n    var display = function (ac, context, lookupData, items) {\n      ac.matchLength = context.text.length;\n      var columns = findMap(lookupData, function (ld) {\n        return Optional.from(ld.columns);\n      }).getOr(1);\n      InlineView.showAt(autocompleter, {\n        anchor: 'node',\n        root: SugarElement.fromDom(editor.getBody()),\n        node: Optional.from(ac.element)\n      }, Menu.sketch(createMenuFrom(createPartialMenuWithAlloyItems('autocompleter-value', true, items, columns, 'normal'), columns, FocusMode.ContentFocus, 'normal')));\n      InlineView.getContent(autocompleter).each(Highlighting.highlightFirst);\n    };\n\n    var doLookup = function (fetchOptions) {\n      return activeAutocompleter.get().map(function (ac) {\n        return getContext(editor.dom, editor.selection.getRng(), ac.triggerChar).bind(function (newContext) {\n          return lookupWithContext(editor, getAutocompleters, newContext, fetchOptions);\n        });\n      }).getOrThunk(function () {\n        return lookup(editor, getAutocompleters);\n      });\n    };\n\n    var load = function (fetchOptions) {\n      doLookup(fetchOptions).fold(cancelIfNecessary, function (lookupInfo) {\n        commenceIfNecessary(lookupInfo.context);\n        lookupInfo.lookupData.then(function (lookupData) {\n          activeAutocompleter.get().map(function (ac) {\n            var context = lookupInfo.context;\n\n            if (ac.triggerChar === context.triggerChar) {\n              var combinedItems = getCombinedItems(context.triggerChar, lookupData);\n\n              if (combinedItems.length > 0) {\n                display(ac, context, lookupData, combinedItems);\n              } else if (context.text.length - ac.matchLength >= 10) {\n                cancelIfNecessary();\n              } else {\n                hideIfNecessary();\n              }\n            }\n          });\n        });\n      });\n    };\n\n    var onKeypress = last$2(function (e) {\n      if (e.which === 27) {\n        return;\n      }\n\n      load();\n    }, 50);\n    var autocompleterUiApi = {\n      onKeypress: onKeypress,\n      cancelIfNecessary: cancelIfNecessary,\n      isMenuOpen: isMenuOpen,\n      isActive: isActive,\n      isProcessingAction: processingAction.get,\n      getView: function () {\n        return InlineView.getContent(autocompleter);\n      }\n    };\n\n    if (editor.hasPlugin('rtc') === false) {\n      AutocompleterEditorEvents.setup(autocompleterUiApi, editor);\n    }\n  };\n\n  var Autocompleter = {\n    register: register$2\n  };\n  var filter$2 = always;\n\n  var bind$3 = function (element, event, handler) {\n    return bind$2(element, event, filter$2, handler);\n  };\n\n  var capture$1 = function (element, event, handler) {\n    return capture(element, event, filter$2, handler);\n  };\n\n  var fromRawEvent$1 = fromRawEvent;\n\n  var closest$4 = function (scope, selector, isRoot) {\n    return closest$3(scope, selector, isRoot).isSome();\n  };\n\n  var DelayedFunction = function (fun, delay) {\n    var ref = null;\n\n    var schedule = function () {\n      var args = [];\n\n      for (var _i = 0; _i < arguments.length; _i++) {\n        args[_i] = arguments[_i];\n      }\n\n      ref = setTimeout(function () {\n        fun.apply(null, args);\n        ref = null;\n      }, delay);\n    };\n\n    var cancel = function () {\n      if (ref !== null) {\n        clearTimeout(ref);\n        ref = null;\n      }\n    };\n\n    return {\n      cancel: cancel,\n      schedule: schedule\n    };\n  };\n\n  var SIGNIFICANT_MOVE = 5;\n  var LONGPRESS_DELAY = 400;\n\n  var getTouch = function (event) {\n    var raw = event.raw;\n\n    if (raw.touches === undefined || raw.touches.length !== 1) {\n      return Optional.none();\n    }\n\n    return Optional.some(raw.touches[0]);\n  };\n\n  var isFarEnough = function (touch, data) {\n    var distX = Math.abs(touch.clientX - data.x);\n    var distY = Math.abs(touch.clientY - data.y);\n    return distX > SIGNIFICANT_MOVE || distY > SIGNIFICANT_MOVE;\n  };\n\n  var monitor = function (settings) {\n    var startData = Cell(Optional.none());\n    var longpressFired = Cell(false);\n    var longpress$1 = DelayedFunction(function (event) {\n      settings.triggerEvent(longpress(), event);\n      longpressFired.set(true);\n    }, LONGPRESS_DELAY);\n\n    var handleTouchstart = function (event) {\n      getTouch(event).each(function (touch) {\n        longpress$1.cancel();\n        var data = {\n          x: touch.clientX,\n          y: touch.clientY,\n          target: event.target\n        };\n        longpress$1.schedule(event);\n        longpressFired.set(false);\n        startData.set(Optional.some(data));\n      });\n      return Optional.none();\n    };\n\n    var handleTouchmove = function (event) {\n      longpress$1.cancel();\n      getTouch(event).each(function (touch) {\n        startData.get().each(function (data) {\n          if (isFarEnough(touch, data)) {\n            startData.set(Optional.none());\n          }\n        });\n      });\n      return Optional.none();\n    };\n\n    var handleTouchend = function (event) {\n      longpress$1.cancel();\n\n      var isSame = function (data) {\n        return eq$1(data.target, event.target);\n      };\n\n      return startData.get().filter(isSame).map(function (_data) {\n        if (longpressFired.get()) {\n          event.prevent();\n          return false;\n        } else {\n          return settings.triggerEvent(tap(), event);\n        }\n      });\n    };\n\n    var handlers = wrapAll$1([{\n      key: touchstart(),\n      value: handleTouchstart\n    }, {\n      key: touchmove(),\n      value: handleTouchmove\n    }, {\n      key: touchend(),\n      value: handleTouchend\n    }]);\n\n    var fireIfReady = function (event, type) {\n      return get$1(handlers, type).bind(function (handler) {\n        return handler(event);\n      });\n    };\n\n    return {\n      fireIfReady: fireIfReady\n    };\n  };\n\n  var isDangerous = function (event) {\n    var keyEv = event.raw;\n    return keyEv.which === BACKSPACE[0] && !contains(['input', 'textarea'], name(event.target)) && !closest$4(event.target, '[contenteditable=\"true\"]');\n  };\n\n  var isFirefox = function () {\n    return detect$3().browser.isFirefox();\n  };\n\n  var settingsSchema = objOfOnly([strictFunction('triggerEvent'), defaulted$1('stopBackspace', true)]);\n\n  var bindFocus = function (container, handler) {\n    if (isFirefox()) {\n      return capture$1(container, 'focus', handler);\n    } else {\n      return bind$3(container, 'focusin', handler);\n    }\n  };\n\n  var bindBlur = function (container, handler) {\n    if (isFirefox()) {\n      return capture$1(container, 'blur', handler);\n    } else {\n      return bind$3(container, 'focusout', handler);\n    }\n  };\n\n  var setup$1 = function (container, rawSettings) {\n    var settings = asRawOrDie('Getting GUI events settings', settingsSchema, rawSettings);\n    var pointerEvents = ['touchstart', 'touchmove', 'touchend', 'touchcancel', 'gesturestart', 'mousedown', 'mouseup', 'mouseover', 'mousemove', 'mouseout', 'click'];\n    var tapEvent = monitor(settings);\n    var simpleEvents = map(pointerEvents.concat(['selectstart', 'input', 'contextmenu', 'change', 'transitionend', 'drag', 'dragstart', 'dragend', 'dragenter', 'dragleave', 'dragover', 'drop', 'keyup']), function (type) {\n      return bind$3(container, type, function (event) {\n        tapEvent.fireIfReady(event, type).each(function (tapStopped) {\n          if (tapStopped) {\n            event.kill();\n          }\n        });\n        var stopped = settings.triggerEvent(type, event);\n\n        if (stopped) {\n          event.kill();\n        }\n      });\n    });\n    var pasteTimeout = Cell(Optional.none());\n    var onPaste = bind$3(container, 'paste', function (event) {\n      tapEvent.fireIfReady(event, 'paste').each(function (tapStopped) {\n        if (tapStopped) {\n          event.kill();\n        }\n      });\n      var stopped = settings.triggerEvent('paste', event);\n\n      if (stopped) {\n        event.kill();\n      }\n\n      pasteTimeout.set(Optional.some(setTimeout(function () {\n        settings.triggerEvent(postPaste(), event);\n      }, 0)));\n    });\n    var onKeydown = bind$3(container, 'keydown', function (event) {\n      var stopped = settings.triggerEvent('keydown', event);\n\n      if (stopped) {\n        event.kill();\n      } else if (settings.stopBackspace === true && isDangerous(event)) {\n        event.prevent();\n      }\n    });\n    var onFocusIn = bindFocus(container, function (event) {\n      var stopped = settings.triggerEvent('focusin', event);\n\n      if (stopped) {\n        event.kill();\n      }\n    });\n    var focusoutTimeout = Cell(Optional.none());\n    var onFocusOut = bindBlur(container, function (event) {\n      var stopped = settings.triggerEvent('focusout', event);\n\n      if (stopped) {\n        event.kill();\n      }\n\n      focusoutTimeout.set(Optional.some(setTimeout(function () {\n        settings.triggerEvent(postBlur(), event);\n      }, 0)));\n    });\n\n    var unbind = function () {\n      each(simpleEvents, function (e) {\n        e.unbind();\n      });\n      onKeydown.unbind();\n      onFocusIn.unbind();\n      onFocusOut.unbind();\n      onPaste.unbind();\n      pasteTimeout.get().each(clearTimeout);\n      focusoutTimeout.get().each(clearTimeout);\n    };\n\n    return {\n      unbind: unbind\n    };\n  };\n\n  var derive$2 = function (rawEvent, rawTarget) {\n    var source = get$1(rawEvent, 'target').getOr(rawTarget);\n    return Cell(source);\n  };\n\n  var fromSource = function (event, source) {\n    var stopper = Cell(false);\n    var cutter = Cell(false);\n\n    var stop = function () {\n      stopper.set(true);\n    };\n\n    var cut = function () {\n      cutter.set(true);\n    };\n\n    return {\n      stop: stop,\n      cut: cut,\n      isStopped: stopper.get,\n      isCut: cutter.get,\n      event: event,\n      setSource: source.set,\n      getSource: source.get\n    };\n  };\n\n  var fromExternal = function (event) {\n    var stopper = Cell(false);\n\n    var stop = function () {\n      stopper.set(true);\n    };\n\n    return {\n      stop: stop,\n      cut: noop,\n      isStopped: stopper.get,\n      isCut: never,\n      event: event,\n      setSource: die('Cannot set source of a broadcasted event'),\n      getSource: die('Cannot get source of a broadcasted event')\n    };\n  };\n\n  var adt$b = Adt.generate([{\n    stopped: []\n  }, {\n    resume: ['element']\n  }, {\n    complete: []\n  }]);\n\n  var doTriggerHandler = function (lookup, eventType, rawEvent, target, source, logger) {\n    var handler = lookup(eventType, target);\n    var simulatedEvent = fromSource(rawEvent, source);\n    return handler.fold(function () {\n      logger.logEventNoHandlers(eventType, target);\n      return adt$b.complete();\n    }, function (handlerInfo) {\n      var descHandler = handlerInfo.descHandler;\n      var eventHandler = getCurried(descHandler);\n      eventHandler(simulatedEvent);\n\n      if (simulatedEvent.isStopped()) {\n        logger.logEventStopped(eventType, handlerInfo.element, descHandler.purpose);\n        return adt$b.stopped();\n      } else if (simulatedEvent.isCut()) {\n        logger.logEventCut(eventType, handlerInfo.element, descHandler.purpose);\n        return adt$b.complete();\n      } else {\n        return parent(handlerInfo.element).fold(function () {\n          logger.logNoParent(eventType, handlerInfo.element, descHandler.purpose);\n          return adt$b.complete();\n        }, function (parent) {\n          logger.logEventResponse(eventType, handlerInfo.element, descHandler.purpose);\n          return adt$b.resume(parent);\n        });\n      }\n    });\n  };\n\n  var doTriggerOnUntilStopped = function (lookup, eventType, rawEvent, rawTarget, source, logger) {\n    return doTriggerHandler(lookup, eventType, rawEvent, rawTarget, source, logger).fold(always, function (parent) {\n      return doTriggerOnUntilStopped(lookup, eventType, rawEvent, parent, source, logger);\n    }, never);\n  };\n\n  var triggerHandler = function (lookup, eventType, rawEvent, target, logger) {\n    var source = derive$2(rawEvent, target);\n    return doTriggerHandler(lookup, eventType, rawEvent, target, source, logger);\n  };\n\n  var broadcast = function (listeners, rawEvent, _logger) {\n    var simulatedEvent = fromExternal(rawEvent);\n    each(listeners, function (listener) {\n      var descHandler = listener.descHandler;\n      var handler = getCurried(descHandler);\n      handler(simulatedEvent);\n    });\n    return simulatedEvent.isStopped();\n  };\n\n  var triggerUntilStopped = function (lookup, eventType, rawEvent, logger) {\n    return triggerOnUntilStopped(lookup, eventType, rawEvent, rawEvent.target, logger);\n  };\n\n  var triggerOnUntilStopped = function (lookup, eventType, rawEvent, rawTarget, logger) {\n    var source = derive$2(rawEvent, rawTarget);\n    return doTriggerOnUntilStopped(lookup, eventType, rawEvent, rawTarget, source, logger);\n  };\n\n  var eventHandler = function (element, descHandler) {\n    return {\n      element: element,\n      descHandler: descHandler\n    };\n  };\n\n  var broadcastHandler = function (id, handler) {\n    return {\n      id: id,\n      descHandler: handler\n    };\n  };\n\n  var EventRegistry = function () {\n    var registry = {};\n\n    var registerId = function (extraArgs, id, events) {\n      each$1(events, function (v, k) {\n        var handlers = registry[k] !== undefined ? registry[k] : {};\n        handlers[id] = curryArgs(v, extraArgs);\n        registry[k] = handlers;\n      });\n    };\n\n    var findHandler = function (handlers, elem) {\n      return read$1(elem).fold(function () {\n        return Optional.none();\n      }, function (id) {\n        return handlers.bind(function (h) {\n          return get$1(h, id);\n        }).map(function (descHandler) {\n          return eventHandler(elem, descHandler);\n        });\n      });\n    };\n\n    var filterByType = function (type) {\n      return get$1(registry, type).map(function (handlers) {\n        return mapToArray(handlers, function (f, id) {\n          return broadcastHandler(id, f);\n        });\n      }).getOr([]);\n    };\n\n    var find = function (isAboveRoot, type, target) {\n      var handlers = get$1(registry, type);\n      return closest(target, function (elem) {\n        return findHandler(handlers, elem);\n      }, isAboveRoot);\n    };\n\n    var unregisterId = function (id) {\n      each$1(registry, function (handlersById, _eventName) {\n        if (handlersById.hasOwnProperty(id)) {\n          delete handlersById[id];\n        }\n      });\n    };\n\n    return {\n      registerId: registerId,\n      unregisterId: unregisterId,\n      filterByType: filterByType,\n      find: find\n    };\n  };\n\n  var Registry = function () {\n    var events = EventRegistry();\n    var components = {};\n\n    var readOrTag = function (component) {\n      var elem = component.element;\n      return read$1(elem).fold(function () {\n        return write('uid-', component.element);\n      }, function (uid) {\n        return uid;\n      });\n    };\n\n    var failOnDuplicate = function (component, tagId) {\n      var conflict = components[tagId];\n\n      if (conflict === component) {\n        unregister(component);\n      } else {\n        throw new Error('The tagId \"' + tagId + '\" is already used by: ' + element(conflict.element) + '\\nCannot use it for: ' + element(component.element) + '\\n' + 'The conflicting element is' + (inBody(conflict.element) ? ' ' : ' not ') + 'already in the DOM');\n      }\n    };\n\n    var register = function (component) {\n      var tagId = readOrTag(component);\n\n      if (hasNonNullableKey(components, tagId)) {\n        failOnDuplicate(component, tagId);\n      }\n\n      var extraArgs = [component];\n      events.registerId(extraArgs, tagId, component.events);\n      components[tagId] = component;\n    };\n\n    var unregister = function (component) {\n      read$1(component.element).each(function (tagId) {\n        delete components[tagId];\n        events.unregisterId(tagId);\n      });\n    };\n\n    var filter = function (type) {\n      return events.filterByType(type);\n    };\n\n    var find = function (isAboveRoot, type, target) {\n      return events.find(isAboveRoot, type, target);\n    };\n\n    var getById = function (id) {\n      return get$1(components, id);\n    };\n\n    return {\n      find: find,\n      filter: filter,\n      register: register,\n      unregister: unregister,\n      getById: getById\n    };\n  };\n\n  var factory$3 = function (detail) {\n    var _a = detail.dom,\n        attributes = _a.attributes,\n        domWithoutAttributes = __rest(_a, ['attributes']);\n\n    return {\n      uid: detail.uid,\n      dom: __assign({\n        tag: 'div',\n        attributes: __assign({\n          role: 'presentation'\n        }, attributes)\n      }, domWithoutAttributes),\n      components: detail.components,\n      behaviours: get$d(detail.containerBehaviours),\n      events: detail.events,\n      domModification: detail.domModification,\n      eventOrder: detail.eventOrder\n    };\n  };\n\n  var Container = single$2({\n    name: 'Container',\n    factory: factory$3,\n    configFields: [defaulted$1('components', []), field$1('containerBehaviours', []), defaulted$1('events', {}), defaulted$1('domModification', {}), defaulted$1('eventOrder', {})]\n  });\n\n  var takeover = function (root) {\n    var isAboveRoot = function (el) {\n      return parent(root.element).fold(always, function (parent) {\n        return eq$1(el, parent);\n      });\n    };\n\n    var registry = Registry();\n\n    var lookup = function (eventName, target) {\n      return registry.find(isAboveRoot, eventName, target);\n    };\n\n    var domEvents = setup$1(root.element, {\n      triggerEvent: function (eventName, event) {\n        return monitorEvent(eventName, event.target, function (logger) {\n          return triggerUntilStopped(lookup, eventName, event, logger);\n        });\n      }\n    });\n    var systemApi = {\n      debugInfo: constant('real'),\n      triggerEvent: function (eventName, target, data) {\n        monitorEvent(eventName, target, function (logger) {\n          return triggerOnUntilStopped(lookup, eventName, data, target, logger);\n        });\n      },\n      triggerFocus: function (target, originator) {\n        read$1(target).fold(function () {\n          focus$1(target);\n        }, function (_alloyId) {\n          monitorEvent(focus(), target, function (logger) {\n            triggerHandler(lookup, focus(), {\n              originator: originator,\n              kill: noop,\n              prevent: noop,\n              target: target\n            }, target, logger);\n            return false;\n          });\n        });\n      },\n      triggerEscape: function (comp, simulatedEvent) {\n        systemApi.triggerEvent('keydown', comp.element, simulatedEvent.event);\n      },\n      getByUid: function (uid) {\n        return getByUid(uid);\n      },\n      getByDom: function (elem) {\n        return getByDom(elem);\n      },\n      build: build$1,\n      addToGui: function (c) {\n        add(c);\n      },\n      removeFromGui: function (c) {\n        remove$1(c);\n      },\n      addToWorld: function (c) {\n        addToWorld(c);\n      },\n      removeFromWorld: function (c) {\n        removeFromWorld(c);\n      },\n      broadcast: function (message) {\n        broadcast$1(message);\n      },\n      broadcastOn: function (channels, message) {\n        broadcastOn(channels, message);\n      },\n      broadcastEvent: function (eventName, event) {\n        broadcastEvent(eventName, event);\n      },\n      isConnected: always\n    };\n\n    var addToWorld = function (component) {\n      component.connect(systemApi);\n\n      if (!isText(component.element)) {\n        registry.register(component);\n        each(component.components(), addToWorld);\n        systemApi.triggerEvent(systemInit(), component.element, {\n          target: component.element\n        });\n      }\n    };\n\n    var removeFromWorld = function (component) {\n      if (!isText(component.element)) {\n        each(component.components(), removeFromWorld);\n        registry.unregister(component);\n      }\n\n      component.disconnect();\n    };\n\n    var add = function (component) {\n      attach$1(root, component);\n    };\n\n    var remove$1 = function (component) {\n      detach(component);\n    };\n\n    var destroy = function () {\n      domEvents.unbind();\n      remove(root.element);\n    };\n\n    var broadcastData = function (data) {\n      var receivers = registry.filter(receive());\n      each(receivers, function (receiver) {\n        var descHandler = receiver.descHandler;\n        var handler = getCurried(descHandler);\n        handler(data);\n      });\n    };\n\n    var broadcast$1 = function (message) {\n      broadcastData({\n        universal: true,\n        data: message\n      });\n    };\n\n    var broadcastOn = function (channels, message) {\n      broadcastData({\n        universal: false,\n        channels: channels,\n        data: message\n      });\n    };\n\n    var broadcastEvent = function (eventName, event) {\n      var listeners = registry.filter(eventName);\n      return broadcast(listeners, event);\n    };\n\n    var getByUid = function (uid) {\n      return registry.getById(uid).fold(function () {\n        return Result.error(new Error('Could not find component with uid: \"' + uid + '\" in system.'));\n      }, Result.value);\n    };\n\n    var getByDom = function (elem) {\n      var uid = read$1(elem).getOr('not found');\n      return getByUid(uid);\n    };\n\n    addToWorld(root);\n    return {\n      root: root,\n      element: root.element,\n      destroy: destroy,\n      add: add,\n      remove: remove$1,\n      getByUid: getByUid,\n      getByDom: getByDom,\n      addToWorld: addToWorld,\n      removeFromWorld: removeFromWorld,\n      broadcast: broadcast$1,\n      broadcastOn: broadcastOn,\n      broadcastEvent: broadcastEvent\n    };\n  };\n\n  var renderBar = function (spec, backstage) {\n    return {\n      dom: {\n        tag: 'div',\n        classes: ['tox-bar', 'tox-form__controls-h-stack']\n      },\n      components: map(spec.items, backstage.interpreter)\n    };\n  };\n\n  var schema$e = constant([defaulted$1('prefix', 'form-field'), field$1('fieldBehaviours', [Composing, Representing])]);\n  var parts$3 = constant([optional({\n    schema: [strict$1('dom')],\n    name: 'label'\n  }), optional({\n    factory: {\n      sketch: function (spec) {\n        return {\n          uid: spec.uid,\n          dom: {\n            tag: 'span',\n            styles: {\n              display: 'none'\n            },\n            attributes: {\n              'aria-hidden': 'true'\n            },\n            innerHtml: spec.text\n          }\n        };\n      }\n    },\n    schema: [strict$1('text')],\n    name: 'aria-descriptor'\n  }), required({\n    factory: {\n      sketch: function (spec) {\n        var excludeFactory = exclude$1(spec, ['factory']);\n        return spec.factory.sketch(excludeFactory);\n      }\n    },\n    schema: [strict$1('factory')],\n    name: 'field'\n  })]);\n\n  var factory$4 = function (detail, components, _spec, _externals) {\n    var behaviours = augment(detail.fieldBehaviours, [Composing.config({\n      find: function (container) {\n        return getPart(container, detail, 'field');\n      }\n    }), Representing.config({\n      store: {\n        mode: 'manual',\n        getValue: function (field) {\n          return Composing.getCurrent(field).bind(Representing.getValue);\n        },\n        setValue: function (field, value) {\n          Composing.getCurrent(field).each(function (current) {\n            Representing.setValue(current, value);\n          });\n        }\n      }\n    })]);\n    var events = derive([runOnAttached(function (component, _simulatedEvent) {\n      var ps = getParts(component, detail, ['label', 'field', 'aria-descriptor']);\n      ps.field().each(function (field) {\n        var id = generate$1(detail.prefix);\n        ps.label().each(function (label) {\n          set$1(label.element, 'for', id);\n          set$1(field.element, 'id', id);\n        });\n        ps['aria-descriptor']().each(function (descriptor) {\n          var descriptorId = generate$1(detail.prefix);\n          set$1(descriptor.element, 'id', descriptorId);\n          set$1(field.element, 'aria-describedby', descriptorId);\n        });\n      });\n    })]);\n    var apis = {\n      getField: function (container) {\n        return getPart(container, detail, 'field');\n      },\n      getLabel: function (container) {\n        return getPart(container, detail, 'label');\n      }\n    };\n    return {\n      uid: detail.uid,\n      dom: detail.dom,\n      components: components,\n      behaviours: behaviours,\n      events: events,\n      apis: apis\n    };\n  };\n\n  var FormField = composite$1({\n    name: 'FormField',\n    configFields: schema$e(),\n    partFields: parts$3(),\n    factory: factory$4,\n    apis: {\n      getField: function (apis, comp) {\n        return apis.getField(comp);\n      },\n      getLabel: function (apis, comp) {\n        return apis.getLabel(comp);\n      }\n    }\n  });\n\n  var exhibit$4 = function (base, tabConfig) {\n    return nu$6({\n      attributes: wrapAll$1([{\n        key: tabConfig.tabAttr,\n        value: 'true'\n      }])\n    });\n  };\n\n  var ActiveTabstopping = /*#__PURE__*/Object.freeze({\n    __proto__: null,\n    exhibit: exhibit$4\n  });\n  var TabstopSchema = [defaulted$1('tabAttr', 'data-alloy-tabstop')];\n  var Tabstopping = create$1({\n    fields: TabstopSchema,\n    name: 'tabstopping',\n    active: ActiveTabstopping\n  });\n  var global$a = tinymce.util.Tools.resolve('tinymce.html.Entities');\n\n  var renderFormFieldWith = function (pLabel, pField, extraClasses, extraBehaviours) {\n    var spec = renderFormFieldSpecWith(pLabel, pField, extraClasses, extraBehaviours);\n    return FormField.sketch(spec);\n  };\n\n  var renderFormField = function (pLabel, pField) {\n    return renderFormFieldWith(pLabel, pField, [], []);\n  };\n\n  var renderFormFieldSpecWith = function (pLabel, pField, extraClasses, extraBehaviours) {\n    return {\n      dom: renderFormFieldDomWith(extraClasses),\n      components: pLabel.toArray().concat([pField]),\n      fieldBehaviours: derive$1(extraBehaviours)\n    };\n  };\n\n  var renderFormFieldDom = function () {\n    return renderFormFieldDomWith([]);\n  };\n\n  var renderFormFieldDomWith = function (extraClasses) {\n    return {\n      tag: 'div',\n      classes: ['tox-form__group'].concat(extraClasses)\n    };\n  };\n\n  var renderLabel = function (label, providersBackstage) {\n    return FormField.parts.label({\n      dom: {\n        tag: 'label',\n        classes: ['tox-label'],\n        innerHtml: providersBackstage.translate(label)\n      }\n    });\n  };\n\n  var formChangeEvent = generate$1('form-component-change');\n  var formCloseEvent = generate$1('form-close');\n  var formCancelEvent = generate$1('form-cancel');\n  var formActionEvent = generate$1('form-action');\n  var formSubmitEvent = generate$1('form-submit');\n  var formBlockEvent = generate$1('form-block');\n  var formUnblockEvent = generate$1('form-unblock');\n  var formTabChangeEvent = generate$1('form-tabchange');\n  var formResizeEvent = generate$1('form-resize');\n\n  var renderCollection = function (spec, providersBackstage) {\n    var _a;\n\n    var pLabel = spec.label.map(function (label) {\n      return renderLabel(label, providersBackstage);\n    });\n\n    var runOnItem = function (f) {\n      return function (comp, se) {\n        closest$3(se.event.target, '[data-collection-item-value]').each(function (target) {\n          f(comp, se, target, get$3(target, 'data-collection-item-value'));\n        });\n      };\n    };\n\n    var setContents = function (comp, items) {\n      var htmlLines = map(items, function (item) {\n        var itemText = global$6.translate(item.text);\n        var textContent = spec.columns === 1 ? '<div class=\"tox-collection__item-label\">' + itemText + '</div>' : '';\n        var iconContent = '<div class=\"tox-collection__item-icon\">' + item.icon + '</div>';\n        var mapItemName = {\n          '_': ' ',\n          ' - ': ' ',\n          '-': ' '\n        };\n        var ariaLabel = itemText.replace(/\\_| \\- |\\-/g, function (match) {\n          return mapItemName[match];\n        });\n        var disabledClass = providersBackstage.isDisabled() ? ' tox-collection__item--state-disabled' : '';\n        return '<div class=\"tox-collection__item' + disabledClass + '\" tabindex=\"-1\" data-collection-item-value=\"' + global$a.encodeAllRaw(item.value) + '\" title=\"' + ariaLabel + '\" aria-label=\"' + ariaLabel + '\">' + iconContent + textContent + '</div>';\n      });\n      var chunks = spec.columns !== 'auto' && spec.columns > 1 ? chunk(htmlLines, spec.columns) : [htmlLines];\n      var html = map(chunks, function (ch) {\n        return '<div class=\"tox-collection__group\">' + ch.join('') + '</div>';\n      });\n      set(comp.element, html.join(''));\n    };\n\n    var onClick = runOnItem(function (comp, se, tgt, itemValue) {\n      se.stop();\n\n      if (!providersBackstage.isDisabled()) {\n        emitWith(comp, formActionEvent, {\n          name: spec.name,\n          value: itemValue\n        });\n      }\n    });\n    var collectionEvents = [run(mouseover(), runOnItem(function (comp, se, tgt) {\n      focus$1(tgt);\n    })), run(click(), onClick), run(tap(), onClick), run(focusin(), runOnItem(function (comp, se, tgt) {\n      descendant$1(comp.element, '.' + activeClass).each(function (currentActive) {\n        remove$4(currentActive, activeClass);\n      });\n      add$2(tgt, activeClass);\n    })), run(focusout(), runOnItem(function (comp) {\n      descendant$1(comp.element, '.' + activeClass).each(function (currentActive) {\n        remove$4(currentActive, activeClass);\n      });\n    })), runOnExecute(runOnItem(function (comp, se, tgt, itemValue) {\n      emitWith(comp, formActionEvent, {\n        name: spec.name,\n        value: itemValue\n      });\n    }))];\n\n    var iterCollectionItems = function (comp, applyAttributes) {\n      return map(descendants(comp.element, '.tox-collection__item'), applyAttributes);\n    };\n\n    var pField = FormField.parts.field({\n      dom: {\n        tag: 'div',\n        classes: ['tox-collection'].concat(spec.columns !== 1 ? ['tox-collection--grid'] : ['tox-collection--list'])\n      },\n      components: [],\n      factory: {\n        sketch: identity\n      },\n      behaviours: derive$1([Disabling.config({\n        disabled: providersBackstage.isDisabled,\n        onDisabled: function (comp) {\n          iterCollectionItems(comp, function (childElm) {\n            add$2(childElm, 'tox-collection__item--state-disabled');\n            set$1(childElm, 'aria-disabled', true);\n          });\n        },\n        onEnabled: function (comp) {\n          iterCollectionItems(comp, function (childElm) {\n            remove$4(childElm, 'tox-collection__item--state-disabled');\n            remove$1(childElm, 'aria-disabled');\n          });\n        }\n      }), receivingConfig(), Replacing.config({}), Representing.config({\n        store: {\n          mode: 'memory',\n          initialValue: []\n        },\n        onSetValue: function (comp, items) {\n          setContents(comp, items);\n\n          if (spec.columns === 'auto') {\n            detectSize(comp, 5, 'tox-collection__item').each(function (_a) {\n              var numRows = _a.numRows,\n                  numColumns = _a.numColumns;\n              Keying.setGridSize(comp, numRows, numColumns);\n            });\n          }\n\n          emit(comp, formResizeEvent);\n        }\n      }), Tabstopping.config({}), Keying.config(deriveCollectionMovement(spec.columns, 'normal')), config('collection-events', collectionEvents)]),\n      eventOrder: (_a = {}, _a[execute()] = ['disabling', 'alloy.base.behaviour', 'collection-events'], _a)\n    });\n    var extraClasses = ['tox-form__group--collection'];\n    return renderFormFieldWith(pLabel, pField, extraClasses, []);\n  };\n\n  var schema$f = constant([option('data'), defaulted$1('inputAttributes', {}), defaulted$1('inputStyles', {}), defaulted$1('tag', 'input'), defaulted$1('inputClasses', []), onHandler('onSetValue'), defaulted$1('styles', {}), defaulted$1('eventOrder', {}), field$1('inputBehaviours', [Representing, Focusing]), defaulted$1('selectOnFocus', true)]);\n\n  var focusBehaviours = function (detail) {\n    return derive$1([Focusing.config({\n      onFocus: !detail.selectOnFocus ? noop : function (component) {\n        var input = component.element;\n        var value = get$6(input);\n        input.dom.setSelectionRange(0, value.length);\n      }\n    })]);\n  };\n\n  var behaviours = function (detail) {\n    return __assign(__assign({}, focusBehaviours(detail)), augment(detail.inputBehaviours, [Representing.config({\n      store: __assign(__assign({\n        mode: 'manual'\n      }, detail.data.map(function (data) {\n        return {\n          initialValue: data\n        };\n      }).getOr({})), {\n        getValue: function (input) {\n          return get$6(input.element);\n        },\n        setValue: function (input, data) {\n          var current = get$6(input.element);\n\n          if (current !== data) {\n            set$3(input.element, data);\n          }\n        }\n      }),\n      onSetValue: detail.onSetValue\n    })]));\n  };\n\n  var dom$2 = function (detail) {\n    return {\n      tag: detail.tag,\n      attributes: __assign({\n        type: 'text'\n      }, detail.inputAttributes),\n      styles: detail.inputStyles,\n      classes: detail.inputClasses\n    };\n  };\n\n  var factory$5 = function (detail, _spec) {\n    return {\n      uid: detail.uid,\n      dom: dom$2(detail),\n      components: [],\n      behaviours: behaviours(detail),\n      eventOrder: detail.eventOrder\n    };\n  };\n\n  var Input = single$2({\n    name: 'Input',\n    configFields: schema$f(),\n    factory: factory$5\n  });\n  var exports$1 = {},\n      module = {\n    exports: exports$1\n  };\n\n  (function (define, exports, module, require) {\n    (function (f) {\n      if (typeof exports === 'object' && typeof module !== 'undefined') {\n        module.exports = f();\n      } else if (typeof define === 'function' && define.amd) {\n        define([], f);\n      } else {\n        var g;\n\n        if (typeof window !== 'undefined') {\n          g = window;\n        } else if (typeof global !== 'undefined') {\n          g = global;\n        } else if (typeof self !== 'undefined') {\n          g = self;\n        } else {\n          g = this;\n        }\n\n        g.EphoxContactWrapper = f();\n      }\n    })(function () {\n      return function () {\n        function r(e, n, t) {\n          function o(i, f) {\n            if (!n[i]) {\n              if (!e[i]) {\n                var c = 'function' == typeof require && require;\n                if (!f && c) return c(i, !0);\n                if (u) return u(i, !0);\n                var a = new Error('Cannot find module \\'' + i + '\\'');\n                throw a.code = 'MODULE_NOT_FOUND', a;\n              }\n\n              var p = n[i] = {\n                exports: {}\n              };\n              e[i][0].call(p.exports, function (r) {\n                var n = e[i][1][r];\n                return o(n || r);\n              }, p, p.exports, r, e, n, t);\n            }\n\n            return n[i].exports;\n          }\n\n          for (var u = 'function' == typeof require && require, i = 0; i < t.length; i++) o(t[i]);\n\n          return o;\n        }\n\n        return r;\n      }()({\n        1: [function (require, module, exports) {\n          var process = module.exports = {};\n          var cachedSetTimeout;\n          var cachedClearTimeout;\n\n          function defaultSetTimout() {\n            throw new Error('setTimeout has not been defined');\n          }\n\n          function defaultClearTimeout() {\n            throw new Error('clearTimeout has not been defined');\n          }\n\n          (function () {\n            try {\n              if (typeof setTimeout === 'function') {\n                cachedSetTimeout = setTimeout;\n              } else {\n                cachedSetTimeout = defaultSetTimout;\n              }\n            } catch (e) {\n              cachedSetTimeout = defaultSetTimout;\n            }\n\n            try {\n              if (typeof clearTimeout === 'function') {\n                cachedClearTimeout = clearTimeout;\n              } else {\n                cachedClearTimeout = defaultClearTimeout;\n              }\n            } catch (e) {\n              cachedClearTimeout = defaultClearTimeout;\n            }\n          })();\n\n          function runTimeout(fun) {\n            if (cachedSetTimeout === setTimeout) {\n              return setTimeout(fun, 0);\n            }\n\n            if ((cachedSetTimeout === defaultSetTimout || !cachedSetTimeout) && setTimeout) {\n              cachedSetTimeout = setTimeout;\n              return setTimeout(fun, 0);\n            }\n\n            try {\n              return cachedSetTimeout(fun, 0);\n            } catch (e) {\n              try {\n                return cachedSetTimeout.call(null, fun, 0);\n              } catch (e) {\n                return cachedSetTimeout.call(this, fun, 0);\n              }\n            }\n          }\n\n          function runClearTimeout(marker) {\n            if (cachedClearTimeout === clearTimeout) {\n              return clearTimeout(marker);\n            }\n\n            if ((cachedClearTimeout === defaultClearTimeout || !cachedClearTimeout) && clearTimeout) {\n              cachedClearTimeout = clearTimeout;\n              return clearTimeout(marker);\n            }\n\n            try {\n              return cachedClearTimeout(marker);\n            } catch (e) {\n              try {\n                return cachedClearTimeout.call(null, marker);\n              } catch (e) {\n                return cachedClearTimeout.call(this, marker);\n              }\n            }\n          }\n\n          var queue = [];\n          var draining = false;\n          var currentQueue;\n          var queueIndex = -1;\n\n          function cleanUpNextTick() {\n            if (!draining || !currentQueue) {\n              return;\n            }\n\n            draining = false;\n\n            if (currentQueue.length) {\n              queue = currentQueue.concat(queue);\n            } else {\n              queueIndex = -1;\n            }\n\n            if (queue.length) {\n              drainQueue();\n            }\n          }\n\n          function drainQueue() {\n            if (draining) {\n              return;\n            }\n\n            var timeout = runTimeout(cleanUpNextTick);\n            draining = true;\n            var len = queue.length;\n\n            while (len) {\n              currentQueue = queue;\n              queue = [];\n\n              while (++queueIndex < len) {\n                if (currentQueue) {\n                  currentQueue[queueIndex].run();\n                }\n              }\n\n              queueIndex = -1;\n              len = queue.length;\n            }\n\n            currentQueue = null;\n            draining = false;\n            runClearTimeout(timeout);\n          }\n\n          process.nextTick = function (fun) {\n            var args = new Array(arguments.length - 1);\n\n            if (arguments.length > 1) {\n              for (var i = 1; i < arguments.length; i++) {\n                args[i - 1] = arguments[i];\n              }\n            }\n\n            queue.push(new Item(fun, args));\n\n            if (queue.length === 1 && !draining) {\n              runTimeout(drainQueue);\n            }\n          };\n\n          function Item(fun, array) {\n            this.fun = fun;\n            this.array = array;\n          }\n\n          Item.prototype.run = function () {\n            this.fun.apply(null, this.array);\n          };\n\n          process.title = 'browser';\n          process.browser = true;\n          process.env = {};\n          process.argv = [];\n          process.version = '';\n          process.versions = {};\n\n          function noop() {}\n\n          process.on = noop;\n          process.addListener = noop;\n          process.once = noop;\n          process.off = noop;\n          process.removeListener = noop;\n          process.removeAllListeners = noop;\n          process.emit = noop;\n          process.prependListener = noop;\n          process.prependOnceListener = noop;\n\n          process.listeners = function (name) {\n            return [];\n          };\n\n          process.binding = function (name) {\n            throw new Error('process.binding is not supported');\n          };\n\n          process.cwd = function () {\n            return '/';\n          };\n\n          process.chdir = function (dir) {\n            throw new Error('process.chdir is not supported');\n          };\n\n          process.umask = function () {\n            return 0;\n          };\n        }, {}],\n        2: [function (require, module, exports) {\n          (function (setImmediate) {\n            (function (root) {\n              var setTimeoutFunc = setTimeout;\n\n              function noop() {}\n\n              function bind(fn, thisArg) {\n                return function () {\n                  fn.apply(thisArg, arguments);\n                };\n              }\n\n              function Promise(fn) {\n                if (typeof this !== 'object') throw new TypeError('Promises must be constructed via new');\n                if (typeof fn !== 'function') throw new TypeError('not a function');\n                this._state = 0;\n                this._handled = false;\n                this._value = undefined;\n                this._deferreds = [];\n                doResolve(fn, this);\n              }\n\n              function handle(self, deferred) {\n                while (self._state === 3) {\n                  self = self._value;\n                }\n\n                if (self._state === 0) {\n                  self._deferreds.push(deferred);\n\n                  return;\n                }\n\n                self._handled = true;\n\n                Promise._immediateFn(function () {\n                  var cb = self._state === 1 ? deferred.onFulfilled : deferred.onRejected;\n\n                  if (cb === null) {\n                    (self._state === 1 ? resolve : reject)(deferred.promise, self._value);\n                    return;\n                  }\n\n                  var ret;\n\n                  try {\n                    ret = cb(self._value);\n                  } catch (e) {\n                    reject(deferred.promise, e);\n                    return;\n                  }\n\n                  resolve(deferred.promise, ret);\n                });\n              }\n\n              function resolve(self, newValue) {\n                try {\n                  if (newValue === self) throw new TypeError('A promise cannot be resolved with itself.');\n\n                  if (newValue && (typeof newValue === 'object' || typeof newValue === 'function')) {\n                    var then = newValue.then;\n\n                    if (newValue instanceof Promise) {\n                      self._state = 3;\n                      self._value = newValue;\n                      finale(self);\n                      return;\n                    } else if (typeof then === 'function') {\n                      doResolve(bind(then, newValue), self);\n                      return;\n                    }\n                  }\n\n                  self._state = 1;\n                  self._value = newValue;\n                  finale(self);\n                } catch (e) {\n                  reject(self, e);\n                }\n              }\n\n              function reject(self, newValue) {\n                self._state = 2;\n                self._value = newValue;\n                finale(self);\n              }\n\n              function finale(self) {\n                if (self._state === 2 && self._deferreds.length === 0) {\n                  Promise._immediateFn(function () {\n                    if (!self._handled) {\n                      Promise._unhandledRejectionFn(self._value);\n                    }\n                  });\n                }\n\n                for (var i = 0, len = self._deferreds.length; i < len; i++) {\n                  handle(self, self._deferreds[i]);\n                }\n\n                self._deferreds = null;\n              }\n\n              function Handler(onFulfilled, onRejected, promise) {\n                this.onFulfilled = typeof onFulfilled === 'function' ? onFulfilled : null;\n                this.onRejected = typeof onRejected === 'function' ? onRejected : null;\n                this.promise = promise;\n              }\n\n              function doResolve(fn, self) {\n                var done = false;\n\n                try {\n                  fn(function (value) {\n                    if (done) return;\n                    done = true;\n                    resolve(self, value);\n                  }, function (reason) {\n                    if (done) return;\n                    done = true;\n                    reject(self, reason);\n                  });\n                } catch (ex) {\n                  if (done) return;\n                  done = true;\n                  reject(self, ex);\n                }\n              }\n\n              Promise.prototype['catch'] = function (onRejected) {\n                return this.then(null, onRejected);\n              };\n\n              Promise.prototype.then = function (onFulfilled, onRejected) {\n                var prom = new this.constructor(noop);\n                handle(this, new Handler(onFulfilled, onRejected, prom));\n                return prom;\n              };\n\n              Promise.all = function (arr) {\n                var args = Array.prototype.slice.call(arr);\n                return new Promise(function (resolve, reject) {\n                  if (args.length === 0) return resolve([]);\n                  var remaining = args.length;\n\n                  function res(i, val) {\n                    try {\n                      if (val && (typeof val === 'object' || typeof val === 'function')) {\n                        var then = val.then;\n\n                        if (typeof then === 'function') {\n                          then.call(val, function (val) {\n                            res(i, val);\n                          }, reject);\n                          return;\n                        }\n                      }\n\n                      args[i] = val;\n\n                      if (--remaining === 0) {\n                        resolve(args);\n                      }\n                    } catch (ex) {\n                      reject(ex);\n                    }\n                  }\n\n                  for (var i = 0; i < args.length; i++) {\n                    res(i, args[i]);\n                  }\n                });\n              };\n\n              Promise.resolve = function (value) {\n                if (value && typeof value === 'object' && value.constructor === Promise) {\n                  return value;\n                }\n\n                return new Promise(function (resolve) {\n                  resolve(value);\n                });\n              };\n\n              Promise.reject = function (value) {\n                return new Promise(function (resolve, reject) {\n                  reject(value);\n                });\n              };\n\n              Promise.race = function (values) {\n                return new Promise(function (resolve, reject) {\n                  for (var i = 0, len = values.length; i < len; i++) {\n                    values[i].then(resolve, reject);\n                  }\n                });\n              };\n\n              Promise._immediateFn = typeof setImmediate === 'function' ? function (fn) {\n                setImmediate(fn);\n              } : function (fn) {\n                setTimeoutFunc(fn, 0);\n              };\n\n              Promise._unhandledRejectionFn = function _unhandledRejectionFn(err) {\n                if (typeof console !== 'undefined' && console) {\n                  console.warn('Possible Unhandled Promise Rejection:', err);\n                }\n              };\n\n              Promise._setImmediateFn = function _setImmediateFn(fn) {\n                Promise._immediateFn = fn;\n              };\n\n              Promise._setUnhandledRejectionFn = function _setUnhandledRejectionFn(fn) {\n                Promise._unhandledRejectionFn = fn;\n              };\n\n              if (typeof module !== 'undefined' && module.exports) {\n                module.exports = Promise;\n              } else if (!root.Promise) {\n                root.Promise = Promise;\n              }\n            })(this);\n          }).call(this, require('timers').setImmediate);\n        }, {\n          'timers': 3\n        }],\n        3: [function (require, module, exports) {\n          (function (setImmediate, clearImmediate) {\n            var nextTick = require('process/browser.js').nextTick;\n\n            var apply = Function.prototype.apply;\n            var slice = Array.prototype.slice;\n            var immediateIds = {};\n            var nextImmediateId = 0;\n\n            exports.setTimeout = function () {\n              return new Timeout(apply.call(setTimeout, window, arguments), clearTimeout);\n            };\n\n            exports.setInterval = function () {\n              return new Timeout(apply.call(setInterval, window, arguments), clearInterval);\n            };\n\n            exports.clearTimeout = exports.clearInterval = function (timeout) {\n              timeout.close();\n            };\n\n            function Timeout(id, clearFn) {\n              this._id = id;\n              this._clearFn = clearFn;\n            }\n\n            Timeout.prototype.unref = Timeout.prototype.ref = function () {};\n\n            Timeout.prototype.close = function () {\n              this._clearFn.call(window, this._id);\n            };\n\n            exports.enroll = function (item, msecs) {\n              clearTimeout(item._idleTimeoutId);\n              item._idleTimeout = msecs;\n            };\n\n            exports.unenroll = function (item) {\n              clearTimeout(item._idleTimeoutId);\n              item._idleTimeout = -1;\n            };\n\n            exports._unrefActive = exports.active = function (item) {\n              clearTimeout(item._idleTimeoutId);\n              var msecs = item._idleTimeout;\n\n              if (msecs >= 0) {\n                item._idleTimeoutId = setTimeout(function onTimeout() {\n                  if (item._onTimeout) item._onTimeout();\n                }, msecs);\n              }\n            };\n\n            exports.setImmediate = typeof setImmediate === 'function' ? setImmediate : function (fn) {\n              var id = nextImmediateId++;\n              var args = arguments.length < 2 ? false : slice.call(arguments, 1);\n              immediateIds[id] = true;\n              nextTick(function onNextTick() {\n                if (immediateIds[id]) {\n                  if (args) {\n                    fn.apply(null, args);\n                  } else {\n                    fn.call(null);\n                  }\n\n                  exports.clearImmediate(id);\n                }\n              });\n              return id;\n            };\n            exports.clearImmediate = typeof clearImmediate === 'function' ? clearImmediate : function (id) {\n              delete immediateIds[id];\n            };\n          }).call(this, require('timers').setImmediate, require('timers').clearImmediate);\n        }, {\n          'process/browser.js': 1,\n          'timers': 3\n        }],\n        4: [function (require, module, exports) {\n          var promisePolyfill = require('promise-polyfill');\n\n          var Global = function () {\n            if (typeof window !== 'undefined') {\n              return window;\n            } else {\n              return Function('return this;')();\n            }\n          }();\n\n          module.exports = {\n            boltExport: Global.Promise || promisePolyfill\n          };\n        }, {\n          'promise-polyfill': 2\n        }]\n      }, {}, [4])(4);\n    });\n  })(undefined, exports$1, module, undefined);\n\n  var Promise = module.exports.boltExport;\n\n  var nu$a = function (baseFn) {\n    var data = Optional.none();\n    var callbacks = [];\n\n    var map = function (f) {\n      return nu$a(function (nCallback) {\n        get(function (data) {\n          nCallback(f(data));\n        });\n      });\n    };\n\n    var get = function (nCallback) {\n      if (isReady()) {\n        call(nCallback);\n      } else {\n        callbacks.push(nCallback);\n      }\n    };\n\n    var set = function (x) {\n      if (!isReady()) {\n        data = Optional.some(x);\n        run(callbacks);\n        callbacks = [];\n      }\n    };\n\n    var isReady = function () {\n      return data.isSome();\n    };\n\n    var run = function (cbs) {\n      each(cbs, call);\n    };\n\n    var call = function (cb) {\n      data.each(function (x) {\n        setTimeout(function () {\n          cb(x);\n        }, 0);\n      });\n    };\n\n    baseFn(set);\n    return {\n      get: get,\n      map: map,\n      isReady: isReady\n    };\n  };\n\n  var pure = function (a) {\n    return nu$a(function (callback) {\n      callback(a);\n    });\n  };\n\n  var LazyValue = {\n    nu: nu$a,\n    pure: pure\n  };\n\n  var errorReporter = function (err) {\n    setTimeout(function () {\n      throw err;\n    }, 0);\n  };\n\n  var make$3 = function (run) {\n    var get = function (callback) {\n      run().then(callback, errorReporter);\n    };\n\n    var map = function (fab) {\n      return make$3(function () {\n        return run().then(fab);\n      });\n    };\n\n    var bind = function (aFutureB) {\n      return make$3(function () {\n        return run().then(function (v) {\n          return aFutureB(v).toPromise();\n        });\n      });\n    };\n\n    var anonBind = function (futureB) {\n      return make$3(function () {\n        return run().then(function () {\n          return futureB.toPromise();\n        });\n      });\n    };\n\n    var toLazy = function () {\n      return LazyValue.nu(get);\n    };\n\n    var toCached = function () {\n      var cache = null;\n      return make$3(function () {\n        if (cache === null) {\n          cache = run();\n        }\n\n        return cache;\n      });\n    };\n\n    var toPromise = run;\n    return {\n      map: map,\n      bind: bind,\n      anonBind: anonBind,\n      toLazy: toLazy,\n      toCached: toCached,\n      toPromise: toPromise,\n      get: get\n    };\n  };\n\n  var nu$b = function (baseFn) {\n    return make$3(function () {\n      return new Promise(baseFn);\n    });\n  };\n\n  var pure$1 = function (a) {\n    return make$3(function () {\n      return Promise.resolve(a);\n    });\n  };\n\n  var Future = {\n    nu: nu$b,\n    pure: pure$1\n  };\n  var ariaElements = ['input', 'textarea'];\n\n  var isAriaElement = function (elem) {\n    var name$1 = name(elem);\n    return contains(ariaElements, name$1);\n  };\n\n  var markValid = function (component, invalidConfig) {\n    var elem = invalidConfig.getRoot(component).getOr(component.element);\n    remove$4(elem, invalidConfig.invalidClass);\n    invalidConfig.notify.each(function (notifyInfo) {\n      if (isAriaElement(component.element)) {\n        set$1(component.element, 'aria-invalid', false);\n      }\n\n      notifyInfo.getContainer(component).each(function (container) {\n        set(container, notifyInfo.validHtml);\n      });\n      notifyInfo.onValid(component);\n    });\n  };\n\n  var markInvalid = function (component, invalidConfig, invalidState, text) {\n    var elem = invalidConfig.getRoot(component).getOr(component.element);\n    add$2(elem, invalidConfig.invalidClass);\n    invalidConfig.notify.each(function (notifyInfo) {\n      if (isAriaElement(component.element)) {\n        set$1(component.element, 'aria-invalid', true);\n      }\n\n      notifyInfo.getContainer(component).each(function (container) {\n        set(container, text);\n      });\n      notifyInfo.onInvalid(component, text);\n    });\n  };\n\n  var query = function (component, invalidConfig, _invalidState) {\n    return invalidConfig.validator.fold(function () {\n      return Future.pure(Result.value(true));\n    }, function (validatorInfo) {\n      return validatorInfo.validate(component);\n    });\n  };\n\n  var run$1 = function (component, invalidConfig, invalidState) {\n    invalidConfig.notify.each(function (notifyInfo) {\n      notifyInfo.onValidate(component);\n    });\n    return query(component, invalidConfig).map(function (valid) {\n      if (component.getSystem().isConnected()) {\n        return valid.fold(function (err) {\n          markInvalid(component, invalidConfig, invalidState, err);\n          return Result.error(err);\n        }, function (v) {\n          markValid(component, invalidConfig);\n          return Result.value(v);\n        });\n      } else {\n        return Result.error('No longer in system');\n      }\n    });\n  };\n\n  var isInvalid = function (component, invalidConfig) {\n    var elem = invalidConfig.getRoot(component).getOr(component.element);\n    return has$2(elem, invalidConfig.invalidClass);\n  };\n\n  var InvalidateApis = /*#__PURE__*/Object.freeze({\n    __proto__: null,\n    markValid: markValid,\n    markInvalid: markInvalid,\n    query: query,\n    run: run$1,\n    isInvalid: isInvalid\n  });\n\n  var events$a = function (invalidConfig, invalidState) {\n    return invalidConfig.validator.map(function (validatorInfo) {\n      return derive([run(validatorInfo.onEvent, function (component) {\n        run$1(component, invalidConfig, invalidState).get(identity);\n      })].concat(validatorInfo.validateOnLoad ? [runOnAttached(function (component) {\n        run$1(component, invalidConfig, invalidState).get(noop);\n      })] : []));\n    }).getOr({});\n  };\n\n  var ActiveInvalidate = /*#__PURE__*/Object.freeze({\n    __proto__: null,\n    events: events$a\n  });\n  var InvalidateSchema = [strict$1('invalidClass'), defaulted$1('getRoot', Optional.none), optionObjOf('notify', [defaulted$1('aria', 'alert'), defaulted$1('getContainer', Optional.none), defaulted$1('validHtml', ''), onHandler('onValid'), onHandler('onInvalid'), onHandler('onValidate')]), optionObjOf('validator', [strict$1('validate'), defaulted$1('onEvent', 'input'), defaulted$1('validateOnLoad', true)])];\n  var Invalidating = create$1({\n    fields: InvalidateSchema,\n    name: 'invalidating',\n    active: ActiveInvalidate,\n    apis: InvalidateApis,\n    extra: {\n      validation: function (validator) {\n        return function (component) {\n          var v = Representing.getValue(component);\n          return Future.pure(validator(v));\n        };\n      }\n    }\n  });\n\n  var getCoupled = function (component, coupleConfig, coupleState, name) {\n    return coupleState.getOrCreate(component, coupleConfig, name);\n  };\n\n  var CouplingApis = /*#__PURE__*/Object.freeze({\n    __proto__: null,\n    getCoupled: getCoupled\n  });\n  var CouplingSchema = [strictOf('others', setOf$1(Result.value, anyValue$1()))];\n\n  var init$5 = function () {\n    var coupled = {};\n\n    var getOrCreate = function (component, coupleConfig, name) {\n      var available = keys(coupleConfig.others);\n\n      if (!available) {\n        throw new Error('Cannot find coupled component: ' + name + '. Known coupled components: ' + JSON.stringify(available, null, 2));\n      } else {\n        return get$1(coupled, name).getOrThunk(function () {\n          var builder = get$1(coupleConfig.others, name).getOrDie('No information found for coupled component: ' + name);\n          var spec = builder(component);\n          var built = component.getSystem().build(spec);\n          coupled[name] = built;\n          return built;\n        });\n      }\n    };\n\n    var readState = constant({});\n    return nu$5({\n      readState: readState,\n      getOrCreate: getOrCreate\n    });\n  };\n\n  var CouplingState = /*#__PURE__*/Object.freeze({\n    __proto__: null,\n    init: init$5\n  });\n  var Coupling = create$1({\n    fields: CouplingSchema,\n    name: 'coupling',\n    apis: CouplingApis,\n    state: CouplingState\n  });\n  var suffix = constant('sink');\n  var partType = constant(optional({\n    name: suffix(),\n    overrides: constant({\n      dom: {\n        tag: 'div'\n      },\n      behaviours: derive$1([Positioning.config({\n        useFixed: always\n      })]),\n      events: derive([cutter(keydown()), cutter(mousedown()), cutter(click())])\n    })\n  }));\n  var HighlightOnOpen;\n\n  (function (HighlightOnOpen) {\n    HighlightOnOpen[HighlightOnOpen['HighlightFirst'] = 0] = 'HighlightFirst';\n    HighlightOnOpen[HighlightOnOpen['HighlightNone'] = 1] = 'HighlightNone';\n  })(HighlightOnOpen || (HighlightOnOpen = {}));\n\n  var getAnchor = function (detail, component) {\n    var hotspot = detail.getHotspot(component).getOr(component);\n    var anchor = 'hotspot';\n    var overrides = detail.getAnchorOverrides();\n    return detail.layouts.fold(function () {\n      return {\n        anchor: anchor,\n        hotspot: hotspot,\n        overrides: overrides\n      };\n    }, function (layouts) {\n      return {\n        anchor: anchor,\n        hotspot: hotspot,\n        overrides: overrides,\n        layouts: layouts\n      };\n    });\n  };\n\n  var fetch = function (detail, mapFetch, component) {\n    var fetcher = detail.fetch;\n    return fetcher(component).map(mapFetch);\n  };\n\n  var openF = function (detail, mapFetch, anchor, component, sandbox, externals, highlightOnOpen) {\n    var futureData = fetch(detail, mapFetch, component);\n    var getLazySink = getSink(component, detail);\n    return futureData.map(function (tdata) {\n      return tdata.bind(function (data) {\n        return Optional.from(tieredMenu.sketch(__assign(__assign({}, externals.menu()), {\n          uid: generate$2(''),\n          data: data,\n          highlightImmediately: highlightOnOpen === HighlightOnOpen.HighlightFirst,\n          onOpenMenu: function (tmenu, menu) {\n            var sink = getLazySink().getOrDie();\n            Positioning.position(sink, anchor, menu);\n            Sandboxing.decloak(sandbox);\n          },\n          onOpenSubmenu: function (tmenu, item, submenu) {\n            var sink = getLazySink().getOrDie();\n            Positioning.position(sink, {\n              anchor: 'submenu',\n              item: item\n            }, submenu);\n            Sandboxing.decloak(sandbox);\n          },\n          onRepositionMenu: function (tmenu, primaryMenu, submenuTriggers) {\n            var sink = getLazySink().getOrDie();\n            Positioning.position(sink, anchor, primaryMenu);\n            each(submenuTriggers, function (st) {\n              Positioning.position(sink, {\n                anchor: 'submenu',\n                item: st.triggeringItem\n              }, st.triggeredMenu);\n            });\n          },\n          onEscape: function () {\n            Focusing.focus(component);\n            Sandboxing.close(sandbox);\n            return Optional.some(true);\n          }\n        })));\n      });\n    });\n  };\n\n  var open$1 = function (detail, mapFetch, hotspot, sandbox, externals, onOpenSync, highlightOnOpen) {\n    var anchor = getAnchor(detail, hotspot);\n    var processed = openF(detail, mapFetch, anchor, hotspot, sandbox, externals, highlightOnOpen);\n    return processed.map(function (tdata) {\n      tdata.fold(function () {\n        if (Sandboxing.isOpen(sandbox)) {\n          Sandboxing.close(sandbox);\n        }\n      }, function (data) {\n        Sandboxing.cloak(sandbox);\n        Sandboxing.open(sandbox, data);\n        onOpenSync(sandbox);\n      });\n      return sandbox;\n    });\n  };\n\n  var close$1 = function (detail, mapFetch, component, sandbox, _externals, _onOpenSync, _highlightOnOpen) {\n    Sandboxing.close(sandbox);\n    return Future.pure(sandbox);\n  };\n\n  var togglePopup = function (detail, mapFetch, hotspot, externals, onOpenSync, highlightOnOpen) {\n    var sandbox = Coupling.getCoupled(hotspot, 'sandbox');\n    var showing = Sandboxing.isOpen(sandbox);\n    var action = showing ? close$1 : open$1;\n    return action(detail, mapFetch, hotspot, sandbox, externals, onOpenSync, highlightOnOpen);\n  };\n\n  var matchWidth = function (hotspot, container, useMinWidth) {\n    var menu = Composing.getCurrent(container).getOr(container);\n    var buttonWidth = get$8(hotspot.element);\n\n    if (useMinWidth) {\n      set$2(menu.element, 'min-width', buttonWidth + 'px');\n    } else {\n      set$4(menu.element, buttonWidth);\n    }\n  };\n\n  var getSink = function (anyInSystem, sinkDetail) {\n    return anyInSystem.getSystem().getByUid(sinkDetail.uid + '-' + suffix()).map(function (internalSink) {\n      return function () {\n        return Result.value(internalSink);\n      };\n    }).getOrThunk(function () {\n      return sinkDetail.lazySink.fold(function () {\n        return function () {\n          return Result.error(new Error('No internal sink is specified, nor could an external sink be found'));\n        };\n      }, function (lazySinkFn) {\n        return function () {\n          return lazySinkFn(anyInSystem);\n        };\n      });\n    });\n  };\n\n  var doRepositionMenus = function (sandbox) {\n    Sandboxing.getState(sandbox).each(function (tmenu) {\n      tieredMenu.repositionMenus(tmenu);\n    });\n  };\n\n  var makeSandbox = function (detail, hotspot, extras) {\n    var ariaOwner = manager();\n\n    var onOpen = function (component, menu) {\n      var anchor = getAnchor(detail, hotspot);\n      ariaOwner.link(hotspot.element);\n\n      if (detail.matchWidth) {\n        matchWidth(anchor.hotspot, menu, detail.useMinWidth);\n      }\n\n      detail.onOpen(anchor, component, menu);\n\n      if (extras !== undefined && extras.onOpen !== undefined) {\n        extras.onOpen(component, menu);\n      }\n    };\n\n    var onClose = function (component, menu) {\n      ariaOwner.unlink(hotspot.element);\n\n      if (extras !== undefined && extras.onClose !== undefined) {\n        extras.onClose(component, menu);\n      }\n    };\n\n    var lazySink = getSink(hotspot, detail);\n    return {\n      dom: {\n        tag: 'div',\n        classes: detail.sandboxClasses,\n        attributes: {\n          id: ariaOwner.id,\n          role: 'listbox'\n        }\n      },\n      behaviours: SketchBehaviours.augment(detail.sandboxBehaviours, [Representing.config({\n        store: {\n          mode: 'memory',\n          initialValue: hotspot\n        }\n      }), Sandboxing.config({\n        onOpen: onOpen,\n        onClose: onClose,\n        isPartOf: function (container, data, queryElem) {\n          return isPartOf(data, queryElem) || isPartOf(hotspot, queryElem);\n        },\n        getAttachPoint: function () {\n          return lazySink().getOrDie();\n        }\n      }), Composing.config({\n        find: function (sandbox) {\n          return Sandboxing.getState(sandbox).bind(function (menu) {\n            return Composing.getCurrent(menu);\n          });\n        }\n      }), Receiving.config({\n        channels: __assign(__assign({}, receivingChannel({\n          isExtraPart: never\n        })), receivingChannel$1({\n          doReposition: doRepositionMenus\n        }))\n      })])\n    };\n  };\n\n  var repositionMenus = function (comp) {\n    var sandbox = Coupling.getCoupled(comp, 'sandbox');\n    doRepositionMenus(sandbox);\n  };\n\n  var sandboxFields = function () {\n    return [defaulted$1('sandboxClasses', []), SketchBehaviours.field('sandboxBehaviours', [Composing, Receiving, Sandboxing, Representing])];\n  };\n\n  var schema$g = constant([strict$1('dom'), strict$1('fetch'), onHandler('onOpen'), onKeyboardHandler('onExecute'), defaulted$1('getHotspot', Optional.some), defaulted$1('getAnchorOverrides', constant({})), schema$1(), field$1('dropdownBehaviours', [Toggling, Coupling, Keying, Focusing]), strict$1('toggleClass'), defaulted$1('eventOrder', {}), option('lazySink'), defaulted$1('matchWidth', false), defaulted$1('useMinWidth', false), option('role')].concat(sandboxFields()));\n  var parts$4 = constant([external$1({\n    schema: [tieredMenuMarkers()],\n    name: 'menu',\n    defaults: function (detail) {\n      return {\n        onExecute: detail.onExecute\n      };\n    }\n  }), partType()]);\n\n  var factory$6 = function (detail, components, _spec, externals) {\n    var _a;\n\n    var lookupAttr = function (attr) {\n      return get$1(detail.dom, 'attributes').bind(function (attrs) {\n        return get$1(attrs, attr);\n      });\n    };\n\n    var switchToMenu = function (sandbox) {\n      Sandboxing.getState(sandbox).each(function (tmenu) {\n        tieredMenu.highlightPrimary(tmenu);\n      });\n    };\n\n    var action = function (component) {\n      var onOpenSync = switchToMenu;\n      togglePopup(detail, function (x) {\n        return x;\n      }, component, externals, onOpenSync, HighlightOnOpen.HighlightFirst).get(noop);\n    };\n\n    var apis = {\n      expand: function (comp) {\n        if (!Toggling.isOn(comp)) {\n          togglePopup(detail, function (x) {\n            return x;\n          }, comp, externals, noop, HighlightOnOpen.HighlightNone).get(noop);\n        }\n      },\n      open: function (comp) {\n        if (!Toggling.isOn(comp)) {\n          togglePopup(detail, function (x) {\n            return x;\n          }, comp, externals, noop, HighlightOnOpen.HighlightFirst).get(noop);\n        }\n      },\n      isOpen: Toggling.isOn,\n      close: function (comp) {\n        if (Toggling.isOn(comp)) {\n          togglePopup(detail, function (x) {\n            return x;\n          }, comp, externals, noop, HighlightOnOpen.HighlightFirst).get(noop);\n        }\n      },\n      repositionMenus: function (comp) {\n        if (Toggling.isOn(comp)) {\n          repositionMenus(comp);\n        }\n      }\n    };\n\n    var triggerExecute = function (comp, _se) {\n      emitExecute(comp);\n      return Optional.some(true);\n    };\n\n    return {\n      uid: detail.uid,\n      dom: detail.dom,\n      components: components,\n      behaviours: augment(detail.dropdownBehaviours, [Toggling.config({\n        toggleClass: detail.toggleClass,\n        aria: {\n          mode: 'expanded'\n        }\n      }), Coupling.config({\n        others: {\n          sandbox: function (hotspot) {\n            return makeSandbox(detail, hotspot, {\n              onOpen: function () {\n                return Toggling.on(hotspot);\n              },\n              onClose: function () {\n                return Toggling.off(hotspot);\n              }\n            });\n          }\n        }\n      }), Keying.config({\n        mode: 'special',\n        onSpace: triggerExecute,\n        onEnter: triggerExecute,\n        onDown: function (comp, _se) {\n          if (Dropdown.isOpen(comp)) {\n            var sandbox = Coupling.getCoupled(comp, 'sandbox');\n            switchToMenu(sandbox);\n          } else {\n            Dropdown.open(comp);\n          }\n\n          return Optional.some(true);\n        },\n        onEscape: function (comp, _se) {\n          if (Dropdown.isOpen(comp)) {\n            Dropdown.close(comp);\n            return Optional.some(true);\n          } else {\n            return Optional.none();\n          }\n        }\n      }), Focusing.config({})]),\n      events: events$7(Optional.some(action)),\n      eventOrder: __assign(__assign({}, detail.eventOrder), (_a = {}, _a[execute()] = ['disabling', 'toggling', 'alloy.base.behaviour'], _a)),\n      apis: apis,\n      domModification: {\n        attributes: __assign(__assign({\n          'aria-haspopup': 'true'\n        }, detail.role.fold(function () {\n          return {};\n        }, function (role) {\n          return {\n            role: role\n          };\n        })), detail.dom.tag === 'button' ? {\n          type: lookupAttr('type').getOr('button')\n        } : {})\n      }\n    };\n  };\n\n  var Dropdown = composite$1({\n    name: 'Dropdown',\n    configFields: schema$g(),\n    partFields: parts$4(),\n    factory: factory$6,\n    apis: {\n      open: function (apis, comp) {\n        return apis.open(comp);\n      },\n      expand: function (apis, comp) {\n        return apis.expand(comp);\n      },\n      close: function (apis, comp) {\n        return apis.close(comp);\n      },\n      isOpen: function (apis, comp) {\n        return apis.isOpen(comp);\n      },\n      repositionMenus: function (apis, comp) {\n        return apis.repositionMenus(comp);\n      }\n    }\n  });\n\n  var exhibit$5 = function () {\n    return nu$6({\n      styles: {\n        '-webkit-user-select': 'none',\n        'user-select': 'none',\n        '-ms-user-select': 'none',\n        '-moz-user-select': '-moz-none'\n      },\n      attributes: {\n        unselectable: 'on'\n      }\n    });\n  };\n\n  var events$b = function () {\n    return derive([abort(selectstart(), always)]);\n  };\n\n  var ActiveUnselecting = /*#__PURE__*/Object.freeze({\n    __proto__: null,\n    events: events$b,\n    exhibit: exhibit$5\n  });\n  var Unselecting = create$1({\n    fields: [],\n    name: 'unselecting',\n    active: ActiveUnselecting\n  });\n\n  var renderPanelButton = function (spec, sharedBackstage) {\n    return Dropdown.sketch({\n      dom: spec.dom,\n      components: spec.components,\n      toggleClass: 'mce-active',\n      dropdownBehaviours: derive$1([DisablingConfigs.button(sharedBackstage.providers.isDisabled), receivingConfig(), Unselecting.config({}), Tabstopping.config({})]),\n      layouts: spec.layouts,\n      sandboxClasses: ['tox-dialog__popups'],\n      lazySink: sharedBackstage.getSink,\n      fetch: function (comp) {\n        return Future.nu(function (callback) {\n          return spec.fetch(callback);\n        }).map(function (items) {\n          return Optional.from(createTieredDataFrom(deepMerge(createPartialChoiceMenu(generate$1('menu-value'), items, function (value) {\n            spec.onItemAction(comp, value);\n          }, spec.columns, spec.presets, ItemResponse$1.CLOSE_ON_EXECUTE, never, sharedBackstage.providers), {\n            movement: deriveMenuMovement(spec.columns, spec.presets)\n          })));\n        });\n      },\n      parts: {\n        menu: part(false, 1, spec.presets)\n      }\n    });\n  };\n\n  var colorInputChangeEvent = generate$1('color-input-change');\n  var colorSwatchChangeEvent = generate$1('color-swatch-change');\n  var colorPickerCancelEvent = generate$1('color-picker-cancel');\n\n  var renderColorInput = function (spec, sharedBackstage, colorInputBackstage) {\n    var pField = FormField.parts.field({\n      factory: Input,\n      inputClasses: ['tox-textfield'],\n      onSetValue: function (c) {\n        return Invalidating.run(c).get(noop);\n      },\n      inputBehaviours: derive$1([Disabling.config({\n        disabled: sharedBackstage.providers.isDisabled\n      }), receivingConfig(), Tabstopping.config({}), Invalidating.config({\n        invalidClass: 'tox-textbox-field-invalid',\n        getRoot: function (comp) {\n          return parent(comp.element);\n        },\n        notify: {\n          onValid: function (comp) {\n            var val = Representing.getValue(comp);\n            emitWith(comp, colorInputChangeEvent, {\n              color: val\n            });\n          }\n        },\n        validator: {\n          validateOnLoad: false,\n          validate: function (input) {\n            var inputValue = Representing.getValue(input);\n\n            if (inputValue.length === 0) {\n              return Future.pure(Result.value(true));\n            } else {\n              var span = SugarElement.fromTag('span');\n              set$2(span, 'background-color', inputValue);\n              var res = getRaw(span, 'background-color').fold(function () {\n                return Result.error('blah');\n              }, function (_) {\n                return Result.value(inputValue);\n              });\n              return Future.pure(res);\n            }\n          }\n        }\n      })]),\n      selectOnFocus: false\n    });\n    var pLabel = spec.label.map(function (label) {\n      return renderLabel(label, sharedBackstage.providers);\n    });\n\n    var emitSwatchChange = function (colorBit, value) {\n      emitWith(colorBit, colorSwatchChangeEvent, {\n        value: value\n      });\n    };\n\n    var onItemAction = function (comp, value) {\n      memColorButton.getOpt(comp).each(function (colorBit) {\n        if (value === 'custom') {\n          colorInputBackstage.colorPicker(function (valueOpt) {\n            valueOpt.fold(function () {\n              return emit(colorBit, colorPickerCancelEvent);\n            }, function (value) {\n              emitSwatchChange(colorBit, value);\n              addColor(value);\n            });\n          }, '#ffffff');\n        } else if (value === 'remove') {\n          emitSwatchChange(colorBit, '');\n        } else {\n          emitSwatchChange(colorBit, value);\n        }\n      });\n    };\n\n    var memColorButton = record(renderPanelButton({\n      dom: {\n        tag: 'span',\n        attributes: {\n          'aria-label': sharedBackstage.providers.translate('Color swatch')\n        }\n      },\n      layouts: {\n        onRtl: function () {\n          return [southwest$1, southeast$1, south$1];\n        },\n        onLtr: function () {\n          return [southeast$1, southwest$1, south$1];\n        }\n      },\n      components: [],\n      fetch: getFetch(colorInputBackstage.getColors(), colorInputBackstage.hasCustomColors()),\n      columns: colorInputBackstage.getColorCols(),\n      presets: 'color',\n      onItemAction: onItemAction\n    }, sharedBackstage));\n    return FormField.sketch({\n      dom: {\n        tag: 'div',\n        classes: ['tox-form__group']\n      },\n      components: pLabel.toArray().concat([{\n        dom: {\n          tag: 'div',\n          classes: ['tox-color-input']\n        },\n        components: [pField, memColorButton.asSpec()]\n      }]),\n      fieldBehaviours: derive$1([config('form-field-events', [run(colorInputChangeEvent, function (comp, se) {\n        memColorButton.getOpt(comp).each(function (colorButton) {\n          set$2(colorButton.element, 'background-color', se.event.color);\n        });\n        emitWith(comp, formChangeEvent, {\n          name: spec.name\n        });\n      }), run(colorSwatchChangeEvent, function (comp, se) {\n        FormField.getField(comp).each(function (field) {\n          Representing.setValue(field, se.event.value);\n          Composing.getCurrent(comp).each(Focusing.focus);\n        });\n      }), run(colorPickerCancelEvent, function (comp, _se) {\n        FormField.getField(comp).each(function (_field) {\n          Composing.getCurrent(comp).each(Focusing.focus);\n        });\n      })])])\n    });\n  };\n\n  var labelPart = optional({\n    schema: [strict$1('dom')],\n    name: 'label'\n  });\n\n  var edgePart = function (name) {\n    return optional({\n      name: '' + name + '-edge',\n      overrides: function (detail) {\n        var action = detail.model.manager.edgeActions[name];\n        return action.fold(function () {\n          return {};\n        }, function (a) {\n          return {\n            events: derive([runActionExtra(touchstart(), function (comp, se, d) {\n              return a(comp, d);\n            }, [detail]), runActionExtra(mousedown(), function (comp, se, d) {\n              return a(comp, d);\n            }, [detail]), runActionExtra(mousemove(), function (comp, se, det) {\n              if (det.mouseIsDown.get()) {\n                a(comp, det);\n              }\n            }, [detail])])\n          };\n        });\n      }\n    });\n  };\n\n  var tlEdgePart = edgePart('top-left');\n  var tedgePart = edgePart('top');\n  var trEdgePart = edgePart('top-right');\n  var redgePart = edgePart('right');\n  var brEdgePart = edgePart('bottom-right');\n  var bedgePart = edgePart('bottom');\n  var blEdgePart = edgePart('bottom-left');\n  var ledgePart = edgePart('left');\n  var thumbPart = required({\n    name: 'thumb',\n    defaults: constant({\n      dom: {\n        styles: {\n          position: 'absolute'\n        }\n      }\n    }),\n    overrides: function (detail) {\n      return {\n        events: derive([redirectToPart(touchstart(), detail, 'spectrum'), redirectToPart(touchmove(), detail, 'spectrum'), redirectToPart(touchend(), detail, 'spectrum'), redirectToPart(mousedown(), detail, 'spectrum'), redirectToPart(mousemove(), detail, 'spectrum'), redirectToPart(mouseup(), detail, 'spectrum')])\n      };\n    }\n  });\n  var spectrumPart = required({\n    schema: [state$1('mouseIsDown', function () {\n      return Cell(false);\n    })],\n    name: 'spectrum',\n    overrides: function (detail) {\n      var modelDetail = detail.model;\n      var model = modelDetail.manager;\n\n      var setValueFrom = function (component, simulatedEvent) {\n        return model.getValueFromEvent(simulatedEvent).map(function (value) {\n          return model.setValueFrom(component, detail, value);\n        });\n      };\n\n      return {\n        behaviours: derive$1([Keying.config({\n          mode: 'special',\n          onLeft: function (spectrum) {\n            return model.onLeft(spectrum, detail);\n          },\n          onRight: function (spectrum) {\n            return model.onRight(spectrum, detail);\n          },\n          onUp: function (spectrum) {\n            return model.onUp(spectrum, detail);\n          },\n          onDown: function (spectrum) {\n            return model.onDown(spectrum, detail);\n          }\n        }), Focusing.config({})]),\n        events: derive([run(touchstart(), setValueFrom), run(touchmove(), setValueFrom), run(mousedown(), setValueFrom), run(mousemove(), function (spectrum, se) {\n          if (detail.mouseIsDown.get()) {\n            setValueFrom(spectrum, se);\n          }\n        })])\n      };\n    }\n  });\n  var SliderParts = [labelPart, ledgePart, redgePart, tedgePart, bedgePart, tlEdgePart, trEdgePart, blEdgePart, brEdgePart, thumbPart, spectrumPart];\n  var _sliderChangeEvent = 'slider.change.value';\n  var sliderChangeEvent = constant(_sliderChangeEvent);\n\n  var isTouchEvent = function (evt) {\n    return evt.type.indexOf('touch') !== -1;\n  };\n\n  var getEventSource = function (simulatedEvent) {\n    var evt = simulatedEvent.event.raw;\n\n    if (isTouchEvent(evt)) {\n      var touchEvent = evt;\n      return touchEvent.touches !== undefined && touchEvent.touches.length === 1 ? Optional.some(touchEvent.touches[0]).map(function (t) {\n        return SugarPosition(t.clientX, t.clientY);\n      }) : Optional.none();\n    } else {\n      var mouseEvent = evt;\n      return mouseEvent.clientX !== undefined ? Optional.some(mouseEvent).map(function (me) {\n        return SugarPosition(me.clientX, me.clientY);\n      }) : Optional.none();\n    }\n  };\n\n  var t = 'top',\n      r$1 = 'right',\n      b = 'bottom',\n      l = 'left';\n\n  var minX = function (detail) {\n    return detail.model.minX;\n  };\n\n  var minY = function (detail) {\n    return detail.model.minY;\n  };\n\n  var min1X = function (detail) {\n    return detail.model.minX - 1;\n  };\n\n  var min1Y = function (detail) {\n    return detail.model.minY - 1;\n  };\n\n  var maxX = function (detail) {\n    return detail.model.maxX;\n  };\n\n  var maxY = function (detail) {\n    return detail.model.maxY;\n  };\n\n  var max1X = function (detail) {\n    return detail.model.maxX + 1;\n  };\n\n  var max1Y = function (detail) {\n    return detail.model.maxY + 1;\n  };\n\n  var range$2 = function (detail, max, min) {\n    return max(detail) - min(detail);\n  };\n\n  var xRange = function (detail) {\n    return range$2(detail, maxX, minX);\n  };\n\n  var yRange = function (detail) {\n    return range$2(detail, maxY, minY);\n  };\n\n  var halfX = function (detail) {\n    return xRange(detail) / 2;\n  };\n\n  var halfY = function (detail) {\n    return yRange(detail) / 2;\n  };\n\n  var step = function (detail) {\n    return detail.stepSize;\n  };\n\n  var snap = function (detail) {\n    return detail.snapToGrid;\n  };\n\n  var snapStart = function (detail) {\n    return detail.snapStart;\n  };\n\n  var rounded = function (detail) {\n    return detail.rounded;\n  };\n\n  var hasEdge = function (detail, edgeName) {\n    return detail[edgeName + '-edge'] !== undefined;\n  };\n\n  var hasLEdge = function (detail) {\n    return hasEdge(detail, l);\n  };\n\n  var hasREdge = function (detail) {\n    return hasEdge(detail, r$1);\n  };\n\n  var hasTEdge = function (detail) {\n    return hasEdge(detail, t);\n  };\n\n  var hasBEdge = function (detail) {\n    return hasEdge(detail, b);\n  };\n\n  var currentValue = function (detail) {\n    return detail.model.value.get();\n  };\n\n  var xValue = function (x) {\n    return {\n      x: x\n    };\n  };\n\n  var yValue = function (y) {\n    return {\n      y: y\n    };\n  };\n\n  var xyValue = function (x, y) {\n    return {\n      x: x,\n      y: y\n    };\n  };\n\n  var fireSliderChange = function (component, value) {\n    emitWith(component, sliderChangeEvent(), {\n      value: value\n    });\n  };\n\n  var setToTLEdgeXY = function (edge, detail) {\n    fireSliderChange(edge, xyValue(min1X(detail), min1Y(detail)));\n  };\n\n  var setToTEdge = function (edge, detail) {\n    fireSliderChange(edge, yValue(min1Y(detail)));\n  };\n\n  var setToTEdgeXY = function (edge, detail) {\n    fireSliderChange(edge, xyValue(halfX(detail), min1Y(detail)));\n  };\n\n  var setToTREdgeXY = function (edge, detail) {\n    fireSliderChange(edge, xyValue(max1X(detail), min1Y(detail)));\n  };\n\n  var setToREdge = function (edge, detail) {\n    fireSliderChange(edge, xValue(max1X(detail)));\n  };\n\n  var setToREdgeXY = function (edge, detail) {\n    fireSliderChange(edge, xyValue(max1X(detail), halfY(detail)));\n  };\n\n  var setToBREdgeXY = function (edge, detail) {\n    fireSliderChange(edge, xyValue(max1X(detail), max1Y(detail)));\n  };\n\n  var setToBEdge = function (edge, detail) {\n    fireSliderChange(edge, yValue(max1Y(detail)));\n  };\n\n  var setToBEdgeXY = function (edge, detail) {\n    fireSliderChange(edge, xyValue(halfX(detail), max1Y(detail)));\n  };\n\n  var setToBLEdgeXY = function (edge, detail) {\n    fireSliderChange(edge, xyValue(min1X(detail), max1Y(detail)));\n  };\n\n  var setToLEdge = function (edge, detail) {\n    fireSliderChange(edge, xValue(min1X(detail)));\n  };\n\n  var setToLEdgeXY = function (edge, detail) {\n    fireSliderChange(edge, xyValue(min1X(detail), halfY(detail)));\n  };\n\n  var reduceBy = function (value, min, max, step) {\n    if (value < min) {\n      return value;\n    } else if (value > max) {\n      return max;\n    } else if (value === min) {\n      return min - 1;\n    } else {\n      return Math.max(min, value - step);\n    }\n  };\n\n  var increaseBy = function (value, min, max, step) {\n    if (value > max) {\n      return value;\n    } else if (value < min) {\n      return min;\n    } else if (value === max) {\n      return max + 1;\n    } else {\n      return Math.min(max, value + step);\n    }\n  };\n\n  var capValue = function (value, min, max) {\n    return Math.max(min, Math.min(max, value));\n  };\n\n  var snapValueOf = function (value, min, max, step, snapStart) {\n    return snapStart.fold(function () {\n      var initValue = value - min;\n      var extraValue = Math.round(initValue / step) * step;\n      return capValue(min + extraValue, min - 1, max + 1);\n    }, function (start) {\n      var remainder = (value - start) % step;\n      var adjustment = Math.round(remainder / step);\n      var rawSteps = Math.floor((value - start) / step);\n      var maxSteps = Math.floor((max - start) / step);\n      var numSteps = Math.min(maxSteps, rawSteps + adjustment);\n      var r = start + numSteps * step;\n      return Math.max(start, r);\n    });\n  };\n\n  var findOffsetOf = function (value, min, max) {\n    return Math.min(max, Math.max(value, min)) - min;\n  };\n\n  var findValueOf = function (args) {\n    var min = args.min,\n        max = args.max,\n        range = args.range,\n        value = args.value,\n        step = args.step,\n        snap = args.snap,\n        snapStart = args.snapStart,\n        rounded = args.rounded,\n        hasMinEdge = args.hasMinEdge,\n        hasMaxEdge = args.hasMaxEdge,\n        minBound = args.minBound,\n        maxBound = args.maxBound,\n        screenRange = args.screenRange;\n    var capMin = hasMinEdge ? min - 1 : min;\n    var capMax = hasMaxEdge ? max + 1 : max;\n\n    if (value < minBound) {\n      return capMin;\n    } else if (value > maxBound) {\n      return capMax;\n    } else {\n      var offset = findOffsetOf(value, minBound, maxBound);\n      var newValue = capValue(offset / screenRange * range + min, capMin, capMax);\n\n      if (snap && newValue >= min && newValue <= max) {\n        return snapValueOf(newValue, min, max, step, snapStart);\n      } else if (rounded) {\n        return Math.round(newValue);\n      } else {\n        return newValue;\n      }\n    }\n  };\n\n  var findOffsetOfValue = function (args) {\n    var min = args.min,\n        max = args.max,\n        range = args.range,\n        value = args.value,\n        hasMinEdge = args.hasMinEdge,\n        hasMaxEdge = args.hasMaxEdge,\n        maxBound = args.maxBound,\n        maxOffset = args.maxOffset,\n        centerMinEdge = args.centerMinEdge,\n        centerMaxEdge = args.centerMaxEdge;\n\n    if (value < min) {\n      return hasMinEdge ? 0 : centerMinEdge;\n    } else if (value > max) {\n      return hasMaxEdge ? maxBound : centerMaxEdge;\n    } else {\n      return (value - min) / range * maxOffset;\n    }\n  };\n\n  var top = 'top',\n      right = 'right',\n      bottom = 'bottom',\n      left = 'left',\n      width = 'width',\n      height = 'height';\n\n  var getBounds$1 = function (component) {\n    return component.element.dom.getBoundingClientRect();\n  };\n\n  var getBoundsProperty = function (bounds, property) {\n    return bounds[property];\n  };\n\n  var getMinXBounds = function (component) {\n    var bounds = getBounds$1(component);\n    return getBoundsProperty(bounds, left);\n  };\n\n  var getMaxXBounds = function (component) {\n    var bounds = getBounds$1(component);\n    return getBoundsProperty(bounds, right);\n  };\n\n  var getMinYBounds = function (component) {\n    var bounds = getBounds$1(component);\n    return getBoundsProperty(bounds, top);\n  };\n\n  var getMaxYBounds = function (component) {\n    var bounds = getBounds$1(component);\n    return getBoundsProperty(bounds, bottom);\n  };\n\n  var getXScreenRange = function (component) {\n    var bounds = getBounds$1(component);\n    return getBoundsProperty(bounds, width);\n  };\n\n  var getYScreenRange = function (component) {\n    var bounds = getBounds$1(component);\n    return getBoundsProperty(bounds, height);\n  };\n\n  var getCenterOffsetOf = function (componentMinEdge, componentMaxEdge, spectrumMinEdge) {\n    return (componentMinEdge + componentMaxEdge) / 2 - spectrumMinEdge;\n  };\n\n  var getXCenterOffSetOf = function (component, spectrum) {\n    var componentBounds = getBounds$1(component);\n    var spectrumBounds = getBounds$1(spectrum);\n    var componentMinEdge = getBoundsProperty(componentBounds, left);\n    var componentMaxEdge = getBoundsProperty(componentBounds, right);\n    var spectrumMinEdge = getBoundsProperty(spectrumBounds, left);\n    return getCenterOffsetOf(componentMinEdge, componentMaxEdge, spectrumMinEdge);\n  };\n\n  var getYCenterOffSetOf = function (component, spectrum) {\n    var componentBounds = getBounds$1(component);\n    var spectrumBounds = getBounds$1(spectrum);\n    var componentMinEdge = getBoundsProperty(componentBounds, top);\n    var componentMaxEdge = getBoundsProperty(componentBounds, bottom);\n    var spectrumMinEdge = getBoundsProperty(spectrumBounds, top);\n    return getCenterOffsetOf(componentMinEdge, componentMaxEdge, spectrumMinEdge);\n  };\n\n  var fireSliderChange$1 = function (spectrum, value) {\n    emitWith(spectrum, sliderChangeEvent(), {\n      value: value\n    });\n  };\n\n  var sliderValue = function (x) {\n    return {\n      x: x\n    };\n  };\n\n  var findValueOfOffset = function (spectrum, detail, left) {\n    var args = {\n      min: minX(detail),\n      max: maxX(detail),\n      range: xRange(detail),\n      value: left,\n      step: step(detail),\n      snap: snap(detail),\n      snapStart: snapStart(detail),\n      rounded: rounded(detail),\n      hasMinEdge: hasLEdge(detail),\n      hasMaxEdge: hasREdge(detail),\n      minBound: getMinXBounds(spectrum),\n      maxBound: getMaxXBounds(spectrum),\n      screenRange: getXScreenRange(spectrum)\n    };\n    return findValueOf(args);\n  };\n\n  var setValueFrom = function (spectrum, detail, value) {\n    var xValue = findValueOfOffset(spectrum, detail, value);\n    var sliderVal = sliderValue(xValue);\n    fireSliderChange$1(spectrum, sliderVal);\n    return xValue;\n  };\n\n  var setToMin = function (spectrum, detail) {\n    var min = minX(detail);\n    fireSliderChange$1(spectrum, sliderValue(min));\n  };\n\n  var setToMax = function (spectrum, detail) {\n    var max = maxX(detail);\n    fireSliderChange$1(spectrum, sliderValue(max));\n  };\n\n  var moveBy = function (direction, spectrum, detail) {\n    var f = direction > 0 ? increaseBy : reduceBy;\n    var xValue = f(currentValue(detail).x, minX(detail), maxX(detail), step(detail));\n    fireSliderChange$1(spectrum, sliderValue(xValue));\n    return Optional.some(xValue);\n  };\n\n  var handleMovement = function (direction) {\n    return function (spectrum, detail) {\n      return moveBy(direction, spectrum, detail).map(always);\n    };\n  };\n\n  var getValueFromEvent = function (simulatedEvent) {\n    var pos = getEventSource(simulatedEvent);\n    return pos.map(function (p) {\n      return p.left;\n    });\n  };\n\n  var findOffsetOfValue$1 = function (spectrum, detail, value, minEdge, maxEdge) {\n    var minOffset = 0;\n    var maxOffset = getXScreenRange(spectrum);\n    var centerMinEdge = minEdge.bind(function (edge) {\n      return Optional.some(getXCenterOffSetOf(edge, spectrum));\n    }).getOr(minOffset);\n    var centerMaxEdge = maxEdge.bind(function (edge) {\n      return Optional.some(getXCenterOffSetOf(edge, spectrum));\n    }).getOr(maxOffset);\n    var args = {\n      min: minX(detail),\n      max: maxX(detail),\n      range: xRange(detail),\n      value: value,\n      hasMinEdge: hasLEdge(detail),\n      hasMaxEdge: hasREdge(detail),\n      minBound: getMinXBounds(spectrum),\n      minOffset: minOffset,\n      maxBound: getMaxXBounds(spectrum),\n      maxOffset: maxOffset,\n      centerMinEdge: centerMinEdge,\n      centerMaxEdge: centerMaxEdge\n    };\n    return findOffsetOfValue(args);\n  };\n\n  var findPositionOfValue = function (slider, spectrum, value, minEdge, maxEdge, detail) {\n    var offset = findOffsetOfValue$1(spectrum, detail, value, minEdge, maxEdge);\n    return getMinXBounds(spectrum) - getMinXBounds(slider) + offset;\n  };\n\n  var setPositionFromValue = function (slider, thumb, detail, edges) {\n    var value = currentValue(detail);\n    var pos = findPositionOfValue(slider, edges.getSpectrum(slider), value.x, edges.getLeftEdge(slider), edges.getRightEdge(slider), detail);\n    var thumbRadius = get$8(thumb.element) / 2;\n    set$2(thumb.element, 'left', pos - thumbRadius + 'px');\n  };\n\n  var onLeft = handleMovement(-1);\n  var onRight = handleMovement(1);\n  var onUp = Optional.none;\n  var onDown = Optional.none;\n  var edgeActions = {\n    'top-left': Optional.none(),\n    'top': Optional.none(),\n    'top-right': Optional.none(),\n    'right': Optional.some(setToREdge),\n    'bottom-right': Optional.none(),\n    'bottom': Optional.none(),\n    'bottom-left': Optional.none(),\n    'left': Optional.some(setToLEdge)\n  };\n  var HorizontalModel = /*#__PURE__*/Object.freeze({\n    __proto__: null,\n    setValueFrom: setValueFrom,\n    setToMin: setToMin,\n    setToMax: setToMax,\n    findValueOfOffset: findValueOfOffset,\n    getValueFromEvent: getValueFromEvent,\n    findPositionOfValue: findPositionOfValue,\n    setPositionFromValue: setPositionFromValue,\n    onLeft: onLeft,\n    onRight: onRight,\n    onUp: onUp,\n    onDown: onDown,\n    edgeActions: edgeActions\n  });\n\n  var fireSliderChange$2 = function (spectrum, value) {\n    emitWith(spectrum, sliderChangeEvent(), {\n      value: value\n    });\n  };\n\n  var sliderValue$1 = function (y) {\n    return {\n      y: y\n    };\n  };\n\n  var findValueOfOffset$1 = function (spectrum, detail, top) {\n    var args = {\n      min: minY(detail),\n      max: maxY(detail),\n      range: yRange(detail),\n      value: top,\n      step: step(detail),\n      snap: snap(detail),\n      snapStart: snapStart(detail),\n      rounded: rounded(detail),\n      hasMinEdge: hasTEdge(detail),\n      hasMaxEdge: hasBEdge(detail),\n      minBound: getMinYBounds(spectrum),\n      maxBound: getMaxYBounds(spectrum),\n      screenRange: getYScreenRange(spectrum)\n    };\n    return findValueOf(args);\n  };\n\n  var setValueFrom$1 = function (spectrum, detail, value) {\n    var yValue = findValueOfOffset$1(spectrum, detail, value);\n    var sliderVal = sliderValue$1(yValue);\n    fireSliderChange$2(spectrum, sliderVal);\n    return yValue;\n  };\n\n  var setToMin$1 = function (spectrum, detail) {\n    var min = minY(detail);\n    fireSliderChange$2(spectrum, sliderValue$1(min));\n  };\n\n  var setToMax$1 = function (spectrum, detail) {\n    var max = maxY(detail);\n    fireSliderChange$2(spectrum, sliderValue$1(max));\n  };\n\n  var moveBy$1 = function (direction, spectrum, detail) {\n    var f = direction > 0 ? increaseBy : reduceBy;\n    var yValue = f(currentValue(detail).y, minY(detail), maxY(detail), step(detail));\n    fireSliderChange$2(spectrum, sliderValue$1(yValue));\n    return Optional.some(yValue);\n  };\n\n  var handleMovement$1 = function (direction) {\n    return function (spectrum, detail) {\n      return moveBy$1(direction, spectrum, detail).map(always);\n    };\n  };\n\n  var getValueFromEvent$1 = function (simulatedEvent) {\n    var pos = getEventSource(simulatedEvent);\n    return pos.map(function (p) {\n      return p.top;\n    });\n  };\n\n  var findOffsetOfValue$2 = function (spectrum, detail, value, minEdge, maxEdge) {\n    var minOffset = 0;\n    var maxOffset = getYScreenRange(spectrum);\n    var centerMinEdge = minEdge.bind(function (edge) {\n      return Optional.some(getYCenterOffSetOf(edge, spectrum));\n    }).getOr(minOffset);\n    var centerMaxEdge = maxEdge.bind(function (edge) {\n      return Optional.some(getYCenterOffSetOf(edge, spectrum));\n    }).getOr(maxOffset);\n    var args = {\n      min: minY(detail),\n      max: maxY(detail),\n      range: yRange(detail),\n      value: value,\n      hasMinEdge: hasTEdge(detail),\n      hasMaxEdge: hasBEdge(detail),\n      minBound: getMinYBounds(spectrum),\n      minOffset: minOffset,\n      maxBound: getMaxYBounds(spectrum),\n      maxOffset: maxOffset,\n      centerMinEdge: centerMinEdge,\n      centerMaxEdge: centerMaxEdge\n    };\n    return findOffsetOfValue(args);\n  };\n\n  var findPositionOfValue$1 = function (slider, spectrum, value, minEdge, maxEdge, detail) {\n    var offset = findOffsetOfValue$2(spectrum, detail, value, minEdge, maxEdge);\n    return getMinYBounds(spectrum) - getMinYBounds(slider) + offset;\n  };\n\n  var setPositionFromValue$1 = function (slider, thumb, detail, edges) {\n    var value = currentValue(detail);\n    var pos = findPositionOfValue$1(slider, edges.getSpectrum(slider), value.y, edges.getTopEdge(slider), edges.getBottomEdge(slider), detail);\n    var thumbRadius = get$7(thumb.element) / 2;\n    set$2(thumb.element, 'top', pos - thumbRadius + 'px');\n  };\n\n  var onLeft$1 = Optional.none;\n  var onRight$1 = Optional.none;\n  var onUp$1 = handleMovement$1(-1);\n  var onDown$1 = handleMovement$1(1);\n  var edgeActions$1 = {\n    'top-left': Optional.none(),\n    'top': Optional.some(setToTEdge),\n    'top-right': Optional.none(),\n    'right': Optional.none(),\n    'bottom-right': Optional.none(),\n    'bottom': Optional.some(setToBEdge),\n    'bottom-left': Optional.none(),\n    'left': Optional.none()\n  };\n  var VerticalModel = /*#__PURE__*/Object.freeze({\n    __proto__: null,\n    setValueFrom: setValueFrom$1,\n    setToMin: setToMin$1,\n    setToMax: setToMax$1,\n    findValueOfOffset: findValueOfOffset$1,\n    getValueFromEvent: getValueFromEvent$1,\n    findPositionOfValue: findPositionOfValue$1,\n    setPositionFromValue: setPositionFromValue$1,\n    onLeft: onLeft$1,\n    onRight: onRight$1,\n    onUp: onUp$1,\n    onDown: onDown$1,\n    edgeActions: edgeActions$1\n  });\n\n  var fireSliderChange$3 = function (spectrum, value) {\n    emitWith(spectrum, sliderChangeEvent(), {\n      value: value\n    });\n  };\n\n  var sliderValue$2 = function (x, y) {\n    return {\n      x: x,\n      y: y\n    };\n  };\n\n  var setValueFrom$2 = function (spectrum, detail, value) {\n    var xValue = findValueOfOffset(spectrum, detail, value.left);\n    var yValue = findValueOfOffset$1(spectrum, detail, value.top);\n    var val = sliderValue$2(xValue, yValue);\n    fireSliderChange$3(spectrum, val);\n    return val;\n  };\n\n  var moveBy$2 = function (direction, isVerticalMovement, spectrum, detail) {\n    var f = direction > 0 ? increaseBy : reduceBy;\n    var xValue = isVerticalMovement ? currentValue(detail).x : f(currentValue(detail).x, minX(detail), maxX(detail), step(detail));\n    var yValue = !isVerticalMovement ? currentValue(detail).y : f(currentValue(detail).y, minY(detail), maxY(detail), step(detail));\n    fireSliderChange$3(spectrum, sliderValue$2(xValue, yValue));\n    return Optional.some(xValue);\n  };\n\n  var handleMovement$2 = function (direction, isVerticalMovement) {\n    return function (spectrum, detail) {\n      return moveBy$2(direction, isVerticalMovement, spectrum, detail).map(always);\n    };\n  };\n\n  var setToMin$2 = function (spectrum, detail) {\n    var mX = minX(detail);\n    var mY = minY(detail);\n    fireSliderChange$3(spectrum, sliderValue$2(mX, mY));\n  };\n\n  var setToMax$2 = function (spectrum, detail) {\n    var mX = maxX(detail);\n    var mY = maxY(detail);\n    fireSliderChange$3(spectrum, sliderValue$2(mX, mY));\n  };\n\n  var getValueFromEvent$2 = function (simulatedEvent) {\n    return getEventSource(simulatedEvent);\n  };\n\n  var setPositionFromValue$2 = function (slider, thumb, detail, edges) {\n    var value = currentValue(detail);\n    var xPos = findPositionOfValue(slider, edges.getSpectrum(slider), value.x, edges.getLeftEdge(slider), edges.getRightEdge(slider), detail);\n    var yPos = findPositionOfValue$1(slider, edges.getSpectrum(slider), value.y, edges.getTopEdge(slider), edges.getBottomEdge(slider), detail);\n    var thumbXRadius = get$8(thumb.element) / 2;\n    var thumbYRadius = get$7(thumb.element) / 2;\n    set$2(thumb.element, 'left', xPos - thumbXRadius + 'px');\n    set$2(thumb.element, 'top', yPos - thumbYRadius + 'px');\n  };\n\n  var onLeft$2 = handleMovement$2(-1, false);\n  var onRight$2 = handleMovement$2(1, false);\n  var onUp$2 = handleMovement$2(-1, true);\n  var onDown$2 = handleMovement$2(1, true);\n  var edgeActions$2 = {\n    'top-left': Optional.some(setToTLEdgeXY),\n    'top': Optional.some(setToTEdgeXY),\n    'top-right': Optional.some(setToTREdgeXY),\n    'right': Optional.some(setToREdgeXY),\n    'bottom-right': Optional.some(setToBREdgeXY),\n    'bottom': Optional.some(setToBEdgeXY),\n    'bottom-left': Optional.some(setToBLEdgeXY),\n    'left': Optional.some(setToLEdgeXY)\n  };\n  var TwoDModel = /*#__PURE__*/Object.freeze({\n    __proto__: null,\n    setValueFrom: setValueFrom$2,\n    setToMin: setToMin$2,\n    setToMax: setToMax$2,\n    getValueFromEvent: getValueFromEvent$2,\n    setPositionFromValue: setPositionFromValue$2,\n    onLeft: onLeft$2,\n    onRight: onRight$2,\n    onUp: onUp$2,\n    onDown: onDown$2,\n    edgeActions: edgeActions$2\n  });\n  var SliderSchema = [defaulted$1('stepSize', 1), defaulted$1('onChange', noop), defaulted$1('onChoose', noop), defaulted$1('onInit', noop), defaulted$1('onDragStart', noop), defaulted$1('onDragEnd', noop), defaulted$1('snapToGrid', false), defaulted$1('rounded', true), option('snapStart'), strictOf('model', choose$1('mode', {\n    x: [defaulted$1('minX', 0), defaulted$1('maxX', 100), state$1('value', function (spec) {\n      return Cell(spec.mode.minX);\n    }), strict$1('getInitialValue'), output('manager', HorizontalModel)],\n    y: [defaulted$1('minY', 0), defaulted$1('maxY', 100), state$1('value', function (spec) {\n      return Cell(spec.mode.minY);\n    }), strict$1('getInitialValue'), output('manager', VerticalModel)],\n    xy: [defaulted$1('minX', 0), defaulted$1('maxX', 100), defaulted$1('minY', 0), defaulted$1('maxY', 100), state$1('value', function (spec) {\n      return Cell({\n        x: spec.mode.minX,\n        y: spec.mode.minY\n      });\n    }), strict$1('getInitialValue'), output('manager', TwoDModel)]\n  })), field$1('sliderBehaviours', [Keying, Representing]), state$1('mouseIsDown', function () {\n    return Cell(false);\n  })];\n\n  var sketch = function (detail, components, _spec, _externals) {\n    var _a;\n\n    var getThumb = function (component) {\n      return getPartOrDie(component, detail, 'thumb');\n    };\n\n    var getSpectrum = function (component) {\n      return getPartOrDie(component, detail, 'spectrum');\n    };\n\n    var getLeftEdge = function (component) {\n      return getPart(component, detail, 'left-edge');\n    };\n\n    var getRightEdge = function (component) {\n      return getPart(component, detail, 'right-edge');\n    };\n\n    var getTopEdge = function (component) {\n      return getPart(component, detail, 'top-edge');\n    };\n\n    var getBottomEdge = function (component) {\n      return getPart(component, detail, 'bottom-edge');\n    };\n\n    var modelDetail = detail.model;\n    var model = modelDetail.manager;\n\n    var refresh = function (slider, thumb) {\n      model.setPositionFromValue(slider, thumb, detail, {\n        getLeftEdge: getLeftEdge,\n        getRightEdge: getRightEdge,\n        getTopEdge: getTopEdge,\n        getBottomEdge: getBottomEdge,\n        getSpectrum: getSpectrum\n      });\n    };\n\n    var setValue = function (slider, newValue) {\n      modelDetail.value.set(newValue);\n      var thumb = getThumb(slider);\n      refresh(slider, thumb);\n    };\n\n    var changeValue = function (slider, newValue) {\n      setValue(slider, newValue);\n      var thumb = getThumb(slider);\n      detail.onChange(slider, thumb, newValue);\n      return Optional.some(true);\n    };\n\n    var resetToMin = function (slider) {\n      model.setToMin(slider, detail);\n    };\n\n    var resetToMax = function (slider) {\n      model.setToMax(slider, detail);\n    };\n\n    var choose = function (slider) {\n      var fireOnChoose = function () {\n        getPart(slider, detail, 'thumb').each(function (thumb) {\n          var value = modelDetail.value.get();\n          detail.onChoose(slider, thumb, value);\n        });\n      };\n\n      var wasDown = detail.mouseIsDown.get();\n      detail.mouseIsDown.set(false);\n\n      if (wasDown) {\n        fireOnChoose();\n      }\n    };\n\n    var onDragStart = function (slider, simulatedEvent) {\n      simulatedEvent.stop();\n      detail.mouseIsDown.set(true);\n      detail.onDragStart(slider, getThumb(slider));\n    };\n\n    var onDragEnd = function (slider, simulatedEvent) {\n      simulatedEvent.stop();\n      detail.onDragEnd(slider, getThumb(slider));\n      choose(slider);\n    };\n\n    return {\n      uid: detail.uid,\n      dom: detail.dom,\n      components: components,\n      behaviours: augment(detail.sliderBehaviours, [Keying.config({\n        mode: 'special',\n        focusIn: function (slider) {\n          return getPart(slider, detail, 'spectrum').map(Keying.focusIn).map(always);\n        }\n      }), Representing.config({\n        store: {\n          mode: 'manual',\n          getValue: function (_) {\n            return modelDetail.value.get();\n          }\n        }\n      }), Receiving.config({\n        channels: (_a = {}, _a[mouseReleased()] = {\n          onReceive: choose\n        }, _a)\n      })]),\n      events: derive([run(sliderChangeEvent(), function (slider, simulatedEvent) {\n        changeValue(slider, simulatedEvent.event.value);\n      }), runOnAttached(function (slider, _simulatedEvent) {\n        var getInitial = modelDetail.getInitialValue();\n        modelDetail.value.set(getInitial);\n        var thumb = getThumb(slider);\n        refresh(slider, thumb);\n        var spectrum = getSpectrum(slider);\n        detail.onInit(slider, thumb, spectrum, modelDetail.value.get());\n      }), run(touchstart(), onDragStart), run(touchend(), onDragEnd), run(mousedown(), onDragStart), run(mouseup(), onDragEnd)]),\n      apis: {\n        resetToMin: resetToMin,\n        resetToMax: resetToMax,\n        setValue: setValue,\n        refresh: refresh\n      },\n      domModification: {\n        styles: {\n          position: 'relative'\n        }\n      }\n    };\n  };\n\n  var Slider = composite$1({\n    name: 'Slider',\n    configFields: SliderSchema,\n    partFields: SliderParts,\n    factory: sketch,\n    apis: {\n      setValue: function (apis, slider, value) {\n        apis.setValue(slider, value);\n      },\n      resetToMin: function (apis, slider) {\n        apis.resetToMin(slider);\n      },\n      resetToMax: function (apis, slider) {\n        apis.resetToMax(slider);\n      },\n      refresh: function (apis, slider) {\n        apis.refresh(slider);\n      }\n    }\n  });\n\n  var hsvColour = function (hue, saturation, value) {\n    return {\n      hue: hue,\n      saturation: saturation,\n      value: value\n    };\n  };\n\n  var fromRgb = function (rgbaColour) {\n    var h = 0;\n    var s = 0;\n    var v = 0;\n    var r = rgbaColour.red / 255;\n    var g = rgbaColour.green / 255;\n    var b = rgbaColour.blue / 255;\n    var minRGB = Math.min(r, Math.min(g, b));\n    var maxRGB = Math.max(r, Math.max(g, b));\n\n    if (minRGB === maxRGB) {\n      v = minRGB;\n      return hsvColour(0, 0, v * 100);\n    }\n\n    var d = r === minRGB ? g - b : b === minRGB ? r - g : b - r;\n    h = r === minRGB ? 3 : b === minRGB ? 1 : 5;\n    h = 60 * (h - d / (maxRGB - minRGB));\n    s = (maxRGB - minRGB) / maxRGB;\n    v = maxRGB;\n    return hsvColour(Math.round(h), Math.round(s * 100), Math.round(v * 100));\n  };\n\n  var hexToHsv = function (hex) {\n    return fromRgb(fromHex(hex));\n  };\n\n  var hsvToHex = function (hsv) {\n    return fromRgba(fromHsv(hsv));\n  };\n\n  var fieldsUpdate = generate$1('rgb-hex-update');\n  var sliderUpdate = generate$1('slider-update');\n  var paletteUpdate = generate$1('palette-update');\n\n  var sliderFactory = function (translate, getClass) {\n    var spectrum = Slider.parts.spectrum({\n      dom: {\n        tag: 'div',\n        classes: [getClass('hue-slider-spectrum')],\n        attributes: {\n          role: 'presentation'\n        }\n      }\n    });\n    var thumb = Slider.parts.thumb({\n      dom: {\n        tag: 'div',\n        classes: [getClass('hue-slider-thumb')],\n        attributes: {\n          role: 'presentation'\n        }\n      }\n    });\n    return Slider.sketch({\n      dom: {\n        tag: 'div',\n        classes: [getClass('hue-slider')],\n        attributes: {\n          role: 'presentation'\n        }\n      },\n      rounded: false,\n      model: {\n        mode: 'y',\n        getInitialValue: constant({\n          y: 0\n        })\n      },\n      components: [spectrum, thumb],\n      sliderBehaviours: derive$1([Focusing.config({})]),\n      onChange: function (slider, _thumb, value) {\n        emitWith(slider, sliderUpdate, {\n          value: value\n        });\n      }\n    });\n  };\n\n  var owner$3 = 'form';\n  var schema$h = [field$1('formBehaviours', [Representing])];\n\n  var getPartName = function (name) {\n    return '<alloy.field.' + name + '>';\n  };\n\n  var sketch$1 = function (fSpec) {\n    var parts = function () {\n      var record = [];\n\n      var field = function (name, config) {\n        record.push(name);\n        return generateOne(owner$3, getPartName(name), config);\n      };\n\n      return {\n        field: field,\n        record: function () {\n          return record;\n        }\n      };\n    }();\n\n    var spec = fSpec(parts);\n    var partNames = parts.record();\n    var fieldParts = map(partNames, function (n) {\n      return required({\n        name: n,\n        pname: getPartName(n)\n      });\n    });\n    return composite(owner$3, schema$h, fieldParts, make$4, spec);\n  };\n\n  var toResult$1 = function (o, e) {\n    return o.fold(function () {\n      return Result.error(e);\n    }, Result.value);\n  };\n\n  var make$4 = function (detail, components) {\n    return {\n      uid: detail.uid,\n      dom: detail.dom,\n      components: components,\n      behaviours: augment(detail.formBehaviours, [Representing.config({\n        store: {\n          mode: 'manual',\n          getValue: function (form) {\n            var resPs = getAllParts(form, detail);\n            return map$2(resPs, function (resPThunk, pName) {\n              return resPThunk().bind(function (v) {\n                var opt = Composing.getCurrent(v);\n                return toResult$1(opt, new Error('Cannot find a current component to extract the value from for form part \\'' + pName + '\\': ' + element(v.element)));\n              }).map(Representing.getValue);\n            });\n          },\n          setValue: function (form, values) {\n            each$1(values, function (newValue, key) {\n              getPart(form, detail, key).each(function (wrapper) {\n                Composing.getCurrent(wrapper).each(function (field) {\n                  Representing.setValue(field, newValue);\n                });\n              });\n            });\n          }\n        }\n      })]),\n      apis: {\n        getField: function (form, key) {\n          return getPart(form, detail, key).bind(Composing.getCurrent);\n        }\n      }\n    };\n  };\n\n  var Form = {\n    getField: makeApi(function (apis, component, key) {\n      return apis.getField(component, key);\n    }),\n    sketch: sketch$1\n  };\n  var validInput = generate$1('valid-input');\n  var invalidInput = generate$1('invalid-input');\n  var validatingInput = generate$1('validating-input');\n  var translatePrefix = 'colorcustom.rgb.';\n\n  var rgbFormFactory = function (translate, getClass, onValidHexx, onInvalidHexx) {\n    var invalidation = function (label, isValid) {\n      return Invalidating.config({\n        invalidClass: getClass('invalid'),\n        notify: {\n          onValidate: function (comp) {\n            emitWith(comp, validatingInput, {\n              type: label\n            });\n          },\n          onValid: function (comp) {\n            emitWith(comp, validInput, {\n              type: label,\n              value: Representing.getValue(comp)\n            });\n          },\n          onInvalid: function (comp) {\n            emitWith(comp, invalidInput, {\n              type: label,\n              value: Representing.getValue(comp)\n            });\n          }\n        },\n        validator: {\n          validate: function (comp) {\n            var value = Representing.getValue(comp);\n            var res = isValid(value) ? Result.value(true) : Result.error(translate('aria.input.invalid'));\n            return Future.pure(res);\n          },\n          validateOnLoad: false\n        }\n      });\n    };\n\n    var renderTextField = function (isValid, name, label, description, data) {\n      var helptext = translate(translatePrefix + 'range');\n      var pLabel = FormField.parts.label({\n        dom: {\n          tag: 'label',\n          innerHtml: label,\n          attributes: {\n            'aria-label': description\n          }\n        }\n      });\n      var pField = FormField.parts.field({\n        data: data,\n        factory: Input,\n        inputAttributes: __assign({\n          type: 'text'\n        }, name === 'hex' ? {\n          'aria-live': 'polite'\n        } : {}),\n        inputClasses: [getClass('textfield')],\n        inputBehaviours: derive$1([invalidation(name, isValid), Tabstopping.config({})]),\n        onSetValue: function (input) {\n          if (Invalidating.isInvalid(input)) {\n            var run = Invalidating.run(input);\n            run.get(noop);\n          }\n        }\n      });\n      var comps = [pLabel, pField];\n      var concats = name !== 'hex' ? [FormField.parts['aria-descriptor']({\n        text: helptext\n      })] : [];\n      var components = comps.concat(concats);\n      return {\n        dom: {\n          tag: 'div',\n          attributes: {\n            role: 'presentation'\n          }\n        },\n        components: components\n      };\n    };\n\n    var copyRgbToHex = function (form, rgba) {\n      var hex = fromRgba(rgba);\n      Form.getField(form, 'hex').each(function (hexField) {\n        if (!Focusing.isFocused(hexField)) {\n          Representing.setValue(form, {\n            hex: hex.value\n          });\n        }\n      });\n      return hex;\n    };\n\n    var copyRgbToForm = function (form, rgb) {\n      var red = rgb.red;\n      var green = rgb.green;\n      var blue = rgb.blue;\n      Representing.setValue(form, {\n        red: red,\n        green: green,\n        blue: blue\n      });\n    };\n\n    var memPreview = record({\n      dom: {\n        tag: 'div',\n        classes: [getClass('rgba-preview')],\n        styles: {\n          'background-color': 'white'\n        },\n        attributes: {\n          role: 'presentation'\n        }\n      }\n    });\n\n    var updatePreview = function (anyInSystem, hex) {\n      memPreview.getOpt(anyInSystem).each(function (preview) {\n        set$2(preview.element, 'background-color', '#' + hex.value);\n      });\n    };\n\n    var factory = function () {\n      var state = {\n        red: Cell(Optional.some(255)),\n        green: Cell(Optional.some(255)),\n        blue: Cell(Optional.some(255)),\n        hex: Cell(Optional.some('ffffff'))\n      };\n\n      var copyHexToRgb = function (form, hex) {\n        var rgb = fromHex(hex);\n        copyRgbToForm(form, rgb);\n        setValueRgb(rgb);\n      };\n\n      var get = function (prop) {\n        return state[prop].get();\n      };\n\n      var set = function (prop, value) {\n        state[prop].set(value);\n      };\n\n      var getValueRgb = function () {\n        return get('red').bind(function (red) {\n          return get('green').bind(function (green) {\n            return get('blue').map(function (blue) {\n              return rgbaColour(red, green, blue, 1);\n            });\n          });\n        });\n      };\n\n      var setValueRgb = function (rgb) {\n        var red = rgb.red;\n        var green = rgb.green;\n        var blue = rgb.blue;\n        set('red', Optional.some(red));\n        set('green', Optional.some(green));\n        set('blue', Optional.some(blue));\n      };\n\n      var onInvalidInput = function (form, simulatedEvent) {\n        var data = simulatedEvent.event;\n\n        if (data.type !== 'hex') {\n          set(data.type, Optional.none());\n        } else {\n          onInvalidHexx(form);\n        }\n      };\n\n      var onValidHex = function (form, value) {\n        onValidHexx(form);\n        var hex = hexColour(value);\n        set('hex', Optional.some(value));\n        var rgb = fromHex(hex);\n        copyRgbToForm(form, rgb);\n        setValueRgb(rgb);\n        emitWith(form, fieldsUpdate, {\n          hex: hex\n        });\n        updatePreview(form, hex);\n      };\n\n      var onValidRgb = function (form, prop, value) {\n        var val = parseInt(value, 10);\n        set(prop, Optional.some(val));\n        getValueRgb().each(function (rgb) {\n          var hex = copyRgbToHex(form, rgb);\n          emitWith(form, fieldsUpdate, {\n            hex: hex\n          });\n          updatePreview(form, hex);\n        });\n      };\n\n      var isHexInputEvent = function (data) {\n        return data.type === 'hex';\n      };\n\n      var onValidInput = function (form, simulatedEvent) {\n        var data = simulatedEvent.event;\n\n        if (isHexInputEvent(data)) {\n          onValidHex(form, data.value);\n        } else {\n          onValidRgb(form, data.type, data.value);\n        }\n      };\n\n      var formPartStrings = function (key) {\n        return {\n          label: translate(translatePrefix + key + '.label'),\n          description: translate(translatePrefix + key + '.description')\n        };\n      };\n\n      var redStrings = formPartStrings('red');\n      var greenStrings = formPartStrings('green');\n      var blueStrings = formPartStrings('blue');\n      var hexStrings = formPartStrings('hex');\n      return deepMerge(Form.sketch(function (parts) {\n        return {\n          dom: {\n            tag: 'form',\n            classes: [getClass('rgb-form')],\n            attributes: {\n              'aria-label': translate('aria.color.picker')\n            }\n          },\n          components: [parts.field('red', FormField.sketch(renderTextField(isRgbaComponent, 'red', redStrings.label, redStrings.description, 255))), parts.field('green', FormField.sketch(renderTextField(isRgbaComponent, 'green', greenStrings.label, greenStrings.description, 255))), parts.field('blue', FormField.sketch(renderTextField(isRgbaComponent, 'blue', blueStrings.label, blueStrings.description, 255))), parts.field('hex', FormField.sketch(renderTextField(isHexString, 'hex', hexStrings.label, hexStrings.description, 'ffffff'))), memPreview.asSpec()],\n          formBehaviours: derive$1([Invalidating.config({\n            invalidClass: getClass('form-invalid')\n          }), config('rgb-form-events', [run(validInput, onValidInput), run(invalidInput, onInvalidInput), run(validatingInput, onInvalidInput)])])\n        };\n      }), {\n        apis: {\n          updateHex: function (form, hex) {\n            Representing.setValue(form, {\n              hex: hex.value\n            });\n            copyHexToRgb(form, hex);\n            updatePreview(form, hex);\n          }\n        }\n      });\n    };\n\n    var rgbFormSketcher = single$2({\n      factory: factory,\n      name: 'RgbForm',\n      configFields: [],\n      apis: {\n        updateHex: function (apis, form, hex) {\n          apis.updateHex(form, hex);\n        }\n      },\n      extraApis: {}\n    });\n    return rgbFormSketcher;\n  };\n\n  var paletteFactory = function (_translate, getClass) {\n    var spectrumPart = Slider.parts.spectrum({\n      dom: {\n        tag: 'canvas',\n        attributes: {\n          role: 'presentation'\n        },\n        classes: [getClass('sv-palette-spectrum')]\n      }\n    });\n    var thumbPart = Slider.parts.thumb({\n      dom: {\n        tag: 'div',\n        attributes: {\n          role: 'presentation'\n        },\n        classes: [getClass('sv-palette-thumb')],\n        innerHtml: '<div class=' + getClass('sv-palette-inner-thumb') + ' role=\"presentation\"></div>'\n      }\n    });\n\n    var setColour = function (canvas, rgba) {\n      var width = canvas.width,\n          height = canvas.height;\n      var ctx = canvas.getContext('2d');\n\n      if (ctx === null) {\n        return;\n      }\n\n      ctx.fillStyle = rgba;\n      ctx.fillRect(0, 0, width, height);\n      var grdWhite = ctx.createLinearGradient(0, 0, width, 0);\n      grdWhite.addColorStop(0, 'rgba(255,255,255,1)');\n      grdWhite.addColorStop(1, 'rgba(255,255,255,0)');\n      ctx.fillStyle = grdWhite;\n      ctx.fillRect(0, 0, width, height);\n      var grdBlack = ctx.createLinearGradient(0, 0, 0, height);\n      grdBlack.addColorStop(0, 'rgba(0,0,0,0)');\n      grdBlack.addColorStop(1, 'rgba(0,0,0,1)');\n      ctx.fillStyle = grdBlack;\n      ctx.fillRect(0, 0, width, height);\n    };\n\n    var setPaletteHue = function (slider, hue) {\n      var canvas = slider.components()[0].element.dom;\n      var hsv = hsvColour(hue, 100, 100);\n      var rgba = fromHsv(hsv);\n      setColour(canvas, toString(rgba));\n    };\n\n    var setPaletteThumb = function (slider, hex) {\n      var hsv = fromRgb(fromHex(hex));\n      Slider.setValue(slider, {\n        x: hsv.saturation,\n        y: 100 - hsv.value\n      });\n    };\n\n    var factory = function (_detail) {\n      var getInitialValue = constant({\n        x: 0,\n        y: 0\n      });\n\n      var onChange = function (slider, _thumb, value) {\n        emitWith(slider, paletteUpdate, {\n          value: value\n        });\n      };\n\n      var onInit = function (_slider, _thumb, spectrum, _value) {\n        setColour(spectrum.element.dom, toString(red));\n      };\n\n      var sliderBehaviours = derive$1([Composing.config({\n        find: Optional.some\n      }), Focusing.config({})]);\n      return Slider.sketch({\n        dom: {\n          tag: 'div',\n          attributes: {\n            role: 'presentation'\n          },\n          classes: [getClass('sv-palette')]\n        },\n        model: {\n          mode: 'xy',\n          getInitialValue: getInitialValue\n        },\n        rounded: false,\n        components: [spectrumPart, thumbPart],\n        onChange: onChange,\n        onInit: onInit,\n        sliderBehaviours: sliderBehaviours\n      });\n    };\n\n    var saturationBrightnessPaletteSketcher = single$2({\n      factory: factory,\n      name: 'SaturationBrightnessPalette',\n      configFields: [],\n      apis: {\n        setHue: function (_apis, slider, hue) {\n          setPaletteHue(slider, hue);\n        },\n        setThumb: function (_apis, slider, hex) {\n          setPaletteThumb(slider, hex);\n        }\n      },\n      extraApis: {}\n    });\n    return saturationBrightnessPaletteSketcher;\n  };\n\n  var makeFactory = function (translate, getClass) {\n    var factory = function (detail) {\n      var rgbForm = rgbFormFactory(translate, getClass, detail.onValidHex, detail.onInvalidHex);\n      var sbPalette = paletteFactory(translate, getClass);\n\n      var hueSliderToDegrees = function (hue) {\n        return (100 - hue) / 100 * 360;\n      };\n\n      var hueDegreesToSlider = function (hue) {\n        return 100 - hue / 360 * 100;\n      };\n\n      var state = {\n        paletteRgba: Cell(red),\n        paletteHue: Cell(0)\n      };\n      var memSlider = record(sliderFactory(translate, getClass));\n      var memPalette = record(sbPalette.sketch({}));\n      var memRgb = record(rgbForm.sketch({}));\n\n      var updatePalette = function (anyInSystem, _hex, hue) {\n        memPalette.getOpt(anyInSystem).each(function (palette) {\n          sbPalette.setHue(palette, hue);\n        });\n      };\n\n      var updateFields = function (anyInSystem, hex) {\n        memRgb.getOpt(anyInSystem).each(function (form) {\n          rgbForm.updateHex(form, hex);\n        });\n      };\n\n      var updateSlider = function (anyInSystem, _hex, hue) {\n        memSlider.getOpt(anyInSystem).each(function (slider) {\n          Slider.setValue(slider, {\n            y: hueDegreesToSlider(hue)\n          });\n        });\n      };\n\n      var updatePaletteThumb = function (anyInSystem, hex) {\n        memPalette.getOpt(anyInSystem).each(function (palette) {\n          sbPalette.setThumb(palette, hex);\n        });\n      };\n\n      var updateState = function (hex, hue) {\n        var rgba = fromHex(hex);\n        state.paletteRgba.set(rgba);\n        state.paletteHue.set(hue);\n      };\n\n      var runUpdates = function (anyInSystem, hex, hue, updates) {\n        updateState(hex, hue);\n        each(updates, function (update) {\n          update(anyInSystem, hex, hue);\n        });\n      };\n\n      var onPaletteUpdate = function () {\n        var updates = [updateFields];\n        return function (form, simulatedEvent) {\n          var value = simulatedEvent.event.value;\n          var oldHue = state.paletteHue.get();\n          var newHsv = hsvColour(oldHue, value.x, 100 - value.y);\n          var newHex = hsvToHex(newHsv);\n          runUpdates(form, newHex, oldHue, updates);\n        };\n      };\n\n      var onSliderUpdate = function () {\n        var updates = [updatePalette, updateFields];\n        return function (form, simulatedEvent) {\n          var hue = hueSliderToDegrees(simulatedEvent.event.value.y);\n          var oldRgb = state.paletteRgba.get();\n          var oldHsv = fromRgb(oldRgb);\n          var newHsv = hsvColour(hue, oldHsv.saturation, oldHsv.value);\n          var newHex = hsvToHex(newHsv);\n          runUpdates(form, newHex, hue, updates);\n        };\n      };\n\n      var onFieldsUpdate = function () {\n        var updates = [updatePalette, updateSlider, updatePaletteThumb];\n        return function (form, simulatedEvent) {\n          var hex = simulatedEvent.event.hex;\n          var hsv = hexToHsv(hex);\n          runUpdates(form, hex, hsv.hue, updates);\n        };\n      };\n\n      return {\n        uid: detail.uid,\n        dom: detail.dom,\n        components: [memPalette.asSpec(), memSlider.asSpec(), memRgb.asSpec()],\n        behaviours: derive$1([config('colour-picker-events', [run(fieldsUpdate, onFieldsUpdate()), run(paletteUpdate, onPaletteUpdate()), run(sliderUpdate, onSliderUpdate())]), Composing.config({\n          find: function (comp) {\n            return memRgb.getOpt(comp);\n          }\n        }), Keying.config({\n          mode: 'acyclic'\n        })])\n      };\n    };\n\n    var colourPickerSketcher = single$2({\n      name: 'ColourPicker',\n      configFields: [strict$1('dom'), defaulted$1('onValidHex', noop), defaulted$1('onInvalidHex', noop)],\n      factory: factory\n    });\n    return colourPickerSketcher;\n  };\n\n  var self$1 = function () {\n    return Composing.config({\n      find: Optional.some\n    });\n  };\n\n  var memento = function (mem) {\n    return Composing.config({\n      find: mem.getOpt\n    });\n  };\n\n  var childAt = function (index) {\n    return Composing.config({\n      find: function (comp) {\n        return child(comp.element, index).bind(function (element) {\n          return comp.getSystem().getByDom(element).toOptional();\n        });\n      }\n    });\n  };\n\n  var ComposingConfigs = {\n    self: self$1,\n    memento: memento,\n    childAt: childAt\n  };\n  var english = {\n    'colorcustom.rgb.red.label': 'R',\n    'colorcustom.rgb.red.description': 'Red component',\n    'colorcustom.rgb.green.label': 'G',\n    'colorcustom.rgb.green.description': 'Green component',\n    'colorcustom.rgb.blue.label': 'B',\n    'colorcustom.rgb.blue.description': 'Blue component',\n    'colorcustom.rgb.hex.label': '#',\n    'colorcustom.rgb.hex.description': 'Hex color code',\n    'colorcustom.rgb.range': 'Range 0 to 255',\n    'colorcustom.sb.saturation': 'Saturation',\n    'colorcustom.sb.brightness': 'Brightness',\n    'colorcustom.sb.picker': 'Saturation and Brightness Picker',\n    'colorcustom.sb.palette': 'Saturation and Brightness Palette',\n    'colorcustom.sb.instructions': 'Use arrow keys to select saturation and brightness, on x and y axes',\n    'colorcustom.hue.hue': 'Hue',\n    'colorcustom.hue.slider': 'Hue Slider',\n    'colorcustom.hue.palette': 'Hue Palette',\n    'colorcustom.hue.instructions': 'Use arrow keys to select a hue',\n    'aria.color.picker': 'Color Picker',\n    'aria.input.invalid': 'Invalid input'\n  };\n\n  var getEnglishText = function (key) {\n    return english[key];\n  };\n\n  var translate$1 = function (key) {\n    return getEnglishText(key);\n  };\n\n  var renderColorPicker = function (_spec) {\n    var getClass = function (key) {\n      return 'tox-' + key;\n    };\n\n    var colourPickerFactory = makeFactory(translate$1, getClass);\n\n    var onValidHex = function (form) {\n      emitWith(form, formActionEvent, {\n        name: 'hex-valid',\n        value: true\n      });\n    };\n\n    var onInvalidHex = function (form) {\n      emitWith(form, formActionEvent, {\n        name: 'hex-valid',\n        value: false\n      });\n    };\n\n    var memPicker = record(colourPickerFactory.sketch({\n      dom: {\n        tag: 'div',\n        classes: [getClass('color-picker-container')],\n        attributes: {\n          role: 'presentation'\n        }\n      },\n      onValidHex: onValidHex,\n      onInvalidHex: onInvalidHex\n    }));\n    return {\n      dom: {\n        tag: 'div'\n      },\n      components: [memPicker.asSpec()],\n      behaviours: derive$1([Representing.config({\n        store: {\n          mode: 'manual',\n          getValue: function (comp) {\n            var picker = memPicker.get(comp);\n            var optRgbForm = Composing.getCurrent(picker);\n            var optHex = optRgbForm.bind(function (rgbForm) {\n              var formValues = Representing.getValue(rgbForm);\n              return formValues.hex;\n            });\n            return optHex.map(function (hex) {\n              return '#' + hex;\n            }).getOr('');\n          },\n          setValue: function (comp, newValue) {\n            var pattern = /^#([a-fA-F0-9]{3}(?:[a-fA-F0-9]{3})?)/;\n            var m = pattern.exec(newValue);\n            var picker = memPicker.get(comp);\n            var optRgbForm = Composing.getCurrent(picker);\n            optRgbForm.fold(function () {\n              console.log('Can not find form');\n            }, function (rgbForm) {\n              Representing.setValue(rgbForm, {\n                hex: Optional.from(m[1]).getOr('')\n              });\n              Form.getField(rgbForm, 'hex').each(function (hexField) {\n                emit(hexField, input());\n              });\n            });\n          }\n        }\n      }), ComposingConfigs.self()])\n    };\n  };\n\n  var global$b = tinymce.util.Tools.resolve('tinymce.Resource');\n\n  var isOldCustomEditor = function (spec) {\n    return Object.prototype.hasOwnProperty.call(spec, 'init');\n  };\n\n  var renderCustomEditor = function (spec) {\n    var editorApi = Cell(Optional.none());\n    var memReplaced = record({\n      dom: {\n        tag: spec.tag\n      }\n    });\n    var initialValue = Cell(Optional.none());\n    return {\n      dom: {\n        tag: 'div',\n        classes: ['tox-custom-editor']\n      },\n      behaviours: derive$1([config('custom-editor-events', [runOnAttached(function (component) {\n        memReplaced.getOpt(component).each(function (ta) {\n          (isOldCustomEditor(spec) ? spec.init(ta.element.dom) : global$b.load(spec.scriptId, spec.scriptUrl).then(function (init) {\n            return init(ta.element.dom, spec.settings);\n          })).then(function (ea) {\n            initialValue.get().each(function (cvalue) {\n              ea.setValue(cvalue);\n            });\n            initialValue.set(Optional.none());\n            editorApi.set(Optional.some(ea));\n          });\n        });\n      })]), Representing.config({\n        store: {\n          mode: 'manual',\n          getValue: function () {\n            return editorApi.get().fold(function () {\n              return initialValue.get().getOr('');\n            }, function (ed) {\n              return ed.getValue();\n            });\n          },\n          setValue: function (component, value) {\n            editorApi.get().fold(function () {\n              initialValue.set(Optional.some(value));\n            }, function (ed) {\n              return ed.setValue(value);\n            });\n          }\n        }\n      }), ComposingConfigs.self()]),\n      components: [memReplaced.asSpec()]\n    };\n  };\n\n  var global$c = tinymce.util.Tools.resolve('tinymce.util.Tools');\n  var processors = objOf([defaulted$1('preprocess', identity), defaulted$1('postprocess', identity)]);\n\n  var memento$1 = function (mem, rawProcessors) {\n    var ps = asRawOrDie('RepresentingConfigs.memento processors', processors, rawProcessors);\n    return Representing.config({\n      store: {\n        mode: 'manual',\n        getValue: function (comp) {\n          var other = mem.get(comp);\n          var rawValue = Representing.getValue(other);\n          return ps.postprocess(rawValue);\n        },\n        setValue: function (comp, rawValue) {\n          var newValue = ps.preprocess(rawValue);\n          var other = mem.get(comp);\n          Representing.setValue(other, newValue);\n        }\n      }\n    });\n  };\n\n  var withComp = function (optInitialValue, getter, setter) {\n    return Representing.config(deepMerge({\n      store: {\n        mode: 'manual',\n        getValue: getter,\n        setValue: setter\n      }\n    }, optInitialValue.map(function (initialValue) {\n      return {\n        store: {\n          initialValue: initialValue\n        }\n      };\n    }).getOr({})));\n  };\n\n  var withElement = function (initialValue, getter, setter) {\n    return withComp(initialValue, function (c) {\n      return getter(c.element);\n    }, function (c, v) {\n      return setter(c.element, v);\n    });\n  };\n\n  var domValue = function (optInitialValue) {\n    return withElement(optInitialValue, get$6, set$3);\n  };\n\n  var domHtml = function (optInitialValue) {\n    return withElement(optInitialValue, get$2, set);\n  };\n\n  var memory$1 = function (initialValue) {\n    return Representing.config({\n      store: {\n        mode: 'memory',\n        initialValue: initialValue\n      }\n    });\n  };\n\n  var RepresentingConfigs = {\n    memento: memento$1,\n    withElement: withElement,\n    withComp: withComp,\n    domValue: domValue,\n    domHtml: domHtml,\n    memory: memory$1\n  };\n  var defaultImageFileTypes = 'jpeg,jpg,jpe,jfi,jif,jfif,png,gif,bmp,webp';\n\n  var filterByExtension = function (files, providersBackstage) {\n    var allowedImageFileTypes = global$c.explode(providersBackstage.getSetting('images_file_types', defaultImageFileTypes, 'string'));\n\n    var isFileInAllowedTypes = function (file) {\n      return exists(allowedImageFileTypes, function (type) {\n        return endsWith(file.name.toLowerCase(), '.' + type.toLowerCase());\n      });\n    };\n\n    return filter(from$1(files), isFileInAllowedTypes);\n  };\n\n  var renderDropZone = function (spec, providersBackstage) {\n    var stopper = function (_, se) {\n      se.stop();\n    };\n\n    var sequence = function (actions) {\n      return function (comp, se) {\n        each(actions, function (a) {\n          a(comp, se);\n        });\n      };\n    };\n\n    var onDrop = function (comp, se) {\n      if (!Disabling.isDisabled(comp)) {\n        var transferEvent = se.event.raw;\n        handleFiles(comp, transferEvent.dataTransfer.files);\n      }\n    };\n\n    var onSelect = function (component, simulatedEvent) {\n      var input = simulatedEvent.event.raw.target;\n      handleFiles(component, input.files);\n    };\n\n    var handleFiles = function (component, files) {\n      Representing.setValue(component, filterByExtension(files, providersBackstage));\n      emitWith(component, formChangeEvent, {\n        name: spec.name\n      });\n    };\n\n    var memInput = record({\n      dom: {\n        tag: 'input',\n        attributes: {\n          type: 'file',\n          accept: 'image/*'\n        },\n        styles: {\n          display: 'none'\n        }\n      },\n      behaviours: derive$1([config('input-file-events', [cutter(click()), cutter(tap())])])\n    });\n\n    var renderField = function (s) {\n      return {\n        uid: s.uid,\n        dom: {\n          tag: 'div',\n          classes: ['tox-dropzone-container']\n        },\n        behaviours: derive$1([RepresentingConfigs.memory([]), ComposingConfigs.self(), Disabling.config({}), Toggling.config({\n          toggleClass: 'dragenter',\n          toggleOnExecute: false\n        }), config('dropzone-events', [run('dragenter', sequence([stopper, Toggling.toggle])), run('dragleave', sequence([stopper, Toggling.toggle])), run('dragover', stopper), run('drop', sequence([stopper, onDrop])), run(change(), onSelect)])]),\n        components: [{\n          dom: {\n            tag: 'div',\n            classes: ['tox-dropzone'],\n            styles: {}\n          },\n          components: [{\n            dom: {\n              tag: 'p',\n              innerHtml: providersBackstage.translate('Drop an image here')\n            }\n          }, Button.sketch({\n            dom: {\n              tag: 'button',\n              innerHtml: providersBackstage.translate('Browse for an image'),\n              styles: {\n                position: 'relative'\n              },\n              classes: ['tox-button', 'tox-button--secondary']\n            },\n            components: [memInput.asSpec()],\n            action: function (comp) {\n              var inputComp = memInput.get(comp);\n              inputComp.element.dom.click();\n            },\n            buttonBehaviours: derive$1([Tabstopping.config({}), DisablingConfigs.button(providersBackstage.isDisabled), receivingConfig()])\n          })]\n        }]\n      };\n    };\n\n    var pLabel = spec.label.map(function (label) {\n      return renderLabel(label, providersBackstage);\n    });\n    var pField = FormField.parts.field({\n      factory: {\n        sketch: renderField\n      }\n    });\n    return renderFormFieldWith(pLabel, pField, ['tox-form__group--stretched'], []);\n  };\n\n  var renderGrid = function (spec, backstage) {\n    return {\n      dom: {\n        tag: 'div',\n        classes: ['tox-form__grid', 'tox-form__grid--' + spec.columns + 'col']\n      },\n      components: map(spec.items, backstage.interpreter)\n    };\n  };\n\n  var beforeObject = generate$1('alloy-fake-before-tabstop');\n  var afterObject = generate$1('alloy-fake-after-tabstop');\n\n  var craftWithClasses = function (classes) {\n    return {\n      dom: {\n        tag: 'div',\n        styles: {\n          width: '1px',\n          height: '1px',\n          outline: 'none'\n        },\n        attributes: {\n          tabindex: '0'\n        },\n        classes: classes\n      },\n      behaviours: derive$1([Focusing.config({\n        ignore: true\n      }), Tabstopping.config({})])\n    };\n  };\n\n  var craft = function (spec) {\n    return {\n      dom: {\n        tag: 'div',\n        classes: ['tox-navobj']\n      },\n      components: [craftWithClasses([beforeObject]), spec, craftWithClasses([afterObject])],\n      behaviours: derive$1([ComposingConfigs.childAt(1)])\n    };\n  };\n\n  var triggerTab = function (placeholder, shiftKey) {\n    emitWith(placeholder, keydown(), {\n      raw: {\n        which: 9,\n        shiftKey: shiftKey\n      }\n    });\n  };\n\n  var onFocus$1 = function (container, targetComp) {\n    var target = targetComp.element;\n\n    if (has$2(target, beforeObject)) {\n      triggerTab(container, true);\n    } else if (has$2(target, afterObject)) {\n      triggerTab(container, false);\n    }\n  };\n\n  var isPseudoStop = function (element) {\n    return closest$4(element, ['.' + beforeObject, '.' + afterObject].join(','), never);\n  };\n\n  var platformNeedsSandboxing = !(detect$3().browser.isIE() || detect$3().browser.isEdge());\n\n  var getDynamicSource = function (isSandbox) {\n    var cachedValue = Cell('');\n    return {\n      getValue: function (_frameComponent) {\n        return cachedValue.get();\n      },\n      setValue: function (frameComponent, html) {\n        if (!isSandbox) {\n          set$1(frameComponent.element, 'src', 'javascript:\\'\\'');\n          var doc = frameComponent.element.dom.contentWindow.document;\n          doc.open();\n          doc.write(html);\n          doc.close();\n        } else {\n          set$1(frameComponent.element, 'srcdoc', html);\n        }\n\n        cachedValue.set(html);\n      }\n    };\n  };\n\n  var renderIFrame = function (spec, providersBackstage) {\n    var isSandbox = platformNeedsSandboxing && spec.sandboxed;\n\n    var attributes = __assign(__assign({}, spec.label.map(function (title) {\n      return {\n        title: title\n      };\n    }).getOr({})), isSandbox ? {\n      sandbox: 'allow-scripts allow-same-origin'\n    } : {});\n\n    var sourcing = getDynamicSource(isSandbox);\n    var pLabel = spec.label.map(function (label) {\n      return renderLabel(label, providersBackstage);\n    });\n\n    var factory = function (newSpec) {\n      return craft({\n        uid: newSpec.uid,\n        dom: {\n          tag: 'iframe',\n          attributes: attributes\n        },\n        behaviours: derive$1([Tabstopping.config({}), Focusing.config({}), RepresentingConfigs.withComp(Optional.none(), sourcing.getValue, sourcing.setValue)])\n      });\n    };\n\n    var pField = FormField.parts.field({\n      factory: {\n        sketch: factory\n      }\n    });\n    return renderFormFieldWith(pLabel, pField, ['tox-form__group--stretched'], []);\n  };\n\n  var create$5 = function (width, height) {\n    return resize(document.createElement('canvas'), width, height);\n  };\n\n  var clone$1 = function (canvas) {\n    var tCanvas = create$5(canvas.width, canvas.height);\n    var ctx = get2dContext(tCanvas);\n    ctx.drawImage(canvas, 0, 0);\n    return tCanvas;\n  };\n\n  var get2dContext = function (canvas) {\n    return canvas.getContext('2d');\n  };\n\n  var resize = function (canvas, width, height) {\n    canvas.width = width;\n    canvas.height = height;\n    return canvas;\n  };\n\n  var getWidth = function (image) {\n    return image.naturalWidth || image.width;\n  };\n\n  var getHeight = function (image) {\n    return image.naturalHeight || image.height;\n  };\n\n  var promise = function () {\n    var Promise = function (fn) {\n      if (typeof this !== 'object') {\n        throw new TypeError('Promises must be constructed via new');\n      }\n\n      if (typeof fn !== 'function') {\n        throw new TypeError('not a function');\n      }\n\n      this._state = null;\n      this._value = null;\n      this._deferreds = [];\n      doResolve(fn, bind(resolve, this), bind(reject, this));\n    };\n\n    var anyWindow = window;\n\n    var asap = Promise.immediateFn || typeof anyWindow.setImmediate === 'function' && anyWindow.setImmediate || function (fn) {\n      return setTimeout(fn, 1);\n    };\n\n    var bind = function (fn, thisArg) {\n      return function () {\n        var args = [];\n\n        for (var _i = 0; _i < arguments.length; _i++) {\n          args[_i] = arguments[_i];\n        }\n\n        return fn.apply(thisArg, args);\n      };\n    };\n\n    var isArray = Array.isArray || function (value) {\n      return Object.prototype.toString.call(value) === '[object Array]';\n    };\n\n    function handle(deferred) {\n      var me = this;\n\n      if (this._state === null) {\n        this._deferreds.push(deferred);\n\n        return;\n      }\n\n      asap(function () {\n        var cb = me._state ? deferred.onFulfilled : deferred.onRejected;\n\n        if (cb === null) {\n          (me._state ? deferred.resolve : deferred.reject)(me._value);\n          return;\n        }\n\n        var ret;\n\n        try {\n          ret = cb(me._value);\n        } catch (e) {\n          deferred.reject(e);\n          return;\n        }\n\n        deferred.resolve(ret);\n      });\n    }\n\n    function resolve(newValue) {\n      try {\n        if (newValue === this) {\n          throw new TypeError('A promise cannot be resolved with itself.');\n        }\n\n        if (newValue && (typeof newValue === 'object' || typeof newValue === 'function')) {\n          var then = newValue.then;\n\n          if (typeof then === 'function') {\n            doResolve(bind(then, newValue), bind(resolve, this), bind(reject, this));\n            return;\n          }\n        }\n\n        this._state = true;\n        this._value = newValue;\n        finale.call(this);\n      } catch (e) {\n        reject.call(this, e);\n      }\n    }\n\n    function reject(newValue) {\n      this._state = false;\n      this._value = newValue;\n      finale.call(this);\n    }\n\n    function finale() {\n      for (var _i = 0, _a = this._deferreds; _i < _a.length; _i++) {\n        var deferred = _a[_i];\n        handle.call(this, deferred);\n      }\n\n      this._deferreds = [];\n    }\n\n    function Handler(onFulfilled, onRejected, resolve, reject) {\n      this.onFulfilled = typeof onFulfilled === 'function' ? onFulfilled : null;\n      this.onRejected = typeof onRejected === 'function' ? onRejected : null;\n      this.resolve = resolve;\n      this.reject = reject;\n    }\n\n    var doResolve = function (fn, onFulfilled, onRejected) {\n      var done = false;\n\n      try {\n        fn(function (value) {\n          if (done) {\n            return;\n          }\n\n          done = true;\n          onFulfilled(value);\n        }, function (reason) {\n          if (done) {\n            return;\n          }\n\n          done = true;\n          onRejected(reason);\n        });\n      } catch (ex) {\n        if (done) {\n          return;\n        }\n\n        done = true;\n        onRejected(ex);\n      }\n    };\n\n    Promise.prototype.catch = function (onRejected) {\n      return this.then(null, onRejected);\n    };\n\n    Promise.prototype.then = function (onFulfilled, onRejected) {\n      var me = this;\n      return new Promise(function (resolve, reject) {\n        handle.call(me, new Handler(onFulfilled, onRejected, resolve, reject));\n      });\n    };\n\n    Promise.all = function () {\n      var values = [];\n\n      for (var _i = 0; _i < arguments.length; _i++) {\n        values[_i] = arguments[_i];\n      }\n\n      var args = Array.prototype.slice.call(values.length === 1 && isArray(values[0]) ? values[0] : values);\n      return new Promise(function (resolve, reject) {\n        if (args.length === 0) {\n          return resolve([]);\n        }\n\n        var remaining = args.length;\n\n        var res = function (i, val) {\n          try {\n            if (val && (typeof val === 'object' || typeof val === 'function')) {\n              var then = val.then;\n\n              if (typeof then === 'function') {\n                then.call(val, function (val) {\n                  res(i, val);\n                }, reject);\n                return;\n              }\n            }\n\n            args[i] = val;\n\n            if (--remaining === 0) {\n              resolve(args);\n            }\n          } catch (ex) {\n            reject(ex);\n          }\n        };\n\n        for (var i = 0; i < args.length; i++) {\n          res(i, args[i]);\n        }\n      });\n    };\n\n    Promise.resolve = function (value) {\n      if (value && typeof value === 'object' && value.constructor === Promise) {\n        return value;\n      }\n\n      return new Promise(function (resolve) {\n        resolve(value);\n      });\n    };\n\n    Promise.reject = function (reason) {\n      return new Promise(function (resolve, reject) {\n        reject(reason);\n      });\n    };\n\n    Promise.race = function (values) {\n      return new Promise(function (resolve, reject) {\n        for (var _i = 0, values_1 = values; _i < values_1.length; _i++) {\n          var value = values_1[_i];\n          value.then(resolve, reject);\n        }\n      });\n    };\n\n    return Promise;\n  };\n\n  var Promise$1 = window.Promise ? window.Promise : promise();\n\n  var blobToImage = function (blob) {\n    return new Promise$1(function (resolve, reject) {\n      var blobUrl = URL.createObjectURL(blob);\n      var image = new Image();\n\n      var removeListeners = function () {\n        image.removeEventListener('load', loaded);\n        image.removeEventListener('error', error);\n      };\n\n      var loaded = function () {\n        removeListeners();\n        resolve(image);\n      };\n\n      var error = function () {\n        removeListeners();\n        reject('Unable to load data of type ' + blob.type + ': ' + blobUrl);\n      };\n\n      image.addEventListener('load', loaded);\n      image.addEventListener('error', error);\n      image.src = blobUrl;\n\n      if (image.complete) {\n        setTimeout(loaded, 0);\n      }\n    });\n  };\n\n  var dataUriToBlobSync = function (uri) {\n    var data = uri.split(',');\n    var matches = /data:([^;]+)/.exec(data[0]);\n\n    if (!matches) {\n      return Optional.none();\n    }\n\n    var mimetype = matches[1];\n    var base64 = data[1];\n    var sliceSize = 1024;\n    var byteCharacters = atob(base64);\n    var bytesLength = byteCharacters.length;\n    var slicesCount = Math.ceil(bytesLength / sliceSize);\n    var byteArrays = new Array(slicesCount);\n\n    for (var sliceIndex = 0; sliceIndex < slicesCount; ++sliceIndex) {\n      var begin = sliceIndex * sliceSize;\n      var end = Math.min(begin + sliceSize, bytesLength);\n      var bytes = new Array(end - begin);\n\n      for (var offset = begin, i = 0; offset < end; ++i, ++offset) {\n        bytes[i] = byteCharacters[offset].charCodeAt(0);\n      }\n\n      byteArrays[sliceIndex] = new Uint8Array(bytes);\n    }\n\n    return Optional.some(new Blob(byteArrays, {\n      type: mimetype\n    }));\n  };\n\n  var dataUriToBlob = function (uri) {\n    return new Promise$1(function (resolve, reject) {\n      dataUriToBlobSync(uri).fold(function () {\n        reject('uri is not base64: ' + uri);\n      }, resolve);\n    });\n  };\n\n  var canvasToBlob = function (canvas, type, quality) {\n    type = type || 'image/png';\n\n    if (isFunction(HTMLCanvasElement.prototype.toBlob)) {\n      return new Promise$1(function (resolve, reject) {\n        canvas.toBlob(function (blob) {\n          if (blob) {\n            resolve(blob);\n          } else {\n            reject();\n          }\n        }, type, quality);\n      });\n    } else {\n      return dataUriToBlob(canvas.toDataURL(type, quality));\n    }\n  };\n\n  var canvasToDataURL = function (canvas, type, quality) {\n    type = type || 'image/png';\n    return canvas.toDataURL(type, quality);\n  };\n\n  var blobToCanvas = function (blob) {\n    return blobToImage(blob).then(function (image) {\n      revokeImageUrl(image);\n      var canvas = create$5(getWidth(image), getHeight(image));\n      var context = get2dContext(canvas);\n      context.drawImage(image, 0, 0);\n      return canvas;\n    });\n  };\n\n  var blobToDataUri = function (blob) {\n    return new Promise$1(function (resolve) {\n      var reader = new FileReader();\n\n      reader.onloadend = function () {\n        resolve(reader.result);\n      };\n\n      reader.readAsDataURL(blob);\n    });\n  };\n\n  var revokeImageUrl = function (image) {\n    URL.revokeObjectURL(image.src);\n  };\n\n  var create$6 = function (getCanvas, blob, uri) {\n    var initialType = blob.type;\n    var getType = constant(initialType);\n\n    var toBlob = function () {\n      return Promise$1.resolve(blob);\n    };\n\n    var toDataURL = constant(uri);\n\n    var toBase64 = function () {\n      return uri.split(',')[1];\n    };\n\n    var toAdjustedBlob = function (type, quality) {\n      return getCanvas.then(function (canvas) {\n        return canvasToBlob(canvas, type, quality);\n      });\n    };\n\n    var toAdjustedDataURL = function (type, quality) {\n      return getCanvas.then(function (canvas) {\n        return canvasToDataURL(canvas, type, quality);\n      });\n    };\n\n    var toAdjustedBase64 = function (type, quality) {\n      return toAdjustedDataURL(type, quality).then(function (dataurl) {\n        return dataurl.split(',')[1];\n      });\n    };\n\n    var toCanvas = function () {\n      return getCanvas.then(clone$1);\n    };\n\n    return {\n      getType: getType,\n      toBlob: toBlob,\n      toDataURL: toDataURL,\n      toBase64: toBase64,\n      toAdjustedBlob: toAdjustedBlob,\n      toAdjustedDataURL: toAdjustedDataURL,\n      toAdjustedBase64: toAdjustedBase64,\n      toCanvas: toCanvas\n    };\n  };\n\n  var fromBlob = function (blob) {\n    return blobToDataUri(blob).then(function (uri) {\n      return create$6(blobToCanvas(blob), blob, uri);\n    });\n  };\n\n  var fromCanvas = function (canvas, type) {\n    return canvasToBlob(canvas, type).then(function (blob) {\n      return create$6(Promise$1.resolve(canvas), blob, canvas.toDataURL());\n    });\n  };\n\n  var blobToImageResult = function (blob) {\n    return fromBlob(blob);\n  };\n\n  var clamp$1 = function (value, min, max) {\n    var parsedValue = typeof value === 'string' ? parseFloat(value) : value;\n\n    if (parsedValue > max) {\n      parsedValue = max;\n    } else if (parsedValue < min) {\n      parsedValue = min;\n    }\n\n    return parsedValue;\n  };\n\n  var identity$1 = function () {\n    return [1, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 1];\n  };\n\n  var DELTA_INDEX = [0, 0.01, 0.02, 0.04, 0.05, 0.06, 0.07, 0.08, 0.1, 0.11, 0.12, 0.14, 0.15, 0.16, 0.17, 0.18, 0.2, 0.21, 0.22, 0.24, 0.25, 0.27, 0.28, 0.3, 0.32, 0.34, 0.36, 0.38, 0.4, 0.42, 0.44, 0.46, 0.48, 0.5, 0.53, 0.56, 0.59, 0.62, 0.65, 0.68, 0.71, 0.74, 0.77, 0.8, 0.83, 0.86, 0.89, 0.92, 0.95, 0.98, 1, 1.06, 1.12, 1.18, 1.24, 1.3, 1.36, 1.42, 1.48, 1.54, 1.6, 1.66, 1.72, 1.78, 1.84, 1.9, 1.96, 2, 2.12, 2.25, 2.37, 2.5, 2.62, 2.75, 2.87, 3, 3.2, 3.4, 3.6, 3.8, 4, 4.3, 4.7, 4.9, 5, 5.5, 6, 6.5, 6.8, 7, 7.3, 7.5, 7.8, 8, 8.4, 8.7, 9, 9.4, 9.6, 9.8, 10];\n\n  var multiply = function (matrix1, matrix2) {\n    var col = [];\n    var out = new Array(25);\n    var val;\n\n    for (var i = 0; i < 5; i++) {\n      for (var j = 0; j < 5; j++) {\n        col[j] = matrix2[j + i * 5];\n      }\n\n      for (var j = 0; j < 5; j++) {\n        val = 0;\n\n        for (var k = 0; k < 5; k++) {\n          val += matrix1[j + k * 5] * col[k];\n        }\n\n        out[j + i * 5] = val;\n      }\n    }\n\n    return out;\n  };\n\n  var adjustContrast = function (matrix, value) {\n    var x;\n    value = clamp$1(value, -1, 1);\n    value *= 100;\n\n    if (value < 0) {\n      x = 127 + value / 100 * 127;\n    } else {\n      x = value % 1;\n\n      if (x === 0) {\n        x = DELTA_INDEX[value];\n      } else {\n        x = DELTA_INDEX[Math.floor(value)] * (1 - x) + DELTA_INDEX[Math.floor(value) + 1] * x;\n      }\n\n      x = x * 127 + 127;\n    }\n\n    return multiply(matrix, [x / 127, 0, 0, 0, 0.5 * (127 - x), 0, x / 127, 0, 0, 0.5 * (127 - x), 0, 0, x / 127, 0, 0.5 * (127 - x), 0, 0, 0, 1, 0, 0, 0, 0, 0, 1]);\n  };\n\n  var adjustBrightness = function (matrix, value) {\n    value = clamp$1(255 * value, -255, 255);\n    return multiply(matrix, [1, 0, 0, 0, value, 0, 1, 0, 0, value, 0, 0, 1, 0, value, 0, 0, 0, 1, 0, 0, 0, 0, 0, 1]);\n  };\n\n  var adjustColors = function (matrix, adjustR, adjustG, adjustB) {\n    adjustR = clamp$1(adjustR, 0, 2);\n    adjustG = clamp$1(adjustG, 0, 2);\n    adjustB = clamp$1(adjustB, 0, 2);\n    return multiply(matrix, [adjustR, 0, 0, 0, 0, 0, adjustG, 0, 0, 0, 0, 0, adjustB, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 1]);\n  };\n\n  var colorFilter = function (ir, matrix) {\n    return ir.toCanvas().then(function (canvas) {\n      return applyColorFilter(canvas, ir.getType(), matrix);\n    });\n  };\n\n  var applyColorFilter = function (canvas, type, matrix) {\n    var context = get2dContext(canvas);\n\n    var applyMatrix = function (pixelsData, m) {\n      var r, g, b, a;\n      var data = pixelsData.data,\n          m0 = m[0],\n          m1 = m[1],\n          m2 = m[2],\n          m3 = m[3],\n          m4 = m[4],\n          m5 = m[5],\n          m6 = m[6],\n          m7 = m[7],\n          m8 = m[8],\n          m9 = m[9],\n          m10 = m[10],\n          m11 = m[11],\n          m12 = m[12],\n          m13 = m[13],\n          m14 = m[14],\n          m15 = m[15],\n          m16 = m[16],\n          m17 = m[17],\n          m18 = m[18],\n          m19 = m[19];\n\n      for (var i = 0; i < data.length; i += 4) {\n        r = data[i];\n        g = data[i + 1];\n        b = data[i + 2];\n        a = data[i + 3];\n        data[i] = r * m0 + g * m1 + b * m2 + a * m3 + m4;\n        data[i + 1] = r * m5 + g * m6 + b * m7 + a * m8 + m9;\n        data[i + 2] = r * m10 + g * m11 + b * m12 + a * m13 + m14;\n        data[i + 3] = r * m15 + g * m16 + b * m17 + a * m18 + m19;\n      }\n\n      return pixelsData;\n    };\n\n    var pixels = applyMatrix(context.getImageData(0, 0, canvas.width, canvas.height), matrix);\n    context.putImageData(pixels, 0, 0);\n    return fromCanvas(canvas, type);\n  };\n\n  var convoluteFilter = function (ir, matrix) {\n    return ir.toCanvas().then(function (canvas) {\n      return applyConvoluteFilter(canvas, ir.getType(), matrix);\n    });\n  };\n\n  var applyConvoluteFilter = function (canvas, type, matrix) {\n    var context = get2dContext(canvas);\n\n    var applyMatrix = function (pIn, pOut, aMatrix) {\n      var clamp = function (value, min, max) {\n        if (value > max) {\n          value = max;\n        } else if (value < min) {\n          value = min;\n        }\n\n        return value;\n      };\n\n      var side = Math.round(Math.sqrt(aMatrix.length));\n      var halfSide = Math.floor(side / 2);\n      var rgba = pIn.data;\n      var drgba = pOut.data;\n      var w = pIn.width;\n      var h = pIn.height;\n\n      for (var y = 0; y < h; y++) {\n        for (var x = 0; x < w; x++) {\n          var r = 0;\n          var g = 0;\n          var b = 0;\n\n          for (var cy = 0; cy < side; cy++) {\n            for (var cx = 0; cx < side; cx++) {\n              var scx = clamp(x + cx - halfSide, 0, w - 1);\n              var scy = clamp(y + cy - halfSide, 0, h - 1);\n              var innerOffset = (scy * w + scx) * 4;\n              var wt = aMatrix[cy * side + cx];\n              r += rgba[innerOffset] * wt;\n              g += rgba[innerOffset + 1] * wt;\n              b += rgba[innerOffset + 2] * wt;\n            }\n          }\n\n          var offset = (y * w + x) * 4;\n          drgba[offset] = clamp(r, 0, 255);\n          drgba[offset + 1] = clamp(g, 0, 255);\n          drgba[offset + 2] = clamp(b, 0, 255);\n        }\n      }\n\n      return pOut;\n    };\n\n    var pixelsIn = context.getImageData(0, 0, canvas.width, canvas.height);\n    var pixelsOut = context.getImageData(0, 0, canvas.width, canvas.height);\n    pixelsOut = applyMatrix(pixelsIn, pixelsOut, matrix);\n    context.putImageData(pixelsOut, 0, 0);\n    return fromCanvas(canvas, type);\n  };\n\n  var functionColorFilter = function (colorFn) {\n    var filterImpl = function (canvas, type, value) {\n      var context = get2dContext(canvas);\n      var lookup = new Array(256);\n\n      var applyLookup = function (pixelsData, lookupData) {\n        var data = pixelsData.data;\n\n        for (var i = 0; i < data.length; i += 4) {\n          data[i] = lookupData[data[i]];\n          data[i + 1] = lookupData[data[i + 1]];\n          data[i + 2] = lookupData[data[i + 2]];\n        }\n\n        return pixelsData;\n      };\n\n      for (var i = 0; i < lookup.length; i++) {\n        lookup[i] = colorFn(i, value);\n      }\n\n      var pixels = applyLookup(context.getImageData(0, 0, canvas.width, canvas.height), lookup);\n      context.putImageData(pixels, 0, 0);\n      return fromCanvas(canvas, type);\n    };\n\n    return function (ir, value) {\n      return ir.toCanvas().then(function (canvas) {\n        return filterImpl(canvas, ir.getType(), value);\n      });\n    };\n  };\n\n  var complexAdjustableColorFilter = function (matrixAdjustFn) {\n    return function (ir, adjust) {\n      return colorFilter(ir, matrixAdjustFn(identity$1(), adjust));\n    };\n  };\n\n  var basicColorFilter = function (matrix) {\n    return function (ir) {\n      return colorFilter(ir, matrix);\n    };\n  };\n\n  var basicConvolutionFilter = function (kernel) {\n    return function (ir) {\n      return convoluteFilter(ir, kernel);\n    };\n  };\n\n  var invert = basicColorFilter([-1, 0, 0, 0, 255, 0, -1, 0, 0, 255, 0, 0, -1, 0, 255, 0, 0, 0, 1, 0, 0, 0, 0, 0, 1]);\n  var brightness = complexAdjustableColorFilter(adjustBrightness);\n  var contrast = complexAdjustableColorFilter(adjustContrast);\n\n  var colorize = function (ir, adjustR, adjustG, adjustB) {\n    return colorFilter(ir, adjustColors(identity$1(), adjustR, adjustG, adjustB));\n  };\n\n  var sharpen = basicConvolutionFilter([0, -1, 0, -1, 5, -1, 0, -1, 0]);\n  var gamma = functionColorFilter(function (color, value) {\n    return Math.pow(color / 255, 1 - value) * 255;\n  });\n\n  var scale = function (image, dW, dH) {\n    var sW = getWidth(image);\n    var sH = getHeight(image);\n    var wRatio = dW / sW;\n    var hRatio = dH / sH;\n    var scaleCapped = false;\n\n    if (wRatio < 0.5 || wRatio > 2) {\n      wRatio = wRatio < 0.5 ? 0.5 : 2;\n      scaleCapped = true;\n    }\n\n    if (hRatio < 0.5 || hRatio > 2) {\n      hRatio = hRatio < 0.5 ? 0.5 : 2;\n      scaleCapped = true;\n    }\n\n    var scaled = _scale(image, wRatio, hRatio);\n\n    return !scaleCapped ? scaled : scaled.then(function (tCanvas) {\n      return scale(tCanvas, dW, dH);\n    });\n  };\n\n  var _scale = function (image, wRatio, hRatio) {\n    return new Promise$1(function (resolve) {\n      var sW = getWidth(image);\n      var sH = getHeight(image);\n      var dW = Math.floor(sW * wRatio);\n      var dH = Math.floor(sH * hRatio);\n      var canvas = create$5(dW, dH);\n      var context = get2dContext(canvas);\n      context.drawImage(image, 0, 0, sW, sH, 0, 0, dW, dH);\n      resolve(canvas);\n    });\n  };\n\n  var ceilWithPrecision = function (num, precision) {\n    if (precision === void 0) {\n      precision = 2;\n    }\n\n    var mul = Math.pow(10, precision);\n    var upper = Math.round(num * mul);\n    return Math.ceil(upper / mul);\n  };\n\n  var rotate = function (ir, angle) {\n    return ir.toCanvas().then(function (canvas) {\n      return applyRotate(canvas, ir.getType(), angle);\n    });\n  };\n\n  var applyRotate = function (image, type, angle) {\n    var degrees = angle < 0 ? 360 + angle : angle;\n    var rad = degrees * Math.PI / 180;\n    var width = image.width;\n    var height = image.height;\n    var sin = Math.sin(rad);\n    var cos = Math.cos(rad);\n    var newWidth = ceilWithPrecision(Math.abs(width * cos) + Math.abs(height * sin));\n    var newHeight = ceilWithPrecision(Math.abs(width * sin) + Math.abs(height * cos));\n    var canvas = create$5(newWidth, newHeight);\n    var context = get2dContext(canvas);\n    context.translate(newWidth / 2, newHeight / 2);\n    context.rotate(rad);\n    context.drawImage(image, -width / 2, -height / 2);\n    return fromCanvas(canvas, type);\n  };\n\n  var flip = function (ir, axis) {\n    return ir.toCanvas().then(function (canvas) {\n      return applyFlip(canvas, ir.getType(), axis);\n    });\n  };\n\n  var applyFlip = function (image, type, axis) {\n    var canvas = create$5(image.width, image.height);\n    var context = get2dContext(canvas);\n\n    if (axis === 'v') {\n      context.scale(1, -1);\n      context.drawImage(image, 0, -canvas.height);\n    } else {\n      context.scale(-1, 1);\n      context.drawImage(image, -canvas.width, 0);\n    }\n\n    return fromCanvas(canvas, type);\n  };\n\n  var crop = function (ir, x, y, w, h) {\n    return ir.toCanvas().then(function (canvas) {\n      return applyCrop(canvas, ir.getType(), x, y, w, h);\n    });\n  };\n\n  var applyCrop = function (image, type, x, y, w, h) {\n    var canvas = create$5(w, h);\n    var context = get2dContext(canvas);\n    context.drawImage(image, -x, -y);\n    return fromCanvas(canvas, type);\n  };\n\n  var resize$1 = function (ir, w, h) {\n    return ir.toCanvas().then(function (canvas) {\n      return scale(canvas, w, h).then(function (newCanvas) {\n        return fromCanvas(newCanvas, ir.getType());\n      });\n    });\n  };\n\n  var invert$1 = function (ir) {\n    return invert(ir);\n  };\n\n  var sharpen$1 = function (ir) {\n    return sharpen(ir);\n  };\n\n  var gamma$1 = function (ir, value) {\n    return gamma(ir, value);\n  };\n\n  var colorize$1 = function (ir, adjustR, adjustG, adjustB) {\n    return colorize(ir, adjustR, adjustG, adjustB);\n  };\n\n  var brightness$1 = function (ir, adjust) {\n    return brightness(ir, adjust);\n  };\n\n  var contrast$1 = function (ir, adjust) {\n    return contrast(ir, adjust);\n  };\n\n  var flip$1 = function (ir, axis) {\n    return flip(ir, axis);\n  };\n\n  var crop$1 = function (ir, x, y, w, h) {\n    return crop(ir, x, y, w, h);\n  };\n\n  var resize$2 = function (ir, w, h) {\n    return resize$1(ir, w, h);\n  };\n\n  var rotate$1 = function (ir, angle) {\n    return rotate(ir, angle);\n  };\n\n  var renderIcon$1 = function (iconHtml, behaviours) {\n    return __assign({\n      dom: {\n        tag: 'span',\n        innerHtml: iconHtml,\n        classes: ['tox-icon', 'tox-tbtn__icon-wrap']\n      }\n    }, behaviours);\n  };\n\n  var renderIconFromPack = function (iconName, iconsProvider) {\n    return renderIcon$1(get$e(iconName, iconsProvider), {});\n  };\n\n  var renderReplacableIconFromPack = function (iconName, iconsProvider) {\n    return renderIcon$1(get$e(iconName, iconsProvider), {\n      behaviours: derive$1([Replacing.config({})])\n    });\n  };\n\n  var renderLabel$1 = function (text, prefix, providersBackstage) {\n    return {\n      dom: {\n        tag: 'span',\n        innerHtml: providersBackstage.translate(text),\n        classes: [prefix + '__select-label']\n      },\n      behaviours: derive$1([Replacing.config({})])\n    };\n  };\n\n  var _a$1;\n\n  var internalToolbarButtonExecute = generate$1('toolbar.button.execute');\n\n  var onToolbarButtonExecute = function (info) {\n    return runOnExecute(function (comp, _simulatedEvent) {\n      runWithApi(info, comp)(function (itemApi) {\n        emitWith(comp, internalToolbarButtonExecute, {\n          buttonApi: itemApi\n        });\n        info.onAction(itemApi);\n      });\n    });\n  };\n\n  var toolbarButtonEventOrder = (_a$1 = {}, _a$1[execute()] = ['disabling', 'alloy.base.behaviour', 'toggling', 'toolbar-button-events'], _a$1);\n  var updateMenuText = generate$1('update-menu-text');\n  var updateMenuIcon = generate$1('update-menu-icon');\n\n  var renderCommonDropdown = function (spec, prefix, sharedBackstage) {\n    var editorOffCell = Cell(noop);\n    var optMemDisplayText = spec.text.map(function (text) {\n      return record(renderLabel$1(text, prefix, sharedBackstage.providers));\n    });\n    var optMemDisplayIcon = spec.icon.map(function (iconName) {\n      return record(renderReplacableIconFromPack(iconName, sharedBackstage.providers.icons));\n    });\n\n    var onLeftOrRightInMenu = function (comp, se) {\n      var dropdown = Representing.getValue(comp);\n      Focusing.focus(dropdown);\n      emitWith(dropdown, 'keydown', {\n        raw: se.event.raw\n      });\n      Dropdown.close(dropdown);\n      return Optional.some(true);\n    };\n\n    var role = spec.role.fold(function () {\n      return {};\n    }, function (role) {\n      return {\n        role: role\n      };\n    });\n    var tooltipAttributes = spec.tooltip.fold(function () {\n      return {};\n    }, function (tooltip) {\n      var translatedTooltip = sharedBackstage.providers.translate(tooltip);\n      return {\n        'title': translatedTooltip,\n        'aria-label': translatedTooltip\n      };\n    });\n    var memDropdown = record(Dropdown.sketch(__assign(__assign(__assign({}, spec.uid ? {\n      uid: spec.uid\n    } : {}), role), {\n      dom: {\n        tag: 'button',\n        classes: [prefix, prefix + '--select'].concat(map(spec.classes, function (c) {\n          return prefix + '--' + c;\n        })),\n        attributes: __assign({}, tooltipAttributes)\n      },\n      components: componentRenderPipeline([optMemDisplayIcon.map(function (mem) {\n        return mem.asSpec();\n      }), optMemDisplayText.map(function (mem) {\n        return mem.asSpec();\n      }), Optional.some({\n        dom: {\n          tag: 'div',\n          classes: [prefix + '__select-chevron'],\n          innerHtml: get$e('chevron-down', sharedBackstage.providers.icons)\n        }\n      })]),\n      matchWidth: true,\n      useMinWidth: true,\n      dropdownBehaviours: derive$1(__spreadArrays(spec.dropdownBehaviours, [DisablingConfigs.button(function () {\n        return spec.disabled || sharedBackstage.providers.isDisabled();\n      }), receivingConfig(), Unselecting.config({}), Replacing.config({}), config('dropdown-events', [onControlAttached(spec, editorOffCell), onControlDetached(spec, editorOffCell)]), config('menubutton-update-display-text', [run(updateMenuText, function (comp, se) {\n        optMemDisplayText.bind(function (mem) {\n          return mem.getOpt(comp);\n        }).each(function (displayText) {\n          Replacing.set(displayText, [text(sharedBackstage.providers.translate(se.event.text))]);\n        });\n      }), run(updateMenuIcon, function (comp, se) {\n        optMemDisplayIcon.bind(function (mem) {\n          return mem.getOpt(comp);\n        }).each(function (displayIcon) {\n          Replacing.set(displayIcon, [renderReplacableIconFromPack(se.event.icon, sharedBackstage.providers.icons)]);\n        });\n      })])])),\n      eventOrder: deepMerge(toolbarButtonEventOrder, {\n        mousedown: ['focusing', 'alloy.base.behaviour', 'item-type-events', 'normal-dropdown-events']\n      }),\n      sandboxBehaviours: derive$1([Keying.config({\n        mode: 'special',\n        onLeft: onLeftOrRightInMenu,\n        onRight: onLeftOrRightInMenu\n      })]),\n      lazySink: sharedBackstage.getSink,\n      toggleClass: prefix + '--active',\n      parts: {\n        menu: part(false, spec.columns, spec.presets)\n      },\n      fetch: function (comp) {\n        return Future.nu(curry(spec.fetch, comp));\n      }\n    })));\n    return memDropdown.asSpec();\n  };\n\n  var isMenuItemReference = function (item) {\n    return isString(item);\n  };\n\n  var isSeparator = function (item) {\n    return item.type === 'separator';\n  };\n\n  var isExpandingMenuItem = function (item) {\n    return has(item, 'getSubmenuItems');\n  };\n\n  var separator$1 = {\n    type: 'separator'\n  };\n\n  var unwrapReferences = function (items, menuItems) {\n    var realItems = foldl(items, function (acc, item) {\n      if (isMenuItemReference(item)) {\n        if (item === '') {\n          return acc;\n        } else if (item === '|') {\n          return acc.length > 0 && !isSeparator(acc[acc.length - 1]) ? acc.concat([separator$1]) : acc;\n        } else if (has(menuItems, item.toLowerCase())) {\n          return acc.concat([menuItems[item.toLowerCase()]]);\n        } else {\n          return acc;\n        }\n      } else {\n        return acc.concat([item]);\n      }\n    }, []);\n\n    if (realItems.length > 0 && isSeparator(realItems[realItems.length - 1])) {\n      realItems.pop();\n    }\n\n    return realItems;\n  };\n\n  var getFromExpandingItem = function (item, menuItems) {\n    var submenuItems = item.getSubmenuItems();\n    var rest = expand(submenuItems, menuItems);\n    var newMenus = deepMerge(rest.menus, wrap$1(item.value, rest.items));\n    var newExpansions = deepMerge(rest.expansions, wrap$1(item.value, item.value));\n    return {\n      item: item,\n      menus: newMenus,\n      expansions: newExpansions\n    };\n  };\n\n  var getFromItem = function (item, menuItems) {\n    return isExpandingMenuItem(item) ? getFromExpandingItem(item, menuItems) : {\n      item: item,\n      menus: {},\n      expansions: {}\n    };\n  };\n\n  var generateValueIfRequired = function (item) {\n    if (isSeparator(item)) {\n      return item;\n    } else {\n      var itemValue = get$1(item, 'value').getOrThunk(function () {\n        return generate$1('generated-menu-item');\n      });\n      return deepMerge({\n        value: itemValue\n      }, item);\n    }\n  };\n\n  var expand = function (items, menuItems) {\n    var realItems = unwrapReferences(isString(items) ? items.split(' ') : items, menuItems);\n    return foldr(realItems, function (acc, item) {\n      var itemWithValue = generateValueIfRequired(item);\n      var newData = getFromItem(itemWithValue, menuItems);\n      return {\n        menus: deepMerge(acc.menus, newData.menus),\n        items: [newData.item].concat(acc.items),\n        expansions: deepMerge(acc.expansions, newData.expansions)\n      };\n    }, {\n      menus: {},\n      expansions: {},\n      items: []\n    });\n  };\n\n  var build$2 = function (items, itemResponse, backstage, isHorizontalMenu) {\n    var primary = generate$1('primary-menu');\n    var data = expand(items, backstage.shared.providers.menuItems());\n\n    if (data.items.length === 0) {\n      return Optional.none();\n    }\n\n    var mainMenu = createPartialMenu(primary, data.items, itemResponse, backstage, isHorizontalMenu);\n    var submenus = map$2(data.menus, function (menuItems, menuName) {\n      return createPartialMenu(menuName, menuItems, itemResponse, backstage, false);\n    });\n    var menus = deepMerge(submenus, wrap$1(primary, mainMenu));\n    return Optional.from(tieredMenu.tieredData(primary, menus, data.expansions));\n  };\n\n  var getMenuButtonApi = function (component) {\n    return {\n      isDisabled: function () {\n        return Disabling.isDisabled(component);\n      },\n      setDisabled: function (state) {\n        return Disabling.set(component, state);\n      },\n      setActive: function (state) {\n        var elm = component.element;\n\n        if (state) {\n          add$2(elm, 'tox-tbtn--enabled');\n          set$1(elm, 'aria-pressed', true);\n        } else {\n          remove$4(elm, 'tox-tbtn--enabled');\n          remove$1(elm, 'aria-pressed');\n        }\n      },\n      isActive: function () {\n        return has$2(component.element, 'tox-tbtn--enabled');\n      }\n    };\n  };\n\n  var renderMenuButton = function (spec, prefix, backstage, role) {\n    return renderCommonDropdown({\n      text: spec.text,\n      icon: spec.icon,\n      tooltip: spec.tooltip,\n      role: role,\n      fetch: function (_comp, callback) {\n        spec.fetch(function (items) {\n          callback(build$2(items, ItemResponse$1.CLOSE_ON_EXECUTE, backstage, false));\n        });\n      },\n      onSetup: spec.onSetup,\n      getApi: getMenuButtonApi,\n      columns: 1,\n      presets: 'normal',\n      classes: [],\n      dropdownBehaviours: [Tabstopping.config({})]\n    }, prefix, backstage.shared);\n  };\n\n  var getFetch$1 = function (items, getButton, backstage) {\n    var getMenuItemAction = function (item) {\n      return function (api) {\n        var newValue = !api.isActive();\n        api.setActive(newValue);\n        item.storage.set(newValue);\n        backstage.shared.getSink().each(function (sink) {\n          getButton().getOpt(sink).each(function (orig) {\n            focus$1(orig.element);\n            emitWith(orig, formActionEvent, {\n              name: item.name,\n              value: item.storage.get()\n            });\n          });\n        });\n      };\n    };\n\n    var getMenuItemSetup = function (item) {\n      return function (api) {\n        api.setActive(item.storage.get());\n      };\n    };\n\n    return function (success) {\n      success(map(items, function (item) {\n        var text = item.text.fold(function () {\n          return {};\n        }, function (text) {\n          return {\n            text: text\n          };\n        });\n        return __assign(__assign({\n          type: item.type,\n          active: false\n        }, text), {\n          onAction: getMenuItemAction(item),\n          onSetup: getMenuItemSetup(item)\n        });\n      }));\n    };\n  };\n\n  var renderCommonSpec = function (spec, actionOpt, extraBehaviours, dom, components, providersBackstage) {\n    if (extraBehaviours === void 0) {\n      extraBehaviours = [];\n    }\n\n    var action = actionOpt.fold(function () {\n      return {};\n    }, function (action) {\n      return {\n        action: action\n      };\n    });\n\n    var common = __assign({\n      buttonBehaviours: derive$1([DisablingConfigs.button(function () {\n        return spec.disabled || providersBackstage.isDisabled();\n      }), receivingConfig(), Tabstopping.config({}), config('button press', [preventDefault('click'), preventDefault('mousedown')])].concat(extraBehaviours)),\n      eventOrder: {\n        click: ['button press', 'alloy.base.behaviour'],\n        mousedown: ['button press', 'alloy.base.behaviour']\n      }\n    }, action);\n\n    var domFinal = deepMerge(common, {\n      dom: dom\n    });\n    return deepMerge(domFinal, {\n      components: components\n    });\n  };\n\n  var renderIconButtonSpec = function (spec, action, providersBackstage, extraBehaviours) {\n    if (extraBehaviours === void 0) {\n      extraBehaviours = [];\n    }\n\n    var tooltipAttributes = spec.tooltip.map(function (tooltip) {\n      return {\n        'aria-label': providersBackstage.translate(tooltip),\n        'title': providersBackstage.translate(tooltip)\n      };\n    }).getOr({});\n    var dom = {\n      tag: 'button',\n      classes: ['tox-tbtn'],\n      attributes: tooltipAttributes\n    };\n    var icon = spec.icon.map(function (iconName) {\n      return renderIconFromPack(iconName, providersBackstage.icons);\n    });\n    var components = componentRenderPipeline([icon]);\n    return renderCommonSpec(spec, action, extraBehaviours, dom, components, providersBackstage);\n  };\n\n  var renderIconButton = function (spec, action, providersBackstage, extraBehaviours) {\n    if (extraBehaviours === void 0) {\n      extraBehaviours = [];\n    }\n\n    var iconButtonSpec = renderIconButtonSpec(spec, Optional.some(action), providersBackstage, extraBehaviours);\n    return Button.sketch(iconButtonSpec);\n  };\n\n  var renderButtonSpec = function (spec, action, providersBackstage, extraBehaviours, extraClasses) {\n    if (extraBehaviours === void 0) {\n      extraBehaviours = [];\n    }\n\n    if (extraClasses === void 0) {\n      extraClasses = [];\n    }\n\n    var translatedText = providersBackstage.translate(spec.text);\n    var icon = spec.icon ? spec.icon.map(function (iconName) {\n      return renderIconFromPack(iconName, providersBackstage.icons);\n    }) : Optional.none();\n    var components = icon.isSome() ? componentRenderPipeline([icon]) : [];\n    var innerHtml = icon.isSome() ? {} : {\n      innerHtml: translatedText\n    };\n\n    var classes = __spreadArrays(!spec.primary && !spec.borderless ? ['tox-button', 'tox-button--secondary'] : ['tox-button'], icon.isSome() ? ['tox-button--icon'] : [], spec.borderless ? ['tox-button--naked'] : [], extraClasses);\n\n    var dom = __assign(__assign({\n      tag: 'button',\n      classes: classes\n    }, innerHtml), {\n      attributes: {\n        title: translatedText\n      }\n    });\n\n    return renderCommonSpec(spec, action, extraBehaviours, dom, components, providersBackstage);\n  };\n\n  var renderButton = function (spec, action, providersBackstage, extraBehaviours, extraClasses) {\n    if (extraBehaviours === void 0) {\n      extraBehaviours = [];\n    }\n\n    if (extraClasses === void 0) {\n      extraClasses = [];\n    }\n\n    var buttonSpec = renderButtonSpec(spec, Optional.some(action), providersBackstage, extraBehaviours, extraClasses);\n    return Button.sketch(buttonSpec);\n  };\n\n  var getAction = function (name, buttonType) {\n    return function (comp) {\n      if (buttonType === 'custom') {\n        emitWith(comp, formActionEvent, {\n          name: name,\n          value: {}\n        });\n      } else if (buttonType === 'submit') {\n        emit(comp, formSubmitEvent);\n      } else if (buttonType === 'cancel') {\n        emit(comp, formCancelEvent);\n      } else {\n        console.error('Unknown button type: ', buttonType);\n      }\n    };\n  };\n\n  var isMenuFooterButtonSpec = function (spec, buttonType) {\n    return buttonType === 'menu';\n  };\n\n  var isNormalFooterButtonSpec = function (spec, buttonType) {\n    return buttonType === 'custom' || buttonType === 'cancel' || buttonType === 'submit';\n  };\n\n  var renderFooterButton = function (spec, buttonType, backstage) {\n    if (isMenuFooterButtonSpec(spec, buttonType)) {\n      var getButton = function () {\n        return memButton_1;\n      };\n\n      var menuButtonSpec = spec;\n\n      var fixedSpec = __assign(__assign({}, spec), {\n        onSetup: function (api) {\n          api.setDisabled(spec.disabled);\n          return noop;\n        },\n        fetch: getFetch$1(menuButtonSpec.items, getButton, backstage)\n      });\n\n      var memButton_1 = record(renderMenuButton(fixedSpec, 'tox-tbtn', backstage, Optional.none()));\n      return memButton_1.asSpec();\n    } else if (isNormalFooterButtonSpec(spec, buttonType)) {\n      var action = getAction(spec.name, buttonType);\n\n      var buttonSpec = __assign(__assign({}, spec), {\n        borderless: false\n      });\n\n      return renderButton(buttonSpec, action, backstage.shared.providers, []);\n    } else {\n      console.error('Unknown footer button type: ', buttonType);\n    }\n  };\n\n  var renderDialogButton = function (spec, providersBackstage) {\n    var action = getAction(spec.name, 'custom');\n    return renderFormField(Optional.none(), FormField.parts.field(__assign({\n      factory: Button\n    }, renderButtonSpec(spec, Optional.some(action), providersBackstage, [RepresentingConfigs.memory(''), ComposingConfigs.self()]))));\n  };\n\n  var schema$i = constant([defaulted$1('field1Name', 'field1'), defaulted$1('field2Name', 'field2'), onStrictHandler('onLockedChange'), markers(['lockClass']), defaulted$1('locked', false), SketchBehaviours.field('coupledFieldBehaviours', [Composing, Representing])]);\n\n  var getField = function (comp, detail, partName) {\n    return getPart(comp, detail, partName).bind(Composing.getCurrent);\n  };\n\n  var coupledPart = function (selfName, otherName) {\n    return required({\n      factory: FormField,\n      name: selfName,\n      overrides: function (detail) {\n        return {\n          fieldBehaviours: derive$1([config('coupled-input-behaviour', [run(input(), function (me) {\n            getField(me, detail, otherName).each(function (other) {\n              getPart(me, detail, 'lock').each(function (lock) {\n                if (Toggling.isOn(lock)) {\n                  detail.onLockedChange(me, other, lock);\n                }\n              });\n            });\n          })])])\n        };\n      }\n    });\n  };\n\n  var parts$5 = constant([coupledPart('field1', 'field2'), coupledPart('field2', 'field1'), required({\n    factory: Button,\n    schema: [strict$1('dom')],\n    name: 'lock',\n    overrides: function (detail) {\n      return {\n        buttonBehaviours: derive$1([Toggling.config({\n          selected: detail.locked,\n          toggleClass: detail.markers.lockClass,\n          aria: {\n            mode: 'pressed'\n          }\n        })])\n      };\n    }\n  })]);\n\n  var factory$7 = function (detail, components, _spec, _externals) {\n    return {\n      uid: detail.uid,\n      dom: detail.dom,\n      components: components,\n      behaviours: SketchBehaviours.augment(detail.coupledFieldBehaviours, [Composing.config({\n        find: Optional.some\n      }), Representing.config({\n        store: {\n          mode: 'manual',\n          getValue: function (comp) {\n            var _a;\n\n            var parts = getPartsOrDie(comp, detail, ['field1', 'field2']);\n            return _a = {}, _a[detail.field1Name] = Representing.getValue(parts.field1()), _a[detail.field2Name] = Representing.getValue(parts.field2()), _a;\n          },\n          setValue: function (comp, value) {\n            var parts = getPartsOrDie(comp, detail, ['field1', 'field2']);\n\n            if (hasNonNullableKey(value, detail.field1Name)) {\n              Representing.setValue(parts.field1(), value[detail.field1Name]);\n            }\n\n            if (hasNonNullableKey(value, detail.field2Name)) {\n              Representing.setValue(parts.field2(), value[detail.field2Name]);\n            }\n          }\n        }\n      })]),\n      apis: {\n        getField1: function (component) {\n          return getPart(component, detail, 'field1');\n        },\n        getField2: function (component) {\n          return getPart(component, detail, 'field2');\n        },\n        getLock: function (component) {\n          return getPart(component, detail, 'lock');\n        }\n      }\n    };\n  };\n\n  var FormCoupledInputs = composite$1({\n    name: 'FormCoupledInputs',\n    configFields: schema$i(),\n    partFields: parts$5(),\n    factory: factory$7,\n    apis: {\n      getField1: function (apis, component) {\n        return apis.getField1(component);\n      },\n      getField2: function (apis, component) {\n        return apis.getField2(component);\n      },\n      getLock: function (apis, component) {\n        return apis.getLock(component);\n      }\n    }\n  });\n\n  var formatSize = function (size) {\n    var unitDec = {\n      '': 0,\n      'px': 0,\n      'pt': 1,\n      'mm': 1,\n      'pc': 2,\n      'ex': 2,\n      'em': 2,\n      'ch': 2,\n      'rem': 2,\n      'cm': 3,\n      'in': 4,\n      '%': 4\n    };\n\n    var maxDecimal = function (unit) {\n      return unit in unitDec ? unitDec[unit] : 1;\n    };\n\n    var numText = size.value.toFixed(maxDecimal(size.unit));\n\n    if (numText.indexOf('.') !== -1) {\n      numText = numText.replace(/\\.?0*$/, '');\n    }\n\n    return numText + size.unit;\n  };\n\n  var parseSize = function (sizeText) {\n    var numPattern = /^\\s*(\\d+(?:\\.\\d+)?)\\s*(|cm|mm|in|px|pt|pc|em|ex|ch|rem|vw|vh|vmin|vmax|%)\\s*$/;\n    var match = numPattern.exec(sizeText);\n\n    if (match !== null) {\n      var value = parseFloat(match[1]);\n      var unit = match[2];\n      return Result.value({\n        value: value,\n        unit: unit\n      });\n    } else {\n      return Result.error(sizeText);\n    }\n  };\n\n  var convertUnit = function (size, unit) {\n    var inInch = {\n      '': 96,\n      'px': 96,\n      'pt': 72,\n      'cm': 2.54,\n      'pc': 12,\n      'mm': 25.4,\n      'in': 1\n    };\n\n    var supported = function (u) {\n      return Object.prototype.hasOwnProperty.call(inInch, u);\n    };\n\n    if (size.unit === unit) {\n      return Optional.some(size.value);\n    } else if (supported(size.unit) && supported(unit)) {\n      if (inInch[size.unit] === inInch[unit]) {\n        return Optional.some(size.value);\n      } else {\n        return Optional.some(size.value / inInch[size.unit] * inInch[unit]);\n      }\n    } else {\n      return Optional.none();\n    }\n  };\n\n  var noSizeConversion = function (_input) {\n    return Optional.none();\n  };\n\n  var ratioSizeConversion = function (scale, unit) {\n    return function (size) {\n      return convertUnit(size, unit).map(function (value) {\n        return {\n          value: value * scale,\n          unit: unit\n        };\n      });\n    };\n  };\n\n  var makeRatioConverter = function (currentFieldText, otherFieldText) {\n    var cValue = parseSize(currentFieldText).toOptional();\n    var oValue = parseSize(otherFieldText).toOptional();\n    return lift2(cValue, oValue, function (cSize, oSize) {\n      return convertUnit(cSize, oSize.unit).map(function (val) {\n        return oSize.value / val;\n      }).map(function (r) {\n        return ratioSizeConversion(r, oSize.unit);\n      }).getOr(noSizeConversion);\n    }).getOr(noSizeConversion);\n  };\n\n  var renderSizeInput = function (spec, providersBackstage) {\n    var converter = noSizeConversion;\n    var ratioEvent = generate$1('ratio-event');\n    var pLock = FormCoupledInputs.parts.lock({\n      dom: {\n        tag: 'button',\n        classes: ['tox-lock', 'tox-button', 'tox-button--naked', 'tox-button--icon'],\n        attributes: {\n          title: providersBackstage.translate(spec.label.getOr('Constrain proportions'))\n        }\n      },\n      components: [{\n        dom: {\n          tag: 'span',\n          classes: ['tox-icon', 'tox-lock-icon__lock'],\n          innerHtml: get$e('lock', providersBackstage.icons)\n        }\n      }, {\n        dom: {\n          tag: 'span',\n          classes: ['tox-icon', 'tox-lock-icon__unlock'],\n          innerHtml: get$e('unlock', providersBackstage.icons)\n        }\n      }],\n      buttonBehaviours: derive$1([Disabling.config({\n        disabled: function () {\n          return spec.disabled || providersBackstage.isDisabled();\n        }\n      }), receivingConfig(), Tabstopping.config({})])\n    });\n\n    var formGroup = function (components) {\n      return {\n        dom: {\n          tag: 'div',\n          classes: ['tox-form__group']\n        },\n        components: components\n      };\n    };\n\n    var getFieldPart = function (isField1) {\n      return FormField.parts.field({\n        factory: Input,\n        inputClasses: ['tox-textfield'],\n        inputBehaviours: derive$1([Disabling.config({\n          disabled: function () {\n            return spec.disabled || providersBackstage.isDisabled();\n          }\n        }), receivingConfig(), Tabstopping.config({}), config('size-input-events', [run(focusin(), function (component, _simulatedEvent) {\n          emitWith(component, ratioEvent, {\n            isField1: isField1\n          });\n        }), run(change(), function (component, _simulatedEvent) {\n          emitWith(component, formChangeEvent, {\n            name: spec.name\n          });\n        })])]),\n        selectOnFocus: false\n      });\n    };\n\n    var getLabel = function (label) {\n      return {\n        dom: {\n          tag: 'label',\n          classes: ['tox-label'],\n          innerHtml: providersBackstage.translate(label)\n        }\n      };\n    };\n\n    var widthField = FormCoupledInputs.parts.field1(formGroup([FormField.parts.label(getLabel('Width')), getFieldPart(true)]));\n    var heightField = FormCoupledInputs.parts.field2(formGroup([FormField.parts.label(getLabel('Height')), getFieldPart(false)]));\n    return FormCoupledInputs.sketch({\n      dom: {\n        tag: 'div',\n        classes: ['tox-form__group']\n      },\n      components: [{\n        dom: {\n          tag: 'div',\n          classes: ['tox-form__controls-h-stack']\n        },\n        components: [widthField, heightField, formGroup([getLabel('&nbsp;'), pLock])]\n      }],\n      field1Name: 'width',\n      field2Name: 'height',\n      locked: true,\n      markers: {\n        lockClass: 'tox-locked'\n      },\n      onLockedChange: function (current, other, _lock) {\n        parseSize(Representing.getValue(current)).each(function (size) {\n          converter(size).each(function (newSize) {\n            Representing.setValue(other, formatSize(newSize));\n          });\n        });\n      },\n      coupledFieldBehaviours: derive$1([Disabling.config({\n        disabled: function () {\n          return spec.disabled || providersBackstage.isDisabled();\n        },\n        onDisabled: function (comp) {\n          FormCoupledInputs.getField1(comp).bind(FormField.getField).each(Disabling.disable);\n          FormCoupledInputs.getField2(comp).bind(FormField.getField).each(Disabling.disable);\n          FormCoupledInputs.getLock(comp).each(Disabling.disable);\n        },\n        onEnabled: function (comp) {\n          FormCoupledInputs.getField1(comp).bind(FormField.getField).each(Disabling.enable);\n          FormCoupledInputs.getField2(comp).bind(FormField.getField).each(Disabling.enable);\n          FormCoupledInputs.getLock(comp).each(Disabling.enable);\n        }\n      }), receivingConfig(), config('size-input-events2', [run(ratioEvent, function (component, simulatedEvent) {\n        var isField1 = simulatedEvent.event.isField1;\n        var optCurrent = isField1 ? FormCoupledInputs.getField1(component) : FormCoupledInputs.getField2(component);\n        var optOther = isField1 ? FormCoupledInputs.getField2(component) : FormCoupledInputs.getField1(component);\n        var value1 = optCurrent.map(Representing.getValue).getOr('');\n        var value2 = optOther.map(Representing.getValue).getOr('');\n        converter = makeRatioConverter(value1, value2);\n      })])])\n    });\n  };\n\n  var undo = constant(generate$1('undo'));\n  var redo = constant(generate$1('redo'));\n  var zoom = constant(generate$1('zoom'));\n  var back = constant(generate$1('back'));\n  var apply = constant(generate$1('apply'));\n  var swap = constant(generate$1('swap'));\n  var transform = constant(generate$1('transform'));\n  var tempTransform = constant(generate$1('temp-transform'));\n  var transformApply = constant(generate$1('transform-apply'));\n  var internal = {\n    undo: undo,\n    redo: redo,\n    zoom: zoom,\n    back: back,\n    apply: apply,\n    swap: swap,\n    transform: transform,\n    tempTransform: tempTransform,\n    transformApply: transformApply\n  };\n  var saveState = constant('save-state');\n  var disable$1 = constant('disable');\n  var enable$1 = constant('enable');\n  var external$2 = {\n    formActionEvent: formActionEvent,\n    saveState: saveState,\n    disable: disable$1,\n    enable: enable$1\n  };\n\n  var renderEditPanel = function (imagePanel, providersBackstage) {\n    var createButton = function (text, action, disabled, primary) {\n      return record(renderButton({\n        name: text,\n        text: text,\n        disabled: disabled,\n        primary: primary,\n        icon: Optional.none(),\n        borderless: false\n      }, action, providersBackstage));\n    };\n\n    var createIconButton = function (icon, tooltip, action, disabled) {\n      return record(renderIconButton({\n        name: icon,\n        icon: Optional.some(icon),\n        tooltip: Optional.some(tooltip),\n        disabled: disabled,\n        primary: false,\n        borderless: false\n      }, action, providersBackstage));\n    };\n\n    var disableAllComponents = function (comps, eventcomp) {\n      comps.map(function (mem) {\n        var component = mem.get(eventcomp);\n\n        if (component.hasConfigured(Disabling)) {\n          Disabling.disable(component);\n        }\n      });\n    };\n\n    var enableAllComponents = function (comps, eventcomp) {\n      comps.map(function (mem) {\n        var component = mem.get(eventcomp);\n\n        if (component.hasConfigured(Disabling)) {\n          Disabling.enable(component);\n        }\n      });\n    };\n\n    var panelDom = {\n      tag: 'div',\n      classes: ['tox-image-tools__toolbar', 'tox-image-tools-edit-panel']\n    };\n    var noop$1 = noop;\n\n    var emit$1 = function (comp, event, data) {\n      emitWith(comp, event, data);\n    };\n\n    var emitDisable = function (component) {\n      return emit(component, external$2.disable());\n    };\n\n    var emitEnable = function (component) {\n      return emit(component, external$2.enable());\n    };\n\n    var emitTransform = function (comp, transform) {\n      emitDisable(comp);\n      emit$1(comp, internal.transform(), {\n        transform: transform\n      });\n      emitEnable(comp);\n    };\n\n    var emitTempTransform = function (comp, transform) {\n      emitDisable(comp);\n      emit$1(comp, internal.tempTransform(), {\n        transform: transform\n      });\n      emitEnable(comp);\n    };\n\n    var getBackSwap = function (anyInSystem) {\n      return function () {\n        memContainer.getOpt(anyInSystem).each(function (container) {\n          Replacing.set(container, [ButtonPanel]);\n        });\n      };\n    };\n\n    var emitTransformApply = function (comp, transform) {\n      emitDisable(comp);\n      emit$1(comp, internal.transformApply(), {\n        transform: transform,\n        swap: getBackSwap(comp)\n      });\n      emitEnable(comp);\n    };\n\n    var createBackButton = function () {\n      return createButton('Back', function (button) {\n        return emit$1(button, internal.back(), {\n          swap: getBackSwap(button)\n        });\n      }, false, false);\n    };\n\n    var createSpacer = function () {\n      return record({\n        dom: {\n          tag: 'div',\n          classes: ['tox-spacer']\n        },\n        behaviours: derive$1([Disabling.config({})])\n      });\n    };\n\n    var createApplyButton = function () {\n      return createButton('Apply', function (button) {\n        return emit$1(button, internal.apply(), {\n          swap: getBackSwap(button)\n        });\n      }, true, true);\n    };\n\n    var makeCropTransform = function () {\n      return function (ir) {\n        var rect = imagePanel.getRect();\n        return crop$1(ir, rect.x, rect.y, rect.w, rect.h);\n      };\n    };\n\n    var cropPanelComponents = [createBackButton(), createSpacer(), createButton('Apply', function (button) {\n      var transform = makeCropTransform();\n      emitTransformApply(button, transform);\n      imagePanel.hideCrop();\n    }, false, true)];\n    var CropPanel = Container.sketch({\n      dom: panelDom,\n      components: cropPanelComponents.map(function (mem) {\n        return mem.asSpec();\n      }),\n      containerBehaviours: derive$1([config('image-tools-crop-buttons-events', [run(external$2.disable(), function (comp, _se) {\n        disableAllComponents(cropPanelComponents, comp);\n      }), run(external$2.enable(), function (comp, _se) {\n        enableAllComponents(cropPanelComponents, comp);\n      })])])\n    });\n    var memSize = record(renderSizeInput({\n      name: 'size',\n      label: Optional.none(),\n      constrain: true,\n      disabled: false\n    }, providersBackstage));\n\n    var makeResizeTransform = function (width, height) {\n      return function (ir) {\n        return resize$2(ir, width, height);\n      };\n    };\n\n    var resizePanelComponents = [createBackButton(), createSpacer(), memSize, createSpacer(), createButton('Apply', function (button) {\n      memSize.getOpt(button).each(function (sizeInput) {\n        var value = Representing.getValue(sizeInput);\n        var width = parseInt(value.width, 10);\n        var height = parseInt(value.height, 10);\n        var transform = makeResizeTransform(width, height);\n        emitTransformApply(button, transform);\n      });\n    }, false, true)];\n    var ResizePanel = Container.sketch({\n      dom: panelDom,\n      components: resizePanelComponents.map(function (mem) {\n        return mem.asSpec();\n      }),\n      containerBehaviours: derive$1([config('image-tools-resize-buttons-events', [run(external$2.disable(), function (comp, _se) {\n        disableAllComponents(resizePanelComponents, comp);\n      }), run(external$2.enable(), function (comp, _se) {\n        enableAllComponents(resizePanelComponents, comp);\n      })])])\n    });\n\n    var makeValueTransform = function (transform, value) {\n      return function (ir) {\n        return transform(ir, value);\n      };\n    };\n\n    var horizontalFlip = makeValueTransform(flip$1, 'h');\n    var verticalFlip = makeValueTransform(flip$1, 'v');\n    var counterclockwiseRotate = makeValueTransform(rotate$1, -90);\n    var clockwiseRotate = makeValueTransform(rotate$1, 90);\n\n    var flipRotateOnAction = function (comp, operation) {\n      emitTempTransform(comp, operation);\n    };\n\n    var flipRotateComponents = [createBackButton(), createSpacer(), createIconButton('flip-horizontally', 'Flip horizontally', function (button) {\n      flipRotateOnAction(button, horizontalFlip);\n    }, false), createIconButton('flip-vertically', 'Flip vertically', function (button) {\n      flipRotateOnAction(button, verticalFlip);\n    }, false), createIconButton('rotate-left', 'Rotate counterclockwise', function (button) {\n      flipRotateOnAction(button, counterclockwiseRotate);\n    }, false), createIconButton('rotate-right', 'Rotate clockwise', function (button) {\n      flipRotateOnAction(button, clockwiseRotate);\n    }, false), createSpacer(), createApplyButton()];\n    var FlipRotatePanel = Container.sketch({\n      dom: panelDom,\n      components: flipRotateComponents.map(function (mem) {\n        return mem.asSpec();\n      }),\n      containerBehaviours: derive$1([config('image-tools-fliprotate-buttons-events', [run(external$2.disable(), function (comp, _se) {\n        disableAllComponents(flipRotateComponents, comp);\n      }), run(external$2.enable(), function (comp, _se) {\n        enableAllComponents(flipRotateComponents, comp);\n      })])])\n    });\n\n    var makeSlider = function (label, onChoose, min, value, max) {\n      var labelPart = Slider.parts.label({\n        dom: {\n          tag: 'label',\n          classes: ['tox-label'],\n          innerHtml: providersBackstage.translate(label)\n        }\n      });\n      var spectrum = Slider.parts.spectrum({\n        dom: {\n          tag: 'div',\n          classes: ['tox-slider__rail'],\n          attributes: {\n            role: 'presentation'\n          }\n        }\n      });\n      var thumb = Slider.parts.thumb({\n        dom: {\n          tag: 'div',\n          classes: ['tox-slider__handle'],\n          attributes: {\n            role: 'presentation'\n          }\n        }\n      });\n      return record(Slider.sketch({\n        dom: {\n          tag: 'div',\n          classes: ['tox-slider'],\n          attributes: {\n            role: 'presentation'\n          }\n        },\n        model: {\n          mode: 'x',\n          minX: min,\n          maxX: max,\n          getInitialValue: constant({\n            x: value\n          })\n        },\n        components: [labelPart, spectrum, thumb],\n        sliderBehaviours: derive$1([Focusing.config({})]),\n        onChoose: onChoose\n      }));\n    };\n\n    var makeVariableSlider = function (label, transform, min, value, max) {\n      var onChoose = function (slider, _thumb, value) {\n        var valTransform = makeValueTransform(transform, value.x / 100);\n        emitTransform(slider, valTransform);\n      };\n\n      return makeSlider(label, onChoose, min, value, max);\n    };\n\n    var variableFilterPanelComponents = function (label, transform, min, value, max) {\n      return [createBackButton(), makeVariableSlider(label, transform, min, value, max), createApplyButton()];\n    };\n\n    var createVariableFilterPanel = function (label, transform, min, value, max) {\n      var filterPanelComponents = variableFilterPanelComponents(label, transform, min, value, max);\n      return Container.sketch({\n        dom: panelDom,\n        components: filterPanelComponents.map(function (mem) {\n          return mem.asSpec();\n        }),\n        containerBehaviours: derive$1([config('image-tools-filter-panel-buttons-events', [run(external$2.disable(), function (comp, _se) {\n          disableAllComponents(filterPanelComponents, comp);\n        }), run(external$2.enable(), function (comp, _se) {\n          enableAllComponents(filterPanelComponents, comp);\n        })])])\n      });\n    };\n\n    var filterPanelComponents = [createBackButton(), createSpacer(), createApplyButton()];\n    var FilterPanel = Container.sketch({\n      dom: panelDom,\n      components: filterPanelComponents.map(function (mem) {\n        return mem.asSpec();\n      })\n    });\n    var BrightnessPanel = createVariableFilterPanel('Brightness', brightness$1, -100, 0, 100);\n    var ContrastPanel = createVariableFilterPanel('Contrast', contrast$1, -100, 0, 100);\n    var GammaPanel = createVariableFilterPanel('Gamma', gamma$1, -100, 0, 100);\n\n    var makeColorTransform = function (red, green, blue) {\n      return function (ir) {\n        return colorize$1(ir, red, green, blue);\n      };\n    };\n\n    var makeColorSlider = function (label) {\n      var onChoose = function (slider, _thumb, _value) {\n        var redOpt = memRed.getOpt(slider);\n        var blueOpt = memBlue.getOpt(slider);\n        var greenOpt = memGreen.getOpt(slider);\n        redOpt.each(function (red) {\n          blueOpt.each(function (blue) {\n            greenOpt.each(function (green) {\n              var r = Representing.getValue(red).x / 100;\n              var g = Representing.getValue(green).x / 100;\n              var b = Representing.getValue(blue).x / 100;\n              var transform = makeColorTransform(r, g, b);\n              emitTransform(slider, transform);\n            });\n          });\n        });\n      };\n\n      return makeSlider(label, onChoose, 0, 100, 200);\n    };\n\n    var memRed = makeColorSlider('R');\n    var memGreen = makeColorSlider('G');\n    var memBlue = makeColorSlider('B');\n    var colorizePanelComponents = [createBackButton(), memRed, memGreen, memBlue, createApplyButton()];\n    var ColorizePanel = Container.sketch({\n      dom: panelDom,\n      components: colorizePanelComponents.map(function (mem) {\n        return mem.asSpec();\n      })\n    });\n\n    var getTransformPanelEvent = function (panel, transform, update) {\n      return function (button) {\n        var swap = function () {\n          memContainer.getOpt(button).each(function (container) {\n            Replacing.set(container, [panel]);\n            update(container);\n          });\n        };\n\n        emit$1(button, internal.swap(), {\n          transform: transform,\n          swap: swap\n        });\n      };\n    };\n\n    var cropPanelUpdate = function (_anyInSystem) {\n      imagePanel.showCrop();\n    };\n\n    var resizePanelUpdate = function (anyInSystem) {\n      memSize.getOpt(anyInSystem).each(function (sizeInput) {\n        var measurements = imagePanel.getMeasurements();\n        var width = measurements.width;\n        var height = measurements.height;\n        Representing.setValue(sizeInput, {\n          width: width,\n          height: height\n        });\n      });\n    };\n\n    var sharpenTransform = Optional.some(sharpen$1);\n    var invertTransform = Optional.some(invert$1);\n    var buttonPanelComponents = [createIconButton('crop', 'Crop', getTransformPanelEvent(CropPanel, Optional.none(), cropPanelUpdate), false), createIconButton('resize', 'Resize', getTransformPanelEvent(ResizePanel, Optional.none(), resizePanelUpdate), false), createIconButton('orientation', 'Orientation', getTransformPanelEvent(FlipRotatePanel, Optional.none(), noop$1), false), createIconButton('brightness', 'Brightness', getTransformPanelEvent(BrightnessPanel, Optional.none(), noop$1), false), createIconButton('sharpen', 'Sharpen', getTransformPanelEvent(FilterPanel, sharpenTransform, noop$1), false), createIconButton('contrast', 'Contrast', getTransformPanelEvent(ContrastPanel, Optional.none(), noop$1), false), createIconButton('color-levels', 'Color levels', getTransformPanelEvent(ColorizePanel, Optional.none(), noop$1), false), createIconButton('gamma', 'Gamma', getTransformPanelEvent(GammaPanel, Optional.none(), noop$1), false), createIconButton('invert', 'Invert', getTransformPanelEvent(FilterPanel, invertTransform, noop$1), false)];\n    var ButtonPanel = Container.sketch({\n      dom: panelDom,\n      components: buttonPanelComponents.map(function (mem) {\n        return mem.asSpec();\n      })\n    });\n    var container = Container.sketch({\n      dom: {\n        tag: 'div'\n      },\n      components: [ButtonPanel],\n      containerBehaviours: derive$1([Replacing.config({})])\n    });\n    var memContainer = record(container);\n\n    var getApplyButton = function (anyInSystem) {\n      return memContainer.getOpt(anyInSystem).map(function (container) {\n        var panel = container.components()[0];\n        return panel.components()[panel.components().length - 1];\n      });\n    };\n\n    return {\n      memContainer: memContainer,\n      getApplyButton: getApplyButton\n    };\n  };\n\n  var global$d = tinymce.util.Tools.resolve('tinymce.geom.Rect');\n  var global$e = tinymce.util.Tools.resolve('tinymce.dom.DomQuery');\n  var global$f = tinymce.util.Tools.resolve('tinymce.util.Observable');\n  var global$g = tinymce.util.Tools.resolve('tinymce.util.VK');\n\n  var getDocumentSize = function (doc) {\n    var max = Math.max;\n    var documentElement = doc.documentElement;\n    var body = doc.body;\n    var scrollWidth = max(documentElement.scrollWidth, body.scrollWidth);\n    var clientWidth = max(documentElement.clientWidth, body.clientWidth);\n    var offsetWidth = max(documentElement.offsetWidth, body.offsetWidth);\n    var scrollHeight = max(documentElement.scrollHeight, body.scrollHeight);\n    var clientHeight = max(documentElement.clientHeight, body.clientHeight);\n    var offsetHeight = max(documentElement.offsetHeight, body.offsetHeight);\n    return {\n      width: scrollWidth < offsetWidth ? clientWidth : scrollWidth,\n      height: scrollHeight < offsetHeight ? clientHeight : scrollHeight\n    };\n  };\n\n  var updateWithTouchData = function (e) {\n    var keys, i;\n\n    if (e.changedTouches) {\n      keys = 'screenX screenY pageX pageY clientX clientY'.split(' ');\n\n      for (i = 0; i < keys.length; i++) {\n        e[keys[i]] = e.changedTouches[0][keys[i]];\n      }\n    }\n  };\n\n  function DragHelper(id, settings) {\n    var $eventOverlay;\n    var doc = settings.document || document;\n    var downButton;\n    var startX, startY;\n    var handleElement = doc.getElementById(settings.handle || id);\n\n    var start = function (e) {\n      var docSize = getDocumentSize(doc);\n      var cursor;\n      updateWithTouchData(e);\n      e.preventDefault();\n      downButton = e.button;\n      var handleElm = handleElement;\n      startX = e.screenX;\n      startY = e.screenY;\n\n      if (window.getComputedStyle) {\n        cursor = window.getComputedStyle(handleElm, null).getPropertyValue('cursor');\n      } else {\n        cursor = handleElm.runtimeStyle.cursor;\n      }\n\n      $eventOverlay = global$e('<div></div>').css({\n        position: 'absolute',\n        top: 0,\n        left: 0,\n        width: docSize.width,\n        height: docSize.height,\n        zIndex: 2147483647,\n        opacity: 0.0001,\n        cursor: cursor\n      }).appendTo(doc.body);\n      global$e(doc).on('mousemove touchmove', drag).on('mouseup touchend', stop);\n      settings.start(e);\n    };\n\n    var drag = function (e) {\n      updateWithTouchData(e);\n\n      if (e.button !== downButton) {\n        return stop(e);\n      }\n\n      e.deltaX = e.screenX - startX;\n      e.deltaY = e.screenY - startY;\n      e.preventDefault();\n      settings.drag(e);\n    };\n\n    var stop = function (e) {\n      updateWithTouchData(e);\n      global$e(doc).off('mousemove touchmove', drag).off('mouseup touchend', stop);\n      $eventOverlay.remove();\n\n      if (settings.stop) {\n        settings.stop(e);\n      }\n    };\n\n    var destroy = function () {\n      global$e(handleElement).off();\n    };\n\n    global$e(handleElement).on('mousedown touchstart', start);\n    return {\n      destroy: destroy\n    };\n  }\n\n  var count = 0;\n\n  var create$7 = function (currentRect, viewPortRect, clampRect, containerElm, action) {\n    var dragHelpers;\n    var prefix = 'tox-';\n    var id = prefix + 'crid-' + count++;\n    var handles = [{\n      name: 'move',\n      xMul: 0,\n      yMul: 0,\n      deltaX: 1,\n      deltaY: 1,\n      deltaW: 0,\n      deltaH: 0,\n      label: 'Crop Mask'\n    }, {\n      name: 'nw',\n      xMul: 0,\n      yMul: 0,\n      deltaX: 1,\n      deltaY: 1,\n      deltaW: -1,\n      deltaH: -1,\n      label: 'Top Left Crop Handle'\n    }, {\n      name: 'ne',\n      xMul: 1,\n      yMul: 0,\n      deltaX: 0,\n      deltaY: 1,\n      deltaW: 1,\n      deltaH: -1,\n      label: 'Top Right Crop Handle'\n    }, {\n      name: 'sw',\n      xMul: 0,\n      yMul: 1,\n      deltaX: 1,\n      deltaY: 0,\n      deltaW: -1,\n      deltaH: 1,\n      label: 'Bottom Left Crop Handle'\n    }, {\n      name: 'se',\n      xMul: 1,\n      yMul: 1,\n      deltaX: 0,\n      deltaY: 0,\n      deltaW: 1,\n      deltaH: 1,\n      label: 'Bottom Right Crop Handle'\n    }];\n    var blockers = ['top', 'right', 'bottom', 'left'];\n\n    var getAbsoluteRect = function (outerRect, relativeRect) {\n      return {\n        x: relativeRect.x + outerRect.x,\n        y: relativeRect.y + outerRect.y,\n        w: relativeRect.w,\n        h: relativeRect.h\n      };\n    };\n\n    var getRelativeRect = function (outerRect, innerRect) {\n      return {\n        x: innerRect.x - outerRect.x,\n        y: innerRect.y - outerRect.y,\n        w: innerRect.w,\n        h: innerRect.h\n      };\n    };\n\n    var getInnerRect = function () {\n      return getRelativeRect(clampRect, currentRect);\n    };\n\n    var moveRect = function (handle, startRect, deltaX, deltaY) {\n      var x, y, w, h, rect;\n      x = startRect.x;\n      y = startRect.y;\n      w = startRect.w;\n      h = startRect.h;\n      x += deltaX * handle.deltaX;\n      y += deltaY * handle.deltaY;\n      w += deltaX * handle.deltaW;\n      h += deltaY * handle.deltaH;\n\n      if (w < 20) {\n        w = 20;\n      }\n\n      if (h < 20) {\n        h = 20;\n      }\n\n      rect = currentRect = global$d.clamp({\n        x: x,\n        y: y,\n        w: w,\n        h: h\n      }, clampRect, handle.name === 'move');\n      rect = getRelativeRect(clampRect, rect);\n      instance.fire('updateRect', {\n        rect: rect\n      });\n      setInnerRect(rect);\n    };\n\n    var render = function () {\n      var createDragHelper = function (handle) {\n        var startRect;\n        return DragHelper(id, {\n          document: containerElm.ownerDocument,\n          handle: id + '-' + handle.name,\n          start: function () {\n            startRect = currentRect;\n          },\n          drag: function (e) {\n            moveRect(handle, startRect, e.deltaX, e.deltaY);\n          }\n        });\n      };\n\n      global$e('<div id=\"' + id + '\" class=\"' + prefix + 'croprect-container\"' + ' role=\"grid\" aria-dropeffect=\"execute\">').appendTo(containerElm);\n      global$c.each(blockers, function (blocker) {\n        global$e('#' + id, containerElm).append('<div id=\"' + id + '-' + blocker + '\"class=\"' + prefix + 'croprect-block\" style=\"display: none\" data-mce-bogus=\"all\">');\n      });\n      global$c.each(handles, function (handle) {\n        global$e('#' + id, containerElm).append('<div id=\"' + id + '-' + handle.name + '\" class=\"' + prefix + 'croprect-handle ' + prefix + 'croprect-handle-' + handle.name + '\"' + 'style=\"display: none\" data-mce-bogus=\"all\" role=\"gridcell\" tabindex=\"-1\"' + ' aria-label=\"' + handle.label + '\" aria-grabbed=\"false\" title=\"' + handle.label + '\">');\n      });\n      dragHelpers = global$c.map(handles, createDragHelper);\n      repaint(currentRect);\n      global$e(containerElm).on('focusin focusout', function (e) {\n        global$e(e.target).attr('aria-grabbed', e.type === 'focus' ? 'true' : 'false');\n      });\n      global$e(containerElm).on('keydown', function (e) {\n        var activeHandle;\n        global$c.each(handles, function (handle) {\n          if (e.target.id === id + '-' + handle.name) {\n            activeHandle = handle;\n            return false;\n          }\n        });\n\n        var moveAndBlock = function (evt, handle, startRect, deltaX, deltaY) {\n          evt.stopPropagation();\n          evt.preventDefault();\n          moveRect(activeHandle, startRect, deltaX, deltaY);\n        };\n\n        switch (e.keyCode) {\n          case global$g.LEFT:\n            moveAndBlock(e, activeHandle, currentRect, -10, 0);\n            break;\n\n          case global$g.RIGHT:\n            moveAndBlock(e, activeHandle, currentRect, 10, 0);\n            break;\n\n          case global$g.UP:\n            moveAndBlock(e, activeHandle, currentRect, 0, -10);\n            break;\n\n          case global$g.DOWN:\n            moveAndBlock(e, activeHandle, currentRect, 0, 10);\n            break;\n\n          case global$g.ENTER:\n          case global$g.SPACEBAR:\n            e.preventDefault();\n            action();\n            break;\n        }\n      });\n    };\n\n    var toggleVisibility = function (state) {\n      var selectors = global$c.map(handles, function (handle) {\n        return '#' + id + '-' + handle.name;\n      }).concat(global$c.map(blockers, function (blocker) {\n        return '#' + id + '-' + blocker;\n      })).join(',');\n\n      if (state) {\n        global$e(selectors, containerElm).show();\n      } else {\n        global$e(selectors, containerElm).hide();\n      }\n    };\n\n    var repaint = function (rect) {\n      var updateElementRect = function (name, rect) {\n        if (rect.h < 0) {\n          rect.h = 0;\n        }\n\n        if (rect.w < 0) {\n          rect.w = 0;\n        }\n\n        global$e('#' + id + '-' + name, containerElm).css({\n          left: rect.x,\n          top: rect.y,\n          width: rect.w,\n          height: rect.h\n        });\n      };\n\n      global$c.each(handles, function (handle) {\n        global$e('#' + id + '-' + handle.name, containerElm).css({\n          left: rect.w * handle.xMul + rect.x,\n          top: rect.h * handle.yMul + rect.y\n        });\n      });\n      updateElementRect('top', {\n        x: viewPortRect.x,\n        y: viewPortRect.y,\n        w: viewPortRect.w,\n        h: rect.y - viewPortRect.y\n      });\n      updateElementRect('right', {\n        x: rect.x + rect.w,\n        y: rect.y,\n        w: viewPortRect.w - rect.x - rect.w + viewPortRect.x,\n        h: rect.h\n      });\n      updateElementRect('bottom', {\n        x: viewPortRect.x,\n        y: rect.y + rect.h,\n        w: viewPortRect.w,\n        h: viewPortRect.h - rect.y - rect.h + viewPortRect.y\n      });\n      updateElementRect('left', {\n        x: viewPortRect.x,\n        y: rect.y,\n        w: rect.x - viewPortRect.x,\n        h: rect.h\n      });\n      updateElementRect('move', rect);\n    };\n\n    var setRect = function (rect) {\n      currentRect = rect;\n      repaint(currentRect);\n    };\n\n    var setViewPortRect = function (rect) {\n      viewPortRect = rect;\n      repaint(currentRect);\n    };\n\n    var setInnerRect = function (rect) {\n      setRect(getAbsoluteRect(clampRect, rect));\n    };\n\n    var setClampRect = function (rect) {\n      clampRect = rect;\n      repaint(currentRect);\n    };\n\n    var destroy = function () {\n      global$c.each(dragHelpers, function (helper) {\n        helper.destroy();\n      });\n      dragHelpers = [];\n    };\n\n    render();\n    var instance = global$c.extend({\n      toggleVisibility: toggleVisibility,\n      setClampRect: setClampRect,\n      setRect: setRect,\n      getInnerRect: getInnerRect,\n      setInnerRect: setInnerRect,\n      setViewPortRect: setViewPortRect,\n      destroy: destroy\n    }, global$f);\n    return instance;\n  };\n\n  var CropRect = {\n    create: create$7\n  };\n\n  var loadImage = function (image) {\n    return new global$4(function (resolve) {\n      var loaded = function () {\n        image.removeEventListener('load', loaded);\n        resolve(image);\n      };\n\n      if (image.complete) {\n        resolve(image);\n      } else {\n        image.addEventListener('load', loaded);\n      }\n    });\n  };\n\n  var renderImagePanel = function (initialUrl) {\n    var memBg = record({\n      dom: {\n        tag: 'div',\n        classes: ['tox-image-tools__image-bg'],\n        attributes: {\n          role: 'presentation'\n        }\n      }\n    });\n    var zoomState = Cell(1);\n    var cropRect = Cell(Optional.none());\n    var rectState = Cell({\n      x: 0,\n      y: 0,\n      w: 1,\n      h: 1\n    });\n    var viewRectState = Cell({\n      x: 0,\n      y: 0,\n      w: 1,\n      h: 1\n    });\n\n    var repaintImg = function (anyInSystem, img) {\n      memContainer.getOpt(anyInSystem).each(function (panel) {\n        var zoom = zoomState.get();\n        var panelW = get$8(panel.element);\n        var panelH = get$7(panel.element);\n        var width = img.dom.naturalWidth * zoom;\n        var height = img.dom.naturalHeight * zoom;\n        var left = Math.max(0, panelW / 2 - width / 2);\n        var top = Math.max(0, panelH / 2 - height / 2);\n        var css = {\n          left: left.toString() + 'px',\n          top: top.toString() + 'px',\n          width: width.toString() + 'px',\n          height: height.toString() + 'px',\n          position: 'absolute'\n        };\n        setAll$1(img, css);\n        memBg.getOpt(panel).each(function (bg) {\n          setAll$1(bg.element, css);\n        });\n        cropRect.get().each(function (cRect) {\n          var rect = rectState.get();\n          cRect.setRect({\n            x: rect.x * zoom + left,\n            y: rect.y * zoom + top,\n            w: rect.w * zoom,\n            h: rect.h * zoom\n          });\n          cRect.setClampRect({\n            x: left,\n            y: top,\n            w: width,\n            h: height\n          });\n          cRect.setViewPortRect({\n            x: 0,\n            y: 0,\n            w: panelW,\n            h: panelH\n          });\n        });\n      });\n    };\n\n    var zoomFit = function (anyInSystem, img) {\n      memContainer.getOpt(anyInSystem).each(function (panel) {\n        var panelW = get$8(panel.element);\n        var panelH = get$7(panel.element);\n        var width = img.dom.naturalWidth;\n        var height = img.dom.naturalHeight;\n        var zoom = Math.min(panelW / width, panelH / height);\n\n        if (zoom >= 1) {\n          zoomState.set(1);\n        } else {\n          zoomState.set(zoom);\n        }\n      });\n    };\n\n    var updateSrc = function (anyInSystem, url) {\n      var img = SugarElement.fromTag('img');\n      set$1(img, 'src', url);\n      return loadImage(img.dom).then(function () {\n        return memContainer.getOpt(anyInSystem).map(function (panel) {\n          var aImg = external({\n            element: img\n          });\n          Replacing.replaceAt(panel, 1, Optional.some(aImg));\n          var lastViewRect = viewRectState.get();\n          var viewRect = {\n            x: 0,\n            y: 0,\n            w: img.dom.naturalWidth,\n            h: img.dom.naturalHeight\n          };\n          viewRectState.set(viewRect);\n          var rect = global$d.inflate(viewRect, -20, -20);\n          rectState.set(rect);\n\n          if (lastViewRect.w !== viewRect.w || lastViewRect.h !== viewRect.h) {\n            zoomFit(panel, img);\n          }\n\n          repaintImg(panel, img);\n          return img;\n        });\n      });\n    };\n\n    var zoom = function (anyInSystem, direction) {\n      var currentZoom = zoomState.get();\n      var newZoom = direction > 0 ? Math.min(2, currentZoom + 0.1) : Math.max(0.1, currentZoom - 0.1);\n      zoomState.set(newZoom);\n      memContainer.getOpt(anyInSystem).each(function (panel) {\n        var img = panel.components()[1].element;\n        repaintImg(panel, img);\n      });\n    };\n\n    var showCrop = function () {\n      cropRect.get().each(function (cRect) {\n        cRect.toggleVisibility(true);\n      });\n    };\n\n    var hideCrop = function () {\n      cropRect.get().each(function (cRect) {\n        cRect.toggleVisibility(false);\n      });\n    };\n\n    var getRect = function () {\n      return rectState.get();\n    };\n\n    var container = Container.sketch({\n      dom: {\n        tag: 'div',\n        classes: ['tox-image-tools__image']\n      },\n      components: [memBg.asSpec(), {\n        dom: {\n          tag: 'img',\n          attributes: {\n            src: initialUrl\n          }\n        }\n      }, {\n        dom: {\n          tag: 'div'\n        },\n        behaviours: derive$1([config('image-panel-crop-events', [runOnAttached(function (comp) {\n          memContainer.getOpt(comp).each(function (container) {\n            var el = container.element.dom;\n            var cRect = CropRect.create({\n              x: 10,\n              y: 10,\n              w: 100,\n              h: 100\n            }, {\n              x: 0,\n              y: 0,\n              w: 200,\n              h: 200\n            }, {\n              x: 0,\n              y: 0,\n              w: 200,\n              h: 200\n            }, el, noop);\n            cRect.toggleVisibility(false);\n            cRect.on('updateRect', function (e) {\n              var rect = e.rect;\n              var zoom = zoomState.get();\n              var newRect = {\n                x: Math.round(rect.x / zoom),\n                y: Math.round(rect.y / zoom),\n                w: Math.round(rect.w / zoom),\n                h: Math.round(rect.h / zoom)\n              };\n              rectState.set(newRect);\n            });\n            cropRect.set(Optional.some(cRect));\n          });\n        })])])\n      }],\n      containerBehaviours: derive$1([Replacing.config({}), config('image-panel-events', [runOnAttached(function (comp) {\n        updateSrc(comp, initialUrl);\n      })])])\n    });\n    var memContainer = record(container);\n\n    var getMeasurements = function () {\n      var viewRect = viewRectState.get();\n      return {\n        width: viewRect.w,\n        height: viewRect.h\n      };\n    };\n\n    return {\n      memContainer: memContainer,\n      updateSrc: updateSrc,\n      zoom: zoom,\n      showCrop: showCrop,\n      hideCrop: hideCrop,\n      getRect: getRect,\n      getMeasurements: getMeasurements\n    };\n  };\n\n  var createButton = function (innerHtml, icon, disabled, action, providersBackstage) {\n    return renderIconButton({\n      name: innerHtml,\n      icon: Optional.some(icon),\n      disabled: disabled,\n      tooltip: Optional.some(innerHtml),\n      primary: false,\n      borderless: false\n    }, action, providersBackstage);\n  };\n\n  var setButtonEnabled = function (button, enabled) {\n    if (enabled) {\n      Disabling.enable(button);\n    } else {\n      Disabling.disable(button);\n    }\n  };\n\n  var renderSideBar = function (providersBackstage) {\n    var updateButtonUndoStates = function (anyInSystem, undoEnabled, redoEnabled) {\n      memUndo.getOpt(anyInSystem).each(function (undo) {\n        setButtonEnabled(undo, undoEnabled);\n      });\n      memRedo.getOpt(anyInSystem).each(function (redo) {\n        setButtonEnabled(redo, redoEnabled);\n      });\n    };\n\n    var memUndo = record(createButton('Undo', 'undo', true, function (button) {\n      emitWith(button, internal.undo(), {\n        direction: 1\n      });\n    }, providersBackstage));\n    var memRedo = record(createButton('Redo', 'redo', true, function (button) {\n      emitWith(button, internal.redo(), {\n        direction: 1\n      });\n    }, providersBackstage));\n    var container = Container.sketch({\n      dom: {\n        tag: 'div',\n        classes: ['tox-image-tools__toolbar', 'tox-image-tools__sidebar']\n      },\n      components: [memUndo.asSpec(), memRedo.asSpec(), createButton('Zoom in', 'zoom-in', false, function (button) {\n        emitWith(button, internal.zoom(), {\n          direction: 1\n        });\n      }, providersBackstage), createButton('Zoom out', 'zoom-out', false, function (button) {\n        emitWith(button, internal.zoom(), {\n          direction: -1\n        });\n      }, providersBackstage)]\n    });\n    return {\n      container: container,\n      updateButtonUndoStates: updateButtonUndoStates\n    };\n  };\n\n  function UndoStack() {\n    var data = [];\n    var index = -1;\n\n    var add = function (state) {\n      var removed = data.splice(++index);\n      data.push(state);\n      return {\n        state: state,\n        removed: removed\n      };\n    };\n\n    var undo = function () {\n      if (canUndo()) {\n        return data[--index];\n      }\n    };\n\n    var redo = function () {\n      if (canRedo()) {\n        return data[++index];\n      }\n    };\n\n    var canUndo = function () {\n      return index > 0;\n    };\n\n    var canRedo = function () {\n      return index !== -1 && index < data.length - 1;\n    };\n\n    return {\n      data: data,\n      add: add,\n      undo: undo,\n      redo: redo,\n      canUndo: canUndo,\n      canRedo: canRedo\n    };\n  }\n\n  var makeState = function (initialState) {\n    var blobState = Cell(initialState);\n    var tempState = Cell(Optional.none());\n    var undoStack = UndoStack();\n    undoStack.add(initialState);\n\n    var getBlobState = function () {\n      return blobState.get();\n    };\n\n    var setBlobState = function (state) {\n      blobState.set(state);\n    };\n\n    var getTempState = function () {\n      return tempState.get().fold(function () {\n        return blobState.get();\n      }, function (temp) {\n        return temp;\n      });\n    };\n\n    var updateTempState = function (blob) {\n      var newTempState = createState(blob);\n      destroyTempState();\n      tempState.set(Optional.some(newTempState));\n      return newTempState.url;\n    };\n\n    var createState = function (blob) {\n      return {\n        blob: blob,\n        url: URL.createObjectURL(blob)\n      };\n    };\n\n    var destroyState = function (state) {\n      URL.revokeObjectURL(state.url);\n    };\n\n    var destroyStates = function (states) {\n      global$c.each(states, destroyState);\n    };\n\n    var destroyTempState = function () {\n      tempState.get().each(destroyState);\n      tempState.set(Optional.none());\n    };\n\n    var addBlobState = function (blob) {\n      var newState = createState(blob);\n      setBlobState(newState);\n      var removed = undoStack.add(newState).removed;\n      destroyStates(removed);\n      return newState.url;\n    };\n\n    var addTempState = function (blob) {\n      var newState = createState(blob);\n      tempState.set(Optional.some(newState));\n      return newState.url;\n    };\n\n    var applyTempState = function (postApply) {\n      return tempState.get().fold(noop, function (temp) {\n        addBlobState(temp.blob);\n        postApply();\n      });\n    };\n\n    var undo = function () {\n      var currentState = undoStack.undo();\n      setBlobState(currentState);\n      return currentState.url;\n    };\n\n    var redo = function () {\n      var currentState = undoStack.redo();\n      setBlobState(currentState);\n      return currentState.url;\n    };\n\n    var getHistoryStates = function () {\n      var undoEnabled = undoStack.canUndo();\n      var redoEnabled = undoStack.canRedo();\n      return {\n        undoEnabled: undoEnabled,\n        redoEnabled: redoEnabled\n      };\n    };\n\n    return {\n      getBlobState: getBlobState,\n      setBlobState: setBlobState,\n      addBlobState: addBlobState,\n      getTempState: getTempState,\n      updateTempState: updateTempState,\n      addTempState: addTempState,\n      applyTempState: applyTempState,\n      destroyTempState: destroyTempState,\n      undo: undo,\n      redo: redo,\n      getHistoryStates: getHistoryStates\n    };\n  };\n\n  var renderImageTools = function (detail, providersBackstage) {\n    var state = makeState(detail.currentState);\n\n    var zoom = function (anyInSystem, simulatedEvent) {\n      var direction = simulatedEvent.event.direction;\n      imagePanel.zoom(anyInSystem, direction);\n    };\n\n    var updateButtonUndoStates = function (anyInSystem) {\n      var historyStates = state.getHistoryStates();\n      sideBar.updateButtonUndoStates(anyInSystem, historyStates.undoEnabled, historyStates.redoEnabled);\n      emitWith(anyInSystem, external$2.formActionEvent, {\n        name: external$2.saveState(),\n        value: historyStates.undoEnabled\n      });\n    };\n\n    var disableUndoRedo = function (anyInSystem) {\n      sideBar.updateButtonUndoStates(anyInSystem, false, false);\n    };\n\n    var undo = function (anyInSystem, _simulatedEvent) {\n      var url = state.undo();\n      updateSrc(anyInSystem, url).then(function (_oImg) {\n        unblock(anyInSystem);\n        updateButtonUndoStates(anyInSystem);\n      });\n    };\n\n    var redo = function (anyInSystem, _simulatedEvent) {\n      var url = state.redo();\n      updateSrc(anyInSystem, url).then(function (_oImg) {\n        unblock(anyInSystem);\n        updateButtonUndoStates(anyInSystem);\n      });\n    };\n\n    var imageResultToBlob = function (ir) {\n      return ir.toBlob();\n    };\n\n    var block = function (anyInSystem) {\n      emitWith(anyInSystem, external$2.formActionEvent, {\n        name: external$2.disable(),\n        value: {}\n      });\n    };\n\n    var unblock = function (anyInSystem) {\n      editPanel.getApplyButton(anyInSystem).each(function (applyButton) {\n        Disabling.enable(applyButton);\n      });\n      emitWith(anyInSystem, external$2.formActionEvent, {\n        name: external$2.enable(),\n        value: {}\n      });\n    };\n\n    var updateSrc = function (anyInSystem, src) {\n      block(anyInSystem);\n      return imagePanel.updateSrc(anyInSystem, src);\n    };\n\n    var blobManipulate = function (anyInSystem, blob, filter, action, swap) {\n      block(anyInSystem);\n      return blobToImageResult(blob).then(filter).then(imageResultToBlob).then(action).then(function (url) {\n        return updateSrc(anyInSystem, url).then(function (oImg) {\n          updateButtonUndoStates(anyInSystem);\n          swap();\n          unblock(anyInSystem);\n          return oImg;\n        });\n      }).catch(function (err) {\n        console.log(err);\n        unblock(anyInSystem);\n        return err;\n      });\n    };\n\n    var manipulate = function (anyInSystem, filter, swap) {\n      var blob = state.getBlobState().blob;\n\n      var action = function (blob) {\n        return state.updateTempState(blob);\n      };\n\n      blobManipulate(anyInSystem, blob, filter, action, swap);\n    };\n\n    var tempManipulate = function (anyInSystem, filter) {\n      var blob = state.getTempState().blob;\n\n      var action = function (blob) {\n        return state.addTempState(blob);\n      };\n\n      blobManipulate(anyInSystem, blob, filter, action, noop);\n    };\n\n    var manipulateApply = function (anyInSystem, filter, swap) {\n      var blob = state.getBlobState().blob;\n\n      var action = function (blob) {\n        var url = state.addBlobState(blob);\n        destroyTempState(anyInSystem);\n        return url;\n      };\n\n      blobManipulate(anyInSystem, blob, filter, action, swap);\n    };\n\n    var apply = function (anyInSystem, simulatedEvent) {\n      var postApply = function () {\n        destroyTempState(anyInSystem);\n        var swap = simulatedEvent.event.swap;\n        swap();\n      };\n\n      state.applyTempState(postApply);\n    };\n\n    var destroyTempState = function (anyInSystem) {\n      var currentUrl = state.getBlobState().url;\n      state.destroyTempState();\n      updateButtonUndoStates(anyInSystem);\n      return currentUrl;\n    };\n\n    var cancel = function (anyInSystem) {\n      var currentUrl = destroyTempState(anyInSystem);\n      updateSrc(anyInSystem, currentUrl).then(function (_oImg) {\n        unblock(anyInSystem);\n      });\n    };\n\n    var back = function (anyInSystem, simulatedEvent) {\n      cancel(anyInSystem);\n      var swap = simulatedEvent.event.swap;\n      swap();\n      imagePanel.hideCrop();\n    };\n\n    var transform = function (anyInSystem, simulatedEvent) {\n      return manipulate(anyInSystem, simulatedEvent.event.transform, noop);\n    };\n\n    var tempTransform = function (anyInSystem, simulatedEvent) {\n      return tempManipulate(anyInSystem, simulatedEvent.event.transform);\n    };\n\n    var transformApply = function (anyInSystem, simulatedEvent) {\n      return manipulateApply(anyInSystem, simulatedEvent.event.transform, simulatedEvent.event.swap);\n    };\n\n    var imagePanel = renderImagePanel(detail.currentState.url);\n    var sideBar = renderSideBar(providersBackstage);\n    var editPanel = renderEditPanel(imagePanel, providersBackstage);\n\n    var swap = function (anyInSystem, simulatedEvent) {\n      disableUndoRedo(anyInSystem);\n      var transform = simulatedEvent.event.transform;\n      var swap = simulatedEvent.event.swap;\n      transform.fold(function () {\n        swap();\n      }, function (transform) {\n        manipulate(anyInSystem, transform, swap);\n      });\n    };\n\n    return {\n      dom: {\n        tag: 'div',\n        attributes: {\n          role: 'presentation'\n        }\n      },\n      components: [editPanel.memContainer.asSpec(), imagePanel.memContainer.asSpec(), sideBar.container],\n      behaviours: derive$1([Representing.config({\n        store: {\n          mode: 'manual',\n          getValue: function () {\n            return state.getBlobState();\n          }\n        }\n      }), config('image-tools-events', [run(internal.undo(), undo), run(internal.redo(), redo), run(internal.zoom(), zoom), run(internal.back(), back), run(internal.apply(), apply), run(internal.transform(), transform), run(internal.tempTransform(), tempTransform), run(internal.transformApply(), transformApply), run(internal.swap(), swap)]), ComposingConfigs.self()])\n    };\n  };\n\n  var renderLabel$2 = function (spec, backstageShared) {\n    var label = {\n      dom: {\n        tag: 'label',\n        innerHtml: backstageShared.providers.translate(spec.label),\n        classes: ['tox-label']\n      }\n    };\n    var comps = map(spec.items, backstageShared.interpreter);\n    return {\n      dom: {\n        tag: 'div',\n        classes: ['tox-form__group']\n      },\n      components: [label].concat(comps),\n      behaviours: derive$1([ComposingConfigs.self(), Replacing.config({}), RepresentingConfigs.domHtml(Optional.none()), Keying.config({\n        mode: 'acyclic'\n      })])\n    };\n  };\n\n  var isSingleListItem = function (item) {\n    return !has(item, 'items');\n  };\n\n  var dataAttribute = 'data-value';\n\n  var fetchItems = function (dropdownComp, name, items, selectedValue) {\n    return map(items, function (item) {\n      if (!isSingleListItem(item)) {\n        return {\n          type: 'nestedmenuitem',\n          text: item.text,\n          getSubmenuItems: function () {\n            return fetchItems(dropdownComp, name, item.items, selectedValue);\n          }\n        };\n      } else {\n        return {\n          type: 'togglemenuitem',\n          text: item.text,\n          value: item.value,\n          active: item.value === selectedValue,\n          onAction: function () {\n            Representing.setValue(dropdownComp, item.value);\n            emitWith(dropdownComp, formChangeEvent, {\n              name: name\n            });\n            Focusing.focus(dropdownComp);\n          }\n        };\n      }\n    });\n  };\n\n  var findItemByValue = function (items, value) {\n    return findMap(items, function (item) {\n      if (!isSingleListItem(item)) {\n        return findItemByValue(item.items, value);\n      } else {\n        return someIf(item.value === value, item);\n      }\n    });\n  };\n\n  var renderListBox = function (spec, backstage) {\n    var providersBackstage = backstage.shared.providers;\n    var initialItem = head(spec.items).filter(isSingleListItem);\n    var pLabel = spec.label.map(function (label) {\n      return renderLabel(label, providersBackstage);\n    });\n    var pField = FormField.parts.field({\n      dom: {},\n      factory: {\n        sketch: function (sketchSpec) {\n          return renderCommonDropdown({\n            uid: sketchSpec.uid,\n            text: initialItem.map(function (item) {\n              return item.text;\n            }),\n            icon: Optional.none(),\n            tooltip: spec.label,\n            role: Optional.none(),\n            fetch: function (comp, callback) {\n              var items = fetchItems(comp, spec.name, spec.items, Representing.getValue(comp));\n              callback(build$2(items, ItemResponse$1.CLOSE_ON_EXECUTE, backstage, false));\n            },\n            onSetup: constant(noop),\n            getApi: constant({}),\n            columns: 1,\n            presets: 'normal',\n            classes: [],\n            dropdownBehaviours: [Tabstopping.config({}), Representing.config({\n              store: {\n                mode: 'manual',\n                initialValue: initialItem.map(function (item) {\n                  return item.value;\n                }).getOr(''),\n                getValue: function (comp) {\n                  return get$3(comp.element, dataAttribute);\n                },\n                setValue: function (comp, data) {\n                  findItemByValue(spec.items, data).each(function (item) {\n                    set$1(comp.element, dataAttribute, item.value);\n                    emitWith(comp, updateMenuText, {\n                      text: item.text\n                    });\n                  });\n                }\n              }\n            })]\n          }, 'tox-listbox', backstage.shared);\n        }\n      }\n    });\n    var listBoxWrap = {\n      dom: {\n        tag: 'div',\n        classes: ['tox-listboxfield']\n      },\n      components: [pField]\n    };\n    return FormField.sketch({\n      dom: {\n        tag: 'div',\n        classes: ['tox-form__group']\n      },\n      components: flatten([pLabel.toArray(), [listBoxWrap]]),\n      fieldBehaviours: derive$1([Disabling.config({\n        disabled: constant(spec.disabled),\n        onDisabled: function (comp) {\n          FormField.getField(comp).each(Disabling.disable);\n        },\n        onEnabled: function (comp) {\n          FormField.getField(comp).each(Disabling.enable);\n        }\n      })])\n    });\n  };\n\n  var renderPanel = function (spec, backstage) {\n    return {\n      dom: {\n        tag: 'div',\n        classes: spec.classes\n      },\n      components: map(spec.items, backstage.shared.interpreter)\n    };\n  };\n\n  var factory$8 = function (detail, _spec) {\n    var options = map(detail.options, function (option) {\n      return {\n        dom: {\n          tag: 'option',\n          value: option.value,\n          innerHtml: option.text\n        }\n      };\n    });\n    var initialValues = detail.data.map(function (v) {\n      return wrap$1('initialValue', v);\n    }).getOr({});\n    return {\n      uid: detail.uid,\n      dom: {\n        tag: 'select',\n        classes: detail.selectClasses,\n        attributes: detail.selectAttributes\n      },\n      components: options,\n      behaviours: augment(detail.selectBehaviours, [Focusing.config({}), Representing.config({\n        store: __assign({\n          mode: 'manual',\n          getValue: function (select) {\n            return get$6(select.element);\n          },\n          setValue: function (select, newValue) {\n            var found = find(detail.options, function (opt) {\n              return opt.value === newValue;\n            });\n\n            if (found.isSome()) {\n              set$3(select.element, newValue);\n            }\n          }\n        }, initialValues)\n      })])\n    };\n  };\n\n  var HtmlSelect = single$2({\n    name: 'HtmlSelect',\n    configFields: [strict$1('options'), field$1('selectBehaviours', [Focusing, Representing]), defaulted$1('selectClasses', []), defaulted$1('selectAttributes', {}), option('data')],\n    factory: factory$8\n  });\n\n  var renderSelectBox = function (spec, providersBackstage) {\n    var translatedOptions = map(spec.items, function (item) {\n      return {\n        text: providersBackstage.translate(item.text),\n        value: item.value\n      };\n    });\n    var pLabel = spec.label.map(function (label) {\n      return renderLabel(label, providersBackstage);\n    });\n    var pField = FormField.parts.field({\n      dom: {},\n      selectAttributes: {\n        size: spec.size\n      },\n      options: translatedOptions,\n      factory: HtmlSelect,\n      selectBehaviours: derive$1([Disabling.config({\n        disabled: function () {\n          return spec.disabled || providersBackstage.isDisabled();\n        }\n      }), Tabstopping.config({}), config('selectbox-change', [run(change(), function (component, _) {\n        emitWith(component, formChangeEvent, {\n          name: spec.name\n        });\n      })])])\n    });\n    var chevron = spec.size > 1 ? Optional.none() : Optional.some({\n      dom: {\n        tag: 'div',\n        classes: ['tox-selectfield__icon-js'],\n        innerHtml: get$e('chevron-down', providersBackstage.icons)\n      }\n    });\n    var selectWrap = {\n      dom: {\n        tag: 'div',\n        classes: ['tox-selectfield']\n      },\n      components: flatten([[pField], chevron.toArray()])\n    };\n    return FormField.sketch({\n      dom: {\n        tag: 'div',\n        classes: ['tox-form__group']\n      },\n      components: flatten([pLabel.toArray(), [selectWrap]]),\n      fieldBehaviours: derive$1([Disabling.config({\n        disabled: function () {\n          return spec.disabled || providersBackstage.isDisabled();\n        },\n        onDisabled: function (comp) {\n          FormField.getField(comp).each(Disabling.disable);\n        },\n        onEnabled: function (comp) {\n          FormField.getField(comp).each(Disabling.enable);\n        }\n      }), receivingConfig()])\n    });\n  };\n\n  var renderTable = function (spec, providersBackstage) {\n    var renderTh = function (text) {\n      return {\n        dom: {\n          tag: 'th',\n          innerHtml: providersBackstage.translate(text)\n        }\n      };\n    };\n\n    var renderHeader = function (header) {\n      return {\n        dom: {\n          tag: 'thead'\n        },\n        components: [{\n          dom: {\n            tag: 'tr'\n          },\n          components: map(header, renderTh)\n        }]\n      };\n    };\n\n    var renderTd = function (text) {\n      return {\n        dom: {\n          tag: 'td',\n          innerHtml: providersBackstage.translate(text)\n        }\n      };\n    };\n\n    var renderTr = function (row) {\n      return {\n        dom: {\n          tag: 'tr'\n        },\n        components: map(row, renderTd)\n      };\n    };\n\n    var renderRows = function (rows) {\n      return {\n        dom: {\n          tag: 'tbody'\n        },\n        components: map(rows, renderTr)\n      };\n    };\n\n    return {\n      dom: {\n        tag: 'table',\n        classes: ['tox-dialog__table']\n      },\n      components: [renderHeader(spec.header), renderRows(spec.cells)],\n      behaviours: derive$1([Tabstopping.config({}), Focusing.config({})])\n    };\n  };\n\n  var renderTextField = function (spec, providersBackstage) {\n    var pLabel = spec.label.map(function (label) {\n      return renderLabel(label, providersBackstage);\n    });\n    var baseInputBehaviours = [Disabling.config({\n      disabled: function () {\n        return spec.disabled || providersBackstage.isDisabled();\n      }\n    }), receivingConfig(), Keying.config({\n      mode: 'execution',\n      useEnter: spec.multiline !== true,\n      useControlEnter: spec.multiline === true,\n      execute: function (comp) {\n        emit(comp, formSubmitEvent);\n        return Optional.some(true);\n      }\n    }), config('textfield-change', [run(input(), function (component, _) {\n      emitWith(component, formChangeEvent, {\n        name: spec.name\n      });\n    }), run(postPaste(), function (component, _) {\n      emitWith(component, formChangeEvent, {\n        name: spec.name\n      });\n    })]), Tabstopping.config({})];\n    var validatingBehaviours = spec.validation.map(function (vl) {\n      return Invalidating.config({\n        getRoot: function (input) {\n          return parent(input.element);\n        },\n        invalidClass: 'tox-invalid',\n        validator: {\n          validate: function (input) {\n            var v = Representing.getValue(input);\n            var result = vl.validator(v);\n            return Future.pure(result === true ? Result.value(v) : Result.error(result));\n          },\n          validateOnLoad: vl.validateOnLoad\n        }\n      });\n    }).toArray();\n    var placeholder = spec.placeholder.fold(constant({}), function (p) {\n      return {\n        placeholder: providersBackstage.translate(p)\n      };\n    });\n    var inputMode = spec.inputMode.fold(constant({}), function (mode) {\n      return {\n        inputmode: mode\n      };\n    });\n\n    var inputAttributes = __assign(__assign({}, placeholder), inputMode);\n\n    var pField = FormField.parts.field({\n      tag: spec.multiline === true ? 'textarea' : 'input',\n      inputAttributes: inputAttributes,\n      inputClasses: [spec.classname],\n      inputBehaviours: derive$1(flatten([baseInputBehaviours, validatingBehaviours])),\n      selectOnFocus: false,\n      factory: Input\n    });\n    var extraClasses = spec.flex ? ['tox-form__group--stretched'] : [];\n    var extraClasses2 = extraClasses.concat(spec.maximized ? ['tox-form-group--maximize'] : []);\n    var extraBehaviours = [Disabling.config({\n      disabled: function () {\n        return spec.disabled || providersBackstage.isDisabled();\n      },\n      onDisabled: function (comp) {\n        FormField.getField(comp).each(Disabling.disable);\n      },\n      onEnabled: function (comp) {\n        FormField.getField(comp).each(Disabling.enable);\n      }\n    }), receivingConfig()];\n    return renderFormFieldWith(pLabel, pField, extraClasses2, extraBehaviours);\n  };\n\n  var renderInput = function (spec, providersBackstage) {\n    return renderTextField({\n      name: spec.name,\n      multiline: false,\n      label: spec.label,\n      inputMode: spec.inputMode,\n      placeholder: spec.placeholder,\n      flex: false,\n      disabled: spec.disabled,\n      classname: 'tox-textfield',\n      validation: Optional.none(),\n      maximized: spec.maximized\n    }, providersBackstage);\n  };\n\n  var renderTextarea = function (spec, providersBackstage) {\n    return renderTextField({\n      name: spec.name,\n      multiline: true,\n      label: spec.label,\n      inputMode: Optional.none(),\n      placeholder: spec.placeholder,\n      flex: true,\n      disabled: spec.disabled,\n      classname: 'tox-textarea',\n      validation: Optional.none(),\n      maximized: spec.maximized\n    }, providersBackstage);\n  };\n\n  var events$c = function (streamConfig, streamState) {\n    var streams = streamConfig.stream.streams;\n    var processor = streams.setup(streamConfig, streamState);\n    return derive([run(streamConfig.event, processor), runOnDetached(function () {\n      return streamState.cancel();\n    })].concat(streamConfig.cancelEvent.map(function (e) {\n      return [run(e, function () {\n        return streamState.cancel();\n      })];\n    }).getOr([])));\n  };\n\n  var ActiveStreaming = /*#__PURE__*/Object.freeze({\n    __proto__: null,\n    events: events$c\n  });\n\n  var throttle = function (_config) {\n    var state = Cell(null);\n\n    var readState = function () {\n      return {\n        timer: state.get() !== null ? 'set' : 'unset'\n      };\n    };\n\n    var setTimer = function (t) {\n      state.set(t);\n    };\n\n    var cancel = function () {\n      var t = state.get();\n\n      if (t !== null) {\n        t.cancel();\n      }\n    };\n\n    return nu$5({\n      readState: readState,\n      setTimer: setTimer,\n      cancel: cancel\n    });\n  };\n\n  var init$6 = function (spec) {\n    return spec.stream.streams.state(spec);\n  };\n\n  var StreamingState = /*#__PURE__*/Object.freeze({\n    __proto__: null,\n    throttle: throttle,\n    init: init$6\n  });\n\n  var setup$2 = function (streamInfo, streamState) {\n    var sInfo = streamInfo.stream;\n    var throttler = last$2(streamInfo.onStream, sInfo.delay);\n    streamState.setTimer(throttler);\n    return function (component, simulatedEvent) {\n      throttler.throttle(component, simulatedEvent);\n\n      if (sInfo.stopEvent) {\n        simulatedEvent.stop();\n      }\n    };\n  };\n\n  var StreamingSchema = [strictOf('stream', choose$1('mode', {\n    throttle: [strict$1('delay'), defaulted$1('stopEvent', true), output('streams', {\n      setup: setup$2,\n      state: throttle\n    })]\n  })), defaulted$1('event', 'input'), option('cancelEvent'), onStrictHandler('onStream')];\n  var Streaming = create$1({\n    fields: StreamingSchema,\n    name: 'streaming',\n    active: ActiveStreaming,\n    state: StreamingState\n  });\n\n  var setValueFromItem = function (model, input, item) {\n    var itemData = Representing.getValue(item);\n    Representing.setValue(input, itemData);\n    setCursorAtEnd(input);\n  };\n\n  var setSelectionOn = function (input, f) {\n    var el = input.element;\n    var value = get$6(el);\n    var node = el.dom;\n\n    if (get$3(el, 'type') !== 'number') {\n      f(node, value);\n    }\n  };\n\n  var setCursorAtEnd = function (input) {\n    setSelectionOn(input, function (node, value) {\n      return node.setSelectionRange(value.length, value.length);\n    });\n  };\n\n  var setSelectionToEnd = function (input, startOffset) {\n    setSelectionOn(input, function (node, value) {\n      return node.setSelectionRange(startOffset, value.length);\n    });\n  };\n\n  var attemptSelectOver = function (model, input, item) {\n    if (!model.selectsOver) {\n      return Optional.none();\n    } else {\n      var currentValue = Representing.getValue(input);\n      var inputDisplay_1 = model.getDisplayText(currentValue);\n      var itemValue = Representing.getValue(item);\n      var itemDisplay = model.getDisplayText(itemValue);\n      return itemDisplay.indexOf(inputDisplay_1) === 0 ? Optional.some(function () {\n        setValueFromItem(model, input, item);\n        setSelectionToEnd(input, inputDisplay_1.length);\n      }) : Optional.none();\n    }\n  };\n\n  var itemExecute = constant('alloy.typeahead.itemexecute');\n\n  var make$5 = function (detail, components, spec, externals) {\n    var navigateList = function (comp, simulatedEvent, highlighter) {\n      detail.previewing.set(false);\n      var sandbox = Coupling.getCoupled(comp, 'sandbox');\n\n      if (Sandboxing.isOpen(sandbox)) {\n        Composing.getCurrent(sandbox).each(function (menu) {\n          Highlighting.getHighlighted(menu).fold(function () {\n            highlighter(menu);\n          }, function () {\n            dispatchEvent(sandbox, menu.element, 'keydown', simulatedEvent);\n          });\n        });\n      } else {\n        var onOpenSync = function (sandbox) {\n          Composing.getCurrent(sandbox).each(highlighter);\n        };\n\n        open$1(detail, mapFetch(comp), comp, sandbox, externals, onOpenSync, HighlightOnOpen.HighlightFirst).get(noop);\n      }\n    };\n\n    var focusBehaviours$1 = focusBehaviours(detail);\n\n    var mapFetch = function (comp) {\n      return function (tdata) {\n        return tdata.map(function (data) {\n          var menus = values(data.menus);\n          var items = bind(menus, function (menu) {\n            return filter(menu.items, function (item) {\n              return item.type === 'item';\n            });\n          });\n          var repState = Representing.getState(comp);\n          repState.update(map(items, function (item) {\n            return item.data;\n          }));\n          return data;\n        });\n      };\n    };\n\n    var behaviours = [Focusing.config({}), Representing.config({\n      onSetValue: detail.onSetValue,\n      store: __assign({\n        mode: 'dataset',\n        getDataKey: function (comp) {\n          return get$6(comp.element);\n        },\n        getFallbackEntry: function (itemString) {\n          return {\n            value: itemString,\n            meta: {}\n          };\n        },\n        setValue: function (comp, data) {\n          set$3(comp.element, detail.model.getDisplayText(data));\n        }\n      }, detail.initialData.map(function (d) {\n        return wrap$1('initialValue', d);\n      }).getOr({}))\n    }), Streaming.config({\n      stream: {\n        mode: 'throttle',\n        delay: detail.responseTime,\n        stopEvent: false\n      },\n      onStream: function (component, _simulatedEvent) {\n        var sandbox = Coupling.getCoupled(component, 'sandbox');\n        var focusInInput = Focusing.isFocused(component);\n\n        if (focusInInput) {\n          if (get$6(component.element).length >= detail.minChars) {\n            var previousValue_1 = Composing.getCurrent(sandbox).bind(function (menu) {\n              return Highlighting.getHighlighted(menu).map(Representing.getValue);\n            });\n            detail.previewing.set(true);\n\n            var onOpenSync = function (_sandbox) {\n              Composing.getCurrent(sandbox).each(function (menu) {\n                previousValue_1.fold(function () {\n                  if (detail.model.selectsOver) {\n                    Highlighting.highlightFirst(menu);\n                  }\n                }, function (pv) {\n                  Highlighting.highlightBy(menu, function (item) {\n                    var itemData = Representing.getValue(item);\n                    return itemData.value === pv.value;\n                  });\n                  Highlighting.getHighlighted(menu).orThunk(function () {\n                    Highlighting.highlightFirst(menu);\n                    return Optional.none();\n                  });\n                });\n              });\n            };\n\n            open$1(detail, mapFetch(component), component, sandbox, externals, onOpenSync, HighlightOnOpen.HighlightFirst).get(noop);\n          }\n        }\n      },\n      cancelEvent: typeaheadCancel()\n    }), Keying.config({\n      mode: 'special',\n      onDown: function (comp, simulatedEvent) {\n        navigateList(comp, simulatedEvent, Highlighting.highlightFirst);\n        return Optional.some(true);\n      },\n      onEscape: function (comp) {\n        var sandbox = Coupling.getCoupled(comp, 'sandbox');\n\n        if (Sandboxing.isOpen(sandbox)) {\n          Sandboxing.close(sandbox);\n          return Optional.some(true);\n        }\n\n        return Optional.none();\n      },\n      onUp: function (comp, simulatedEvent) {\n        navigateList(comp, simulatedEvent, Highlighting.highlightLast);\n        return Optional.some(true);\n      },\n      onEnter: function (comp) {\n        var sandbox = Coupling.getCoupled(comp, 'sandbox');\n        var sandboxIsOpen = Sandboxing.isOpen(sandbox);\n\n        if (sandboxIsOpen && !detail.previewing.get()) {\n          return Composing.getCurrent(sandbox).bind(function (menu) {\n            return Highlighting.getHighlighted(menu);\n          }).map(function (item) {\n            emitWith(comp, itemExecute(), {\n              item: item\n            });\n            return true;\n          });\n        } else {\n          var currentValue = Representing.getValue(comp);\n          emit(comp, typeaheadCancel());\n          detail.onExecute(sandbox, comp, currentValue);\n\n          if (sandboxIsOpen) {\n            Sandboxing.close(sandbox);\n          }\n\n          return Optional.some(true);\n        }\n      }\n    }), Toggling.config({\n      toggleClass: detail.markers.openClass,\n      aria: {\n        mode: 'expanded'\n      }\n    }), Coupling.config({\n      others: {\n        sandbox: function (hotspot) {\n          return makeSandbox(detail, hotspot, {\n            onOpen: function () {\n              return Toggling.on(hotspot);\n            },\n            onClose: function () {\n              return Toggling.off(hotspot);\n            }\n          });\n        }\n      }\n    }), config('typeaheadevents', [runOnExecute(function (comp) {\n      var onOpenSync = noop;\n      togglePopup(detail, mapFetch(comp), comp, externals, onOpenSync, HighlightOnOpen.HighlightFirst).get(noop);\n    }), run(itemExecute(), function (comp, se) {\n      var sandbox = Coupling.getCoupled(comp, 'sandbox');\n      setValueFromItem(detail.model, comp, se.event.item);\n      emit(comp, typeaheadCancel());\n      detail.onItemExecute(comp, sandbox, se.event.item, Representing.getValue(comp));\n      Sandboxing.close(sandbox);\n      setCursorAtEnd(comp);\n    })].concat(detail.dismissOnBlur ? [run(postBlur(), function (typeahead) {\n      var sandbox = Coupling.getCoupled(typeahead, 'sandbox');\n\n      if (search(sandbox.element).isNone()) {\n        Sandboxing.close(sandbox);\n      }\n    })] : []))];\n    return {\n      uid: detail.uid,\n      dom: dom$2(deepMerge(detail, {\n        inputAttributes: {\n          'role': 'combobox',\n          'aria-autocomplete': 'list',\n          'aria-haspopup': 'true'\n        }\n      })),\n      behaviours: __assign(__assign({}, focusBehaviours$1), augment(detail.typeaheadBehaviours, behaviours)),\n      eventOrder: detail.eventOrder\n    };\n  };\n\n  var schema$j = constant([option('lazySink'), strict$1('fetch'), defaulted$1('minChars', 5), defaulted$1('responseTime', 1000), onHandler('onOpen'), defaulted$1('getHotspot', Optional.some), defaulted$1('getAnchorOverrides', constant({})), defaulted$1('layouts', Optional.none()), defaulted$1('eventOrder', {}), defaultedObjOf('model', {}, [defaulted$1('getDisplayText', function (itemData) {\n    return itemData.meta !== undefined && itemData.meta.text !== undefined ? itemData.meta.text : itemData.value;\n  }), defaulted$1('selectsOver', true), defaulted$1('populateFromBrowse', true)]), onHandler('onSetValue'), onKeyboardHandler('onExecute'), onHandler('onItemExecute'), defaulted$1('inputClasses', []), defaulted$1('inputAttributes', {}), defaulted$1('inputStyles', {}), defaulted$1('matchWidth', true), defaulted$1('useMinWidth', false), defaulted$1('dismissOnBlur', true), markers(['openClass']), option('initialData'), field$1('typeaheadBehaviours', [Focusing, Representing, Streaming, Keying, Toggling, Coupling]), state$1('previewing', function () {\n    return Cell(true);\n  })].concat(schema$f()).concat(sandboxFields()));\n  var parts$6 = constant([external$1({\n    schema: [tieredMenuMarkers()],\n    name: 'menu',\n    overrides: function (detail) {\n      return {\n        fakeFocus: true,\n        onHighlight: function (menu, item) {\n          if (!detail.previewing.get()) {\n            menu.getSystem().getByUid(detail.uid).each(function (input) {\n              if (detail.model.populateFromBrowse) {\n                setValueFromItem(detail.model, input, item);\n              }\n            });\n          } else {\n            menu.getSystem().getByUid(detail.uid).each(function (input) {\n              attemptSelectOver(detail.model, input, item).fold(function () {\n                return Highlighting.dehighlight(menu, item);\n              }, function (fn) {\n                return fn();\n              });\n            });\n          }\n\n          detail.previewing.set(false);\n        },\n        onExecute: function (menu, item) {\n          return menu.getSystem().getByUid(detail.uid).toOptional().map(function (typeahead) {\n            emitWith(typeahead, itemExecute(), {\n              item: item\n            });\n            return true;\n          });\n        },\n        onHover: function (menu, item) {\n          detail.previewing.set(false);\n          menu.getSystem().getByUid(detail.uid).each(function (input) {\n            if (detail.model.populateFromBrowse) {\n              setValueFromItem(detail.model, input, item);\n            }\n          });\n        }\n      };\n    }\n  })]);\n  var Typeahead = composite$1({\n    name: 'Typeahead',\n    configFields: schema$j(),\n    partFields: parts$6(),\n    factory: make$5\n  });\n\n  var wrap$2 = function (delegate) {\n    var toCached = function () {\n      return wrap$2(delegate.toCached());\n    };\n\n    var bindFuture = function (f) {\n      return wrap$2(delegate.bind(function (resA) {\n        return resA.fold(function (err) {\n          return Future.pure(Result.error(err));\n        }, function (a) {\n          return f(a);\n        });\n      }));\n    };\n\n    var bindResult = function (f) {\n      return wrap$2(delegate.map(function (resA) {\n        return resA.bind(f);\n      }));\n    };\n\n    var mapResult = function (f) {\n      return wrap$2(delegate.map(function (resA) {\n        return resA.map(f);\n      }));\n    };\n\n    var mapError = function (f) {\n      return wrap$2(delegate.map(function (resA) {\n        return resA.mapError(f);\n      }));\n    };\n\n    var foldResult = function (whenError, whenValue) {\n      return delegate.map(function (res) {\n        return res.fold(whenError, whenValue);\n      });\n    };\n\n    var withTimeout = function (timeout, errorThunk) {\n      return wrap$2(Future.nu(function (callback) {\n        var timedOut = false;\n        var timer = setTimeout(function () {\n          timedOut = true;\n          callback(Result.error(errorThunk()));\n        }, timeout);\n        delegate.get(function (result) {\n          if (!timedOut) {\n            clearTimeout(timer);\n            callback(result);\n          }\n        });\n      }));\n    };\n\n    return __assign(__assign({}, delegate), {\n      toCached: toCached,\n      bindFuture: bindFuture,\n      bindResult: bindResult,\n      mapResult: mapResult,\n      mapError: mapError,\n      foldResult: foldResult,\n      withTimeout: withTimeout\n    });\n  };\n\n  var nu$c = function (worker) {\n    return wrap$2(Future.nu(worker));\n  };\n\n  var value$2 = function (value) {\n    return wrap$2(Future.pure(Result.value(value)));\n  };\n\n  var error$1 = function (error) {\n    return wrap$2(Future.pure(Result.error(error)));\n  };\n\n  var fromResult$1 = function (result) {\n    return wrap$2(Future.pure(result));\n  };\n\n  var fromFuture = function (future) {\n    return wrap$2(future.map(Result.value));\n  };\n\n  var fromPromise = function (promise) {\n    return nu$c(function (completer) {\n      promise.then(function (value) {\n        completer(Result.value(value));\n      }, function (error) {\n        completer(Result.error(error));\n      });\n    });\n  };\n\n  var FutureResult = {\n    nu: nu$c,\n    wrap: wrap$2,\n    pure: value$2,\n    value: value$2,\n    error: error$1,\n    fromResult: fromResult$1,\n    fromFuture: fromFuture,\n    fromPromise: fromPromise\n  };\n  var separator$2 = {\n    type: 'separator'\n  };\n\n  var toMenuItem = function (target) {\n    return {\n      type: 'menuitem',\n      value: target.url,\n      text: target.title,\n      meta: {\n        attach: target.attach\n      },\n      onAction: noop\n    };\n  };\n\n  var staticMenuItem = function (title, url) {\n    return {\n      type: 'menuitem',\n      value: url,\n      text: title,\n      meta: {\n        attach: undefined\n      },\n      onAction: noop\n    };\n  };\n\n  var toMenuItems = function (targets) {\n    return map(targets, toMenuItem);\n  };\n\n  var filterLinkTargets = function (type, targets) {\n    return filter(targets, function (target) {\n      return target.type === type;\n    });\n  };\n\n  var filteredTargets = function (type, targets) {\n    return toMenuItems(filterLinkTargets(type, targets));\n  };\n\n  var headerTargets = function (linkInfo) {\n    return filteredTargets('header', linkInfo.targets);\n  };\n\n  var anchorTargets = function (linkInfo) {\n    return filteredTargets('anchor', linkInfo.targets);\n  };\n\n  var anchorTargetTop = function (linkInfo) {\n    return Optional.from(linkInfo.anchorTop).map(function (url) {\n      return staticMenuItem('<top>', url);\n    }).toArray();\n  };\n\n  var anchorTargetBottom = function (linkInfo) {\n    return Optional.from(linkInfo.anchorBottom).map(function (url) {\n      return staticMenuItem('<bottom>', url);\n    }).toArray();\n  };\n\n  var historyTargets = function (history) {\n    return map(history, function (url) {\n      return staticMenuItem(url, url);\n    });\n  };\n\n  var joinMenuLists = function (items) {\n    return foldl(items, function (a, b) {\n      var bothEmpty = a.length === 0 || b.length === 0;\n      return bothEmpty ? a.concat(b) : a.concat(separator$2, b);\n    }, []);\n  };\n\n  var filterByQuery = function (term, menuItems) {\n    var lowerCaseTerm = term.toLowerCase();\n    return filter(menuItems, function (item) {\n      var text = item.meta !== undefined && item.meta.text !== undefined ? item.meta.text : item.text;\n      return contains$1(text.toLowerCase(), lowerCaseTerm) || contains$1(item.value.toLowerCase(), lowerCaseTerm);\n    });\n  };\n\n  var getItems = function (fileType, input, urlBackstage) {\n    var urlInputValue = Representing.getValue(input);\n    var term = urlInputValue.meta.text !== undefined ? urlInputValue.meta.text : urlInputValue.value;\n    var info = urlBackstage.getLinkInformation();\n    return info.fold(function () {\n      return [];\n    }, function (linkInfo) {\n      var history = filterByQuery(term, historyTargets(urlBackstage.getHistory(fileType)));\n      return fileType === 'file' ? joinMenuLists([history, filterByQuery(term, headerTargets(linkInfo)), filterByQuery(term, flatten([anchorTargetTop(linkInfo), anchorTargets(linkInfo), anchorTargetBottom(linkInfo)]))]) : history;\n    });\n  };\n\n  var errorId = generate$1('aria-invalid');\n\n  var renderUrlInput = function (spec, backstage, urlBackstage) {\n    var _a;\n\n    var providersBackstage = backstage.shared.providers;\n\n    var updateHistory = function (component) {\n      var urlEntry = Representing.getValue(component);\n      urlBackstage.addToHistory(urlEntry.value, spec.filetype);\n    };\n\n    var pField = FormField.parts.field({\n      factory: Typeahead,\n      dismissOnBlur: true,\n      inputClasses: ['tox-textfield'],\n      sandboxClasses: ['tox-dialog__popups'],\n      inputAttributes: {\n        'aria-errormessage': errorId,\n        'type': 'url'\n      },\n      minChars: 0,\n      responseTime: 0,\n      fetch: function (input) {\n        var items = getItems(spec.filetype, input, urlBackstage);\n        var tdata = build$2(items, ItemResponse$1.BUBBLE_TO_SANDBOX, backstage, false);\n        return Future.pure(tdata);\n      },\n      getHotspot: function (comp) {\n        return memUrlBox.getOpt(comp);\n      },\n      onSetValue: function (comp, _newValue) {\n        if (comp.hasConfigured(Invalidating)) {\n          Invalidating.run(comp).get(noop);\n        }\n      },\n      typeaheadBehaviours: derive$1(flatten([urlBackstage.getValidationHandler().map(function (handler) {\n        return Invalidating.config({\n          getRoot: function (comp) {\n            return parent(comp.element);\n          },\n          invalidClass: 'tox-control-wrap--status-invalid',\n          notify: {\n            onInvalid: function (comp, err) {\n              memInvalidIcon.getOpt(comp).each(function (invalidComp) {\n                set$1(invalidComp.element, 'title', providersBackstage.translate(err));\n              });\n            }\n          },\n          validator: {\n            validate: function (input) {\n              var urlEntry = Representing.getValue(input);\n              return FutureResult.nu(function (completer) {\n                handler({\n                  type: spec.filetype,\n                  url: urlEntry.value\n                }, function (validation) {\n                  if (validation.status === 'invalid') {\n                    var err = Result.error(validation.message);\n                    completer(err);\n                  } else {\n                    var val = Result.value(validation.message);\n                    completer(val);\n                  }\n                });\n              });\n            },\n            validateOnLoad: false\n          }\n        });\n      }).toArray(), [Disabling.config({\n        disabled: function () {\n          return spec.disabled || providersBackstage.isDisabled();\n        }\n      }), Tabstopping.config({}), config('urlinput-events', flatten([spec.filetype === 'file' ? [run(input(), function (comp) {\n        emitWith(comp, formChangeEvent, {\n          name: spec.name\n        });\n      })] : [], [run(change(), function (comp) {\n        emitWith(comp, formChangeEvent, {\n          name: spec.name\n        });\n        updateHistory(comp);\n      }), run(postPaste(), function (comp) {\n        emitWith(comp, formChangeEvent, {\n          name: spec.name\n        });\n        updateHistory(comp);\n      })]]))]])),\n      eventOrder: (_a = {}, _a[input()] = ['streaming', 'urlinput-events', 'invalidating'], _a),\n      model: {\n        getDisplayText: function (itemData) {\n          return itemData.value;\n        },\n        selectsOver: false,\n        populateFromBrowse: false\n      },\n      markers: {\n        openClass: 'tox-textfield--popup-open'\n      },\n      lazySink: backstage.shared.getSink,\n      parts: {\n        menu: part(false, 1, 'normal')\n      },\n      onExecute: function (_menu, component, _entry) {\n        emitWith(component, formSubmitEvent, {});\n      },\n      onItemExecute: function (typeahead, _sandbox, _item, _value) {\n        updateHistory(typeahead);\n        emitWith(typeahead, formChangeEvent, {\n          name: spec.name\n        });\n      }\n    });\n    var pLabel = spec.label.map(function (label) {\n      return renderLabel(label, providersBackstage);\n    });\n\n    var makeIcon = function (name, errId, icon, label) {\n      if (icon === void 0) {\n        icon = name;\n      }\n\n      if (label === void 0) {\n        label = name;\n      }\n\n      return {\n        dom: {\n          tag: 'div',\n          classes: ['tox-icon', 'tox-control-wrap__status-icon-' + name],\n          innerHtml: get$e(icon, providersBackstage.icons),\n          attributes: __assign({\n            'title': providersBackstage.translate(label),\n            'aria-live': 'polite'\n          }, errId.fold(function () {\n            return {};\n          }, function (id) {\n            return {\n              id: id\n            };\n          }))\n        }\n      };\n    };\n\n    var memInvalidIcon = record(makeIcon('invalid', Optional.some(errorId), 'warning'));\n    var memStatus = record({\n      dom: {\n        tag: 'div',\n        classes: ['tox-control-wrap__status-icon-wrap']\n      },\n      components: [memInvalidIcon.asSpec()]\n    });\n    var optUrlPicker = urlBackstage.getUrlPicker(spec.filetype);\n    var browseUrlEvent = generate$1('browser.url.event');\n    var memUrlBox = record({\n      dom: {\n        tag: 'div',\n        classes: ['tox-control-wrap']\n      },\n      components: [pField, memStatus.asSpec()],\n      behaviours: derive$1([Disabling.config({\n        disabled: function () {\n          return spec.disabled || providersBackstage.isDisabled();\n        }\n      })])\n    });\n    var memUrlPickerButton = record(renderButton({\n      name: spec.name,\n      icon: Optional.some('browse'),\n      text: spec.label.getOr(''),\n      disabled: spec.disabled,\n      primary: false,\n      borderless: true\n    }, function (component) {\n      return emit(component, browseUrlEvent);\n    }, providersBackstage, [], ['tox-browse-url']));\n\n    var controlHWrapper = function () {\n      return {\n        dom: {\n          tag: 'div',\n          classes: ['tox-form__controls-h-stack']\n        },\n        components: flatten([[memUrlBox.asSpec()], optUrlPicker.map(function () {\n          return memUrlPickerButton.asSpec();\n        }).toArray()])\n      };\n    };\n\n    var openUrlPicker = function (comp) {\n      Composing.getCurrent(comp).each(function (field) {\n        var componentData = Representing.getValue(field);\n\n        var urlData = __assign({\n          fieldname: spec.name\n        }, componentData);\n\n        optUrlPicker.each(function (picker) {\n          picker(urlData).get(function (chosenData) {\n            Representing.setValue(field, chosenData);\n            emitWith(comp, formChangeEvent, {\n              name: spec.name\n            });\n          });\n        });\n      });\n    };\n\n    return FormField.sketch({\n      dom: renderFormFieldDom(),\n      components: pLabel.toArray().concat([controlHWrapper()]),\n      fieldBehaviours: derive$1([Disabling.config({\n        disabled: function () {\n          return spec.disabled || providersBackstage.isDisabled();\n        },\n        onDisabled: function (comp) {\n          FormField.getField(comp).each(Disabling.disable);\n          memUrlPickerButton.getOpt(comp).each(Disabling.disable);\n        },\n        onEnabled: function (comp) {\n          FormField.getField(comp).each(Disabling.enable);\n          memUrlPickerButton.getOpt(comp).each(Disabling.enable);\n        }\n      }), receivingConfig(), config('url-input-events', [run(browseUrlEvent, openUrlPicker)])])\n    });\n  };\n\n  var renderAlertBanner = function (spec, providersBackstage) {\n    return Container.sketch({\n      dom: {\n        tag: 'div',\n        attributes: {\n          role: 'alert'\n        },\n        classes: ['tox-notification', 'tox-notification--in', 'tox-notification--' + spec.level]\n      },\n      components: [{\n        dom: {\n          tag: 'div',\n          classes: ['tox-notification__icon']\n        },\n        components: [Button.sketch({\n          dom: {\n            tag: 'button',\n            classes: ['tox-button', 'tox-button--naked', 'tox-button--icon'],\n            innerHtml: get$e(spec.icon, providersBackstage.icons),\n            attributes: {\n              title: providersBackstage.translate(spec.iconTooltip)\n            }\n          },\n          action: function (comp) {\n            emitWith(comp, formActionEvent, {\n              name: 'alert-banner',\n              value: spec.url\n            });\n          }\n        })]\n      }, {\n        dom: {\n          tag: 'div',\n          classes: ['tox-notification__body'],\n          innerHtml: providersBackstage.translate(spec.text)\n        }\n      }]\n    });\n  };\n\n  var renderCheckbox = function (spec, providerBackstage) {\n    var repBehaviour = Representing.config({\n      store: {\n        mode: 'manual',\n        getValue: function (comp) {\n          var el = comp.element.dom;\n          return el.checked;\n        },\n        setValue: function (comp, value) {\n          var el = comp.element.dom;\n          el.checked = value;\n        }\n      }\n    });\n\n    var toggleCheckboxHandler = function (comp) {\n      comp.element.dom.click();\n      return Optional.some(true);\n    };\n\n    var pField = FormField.parts.field({\n      factory: {\n        sketch: identity\n      },\n      dom: {\n        tag: 'input',\n        classes: ['tox-checkbox__input'],\n        attributes: {\n          type: 'checkbox'\n        }\n      },\n      behaviours: derive$1([ComposingConfigs.self(), Disabling.config({\n        disabled: function () {\n          return spec.disabled || providerBackstage.isDisabled();\n        }\n      }), Tabstopping.config({}), Focusing.config({}), repBehaviour, Keying.config({\n        mode: 'special',\n        onEnter: toggleCheckboxHandler,\n        onSpace: toggleCheckboxHandler,\n        stopSpaceKeyup: true\n      }), config('checkbox-events', [run(change(), function (component, _) {\n        emitWith(component, formChangeEvent, {\n          name: spec.name\n        });\n      })])])\n    });\n    var pLabel = FormField.parts.label({\n      dom: {\n        tag: 'span',\n        classes: ['tox-checkbox__label'],\n        innerHtml: providerBackstage.translate(spec.label)\n      },\n      behaviours: derive$1([Unselecting.config({})])\n    });\n\n    var makeIcon = function (className) {\n      var iconName = className === 'checked' ? 'selected' : 'unselected';\n      return {\n        dom: {\n          tag: 'span',\n          classes: ['tox-icon', 'tox-checkbox-icon__' + className],\n          innerHtml: get$e(iconName, providerBackstage.icons)\n        }\n      };\n    };\n\n    var memIcons = record({\n      dom: {\n        tag: 'div',\n        classes: ['tox-checkbox__icons']\n      },\n      components: [makeIcon('checked'), makeIcon('unchecked')]\n    });\n    return FormField.sketch({\n      dom: {\n        tag: 'label',\n        classes: ['tox-checkbox']\n      },\n      components: [pField, memIcons.asSpec(), pLabel],\n      fieldBehaviours: derive$1([Disabling.config({\n        disabled: function () {\n          return spec.disabled || providerBackstage.isDisabled();\n        },\n        disableClass: 'tox-checkbox--disabled',\n        onDisabled: function (comp) {\n          FormField.getField(comp).each(Disabling.disable);\n        },\n        onEnabled: function (comp) {\n          FormField.getField(comp).each(Disabling.enable);\n        }\n      }), receivingConfig()])\n    });\n  };\n\n  var renderHtmlPanel = function (spec) {\n    if (spec.presets === 'presentation') {\n      return Container.sketch({\n        dom: {\n          tag: 'div',\n          classes: ['tox-form__group'],\n          innerHtml: spec.html\n        }\n      });\n    } else {\n      return Container.sketch({\n        dom: {\n          tag: 'div',\n          classes: ['tox-form__group'],\n          innerHtml: spec.html,\n          attributes: {\n            role: 'document'\n          }\n        },\n        containerBehaviours: derive$1([Tabstopping.config({}), Focusing.config({})])\n      });\n    }\n  };\n\n  var make$6 = function (render) {\n    return function (parts, spec, backstage) {\n      return get$1(spec, 'name').fold(function () {\n        return render(spec, backstage);\n      }, function (fieldName) {\n        return parts.field(fieldName, render(spec, backstage));\n      });\n    };\n  };\n\n  var makeIframe = function (render) {\n    return function (parts, spec, backstage) {\n      var iframeSpec = deepMerge(spec, {\n        source: 'dynamic'\n      });\n      return make$6(render)(parts, iframeSpec, backstage);\n    };\n  };\n\n  var factories = {\n    bar: make$6(function (spec, backstage) {\n      return renderBar(spec, backstage.shared);\n    }),\n    collection: make$6(function (spec, backstage) {\n      return renderCollection(spec, backstage.shared.providers);\n    }),\n    alertbanner: make$6(function (spec, backstage) {\n      return renderAlertBanner(spec, backstage.shared.providers);\n    }),\n    input: make$6(function (spec, backstage) {\n      return renderInput(spec, backstage.shared.providers);\n    }),\n    textarea: make$6(function (spec, backstage) {\n      return renderTextarea(spec, backstage.shared.providers);\n    }),\n    label: make$6(function (spec, backstage) {\n      return renderLabel$2(spec, backstage.shared);\n    }),\n    iframe: makeIframe(function (spec, backstage) {\n      return renderIFrame(spec, backstage.shared.providers);\n    }),\n    button: make$6(function (spec, backstage) {\n      return renderDialogButton(spec, backstage.shared.providers);\n    }),\n    checkbox: make$6(function (spec, backstage) {\n      return renderCheckbox(spec, backstage.shared.providers);\n    }),\n    colorinput: make$6(function (spec, backstage) {\n      return renderColorInput(spec, backstage.shared, backstage.colorinput);\n    }),\n    colorpicker: make$6(renderColorPicker),\n    dropzone: make$6(function (spec, backstage) {\n      return renderDropZone(spec, backstage.shared.providers);\n    }),\n    grid: make$6(function (spec, backstage) {\n      return renderGrid(spec, backstage.shared);\n    }),\n    listbox: make$6(function (spec, backstage) {\n      return renderListBox(spec, backstage);\n    }),\n    selectbox: make$6(function (spec, backstage) {\n      return renderSelectBox(spec, backstage.shared.providers);\n    }),\n    sizeinput: make$6(function (spec, backstage) {\n      return renderSizeInput(spec, backstage.shared.providers);\n    }),\n    urlinput: make$6(function (spec, backstage) {\n      return renderUrlInput(spec, backstage, backstage.urlinput);\n    }),\n    customeditor: make$6(renderCustomEditor),\n    htmlpanel: make$6(renderHtmlPanel),\n    imagetools: make$6(function (spec, backstage) {\n      return renderImageTools(spec, backstage.shared.providers);\n    }),\n    table: make$6(function (spec, backstage) {\n      return renderTable(spec, backstage.shared.providers);\n    }),\n    panel: make$6(function (spec, backstage) {\n      return renderPanel(spec, backstage);\n    })\n  };\n  var noFormParts = {\n    field: function (_name, spec) {\n      return spec;\n    }\n  };\n\n  var interpretInForm = function (parts, spec, oldBackstage) {\n    var newBackstage = deepMerge(oldBackstage, {\n      shared: {\n        interpreter: function (childSpec) {\n          return interpretParts(parts, childSpec, newBackstage);\n        }\n      }\n    });\n    return interpretParts(parts, spec, newBackstage);\n  };\n\n  var interpretParts = function (parts, spec, backstage) {\n    return get$1(factories, spec.type).fold(function () {\n      console.error('Unknown factory type \"' + spec.type + '\", defaulting to container: ', spec);\n      return spec;\n    }, function (factory) {\n      return factory(parts, spec, backstage);\n    });\n  };\n\n  var interpretWithoutForm = function (spec, backstage) {\n    var parts = noFormParts;\n    return interpretParts(parts, spec, backstage);\n  };\n\n  var bubbleAlignments = {\n    valignCentre: [],\n    alignCentre: [],\n    alignLeft: [],\n    alignRight: [],\n    right: [],\n    left: [],\n    bottom: [],\n    top: []\n  };\n\n  var getInlineDialogAnchor = function (contentAreaElement, lazyAnchorbar, lazyUseEditableAreaAnchor) {\n    var bubble = nu$8(-12, 12, bubbleAlignments);\n    var overrides = {\n      maxHeightFunction: expandable()\n    };\n\n    var editableAreaAnchor = function () {\n      return {\n        anchor: 'node',\n        root: getContentContainer(contentAreaElement()),\n        node: Optional.from(contentAreaElement()),\n        bubble: bubble,\n        layouts: {\n          onRtl: function () {\n            return [northwest$3];\n          },\n          onLtr: function () {\n            return [northeast$3];\n          }\n        },\n        overrides: overrides\n      };\n    };\n\n    var standardAnchor = function () {\n      return {\n        anchor: 'hotspot',\n        hotspot: lazyAnchorbar(),\n        bubble: bubble,\n        layouts: {\n          onRtl: function () {\n            return [southeast$1];\n          },\n          onLtr: function () {\n            return [southwest$1];\n          }\n        },\n        overrides: overrides\n      };\n    };\n\n    return function () {\n      return lazyUseEditableAreaAnchor() ? editableAreaAnchor() : standardAnchor();\n    };\n  };\n\n  var getBannerAnchor = function (contentAreaElement, lazyAnchorbar, lazyUseEditableAreaAnchor) {\n    var editableAreaAnchor = function () {\n      return {\n        anchor: 'node',\n        root: getContentContainer(contentAreaElement()),\n        node: Optional.from(contentAreaElement()),\n        layouts: {\n          onRtl: function () {\n            return [north$3];\n          },\n          onLtr: function () {\n            return [north$3];\n          }\n        }\n      };\n    };\n\n    var standardAnchor = function () {\n      return {\n        anchor: 'hotspot',\n        hotspot: lazyAnchorbar(),\n        layouts: {\n          onRtl: function () {\n            return [south$1];\n          },\n          onLtr: function () {\n            return [south$1];\n          }\n        }\n      };\n    };\n\n    return function () {\n      return lazyUseEditableAreaAnchor() ? editableAreaAnchor() : standardAnchor();\n    };\n  };\n\n  var getCursorAnchor = function (editor, bodyElement) {\n    return function () {\n      return {\n        anchor: 'selection',\n        root: bodyElement(),\n        getSelection: function () {\n          var rng = editor.selection.getRng();\n          return Optional.some(SimSelection.range(SugarElement.fromDom(rng.startContainer), rng.startOffset, SugarElement.fromDom(rng.endContainer), rng.endOffset));\n        }\n      };\n    };\n  };\n\n  var getNodeAnchor = function (bodyElement) {\n    return function (element) {\n      return {\n        anchor: 'node',\n        root: bodyElement(),\n        node: element\n      };\n    };\n  };\n\n  var getAnchors = function (editor, lazyAnchorbar, isToolbarTop) {\n    var useFixedToolbarContainer = useFixedContainer(editor);\n\n    var bodyElement = function () {\n      return SugarElement.fromDom(editor.getBody());\n    };\n\n    var contentAreaElement = function () {\n      return SugarElement.fromDom(editor.getContentAreaContainer());\n    };\n\n    var lazyUseEditableAreaAnchor = function () {\n      return useFixedToolbarContainer || !isToolbarTop();\n    };\n\n    return {\n      inlineDialog: getInlineDialogAnchor(contentAreaElement, lazyAnchorbar, lazyUseEditableAreaAnchor),\n      banner: getBannerAnchor(contentAreaElement, lazyAnchorbar, lazyUseEditableAreaAnchor),\n      cursor: getCursorAnchor(editor, bodyElement),\n      node: getNodeAnchor(bodyElement)\n    };\n  };\n\n  var colorPicker = function (editor) {\n    return function (callback, value) {\n      var dialog = colorPickerDialog(editor);\n      dialog(callback, value);\n    };\n  };\n\n  var hasCustomColors$1 = function (editor) {\n    return function () {\n      return hasCustomColors(editor);\n    };\n  };\n\n  var getColors$2 = function (editor) {\n    return function () {\n      return getColors(editor);\n    };\n  };\n\n  var getColorCols$2 = function (editor) {\n    return function () {\n      return getColorCols$1(editor);\n    };\n  };\n\n  var ColorInputBackstage = function (editor) {\n    return {\n      colorPicker: colorPicker(editor),\n      hasCustomColors: hasCustomColors$1(editor),\n      getColors: getColors$2(editor),\n      getColorCols: getColorCols$2(editor)\n    };\n  };\n\n  var isDraggableModal$1 = function (editor) {\n    return function () {\n      return isDraggableModal(editor);\n    };\n  };\n\n  var DialogBackstage = function (editor) {\n    return {\n      isDraggableModal: isDraggableModal$1(editor)\n    };\n  };\n\n  var HeaderBackstage = function (editor) {\n    var mode = Cell(isToolbarLocationBottom(editor) ? 'bottom' : 'top');\n    return {\n      isPositionedAtTop: function () {\n        return mode.get() === 'top';\n      },\n      getDockingMode: mode.get,\n      setDockingMode: mode.set\n    };\n  };\n\n  var defaultStyleFormats = [{\n    title: 'Headings',\n    items: [{\n      title: 'Heading 1',\n      format: 'h1'\n    }, {\n      title: 'Heading 2',\n      format: 'h2'\n    }, {\n      title: 'Heading 3',\n      format: 'h3'\n    }, {\n      title: 'Heading 4',\n      format: 'h4'\n    }, {\n      title: 'Heading 5',\n      format: 'h5'\n    }, {\n      title: 'Heading 6',\n      format: 'h6'\n    }]\n  }, {\n    title: 'Inline',\n    items: [{\n      title: 'Bold',\n      format: 'bold'\n    }, {\n      title: 'Italic',\n      format: 'italic'\n    }, {\n      title: 'Underline',\n      format: 'underline'\n    }, {\n      title: 'Strikethrough',\n      format: 'strikethrough'\n    }, {\n      title: 'Superscript',\n      format: 'superscript'\n    }, {\n      title: 'Subscript',\n      format: 'subscript'\n    }, {\n      title: 'Code',\n      format: 'code'\n    }]\n  }, {\n    title: 'Blocks',\n    items: [{\n      title: 'Paragraph',\n      format: 'p'\n    }, {\n      title: 'Blockquote',\n      format: 'blockquote'\n    }, {\n      title: 'Div',\n      format: 'div'\n    }, {\n      title: 'Pre',\n      format: 'pre'\n    }]\n  }, {\n    title: 'Align',\n    items: [{\n      title: 'Left',\n      format: 'alignleft'\n    }, {\n      title: 'Center',\n      format: 'aligncenter'\n    }, {\n      title: 'Right',\n      format: 'alignright'\n    }, {\n      title: 'Justify',\n      format: 'alignjustify'\n    }]\n  }];\n\n  var isNestedFormat = function (format) {\n    return has(format, 'items');\n  };\n\n  var isBlockFormat = function (format) {\n    return has(format, 'block');\n  };\n\n  var isInlineFormat = function (format) {\n    return has(format, 'inline');\n  };\n\n  var isSelectorFormat = function (format) {\n    return has(format, 'selector');\n  };\n\n  var mapFormats = function (userFormats) {\n    return foldl(userFormats, function (acc, fmt) {\n      if (isNestedFormat(fmt)) {\n        var result = mapFormats(fmt.items);\n        return {\n          customFormats: acc.customFormats.concat(result.customFormats),\n          formats: acc.formats.concat([{\n            title: fmt.title,\n            items: result.formats\n          }])\n        };\n      } else if (isInlineFormat(fmt) || isBlockFormat(fmt) || isSelectorFormat(fmt)) {\n        var formatName = isString(fmt.name) ? fmt.name : fmt.title.toLowerCase();\n        var formatNameWithPrefix = 'custom-' + formatName;\n        return {\n          customFormats: acc.customFormats.concat([{\n            name: formatNameWithPrefix,\n            format: fmt\n          }]),\n          formats: acc.formats.concat([{\n            title: fmt.title,\n            format: formatNameWithPrefix,\n            icon: fmt.icon\n          }])\n        };\n      } else {\n        return __assign(__assign({}, acc), {\n          formats: acc.formats.concat(fmt)\n        });\n      }\n    }, {\n      customFormats: [],\n      formats: []\n    });\n  };\n\n  var registerCustomFormats = function (editor, userFormats) {\n    var result = mapFormats(userFormats);\n\n    var registerFormats = function (customFormats) {\n      each(customFormats, function (fmt) {\n        if (!editor.formatter.has(fmt.name)) {\n          editor.formatter.register(fmt.name, fmt.format);\n        }\n      });\n    };\n\n    if (editor.formatter) {\n      registerFormats(result.customFormats);\n    } else {\n      editor.on('init', function () {\n        registerFormats(result.customFormats);\n      });\n    }\n\n    return result.formats;\n  };\n\n  var getStyleFormats = function (editor) {\n    return getUserStyleFormats(editor).map(function (userFormats) {\n      var registeredUserFormats = registerCustomFormats(editor, userFormats);\n      return isMergeStyleFormats(editor) ? defaultStyleFormats.concat(registeredUserFormats) : registeredUserFormats;\n    }).getOr(defaultStyleFormats);\n  };\n\n  var processBasic = function (item, isSelectedFor, getPreviewFor) {\n    var formatterSpec = {\n      type: 'formatter',\n      isSelected: isSelectedFor(item.format),\n      getStylePreview: getPreviewFor(item.format)\n    };\n    return deepMerge(item, formatterSpec);\n  };\n\n  var register$3 = function (editor, formats, isSelectedFor, getPreviewFor) {\n    var enrichSupported = function (item) {\n      return processBasic(item, isSelectedFor, getPreviewFor);\n    };\n\n    var enrichMenu = function (item) {\n      var submenuSpec = {\n        type: 'submenu'\n      };\n      return deepMerge(item, submenuSpec);\n    };\n\n    var enrichCustom = function (item) {\n      var formatName = isString(item.name) ? item.name : generate$1(item.title);\n      var formatNameWithPrefix = 'custom-' + formatName;\n      var customSpec = {\n        type: 'formatter',\n        format: formatNameWithPrefix,\n        isSelected: isSelectedFor(formatNameWithPrefix),\n        getStylePreview: getPreviewFor(formatNameWithPrefix)\n      };\n      var newItem = deepMerge(item, customSpec);\n      editor.formatter.register(formatName, newItem);\n      return newItem;\n    };\n\n    var doEnrich = function (items) {\n      return map(items, function (item) {\n        var keys$1 = keys(item);\n\n        if (hasNonNullableKey(item, 'items')) {\n          var newItems_1 = doEnrich(item.items);\n          return deepMerge(enrichMenu(item), {\n            getStyleItems: function () {\n              return newItems_1;\n            }\n          });\n        } else if (hasNonNullableKey(item, 'format')) {\n          return enrichSupported(item);\n        } else if (keys$1.length === 1 && contains(keys$1, 'title')) {\n          return deepMerge(item, {\n            type: 'separator'\n          });\n        } else {\n          return enrichCustom(item);\n        }\n      });\n    };\n\n    return doEnrich(formats);\n  };\n\n  var init$7 = function (editor) {\n    var isSelectedFor = function (format) {\n      return function () {\n        return editor.formatter.match(format);\n      };\n    };\n\n    var getPreviewFor = function (format) {\n      return function () {\n        var fmt = editor.formatter.get(format);\n        return fmt !== undefined ? Optional.some({\n          tag: fmt.length > 0 ? fmt[0].inline || fmt[0].block || 'div' : 'div',\n          styles: editor.dom.parseStyle(editor.formatter.getCssText(format))\n        }) : Optional.none();\n      };\n    };\n\n    var flatten = function (fmt) {\n      var subs = fmt.items;\n      return subs !== undefined && subs.length > 0 ? bind(subs, flatten) : [fmt.format];\n    };\n\n    var settingsFormats = Cell([]);\n    var settingsFlattenedFormats = Cell([]);\n    var eventsFormats = Cell([]);\n    var eventsFlattenedFormats = Cell([]);\n    var replaceSettings = Cell(false);\n    editor.on('PreInit', function (_e) {\n      var formats = getStyleFormats(editor);\n      var enriched = register$3(editor, formats, isSelectedFor, getPreviewFor);\n      settingsFormats.set(enriched);\n      settingsFlattenedFormats.set(bind(enriched, flatten));\n    });\n    editor.on('addStyleModifications', function (e) {\n      var modifications = register$3(editor, e.items, isSelectedFor, getPreviewFor);\n      eventsFormats.set(modifications);\n      replaceSettings.set(e.replace);\n      eventsFlattenedFormats.set(bind(modifications, flatten));\n    });\n\n    var getData = function () {\n      var fromSettings = replaceSettings.get() ? [] : settingsFormats.get();\n      var fromEvents = eventsFormats.get();\n      return fromSettings.concat(fromEvents);\n    };\n\n    var getFlattenedKeys = function () {\n      var fromSettings = replaceSettings.get() ? [] : settingsFlattenedFormats.get();\n      var fromEvents = eventsFlattenedFormats.get();\n      return fromSettings.concat(fromEvents);\n    };\n\n    return {\n      getData: getData,\n      getFlattenedKeys: getFlattenedKeys\n    };\n  };\n\n  var isElement$2 = function (node) {\n    return isNonNullable(node) && node.nodeType === 1;\n  };\n\n  var trim$1 = global$c.trim;\n\n  var hasContentEditableState = function (value) {\n    return function (node) {\n      if (isElement$2(node)) {\n        if (node.contentEditable === value) {\n          return true;\n        }\n\n        if (node.getAttribute('data-mce-contenteditable') === value) {\n          return true;\n        }\n      }\n\n      return false;\n    };\n  };\n\n  var isContentEditableTrue = hasContentEditableState('true');\n  var isContentEditableFalse = hasContentEditableState('false');\n\n  var create$8 = function (type, title, url, level, attach) {\n    return {\n      type: type,\n      title: title,\n      url: url,\n      level: level,\n      attach: attach\n    };\n  };\n\n  var isChildOfContentEditableTrue = function (node) {\n    while (node = node.parentNode) {\n      var value = node.contentEditable;\n\n      if (value && value !== 'inherit') {\n        return isContentEditableTrue(node);\n      }\n    }\n\n    return false;\n  };\n\n  var select = function (selector, root) {\n    return map(descendants(SugarElement.fromDom(root), selector), function (element) {\n      return element.dom;\n    });\n  };\n\n  var getElementText = function (elm) {\n    return elm.innerText || elm.textContent;\n  };\n\n  var getOrGenerateId = function (elm) {\n    return elm.id ? elm.id : generate$1('h');\n  };\n\n  var isAnchor = function (elm) {\n    return elm && elm.nodeName === 'A' && (elm.id || elm.name) !== undefined;\n  };\n\n  var isValidAnchor = function (elm) {\n    return isAnchor(elm) && isEditable(elm);\n  };\n\n  var isHeader = function (elm) {\n    return elm && /^(H[1-6])$/.test(elm.nodeName);\n  };\n\n  var isEditable = function (elm) {\n    return isChildOfContentEditableTrue(elm) && !isContentEditableFalse(elm);\n  };\n\n  var isValidHeader = function (elm) {\n    return isHeader(elm) && isEditable(elm);\n  };\n\n  var getLevel = function (elm) {\n    return isHeader(elm) ? parseInt(elm.nodeName.substr(1), 10) : 0;\n  };\n\n  var headerTarget = function (elm) {\n    var headerId = getOrGenerateId(elm);\n\n    var attach = function () {\n      elm.id = headerId;\n    };\n\n    return create$8('header', getElementText(elm), '#' + headerId, getLevel(elm), attach);\n  };\n\n  var anchorTarget = function (elm) {\n    var anchorId = elm.id || elm.name;\n    var anchorText = getElementText(elm);\n    return create$8('anchor', anchorText ? anchorText : '#' + anchorId, '#' + anchorId, 0, noop);\n  };\n\n  var getHeaderTargets = function (elms) {\n    return map(filter(elms, isValidHeader), headerTarget);\n  };\n\n  var getAnchorTargets = function (elms) {\n    return map(filter(elms, isValidAnchor), anchorTarget);\n  };\n\n  var getTargetElements = function (elm) {\n    var elms = select('h1,h2,h3,h4,h5,h6,a:not([href])', elm);\n    return elms;\n  };\n\n  var hasTitle = function (target) {\n    return trim$1(target.title).length > 0;\n  };\n\n  var find$5 = function (elm) {\n    var elms = getTargetElements(elm);\n    return filter(getHeaderTargets(elms).concat(getAnchorTargets(elms)), hasTitle);\n  };\n\n  var LinkTargets = {\n    find: find$5\n  };\n  var STORAGE_KEY = 'tinymce-url-history';\n  var HISTORY_LENGTH = 5;\n\n  var isHttpUrl = function (url) {\n    return isString(url) && /^https?/.test(url);\n  };\n\n  var isArrayOfUrl = function (a) {\n    return isArray(a) && a.length <= HISTORY_LENGTH && forall(a, isHttpUrl);\n  };\n\n  var isRecordOfUrlArray = function (r) {\n    return isObject(r) && find$1(r, function (value) {\n      return !isArrayOfUrl(value);\n    }).isNone();\n  };\n\n  var getAllHistory = function () {\n    var unparsedHistory = global$9.getItem(STORAGE_KEY);\n\n    if (unparsedHistory === null) {\n      return {};\n    }\n\n    var history;\n\n    try {\n      history = JSON.parse(unparsedHistory);\n    } catch (e) {\n      if (e instanceof SyntaxError) {\n        console.log('Local storage ' + STORAGE_KEY + ' was not valid JSON', e);\n        return {};\n      }\n\n      throw e;\n    }\n\n    if (!isRecordOfUrlArray(history)) {\n      console.log('Local storage ' + STORAGE_KEY + ' was not valid format', history);\n      return {};\n    }\n\n    return history;\n  };\n\n  var setAllHistory = function (history) {\n    if (!isRecordOfUrlArray(history)) {\n      throw new Error('Bad format for history:\\n' + JSON.stringify(history));\n    }\n\n    global$9.setItem(STORAGE_KEY, JSON.stringify(history));\n  };\n\n  var getHistory = function (fileType) {\n    var history = getAllHistory();\n    return Object.prototype.hasOwnProperty.call(history, fileType) ? history[fileType] : [];\n  };\n\n  var addToHistory = function (url, fileType) {\n    if (!isHttpUrl(url)) {\n      return;\n    }\n\n    var history = getAllHistory();\n    var items = Object.prototype.hasOwnProperty.call(history, fileType) ? history[fileType] : [];\n    var itemsWithoutUrl = filter(items, function (item) {\n      return item !== url;\n    });\n    history[fileType] = [url].concat(itemsWithoutUrl).slice(0, HISTORY_LENGTH);\n    setAllHistory(history);\n  };\n\n  var isTruthy = function (value) {\n    return !!value;\n  };\n\n  var makeMap = function (value) {\n    return map$2(global$c.makeMap(value, /[, ]/), isTruthy);\n  };\n\n  var getPicker = function (editor) {\n    return Optional.from(getFilePickerCallback(editor)).filter(isFunction);\n  };\n\n  var getPickerTypes = function (editor) {\n    var optFileTypes = Optional.some(getFilePickerTypes(editor)).filter(isTruthy);\n    var optLegacyTypes = Optional.some(getFileBrowserCallbackTypes(editor)).filter(isTruthy);\n    var optTypes = optFileTypes.or(optLegacyTypes).map(makeMap);\n    return getPicker(editor).fold(never, function (_picker) {\n      return optTypes.fold(always, function (types) {\n        return keys(types).length > 0 ? types : false;\n      });\n    });\n  };\n\n  var getPickerSetting = function (editor, filetype) {\n    var pickerTypes = getPickerTypes(editor);\n\n    if (isBoolean(pickerTypes)) {\n      return pickerTypes ? getPicker(editor) : Optional.none();\n    } else {\n      return pickerTypes[filetype] ? getPicker(editor) : Optional.none();\n    }\n  };\n\n  var getUrlPicker = function (editor, filetype) {\n    return getPickerSetting(editor, filetype).map(function (picker) {\n      return function (entry) {\n        return Future.nu(function (completer) {\n          var handler = function (value, meta) {\n            if (!isString(value)) {\n              throw new Error('Expected value to be string');\n            }\n\n            if (meta !== undefined && !isObject(meta)) {\n              throw new Error('Expected meta to be a object');\n            }\n\n            var r = {\n              value: value,\n              meta: meta\n            };\n            completer(r);\n          };\n\n          var meta = __assign({\n            filetype: filetype,\n            fieldname: entry.fieldname\n          }, Optional.from(entry.meta).getOr({}));\n\n          picker.call(editor, handler, entry.value, meta);\n        });\n      };\n    });\n  };\n\n  var getTextSetting = function (value) {\n    return Optional.from(value).filter(isString).getOrUndefined();\n  };\n\n  var getLinkInformation = function (editor) {\n    if (noTypeaheadUrls(editor)) {\n      return Optional.none();\n    }\n\n    return Optional.some({\n      targets: LinkTargets.find(editor.getBody()),\n      anchorTop: getTextSetting(getAnchorTop(editor)),\n      anchorBottom: getTextSetting(getAnchorBottom(editor))\n    });\n  };\n\n  var getValidationHandler = function (editor) {\n    return Optional.from(getFilePickerValidatorHandler(editor));\n  };\n\n  var UrlInputBackstage = function (editor) {\n    return {\n      getHistory: getHistory,\n      addToHistory: addToHistory,\n      getLinkInformation: function () {\n        return getLinkInformation(editor);\n      },\n      getValidationHandler: function () {\n        return getValidationHandler(editor);\n      },\n      getUrlPicker: function (filetype) {\n        return getUrlPicker(editor, filetype);\n      }\n    };\n  };\n\n  var init$8 = function (sink, editor, lazyAnchorbar) {\n    var contextMenuState = Cell(false);\n    var toolbar = HeaderBackstage(editor);\n    var backstage = {\n      shared: {\n        providers: {\n          icons: function () {\n            return editor.ui.registry.getAll().icons;\n          },\n          menuItems: function () {\n            return editor.ui.registry.getAll().menuItems;\n          },\n          translate: global$6.translate,\n          isDisabled: function () {\n            return editor.mode.isReadOnly() || editor.ui.isDisabled();\n          },\n          getSetting: editor.getParam.bind(editor)\n        },\n        interpreter: function (s) {\n          return interpretWithoutForm(s, backstage);\n        },\n        anchors: getAnchors(editor, lazyAnchorbar, toolbar.isPositionedAtTop),\n        header: toolbar,\n        getSink: function () {\n          return Result.value(sink);\n        }\n      },\n      urlinput: UrlInputBackstage(editor),\n      styleselect: init$7(editor),\n      colorinput: ColorInputBackstage(editor),\n      dialog: DialogBackstage(editor),\n      isContextMenuOpen: function () {\n        return contextMenuState.get();\n      },\n      setContextMenuState: function (state) {\n        return contextMenuState.set(state);\n      }\n    };\n    return backstage;\n  };\n\n  var expandable$1 = constant(function (element, available) {\n    setMax$1(element, Math.floor(available));\n  });\n  var showContextToolbarEvent = 'contexttoolbar-show';\n  var hideContextToolbarEvent = 'contexttoolbar-hide';\n  var schema$k = constant([strict$1('dom'), defaulted$1('shell', true), field$1('toolbarBehaviours', [Replacing])]);\n\n  var enhanceGroups = function () {\n    return {\n      behaviours: derive$1([Replacing.config({})])\n    };\n  };\n\n  var parts$7 = constant([optional({\n    name: 'groups',\n    overrides: enhanceGroups\n  })]);\n\n  var factory$9 = function (detail, components, _spec, _externals) {\n    var setGroups = function (toolbar, groups) {\n      getGroupContainer(toolbar).fold(function () {\n        console.error('Toolbar was defined to not be a shell, but no groups container was specified in components');\n        throw new Error('Toolbar was defined to not be a shell, but no groups container was specified in components');\n      }, function (container) {\n        Replacing.set(container, groups);\n      });\n    };\n\n    var getGroupContainer = function (component) {\n      return detail.shell ? Optional.some(component) : getPart(component, detail, 'groups');\n    };\n\n    var extra = detail.shell ? {\n      behaviours: [Replacing.config({})],\n      components: []\n    } : {\n      behaviours: [],\n      components: components\n    };\n    return {\n      uid: detail.uid,\n      dom: detail.dom,\n      components: extra.components,\n      behaviours: augment(detail.toolbarBehaviours, extra.behaviours),\n      apis: {\n        setGroups: setGroups\n      },\n      domModification: {\n        attributes: {\n          role: 'group'\n        }\n      }\n    };\n  };\n\n  var Toolbar = composite$1({\n    name: 'Toolbar',\n    configFields: schema$k(),\n    partFields: parts$7(),\n    factory: factory$9,\n    apis: {\n      setGroups: function (apis, toolbar, groups) {\n        apis.setGroups(toolbar, groups);\n      }\n    }\n  });\n\n  var generate$6 = function (xs, f) {\n    var init = {\n      len: 0,\n      list: []\n    };\n    var r = foldl(xs, function (b, a) {\n      var value = f(a, b.len);\n      return value.fold(constant(b), function (v) {\n        return {\n          len: v.finish,\n          list: b.list.concat([v])\n        };\n      });\n    }, init);\n    return r.list;\n  };\n\n  var output$1 = function (within, extra, withinWidth) {\n    return {\n      within: within,\n      extra: extra,\n      withinWidth: withinWidth\n    };\n  };\n\n  var apportion = function (units, total, len) {\n    var parray = generate$6(units, function (unit, current) {\n      var width = len(unit);\n      return Optional.some({\n        element: unit,\n        start: current,\n        finish: current + width,\n        width: width\n      });\n    });\n    var within = filter(parray, function (unit) {\n      return unit.finish <= total;\n    });\n    var withinWidth = foldr(within, function (acc, el) {\n      return acc + el.width;\n    }, 0);\n    var extra = parray.slice(within.length);\n    return {\n      within: within,\n      extra: extra,\n      withinWidth: withinWidth\n    };\n  };\n\n  var toUnit = function (parray) {\n    return map(parray, function (unit) {\n      return unit.element;\n    });\n  };\n\n  var fitLast = function (within, extra, withinWidth) {\n    var fits = toUnit(within.concat(extra));\n    return output$1(fits, [], withinWidth);\n  };\n\n  var overflow = function (within, extra, overflower, withinWidth) {\n    var fits = toUnit(within).concat([overflower]);\n    return output$1(fits, toUnit(extra), withinWidth);\n  };\n\n  var fitAll = function (within, extra, withinWidth) {\n    return output$1(toUnit(within), [], withinWidth);\n  };\n\n  var tryFit = function (total, units, len) {\n    var divide = apportion(units, total, len);\n    return divide.extra.length === 0 ? Optional.some(divide) : Optional.none();\n  };\n\n  var partition$3 = function (total, units, len, overflower) {\n    var divide = tryFit(total, units, len).getOrThunk(function () {\n      return apportion(units, total - len(overflower), len);\n    });\n    var within = divide.within;\n    var extra = divide.extra;\n    var withinWidth = divide.withinWidth;\n\n    if (extra.length === 1 && extra[0].width <= len(overflower)) {\n      return fitLast(within, extra, withinWidth);\n    } else if (extra.length >= 1) {\n      return overflow(within, extra, overflower, withinWidth);\n    } else {\n      return fitAll(within, extra, withinWidth);\n    }\n  };\n\n  var setGroups = function (toolbar, storedGroups) {\n    var bGroups = map(storedGroups, function (g) {\n      return premade$1(g);\n    });\n    Toolbar.setGroups(toolbar, bGroups);\n  };\n\n  var findFocusedComp = function (comps) {\n    return findMap(comps, function (comp) {\n      return search(comp.element).bind(function (focusedElm) {\n        return comp.getSystem().getByDom(focusedElm).toOptional();\n      });\n    });\n  };\n\n  var refresh = function (toolbar, detail, setOverflow) {\n    var primary = getPartOrDie(toolbar, detail, 'primary');\n    var overflowGroup = Coupling.getCoupled(toolbar, 'overflowGroup');\n    set$2(primary.element, 'visibility', 'hidden');\n    var groups = detail.builtGroups.get().concat([overflowGroup]);\n    var focusedComp = findFocusedComp(groups);\n    setOverflow([]);\n    setGroups(primary, groups);\n    var availableWidth = get$8(primary.element);\n    var overflows = partition$3(availableWidth, detail.builtGroups.get(), function (comp) {\n      return get$8(comp.element);\n    }, overflowGroup);\n\n    if (overflows.extra.length === 0) {\n      Replacing.remove(primary, overflowGroup);\n      setOverflow([]);\n    } else {\n      setGroups(primary, overflows.within);\n      setOverflow(overflows.extra);\n    }\n\n    remove$6(primary.element, 'visibility');\n    reflow(primary.element);\n    focusedComp.each(Focusing.focus);\n  };\n\n  var schema$l = constant([field$1('splitToolbarBehaviours', [Coupling]), state$1('builtGroups', function () {\n    return Cell([]);\n  })]);\n  var schema$m = constant([markers(['overflowToggledClass']), optionFunction('getOverflowBounds'), strict$1('lazySink'), state$1('overflowGroups', function () {\n    return Cell([]);\n  })].concat(schema$l()));\n  var parts$8 = constant([required({\n    factory: Toolbar,\n    schema: schema$k(),\n    name: 'primary'\n  }), external$1({\n    schema: schema$k(),\n    name: 'overflow'\n  }), external$1({\n    name: 'overflow-button'\n  }), external$1({\n    name: 'overflow-group'\n  })]);\n  var schema$n = constant([markers(['toggledClass']), strict$1('lazySink'), strictFunction('fetch'), optionFunction('getBounds'), optionObjOf('fireDismissalEventInstead', [defaulted$1('event', dismissRequested())]), schema$1()]);\n  var parts$9 = constant([external$1({\n    name: 'button',\n    overrides: function (detail) {\n      return {\n        dom: {\n          attributes: {\n            'aria-haspopup': 'true'\n          }\n        },\n        buttonBehaviours: derive$1([Toggling.config({\n          toggleClass: detail.markers.toggledClass,\n          aria: {\n            mode: 'expanded'\n          },\n          toggleOnExecute: false\n        })])\n      };\n    }\n  }), external$1({\n    factory: Toolbar,\n    schema: schema$k(),\n    name: 'toolbar',\n    overrides: function (detail) {\n      return {\n        toolbarBehaviours: derive$1([Keying.config({\n          mode: 'cyclic',\n          onEscape: function (comp) {\n            getPart(comp, detail, 'button').each(Focusing.focus);\n            return Optional.none();\n          }\n        })])\n      };\n    }\n  })]);\n\n  var toggle$2 = function (button, externals) {\n    var toolbarSandbox = Coupling.getCoupled(button, 'toolbarSandbox');\n\n    if (Sandboxing.isOpen(toolbarSandbox)) {\n      Sandboxing.close(toolbarSandbox);\n    } else {\n      Sandboxing.open(toolbarSandbox, externals.toolbar());\n    }\n  };\n\n  var position$2 = function (button, toolbar, detail, layouts) {\n    var bounds = detail.getBounds.map(function (bounder) {\n      return bounder();\n    });\n    var sink = detail.lazySink(button).getOrDie();\n    Positioning.positionWithinBounds(sink, {\n      anchor: 'hotspot',\n      hotspot: button,\n      layouts: layouts,\n      overrides: {\n        maxWidthFunction: expandable$1()\n      }\n    }, toolbar, bounds);\n  };\n\n  var setGroups$1 = function (button, toolbar, detail, layouts, groups) {\n    Toolbar.setGroups(toolbar, groups);\n    position$2(button, toolbar, detail, layouts);\n    Toggling.on(button);\n  };\n\n  var makeSandbox$1 = function (button, spec, detail) {\n    var ariaOwner = manager();\n\n    var onOpen = function (sandbox, toolbar) {\n      detail.fetch().get(function (groups) {\n        setGroups$1(button, toolbar, detail, spec.layouts, groups);\n        ariaOwner.link(button.element);\n        Keying.focusIn(toolbar);\n      });\n    };\n\n    var onClose = function () {\n      Toggling.off(button);\n      Focusing.focus(button);\n      ariaOwner.unlink(button.element);\n    };\n\n    return {\n      dom: {\n        tag: 'div',\n        attributes: {\n          id: ariaOwner.id\n        }\n      },\n      behaviours: derive$1([Keying.config({\n        mode: 'special',\n        onEscape: function (comp) {\n          Sandboxing.close(comp);\n          return Optional.some(true);\n        }\n      }), Sandboxing.config({\n        onOpen: onOpen,\n        onClose: onClose,\n        isPartOf: function (container, data, queryElem) {\n          return isPartOf(data, queryElem) || isPartOf(button, queryElem);\n        },\n        getAttachPoint: function () {\n          return detail.lazySink(button).getOrDie();\n        }\n      }), Receiving.config({\n        channels: __assign(__assign({}, receivingChannel(__assign({\n          isExtraPart: never\n        }, detail.fireDismissalEventInstead.map(function (fe) {\n          return {\n            fireEventInstead: {\n              event: fe.event\n            }\n          };\n        }).getOr({})))), receivingChannel$1({\n          doReposition: function () {\n            Sandboxing.getState(Coupling.getCoupled(button, 'toolbarSandbox')).each(function (toolbar) {\n              position$2(button, toolbar, detail, spec.layouts);\n            });\n          }\n        }))\n      })])\n    };\n  };\n\n  var factory$a = function (detail, components, spec, externals) {\n    return __assign(__assign({}, Button.sketch(__assign(__assign({}, externals.button()), {\n      action: function (button) {\n        toggle$2(button, externals);\n      },\n      buttonBehaviours: SketchBehaviours.augment({\n        dump: externals.button().buttonBehaviours\n      }, [Coupling.config({\n        others: {\n          toolbarSandbox: function (button) {\n            return makeSandbox$1(button, spec, detail);\n          }\n        }\n      })])\n    }))), {\n      apis: {\n        setGroups: function (button, groups) {\n          Sandboxing.getState(Coupling.getCoupled(button, 'toolbarSandbox')).each(function (toolbar) {\n            setGroups$1(button, toolbar, detail, spec.layouts, groups);\n          });\n        },\n        reposition: function (button) {\n          Sandboxing.getState(Coupling.getCoupled(button, 'toolbarSandbox')).each(function (toolbar) {\n            position$2(button, toolbar, detail, spec.layouts);\n          });\n        },\n        toggle: function (button) {\n          toggle$2(button, externals);\n        },\n        getToolbar: function (button) {\n          return Sandboxing.getState(Coupling.getCoupled(button, 'toolbarSandbox'));\n        },\n        isOpen: function (button) {\n          return Sandboxing.isOpen(Coupling.getCoupled(button, 'toolbarSandbox'));\n        }\n      }\n    });\n  };\n\n  var FloatingToolbarButton = composite$1({\n    name: 'FloatingToolbarButton',\n    factory: factory$a,\n    configFields: schema$n(),\n    partFields: parts$9(),\n    apis: {\n      setGroups: function (apis, button, groups) {\n        apis.setGroups(button, groups);\n      },\n      reposition: function (apis, button) {\n        apis.reposition(button);\n      },\n      toggle: function (apis, button) {\n        apis.toggle(button);\n      },\n      getToolbar: function (apis, button) {\n        return apis.getToolbar(button);\n      },\n      isOpen: function (apis, button) {\n        return apis.isOpen(button);\n      }\n    }\n  });\n  var schema$o = constant([strict$1('items'), markers(['itemSelector']), field$1('tgroupBehaviours', [Keying])]);\n  var parts$a = constant([group({\n    name: 'items',\n    unit: 'item'\n  })]);\n\n  var factory$b = function (detail, components, _spec, _externals) {\n    return {\n      uid: detail.uid,\n      dom: detail.dom,\n      components: components,\n      behaviours: augment(detail.tgroupBehaviours, [Keying.config({\n        mode: 'flow',\n        selector: detail.markers.itemSelector\n      })]),\n      domModification: {\n        attributes: {\n          role: 'toolbar'\n        }\n      }\n    };\n  };\n\n  var ToolbarGroup = composite$1({\n    name: 'ToolbarGroup',\n    configFields: schema$o(),\n    partFields: parts$a(),\n    factory: factory$b\n  });\n\n  var buildGroups = function (comps) {\n    return map(comps, function (g) {\n      return premade$1(g);\n    });\n  };\n\n  var refresh$1 = function (toolbar, memFloatingToolbarButton, detail) {\n    refresh(toolbar, detail, function (overflowGroups) {\n      detail.overflowGroups.set(overflowGroups);\n      memFloatingToolbarButton.getOpt(toolbar).each(function (floatingToolbarButton) {\n        FloatingToolbarButton.setGroups(floatingToolbarButton, buildGroups(overflowGroups));\n      });\n    });\n  };\n\n  var factory$c = function (detail, components, spec, externals) {\n    var memFloatingToolbarButton = record(FloatingToolbarButton.sketch({\n      fetch: function () {\n        return Future.nu(function (resolve) {\n          resolve(buildGroups(detail.overflowGroups.get()));\n        });\n      },\n      layouts: {\n        onLtr: function () {\n          return [southwest$1, southeast$1];\n        },\n        onRtl: function () {\n          return [southeast$1, southwest$1];\n        },\n        onBottomLtr: function () {\n          return [northwest$1, northeast$1];\n        },\n        onBottomRtl: function () {\n          return [northeast$1, northwest$1];\n        }\n      },\n      getBounds: spec.getOverflowBounds,\n      lazySink: detail.lazySink,\n      fireDismissalEventInstead: {},\n      markers: {\n        toggledClass: detail.markers.overflowToggledClass\n      },\n      parts: {\n        button: externals['overflow-button'](),\n        toolbar: externals.overflow()\n      }\n    }));\n    return {\n      uid: detail.uid,\n      dom: detail.dom,\n      components: components,\n      behaviours: augment(detail.splitToolbarBehaviours, [Coupling.config({\n        others: {\n          overflowGroup: function () {\n            return ToolbarGroup.sketch(__assign(__assign({}, externals['overflow-group']()), {\n              items: [memFloatingToolbarButton.asSpec()]\n            }));\n          }\n        }\n      })]),\n      apis: {\n        setGroups: function (toolbar, groups) {\n          detail.builtGroups.set(map(groups, toolbar.getSystem().build));\n          refresh$1(toolbar, memFloatingToolbarButton, detail);\n        },\n        refresh: function (toolbar) {\n          return refresh$1(toolbar, memFloatingToolbarButton, detail);\n        },\n        toggle: function (toolbar) {\n          memFloatingToolbarButton.getOpt(toolbar).each(function (floatingToolbarButton) {\n            FloatingToolbarButton.toggle(floatingToolbarButton);\n          });\n        },\n        isOpen: function (toolbar) {\n          return memFloatingToolbarButton.getOpt(toolbar).map(FloatingToolbarButton.isOpen).getOr(false);\n        },\n        reposition: function (toolbar) {\n          memFloatingToolbarButton.getOpt(toolbar).each(function (floatingToolbarButton) {\n            FloatingToolbarButton.reposition(floatingToolbarButton);\n          });\n        },\n        getOverflow: function (toolbar) {\n          return memFloatingToolbarButton.getOpt(toolbar).bind(FloatingToolbarButton.getToolbar);\n        }\n      },\n      domModification: {\n        attributes: {\n          role: 'group'\n        }\n      }\n    };\n  };\n\n  var SplitFloatingToolbar = composite$1({\n    name: 'SplitFloatingToolbar',\n    configFields: schema$m(),\n    partFields: parts$8(),\n    factory: factory$c,\n    apis: {\n      setGroups: function (apis, toolbar, groups) {\n        apis.setGroups(toolbar, groups);\n      },\n      refresh: function (apis, toolbar) {\n        apis.refresh(toolbar);\n      },\n      reposition: function (apis, toolbar) {\n        apis.reposition(toolbar);\n      },\n      toggle: function (apis, toolbar) {\n        apis.toggle(toolbar);\n      },\n      isOpen: function (apis, toolbar) {\n        return apis.isOpen(toolbar);\n      },\n      getOverflow: function (apis, toolbar) {\n        return apis.getOverflow(toolbar);\n      }\n    }\n  });\n\n  var getAnimationRoot = function (component, slideConfig) {\n    return slideConfig.getAnimationRoot.fold(function () {\n      return component.element;\n    }, function (get) {\n      return get(component);\n    });\n  };\n\n  var getDimensionProperty = function (slideConfig) {\n    return slideConfig.dimension.property;\n  };\n\n  var getDimension = function (slideConfig, elem) {\n    return slideConfig.dimension.getDimension(elem);\n  };\n\n  var disableTransitions = function (component, slideConfig) {\n    var root = getAnimationRoot(component, slideConfig);\n    remove$5(root, [slideConfig.shrinkingClass, slideConfig.growingClass]);\n  };\n\n  var setShrunk = function (component, slideConfig) {\n    remove$4(component.element, slideConfig.openClass);\n    add$2(component.element, slideConfig.closedClass);\n    set$2(component.element, getDimensionProperty(slideConfig), '0px');\n    reflow(component.element);\n  };\n\n  var setGrown = function (component, slideConfig) {\n    remove$4(component.element, slideConfig.closedClass);\n    add$2(component.element, slideConfig.openClass);\n    remove$6(component.element, getDimensionProperty(slideConfig));\n  };\n\n  var doImmediateShrink = function (component, slideConfig, slideState, _calculatedSize) {\n    slideState.setCollapsed();\n    set$2(component.element, getDimensionProperty(slideConfig), getDimension(slideConfig, component.element));\n    reflow(component.element);\n    disableTransitions(component, slideConfig);\n    setShrunk(component, slideConfig);\n    slideConfig.onStartShrink(component);\n    slideConfig.onShrunk(component);\n  };\n\n  var doStartShrink = function (component, slideConfig, slideState, calculatedSize) {\n    var size = calculatedSize.getOrThunk(function () {\n      return getDimension(slideConfig, component.element);\n    });\n    slideState.setCollapsed();\n    set$2(component.element, getDimensionProperty(slideConfig), size);\n    reflow(component.element);\n    var root = getAnimationRoot(component, slideConfig);\n    remove$4(root, slideConfig.growingClass);\n    add$2(root, slideConfig.shrinkingClass);\n    setShrunk(component, slideConfig);\n    slideConfig.onStartShrink(component);\n  };\n\n  var doStartSmartShrink = function (component, slideConfig, slideState) {\n    var size = getDimension(slideConfig, component.element);\n    var shrinker = size === '0px' ? doImmediateShrink : doStartShrink;\n    shrinker(component, slideConfig, slideState, Optional.some(size));\n  };\n\n  var doStartGrow = function (component, slideConfig, slideState) {\n    var root = getAnimationRoot(component, slideConfig);\n    var wasShrinking = has$2(root, slideConfig.shrinkingClass);\n    var beforeSize = getDimension(slideConfig, component.element);\n    setGrown(component, slideConfig);\n    var fullSize = getDimension(slideConfig, component.element);\n\n    var startPartialGrow = function () {\n      set$2(component.element, getDimensionProperty(slideConfig), beforeSize);\n      reflow(component.element);\n    };\n\n    var startCompleteGrow = function () {\n      setShrunk(component, slideConfig);\n    };\n\n    var setStartSize = wasShrinking ? startPartialGrow : startCompleteGrow;\n    setStartSize();\n    remove$4(root, slideConfig.shrinkingClass);\n    add$2(root, slideConfig.growingClass);\n    setGrown(component, slideConfig);\n    set$2(component.element, getDimensionProperty(slideConfig), fullSize);\n    slideState.setExpanded();\n    slideConfig.onStartGrow(component);\n  };\n\n  var refresh$2 = function (component, slideConfig, slideState) {\n    if (slideState.isExpanded()) {\n      remove$6(component.element, getDimensionProperty(slideConfig));\n      var fullSize = getDimension(slideConfig, component.element);\n      set$2(component.element, getDimensionProperty(slideConfig), fullSize);\n    }\n  };\n\n  var grow = function (component, slideConfig, slideState) {\n    if (!slideState.isExpanded()) {\n      doStartGrow(component, slideConfig, slideState);\n    }\n  };\n\n  var shrink = function (component, slideConfig, slideState) {\n    if (slideState.isExpanded()) {\n      doStartSmartShrink(component, slideConfig, slideState);\n    }\n  };\n\n  var immediateShrink = function (component, slideConfig, slideState) {\n    if (slideState.isExpanded()) {\n      doImmediateShrink(component, slideConfig, slideState, Optional.none());\n    }\n  };\n\n  var hasGrown = function (component, slideConfig, slideState) {\n    return slideState.isExpanded();\n  };\n\n  var hasShrunk = function (component, slideConfig, slideState) {\n    return slideState.isCollapsed();\n  };\n\n  var isGrowing = function (component, slideConfig, _slideState) {\n    var root = getAnimationRoot(component, slideConfig);\n    return has$2(root, slideConfig.growingClass) === true;\n  };\n\n  var isShrinking = function (component, slideConfig, _slideState) {\n    var root = getAnimationRoot(component, slideConfig);\n    return has$2(root, slideConfig.shrinkingClass) === true;\n  };\n\n  var isTransitioning = function (component, slideConfig, slideState) {\n    return isGrowing(component, slideConfig) || isShrinking(component, slideConfig);\n  };\n\n  var toggleGrow = function (component, slideConfig, slideState) {\n    var f = slideState.isExpanded() ? doStartSmartShrink : doStartGrow;\n    f(component, slideConfig, slideState);\n  };\n\n  var SlidingApis = /*#__PURE__*/Object.freeze({\n    __proto__: null,\n    refresh: refresh$2,\n    grow: grow,\n    shrink: shrink,\n    immediateShrink: immediateShrink,\n    hasGrown: hasGrown,\n    hasShrunk: hasShrunk,\n    isGrowing: isGrowing,\n    isShrinking: isShrinking,\n    isTransitioning: isTransitioning,\n    toggleGrow: toggleGrow,\n    disableTransitions: disableTransitions\n  });\n\n  var exhibit$6 = function (base, slideConfig, _slideState) {\n    var expanded = slideConfig.expanded;\n    return expanded ? nu$6({\n      classes: [slideConfig.openClass],\n      styles: {}\n    }) : nu$6({\n      classes: [slideConfig.closedClass],\n      styles: wrap$1(slideConfig.dimension.property, '0px')\n    });\n  };\n\n  var events$d = function (slideConfig, slideState) {\n    return derive([runOnSource(transitionend(), function (component, simulatedEvent) {\n      var raw = simulatedEvent.event.raw;\n\n      if (raw.propertyName === slideConfig.dimension.property) {\n        disableTransitions(component, slideConfig);\n\n        if (slideState.isExpanded()) {\n          remove$6(component.element, slideConfig.dimension.property);\n        }\n\n        var notify = slideState.isExpanded() ? slideConfig.onGrown : slideConfig.onShrunk;\n        notify(component);\n      }\n    })]);\n  };\n\n  var ActiveSliding = /*#__PURE__*/Object.freeze({\n    __proto__: null,\n    exhibit: exhibit$6,\n    events: events$d\n  });\n  var SlidingSchema = [strict$1('closedClass'), strict$1('openClass'), strict$1('shrinkingClass'), strict$1('growingClass'), option('getAnimationRoot'), onHandler('onShrunk'), onHandler('onStartShrink'), onHandler('onGrown'), onHandler('onStartGrow'), defaulted$1('expanded', false), strictOf('dimension', choose$1('property', {\n    width: [output('property', 'width'), output('getDimension', function (elem) {\n      return get$8(elem) + 'px';\n    })],\n    height: [output('property', 'height'), output('getDimension', function (elem) {\n      return get$7(elem) + 'px';\n    })]\n  }))];\n\n  var init$9 = function (spec) {\n    var state = Cell(spec.expanded);\n\n    var readState = function () {\n      return 'expanded: ' + state.get();\n    };\n\n    return nu$5({\n      isExpanded: function () {\n        return state.get() === true;\n      },\n      isCollapsed: function () {\n        return state.get() === false;\n      },\n      setCollapsed: curry(state.set, false),\n      setExpanded: curry(state.set, true),\n      readState: readState\n    });\n  };\n\n  var SlidingState = /*#__PURE__*/Object.freeze({\n    __proto__: null,\n    init: init$9\n  });\n  var Sliding = create$1({\n    fields: SlidingSchema,\n    name: 'sliding',\n    active: ActiveSliding,\n    apis: SlidingApis,\n    state: SlidingState\n  });\n  var schema$p = constant([markers(['closedClass', 'openClass', 'shrinkingClass', 'growingClass', 'overflowToggledClass']), onHandler('onOpened'), onHandler('onClosed')].concat(schema$l()));\n  var parts$b = constant([required({\n    factory: Toolbar,\n    schema: schema$k(),\n    name: 'primary'\n  }), required({\n    factory: Toolbar,\n    schema: schema$k(),\n    name: 'overflow',\n    overrides: function (detail) {\n      return {\n        toolbarBehaviours: derive$1([Sliding.config({\n          dimension: {\n            property: 'height'\n          },\n          closedClass: detail.markers.closedClass,\n          openClass: detail.markers.openClass,\n          shrinkingClass: detail.markers.shrinkingClass,\n          growingClass: detail.markers.growingClass,\n          onShrunk: function (comp) {\n            getPart(comp, detail, 'overflow-button').each(function (button) {\n              Toggling.off(button);\n              Focusing.focus(button);\n            });\n            detail.onClosed(comp);\n          },\n          onGrown: function (comp) {\n            Keying.focusIn(comp);\n            detail.onOpened(comp);\n          },\n          onStartGrow: function (comp) {\n            getPart(comp, detail, 'overflow-button').each(Toggling.on);\n          }\n        }), Keying.config({\n          mode: 'acyclic',\n          onEscape: function (comp) {\n            getPart(comp, detail, 'overflow-button').each(Focusing.focus);\n            return Optional.some(true);\n          }\n        })])\n      };\n    }\n  }), external$1({\n    name: 'overflow-button',\n    overrides: function (detail) {\n      return {\n        buttonBehaviours: derive$1([Toggling.config({\n          toggleClass: detail.markers.overflowToggledClass,\n          aria: {\n            mode: 'pressed'\n          },\n          toggleOnExecute: false\n        })])\n      };\n    }\n  }), external$1({\n    name: 'overflow-group'\n  })]);\n\n  var isOpen$1 = function (toolbar, detail) {\n    return getPart(toolbar, detail, 'overflow').map(Sliding.hasGrown).getOr(false);\n  };\n\n  var toggleToolbar = function (toolbar, detail) {\n    getPart(toolbar, detail, 'overflow-button').bind(function () {\n      return getPart(toolbar, detail, 'overflow');\n    }).each(function (overf) {\n      refresh$3(toolbar, detail);\n      Sliding.toggleGrow(overf);\n    });\n  };\n\n  var refresh$3 = function (toolbar, detail) {\n    getPart(toolbar, detail, 'overflow').each(function (overflow) {\n      refresh(toolbar, detail, function (groups) {\n        var builtGroups = map(groups, function (g) {\n          return premade$1(g);\n        });\n        Toolbar.setGroups(overflow, builtGroups);\n      });\n      getPart(toolbar, detail, 'overflow-button').each(function (button) {\n        if (Sliding.hasGrown(overflow)) {\n          Toggling.on(button);\n        }\n      });\n      Sliding.refresh(overflow);\n    });\n  };\n\n  var factory$d = function (detail, components, spec, externals) {\n    var toolbarToggleEvent = 'alloy.toolbar.toggle';\n\n    var doSetGroups = function (toolbar, groups) {\n      var built = map(groups, toolbar.getSystem().build);\n      detail.builtGroups.set(built);\n    };\n\n    return {\n      uid: detail.uid,\n      dom: detail.dom,\n      components: components,\n      behaviours: augment(detail.splitToolbarBehaviours, [Coupling.config({\n        others: {\n          overflowGroup: function (toolbar) {\n            return ToolbarGroup.sketch(__assign(__assign({}, externals['overflow-group']()), {\n              items: [Button.sketch(__assign(__assign({}, externals['overflow-button']()), {\n                action: function (_button) {\n                  emit(toolbar, toolbarToggleEvent);\n                }\n              }))]\n            }));\n          }\n        }\n      }), config('toolbar-toggle-events', [run(toolbarToggleEvent, function (toolbar) {\n        toggleToolbar(toolbar, detail);\n      })])]),\n      apis: {\n        setGroups: function (toolbar, groups) {\n          doSetGroups(toolbar, groups);\n          refresh$3(toolbar, detail);\n        },\n        refresh: function (toolbar) {\n          return refresh$3(toolbar, detail);\n        },\n        toggle: function (toolbar) {\n          return toggleToolbar(toolbar, detail);\n        },\n        isOpen: function (toolbar) {\n          return isOpen$1(toolbar, detail);\n        }\n      },\n      domModification: {\n        attributes: {\n          role: 'group'\n        }\n      }\n    };\n  };\n\n  var SplitSlidingToolbar = composite$1({\n    name: 'SplitSlidingToolbar',\n    configFields: schema$p(),\n    partFields: parts$b(),\n    factory: factory$d,\n    apis: {\n      setGroups: function (apis, toolbar, groups) {\n        apis.setGroups(toolbar, groups);\n      },\n      refresh: function (apis, toolbar) {\n        apis.refresh(toolbar);\n      },\n      toggle: function (apis, toolbar) {\n        apis.toggle(toolbar);\n      },\n      isOpen: function (apis, toolbar) {\n        return apis.isOpen(toolbar);\n      }\n    }\n  });\n  var toolbarHeightChange = constant(generate$1('toolbar-height-change'));\n\n  var renderToolbarGroupCommon = function (toolbarGroup) {\n    var attributes = toolbarGroup.title.fold(function () {\n      return {};\n    }, function (title) {\n      return {\n        attributes: {\n          title: title\n        }\n      };\n    });\n    return {\n      dom: __assign({\n        tag: 'div',\n        classes: ['tox-toolbar__group']\n      }, attributes),\n      components: [ToolbarGroup.parts.items({})],\n      items: toolbarGroup.items,\n      markers: {\n        itemSelector: '*:not(.tox-split-button) > .tox-tbtn:not([disabled]), ' + '.tox-split-button:not([disabled]), ' + '.tox-toolbar-nav-js:not([disabled])'\n      },\n      tgroupBehaviours: derive$1([Tabstopping.config({}), Focusing.config({})])\n    };\n  };\n\n  var renderToolbarGroup = function (toolbarGroup) {\n    return ToolbarGroup.sketch(renderToolbarGroupCommon(toolbarGroup));\n  };\n\n  var getToolbarbehaviours = function (toolbarSpec, modeName) {\n    var onAttached = runOnAttached(function (component) {\n      var groups = map(toolbarSpec.initGroups, renderToolbarGroup);\n      Toolbar.setGroups(component, groups);\n    });\n    return derive$1([DisablingConfigs.toolbarButton(toolbarSpec.providers.isDisabled), receivingConfig(), Keying.config({\n      mode: modeName,\n      onEscape: toolbarSpec.onEscape,\n      selector: '.tox-toolbar__group'\n    }), config('toolbar-events', [onAttached])]);\n  };\n\n  var renderMoreToolbarCommon = function (toolbarSpec) {\n    var modeName = toolbarSpec.cyclicKeying ? 'cyclic' : 'acyclic';\n    return {\n      uid: toolbarSpec.uid,\n      dom: {\n        tag: 'div',\n        classes: ['tox-toolbar-overlord']\n      },\n      parts: {\n        'overflow-group': renderToolbarGroupCommon({\n          title: Optional.none(),\n          items: []\n        }),\n        'overflow-button': renderIconButtonSpec({\n          name: 'more',\n          icon: Optional.some('more-drawer'),\n          disabled: false,\n          tooltip: Optional.some('More...'),\n          primary: false,\n          borderless: false\n        }, Optional.none(), toolbarSpec.providers)\n      },\n      splitToolbarBehaviours: getToolbarbehaviours(toolbarSpec, modeName)\n    };\n  };\n\n  var renderFloatingMoreToolbar = function (toolbarSpec) {\n    var baseSpec = renderMoreToolbarCommon(toolbarSpec);\n    var overflowXOffset = 4;\n    var primary = SplitFloatingToolbar.parts.primary({\n      dom: {\n        tag: 'div',\n        classes: ['tox-toolbar__primary']\n      }\n    });\n    return SplitFloatingToolbar.sketch(__assign(__assign({}, baseSpec), {\n      lazySink: toolbarSpec.getSink,\n      getOverflowBounds: function () {\n        var headerElem = toolbarSpec.moreDrawerData.lazyHeader().element;\n        var headerBounds = absolute$1(headerElem);\n        var docElem = documentElement(headerElem);\n        var docBounds = absolute$1(docElem);\n        var height = Math.max(docElem.dom.scrollHeight, docBounds.height);\n        return bounds$1(headerBounds.x + overflowXOffset, docBounds.y, headerBounds.width - overflowXOffset * 2, height);\n      },\n      parts: __assign(__assign({}, baseSpec.parts), {\n        overflow: {\n          dom: {\n            tag: 'div',\n            classes: ['tox-toolbar__overflow'],\n            attributes: toolbarSpec.attributes\n          }\n        }\n      }),\n      components: [primary],\n      markers: {\n        overflowToggledClass: 'tox-tbtn--enabled'\n      }\n    }));\n  };\n\n  var renderSlidingMoreToolbar = function (toolbarSpec) {\n    var primary = SplitSlidingToolbar.parts.primary({\n      dom: {\n        tag: 'div',\n        classes: ['tox-toolbar__primary']\n      }\n    });\n    var overflow = SplitSlidingToolbar.parts.overflow({\n      dom: {\n        tag: 'div',\n        classes: ['tox-toolbar__overflow']\n      }\n    });\n    var baseSpec = renderMoreToolbarCommon(toolbarSpec);\n    return SplitSlidingToolbar.sketch(__assign(__assign({}, baseSpec), {\n      components: [primary, overflow],\n      markers: {\n        openClass: 'tox-toolbar__overflow--open',\n        closedClass: 'tox-toolbar__overflow--closed',\n        growingClass: 'tox-toolbar__overflow--growing',\n        shrinkingClass: 'tox-toolbar__overflow--shrinking',\n        overflowToggledClass: 'tox-tbtn--enabled'\n      },\n      onOpened: function (comp) {\n        comp.getSystem().broadcastOn([toolbarHeightChange()], {\n          type: 'opened'\n        });\n      },\n      onClosed: function (comp) {\n        comp.getSystem().broadcastOn([toolbarHeightChange()], {\n          type: 'closed'\n        });\n      }\n    }));\n  };\n\n  var renderToolbar = function (toolbarSpec) {\n    var modeName = toolbarSpec.cyclicKeying ? 'cyclic' : 'acyclic';\n    return Toolbar.sketch({\n      uid: toolbarSpec.uid,\n      dom: {\n        tag: 'div',\n        classes: ['tox-toolbar'].concat(toolbarSpec.type === ToolbarMode.scrolling ? ['tox-toolbar--scrolling'] : [])\n      },\n      components: [Toolbar.parts.groups({})],\n      toolbarBehaviours: getToolbarbehaviours(toolbarSpec, modeName)\n    });\n  };\n\n  var groupToolbarButtonSchema = objOf([strictString('type'), strictOf('items', oneOf([arrOfObj$1([strictString('name'), strictArrayOf('items', string)]), string]))].concat(baseToolbarButtonFields));\n\n  var createGroupToolbarButton = function (spec) {\n    return asRaw('GroupToolbarButton', groupToolbarButtonSchema, spec);\n  };\n\n  var baseMenuButtonFields = [optionString('text'), optionString('tooltip'), optionString('icon'), strictFunction('fetch'), defaultedFunction('onSetup', function () {\n    return noop;\n  })];\n  var MenuButtonSchema = objOf(__spreadArrays([strictString('type')], baseMenuButtonFields));\n\n  var createMenuButton = function (spec) {\n    return asRaw('menubutton', MenuButtonSchema, spec);\n  };\n\n  var splitButtonSchema = objOf([strictString('type'), optionString('tooltip'), optionString('icon'), optionString('text'), optionFunction('select'), strictFunction('fetch'), defaultedFunction('onSetup', function () {\n    return noop;\n  }), defaultedStringEnum('presets', 'normal', ['normal', 'color', 'listpreview']), defaulted$1('columns', 1), strictFunction('onAction'), strictFunction('onItemAction')]);\n\n  var createSplitButton = function (spec) {\n    return asRaw('SplitButton', splitButtonSchema, spec);\n  };\n\n  var events$e = function (reflectingConfig, reflectingState) {\n    var update = function (component, data) {\n      reflectingConfig.updateState.each(function (updateState) {\n        var newState = updateState(component, data);\n        reflectingState.set(newState);\n      });\n      reflectingConfig.renderComponents.each(function (renderComponents) {\n        var newComponents = renderComponents(data, reflectingState.get());\n        var newChildren = map(newComponents, component.getSystem().build);\n        replaceChildren(component, newChildren);\n      });\n    };\n\n    return derive([run(receive(), function (component, message) {\n      var receivingData = message;\n\n      if (!receivingData.universal) {\n        var channel = reflectingConfig.channel;\n\n        if (contains(receivingData.channels, channel)) {\n          update(component, receivingData.data);\n        }\n      }\n    }), runOnAttached(function (comp, _se) {\n      reflectingConfig.initialData.each(function (rawData) {\n        update(comp, rawData);\n      });\n    })]);\n  };\n\n  var ActiveReflecting = /*#__PURE__*/Object.freeze({\n    __proto__: null,\n    events: events$e\n  });\n\n  var getState$2 = function (component, replaceConfig, reflectState) {\n    return reflectState;\n  };\n\n  var ReflectingApis = /*#__PURE__*/Object.freeze({\n    __proto__: null,\n    getState: getState$2\n  });\n  var ReflectingSchema = [strict$1('channel'), option('renderComponents'), option('updateState'), option('initialData')];\n\n  var init$a = function () {\n    var cell = Cell(Optional.none());\n\n    var set = function (optS) {\n      return cell.set(optS);\n    };\n\n    var clear = function () {\n      return cell.set(Optional.none());\n    };\n\n    var get = function () {\n      return cell.get();\n    };\n\n    var readState = function () {\n      return cell.get().fold(function () {\n        return 'none';\n      }, function (x) {\n        return x;\n      });\n    };\n\n    return {\n      readState: readState,\n      get: get,\n      set: set,\n      clear: clear\n    };\n  };\n\n  var ReflectingState = /*#__PURE__*/Object.freeze({\n    __proto__: null,\n    init: init$a\n  });\n  var Reflecting = create$1({\n    fields: ReflectingSchema,\n    name: 'reflecting',\n    active: ActiveReflecting,\n    apis: ReflectingApis,\n    state: ReflectingState\n  });\n  var schema$q = constant([strict$1('toggleClass'), strict$1('fetch'), onStrictHandler('onExecute'), defaulted$1('getHotspot', Optional.some), defaulted$1('getAnchorOverrides', constant({})), schema$1(), onStrictHandler('onItemExecute'), option('lazySink'), strict$1('dom'), onHandler('onOpen'), field$1('splitDropdownBehaviours', [Coupling, Keying, Focusing]), defaulted$1('matchWidth', false), defaulted$1('useMinWidth', false), defaulted$1('eventOrder', {}), option('role')].concat(sandboxFields()));\n  var arrowPart = required({\n    factory: Button,\n    schema: [strict$1('dom')],\n    name: 'arrow',\n    defaults: function () {\n      return {\n        buttonBehaviours: derive$1([Focusing.revoke()])\n      };\n    },\n    overrides: function (detail) {\n      return {\n        dom: {\n          tag: 'span',\n          attributes: {\n            role: 'presentation'\n          }\n        },\n        action: function (arrow) {\n          arrow.getSystem().getByUid(detail.uid).each(emitExecute);\n        },\n        buttonBehaviours: derive$1([Toggling.config({\n          toggleOnExecute: false,\n          toggleClass: detail.toggleClass\n        })])\n      };\n    }\n  });\n  var buttonPart = required({\n    factory: Button,\n    schema: [strict$1('dom')],\n    name: 'button',\n    defaults: function () {\n      return {\n        buttonBehaviours: derive$1([Focusing.revoke()])\n      };\n    },\n    overrides: function (detail) {\n      return {\n        dom: {\n          tag: 'span',\n          attributes: {\n            role: 'presentation'\n          }\n        },\n        action: function (btn) {\n          btn.getSystem().getByUid(detail.uid).each(function (splitDropdown) {\n            detail.onExecute(splitDropdown, btn);\n          });\n        }\n      };\n    }\n  });\n  var parts$c = constant([arrowPart, buttonPart, optional({\n    factory: {\n      sketch: function (spec) {\n        return {\n          uid: spec.uid,\n          dom: {\n            tag: 'span',\n            styles: {\n              display: 'none'\n            },\n            attributes: {\n              'aria-hidden': 'true'\n            },\n            innerHtml: spec.text\n          }\n        };\n      }\n    },\n    schema: [strict$1('text')],\n    name: 'aria-descriptor'\n  }), external$1({\n    schema: [tieredMenuMarkers()],\n    name: 'menu',\n    defaults: function (detail) {\n      return {\n        onExecute: function (tmenu, item) {\n          tmenu.getSystem().getByUid(detail.uid).each(function (splitDropdown) {\n            detail.onItemExecute(splitDropdown, tmenu, item);\n          });\n        }\n      };\n    }\n  }), partType()]);\n\n  var factory$e = function (detail, components, spec, externals) {\n    var _a;\n\n    var switchToMenu = function (sandbox) {\n      Composing.getCurrent(sandbox).each(function (current) {\n        Highlighting.highlightFirst(current);\n        Keying.focusIn(current);\n      });\n    };\n\n    var action = function (component) {\n      var onOpenSync = switchToMenu;\n      togglePopup(detail, function (x) {\n        return x;\n      }, component, externals, onOpenSync, HighlightOnOpen.HighlightFirst).get(noop);\n    };\n\n    var openMenu = function (comp) {\n      action(comp);\n      return Optional.some(true);\n    };\n\n    var executeOnButton = function (comp) {\n      var button = getPartOrDie(comp, detail, 'button');\n      emitExecute(button);\n      return Optional.some(true);\n    };\n\n    var buttonEvents = __assign(__assign({}, derive([runOnAttached(function (component, _simulatedEvent) {\n      var ariaDescriptor = getPart(component, detail, 'aria-descriptor');\n      ariaDescriptor.each(function (descriptor) {\n        var descriptorId = generate$1('aria');\n        set$1(descriptor.element, 'id', descriptorId);\n        set$1(component.element, 'aria-describedby', descriptorId);\n      });\n    })])), events$7(Optional.some(action)));\n\n    var apis = {\n      repositionMenus: function (comp) {\n        if (Toggling.isOn(comp)) {\n          repositionMenus(comp);\n        }\n      }\n    };\n    return {\n      uid: detail.uid,\n      dom: detail.dom,\n      components: components,\n      apis: apis,\n      eventOrder: __assign(__assign({}, detail.eventOrder), (_a = {}, _a[execute()] = ['disabling', 'toggling', 'alloy.base.behaviour'], _a)),\n      events: buttonEvents,\n      behaviours: augment(detail.splitDropdownBehaviours, [Coupling.config({\n        others: {\n          sandbox: function (hotspot) {\n            var arrow = getPartOrDie(hotspot, detail, 'arrow');\n            var extras = {\n              onOpen: function () {\n                Toggling.on(arrow);\n                Toggling.on(hotspot);\n              },\n              onClose: function () {\n                Toggling.off(arrow);\n                Toggling.off(hotspot);\n              }\n            };\n            return makeSandbox(detail, hotspot, extras);\n          }\n        }\n      }), Keying.config({\n        mode: 'special',\n        onSpace: executeOnButton,\n        onEnter: executeOnButton,\n        onDown: openMenu\n      }), Focusing.config({}), Toggling.config({\n        toggleOnExecute: false,\n        aria: {\n          mode: 'expanded'\n        }\n      })]),\n      domModification: {\n        attributes: {\n          'role': detail.role.getOr('button'),\n          'aria-haspopup': true\n        }\n      }\n    };\n  };\n\n  var SplitDropdown = composite$1({\n    name: 'SplitDropdown',\n    configFields: schema$q(),\n    partFields: parts$c(),\n    factory: factory$e,\n    apis: {\n      repositionMenus: function (apis, comp) {\n        return apis.repositionMenus(comp);\n      }\n    }\n  });\n\n  var getButtonApi = function (component) {\n    return {\n      isDisabled: function () {\n        return Disabling.isDisabled(component);\n      },\n      setDisabled: function (state) {\n        return Disabling.set(component, state);\n      }\n    };\n  };\n\n  var getToggleApi = function (component) {\n    return {\n      setActive: function (state) {\n        Toggling.set(component, state);\n      },\n      isActive: function () {\n        return Toggling.isOn(component);\n      },\n      isDisabled: function () {\n        return Disabling.isDisabled(component);\n      },\n      setDisabled: function (state) {\n        return Disabling.set(component, state);\n      }\n    };\n  };\n\n  var getTooltipAttributes = function (tooltip, providersBackstage) {\n    return tooltip.map(function (tooltip) {\n      return {\n        'aria-label': providersBackstage.translate(tooltip),\n        'title': providersBackstage.translate(tooltip)\n      };\n    }).getOr({});\n  };\n\n  var focusButtonEvent = generate$1('focus-button');\n  var rtlIcon$1 = ['checklist', 'ordered-list'];\n  var rtlTransform$1 = ['indent', 'outdent', 'table-insert-column-after', 'table-insert-column-before', 'unordered-list'];\n\n  var renderCommonStructure = function (icon, text, tooltip, receiver, behaviours, providersBackstage) {\n    var _d;\n\n    var getIconName = function (iconName) {\n      return global$6.isRtl() && contains(rtlIcon$1, iconName) ? iconName + '-rtl' : iconName;\n    };\n\n    var needsRtlClass = global$6.isRtl() && icon.exists(function (name) {\n      return contains(rtlTransform$1, name);\n    });\n    return {\n      dom: {\n        tag: 'button',\n        classes: ['tox-tbtn'].concat(text.isSome() ? ['tox-tbtn--select'] : []).concat(needsRtlClass ? ['tox-tbtn__icon-rtl'] : []),\n        attributes: getTooltipAttributes(tooltip, providersBackstage)\n      },\n      components: componentRenderPipeline([icon.map(function (iconName) {\n        return renderIconFromPack(getIconName(iconName), providersBackstage.icons);\n      }), text.map(function (text) {\n        return renderLabel$1(text, 'tox-tbtn', providersBackstage);\n      })]),\n      eventOrder: (_d = {}, _d[mousedown()] = ['focusing', 'alloy.base.behaviour', 'common-button-display-events'], _d),\n      buttonBehaviours: derive$1([DisablingConfigs.toolbarButton(providersBackstage.isDisabled), receivingConfig(), config('common-button-display-events', [run(mousedown(), function (button, se) {\n        se.event.prevent();\n        emit(button, focusButtonEvent);\n      })])].concat(receiver.map(function (r) {\n        return Reflecting.config({\n          channel: r,\n          initialData: {\n            icon: icon,\n            text: text\n          },\n          renderComponents: function (data, _state) {\n            return componentRenderPipeline([data.icon.map(function (iconName) {\n              return renderIconFromPack(getIconName(iconName), providersBackstage.icons);\n            }), data.text.map(function (text) {\n              return renderLabel$1(text, 'tox-tbtn', providersBackstage);\n            })]);\n          }\n        });\n      }).toArray()).concat(behaviours.getOr([])))\n    };\n  };\n\n  var renderFloatingToolbarButton = function (spec, backstage, identifyButtons, attributes) {\n    var sharedBackstage = backstage.shared;\n    return FloatingToolbarButton.sketch({\n      lazySink: sharedBackstage.getSink,\n      fetch: function () {\n        return Future.nu(function (resolve) {\n          resolve(map(identifyButtons(spec.items), renderToolbarGroup));\n        });\n      },\n      markers: {\n        toggledClass: 'tox-tbtn--enabled'\n      },\n      parts: {\n        button: renderCommonStructure(spec.icon, spec.text, spec.tooltip, Optional.none(), Optional.none(), sharedBackstage.providers),\n        toolbar: {\n          dom: {\n            tag: 'div',\n            classes: ['tox-toolbar__overflow'],\n            attributes: attributes\n          }\n        }\n      }\n    });\n  };\n\n  var renderCommonToolbarButton = function (spec, specialisation, providersBackstage) {\n    var editorOffCell = Cell(noop);\n    var structure = renderCommonStructure(spec.icon, spec.text, spec.tooltip, Optional.none(), Optional.none(), providersBackstage);\n    return Button.sketch({\n      dom: structure.dom,\n      components: structure.components,\n      eventOrder: toolbarButtonEventOrder,\n      buttonBehaviours: derive$1([config('toolbar-button-events', [onToolbarButtonExecute({\n        onAction: spec.onAction,\n        getApi: specialisation.getApi\n      }), onControlAttached(specialisation, editorOffCell), onControlDetached(specialisation, editorOffCell)]), DisablingConfigs.toolbarButton(function () {\n        return spec.disabled || providersBackstage.isDisabled();\n      }), receivingConfig()].concat(specialisation.toolbarButtonBehaviours))\n    });\n  };\n\n  var renderToolbarButton = function (spec, providersBackstage) {\n    return renderToolbarButtonWith(spec, providersBackstage, []);\n  };\n\n  var renderToolbarButtonWith = function (spec, providersBackstage, bonusEvents) {\n    return renderCommonToolbarButton(spec, {\n      toolbarButtonBehaviours: [].concat(bonusEvents.length > 0 ? [config('toolbarButtonWith', bonusEvents)] : []),\n      getApi: getButtonApi,\n      onSetup: spec.onSetup\n    }, providersBackstage);\n  };\n\n  var renderToolbarToggleButton = function (spec, providersBackstage) {\n    return renderToolbarToggleButtonWith(spec, providersBackstage, []);\n  };\n\n  var renderToolbarToggleButtonWith = function (spec, providersBackstage, bonusEvents) {\n    return deepMerge(renderCommonToolbarButton(spec, {\n      toolbarButtonBehaviours: [Replacing.config({}), Toggling.config({\n        toggleClass: 'tox-tbtn--enabled',\n        aria: {\n          mode: 'pressed'\n        },\n        toggleOnExecute: false\n      })].concat(bonusEvents.length > 0 ? [config('toolbarToggleButtonWith', bonusEvents)] : []),\n      getApi: getToggleApi,\n      onSetup: spec.onSetup\n    }, providersBackstage));\n  };\n\n  var fetchChoices = function (getApi, spec, providersBackstage) {\n    return function (comp) {\n      return Future.nu(function (callback) {\n        return spec.fetch(callback);\n      }).map(function (items) {\n        return Optional.from(createTieredDataFrom(deepMerge(createPartialChoiceMenu(generate$1('menu-value'), items, function (value) {\n          spec.onItemAction(getApi(comp), value);\n        }, spec.columns, spec.presets, ItemResponse$1.CLOSE_ON_EXECUTE, spec.select.getOr(never), providersBackstage), {\n          movement: deriveMenuMovement(spec.columns, spec.presets),\n          menuBehaviours: SimpleBehaviours.unnamedEvents(spec.columns !== 'auto' ? [] : [runOnAttached(function (comp, _se) {\n            detectSize(comp, 4, classForPreset(spec.presets)).each(function (_d) {\n              var numRows = _d.numRows,\n                  numColumns = _d.numColumns;\n              Keying.setGridSize(comp, numRows, numColumns);\n            });\n          })])\n        })));\n      });\n    };\n  };\n\n  var renderSplitButton = function (spec, sharedBackstage) {\n    var _d;\n\n    var displayChannel = generate$1('channel-update-split-dropdown-display');\n\n    var getApi = function (comp) {\n      return {\n        isDisabled: function () {\n          return Disabling.isDisabled(comp);\n        },\n        setDisabled: function (state) {\n          return Disabling.set(comp, state);\n        },\n        setIconFill: function (id, value) {\n          descendant$1(comp.element, 'svg path[id=\"' + id + '\"], rect[id=\"' + id + '\"]').each(function (underlinePath) {\n            set$1(underlinePath, 'fill', value);\n          });\n        },\n        setIconStroke: function (id, value) {\n          descendant$1(comp.element, 'svg path[id=\"' + id + '\"], rect[id=\"' + id + '\"]').each(function (underlinePath) {\n            set$1(underlinePath, 'stroke', value);\n          });\n        },\n        setActive: function (state) {\n          if (comp.getSystem().isConnected()) {\n            set$1(comp.element, 'aria-pressed', state);\n            descendant$1(comp.element, 'span').each(function (button) {\n              comp.getSystem().getByDom(button).each(function (buttonComp) {\n                return Toggling.set(buttonComp, state);\n              });\n            });\n          }\n        },\n        isActive: function () {\n          return descendant$1(comp.element, 'span').exists(function (button) {\n            if (comp.getSystem().isConnected()) {\n              return comp.getSystem().getByDom(button).exists(Toggling.isOn);\n            } else {\n              return false;\n            }\n          });\n        }\n      };\n    };\n\n    var editorOffCell = Cell(noop);\n    var specialisation = {\n      getApi: getApi,\n      onSetup: spec.onSetup\n    };\n    return SplitDropdown.sketch({\n      dom: {\n        tag: 'div',\n        classes: ['tox-split-button'],\n        attributes: __assign({\n          'aria-pressed': false\n        }, getTooltipAttributes(spec.tooltip, sharedBackstage.providers))\n      },\n      onExecute: function (button) {\n        spec.onAction(getApi(button));\n      },\n      onItemExecute: function (_a, _b, _c) {},\n      splitDropdownBehaviours: derive$1([DisablingConfigs.splitButton(sharedBackstage.providers.isDisabled), receivingConfig(), config('split-dropdown-events', [run(focusButtonEvent, Focusing.focus), onControlAttached(specialisation, editorOffCell), onControlDetached(specialisation, editorOffCell)]), Unselecting.config({})]),\n      eventOrder: (_d = {}, _d[attachedToDom()] = ['alloy.base.behaviour', 'split-dropdown-events'], _d),\n      toggleClass: 'tox-tbtn--enabled',\n      lazySink: sharedBackstage.getSink,\n      fetch: fetchChoices(getApi, spec, sharedBackstage.providers),\n      parts: {\n        menu: part(false, spec.columns, spec.presets)\n      },\n      components: [SplitDropdown.parts.button(renderCommonStructure(spec.icon, spec.text, Optional.none(), Optional.some(displayChannel), Optional.some([Toggling.config({\n        toggleClass: 'tox-tbtn--enabled',\n        toggleOnExecute: false\n      })]), sharedBackstage.providers)), SplitDropdown.parts.arrow({\n        dom: {\n          tag: 'button',\n          classes: ['tox-tbtn', 'tox-split-button__chevron'],\n          innerHtml: get$e('chevron-down', sharedBackstage.providers.icons)\n        },\n        buttonBehaviours: derive$1([DisablingConfigs.splitButton(sharedBackstage.providers.isDisabled), receivingConfig()])\n      }), SplitDropdown.parts['aria-descriptor']({\n        text: sharedBackstage.providers.translate('To open the popup, press Shift+Enter')\n      })]\n    });\n  };\n\n  var getFormApi = function (input) {\n    return {\n      hide: function () {\n        return emit(input, sandboxClose());\n      },\n      getValue: function () {\n        return Representing.getValue(input);\n      }\n    };\n  };\n\n  var runOnExecute$1 = function (memInput, original) {\n    return run(internalToolbarButtonExecute, function (comp, se) {\n      var input = memInput.get(comp);\n      var formApi = getFormApi(input);\n      original.onAction(formApi, se.event.buttonApi);\n    });\n  };\n\n  var renderContextButton = function (memInput, button, extras) {\n    var _a = button.original,\n        primary = _a.primary,\n        rest = __rest(_a, ['primary']);\n\n    var bridged = getOrDie(createToolbarButton(__assign(__assign({}, rest), {\n      type: 'button',\n      onAction: noop\n    })));\n    return renderToolbarButtonWith(bridged, extras.backstage.shared.providers, [runOnExecute$1(memInput, button)]);\n  };\n\n  var renderContextToggleButton = function (memInput, button, extras) {\n    var _a = button.original,\n        primary = _a.primary,\n        rest = __rest(_a, ['primary']);\n\n    var bridged = getOrDie(createToggleButton(__assign(__assign({}, rest), {\n      type: 'togglebutton',\n      onAction: noop\n    })));\n    return renderToolbarToggleButtonWith(bridged, extras.backstage.shared.providers, [runOnExecute$1(memInput, button)]);\n  };\n\n  var generateOne$1 = function (memInput, button, providersBackstage) {\n    var extras = {\n      backstage: {\n        shared: {\n          providers: providersBackstage\n        }\n      }\n    };\n\n    if (button.type === 'contextformtogglebutton') {\n      return renderContextToggleButton(memInput, button, extras);\n    } else {\n      return renderContextButton(memInput, button, extras);\n    }\n  };\n\n  var generate$7 = function (memInput, buttons, providersBackstage) {\n    var mementos = map(buttons, function (button) {\n      return record(generateOne$1(memInput, button, providersBackstage));\n    });\n\n    var asSpecs = function () {\n      return map(mementos, function (mem) {\n        return mem.asSpec();\n      });\n    };\n\n    var findPrimary = function (compInSystem) {\n      return findMap(buttons, function (button, i) {\n        if (button.primary) {\n          return Optional.from(mementos[i]).bind(function (mem) {\n            return mem.getOpt(compInSystem);\n          }).filter(not(Disabling.isDisabled));\n        } else {\n          return Optional.none();\n        }\n      });\n    };\n\n    return {\n      asSpecs: asSpecs,\n      findPrimary: findPrimary\n    };\n  };\n\n  var buildInitGroups = function (ctx, providers) {\n    var inputAttributes = ctx.label.fold(function () {\n      return {};\n    }, function (label) {\n      return {\n        'aria-label': label\n      };\n    });\n    var memInput = record(Input.sketch({\n      inputClasses: ['tox-toolbar-textfield', 'tox-toolbar-nav-js'],\n      data: ctx.initValue(),\n      inputAttributes: inputAttributes,\n      selectOnFocus: true,\n      inputBehaviours: derive$1([Keying.config({\n        mode: 'special',\n        onEnter: function (input) {\n          return commands.findPrimary(input).map(function (primary) {\n            emitExecute(primary);\n            return true;\n          });\n        },\n        onLeft: function (comp, se) {\n          se.cut();\n          return Optional.none();\n        },\n        onRight: function (comp, se) {\n          se.cut();\n          return Optional.none();\n        }\n      })])\n    }));\n    var commands = generate$7(memInput, ctx.commands, providers);\n    return [{\n      title: Optional.none(),\n      items: [memInput.asSpec()]\n    }, {\n      title: Optional.none(),\n      items: commands.asSpecs()\n    }];\n  };\n\n  var renderContextForm = function (toolbarType, ctx, providers) {\n    return renderToolbar({\n      type: toolbarType,\n      uid: generate$1('context-toolbar'),\n      initGroups: buildInitGroups(ctx, providers),\n      onEscape: Optional.none,\n      cyclicKeying: true,\n      providers: providers\n    });\n  };\n\n  var ContextForm = {\n    renderContextForm: renderContextForm,\n    buildInitGroups: buildInitGroups\n  };\n\n  var getHorizontalBounds = function (contentAreaBox, viewportBounds) {\n    var x = Math.max(viewportBounds.x, contentAreaBox.x);\n    var contentBoxWidth = contentAreaBox.right - x;\n    var maxViewportWidth = viewportBounds.width - (x - viewportBounds.x);\n    var width = Math.min(contentBoxWidth, maxViewportWidth);\n    return {\n      x: x,\n      width: width\n    };\n  };\n\n  var getVerticalBounds = function (editor, contentAreaBox, viewportBounds, isToolbarLocationTop) {\n    var container = SugarElement.fromDom(editor.getContainer());\n    var header = descendant$1(container, '.tox-editor-header').getOr(container);\n    var headerBox = box(header);\n    var isToolbarBelowContentArea = headerBox.y >= contentAreaBox.bottom;\n    var isToolbarAbove = isToolbarLocationTop && !isToolbarBelowContentArea;\n\n    if (editor.inline && isToolbarAbove) {\n      return {\n        y: Math.max(headerBox.bottom, viewportBounds.y),\n        bottom: viewportBounds.bottom\n      };\n    }\n\n    if (editor.inline && !isToolbarAbove) {\n      return {\n        y: viewportBounds.y,\n        bottom: Math.min(headerBox.y, viewportBounds.bottom)\n      };\n    }\n\n    var containerBounds = box(container);\n\n    if (isToolbarAbove) {\n      return {\n        y: Math.max(headerBox.bottom, viewportBounds.y),\n        bottom: Math.min(containerBounds.bottom, viewportBounds.bottom)\n      };\n    }\n\n    return {\n      y: Math.max(containerBounds.y, viewportBounds.y),\n      bottom: Math.min(headerBox.y, viewportBounds.bottom)\n    };\n  };\n\n  var getContextToolbarBounds = function (editor, sharedBackstage) {\n    var viewportBounds = getBounds(window);\n    var contentAreaBox = box(SugarElement.fromDom(editor.getContentAreaContainer()));\n    var toolbarOrMenubarEnabled = isMenubarEnabled(editor) || isToolbarEnabled(editor) || isMultipleToolbars(editor);\n\n    var _a = getHorizontalBounds(contentAreaBox, viewportBounds),\n        x = _a.x,\n        width = _a.width;\n\n    if (editor.inline && !toolbarOrMenubarEnabled) {\n      return bounds$1(x, viewportBounds.y, width, viewportBounds.height);\n    } else {\n      var isToolbarTop = sharedBackstage.header.isPositionedAtTop();\n\n      var _b = getVerticalBounds(editor, contentAreaBox, viewportBounds, isToolbarTop),\n          y = _b.y,\n          bottom = _b.bottom;\n\n      return bounds$1(x, y, width, bottom - y);\n    }\n  };\n\n  var matchTargetWith = function (elem, candidates) {\n    var ctxs = filter(candidates, function (toolbarApi) {\n      return toolbarApi.predicate(elem.dom);\n    });\n\n    var _a = partition(ctxs, function (t) {\n      return t.type === 'contexttoolbar';\n    }),\n        pass = _a.pass,\n        fail = _a.fail;\n\n    return {\n      contextToolbars: pass,\n      contextForms: fail\n    };\n  };\n\n  var filterByPositionForStartNode = function (toolbars) {\n    if (toolbars.length <= 1) {\n      return toolbars;\n    } else {\n      var doesPositionExist = function (value) {\n        return exists(toolbars, function (t) {\n          return t.position === value;\n        });\n      };\n\n      var filterToolbarsByPosition = function (value) {\n        return filter(toolbars, function (t) {\n          return t.position === value;\n        });\n      };\n\n      var hasSelectionToolbars = doesPositionExist('selection');\n      var hasNodeToolbars = doesPositionExist('node');\n\n      if (hasSelectionToolbars || hasNodeToolbars) {\n        if (hasNodeToolbars && hasSelectionToolbars) {\n          var nodeToolbars = filterToolbarsByPosition('node');\n          var selectionToolbars = map(filterToolbarsByPosition('selection'), function (t) {\n            return __assign(__assign({}, t), {\n              position: 'node'\n            });\n          });\n          return nodeToolbars.concat(selectionToolbars);\n        } else {\n          return hasSelectionToolbars ? filterToolbarsByPosition('selection') : filterToolbarsByPosition('node');\n        }\n      } else {\n        return filterToolbarsByPosition('line');\n      }\n    }\n  };\n\n  var filterByPositionForAncestorNode = function (toolbars) {\n    if (toolbars.length <= 1) {\n      return toolbars;\n    } else {\n      var findPosition_1 = function (value) {\n        return find(toolbars, function (t) {\n          return t.position === value;\n        });\n      };\n\n      var basePosition = findPosition_1('selection').orThunk(function () {\n        return findPosition_1('node');\n      }).orThunk(function () {\n        return findPosition_1('line');\n      }).map(function (t) {\n        return t.position;\n      });\n      return basePosition.fold(function () {\n        return [];\n      }, function (pos) {\n        return filter(toolbars, function (t) {\n          return t.position === pos;\n        });\n      });\n    }\n  };\n\n  var matchStartNode = function (elem, nodeCandidates, editorCandidates) {\n    var nodeMatches = matchTargetWith(elem, nodeCandidates);\n\n    if (nodeMatches.contextForms.length > 0) {\n      return Optional.some({\n        elem: elem,\n        toolbars: [nodeMatches.contextForms[0]]\n      });\n    } else {\n      var editorMatches = matchTargetWith(elem, editorCandidates);\n\n      if (editorMatches.contextForms.length > 0) {\n        return Optional.some({\n          elem: elem,\n          toolbars: [editorMatches.contextForms[0]]\n        });\n      } else if (nodeMatches.contextToolbars.length > 0 || editorMatches.contextToolbars.length > 0) {\n        var toolbars = filterByPositionForStartNode(nodeMatches.contextToolbars.concat(editorMatches.contextToolbars));\n        return Optional.some({\n          elem: elem,\n          toolbars: toolbars\n        });\n      } else {\n        return Optional.none();\n      }\n    }\n  };\n\n  var matchAncestor = function (isRoot, startNode, scopes) {\n    if (isRoot(startNode)) {\n      return Optional.none();\n    } else {\n      return ancestor(startNode, function (ancestorElem) {\n        var _a = matchTargetWith(ancestorElem, scopes.inNodeScope),\n            contextToolbars = _a.contextToolbars,\n            contextForms = _a.contextForms;\n\n        var toolbars = contextForms.length > 0 ? contextForms : filterByPositionForAncestorNode(contextToolbars);\n        return toolbars.length > 0 ? Optional.some({\n          elem: ancestorElem,\n          toolbars: toolbars\n        }) : Optional.none();\n      }, isRoot);\n    }\n  };\n\n  var lookup$1 = function (scopes, editor) {\n    var rootElem = SugarElement.fromDom(editor.getBody());\n\n    var isRoot = function (elem) {\n      return eq$1(elem, rootElem);\n    };\n\n    var isOutsideRoot = function (startNode) {\n      return !isRoot(startNode) && !contains$2(rootElem, startNode);\n    };\n\n    var startNode = SugarElement.fromDom(editor.selection.getNode());\n\n    if (isOutsideRoot(startNode)) {\n      return Optional.none();\n    }\n\n    return matchStartNode(startNode, scopes.inNodeScope, scopes.inEditorScope).orThunk(function () {\n      return matchAncestor(isRoot, startNode, scopes);\n    });\n  };\n\n  var categorise = function (contextToolbars, navigate) {\n    var forms = {};\n    var inNodeScope = [];\n    var inEditorScope = [];\n    var formNavigators = {};\n    var lookupTable = {};\n\n    var registerForm = function (key, toolbarSpec) {\n      var contextForm = getOrDie(createContextForm(toolbarSpec));\n      forms[key] = contextForm;\n      contextForm.launch.map(function (launch) {\n        formNavigators['form:' + key + ''] = __assign(__assign({}, toolbarSpec.launch), {\n          type: launch.type === 'contextformtogglebutton' ? 'togglebutton' : 'button',\n          onAction: function () {\n            navigate(contextForm);\n          }\n        });\n      });\n\n      if (contextForm.scope === 'editor') {\n        inEditorScope.push(contextForm);\n      } else {\n        inNodeScope.push(contextForm);\n      }\n\n      lookupTable[key] = contextForm;\n    };\n\n    var registerToolbar = function (key, toolbarSpec) {\n      createContextToolbar(toolbarSpec).each(function (contextToolbar) {\n        if (toolbarSpec.scope === 'editor') {\n          inEditorScope.push(contextToolbar);\n        } else {\n          inNodeScope.push(contextToolbar);\n        }\n\n        lookupTable[key] = contextToolbar;\n      });\n    };\n\n    var keys$1 = keys(contextToolbars);\n    each(keys$1, function (key) {\n      var toolbarApi = contextToolbars[key];\n\n      if (toolbarApi.type === 'contextform') {\n        registerForm(key, toolbarApi);\n      } else if (toolbarApi.type === 'contexttoolbar') {\n        registerToolbar(key, toolbarApi);\n      }\n    });\n    return {\n      forms: forms,\n      inNodeScope: inNodeScope,\n      inEditorScope: inEditorScope,\n      lookupTable: lookupTable,\n      formNavigators: formNavigators\n    };\n  };\n\n  var forwardSlideEvent = generate$1('forward-slide');\n  var backSlideEvent = generate$1('backward-slide');\n  var changeSlideEvent = generate$1('change-slide-event');\n  var resizingClass = 'tox-pop--resizing';\n\n  var renderContextToolbar = function (spec) {\n    var stack = Cell([]);\n    return InlineView.sketch({\n      dom: {\n        tag: 'div',\n        classes: ['tox-pop']\n      },\n      fireDismissalEventInstead: {\n        event: 'doNotDismissYet'\n      },\n      onShow: function (comp) {\n        stack.set([]);\n        InlineView.getContent(comp).each(function (c) {\n          remove$6(c.element, 'visibility');\n        });\n        remove$4(comp.element, resizingClass);\n        remove$6(comp.element, 'width');\n      },\n      inlineBehaviours: derive$1([config('context-toolbar-events', [runOnSource(transitionend(), function (comp, _se) {\n        remove$4(comp.element, resizingClass);\n        remove$6(comp.element, 'width');\n      }), run(changeSlideEvent, function (comp, se) {\n        var elem = comp.element;\n        remove$6(elem, 'width');\n        var currentWidth = get$8(elem);\n        InlineView.setContent(comp, se.event.contents);\n        add$2(elem, resizingClass);\n        var newWidth = get$8(elem);\n        set$2(elem, 'width', currentWidth + 'px');\n        InlineView.getContent(comp).each(function (newContents) {\n          se.event.focus.bind(function (f) {\n            focus$1(f);\n            return search(elem);\n          }).orThunk(function () {\n            Keying.focusIn(newContents);\n            return active(getRootNode(elem));\n          });\n        });\n        global$2.setTimeout(function () {\n          set$2(comp.element, 'width', newWidth + 'px');\n        }, 0);\n      }), run(forwardSlideEvent, function (comp, se) {\n        InlineView.getContent(comp).each(function (oldContents) {\n          stack.set(stack.get().concat([{\n            bar: oldContents,\n            focus: active(getRootNode(comp.element))\n          }]));\n        });\n        emitWith(comp, changeSlideEvent, {\n          contents: se.event.forwardContents,\n          focus: Optional.none()\n        });\n      }), run(backSlideEvent, function (comp, _se) {\n        last(stack.get()).each(function (last) {\n          stack.set(stack.get().slice(0, stack.get().length - 1));\n          emitWith(comp, changeSlideEvent, {\n            contents: premade$1(last.bar),\n            focus: last.focus\n          });\n        });\n      })]), Keying.config({\n        mode: 'special',\n        onEscape: function (comp) {\n          return last(stack.get()).fold(function () {\n            return spec.onEscape();\n          }, function (_) {\n            emit(comp, backSlideEvent);\n            return Optional.some(true);\n          });\n        }\n      })]),\n      lazySink: function () {\n        return Result.value(spec.sink);\n      }\n    });\n  };\n\n  var generateSelectItems = function (_editor, backstage, spec) {\n    var generateItem = function (rawItem, response, disabled, value) {\n      var translatedText = backstage.shared.providers.translate(rawItem.title);\n\n      if (rawItem.type === 'separator') {\n        return Optional.some({\n          type: 'separator',\n          text: translatedText\n        });\n      } else if (rawItem.type === 'submenu') {\n        var items = bind(rawItem.getStyleItems(), function (si) {\n          return validate(si, response, value);\n        });\n\n        if (response === 0 && items.length <= 0) {\n          return Optional.none();\n        } else {\n          return Optional.some({\n            type: 'nestedmenuitem',\n            text: translatedText,\n            disabled: items.length <= 0,\n            getSubmenuItems: function () {\n              return bind(rawItem.getStyleItems(), function (si) {\n                return validate(si, response, value);\n              });\n            }\n          });\n        }\n      } else {\n        return Optional.some(__assign({\n          type: 'togglemenuitem',\n          text: translatedText,\n          icon: rawItem.icon,\n          active: rawItem.isSelected(value),\n          disabled: disabled,\n          onAction: spec.onAction(rawItem)\n        }, rawItem.getStylePreview().fold(function () {\n          return {};\n        }, function (preview) {\n          return {\n            meta: {\n              style: preview\n            }\n          };\n        })));\n      }\n    };\n\n    var validate = function (item, response, value) {\n      var invalid = item.type === 'formatter' && spec.isInvalid(item);\n\n      if (response === 0) {\n        return invalid ? [] : generateItem(item, response, false, value).toArray();\n      } else {\n        return generateItem(item, response, invalid, value).toArray();\n      }\n    };\n\n    var validateItems = function (preItems) {\n      var value = spec.getCurrentValue();\n      var response = spec.shouldHide ? 0 : 1;\n      return bind(preItems, function (item) {\n        return validate(item, response, value);\n      });\n    };\n\n    var getFetch = function (backstage, getStyleItems) {\n      return function (comp, callback) {\n        var preItems = getStyleItems();\n        var items = validateItems(preItems);\n        var menu = build$2(items, ItemResponse$1.CLOSE_ON_EXECUTE, backstage, false);\n        callback(menu);\n      };\n    };\n\n    return {\n      validateItems: validateItems,\n      getFetch: getFetch\n    };\n  };\n\n  var createMenuItems = function (editor, backstage, spec) {\n    var dataset = spec.dataset;\n    var getStyleItems = dataset.type === 'basic' ? function () {\n      return map(dataset.data, function (d) {\n        return processBasic(d, spec.isSelectedFor, spec.getPreviewFor);\n      });\n    } : dataset.getData;\n    return {\n      items: generateSelectItems(editor, backstage, spec),\n      getStyleItems: getStyleItems\n    };\n  };\n\n  var createSelectButton = function (editor, backstage, spec) {\n    var _a = createMenuItems(editor, backstage, spec),\n        items = _a.items,\n        getStyleItems = _a.getStyleItems;\n\n    var getApi = function (comp) {\n      return {\n        getComponent: constant(comp)\n      };\n    };\n\n    var onSetup = function (api) {\n      var updateText = function () {\n        var comp = api.getComponent();\n\n        if (comp.getSystem().isConnected()) {\n          spec.updateText(comp);\n        }\n      };\n\n      updateText();\n      editor.on('NodeChange', updateText);\n      return function () {\n        editor.off('NodeChange', updateText);\n      };\n    };\n\n    return renderCommonDropdown({\n      text: spec.icon.isSome() ? Optional.none() : Optional.some(''),\n      icon: spec.icon,\n      tooltip: Optional.from(spec.tooltip),\n      role: Optional.none(),\n      fetch: items.getFetch(backstage, getStyleItems),\n      onSetup: onSetup,\n      getApi: getApi,\n      columns: 1,\n      presets: 'normal',\n      classes: spec.icon.isSome() ? [] : ['bespoke'],\n      dropdownBehaviours: []\n    }, 'tox-tbtn', backstage.shared);\n  };\n\n  var process = function (rawFormats) {\n    return map(rawFormats, function (item) {\n      var title = item,\n          format = item;\n      var values = item.split('=');\n\n      if (values.length > 1) {\n        title = values[0];\n        format = values[1];\n      }\n\n      return {\n        title: title,\n        format: format\n      };\n    });\n  };\n\n  var buildBasicStaticDataset = function (data) {\n    return {\n      type: 'basic',\n      data: data\n    };\n  };\n\n  var Delimiter;\n\n  (function (Delimiter) {\n    Delimiter[Delimiter['SemiColon'] = 0] = 'SemiColon';\n    Delimiter[Delimiter['Space'] = 1] = 'Space';\n  })(Delimiter || (Delimiter = {}));\n\n  var split = function (rawFormats, delimiter) {\n    if (delimiter === Delimiter.SemiColon) {\n      return rawFormats.replace(/;$/, '').split(';');\n    } else {\n      return rawFormats.split(' ');\n    }\n  };\n\n  var buildBasicSettingsDataset = function (editor, settingName, defaults, delimiter) {\n    var rawFormats = editor.getParam(settingName, defaults, 'string');\n    var data = process(split(rawFormats, delimiter));\n    return {\n      type: 'basic',\n      data: data\n    };\n  };\n\n  var alignMenuItems = [{\n    title: 'Left',\n    icon: 'align-left',\n    format: 'alignleft',\n    command: 'JustifyLeft'\n  }, {\n    title: 'Center',\n    icon: 'align-center',\n    format: 'aligncenter',\n    command: 'JustifyCenter'\n  }, {\n    title: 'Right',\n    icon: 'align-right',\n    format: 'alignright',\n    command: 'JustifyRight'\n  }, {\n    title: 'Justify',\n    icon: 'align-justify',\n    format: 'alignjustify',\n    command: 'JustifyFull'\n  }];\n\n  var getSpec = function (editor) {\n    var getMatchingValue = function () {\n      return find(alignMenuItems, function (item) {\n        return editor.formatter.match(item.format);\n      });\n    };\n\n    var isSelectedFor = function (format) {\n      return function () {\n        return editor.formatter.match(format);\n      };\n    };\n\n    var getPreviewFor = function (_format) {\n      return function () {\n        return Optional.none();\n      };\n    };\n\n    var updateSelectMenuIcon = function (comp) {\n      var match = getMatchingValue();\n      var alignment = match.fold(function () {\n        return 'left';\n      }, function (item) {\n        return item.title.toLowerCase();\n      });\n      emitWith(comp, updateMenuIcon, {\n        icon: 'align-' + alignment\n      });\n    };\n\n    var dataset = buildBasicStaticDataset(alignMenuItems);\n\n    var onAction = function (rawItem) {\n      return function () {\n        return find(alignMenuItems, function (item) {\n          return item.format === rawItem.format;\n        }).each(function (item) {\n          return editor.execCommand(item.command);\n        });\n      };\n    };\n\n    return {\n      tooltip: 'Align',\n      icon: Optional.some('align-left'),\n      isSelectedFor: isSelectedFor,\n      getCurrentValue: Optional.none,\n      getPreviewFor: getPreviewFor,\n      onAction: onAction,\n      updateText: updateSelectMenuIcon,\n      dataset: dataset,\n      shouldHide: false,\n      isInvalid: function (item) {\n        return !editor.formatter.canApply(item.format);\n      }\n    };\n  };\n\n  var createAlignSelect = function (editor, backstage) {\n    return createSelectButton(editor, backstage, getSpec(editor));\n  };\n\n  var alignSelectMenu = function (editor, backstage) {\n    var menuItems = createMenuItems(editor, backstage, getSpec(editor));\n    editor.ui.registry.addNestedMenuItem('align', {\n      text: backstage.shared.providers.translate('Align'),\n      getSubmenuItems: function () {\n        return menuItems.items.validateItems(menuItems.getStyleItems());\n      }\n    });\n  };\n\n  var defaultFontsFormats = 'Andale Mono=andale mono,monospace;' + 'Arial=arial,helvetica,sans-serif;' + 'Arial Black=arial black,sans-serif;' + 'Book Antiqua=book antiqua,palatino,serif;' + 'Comic Sans MS=comic sans ms,sans-serif;' + 'Courier New=courier new,courier,monospace;' + 'Georgia=georgia,palatino,serif;' + 'Helvetica=helvetica,arial,sans-serif;' + 'Impact=impact,sans-serif;' + 'Symbol=symbol;' + 'Tahoma=tahoma,arial,helvetica,sans-serif;' + 'Terminal=terminal,monaco,monospace;' + 'Times New Roman=times new roman,times,serif;' + 'Trebuchet MS=trebuchet ms,geneva,sans-serif;' + 'Verdana=verdana,geneva,sans-serif;' + 'Webdings=webdings;' + 'Wingdings=wingdings,zapf dingbats';\n  var systemStackFonts = ['-apple-system', 'Segoe UI', 'Roboto', 'Helvetica Neue', 'sans-serif'];\n\n  var splitFonts = function (fontFamily) {\n    var fonts = fontFamily.split(/\\s*,\\s*/);\n    return map(fonts, function (font) {\n      return font.replace(/^['\"]+|['\"]+$/g, '');\n    });\n  };\n\n  var isSystemFontStack = function (fontFamily) {\n    var matchesSystemStack = function () {\n      var fonts = splitFonts(fontFamily.toLowerCase());\n      return forall(systemStackFonts, function (font) {\n        return fonts.indexOf(font.toLowerCase()) > -1;\n      });\n    };\n\n    return fontFamily.indexOf('-apple-system') === 0 && matchesSystemStack();\n  };\n\n  var getSpec$1 = function (editor) {\n    var getMatchingValue = function () {\n      var getFirstFont = function (fontFamily) {\n        return fontFamily ? splitFonts(fontFamily)[0] : '';\n      };\n\n      var fontFamily = editor.queryCommandValue('FontName');\n      var items = dataset.data;\n      var font = fontFamily ? fontFamily.toLowerCase() : '';\n      var matchOpt = find(items, function (item) {\n        var format = item.format;\n        return format.toLowerCase() === font || getFirstFont(format).toLowerCase() === getFirstFont(font).toLowerCase();\n      }).orThunk(function () {\n        if (isSystemFontStack(font)) {\n          return Optional.from({\n            title: 'System Font',\n            format: font\n          });\n        } else {\n          return Optional.none();\n        }\n      });\n      return {\n        matchOpt: matchOpt,\n        font: fontFamily\n      };\n    };\n\n    var isSelectedFor = function (item) {\n      return function (valueOpt) {\n        return valueOpt.exists(function (value) {\n          return value.format === item;\n        });\n      };\n    };\n\n    var getCurrentValue = function () {\n      var matchOpt = getMatchingValue().matchOpt;\n      return matchOpt;\n    };\n\n    var getPreviewFor = function (item) {\n      return function () {\n        return Optional.some({\n          tag: 'div',\n          styles: item.indexOf('dings') === -1 ? {\n            'font-family': item\n          } : {}\n        });\n      };\n    };\n\n    var onAction = function (rawItem) {\n      return function () {\n        editor.undoManager.transact(function () {\n          editor.focus();\n          editor.execCommand('FontName', false, rawItem.format);\n        });\n      };\n    };\n\n    var updateSelectMenuText = function (comp) {\n      var _a = getMatchingValue(),\n          matchOpt = _a.matchOpt,\n          font = _a.font;\n\n      var text = matchOpt.fold(function () {\n        return font;\n      }, function (item) {\n        return item.title;\n      });\n      emitWith(comp, updateMenuText, {\n        text: text\n      });\n    };\n\n    var dataset = buildBasicSettingsDataset(editor, 'font_formats', defaultFontsFormats, Delimiter.SemiColon);\n    return {\n      tooltip: 'Fonts',\n      icon: Optional.none(),\n      isSelectedFor: isSelectedFor,\n      getCurrentValue: getCurrentValue,\n      getPreviewFor: getPreviewFor,\n      onAction: onAction,\n      updateText: updateSelectMenuText,\n      dataset: dataset,\n      shouldHide: false,\n      isInvalid: never\n    };\n  };\n\n  var createFontSelect = function (editor, backstage) {\n    return createSelectButton(editor, backstage, getSpec$1(editor));\n  };\n\n  var fontSelectMenu = function (editor, backstage) {\n    var menuItems = createMenuItems(editor, backstage, getSpec$1(editor));\n    editor.ui.registry.addNestedMenuItem('fontformats', {\n      text: backstage.shared.providers.translate('Fonts'),\n      getSubmenuItems: function () {\n        return menuItems.items.validateItems(menuItems.getStyleItems());\n      }\n    });\n  };\n\n  var defaultFontsizeFormats = '8pt 10pt 12pt 14pt 18pt 24pt 36pt';\n  var legacyFontSizes = {\n    '8pt': '1',\n    '10pt': '2',\n    '12pt': '3',\n    '14pt': '4',\n    '18pt': '5',\n    '24pt': '6',\n    '36pt': '7'\n  };\n  var keywordFontSizes = {\n    'xx-small': '7pt',\n    'x-small': '8pt',\n    'small': '10pt',\n    'medium': '12pt',\n    'large': '14pt',\n    'x-large': '18pt',\n    'xx-large': '24pt'\n  };\n\n  var round$1 = function (number, precision) {\n    var factor = Math.pow(10, precision);\n    return Math.round(number * factor) / factor;\n  };\n\n  var toPt = function (fontSize, precision) {\n    if (/[0-9.]+px$/.test(fontSize)) {\n      return round$1(parseInt(fontSize, 10) * 72 / 96, precision || 0) + 'pt';\n    } else {\n      return get$1(keywordFontSizes, fontSize).getOr(fontSize);\n    }\n  };\n\n  var toLegacy = function (fontSize) {\n    return get$1(legacyFontSizes, fontSize).getOr('');\n  };\n\n  var getSpec$2 = function (editor) {\n    var getMatchingValue = function () {\n      var matchOpt = Optional.none();\n      var items = dataset.data;\n      var fontSize = editor.queryCommandValue('FontSize');\n\n      if (fontSize) {\n        var _loop_1 = function (precision) {\n          var pt = toPt(fontSize, precision);\n          var legacy = toLegacy(pt);\n          matchOpt = find(items, function (item) {\n            return item.format === fontSize || item.format === pt || item.format === legacy;\n          });\n        };\n\n        for (var precision = 3; matchOpt.isNone() && precision >= 0; precision--) {\n          _loop_1(precision);\n        }\n      }\n\n      return {\n        matchOpt: matchOpt,\n        size: fontSize\n      };\n    };\n\n    var isSelectedFor = function (item) {\n      return function (valueOpt) {\n        return valueOpt.exists(function (value) {\n          return value.format === item;\n        });\n      };\n    };\n\n    var getCurrentValue = function () {\n      var matchOpt = getMatchingValue().matchOpt;\n      return matchOpt;\n    };\n\n    var getPreviewFor = constant(Optional.none);\n\n    var onAction = function (rawItem) {\n      return function () {\n        editor.undoManager.transact(function () {\n          editor.focus();\n          editor.execCommand('FontSize', false, rawItem.format);\n        });\n      };\n    };\n\n    var updateSelectMenuText = function (comp) {\n      var _a = getMatchingValue(),\n          matchOpt = _a.matchOpt,\n          size = _a.size;\n\n      var text = matchOpt.fold(function () {\n        return size;\n      }, function (match) {\n        return match.title;\n      });\n      emitWith(comp, updateMenuText, {\n        text: text\n      });\n    };\n\n    var dataset = buildBasicSettingsDataset(editor, 'fontsize_formats', defaultFontsizeFormats, Delimiter.Space);\n    return {\n      tooltip: 'Font sizes',\n      icon: Optional.none(),\n      isSelectedFor: isSelectedFor,\n      getPreviewFor: getPreviewFor,\n      getCurrentValue: getCurrentValue,\n      onAction: onAction,\n      updateText: updateSelectMenuText,\n      dataset: dataset,\n      shouldHide: false,\n      isInvalid: never\n    };\n  };\n\n  var createFontsizeSelect = function (editor, backstage) {\n    return createSelectButton(editor, backstage, getSpec$2(editor));\n  };\n\n  var fontsizeSelectMenu = function (editor, backstage) {\n    var menuItems = createMenuItems(editor, backstage, getSpec$2(editor));\n    editor.ui.registry.addNestedMenuItem('fontsizes', {\n      text: 'Font sizes',\n      getSubmenuItems: function () {\n        return menuItems.items.validateItems(menuItems.getStyleItems());\n      }\n    });\n  };\n\n  var findNearest = function (editor, getStyles) {\n    var styles = getStyles();\n    var formats = map(styles, function (style) {\n      return style.format;\n    });\n    return Optional.from(editor.formatter.closest(formats)).bind(function (fmt) {\n      return find(styles, function (data) {\n        return data.format === fmt;\n      });\n    }).orThunk(function () {\n      return someIf(editor.formatter.match('p'), {\n        title: 'Paragraph',\n        format: 'p'\n      });\n    });\n  };\n\n  var revocable = function (doRevoke) {\n    var subject = Cell(Optional.none());\n\n    var revoke = function () {\n      return subject.get().each(doRevoke);\n    };\n\n    var clear = function () {\n      revoke();\n      subject.set(Optional.none());\n    };\n\n    var isSet = function () {\n      return subject.get().isSome();\n    };\n\n    var set = function (s) {\n      revoke();\n      subject.set(Optional.some(s));\n    };\n\n    return {\n      clear: clear,\n      isSet: isSet,\n      set: set\n    };\n  };\n\n  var destroyable = function () {\n    return revocable(function (s) {\n      return s.destroy();\n    });\n  };\n\n  var unbindable = function () {\n    return revocable(function (s) {\n      return s.unbind();\n    });\n  };\n\n  var value$3 = function () {\n    var subject = Cell(Optional.none());\n\n    var clear = function () {\n      return subject.set(Optional.none());\n    };\n\n    var set = function (s) {\n      return subject.set(Optional.some(s));\n    };\n\n    var isSet = function () {\n      return subject.get().isSome();\n    };\n\n    var on = function (f) {\n      return subject.get().each(f);\n    };\n\n    return {\n      clear: clear,\n      set: set,\n      isSet: isSet,\n      on: on\n    };\n  };\n\n  var onSetupFormatToggle = function (editor, name) {\n    return function (api) {\n      var boundCallback = unbindable();\n\n      var init = function () {\n        api.setActive(editor.formatter.match(name));\n        var binding = editor.formatter.formatChanged(name, api.setActive);\n        boundCallback.set(binding);\n      };\n\n      editor.initialized ? init() : editor.on('init', init);\n      return boundCallback.clear;\n    };\n  };\n\n  var onActionToggleFormat = function (editor) {\n    return function (rawItem) {\n      return function () {\n        editor.undoManager.transact(function () {\n          editor.focus();\n          editor.execCommand('mceToggleFormat', false, rawItem.format);\n        });\n      };\n    };\n  };\n\n  var defaultBlocks = 'Paragraph=p;' + 'Heading 1=h1;' + 'Heading 2=h2;' + 'Heading 3=h3;' + 'Heading 4=h4;' + 'Heading 5=h5;' + 'Heading 6=h6;' + 'Preformatted=pre';\n\n  var getSpec$3 = function (editor) {\n    var isSelectedFor = function (format) {\n      return function () {\n        return editor.formatter.match(format);\n      };\n    };\n\n    var getPreviewFor = function (format) {\n      return function () {\n        var fmt = editor.formatter.get(format);\n        return Optional.some({\n          tag: fmt.length > 0 ? fmt[0].inline || fmt[0].block || 'div' : 'div',\n          styles: editor.dom.parseStyle(editor.formatter.getCssText(format))\n        });\n      };\n    };\n\n    var updateSelectMenuText = function (comp) {\n      var detectedFormat = findNearest(editor, function () {\n        return dataset.data;\n      });\n      var text = detectedFormat.fold(function () {\n        return 'Paragraph';\n      }, function (fmt) {\n        return fmt.title;\n      });\n      emitWith(comp, updateMenuText, {\n        text: text\n      });\n    };\n\n    var dataset = buildBasicSettingsDataset(editor, 'block_formats', defaultBlocks, Delimiter.SemiColon);\n    return {\n      tooltip: 'Blocks',\n      icon: Optional.none(),\n      isSelectedFor: isSelectedFor,\n      getCurrentValue: Optional.none,\n      getPreviewFor: getPreviewFor,\n      onAction: onActionToggleFormat(editor),\n      updateText: updateSelectMenuText,\n      dataset: dataset,\n      shouldHide: false,\n      isInvalid: function (item) {\n        return !editor.formatter.canApply(item.format);\n      }\n    };\n  };\n\n  var createFormatSelect = function (editor, backstage) {\n    return createSelectButton(editor, backstage, getSpec$3(editor));\n  };\n\n  var formatSelectMenu = function (editor, backstage) {\n    var menuItems = createMenuItems(editor, backstage, getSpec$3(editor));\n    editor.ui.registry.addNestedMenuItem('blockformats', {\n      text: 'Blocks',\n      getSubmenuItems: function () {\n        return menuItems.items.validateItems(menuItems.getStyleItems());\n      }\n    });\n  };\n\n  var getSpec$4 = function (editor, dataset) {\n    var isSelectedFor = function (format) {\n      return function () {\n        return editor.formatter.match(format);\n      };\n    };\n\n    var getPreviewFor = function (format) {\n      return function () {\n        var fmt = editor.formatter.get(format);\n        return fmt !== undefined ? Optional.some({\n          tag: fmt.length > 0 ? fmt[0].inline || fmt[0].block || 'div' : 'div',\n          styles: editor.dom.parseStyle(editor.formatter.getCssText(format))\n        }) : Optional.none();\n      };\n    };\n\n    var updateSelectMenuText = function (comp) {\n      var getFormatItems = function (fmt) {\n        var subs = fmt.items;\n        return subs !== undefined && subs.length > 0 ? bind(subs, getFormatItems) : [{\n          title: fmt.title,\n          format: fmt.format\n        }];\n      };\n\n      var flattenedItems = bind(getStyleFormats(editor), getFormatItems);\n      var detectedFormat = findNearest(editor, function () {\n        return flattenedItems;\n      });\n      var text = detectedFormat.fold(function () {\n        return 'Paragraph';\n      }, function (fmt) {\n        return fmt.title;\n      });\n      emitWith(comp, updateMenuText, {\n        text: text\n      });\n    };\n\n    return {\n      tooltip: 'Formats',\n      icon: Optional.none(),\n      isSelectedFor: isSelectedFor,\n      getCurrentValue: Optional.none,\n      getPreviewFor: getPreviewFor,\n      onAction: onActionToggleFormat(editor),\n      updateText: updateSelectMenuText,\n      shouldHide: editor.getParam('style_formats_autohide', false, 'boolean'),\n      isInvalid: function (item) {\n        return !editor.formatter.canApply(item.format);\n      },\n      dataset: dataset\n    };\n  };\n\n  var createStyleSelect = function (editor, backstage) {\n    var dataset = __assign({\n      type: 'advanced'\n    }, backstage.styleselect);\n\n    return createSelectButton(editor, backstage, getSpec$4(editor, dataset));\n  };\n\n  var styleSelectMenu = function (editor, backstage) {\n    var dataset = __assign({\n      type: 'advanced'\n    }, backstage.styleselect);\n\n    var menuItems = createMenuItems(editor, backstage, getSpec$4(editor, dataset));\n    editor.ui.registry.addNestedMenuItem('formats', {\n      text: 'Formats',\n      getSubmenuItems: function () {\n        return menuItems.items.validateItems(menuItems.getStyleItems());\n      }\n    });\n  };\n\n  var defaultToolbar = [{\n    name: 'history',\n    items: ['undo', 'redo']\n  }, {\n    name: 'styles',\n    items: ['styleselect']\n  }, {\n    name: 'formatting',\n    items: ['bold', 'italic']\n  }, {\n    name: 'alignment',\n    items: ['alignleft', 'aligncenter', 'alignright', 'alignjustify']\n  }, {\n    name: 'indentation',\n    items: ['outdent', 'indent']\n  }, {\n    name: 'permanent pen',\n    items: ['permanentpen']\n  }, {\n    name: 'comments',\n    items: ['addcomment']\n  }];\n\n  var renderFromBridge = function (bridgeBuilder, render) {\n    return function (spec, extras, editor) {\n      var internal = bridgeBuilder(spec).mapError(function (errInfo) {\n        return formatError(errInfo);\n      }).getOrDie();\n      return render(internal, extras, editor);\n    };\n  };\n\n  var types = {\n    button: renderFromBridge(createToolbarButton, function (s, extras) {\n      return renderToolbarButton(s, extras.backstage.shared.providers);\n    }),\n    togglebutton: renderFromBridge(createToggleButton, function (s, extras) {\n      return renderToolbarToggleButton(s, extras.backstage.shared.providers);\n    }),\n    menubutton: renderFromBridge(createMenuButton, function (s, extras) {\n      return renderMenuButton(s, 'tox-tbtn', extras.backstage, Optional.none());\n    }),\n    splitbutton: renderFromBridge(createSplitButton, function (s, extras) {\n      return renderSplitButton(s, extras.backstage.shared);\n    }),\n    grouptoolbarbutton: renderFromBridge(createGroupToolbarButton, function (s, extras, editor) {\n      var _a;\n\n      var buttons = editor.ui.registry.getAll().buttons;\n\n      var identify = function (toolbar) {\n        return identifyButtons(editor, {\n          buttons: buttons,\n          toolbar: toolbar,\n          allowToolbarGroups: false\n        }, extras, Optional.none());\n      };\n\n      var attributes = (_a = {}, _a[Attribute] = extras.backstage.shared.header.isPositionedAtTop() ? AttributeValue.TopToBottom : AttributeValue.BottomToTop, _a);\n\n      switch (getToolbarMode(editor)) {\n        case ToolbarMode.floating:\n          return renderFloatingToolbarButton(s, extras.backstage, identify, attributes);\n\n        default:\n          throw new Error('Toolbar groups are only supported when using floating toolbar mode');\n      }\n    }),\n    styleSelectButton: function (editor, extras) {\n      return createStyleSelect(editor, extras.backstage);\n    },\n    fontsizeSelectButton: function (editor, extras) {\n      return createFontsizeSelect(editor, extras.backstage);\n    },\n    fontSelectButton: function (editor, extras) {\n      return createFontSelect(editor, extras.backstage);\n    },\n    formatButton: function (editor, extras) {\n      return createFormatSelect(editor, extras.backstage);\n    },\n    alignMenuButton: function (editor, extras) {\n      return createAlignSelect(editor, extras.backstage);\n    }\n  };\n\n  var extractFrom = function (spec, extras, editor) {\n    return get$1(types, spec.type).fold(function () {\n      console.error('skipping button defined by', spec);\n      return Optional.none();\n    }, function (render) {\n      return Optional.some(render(spec, extras, editor));\n    });\n  };\n\n  var bespokeButtons = {\n    styleselect: types.styleSelectButton,\n    fontsizeselect: types.fontsizeSelectButton,\n    fontselect: types.fontSelectButton,\n    formatselect: types.formatButton,\n    align: types.alignMenuButton\n  };\n\n  var removeUnusedDefaults = function (buttons) {\n    var filteredItemGroups = map(defaultToolbar, function (group) {\n      var items = filter(group.items, function (subItem) {\n        return has(buttons, subItem) || has(bespokeButtons, subItem);\n      });\n      return {\n        name: group.name,\n        items: items\n      };\n    });\n    return filter(filteredItemGroups, function (group) {\n      return group.items.length > 0;\n    });\n  };\n\n  var convertStringToolbar = function (strToolbar) {\n    var groupsStrings = strToolbar.split('|');\n    return map(groupsStrings, function (g) {\n      return {\n        items: g.trim().split(' ')\n      };\n    });\n  };\n\n  var isToolbarGroupSettingArray = function (toolbar) {\n    return isArrayOf(toolbar, function (t) {\n      return has(t, 'name') && has(t, 'items');\n    });\n  };\n\n  var createToolbar = function (toolbarConfig) {\n    var toolbar = toolbarConfig.toolbar;\n    var buttons = toolbarConfig.buttons;\n\n    if (toolbar === false) {\n      return [];\n    } else if (toolbar === undefined || toolbar === true) {\n      return removeUnusedDefaults(buttons);\n    } else if (isString(toolbar)) {\n      return convertStringToolbar(toolbar);\n    } else if (isToolbarGroupSettingArray(toolbar)) {\n      return toolbar;\n    } else {\n      console.error('Toolbar type should be string, string[], boolean or ToolbarGroup[]');\n      return [];\n    }\n  };\n\n  var lookupButton = function (editor, buttons, toolbarItem, allowToolbarGroups, extras, prefixes) {\n    return get$1(buttons, toolbarItem.toLowerCase()).orThunk(function () {\n      return prefixes.bind(function (ps) {\n        return findMap(ps, function (prefix) {\n          return get$1(buttons, prefix + toolbarItem.toLowerCase());\n        });\n      });\n    }).fold(function () {\n      return get$1(bespokeButtons, toolbarItem.toLowerCase()).map(function (r) {\n        return r(editor, extras);\n      }).orThunk(function () {\n        return Optional.none();\n      });\n    }, function (spec) {\n      if (spec.type === 'grouptoolbarbutton' && !allowToolbarGroups) {\n        console.warn('Ignoring the \\'' + toolbarItem + '\\' toolbar button. Group toolbar buttons are only supported when using floating toolbar mode and cannot be nested.');\n        return Optional.none();\n      } else {\n        return extractFrom(spec, extras, editor);\n      }\n    });\n  };\n\n  var identifyButtons = function (editor, toolbarConfig, extras, prefixes) {\n    var toolbarGroups = createToolbar(toolbarConfig);\n    var groups = map(toolbarGroups, function (group) {\n      var items = bind(group.items, function (toolbarItem) {\n        return toolbarItem.trim().length === 0 ? [] : lookupButton(editor, toolbarConfig.buttons, toolbarItem, toolbarConfig.allowToolbarGroups, extras, prefixes).toArray();\n      });\n      return {\n        title: Optional.from(editor.translate(group.name)),\n        items: items\n      };\n    });\n    return filter(groups, function (group) {\n      return group.items.length > 0;\n    });\n  };\n\n  var bubbleSize = 12;\n  var bubbleAlignments$1 = {\n    valignCentre: [],\n    alignCentre: [],\n    alignLeft: ['tox-pop--align-left'],\n    alignRight: ['tox-pop--align-right'],\n    right: ['tox-pop--right'],\n    left: ['tox-pop--left'],\n    bottom: ['tox-pop--bottom'],\n    top: ['tox-pop--top']\n  };\n  var anchorOverrides = {\n    maxHeightFunction: expandable(),\n    maxWidthFunction: expandable$1()\n  };\n  var desktopAnchorSpecLayouts = {\n    onLtr: function () {\n      return [north$1, south$1, northeast$1, southeast$1, northwest$1, southwest$1, north$3, south$3, northeast$3, southeast$3, northwest$3, southwest$3];\n    },\n    onRtl: function () {\n      return [north$1, south$1, northwest$1, southwest$1, northeast$1, southeast$1, north$3, south$3, northwest$3, southwest$3, northeast$3, southeast$3];\n    }\n  };\n  var mobileAnchorSpecLayouts = {\n    onLtr: function () {\n      return [south$1, southeast$1, southwest$1, northeast$1, northwest$1, north$1, north$3, south$3, northeast$3, southeast$3, northwest$3, southwest$3];\n    },\n    onRtl: function () {\n      return [south$1, southwest$1, southeast$1, northwest$1, northeast$1, north$1, north$3, south$3, northwest$3, southwest$3, northeast$3, southeast$3];\n    }\n  };\n\n  var getAnchorLayout = function (position, isTouch) {\n    if (position === 'line') {\n      return {\n        bubble: nu$8(bubbleSize, 0, bubbleAlignments$1),\n        layouts: {\n          onLtr: function () {\n            return [east$1];\n          },\n          onRtl: function () {\n            return [west$1];\n          }\n        },\n        overrides: anchorOverrides\n      };\n    } else {\n      return {\n        bubble: nu$8(0, bubbleSize, bubbleAlignments$1),\n        layouts: isTouch ? mobileAnchorSpecLayouts : desktopAnchorSpecLayouts,\n        overrides: anchorOverrides\n      };\n    }\n  };\n\n  var register$4 = function (editor, registryContextToolbars, sink, extras) {\n    var isTouch = detect$3().deviceType.isTouch;\n    var contextbar = build$1(renderContextToolbar({\n      sink: sink,\n      onEscape: function () {\n        editor.focus();\n        return Optional.some(true);\n      }\n    }));\n\n    var getBounds = function () {\n      return getContextToolbarBounds(editor, extras.backstage.shared);\n    };\n\n    var isRangeOverlapping = function (aTop, aBottom, bTop, bBottom) {\n      return Math.max(aTop, bTop) <= Math.min(aBottom, bBottom);\n    };\n\n    var getLastElementVerticalBound = function () {\n      var nodeBounds = lastElement.get().filter(function (ele) {\n        return inBody(SugarElement.fromDom(ele));\n      }).map(function (ele) {\n        return ele.getBoundingClientRect();\n      }).getOrThunk(function () {\n        return editor.selection.getRng().getBoundingClientRect();\n      });\n      var diffTop = editor.inline ? get$9().top : absolute$1(SugarElement.fromDom(editor.getBody())).y;\n      return {\n        y: nodeBounds.top + diffTop,\n        bottom: nodeBounds.bottom + diffTop\n      };\n    };\n\n    var shouldContextToolbarHide = function () {\n      if (isTouch() && extras.backstage.isContextMenuOpen()) {\n        return true;\n      }\n\n      var lastElementBounds = getLastElementVerticalBound();\n      var contextToolbarBounds = getBounds();\n      return !isRangeOverlapping(lastElementBounds.y, lastElementBounds.bottom, contextToolbarBounds.y, contextToolbarBounds.bottom);\n    };\n\n    var close = function () {\n      lastAnchor.set(Optional.none());\n      InlineView.hide(contextbar);\n    };\n\n    var forceHide = function () {\n      InlineView.hide(contextbar);\n    };\n\n    var hideOrRepositionIfNecessary = function () {\n      lastAnchor.get().each(function (anchor) {\n        var contextBarEle = contextbar.element;\n        remove$6(contextBarEle, 'display');\n\n        if (shouldContextToolbarHide()) {\n          set$2(contextBarEle, 'display', 'none');\n        } else {\n          Positioning.positionWithinBounds(sink, anchor, contextbar, Optional.some(getBounds()));\n        }\n      });\n    };\n\n    var lastAnchor = Cell(Optional.none());\n    var lastElement = Cell(Optional.none());\n    var timer = Cell(null);\n\n    var wrapInPopDialog = function (toolbarSpec) {\n      return {\n        dom: {\n          tag: 'div',\n          classes: ['tox-pop__dialog']\n        },\n        components: [toolbarSpec],\n        behaviours: derive$1([Keying.config({\n          mode: 'acyclic'\n        }), config('pop-dialog-wrap-events', [runOnAttached(function (comp) {\n          editor.shortcuts.add('ctrl+F9', 'focus statusbar', function () {\n            return Keying.focusIn(comp);\n          });\n        }), runOnDetached(function (_comp) {\n          editor.shortcuts.remove('ctrl+F9');\n        })])])\n      };\n    };\n\n    var getScopes = cached(function () {\n      return categorise(registryContextToolbars, function (toolbarApi) {\n        var alloySpec = buildToolbar([toolbarApi]);\n        emitWith(contextbar, forwardSlideEvent, {\n          forwardContents: wrapInPopDialog(alloySpec)\n        });\n      });\n    });\n\n    var buildContextToolbarGroups = function (allButtons, ctx) {\n      return identifyButtons(editor, {\n        buttons: allButtons,\n        toolbar: ctx.items,\n        allowToolbarGroups: false\n      }, extras, Optional.some(['form:']));\n    };\n\n    var buildContextMenuGroups = function (ctx, providers) {\n      return ContextForm.buildInitGroups(ctx, providers);\n    };\n\n    var buildToolbar = function (toolbars) {\n      var buttons = editor.ui.registry.getAll().buttons;\n      var scopes = getScopes();\n\n      var allButtons = __assign(__assign({}, buttons), scopes.formNavigators);\n\n      var toolbarType = getToolbarMode(editor) === ToolbarMode.scrolling ? ToolbarMode.scrolling : ToolbarMode.default;\n      var initGroups = flatten(map(toolbars, function (ctx) {\n        return ctx.type === 'contexttoolbar' ? buildContextToolbarGroups(allButtons, ctx) : buildContextMenuGroups(ctx, extras.backstage.shared.providers);\n      }));\n      return renderToolbar({\n        type: toolbarType,\n        uid: generate$1('context-toolbar'),\n        initGroups: initGroups,\n        onEscape: Optional.none,\n        cyclicKeying: true,\n        providers: extras.backstage.shared.providers\n      });\n    };\n\n    editor.on(showContextToolbarEvent, function (e) {\n      var scopes = getScopes();\n      get$1(scopes.lookupTable, e.toolbarKey).each(function (ctx) {\n        launchContext([ctx], e.target === editor ? Optional.none() : Optional.some(e));\n        InlineView.getContent(contextbar).each(Keying.focusIn);\n      });\n    });\n\n    var getAnchor = function (position, element) {\n      var anchorage = position === 'node' ? extras.backstage.shared.anchors.node(element) : extras.backstage.shared.anchors.cursor();\n      return deepMerge(anchorage, getAnchorLayout(position, isTouch()));\n    };\n\n    var launchContext = function (toolbarApi, elem) {\n      clearTimer();\n\n      if (isTouch() && extras.backstage.isContextMenuOpen()) {\n        return;\n      }\n\n      var toolbarSpec = buildToolbar(toolbarApi);\n      var sElem = elem.map(SugarElement.fromDom);\n      var anchor = getAnchor(toolbarApi[0].position, sElem);\n      lastAnchor.set(Optional.some(anchor));\n      lastElement.set(elem);\n      var contextBarEle = contextbar.element;\n      remove$6(contextBarEle, 'display');\n      InlineView.showWithinBounds(contextbar, anchor, wrapInPopDialog(toolbarSpec), function () {\n        return Optional.some(getBounds());\n      });\n\n      if (shouldContextToolbarHide()) {\n        set$2(contextBarEle, 'display', 'none');\n      }\n    };\n\n    var launchContextToolbar = function () {\n      if (!editor.hasFocus()) {\n        return;\n      }\n\n      var scopes = getScopes();\n      lookup$1(scopes, editor).fold(close, function (info) {\n        launchContext(info.toolbars, Optional.some(info.elem.dom));\n      });\n    };\n\n    var clearTimer = function () {\n      var current = timer.get();\n\n      if (current !== null) {\n        global$2.clearTimeout(current);\n        timer.set(null);\n      }\n    };\n\n    var asyncOpen = function () {\n      clearTimer();\n      timer.set(global$2.setEditorTimeout(editor, launchContextToolbar, 0));\n    };\n\n    editor.on('init', function () {\n      editor.on(hideContextToolbarEvent, forceHide);\n      editor.on('ScrollContent ScrollWindow longpress', hideOrRepositionIfNecessary);\n      editor.on('click keyup focus SetContent ObjectResized ResizeEditor', function () {\n        asyncOpen();\n      });\n      editor.on('focusout', function (_e) {\n        global$2.setEditorTimeout(editor, function () {\n          if (search(sink.element).isNone() && search(contextbar.element).isNone()) {\n            close();\n          }\n        }, 0);\n      });\n      editor.on('SwitchMode', function () {\n        if (editor.mode.isReadOnly()) {\n          close();\n        }\n      });\n      editor.on('AfterProgressState', function (event) {\n        if (event.state) {\n          close();\n        } else if (editor.hasFocus()) {\n          asyncOpen();\n        }\n      });\n      editor.on('NodeChange', function (_e) {\n        search(contextbar.element).fold(asyncOpen, noop);\n      });\n    });\n  };\n\n  var setup$3 = function (editor, mothership, uiMothership) {\n    var broadcastEvent = function (name, evt) {\n      each([mothership, uiMothership], function (ship) {\n        ship.broadcastEvent(name, evt);\n      });\n    };\n\n    var broadcastOn = function (channel, message) {\n      each([mothership, uiMothership], function (ship) {\n        ship.broadcastOn([channel], message);\n      });\n    };\n\n    var fireDismissPopups = function (evt) {\n      return broadcastOn(dismissPopups(), {\n        target: evt.target\n      });\n    };\n\n    var onTouchstart = bind$3(SugarElement.fromDom(document), 'touchstart', fireDismissPopups);\n    var onTouchmove = bind$3(SugarElement.fromDom(document), 'touchmove', function (evt) {\n      return broadcastEvent(documentTouchmove(), evt);\n    });\n    var onTouchend = bind$3(SugarElement.fromDom(document), 'touchend', function (evt) {\n      return broadcastEvent(documentTouchend(), evt);\n    });\n    var onMousedown = bind$3(SugarElement.fromDom(document), 'mousedown', fireDismissPopups);\n    var onMouseup = bind$3(SugarElement.fromDom(document), 'mouseup', function (evt) {\n      if (evt.raw.button === 0) {\n        broadcastOn(mouseReleased(), {\n          target: evt.target\n        });\n      }\n    });\n\n    var onContentClick = function (raw) {\n      return broadcastOn(dismissPopups(), {\n        target: SugarElement.fromDom(raw.target)\n      });\n    };\n\n    var onContentMouseup = function (raw) {\n      if (raw.button === 0) {\n        broadcastOn(mouseReleased(), {\n          target: SugarElement.fromDom(raw.target)\n        });\n      }\n    };\n\n    var onWindowScroll = function (evt) {\n      return broadcastEvent(windowScroll(), fromRawEvent$1(evt));\n    };\n\n    var onWindowResize = function (evt) {\n      broadcastOn(repositionPopups(), {});\n      broadcastEvent(windowResize(), fromRawEvent$1(evt));\n    };\n\n    var onEditorResize = function () {\n      return broadcastOn(repositionPopups(), {});\n    };\n\n    var onEditorProgress = function (evt) {\n      if (evt.state) {\n        broadcastOn(dismissPopups(), {\n          target: SugarElement.fromDom(editor.getContainer())\n        });\n      }\n    };\n\n    editor.on('PostRender', function () {\n      editor.on('click', onContentClick);\n      editor.on('tap', onContentClick);\n      editor.on('mouseup', onContentMouseup);\n      editor.on('ScrollWindow', onWindowScroll);\n      editor.on('ResizeWindow', onWindowResize);\n      editor.on('ResizeEditor', onEditorResize);\n      editor.on('AfterProgressState', onEditorProgress);\n    });\n    editor.on('remove', function () {\n      editor.off('click', onContentClick);\n      editor.off('tap', onContentClick);\n      editor.off('mouseup', onContentMouseup);\n      editor.off('ScrollWindow', onWindowScroll);\n      editor.off('ResizeWindow', onWindowResize);\n      editor.off('ResizeEditor', onEditorResize);\n      editor.off('AfterProgressState', onEditorProgress);\n      onMousedown.unbind();\n      onTouchstart.unbind();\n      onTouchmove.unbind();\n      onTouchend.unbind();\n      onMouseup.unbind();\n    });\n    editor.on('detach', function () {\n      detachSystem(mothership);\n      detachSystem(uiMothership);\n      mothership.destroy();\n      uiMothership.destroy();\n    });\n  };\n\n  var parts$d = AlloyParts;\n  var partType$1 = PartType;\n  var schema$r = constant([defaulted$1('shell', false), strict$1('makeItem'), defaulted$1('setupItem', noop), SketchBehaviours.field('listBehaviours', [Replacing])]);\n\n  var customListDetail = function () {\n    return {\n      behaviours: derive$1([Replacing.config({})])\n    };\n  };\n\n  var itemsPart = optional({\n    name: 'items',\n    overrides: customListDetail\n  });\n  var parts$e = constant([itemsPart]);\n  var name$2 = constant('CustomList');\n\n  var factory$f = function (detail, components, _spec, _external) {\n    var setItems = function (list, items) {\n      getListContainer(list).fold(function () {\n        console.error('Custom List was defined to not be a shell, but no item container was specified in components');\n        throw new Error('Custom List was defined to not be a shell, but no item container was specified in components');\n      }, function (container) {\n        var itemComps = Replacing.contents(container);\n        var numListsRequired = items.length;\n        var numListsToAdd = numListsRequired - itemComps.length;\n        var itemsToAdd = numListsToAdd > 0 ? range(numListsToAdd, function () {\n          return detail.makeItem();\n        }) : [];\n        var itemsToRemove = itemComps.slice(numListsRequired);\n        each(itemsToRemove, function (item) {\n          return Replacing.remove(container, item);\n        });\n        each(itemsToAdd, function (item) {\n          return Replacing.append(container, item);\n        });\n        var builtLists = Replacing.contents(container);\n        each(builtLists, function (item, i) {\n          detail.setupItem(list, item, items[i], i);\n        });\n      });\n    };\n\n    var extra = detail.shell ? {\n      behaviours: [Replacing.config({})],\n      components: []\n    } : {\n      behaviours: [],\n      components: components\n    };\n\n    var getListContainer = function (component) {\n      return detail.shell ? Optional.some(component) : getPart(component, detail, 'items');\n    };\n\n    return {\n      uid: detail.uid,\n      dom: detail.dom,\n      components: extra.components,\n      behaviours: augment(detail.listBehaviours, extra.behaviours),\n      apis: {\n        setItems: setItems\n      }\n    };\n  };\n\n  var CustomList = composite$1({\n    name: name$2(),\n    configFields: schema$r(),\n    partFields: parts$e(),\n    factory: factory$f,\n    apis: {\n      setItems: function (apis, list, items) {\n        apis.setItems(list, items);\n      }\n    }\n  });\n  var setup$4 = noop;\n  var isDocked = never;\n  var getBehaviours$2 = constant([]);\n  var StaticHeader = /*#__PURE__*/Object.freeze({\n    __proto__: null,\n    setup: setup$4,\n    isDocked: isDocked,\n    getBehaviours: getBehaviours$2\n  });\n\n  var getOffsetParent = function (element) {\n    var isFixed = getRaw(element, 'position').is('fixed');\n    var offsetParent$1 = isFixed ? Optional.none() : offsetParent(element);\n    return offsetParent$1.orThunk(function () {\n      var marker = SugarElement.fromTag('span');\n      return parent(element).bind(function (parent) {\n        append(parent, marker);\n        var offsetParent$1 = offsetParent(marker);\n        remove(marker);\n        return offsetParent$1;\n      });\n    });\n  };\n\n  var getOrigin = function (element) {\n    return getOffsetParent(element).map(absolute).getOrThunk(function () {\n      return SugarPosition(0, 0);\n    });\n  };\n\n  var morphAdt = Adt.generate([{\n    static: []\n  }, {\n    absolute: ['positionCss']\n  }, {\n    fixed: ['positionCss']\n  }]);\n\n  var appear = function (component, contextualInfo) {\n    var elem = component.element;\n    add$2(elem, contextualInfo.transitionClass);\n    remove$4(elem, contextualInfo.fadeOutClass);\n    add$2(elem, contextualInfo.fadeInClass);\n    contextualInfo.onShow(component);\n  };\n\n  var disappear = function (component, contextualInfo) {\n    var elem = component.element;\n    add$2(elem, contextualInfo.transitionClass);\n    remove$4(elem, contextualInfo.fadeInClass);\n    add$2(elem, contextualInfo.fadeOutClass);\n    contextualInfo.onHide(component);\n  };\n\n  var isPartiallyVisible = function (box, viewport) {\n    return box.y < viewport.bottom && box.bottom > viewport.y;\n  };\n\n  var isTopCompletelyVisible = function (box, viewport) {\n    return box.y >= viewport.y;\n  };\n\n  var isBottomCompletelyVisible = function (box, viewport) {\n    return box.bottom <= viewport.bottom;\n  };\n\n  var isVisibleForModes = function (modes, box, viewport) {\n    return forall(modes, function (mode) {\n      switch (mode) {\n        case 'bottom':\n          return isBottomCompletelyVisible(box, viewport);\n\n        case 'top':\n          return isTopCompletelyVisible(box, viewport);\n      }\n    });\n  };\n\n  var getPrior = function (elem, state) {\n    return state.getInitialPosition().map(function (pos) {\n      return bounds$1(pos.bounds.x, pos.bounds.y, get$8(elem), get$7(elem));\n    });\n  };\n\n  var storePrior = function (elem, box, state) {\n    state.setInitialPosition(Optional.some({\n      style: getAllRaw(elem),\n      position: get$5(elem, 'position') || 'static',\n      bounds: box\n    }));\n  };\n\n  var revertToOriginal = function (elem, box$1, state) {\n    return state.getInitialPosition().bind(function (position) {\n      state.setInitialPosition(Optional.none());\n\n      switch (position.position) {\n        case 'static':\n          return Optional.some(morphAdt.static());\n\n        case 'absolute':\n          var offsetBox_1 = getOffsetParent(elem).map(box).getOrThunk(function () {\n            return box(body());\n          });\n          return Optional.some(morphAdt.absolute(NuPositionCss('absolute', get$1(position.style, 'left').map(function (_left) {\n            return box$1.x - offsetBox_1.x;\n          }), get$1(position.style, 'top').map(function (_top) {\n            return box$1.y - offsetBox_1.y;\n          }), get$1(position.style, 'right').map(function (_right) {\n            return offsetBox_1.right - box$1.right;\n          }), get$1(position.style, 'bottom').map(function (_bottom) {\n            return offsetBox_1.bottom - box$1.bottom;\n          }))));\n\n        default:\n          return Optional.none();\n      }\n    });\n  };\n\n  var morphToOriginal = function (elem, viewport, state) {\n    return getPrior(elem, state).filter(function (box) {\n      return isVisibleForModes(state.getModes(), box, viewport);\n    }).bind(function (box) {\n      return revertToOriginal(elem, box, state);\n    });\n  };\n\n  var morphToFixed = function (elem, viewport, state) {\n    var box$1 = box(elem);\n\n    if (!isVisibleForModes(state.getModes(), box$1, viewport)) {\n      storePrior(elem, box$1, state);\n      var winBox = win();\n      var left = box$1.x - winBox.x;\n      var top_1 = viewport.y - winBox.y;\n      var bottom = winBox.bottom - viewport.bottom;\n      var isTop = box$1.y <= viewport.y;\n      return Optional.some(morphAdt.fixed(NuPositionCss('fixed', Optional.some(left), isTop ? Optional.some(top_1) : Optional.none(), Optional.none(), !isTop ? Optional.some(bottom) : Optional.none())));\n    } else {\n      return Optional.none();\n    }\n  };\n\n  var getMorph = function (component, viewport, state) {\n    var elem = component.element;\n    var isDocked = getRaw(elem, 'position').is('fixed');\n    return isDocked ? morphToOriginal(elem, viewport, state) : morphToFixed(elem, viewport, state);\n  };\n\n  var getMorphToOriginal = function (component, state) {\n    var elem = component.element;\n    return getPrior(elem, state).bind(function (box) {\n      return revertToOriginal(elem, box, state);\n    });\n  };\n\n  var morphToStatic = function (component, config) {\n    each(['left', 'right', 'top', 'bottom', 'position'], function (prop) {\n      return remove$6(component.element, prop);\n    });\n    config.onUndocked(component);\n  };\n\n  var morphToCoord = function (component, config, position) {\n    applyPositionCss(component.element, position);\n    var method = position.position === 'fixed' ? config.onDocked : config.onUndocked;\n    method(component);\n  };\n\n  var updateVisibility = function (component, config, state, viewport, morphToDocked) {\n    if (morphToDocked === void 0) {\n      morphToDocked = false;\n    }\n\n    config.contextual.each(function (contextInfo) {\n      contextInfo.lazyContext(component).each(function (box) {\n        var isVisible = isPartiallyVisible(box, viewport);\n\n        if (isVisible !== state.isVisible()) {\n          state.setVisible(isVisible);\n\n          if (morphToDocked && !isVisible) {\n            add$3(component.element, [contextInfo.fadeOutClass]);\n            contextInfo.onHide(component);\n          } else {\n            var method = isVisible ? appear : disappear;\n            method(component, contextInfo);\n          }\n        }\n      });\n    });\n  };\n\n  var refreshInternal = function (component, config, state) {\n    var viewport = config.lazyViewport(component);\n    var isDocked = state.isDocked();\n\n    if (isDocked) {\n      updateVisibility(component, config, state, viewport);\n    }\n\n    getMorph(component, viewport, state).each(function (morph) {\n      state.setDocked(!isDocked);\n      morph.fold(function () {\n        return morphToStatic(component, config);\n      }, function (position) {\n        return morphToCoord(component, config, position);\n      }, function (position) {\n        updateVisibility(component, config, state, viewport, true);\n        morphToCoord(component, config, position);\n      });\n    });\n  };\n\n  var resetInternal = function (component, config, state) {\n    var elem = component.element;\n    state.setDocked(false);\n    getMorphToOriginal(component, state).each(function (morph) {\n      morph.fold(function () {\n        return morphToStatic(component, config);\n      }, function (position) {\n        return morphToCoord(component, config, position);\n      }, noop);\n    });\n    state.setVisible(true);\n    config.contextual.each(function (contextInfo) {\n      remove$5(elem, [contextInfo.fadeInClass, contextInfo.fadeOutClass, contextInfo.transitionClass]);\n      contextInfo.onShow(component);\n    });\n    refresh$4(component, config, state);\n  };\n\n  var refresh$4 = function (component, config, state) {\n    if (component.getSystem().isConnected()) {\n      refreshInternal(component, config, state);\n    }\n  };\n\n  var reset = function (component, config, state) {\n    if (state.isDocked()) {\n      resetInternal(component, config, state);\n    }\n  };\n\n  var isDocked$1 = function (component, config, state) {\n    return state.isDocked();\n  };\n\n  var setModes = function (component, config, state, modes) {\n    return state.setModes(modes);\n  };\n\n  var getModes = function (component, config, state) {\n    return state.getModes();\n  };\n\n  var DockingApis = /*#__PURE__*/Object.freeze({\n    __proto__: null,\n    refresh: refresh$4,\n    reset: reset,\n    isDocked: isDocked$1,\n    getModes: getModes,\n    setModes: setModes\n  });\n\n  var events$f = function (dockInfo, dockState) {\n    return derive([runOnSource(transitionend(), function (component, simulatedEvent) {\n      dockInfo.contextual.each(function (contextInfo) {\n        if (has$2(component.element, contextInfo.transitionClass)) {\n          remove$5(component.element, [contextInfo.transitionClass, contextInfo.fadeInClass]);\n          var notify = dockState.isVisible() ? contextInfo.onShown : contextInfo.onHidden;\n          notify(component);\n        }\n\n        simulatedEvent.stop();\n      });\n    }), run(windowScroll(), function (component, _) {\n      refresh$4(component, dockInfo, dockState);\n    }), run(windowResize(), function (component, _) {\n      reset(component, dockInfo, dockState);\n    })]);\n  };\n\n  var ActiveDocking = /*#__PURE__*/Object.freeze({\n    __proto__: null,\n    events: events$f\n  });\n  var DockingSchema = [optionObjOf('contextual', [strictString('fadeInClass'), strictString('fadeOutClass'), strictString('transitionClass'), strictFunction('lazyContext'), onHandler('onShow'), onHandler('onShown'), onHandler('onHide'), onHandler('onHidden')]), defaultedFunction('lazyViewport', win), defaultedArrayOf('modes', ['top', 'bottom'], string), onHandler('onDocked'), onHandler('onUndocked')];\n\n  var init$b = function (spec) {\n    var docked = Cell(false);\n    var visible = Cell(true);\n    var initialBounds = Cell(Optional.none());\n    var modes = Cell(spec.modes);\n\n    var readState = function () {\n      return 'docked:  ' + docked.get() + ', visible: ' + visible.get() + ', modes: ' + modes.get().join(',');\n    };\n\n    return nu$5({\n      isDocked: docked.get,\n      setDocked: docked.set,\n      getInitialPosition: initialBounds.get,\n      setInitialPosition: initialBounds.set,\n      isVisible: visible.get,\n      setVisible: visible.set,\n      getModes: modes.get,\n      setModes: modes.set,\n      readState: readState\n    });\n  };\n\n  var DockingState = /*#__PURE__*/Object.freeze({\n    __proto__: null,\n    init: init$b\n  });\n  var Docking = create$1({\n    fields: DockingSchema,\n    name: 'docking',\n    active: ActiveDocking,\n    apis: DockingApis,\n    state: DockingState\n  });\n  var visibility = {\n    fadeInClass: 'tox-editor-dock-fadein',\n    fadeOutClass: 'tox-editor-dock-fadeout',\n    transitionClass: 'tox-editor-dock-transition'\n  };\n  var editorStickyOnClass = 'tox-tinymce--toolbar-sticky-on';\n  var editorStickyOffClass = 'tox-tinymce--toolbar-sticky-off';\n\n  var scrollFromBehindHeader = function (e, containerHeader) {\n    var doc = owner(containerHeader);\n    var viewHeight = doc.dom.defaultView.innerHeight;\n    var scrollPos = get$9(doc);\n    var markerElement = SugarElement.fromDom(e.elm);\n    var markerPos = absolute$1(markerElement);\n    var markerHeight = get$7(markerElement);\n    var markerTop = markerPos.y;\n    var markerBottom = markerTop + markerHeight;\n    var editorHeaderPos = absolute(containerHeader);\n    var editorHeaderHeight = get$7(containerHeader);\n    var editorHeaderTop = editorHeaderPos.top;\n    var editorHeaderBottom = editorHeaderTop + editorHeaderHeight;\n    var editorHeaderDockedAtTop = Math.abs(editorHeaderTop - scrollPos.top) < 2;\n    var editorHeaderDockedAtBottom = Math.abs(editorHeaderBottom - (scrollPos.top + viewHeight)) < 2;\n\n    if (editorHeaderDockedAtTop && markerTop < editorHeaderBottom) {\n      to(scrollPos.left, markerTop - editorHeaderHeight, doc);\n    } else if (editorHeaderDockedAtBottom && markerBottom > editorHeaderTop) {\n      var y = markerTop - viewHeight + markerHeight + editorHeaderHeight;\n      to(scrollPos.left, y, doc);\n    }\n  };\n\n  var isDockedMode = function (header, mode) {\n    return contains(Docking.getModes(header), mode);\n  };\n\n  var updateIframeContentFlow = function (header) {\n    var getOccupiedHeight = function (elm) {\n      return getOuter$1(elm) + (parseInt(get$5(elm, 'margin-top'), 10) || 0) + (parseInt(get$5(elm, 'margin-bottom'), 10) || 0);\n    };\n\n    var elm = header.element;\n    parent(elm).each(function (parentElem) {\n      var padding = 'padding-' + Docking.getModes(header)[0];\n\n      if (Docking.isDocked(header)) {\n        var parentWidth = get$8(parentElem);\n        set$2(elm, 'width', parentWidth + 'px');\n        set$2(parentElem, padding, getOccupiedHeight(elm) + 'px');\n      } else {\n        remove$6(elm, 'width');\n        remove$6(parentElem, padding);\n      }\n    });\n  };\n\n  var updateSinkVisibility = function (sinkElem, visible) {\n    if (visible) {\n      remove$4(sinkElem, visibility.fadeOutClass);\n      add$3(sinkElem, [visibility.transitionClass, visibility.fadeInClass]);\n    } else {\n      remove$4(sinkElem, visibility.fadeInClass);\n      add$3(sinkElem, [visibility.fadeOutClass, visibility.transitionClass]);\n    }\n  };\n\n  var updateEditorClasses = function (editor, docked) {\n    var editorContainer = SugarElement.fromDom(editor.getContainer());\n\n    if (docked) {\n      add$2(editorContainer, editorStickyOnClass);\n      remove$4(editorContainer, editorStickyOffClass);\n    } else {\n      add$2(editorContainer, editorStickyOffClass);\n      remove$4(editorContainer, editorStickyOnClass);\n    }\n  };\n\n  var restoreFocus = function (headerElem, focusedElem) {\n    var ownerDoc = owner(focusedElem);\n    active(ownerDoc).filter(function (activeElm) {\n      return !eq$1(focusedElem, activeElm);\n    }).filter(function (activeElm) {\n      return eq$1(activeElm, SugarElement.fromDom(ownerDoc.dom.body)) || contains$2(headerElem, activeElm);\n    }).each(function () {\n      return focus$1(focusedElem);\n    });\n  };\n\n  var findFocusedElem = function (rootElm, lazySink) {\n    return search(rootElm).orThunk(function () {\n      return lazySink().toOptional().bind(function (sink) {\n        return search(sink.element);\n      });\n    });\n  };\n\n  var setup$5 = function (editor, sharedBackstage, lazyHeader) {\n    if (!editor.inline) {\n      if (!sharedBackstage.header.isPositionedAtTop()) {\n        editor.on('ResizeEditor', function () {\n          lazyHeader().each(Docking.reset);\n        });\n      }\n\n      editor.on('ResizeWindow ResizeEditor', function () {\n        lazyHeader().each(updateIframeContentFlow);\n      });\n      editor.on('SkinLoaded', function () {\n        lazyHeader().each(function (comp) {\n          Docking.isDocked(comp) ? Docking.reset(comp) : Docking.refresh(comp);\n        });\n      });\n      editor.on('FullscreenStateChanged', function () {\n        lazyHeader().each(Docking.reset);\n      });\n    }\n\n    editor.on('AfterScrollIntoView', function (e) {\n      lazyHeader().each(function (header) {\n        Docking.refresh(header);\n        var headerElem = header.element;\n\n        if (isVisible(headerElem)) {\n          scrollFromBehindHeader(e, headerElem);\n        }\n      });\n    });\n    editor.on('PostRender', function () {\n      updateEditorClasses(editor, false);\n    });\n  };\n\n  var isDocked$2 = function (lazyHeader) {\n    return lazyHeader().map(Docking.isDocked).getOr(false);\n  };\n\n  var getIframeBehaviours = function () {\n    var _a;\n\n    return [Receiving.config({\n      channels: (_a = {}, _a[toolbarHeightChange()] = {\n        onReceive: updateIframeContentFlow\n      }, _a)\n    })];\n  };\n\n  var getBehaviours$3 = function (editor, sharedBackstage) {\n    var focusedElm = Cell(Optional.none());\n    var lazySink = sharedBackstage.getSink;\n\n    var runOnSinkElement = function (f) {\n      lazySink().each(function (sink) {\n        return f(sink.element);\n      });\n    };\n\n    var onDockingSwitch = function (comp) {\n      if (!editor.inline) {\n        updateIframeContentFlow(comp);\n      }\n\n      updateEditorClasses(editor, Docking.isDocked(comp));\n      comp.getSystem().broadcastOn([repositionPopups()], {});\n      lazySink().each(function (sink) {\n        return sink.getSystem().broadcastOn([repositionPopups()], {});\n      });\n    };\n\n    var additionalBehaviours = editor.inline ? [] : getIframeBehaviours();\n    return __spreadArrays([Focusing.config({}), Docking.config({\n      contextual: __assign({\n        lazyContext: function (comp) {\n          var headerHeight = getOuter$1(comp.element);\n          var container = editor.inline ? editor.getContentAreaContainer() : editor.getContainer();\n          var box$1 = box(SugarElement.fromDom(container));\n          var boxHeight = box$1.height - headerHeight;\n          var topBound = box$1.y + (isDockedMode(comp, 'top') ? 0 : headerHeight);\n          return Optional.some(bounds$1(box$1.x, topBound, box$1.width, boxHeight));\n        },\n        onShow: function () {\n          runOnSinkElement(function (elem) {\n            return updateSinkVisibility(elem, true);\n          });\n        },\n        onShown: function (comp) {\n          runOnSinkElement(function (elem) {\n            return remove$5(elem, [visibility.transitionClass, visibility.fadeInClass]);\n          });\n          focusedElm.get().each(function (elem) {\n            restoreFocus(comp.element, elem);\n            focusedElm.set(Optional.none());\n          });\n        },\n        onHide: function (comp) {\n          focusedElm.set(findFocusedElem(comp.element, lazySink));\n          runOnSinkElement(function (elem) {\n            return updateSinkVisibility(elem, false);\n          });\n        },\n        onHidden: function () {\n          runOnSinkElement(function (elem) {\n            return remove$5(elem, [visibility.transitionClass]);\n          });\n        }\n      }, visibility),\n      modes: [sharedBackstage.header.getDockingMode()],\n      onDocked: onDockingSwitch,\n      onUndocked: onDockingSwitch\n    })], additionalBehaviours);\n  };\n\n  var StickyHeader = /*#__PURE__*/Object.freeze({\n    __proto__: null,\n    setup: setup$5,\n    isDocked: isDocked$2,\n    getBehaviours: getBehaviours$3\n  });\n\n  var renderHeader = function (spec) {\n    var editor = spec.editor;\n    var getBehaviours = spec.sticky ? getBehaviours$3 : getBehaviours$2;\n    return {\n      uid: spec.uid,\n      dom: spec.dom,\n      components: spec.components,\n      behaviours: derive$1(getBehaviours(editor, spec.sharedBackstage))\n    };\n  };\n\n  var factory$g = function (detail, spec) {\n    var setMenus = function (comp, menus) {\n      var newMenus = map(menus, function (m) {\n        var buttonSpec = {\n          type: 'menubutton',\n          text: m.text,\n          fetch: function (callback) {\n            callback(m.getItems());\n          }\n        };\n        var internal = createMenuButton(buttonSpec).mapError(function (errInfo) {\n          return formatError(errInfo);\n        }).getOrDie();\n        return renderMenuButton(internal, 'tox-mbtn', spec.backstage, Optional.some('menuitem'));\n      });\n      Replacing.set(comp, newMenus);\n    };\n\n    var apis = {\n      focus: Keying.focusIn,\n      setMenus: setMenus\n    };\n    return {\n      uid: detail.uid,\n      dom: detail.dom,\n      components: [],\n      behaviours: derive$1([Replacing.config({}), config('menubar-events', [runOnAttached(function (component) {\n        detail.onSetup(component);\n      }), run(mouseover(), function (comp, se) {\n        descendant$1(comp.element, '.' + 'tox-mbtn--active').each(function (activeButton) {\n          closest$3(se.event.target, '.' + 'tox-mbtn').each(function (hoveredButton) {\n            if (!eq$1(activeButton, hoveredButton)) {\n              comp.getSystem().getByDom(activeButton).each(function (activeComp) {\n                comp.getSystem().getByDom(hoveredButton).each(function (hoveredComp) {\n                  Dropdown.expand(hoveredComp);\n                  Dropdown.close(activeComp);\n                  Focusing.focus(hoveredComp);\n                });\n              });\n            }\n          });\n        });\n      }), run(focusShifted(), function (comp, se) {\n        se.event.prevFocus.bind(function (prev) {\n          return comp.getSystem().getByDom(prev).toOptional();\n        }).each(function (prev) {\n          se.event.newFocus.bind(function (nu) {\n            return comp.getSystem().getByDom(nu).toOptional();\n          }).each(function (nu) {\n            if (Dropdown.isOpen(prev)) {\n              Dropdown.expand(nu);\n              Dropdown.close(prev);\n            }\n          });\n        });\n      })]), Keying.config({\n        mode: 'flow',\n        selector: '.' + 'tox-mbtn',\n        onEscape: function (comp) {\n          detail.onEscape(comp);\n          return Optional.some(true);\n        }\n      }), Tabstopping.config({})]),\n      apis: apis,\n      domModification: {\n        attributes: {\n          role: 'menubar'\n        }\n      }\n    };\n  };\n\n  var SilverMenubar = single$2({\n    factory: factory$g,\n    name: 'silver.Menubar',\n    configFields: [strict$1('dom'), strict$1('uid'), strict$1('onEscape'), strict$1('backstage'), defaulted$1('onSetup', noop)],\n    apis: {\n      focus: function (apis, comp) {\n        apis.focus(comp);\n      },\n      setMenus: function (apis, comp, menus) {\n        apis.setMenus(comp, menus);\n      }\n    }\n  });\n  var owner$4 = 'container';\n  var schema$s = [field$1('slotBehaviours', [])];\n\n  var getPartName$1 = function (name) {\n    return '<alloy.field.' + name + '>';\n  };\n\n  var sketch$2 = function (sSpec) {\n    var parts = function () {\n      var record = [];\n\n      var slot = function (name, config) {\n        record.push(name);\n        return generateOne(owner$4, getPartName$1(name), config);\n      };\n\n      return {\n        slot: slot,\n        record: function () {\n          return record;\n        }\n      };\n    }();\n\n    var spec = sSpec(parts);\n    var partNames = parts.record();\n    var fieldParts = map(partNames, function (n) {\n      return required({\n        name: n,\n        pname: getPartName$1(n)\n      });\n    });\n    return composite(owner$4, schema$s, fieldParts, make$7, spec);\n  };\n\n  var make$7 = function (detail, components) {\n    var getSlotNames = function (_) {\n      return getAllPartNames(detail);\n    };\n\n    var getSlot = function (container, key) {\n      return getPart(container, detail, key);\n    };\n\n    var onSlot = function (f, def) {\n      return function (container, key) {\n        return getPart(container, detail, key).map(function (slot) {\n          return f(slot, key);\n        }).getOr(def);\n      };\n    };\n\n    var onSlots = function (f) {\n      return function (container, keys) {\n        each(keys, function (key) {\n          return f(container, key);\n        });\n      };\n    };\n\n    var doShowing = function (comp, _key) {\n      return get$3(comp.element, 'aria-hidden') !== 'true';\n    };\n\n    var doShow = function (comp, key) {\n      if (!doShowing(comp)) {\n        var element = comp.element;\n        remove$6(element, 'display');\n        remove$1(element, 'aria-hidden');\n        emitWith(comp, slotVisibility(), {\n          name: key,\n          visible: true\n        });\n      }\n    };\n\n    var doHide = function (comp, key) {\n      if (doShowing(comp)) {\n        var element = comp.element;\n        set$2(element, 'display', 'none');\n        set$1(element, 'aria-hidden', 'true');\n        emitWith(comp, slotVisibility(), {\n          name: key,\n          visible: false\n        });\n      }\n    };\n\n    var isShowing = onSlot(doShowing, false);\n    var hideSlot = onSlot(doHide);\n    var hideSlots = onSlots(hideSlot);\n\n    var hideAllSlots = function (container) {\n      return hideSlots(container, getSlotNames());\n    };\n\n    var showSlot = onSlot(doShow);\n    var apis = {\n      getSlotNames: getSlotNames,\n      getSlot: getSlot,\n      isShowing: isShowing,\n      hideSlot: hideSlot,\n      hideAllSlots: hideAllSlots,\n      showSlot: showSlot\n    };\n    return {\n      uid: detail.uid,\n      dom: detail.dom,\n      components: components,\n      behaviours: get$d(detail.slotBehaviours),\n      apis: apis\n    };\n  };\n\n  var slotApis = map$2({\n    getSlotNames: function (apis, c) {\n      return apis.getSlotNames(c);\n    },\n    getSlot: function (apis, c, key) {\n      return apis.getSlot(c, key);\n    },\n    isShowing: function (apis, c, key) {\n      return apis.isShowing(c, key);\n    },\n    hideSlot: function (apis, c, key) {\n      return apis.hideSlot(c, key);\n    },\n    hideAllSlots: function (apis, c) {\n      return apis.hideAllSlots(c);\n    },\n    showSlot: function (apis, c, key) {\n      return apis.showSlot(c, key);\n    }\n  }, function (value) {\n    return makeApi(value);\n  });\n\n  var SlotContainer = __assign(__assign({}, slotApis), {\n    sketch: sketch$2\n  });\n\n  var sidebarSchema = objOf([optionString('icon'), optionString('tooltip'), defaultedFunction('onShow', noop), defaultedFunction('onHide', noop), defaultedFunction('onSetup', function () {\n    return noop;\n  })]);\n\n  var createSidebar = function (spec) {\n    return asRaw('sidebar', sidebarSchema, spec);\n  };\n\n  var setup$6 = function (editor) {\n    var sidebars = editor.ui.registry.getAll().sidebars;\n    each(keys(sidebars), function (name) {\n      var spec = sidebars[name];\n\n      var isActive = function () {\n        return Optional.from(editor.queryCommandValue('ToggleSidebar')).is(name);\n      };\n\n      editor.ui.registry.addToggleButton(name, {\n        icon: spec.icon,\n        tooltip: spec.tooltip,\n        onAction: function (buttonApi) {\n          editor.execCommand('ToggleSidebar', false, name);\n          buttonApi.setActive(isActive());\n        },\n        onSetup: function (buttonApi) {\n          var handleToggle = function () {\n            return buttonApi.setActive(isActive());\n          };\n\n          editor.on('ToggleSidebar', handleToggle);\n          return function () {\n            editor.off('ToggleSidebar', handleToggle);\n          };\n        }\n      });\n    });\n  };\n\n  var getApi = function (comp) {\n    return {\n      element: function () {\n        return comp.element.dom;\n      }\n    };\n  };\n\n  var makePanels = function (parts, panelConfigs) {\n    var specs = map(keys(panelConfigs), function (name) {\n      var spec = panelConfigs[name];\n      var bridged = getOrDie(createSidebar(spec));\n      return {\n        name: name,\n        getApi: getApi,\n        onSetup: bridged.onSetup,\n        onShow: bridged.onShow,\n        onHide: bridged.onHide\n      };\n    });\n    return map(specs, function (spec) {\n      var editorOffCell = Cell(noop);\n      return parts.slot(spec.name, {\n        dom: {\n          tag: 'div',\n          classes: ['tox-sidebar__pane']\n        },\n        behaviours: SimpleBehaviours.unnamedEvents([onControlAttached(spec, editorOffCell), onControlDetached(spec, editorOffCell), run(slotVisibility(), function (sidepanel, se) {\n          var data = se.event;\n          var optSidePanelSpec = find(specs, function (config) {\n            return config.name === data.name;\n          });\n          optSidePanelSpec.each(function (sidePanelSpec) {\n            var handler = data.visible ? sidePanelSpec.onShow : sidePanelSpec.onHide;\n            handler(sidePanelSpec.getApi(sidepanel));\n          });\n        })])\n      });\n    });\n  };\n\n  var makeSidebar = function (panelConfigs) {\n    return SlotContainer.sketch(function (parts) {\n      return {\n        dom: {\n          tag: 'div',\n          classes: ['tox-sidebar__pane-container']\n        },\n        components: makePanels(parts, panelConfigs),\n        slotBehaviours: SimpleBehaviours.unnamedEvents([runOnAttached(function (slotContainer) {\n          return SlotContainer.hideAllSlots(slotContainer);\n        })])\n      };\n    });\n  };\n\n  var setSidebar = function (sidebar, panelConfigs) {\n    var optSlider = Composing.getCurrent(sidebar);\n    optSlider.each(function (slider) {\n      return Replacing.set(slider, [makeSidebar(panelConfigs)]);\n    });\n  };\n\n  var toggleSidebar = function (sidebar, name) {\n    var optSlider = Composing.getCurrent(sidebar);\n    optSlider.each(function (slider) {\n      var optSlotContainer = Composing.getCurrent(slider);\n      optSlotContainer.each(function (slotContainer) {\n        if (Sliding.hasGrown(slider)) {\n          if (SlotContainer.isShowing(slotContainer, name)) {\n            Sliding.shrink(slider);\n          } else {\n            SlotContainer.hideAllSlots(slotContainer);\n            SlotContainer.showSlot(slotContainer, name);\n          }\n        } else {\n          SlotContainer.hideAllSlots(slotContainer);\n          SlotContainer.showSlot(slotContainer, name);\n          Sliding.grow(slider);\n        }\n      });\n    });\n  };\n\n  var whichSidebar = function (sidebar) {\n    var optSlider = Composing.getCurrent(sidebar);\n    return optSlider.bind(function (slider) {\n      var sidebarOpen = Sliding.isGrowing(slider) || Sliding.hasGrown(slider);\n\n      if (sidebarOpen) {\n        var optSlotContainer = Composing.getCurrent(slider);\n        return optSlotContainer.bind(function (slotContainer) {\n          return find(SlotContainer.getSlotNames(slotContainer), function (name) {\n            return SlotContainer.isShowing(slotContainer, name);\n          });\n        });\n      } else {\n        return Optional.none();\n      }\n    });\n  };\n\n  var fixSize = generate$1('FixSizeEvent');\n  var autoSize = generate$1('AutoSizeEvent');\n\n  var renderSidebar = function (spec) {\n    return {\n      uid: spec.uid,\n      dom: {\n        tag: 'div',\n        classes: ['tox-sidebar'],\n        attributes: {\n          role: 'complementary'\n        }\n      },\n      components: [{\n        dom: {\n          tag: 'div',\n          classes: ['tox-sidebar__slider']\n        },\n        components: [],\n        behaviours: derive$1([Tabstopping.config({}), Focusing.config({}), Sliding.config({\n          dimension: {\n            property: 'width'\n          },\n          closedClass: 'tox-sidebar--sliding-closed',\n          openClass: 'tox-sidebar--sliding-open',\n          shrinkingClass: 'tox-sidebar--sliding-shrinking',\n          growingClass: 'tox-sidebar--sliding-growing',\n          onShrunk: function (slider) {\n            var optSlotContainer = Composing.getCurrent(slider);\n            optSlotContainer.each(SlotContainer.hideAllSlots);\n            emit(slider, autoSize);\n          },\n          onGrown: function (slider) {\n            emit(slider, autoSize);\n          },\n          onStartGrow: function (slider) {\n            emitWith(slider, fixSize, {\n              width: getRaw(slider.element, 'width').getOr('')\n            });\n          },\n          onStartShrink: function (slider) {\n            emitWith(slider, fixSize, {\n              width: get$8(slider.element) + 'px'\n            });\n          }\n        }), Replacing.config({}), Composing.config({\n          find: function (comp) {\n            var children = Replacing.contents(comp);\n            return head(children);\n          }\n        })])\n      }],\n      behaviours: derive$1([ComposingConfigs.childAt(0), config('sidebar-sliding-events', [run(fixSize, function (comp, se) {\n        set$2(comp.element, 'width', se.event.width);\n      }), run(autoSize, function (comp, _se) {\n        remove$6(comp.element, 'width');\n      })])])\n    };\n  };\n\n  var getAttrs = function (elem) {\n    var attributes = elem.dom.attributes !== undefined ? elem.dom.attributes : [];\n    return foldl(attributes, function (b, attr) {\n      var _a;\n\n      if (attr.name === 'class') {\n        return b;\n      } else {\n        return __assign(__assign({}, b), (_a = {}, _a[attr.name] = attr.value, _a));\n      }\n    }, {});\n  };\n\n  var getClasses = function (elem) {\n    return Array.prototype.slice.call(elem.dom.classList, 0);\n  };\n\n  var fromHtml$2 = function (html) {\n    var elem = SugarElement.fromHtml(html);\n    var children$1 = children(elem);\n    var attrs = getAttrs(elem);\n    var classes = getClasses(elem);\n    var contents = children$1.length === 0 ? {} : {\n      innerHtml: get$2(elem)\n    };\n    return __assign({\n      tag: name(elem),\n      classes: classes,\n      attributes: attrs\n    }, contents);\n  };\n\n  var renderSpinner = function (providerBackstage) {\n    return {\n      dom: {\n        tag: 'div',\n        attributes: {\n          'aria-label': providerBackstage.translate('Loading...')\n        },\n        classes: ['tox-throbber__busy-spinner']\n      },\n      components: [{\n        dom: fromHtml$2('<div class=\"tox-spinner\"><div></div><div></div><div></div></div>')\n      }],\n      behaviours: derive$1([Keying.config({\n        mode: 'special',\n        onTab: function () {\n          return Optional.some(true);\n        },\n        onShiftTab: function () {\n          return Optional.some(true);\n        }\n      }), Focusing.config({})])\n    };\n  };\n\n  var toggleThrobber = function (comp, state, providerBackstage) {\n    var element = comp.element;\n\n    if (state === true) {\n      Replacing.set(comp, [renderSpinner(providerBackstage)]);\n      remove$6(element, 'display');\n      remove$1(element, 'aria-hidden');\n    } else {\n      Replacing.set(comp, []);\n      set$2(element, 'display', 'none');\n      set$1(element, 'aria-hidden', 'true');\n    }\n  };\n\n  var renderThrobber = function (spec) {\n    return {\n      uid: spec.uid,\n      dom: {\n        tag: 'div',\n        attributes: {\n          'aria-hidden': 'true'\n        },\n        classes: ['tox-throbber'],\n        styles: {\n          display: 'none'\n        }\n      },\n      behaviours: derive$1([Replacing.config({})]),\n      components: []\n    };\n  };\n\n  var setup$7 = function (editor, lazyThrobber, sharedBackstage) {\n    var throbberState = Cell(false);\n    var timer = Cell(Optional.none());\n\n    var toggle = function (state) {\n      if (state !== throbberState.get()) {\n        toggleThrobber(lazyThrobber(), state, sharedBackstage.providers);\n        throbberState.set(state);\n        editor.fire('AfterProgressState', {\n          state: state\n        });\n      }\n    };\n\n    editor.on('ProgressState', function (e) {\n      timer.get().each(global$2.clearTimeout);\n\n      if (isNumber(e.time)) {\n        var timerId = global$2.setEditorTimeout(editor, function () {\n          return toggle(e.state);\n        }, e.time);\n        timer.set(Optional.some(timerId));\n      } else {\n        toggle(e.state);\n        timer.set(Optional.none());\n      }\n    });\n  };\n\n  var factory$h = function (detail, components, _spec) {\n    var apis = {\n      getSocket: function (comp) {\n        return parts$d.getPart(comp, detail, 'socket');\n      },\n      setSidebar: function (comp, panelConfigs) {\n        parts$d.getPart(comp, detail, 'sidebar').each(function (sidebar) {\n          return setSidebar(sidebar, panelConfigs);\n        });\n      },\n      toggleSidebar: function (comp, name) {\n        parts$d.getPart(comp, detail, 'sidebar').each(function (sidebar) {\n          return toggleSidebar(sidebar, name);\n        });\n      },\n      whichSidebar: function (comp) {\n        return parts$d.getPart(comp, detail, 'sidebar').bind(whichSidebar).getOrNull();\n      },\n      getHeader: function (comp) {\n        return parts$d.getPart(comp, detail, 'header');\n      },\n      getToolbar: function (comp) {\n        return parts$d.getPart(comp, detail, 'toolbar');\n      },\n      setToolbar: function (comp, groups) {\n        parts$d.getPart(comp, detail, 'toolbar').each(function (toolbar) {\n          toolbar.getApis().setGroups(toolbar, groups);\n        });\n      },\n      setToolbars: function (comp, toolbars) {\n        parts$d.getPart(comp, detail, 'multiple-toolbar').each(function (mToolbar) {\n          CustomList.setItems(mToolbar, toolbars);\n        });\n      },\n      refreshToolbar: function (comp) {\n        var toolbar = parts$d.getPart(comp, detail, 'toolbar');\n        toolbar.each(function (toolbar) {\n          return toolbar.getApis().refresh(toolbar);\n        });\n      },\n      toggleToolbarDrawer: function (comp) {\n        parts$d.getPart(comp, detail, 'toolbar').each(function (toolbar) {\n          mapFrom(toolbar.getApis().toggle, function (toggle) {\n            return toggle(toolbar);\n          });\n        });\n      },\n      isToolbarDrawerToggled: function (comp) {\n        return parts$d.getPart(comp, detail, 'toolbar').bind(function (toolbar) {\n          return Optional.from(toolbar.getApis().isOpen).map(function (isOpen) {\n            return isOpen(toolbar);\n          });\n        }).getOr(false);\n      },\n      getThrobber: function (comp) {\n        return parts$d.getPart(comp, detail, 'throbber');\n      },\n      focusToolbar: function (comp) {\n        var optToolbar = parts$d.getPart(comp, detail, 'toolbar').orThunk(function () {\n          return parts$d.getPart(comp, detail, 'multiple-toolbar');\n        });\n        optToolbar.each(function (toolbar) {\n          Keying.focusIn(toolbar);\n        });\n      },\n      setMenubar: function (comp, menus) {\n        parts$d.getPart(comp, detail, 'menubar').each(function (menubar) {\n          SilverMenubar.setMenus(menubar, menus);\n        });\n      },\n      focusMenubar: function (comp) {\n        parts$d.getPart(comp, detail, 'menubar').each(function (menubar) {\n          SilverMenubar.focus(menubar);\n        });\n      }\n    };\n    return {\n      uid: detail.uid,\n      dom: detail.dom,\n      components: components,\n      apis: apis,\n      behaviours: detail.behaviours\n    };\n  };\n\n  var partMenubar = partType$1.optional({\n    factory: SilverMenubar,\n    name: 'menubar',\n    schema: [strict$1('backstage')]\n  });\n\n  var toolbarFactory = function (spec) {\n    if (spec.type === ToolbarMode.sliding) {\n      return renderSlidingMoreToolbar;\n    } else if (spec.type === ToolbarMode.floating) {\n      return renderFloatingMoreToolbar;\n    } else {\n      return renderToolbar;\n    }\n  };\n\n  var partMultipleToolbar = partType$1.optional({\n    factory: {\n      sketch: function (spec) {\n        return CustomList.sketch({\n          uid: spec.uid,\n          dom: spec.dom,\n          listBehaviours: derive$1([Keying.config({\n            mode: 'acyclic',\n            selector: '.tox-toolbar'\n          })]),\n          makeItem: function () {\n            return renderToolbar({\n              type: spec.type,\n              uid: generate$1('multiple-toolbar-item'),\n              cyclicKeying: false,\n              initGroups: [],\n              providers: spec.providers,\n              onEscape: function () {\n                spec.onEscape();\n                return Optional.some(true);\n              }\n            });\n          },\n          setupItem: function (_mToolbar, tc, data, _index) {\n            Toolbar.setGroups(tc, data);\n          },\n          shell: true\n        });\n      }\n    },\n    name: 'multiple-toolbar',\n    schema: [strict$1('dom'), strict$1('onEscape')]\n  });\n  var partToolbar = partType$1.optional({\n    factory: {\n      sketch: function (spec) {\n        var renderer = toolbarFactory(spec);\n        var toolbarSpec = {\n          type: spec.type,\n          uid: spec.uid,\n          onEscape: function () {\n            spec.onEscape();\n            return Optional.some(true);\n          },\n          cyclicKeying: false,\n          initGroups: [],\n          getSink: spec.getSink,\n          providers: spec.providers,\n          moreDrawerData: {\n            lazyToolbar: spec.lazyToolbar,\n            lazyMoreButton: spec.lazyMoreButton,\n            lazyHeader: spec.lazyHeader\n          },\n          attributes: spec.attributes\n        };\n        return renderer(toolbarSpec);\n      }\n    },\n    name: 'toolbar',\n    schema: [strict$1('dom'), strict$1('onEscape'), strict$1('getSink')]\n  });\n  var partHeader = partType$1.optional({\n    factory: {\n      sketch: renderHeader\n    },\n    name: 'header',\n    schema: [strict$1('dom')]\n  });\n  var partSocket = partType$1.optional({\n    name: 'socket',\n    schema: [strict$1('dom')]\n  });\n  var partSidebar = partType$1.optional({\n    factory: {\n      sketch: renderSidebar\n    },\n    name: 'sidebar',\n    schema: [strict$1('dom')]\n  });\n  var partThrobber = partType$1.optional({\n    factory: {\n      sketch: renderThrobber\n    },\n    name: 'throbber',\n    schema: [strict$1('dom')]\n  });\n  var OuterContainer = composite$1({\n    name: 'OuterContainer',\n    factory: factory$h,\n    configFields: [strict$1('dom'), strict$1('behaviours')],\n    partFields: [partHeader, partMenubar, partToolbar, partMultipleToolbar, partSocket, partSidebar, partThrobber],\n    apis: {\n      getSocket: function (apis, comp) {\n        return apis.getSocket(comp);\n      },\n      setSidebar: function (apis, comp, panelConfigs) {\n        apis.setSidebar(comp, panelConfigs);\n      },\n      toggleSidebar: function (apis, comp, name) {\n        apis.toggleSidebar(comp, name);\n      },\n      whichSidebar: function (apis, comp) {\n        return apis.whichSidebar(comp);\n      },\n      getHeader: function (apis, comp) {\n        return apis.getHeader(comp);\n      },\n      getToolbar: function (apis, comp) {\n        return apis.getToolbar(comp);\n      },\n      setToolbar: function (apis, comp, grps) {\n        var groups = map(grps, function (grp) {\n          return renderToolbarGroup(grp);\n        });\n        apis.setToolbar(comp, groups);\n      },\n      setToolbars: function (apis, comp, ts) {\n        var renderedToolbars = map(ts, function (g) {\n          return map(g, renderToolbarGroup);\n        });\n        apis.setToolbars(comp, renderedToolbars);\n      },\n      refreshToolbar: function (apis, comp) {\n        return apis.refreshToolbar(comp);\n      },\n      toggleToolbarDrawer: function (apis, comp) {\n        apis.toggleToolbarDrawer(comp);\n      },\n      isToolbarDrawerToggled: function (apis, comp) {\n        return apis.isToolbarDrawerToggled(comp);\n      },\n      getThrobber: function (apis, comp) {\n        return apis.getThrobber(comp);\n      },\n      setMenubar: function (apis, comp, menus) {\n        apis.setMenubar(comp, menus);\n      },\n      focusMenubar: function (apis, comp) {\n        apis.focusMenubar(comp);\n      },\n      focusToolbar: function (apis, comp) {\n        apis.focusToolbar(comp);\n      }\n    }\n  });\n  var defaultMenubar = 'file edit view insert format tools table help';\n  var defaultMenus = {\n    file: {\n      title: 'File',\n      items: 'newdocument restoredraft | preview | export print | deleteallconversations'\n    },\n    edit: {\n      title: 'Edit',\n      items: 'undo redo | cut copy paste pastetext | selectall | searchreplace'\n    },\n    view: {\n      title: 'View',\n      items: 'code | visualaid visualchars visualblocks | spellchecker | preview fullscreen | showcomments'\n    },\n    insert: {\n      title: 'Insert',\n      items: 'image link media addcomment pageembed template codesample inserttable | charmap emoticons hr | pagebreak nonbreaking anchor toc | insertdatetime'\n    },\n    format: {\n      title: 'Format',\n      items: 'bold italic underline strikethrough superscript subscript codeformat | formats blockformats fontformats fontsizes align lineheight | forecolor backcolor | removeformat'\n    },\n    tools: {\n      title: 'Tools',\n      items: 'spellchecker spellcheckerlanguage | a11ycheck code wordcount'\n    },\n    table: {\n      title: 'Table',\n      items: 'inserttable | cell row column | advtablesort | tableprops deletetable'\n    },\n    help: {\n      title: 'Help',\n      items: 'help'\n    }\n  };\n\n  var make$8 = function (menu, registry, editor) {\n    var removedMenuItems = getRemovedMenuItems(editor).split(/[ ,]/);\n    return {\n      text: menu.title,\n      getItems: function () {\n        return bind(menu.items, function (i) {\n          var itemName = i.toLowerCase();\n\n          if (itemName.trim().length === 0) {\n            return [];\n          } else if (exists(removedMenuItems, function (removedMenuItem) {\n            return removedMenuItem === itemName;\n          })) {\n            return [];\n          } else if (itemName === 'separator' || itemName === '|') {\n            return [{\n              type: 'separator'\n            }];\n          } else if (registry.menuItems[itemName]) {\n            return [registry.menuItems[itemName]];\n          } else {\n            return [];\n          }\n        });\n      }\n    };\n  };\n\n  var parseItemsString = function (items) {\n    if (typeof items === 'string') {\n      return items.split(' ');\n    }\n\n    return items;\n  };\n\n  var identifyMenus = function (editor, registry) {\n    var rawMenuData = __assign(__assign({}, defaultMenus), registry.menus);\n\n    var userDefinedMenus = keys(registry.menus).length > 0;\n    var menubar = registry.menubar === undefined || registry.menubar === true ? parseItemsString(defaultMenubar) : parseItemsString(registry.menubar === false ? '' : registry.menubar);\n    var validMenus = filter(menubar, function (menuName) {\n      return userDefinedMenus ? registry.menus.hasOwnProperty(menuName) && registry.menus[menuName].hasOwnProperty('items') || defaultMenus.hasOwnProperty(menuName) : defaultMenus.hasOwnProperty(menuName);\n    });\n    var menus = map(validMenus, function (menuName) {\n      var menuData = rawMenuData[menuName];\n      return make$8({\n        title: menuData.title,\n        items: parseItemsString(menuData.items)\n      }, registry, editor);\n    });\n    return filter(menus, function (menu) {\n      var isNotSeparator = function (item) {\n        return item.type !== 'separator';\n      };\n\n      return menu.getItems().length > 0 && exists(menu.getItems(), isNotSeparator);\n    });\n  };\n\n  var fireSkinLoaded$1 = function (editor) {\n    var done = function () {\n      editor._skinLoaded = true;\n      fireSkinLoaded(editor);\n    };\n\n    return function () {\n      if (editor.initialized) {\n        done();\n      } else {\n        editor.on('init', done);\n      }\n    };\n  };\n\n  var fireSkinLoadError$1 = function (editor, err) {\n    return function () {\n      return fireSkinLoadError(editor, {\n        message: err\n      });\n    };\n  };\n\n  var loadStylesheet = function (editor, stylesheetUrl, styleSheetLoader) {\n    return new global$4(function (resolve, reject) {\n      styleSheetLoader.load(stylesheetUrl, resolve, reject);\n      editor.on('remove', function () {\n        return styleSheetLoader.unload(stylesheetUrl);\n      });\n    });\n  };\n\n  var loadUiSkins = function (editor, skinUrl) {\n    var skinUiCss = skinUrl + '/skin.min.css';\n    return loadStylesheet(editor, skinUiCss, editor.ui.styleSheetLoader);\n  };\n\n  var loadShadowDomUiSkins = function (editor, skinUrl) {\n    var isInShadowRoot$1 = isInShadowRoot(SugarElement.fromDom(editor.getElement()));\n\n    if (isInShadowRoot$1) {\n      var shadowDomSkinCss = skinUrl + '/skin.shadowdom.min.css';\n      return loadStylesheet(editor, shadowDomSkinCss, global$5.DOM.styleSheetLoader);\n    } else {\n      return global$4.resolve();\n    }\n  };\n\n  var loadSkin = function (isInline, editor) {\n    var skinUrl = getSkinUrl(editor);\n\n    if (skinUrl) {\n      editor.contentCSS.push(skinUrl + (isInline ? '/content.inline' : '/content') + '.min.css');\n    }\n\n    if (isSkinDisabled(editor) === false && isString(skinUrl)) {\n      global$4.all([loadUiSkins(editor, skinUrl), loadShadowDomUiSkins(editor, skinUrl)]).then(fireSkinLoaded$1(editor), fireSkinLoadError$1(editor, 'Skin could not be loaded'));\n    } else {\n      fireSkinLoaded$1(editor)();\n    }\n  };\n\n  var iframe = curry(loadSkin, false);\n  var inline = curry(loadSkin, true);\n\n  var setToolbar = function (editor, uiComponents, rawUiConfig, backstage) {\n    var comp = uiComponents.outerContainer;\n    var toolbarConfig = rawUiConfig.toolbar;\n    var toolbarButtonsConfig = rawUiConfig.buttons;\n\n    if (isArrayOf(toolbarConfig, isString)) {\n      var toolbars = toolbarConfig.map(function (t) {\n        var config = {\n          toolbar: t,\n          buttons: toolbarButtonsConfig,\n          allowToolbarGroups: rawUiConfig.allowToolbarGroups\n        };\n        return identifyButtons(editor, config, {\n          backstage: backstage\n        }, Optional.none());\n      });\n      OuterContainer.setToolbars(comp, toolbars);\n    } else {\n      OuterContainer.setToolbar(comp, identifyButtons(editor, rawUiConfig, {\n        backstage: backstage\n      }, Optional.none()));\n    }\n  };\n\n  var detection = detect$3();\n  var isiOS12 = detection.os.isiOS() && detection.os.version.major <= 12;\n\n  var setupEvents = function (editor, uiComponents) {\n    var dom = editor.dom;\n    var contentWindow = editor.getWin();\n    var initialDocEle = editor.getDoc().documentElement;\n    var lastWindowDimensions = Cell(SugarPosition(contentWindow.innerWidth, contentWindow.innerHeight));\n    var lastDocumentDimensions = Cell(SugarPosition(initialDocEle.offsetWidth, initialDocEle.offsetHeight));\n\n    var resizeWindow = function () {\n      var outer = lastWindowDimensions.get();\n\n      if (outer.left !== contentWindow.innerWidth || outer.top !== contentWindow.innerHeight) {\n        lastWindowDimensions.set(SugarPosition(contentWindow.innerWidth, contentWindow.innerHeight));\n        fireResizeContent(editor);\n      }\n    };\n\n    var resizeDocument = function () {\n      var docEle = editor.getDoc().documentElement;\n      var inner = lastDocumentDimensions.get();\n\n      if (inner.left !== docEle.offsetWidth || inner.top !== docEle.offsetHeight) {\n        lastDocumentDimensions.set(SugarPosition(docEle.offsetWidth, docEle.offsetHeight));\n        fireResizeContent(editor);\n      }\n    };\n\n    var scroll = function (e) {\n      return fireScrollContent(editor, e);\n    };\n\n    dom.bind(contentWindow, 'resize', resizeWindow);\n    dom.bind(contentWindow, 'scroll', scroll);\n    var elementLoad = capture$1(SugarElement.fromDom(editor.getBody()), 'load', resizeDocument);\n    var mothership = uiComponents.uiMothership.element;\n    editor.on('hide', function () {\n      set$2(mothership, 'display', 'none');\n    });\n    editor.on('show', function () {\n      remove$6(mothership, 'display');\n    });\n    editor.on('NodeChange', resizeDocument);\n    editor.on('remove', function () {\n      elementLoad.unbind();\n      dom.unbind(contentWindow, 'resize', resizeWindow);\n      dom.unbind(contentWindow, 'scroll', scroll);\n      contentWindow = null;\n    });\n  };\n\n  var render$1 = function (editor, uiComponents, rawUiConfig, backstage, args) {\n    var lastToolbarWidth = Cell(0);\n    var outerContainer = uiComponents.outerContainer;\n    iframe(editor);\n    var eTargetNode = SugarElement.fromDom(args.targetNode);\n    var uiRoot = getContentContainer(getRootNode(eTargetNode));\n    attachSystemAfter(eTargetNode, uiComponents.mothership);\n    attachSystem(uiRoot, uiComponents.uiMothership);\n    editor.on('PostRender', function () {\n      setToolbar(editor, uiComponents, rawUiConfig, backstage);\n      lastToolbarWidth.set(editor.getWin().innerWidth);\n      OuterContainer.setMenubar(outerContainer, identifyMenus(editor, rawUiConfig));\n      OuterContainer.setSidebar(outerContainer, rawUiConfig.sidebar);\n      setupEvents(editor, uiComponents);\n    });\n    var socket = OuterContainer.getSocket(outerContainer).getOrDie('Could not find expected socket element');\n\n    if (isiOS12) {\n      setAll$1(socket.element, {\n        'overflow': 'scroll',\n        '-webkit-overflow-scrolling': 'touch'\n      });\n      var limit = first(function () {\n        editor.fire('ScrollContent');\n      }, 20);\n      var unbinder = bind$3(socket.element, 'scroll', limit.throttle);\n      editor.on('remove', unbinder.unbind);\n    }\n\n    setupReadonlyModeSwitch(editor, uiComponents);\n    editor.addCommand('ToggleSidebar', function (_ui, value) {\n      OuterContainer.toggleSidebar(outerContainer, value);\n      editor.fire('ToggleSidebar');\n    });\n    editor.addQueryValueHandler('ToggleSidebar', function () {\n      return OuterContainer.whichSidebar(outerContainer);\n    });\n    var toolbarMode = getToolbarMode(editor);\n\n    var refreshDrawer = function () {\n      OuterContainer.refreshToolbar(uiComponents.outerContainer);\n    };\n\n    if (toolbarMode === ToolbarMode.sliding || toolbarMode === ToolbarMode.floating) {\n      editor.on('ResizeWindow ResizeEditor ResizeContent', function () {\n        var width = editor.getWin().innerWidth;\n\n        if (width !== lastToolbarWidth.get()) {\n          refreshDrawer();\n          lastToolbarWidth.set(width);\n        }\n      });\n    }\n\n    var api = {\n      enable: function () {\n        broadcastReadonly(uiComponents, false);\n      },\n      disable: function () {\n        broadcastReadonly(uiComponents, true);\n      },\n      isDisabled: function () {\n        return Disabling.isDisabled(outerContainer);\n      }\n    };\n    return {\n      iframeContainer: socket.element.dom,\n      editorContainer: outerContainer.element.dom,\n      api: api\n    };\n  };\n\n  var Iframe = /*#__PURE__*/Object.freeze({\n    __proto__: null,\n    render: render$1\n  });\n\n  var parseToInt = function (val) {\n    var re = /^[0-9\\.]+(|px)$/i;\n\n    if (re.test('' + val)) {\n      return Optional.some(parseInt('' + val, 10));\n    }\n\n    return Optional.none();\n  };\n\n  var numToPx = function (val) {\n    return isNumber(val) ? val + 'px' : val;\n  };\n\n  var calcCappedSize = function (size, minSize, maxSize) {\n    var minOverride = minSize.filter(function (min) {\n      return size < min;\n    });\n    var maxOverride = maxSize.filter(function (max) {\n      return size > max;\n    });\n    return minOverride.or(maxOverride).getOr(size);\n  };\n\n  var getHeight$1 = function (editor) {\n    var baseHeight = getHeightSetting(editor);\n    var minHeight = getMinHeightSetting(editor);\n    var maxHeight = getMaxHeightSetting(editor);\n    return parseToInt(baseHeight).map(function (height) {\n      return calcCappedSize(height, minHeight, maxHeight);\n    });\n  };\n\n  var getHeightWithFallback = function (editor) {\n    var height = getHeight$1(editor);\n    return height.getOr(getHeightSetting(editor));\n  };\n\n  var getWidth$1 = function (editor) {\n    var baseWidth = getWidthSetting(editor);\n    var minWidth = getMinWidthSetting(editor);\n    var maxWidth = getMaxWidthSetting(editor);\n    return parseToInt(baseWidth).map(function (width) {\n      return calcCappedSize(width, minWidth, maxWidth);\n    });\n  };\n\n  var getWidthWithFallback = function (editor) {\n    var width = getWidth$1(editor);\n    return width.getOr(getWidthSetting(editor));\n  };\n\n  var InlineHeader = function (editor, targetElm, uiComponents, backstage, floatContainer) {\n    var uiMothership = uiComponents.uiMothership,\n        outerContainer = uiComponents.outerContainer;\n    var DOM = global$5.DOM;\n    var useFixedToolbarContainer = useFixedContainer(editor);\n    var isSticky = isStickyToolbar(editor);\n    var editorMaxWidthOpt = getMaxWidthSetting(editor).or(getWidth$1(editor));\n    var headerBackstage = backstage.shared.header;\n    var isPositionedAtTop = headerBackstage.isPositionedAtTop;\n    var toolbarMode = getToolbarMode(editor);\n    var isSplitToolbar = toolbarMode === ToolbarMode.sliding || toolbarMode === ToolbarMode.floating;\n    var visible = Cell(false);\n\n    var isVisible = function () {\n      return visible.get() && !editor.removed;\n    };\n\n    var calcToolbarOffset = function (toolbar) {\n      return isSplitToolbar ? toolbar.fold(function () {\n        return 0;\n      }, function (tbar) {\n        return tbar.components().length > 1 ? get$7(tbar.components()[1].element) : 0;\n      }) : 0;\n    };\n\n    var calcMode = function (container) {\n      switch (getToolbarLocation(editor)) {\n        case ToolbarLocation.auto:\n          var toolbar_1 = OuterContainer.getToolbar(outerContainer);\n          var offset = calcToolbarOffset(toolbar_1);\n          var toolbarHeight = get$7(container.element) - offset;\n          var targetBounds = box(targetElm);\n          var roomAtTop = targetBounds.y > toolbarHeight;\n\n          if (roomAtTop) {\n            return 'top';\n          } else {\n            var doc = documentElement(targetElm);\n            var docHeight = Math.max(doc.dom.scrollHeight, get$7(doc));\n            var roomAtBottom = targetBounds.bottom < docHeight - toolbarHeight;\n\n            if (roomAtBottom) {\n              return 'bottom';\n            } else {\n              var winBounds = win();\n              var isRoomAtBottomViewport = winBounds.bottom < targetBounds.bottom - toolbarHeight;\n              return isRoomAtBottomViewport ? 'bottom' : 'top';\n            }\n          }\n\n        case ToolbarLocation.bottom:\n          return 'bottom';\n\n        case ToolbarLocation.top:\n        default:\n          return 'top';\n      }\n    };\n\n    var setupMode = function (mode) {\n      var container = floatContainer.get();\n      Docking.setModes(container, [mode]);\n      headerBackstage.setDockingMode(mode);\n      var verticalDir = isPositionedAtTop() ? AttributeValue.TopToBottom : AttributeValue.BottomToTop;\n      set$1(container.element, Attribute, verticalDir);\n    };\n\n    var updateChromeWidth = function () {\n      var maxWidth = editorMaxWidthOpt.getOrThunk(function () {\n        var bodyMargin = parseToInt(get$5(body(), 'margin-left')).getOr(0);\n        return get$8(body()) - absolute(targetElm).left + bodyMargin;\n      });\n      set$2(floatContainer.get().element, 'max-width', maxWidth + 'px');\n    };\n\n    var updateChromePosition = function () {\n      var toolbar = OuterContainer.getToolbar(outerContainer);\n      var offset = calcToolbarOffset(toolbar);\n      var targetBounds = box(targetElm);\n      var top = isPositionedAtTop() ? Math.max(targetBounds.y - get$7(floatContainer.get().element) + offset, 0) : targetBounds.bottom;\n      setAll$1(outerContainer.element, {\n        position: 'absolute',\n        top: Math.round(top) + 'px',\n        left: Math.round(targetBounds.x) + 'px'\n      });\n    };\n\n    var repositionPopups$1 = function () {\n      uiMothership.broadcastOn([repositionPopups()], {});\n    };\n\n    var updateChromeUi = function (resetDocking) {\n      if (resetDocking === void 0) {\n        resetDocking = false;\n      }\n\n      if (!isVisible()) {\n        return;\n      }\n\n      if (!useFixedToolbarContainer) {\n        updateChromeWidth();\n      }\n\n      if (isSplitToolbar) {\n        OuterContainer.refreshToolbar(outerContainer);\n      }\n\n      if (!useFixedToolbarContainer) {\n        updateChromePosition();\n      }\n\n      if (isSticky) {\n        var floatContainerComp = floatContainer.get();\n        resetDocking ? Docking.reset(floatContainerComp) : Docking.refresh(floatContainerComp);\n      }\n\n      repositionPopups$1();\n    };\n\n    var updateMode = function (updateUi) {\n      if (updateUi === void 0) {\n        updateUi = true;\n      }\n\n      if (useFixedToolbarContainer || !isSticky || !isVisible()) {\n        return;\n      }\n\n      var currentMode = headerBackstage.getDockingMode();\n      var newMode = calcMode(floatContainer.get());\n\n      if (newMode !== currentMode) {\n        setupMode(newMode);\n\n        if (updateUi) {\n          updateChromeUi(true);\n        }\n      }\n    };\n\n    var show = function () {\n      visible.set(true);\n      set$2(outerContainer.element, 'display', 'flex');\n      DOM.addClass(editor.getBody(), 'mce-edit-focus');\n      remove$6(uiMothership.element, 'display');\n      updateMode(false);\n      updateChromeUi();\n    };\n\n    var hide = function () {\n      visible.set(false);\n\n      if (uiComponents.outerContainer) {\n        set$2(outerContainer.element, 'display', 'none');\n        DOM.removeClass(editor.getBody(), 'mce-edit-focus');\n      }\n\n      set$2(uiMothership.element, 'display', 'none');\n    };\n\n    return {\n      isVisible: isVisible,\n      isPositionedAtTop: isPositionedAtTop,\n      show: show,\n      hide: hide,\n      update: updateChromeUi,\n      updateMode: updateMode,\n      repositionPopups: repositionPopups$1\n    };\n  };\n\n  var getTargetPosAndBounds = function (targetElm, isToolbarTop) {\n    var bounds = box(targetElm);\n    return {\n      pos: isToolbarTop ? bounds.y : bounds.bottom,\n      bounds: bounds\n    };\n  };\n\n  var setupEvents$1 = function (editor, targetElm, ui, toolbarPersist) {\n    var prevPosAndBounds = Cell(getTargetPosAndBounds(targetElm, ui.isPositionedAtTop()));\n\n    var resizeContent = function (e) {\n      var _a = getTargetPosAndBounds(targetElm, ui.isPositionedAtTop()),\n          pos = _a.pos,\n          bounds = _a.bounds;\n\n      var _b = prevPosAndBounds.get(),\n          prevPos = _b.pos,\n          prevBounds = _b.bounds;\n\n      var hasResized = bounds.height !== prevBounds.height || bounds.width !== prevBounds.width;\n      prevPosAndBounds.set({\n        pos: pos,\n        bounds: bounds\n      });\n\n      if (hasResized) {\n        fireResizeContent(editor, e);\n      }\n\n      if (ui.isVisible()) {\n        if (prevPos !== pos) {\n          ui.update(true);\n        } else if (hasResized) {\n          ui.updateMode();\n          ui.repositionPopups();\n        }\n      }\n    };\n\n    if (!toolbarPersist) {\n      editor.on('activate', ui.show);\n      editor.on('deactivate', ui.hide);\n    }\n\n    editor.on('SkinLoaded ResizeWindow', function () {\n      return ui.update(true);\n    });\n    editor.on('NodeChange keydown', function (e) {\n      global$2.requestAnimationFrame(function () {\n        return resizeContent(e);\n      });\n    });\n    editor.on('ScrollWindow', function () {\n      return ui.updateMode();\n    });\n    var elementLoad = unbindable();\n    elementLoad.set(capture$1(SugarElement.fromDom(editor.getBody()), 'load', resizeContent));\n    editor.on('remove', function () {\n      elementLoad.clear();\n    });\n  };\n\n  var render$2 = function (editor, uiComponents, rawUiConfig, backstage, args) {\n    var mothership = uiComponents.mothership,\n        uiMothership = uiComponents.uiMothership,\n        outerContainer = uiComponents.outerContainer;\n    var floatContainer = Cell(null);\n    var targetElm = SugarElement.fromDom(args.targetNode);\n    var ui = InlineHeader(editor, targetElm, uiComponents, backstage, floatContainer);\n    var toolbarPersist = isToolbarPersist(editor);\n    inline(editor);\n\n    var render = function () {\n      if (floatContainer.get()) {\n        ui.show();\n        return;\n      }\n\n      floatContainer.set(OuterContainer.getHeader(outerContainer).getOrDie());\n      var uiContainer = getUiContainer(editor);\n      attachSystem(uiContainer, mothership);\n      attachSystem(uiContainer, uiMothership);\n      setToolbar(editor, uiComponents, rawUiConfig, backstage);\n      OuterContainer.setMenubar(outerContainer, identifyMenus(editor, rawUiConfig));\n      ui.show();\n      setupEvents$1(editor, targetElm, ui, toolbarPersist);\n      editor.nodeChanged();\n    };\n\n    var delayedRender = function () {\n      return global$2.setEditorTimeout(editor, render, 0);\n    };\n\n    editor.on('show', render);\n    editor.on('hide', ui.hide);\n\n    if (!toolbarPersist) {\n      editor.on('focus', delayedRender);\n      editor.on('blur', ui.hide);\n    }\n\n    editor.on('init', function () {\n      if (editor.hasFocus() || toolbarPersist) {\n        delayedRender();\n      }\n    });\n    setupReadonlyModeSwitch(editor, uiComponents);\n    var api = {\n      show: function () {\n        ui.show();\n      },\n      hide: function () {\n        ui.hide();\n      },\n      enable: function () {\n        broadcastReadonly(uiComponents, false);\n      },\n      disable: function () {\n        broadcastReadonly(uiComponents, true);\n      },\n      isDisabled: function () {\n        return Disabling.isDisabled(outerContainer);\n      }\n    };\n    return {\n      editorContainer: outerContainer.element.dom,\n      api: api\n    };\n  };\n\n  var Inline = /*#__PURE__*/Object.freeze({\n    __proto__: null,\n    render: render$2\n  });\n\n  var register$5 = function (editor) {\n    var alignToolbarButtons = [{\n      name: 'alignleft',\n      text: 'Align left',\n      cmd: 'JustifyLeft',\n      icon: 'align-left'\n    }, {\n      name: 'aligncenter',\n      text: 'Align center',\n      cmd: 'JustifyCenter',\n      icon: 'align-center'\n    }, {\n      name: 'alignright',\n      text: 'Align right',\n      cmd: 'JustifyRight',\n      icon: 'align-right'\n    }, {\n      name: 'alignjustify',\n      text: 'Justify',\n      cmd: 'JustifyFull',\n      icon: 'align-justify'\n    }];\n    global$c.each(alignToolbarButtons, function (item) {\n      editor.ui.registry.addToggleButton(item.name, {\n        tooltip: item.text,\n        onAction: function () {\n          return editor.execCommand(item.cmd);\n        },\n        icon: item.icon,\n        onSetup: onSetupFormatToggle(editor, item.name)\n      });\n    });\n    var alignNoneToolbarButton = {\n      name: 'alignnone',\n      text: 'No alignment',\n      cmd: 'JustifyNone',\n      icon: 'align-none'\n    };\n    editor.ui.registry.addButton(alignNoneToolbarButton.name, {\n      tooltip: alignNoneToolbarButton.text,\n      onAction: function () {\n        return editor.execCommand(alignNoneToolbarButton.cmd);\n      },\n      icon: alignNoneToolbarButton.icon\n    });\n  };\n\n  var register$6 = function (editor, backstage) {\n    alignSelectMenu(editor, backstage);\n    fontSelectMenu(editor, backstage);\n    styleSelectMenu(editor, backstage);\n    formatSelectMenu(editor, backstage);\n    fontsizeSelectMenu(editor, backstage);\n  };\n\n  var toggleOutdentState = function (api, editor) {\n    api.setDisabled(!editor.queryCommandState('outdent'));\n\n    var onNodeChange = function () {\n      api.setDisabled(!editor.queryCommandState('outdent'));\n    };\n\n    editor.on('NodeChange', onNodeChange);\n    return function () {\n      return editor.off('NodeChange', onNodeChange);\n    };\n  };\n\n  var registerButtons = function (editor) {\n    editor.ui.registry.addButton('outdent', {\n      tooltip: 'Decrease indent',\n      icon: 'outdent',\n      onSetup: function (api) {\n        return toggleOutdentState(api, editor);\n      },\n      onAction: function () {\n        return editor.execCommand('outdent');\n      }\n    });\n    editor.ui.registry.addButton('indent', {\n      tooltip: 'Increase indent',\n      icon: 'indent',\n      onAction: function () {\n        return editor.execCommand('indent');\n      }\n    });\n  };\n\n  var register$7 = function (editor) {\n    registerButtons(editor);\n  };\n\n  var units = {\n    unsupportedLength: ['em', 'ex', 'cap', 'ch', 'ic', 'rem', 'lh', 'rlh', 'vw', 'vh', 'vi', 'vb', 'vmin', 'vmax', 'cm', 'mm', 'Q', 'in', 'pc', 'pt', 'px'],\n    fixed: ['px', 'pt'],\n    relative: ['%'],\n    empty: ['']\n  };\n\n  var pattern = function () {\n    var decimalDigits = '[0-9]+';\n    var signedInteger = '[+-]?' + decimalDigits;\n    var exponentPart = '[eE]' + signedInteger;\n    var dot = '\\\\.';\n\n    var opt = function (input) {\n      return '(?:' + input + ')?';\n    };\n\n    var unsignedDecimalLiteral = ['Infinity', decimalDigits + dot + opt(decimalDigits) + opt(exponentPart), dot + decimalDigits + opt(exponentPart), decimalDigits + opt(exponentPart)].join('|');\n    var float = '[+-]?(?:' + unsignedDecimalLiteral + ')';\n    return new RegExp('^(' + float + ')(.*)$');\n  }();\n\n  var isUnit = function (unit, accepted) {\n    return exists(accepted, function (acc) {\n      return exists(units[acc], function (check) {\n        return unit === check;\n      });\n    });\n  };\n\n  var parse = function (input, accepted) {\n    var match = Optional.from(pattern.exec(input));\n    return match.bind(function (array) {\n      var value = Number(array[1]);\n      var unitRaw = array[2];\n\n      if (isUnit(unitRaw, accepted)) {\n        return Optional.some({\n          value: value,\n          unit: unitRaw\n        });\n      } else {\n        return Optional.none();\n      }\n    });\n  };\n\n  var normalise = function (input, accepted) {\n    return parse(input, accepted).map(function (_a) {\n      var value = _a.value,\n          unit = _a.unit;\n      return value + unit;\n    });\n  };\n\n  var normaliseLineHeight = function (input) {\n    return normalise(input, ['fixed', 'relative', 'empty']).getOr(input);\n  };\n\n  var getLineHeights = function (editor) {\n    var options = getLineHeightFormats(editor);\n    var apis = new Map();\n    var lastApi = destroyable();\n\n    var callback = function () {\n      var current = normaliseLineHeight(editor.queryCommandValue('LineHeight'));\n      Optional.from(apis.get(current)).fold(function () {\n        return lastApi.clear();\n      }, function (api) {\n        lastApi.set({\n          destroy: function () {\n            api.setActive(false);\n          }\n        });\n        api.setActive(true);\n      });\n    };\n\n    editor.on('nodeChange', callback);\n    return map(options, function (value, i) {\n      return {\n        type: 'togglemenuitem',\n        text: value,\n        onSetup: function (api) {\n          apis.set(normaliseLineHeight(value), api);\n\n          if (i + 1 === options.length) {\n            callback();\n          }\n\n          return function () {\n            if (i === 0) {\n              editor.off('nodeChange', callback);\n              lastApi.clear();\n            }\n          };\n        },\n        onAction: function () {\n          return editor.execCommand('LineHeight', false, value);\n        }\n      };\n    });\n  };\n\n  var registerMenuItems = function (editor) {\n    editor.ui.registry.addNestedMenuItem('lineheight', {\n      type: 'nestedmenuitem',\n      text: 'Line height',\n      getSubmenuItems: function () {\n        return getLineHeights(editor);\n      }\n    });\n  };\n\n  var registerButtons$1 = function (editor) {\n    editor.ui.registry.addMenuButton('lineheight', {\n      tooltip: 'Line height',\n      icon: 'line-height',\n      fetch: function (callback) {\n        return callback(getLineHeights(editor));\n      }\n    });\n  };\n\n  var register$8 = function (editor) {\n    registerMenuItems(editor);\n    registerButtons$1(editor);\n  };\n\n  var toggleFormat = function (editor, fmt) {\n    return function () {\n      editor.execCommand('mceToggleFormat', false, fmt);\n    };\n  };\n\n  var registerFormatButtons = function (editor) {\n    global$c.each([{\n      name: 'bold',\n      text: 'Bold',\n      icon: 'bold'\n    }, {\n      name: 'italic',\n      text: 'Italic',\n      icon: 'italic'\n    }, {\n      name: 'underline',\n      text: 'Underline',\n      icon: 'underline'\n    }, {\n      name: 'strikethrough',\n      text: 'Strikethrough',\n      icon: 'strike-through'\n    }, {\n      name: 'subscript',\n      text: 'Subscript',\n      icon: 'subscript'\n    }, {\n      name: 'superscript',\n      text: 'Superscript',\n      icon: 'superscript'\n    }], function (btn, _idx) {\n      editor.ui.registry.addToggleButton(btn.name, {\n        tooltip: btn.text,\n        icon: btn.icon,\n        onSetup: onSetupFormatToggle(editor, btn.name),\n        onAction: toggleFormat(editor, btn.name)\n      });\n    });\n\n    for (var i = 1; i <= 6; i++) {\n      var name_1 = 'h' + i;\n      editor.ui.registry.addToggleButton(name_1, {\n        text: name_1.toUpperCase(),\n        tooltip: 'Heading ' + i,\n        onSetup: onSetupFormatToggle(editor, name_1),\n        onAction: toggleFormat(editor, name_1)\n      });\n    }\n  };\n\n  var registerCommandButtons = function (editor) {\n    global$c.each([{\n      name: 'cut',\n      text: 'Cut',\n      action: 'Cut',\n      icon: 'cut'\n    }, {\n      name: 'copy',\n      text: 'Copy',\n      action: 'Copy',\n      icon: 'copy'\n    }, {\n      name: 'paste',\n      text: 'Paste',\n      action: 'Paste',\n      icon: 'paste'\n    }, {\n      name: 'help',\n      text: 'Help',\n      action: 'mceHelp',\n      icon: 'help'\n    }, {\n      name: 'selectall',\n      text: 'Select all',\n      action: 'SelectAll',\n      icon: 'select-all'\n    }, {\n      name: 'newdocument',\n      text: 'New document',\n      action: 'mceNewDocument',\n      icon: 'new-document'\n    }, {\n      name: 'removeformat',\n      text: 'Clear formatting',\n      action: 'RemoveFormat',\n      icon: 'remove-formatting'\n    }, {\n      name: 'remove',\n      text: 'Remove',\n      action: 'Delete',\n      icon: 'remove'\n    }], function (btn) {\n      editor.ui.registry.addButton(btn.name, {\n        tooltip: btn.text,\n        icon: btn.icon,\n        onAction: function () {\n          return editor.execCommand(btn.action);\n        }\n      });\n    });\n  };\n\n  var registerCommandToggleButtons = function (editor) {\n    global$c.each([{\n      name: 'blockquote',\n      text: 'Blockquote',\n      action: 'mceBlockQuote',\n      icon: 'quote'\n    }], function (btn) {\n      editor.ui.registry.addToggleButton(btn.name, {\n        tooltip: btn.text,\n        icon: btn.icon,\n        onAction: function () {\n          return editor.execCommand(btn.action);\n        },\n        onSetup: onSetupFormatToggle(editor, btn.name)\n      });\n    });\n  };\n\n  var registerButtons$2 = function (editor) {\n    registerFormatButtons(editor);\n    registerCommandButtons(editor);\n    registerCommandToggleButtons(editor);\n  };\n\n  var registerMenuItems$1 = function (editor) {\n    global$c.each([{\n      name: 'bold',\n      text: 'Bold',\n      action: 'Bold',\n      icon: 'bold',\n      shortcut: 'Meta+B'\n    }, {\n      name: 'italic',\n      text: 'Italic',\n      action: 'Italic',\n      icon: 'italic',\n      shortcut: 'Meta+I'\n    }, {\n      name: 'underline',\n      text: 'Underline',\n      action: 'Underline',\n      icon: 'underline',\n      shortcut: 'Meta+U'\n    }, {\n      name: 'strikethrough',\n      text: 'Strikethrough',\n      action: 'Strikethrough',\n      icon: 'strike-through',\n      shortcut: ''\n    }, {\n      name: 'subscript',\n      text: 'Subscript',\n      action: 'Subscript',\n      icon: 'subscript',\n      shortcut: ''\n    }, {\n      name: 'superscript',\n      text: 'Superscript',\n      action: 'Superscript',\n      icon: 'superscript',\n      shortcut: ''\n    }, {\n      name: 'removeformat',\n      text: 'Clear formatting',\n      action: 'RemoveFormat',\n      icon: 'remove-formatting',\n      shortcut: ''\n    }, {\n      name: 'newdocument',\n      text: 'New document',\n      action: 'mceNewDocument',\n      icon: 'new-document',\n      shortcut: ''\n    }, {\n      name: 'cut',\n      text: 'Cut',\n      action: 'Cut',\n      icon: 'cut',\n      shortcut: 'Meta+X'\n    }, {\n      name: 'copy',\n      text: 'Copy',\n      action: 'Copy',\n      icon: 'copy',\n      shortcut: 'Meta+C'\n    }, {\n      name: 'paste',\n      text: 'Paste',\n      action: 'Paste',\n      icon: 'paste',\n      shortcut: 'Meta+V'\n    }, {\n      name: 'selectall',\n      text: 'Select all',\n      action: 'SelectAll',\n      icon: 'select-all',\n      shortcut: 'Meta+A'\n    }], function (btn) {\n      editor.ui.registry.addMenuItem(btn.name, {\n        text: btn.text,\n        icon: btn.icon,\n        shortcut: btn.shortcut,\n        onAction: function () {\n          return editor.execCommand(btn.action);\n        }\n      });\n    });\n    editor.ui.registry.addMenuItem('codeformat', {\n      text: 'Code',\n      icon: 'sourcecode',\n      onAction: toggleFormat(editor, 'code')\n    });\n  };\n\n  var register$9 = function (editor) {\n    registerButtons$2(editor);\n    registerMenuItems$1(editor);\n  };\n\n  var toggleUndoRedoState = function (api, editor, type) {\n    var checkState = function () {\n      return editor.undoManager ? editor.undoManager[type]() : false;\n    };\n\n    var onUndoStateChange = function () {\n      api.setDisabled(editor.mode.isReadOnly() || !checkState());\n    };\n\n    api.setDisabled(!checkState());\n    editor.on('Undo Redo AddUndo TypingUndo ClearUndos SwitchMode', onUndoStateChange);\n    return function () {\n      return editor.off('Undo Redo AddUndo TypingUndo ClearUndos SwitchMode', onUndoStateChange);\n    };\n  };\n\n  var registerMenuItems$2 = function (editor) {\n    editor.ui.registry.addMenuItem('undo', {\n      text: 'Undo',\n      icon: 'undo',\n      shortcut: 'Meta+Z',\n      onSetup: function (api) {\n        return toggleUndoRedoState(api, editor, 'hasUndo');\n      },\n      onAction: function () {\n        return editor.execCommand('undo');\n      }\n    });\n    editor.ui.registry.addMenuItem('redo', {\n      text: 'Redo',\n      icon: 'redo',\n      shortcut: 'Meta+Y',\n      onSetup: function (api) {\n        return toggleUndoRedoState(api, editor, 'hasRedo');\n      },\n      onAction: function () {\n        return editor.execCommand('redo');\n      }\n    });\n  };\n\n  var registerButtons$3 = function (editor) {\n    editor.ui.registry.addButton('undo', {\n      tooltip: 'Undo',\n      icon: 'undo',\n      onSetup: function (api) {\n        return toggleUndoRedoState(api, editor, 'hasUndo');\n      },\n      onAction: function () {\n        return editor.execCommand('undo');\n      }\n    });\n    editor.ui.registry.addButton('redo', {\n      tooltip: 'Redo',\n      icon: 'redo',\n      onSetup: function (api) {\n        return toggleUndoRedoState(api, editor, 'hasRedo');\n      },\n      onAction: function () {\n        return editor.execCommand('redo');\n      }\n    });\n  };\n\n  var register$a = function (editor) {\n    registerMenuItems$2(editor);\n    registerButtons$3(editor);\n  };\n\n  var toggleVisualAidState = function (api, editor) {\n    api.setActive(editor.hasVisual);\n\n    var onVisualAid = function (e) {\n      api.setActive(e.hasVisual);\n    };\n\n    editor.on('VisualAid', onVisualAid);\n    return function () {\n      return editor.off('VisualAid', onVisualAid);\n    };\n  };\n\n  var registerMenuItems$3 = function (editor) {\n    editor.ui.registry.addToggleMenuItem('visualaid', {\n      text: 'Visual aids',\n      onSetup: function (api) {\n        return toggleVisualAidState(api, editor);\n      },\n      onAction: function () {\n        editor.execCommand('mceToggleVisualAid');\n      }\n    });\n  };\n\n  var registerToolbarButton = function (editor) {\n    editor.ui.registry.addButton('visualaid', {\n      tooltip: 'Visual aids',\n      text: 'Visual aids',\n      onAction: function () {\n        return editor.execCommand('mceToggleVisualAid');\n      }\n    });\n  };\n\n  var register$b = function (editor) {\n    registerToolbarButton(editor);\n    registerMenuItems$3(editor);\n  };\n\n  var setup$8 = function (editor, backstage) {\n    register$5(editor);\n    register$9(editor);\n    register$6(editor, backstage);\n    register$a(editor);\n    register$1(editor);\n    register$b(editor);\n    register$7(editor);\n    register$8(editor);\n  };\n\n  var nu$d = function (x, y) {\n    return {\n      anchor: 'makeshift',\n      x: x,\n      y: y\n    };\n  };\n\n  var transpose$1 = function (pos, dx, dy) {\n    return nu$d(pos.x + dx, pos.y + dy);\n  };\n\n  var isTouchEvent$1 = function (e) {\n    return e.type === 'longpress' || e.type.indexOf('touch') === 0;\n  };\n\n  var fromPageXY = function (e) {\n    if (isTouchEvent$1(e)) {\n      var touch = e.touches[0];\n      return nu$d(touch.pageX, touch.pageY);\n    } else {\n      return nu$d(e.pageX, e.pageY);\n    }\n  };\n\n  var fromClientXY = function (e) {\n    if (isTouchEvent$1(e)) {\n      var touch = e.touches[0];\n      return nu$d(touch.clientX, touch.clientY);\n    } else {\n      return nu$d(e.clientX, e.clientY);\n    }\n  };\n\n  var transposeContentAreaContainer = function (element, pos) {\n    var containerPos = global$5.DOM.getPos(element);\n    return transpose$1(pos, containerPos.x, containerPos.y);\n  };\n\n  var getPointAnchor = function (editor, e) {\n    if (e.type === 'contextmenu' || e.type === 'longpress') {\n      if (editor.inline) {\n        return fromPageXY(e);\n      } else {\n        return transposeContentAreaContainer(editor.getContentAreaContainer(), fromClientXY(e));\n      }\n    } else {\n      return getSelectionAnchor(editor);\n    }\n  };\n\n  var getSelectionAnchor = function (editor) {\n    return {\n      anchor: 'selection',\n      root: SugarElement.fromDom(editor.selection.getNode())\n    };\n  };\n\n  var getNodeAnchor$1 = function (editor) {\n    return {\n      anchor: 'node',\n      node: Optional.some(SugarElement.fromDom(editor.selection.getNode())),\n      root: SugarElement.fromDom(editor.getBody())\n    };\n  };\n\n  var initAndShow = function (editor, e, buildMenu, backstage, contextmenu, useNodeAnchor) {\n    var items = buildMenu();\n    var anchorSpec = useNodeAnchor ? getNodeAnchor$1(editor) : getPointAnchor(editor, e);\n    build$2(items, ItemResponse$1.CLOSE_ON_EXECUTE, backstage, false).map(function (menuData) {\n      e.preventDefault();\n      InlineView.showMenuAt(contextmenu, anchorSpec, {\n        menu: {\n          markers: markers$1('normal')\n        },\n        data: menuData\n      });\n    });\n  };\n\n  var layouts = {\n    onLtr: function () {\n      return [south$1, southeast$1, southwest$1, northeast$1, northwest$1, north$1, north$3, south$3, northeast$3, southeast$3, northwest$3, southwest$3];\n    },\n    onRtl: function () {\n      return [south$1, southwest$1, southeast$1, northwest$1, northeast$1, north$1, north$3, south$3, northwest$3, southwest$3, northeast$3, southeast$3];\n    }\n  };\n  var bubbleSize$1 = 12;\n  var bubbleAlignments$2 = {\n    valignCentre: [],\n    alignCentre: [],\n    alignLeft: ['tox-pop--align-left'],\n    alignRight: ['tox-pop--align-right'],\n    right: ['tox-pop--right'],\n    left: ['tox-pop--left'],\n    bottom: ['tox-pop--bottom'],\n    top: ['tox-pop--top']\n  };\n\n  var isTouchWithinSelection = function (editor, e) {\n    var selection = editor.selection;\n\n    if (selection.isCollapsed() || e.touches.length < 1) {\n      return false;\n    } else {\n      var touch_1 = e.touches[0];\n      var rng = selection.getRng();\n      var rngRectOpt = getFirstRect$1(editor.getWin(), SimSelection.domRange(rng));\n      return rngRectOpt.exists(function (rngRect) {\n        return rngRect.left <= touch_1.clientX && rngRect.right >= touch_1.clientX && rngRect.top <= touch_1.clientY && rngRect.bottom >= touch_1.clientY;\n      });\n    }\n  };\n\n  var getPointAnchorSpec = function (editor, e) {\n    return __assign({\n      bubble: nu$8(0, bubbleSize$1, bubbleAlignments$2),\n      layouts: layouts,\n      overrides: {\n        maxWidthFunction: expandable$1(),\n        maxHeightFunction: expandable()\n      }\n    }, getPointAnchor(editor, e));\n  };\n\n  var setupiOSOverrides = function (editor) {\n    var originalSelection = editor.selection.getRng();\n\n    var selectionReset = function () {\n      global$2.setEditorTimeout(editor, function () {\n        editor.selection.setRng(originalSelection);\n      }, 10);\n      unbindEventListeners();\n    };\n\n    editor.once('touchend', selectionReset);\n\n    var preventMousedown = function (e) {\n      e.preventDefault();\n      e.stopImmediatePropagation();\n    };\n\n    editor.on('mousedown', preventMousedown, true);\n\n    var clearSelectionReset = function () {\n      return unbindEventListeners();\n    };\n\n    editor.once('longpresscancel', clearSelectionReset);\n\n    var unbindEventListeners = function () {\n      editor.off('touchend', selectionReset);\n      editor.off('longpresscancel', clearSelectionReset);\n      editor.off('mousedown', preventMousedown);\n    };\n  };\n\n  var show = function (editor, e, items, backstage, contextmenu, useNodeAnchor, highlightImmediately) {\n    var anchorSpec = useNodeAnchor ? getNodeAnchor$1(editor) : getPointAnchorSpec(editor, e);\n    build$2(items, ItemResponse$1.CLOSE_ON_EXECUTE, backstage, true).map(function (menuData) {\n      e.preventDefault();\n      InlineView.showMenuWithinBounds(contextmenu, anchorSpec, {\n        menu: {\n          markers: markers$1('normal'),\n          highlightImmediately: highlightImmediately\n        },\n        data: menuData,\n        type: 'horizontal'\n      }, function () {\n        return Optional.some(getContextToolbarBounds(editor, backstage.shared));\n      });\n      editor.fire(hideContextToolbarEvent);\n    });\n  };\n\n  var initAndShow$1 = function (editor, e, buildMenu, backstage, contextmenu, useNodeAnchor) {\n    var detection = detect$3();\n    var isiOS = detection.os.isiOS();\n    var isOSX = detection.os.isOSX();\n    var isAndroid = detection.os.isAndroid();\n    var isTouch = detection.deviceType.isTouch();\n\n    var shouldHighlightImmediately = function () {\n      return !(isAndroid || isiOS || isOSX && isTouch);\n    };\n\n    var open = function () {\n      var items = buildMenu();\n      show(editor, e, items, backstage, contextmenu, useNodeAnchor, shouldHighlightImmediately());\n    };\n\n    if ((isOSX || isiOS) && !useNodeAnchor) {\n      var openiOS_1 = function () {\n        setupiOSOverrides(editor);\n        open();\n      };\n\n      if (isTouchWithinSelection(editor, e)) {\n        openiOS_1();\n      } else {\n        editor.once('selectionchange', openiOS_1);\n        editor.once('touchend', function () {\n          return editor.off('selectionchange', openiOS_1);\n        });\n      }\n    } else {\n      if (isAndroid && !useNodeAnchor) {\n        editor.selection.setCursorLocation(e.target, 0);\n      }\n\n      open();\n    }\n  };\n\n  var patchPipeConfig = function (config) {\n    return typeof config === 'string' ? config.split(/[ ,]/) : config;\n  };\n\n  var shouldNeverUseNative = function (editor) {\n    return editor.getParam('contextmenu_never_use_native', false, 'boolean');\n  };\n\n  var getMenuItems = function (editor, name, defaultItems) {\n    var contextMenus = editor.ui.registry.getAll().contextMenus;\n    return Optional.from(editor.getParam(name)).map(patchPipeConfig).getOrThunk(function () {\n      return filter(patchPipeConfig(defaultItems), function (item) {\n        return has(contextMenus, item);\n      });\n    });\n  };\n\n  var isContextMenuDisabled = function (editor) {\n    return editor.getParam('contextmenu') === false;\n  };\n\n  var getContextMenu = function (editor) {\n    return getMenuItems(editor, 'contextmenu', 'link linkchecker image imagetools table spellchecker configurepermanentpen');\n  };\n\n  var getAvoidOverlapSelector = function (editor) {\n    return editor.getParam('contextmenu_avoid_overlap', '', 'string');\n  };\n\n  var isSeparator$1 = function (item) {\n    return isString(item) ? item === '|' : item.type === 'separator';\n  };\n\n  var separator$3 = {\n    type: 'separator'\n  };\n\n  var makeContextItem = function (item) {\n    var commonMenuItem = function (item) {\n      return {\n        text: item.text,\n        icon: item.icon,\n        disabled: item.disabled,\n        shortcut: item.shortcut\n      };\n    };\n\n    if (isString(item)) {\n      return item;\n    } else {\n      switch (item.type) {\n        case 'separator':\n          return separator$3;\n\n        case 'submenu':\n          return __assign(__assign({\n            type: 'nestedmenuitem'\n          }, commonMenuItem(item)), {\n            getSubmenuItems: function () {\n              var items = item.getSubmenuItems();\n\n              if (isString(items)) {\n                return items;\n              } else {\n                return map(items, makeContextItem);\n              }\n            }\n          });\n\n        default:\n          return __assign(__assign({\n            type: 'menuitem'\n          }, commonMenuItem(item)), {\n            onAction: noarg(item.onAction)\n          });\n      }\n    }\n  };\n\n  var addContextMenuGroup = function (xs, groupItems) {\n    if (groupItems.length === 0) {\n      return xs;\n    }\n\n    var lastMenuItem = last(xs).filter(function (item) {\n      return !isSeparator$1(item);\n    });\n    var before = lastMenuItem.fold(function () {\n      return [];\n    }, function (_) {\n      return [separator$3];\n    });\n    return xs.concat(before).concat(groupItems).concat([separator$3]);\n  };\n\n  var generateContextMenu = function (contextMenus, menuConfig, selectedElement) {\n    var sections = foldl(menuConfig, function (acc, name) {\n      return get$1(contextMenus, name.toLowerCase()).map(function (menu) {\n        var items = menu.update(selectedElement);\n\n        if (isString(items)) {\n          return addContextMenuGroup(acc, items.split(' '));\n        } else if (items.length > 0) {\n          var allItems = map(items, makeContextItem);\n          return addContextMenuGroup(acc, allItems);\n        } else {\n          return acc;\n        }\n      }).getOrThunk(function () {\n        return acc.concat([name]);\n      });\n    }, []);\n\n    if (sections.length > 0 && isSeparator$1(sections[sections.length - 1])) {\n      sections.pop();\n    }\n\n    return sections;\n  };\n\n  var isNativeOverrideKeyEvent = function (editor, e) {\n    return e.ctrlKey && !shouldNeverUseNative(editor);\n  };\n\n  var isTriggeredByKeyboard = function (editor, e) {\n    return e.type !== 'longpress' && (e.button !== 2 || e.target === editor.getBody() && e.pointerType === '');\n  };\n\n  var getSelectedElement = function (editor, e) {\n    return isTriggeredByKeyboard(editor, e) ? editor.selection.getStart(true) : e.target;\n  };\n\n  var shouldUseNodeAnchor = function (editor, e) {\n    var selector = getAvoidOverlapSelector(editor);\n\n    if (isTriggeredByKeyboard(editor, e)) {\n      return true;\n    } else if (selector) {\n      var target = getSelectedElement(editor, e);\n      return closest$4(SugarElement.fromDom(target), selector);\n    } else {\n      return false;\n    }\n  };\n\n  var setup$9 = function (editor, lazySink, backstage) {\n    var detection = detect$3();\n    var isTouch = detection.deviceType.isTouch;\n    var contextmenu = build$1(InlineView.sketch({\n      dom: {\n        tag: 'div'\n      },\n      lazySink: lazySink,\n      onEscape: function () {\n        return editor.focus();\n      },\n      onShow: function () {\n        return backstage.setContextMenuState(true);\n      },\n      onHide: function () {\n        return backstage.setContextMenuState(false);\n      },\n      fireDismissalEventInstead: {},\n      inlineBehaviours: derive$1([config('dismissContextMenu', [run(dismissRequested(), function (comp, _se) {\n        Sandboxing.close(comp);\n        editor.focus();\n      })])])\n    }));\n\n    var hideContextMenu = function (_e) {\n      return InlineView.hide(contextmenu);\n    };\n\n    var showContextMenu = function (e) {\n      if (shouldNeverUseNative(editor)) {\n        e.preventDefault();\n      }\n\n      if (isNativeOverrideKeyEvent(editor, e) || isContextMenuDisabled(editor)) {\n        return;\n      }\n\n      var useNodeAnchor = shouldUseNodeAnchor(editor, e);\n\n      var buildMenu = function () {\n        var selectedElement = getSelectedElement(editor, e);\n        var registry = editor.ui.registry.getAll();\n        var menuConfig = getContextMenu(editor);\n        return generateContextMenu(registry.contextMenus, menuConfig, selectedElement);\n      };\n\n      var initAndShow$2 = isTouch() ? initAndShow$1 : initAndShow;\n      initAndShow$2(editor, e, buildMenu, backstage, contextmenu, useNodeAnchor);\n    };\n\n    editor.on('init', function () {\n      var hideEvents = 'ResizeEditor ScrollContent ScrollWindow longpresscancel' + (isTouch() ? '' : ' ResizeWindow');\n      editor.on(hideEvents, hideContextMenu);\n      editor.on('longpress contextmenu', showContextMenu);\n    });\n  };\n\n  var adt$c = Adt.generate([{\n    offset: ['x', 'y']\n  }, {\n    absolute: ['x', 'y']\n  }, {\n    fixed: ['x', 'y']\n  }]);\n\n  var subtract = function (change) {\n    return function (point) {\n      return point.translate(-change.left, -change.top);\n    };\n  };\n\n  var add$4 = function (change) {\n    return function (point) {\n      return point.translate(change.left, change.top);\n    };\n  };\n\n  var transform$1 = function (changes) {\n    return function (x, y) {\n      return foldl(changes, function (rest, f) {\n        return f(rest);\n      }, SugarPosition(x, y));\n    };\n  };\n\n  var asFixed = function (coord, scroll, origin) {\n    return coord.fold(transform$1([add$4(origin), subtract(scroll)]), transform$1([subtract(scroll)]), transform$1([]));\n  };\n\n  var asAbsolute = function (coord, scroll, origin) {\n    return coord.fold(transform$1([add$4(origin)]), transform$1([]), transform$1([add$4(scroll)]));\n  };\n\n  var asOffset = function (coord, scroll, origin) {\n    return coord.fold(transform$1([]), transform$1([subtract(origin)]), transform$1([add$4(scroll), subtract(origin)]));\n  };\n\n  var withinRange = function (coord1, coord2, xRange, yRange, scroll, origin) {\n    var a1 = asAbsolute(coord1, scroll, origin);\n    var a2 = asAbsolute(coord2, scroll, origin);\n    return Math.abs(a1.left - a2.left) <= xRange && Math.abs(a1.top - a2.top) <= yRange;\n  };\n\n  var getDeltas = function (coord1, coord2, xRange, yRange, scroll, origin) {\n    var a1 = asAbsolute(coord1, scroll, origin);\n    var a2 = asAbsolute(coord2, scroll, origin);\n    var left = Math.abs(a1.left - a2.left);\n    var top = Math.abs(a1.top - a2.top);\n    return SugarPosition(left, top);\n  };\n\n  var toStyles = function (coord, scroll, origin) {\n    var stylesOpt = coord.fold(function (x, y) {\n      return {\n        position: Optional.some('absolute'),\n        left: Optional.some(x + 'px'),\n        top: Optional.some(y + 'px')\n      };\n    }, function (x, y) {\n      return {\n        position: Optional.some('absolute'),\n        left: Optional.some(x - origin.left + 'px'),\n        top: Optional.some(y - origin.top + 'px')\n      };\n    }, function (x, y) {\n      return {\n        position: Optional.some('fixed'),\n        left: Optional.some(x + 'px'),\n        top: Optional.some(y + 'px')\n      };\n    });\n    return __assign({\n      right: Optional.none(),\n      bottom: Optional.none()\n    }, stylesOpt);\n  };\n\n  var translate$2 = function (coord, deltaX, deltaY) {\n    return coord.fold(function (x, y) {\n      return offset(x + deltaX, y + deltaY);\n    }, function (x, y) {\n      return absolute$3(x + deltaX, y + deltaY);\n    }, function (x, y) {\n      return fixed$1(x + deltaX, y + deltaY);\n    });\n  };\n\n  var absorb = function (partialCoord, originalCoord, scroll, origin) {\n    var absorbOne = function (stencil, nu) {\n      return function (optX, optY) {\n        var original = stencil(originalCoord, scroll, origin);\n        return nu(optX.getOr(original.left), optY.getOr(original.top));\n      };\n    };\n\n    return partialCoord.fold(absorbOne(asOffset, offset), absorbOne(asAbsolute, absolute$3), absorbOne(asFixed, fixed$1));\n  };\n\n  var offset = adt$c.offset;\n  var absolute$3 = adt$c.absolute;\n  var fixed$1 = adt$c.fixed;\n\n  var parseAttrToInt = function (element, name) {\n    var value = get$3(element, name);\n    return isUndefined(value) ? NaN : parseInt(value, 10);\n  };\n\n  var get$f = function (component, snapsInfo) {\n    var element = component.element;\n    var x = parseAttrToInt(element, snapsInfo.leftAttr);\n    var y = parseAttrToInt(element, snapsInfo.topAttr);\n    return isNaN(x) || isNaN(y) ? Optional.none() : Optional.some(SugarPosition(x, y));\n  };\n\n  var set$8 = function (component, snapsInfo, pt) {\n    var element = component.element;\n    set$1(element, snapsInfo.leftAttr, pt.left + 'px');\n    set$1(element, snapsInfo.topAttr, pt.top + 'px');\n  };\n\n  var clear = function (component, snapsInfo) {\n    var element = component.element;\n    remove$1(element, snapsInfo.leftAttr);\n    remove$1(element, snapsInfo.topAttr);\n  };\n\n  var getCoords = function (component, snapInfo, coord, delta) {\n    return get$f(component, snapInfo).fold(function () {\n      return coord;\n    }, function (fixed) {\n      return fixed$1(fixed.left + delta.left, fixed.top + delta.top);\n    });\n  };\n\n  var moveOrSnap = function (component, snapInfo, coord, delta, scroll, origin) {\n    var newCoord = getCoords(component, snapInfo, coord, delta);\n    var snap = snapInfo.mustSnap ? findClosestSnap(component, snapInfo, newCoord, scroll, origin) : findSnap(component, snapInfo, newCoord, scroll, origin);\n    var fixedCoord = asFixed(newCoord, scroll, origin);\n    set$8(component, snapInfo, fixedCoord);\n    return snap.fold(function () {\n      return {\n        coord: fixed$1(fixedCoord.left, fixedCoord.top),\n        extra: Optional.none()\n      };\n    }, function (spanned) {\n      return {\n        coord: spanned.output,\n        extra: spanned.extra\n      };\n    });\n  };\n\n  var stopDrag = function (component, snapInfo) {\n    clear(component, snapInfo);\n  };\n\n  var findMatchingSnap = function (snaps, newCoord, scroll, origin) {\n    return findMap(snaps, function (snap) {\n      var sensor = snap.sensor;\n      var inRange = withinRange(newCoord, sensor, snap.range.left, snap.range.top, scroll, origin);\n      return inRange ? Optional.some({\n        output: absorb(snap.output, newCoord, scroll, origin),\n        extra: snap.extra\n      }) : Optional.none();\n    });\n  };\n\n  var findClosestSnap = function (component, snapInfo, newCoord, scroll, origin) {\n    var snaps = snapInfo.getSnapPoints(component);\n    var matchSnap = findMatchingSnap(snaps, newCoord, scroll, origin);\n    return matchSnap.orThunk(function () {\n      var bestSnap = foldl(snaps, function (acc, snap) {\n        var sensor = snap.sensor;\n        var deltas = getDeltas(newCoord, sensor, snap.range.left, snap.range.top, scroll, origin);\n        return acc.deltas.fold(function () {\n          return {\n            deltas: Optional.some(deltas),\n            snap: Optional.some(snap)\n          };\n        }, function (bestDeltas) {\n          var currAvg = (deltas.left + deltas.top) / 2;\n          var bestAvg = (bestDeltas.left + bestDeltas.top) / 2;\n\n          if (currAvg <= bestAvg) {\n            return {\n              deltas: Optional.some(deltas),\n              snap: Optional.some(snap)\n            };\n          } else {\n            return acc;\n          }\n        });\n      }, {\n        deltas: Optional.none(),\n        snap: Optional.none()\n      });\n      return bestSnap.snap.map(function (snap) {\n        return {\n          output: absorb(snap.output, newCoord, scroll, origin),\n          extra: snap.extra\n        };\n      });\n    });\n  };\n\n  var findSnap = function (component, snapInfo, newCoord, scroll, origin) {\n    var snaps = snapInfo.getSnapPoints(component);\n    return findMatchingSnap(snaps, newCoord, scroll, origin);\n  };\n\n  var snapTo = function (snap, scroll, origin) {\n    return {\n      coord: absorb(snap.output, snap.output, scroll, origin),\n      extra: snap.extra\n    };\n  };\n\n  var snapTo$1 = function (component, dragConfig, _state, snap) {\n    var target = dragConfig.getTarget(component.element);\n\n    if (dragConfig.repositionTarget) {\n      var doc = owner(component.element);\n      var scroll_1 = get$9(doc);\n      var origin_1 = getOrigin(target);\n      var snapPin = snapTo(snap, scroll_1, origin_1);\n      var styles = toStyles(snapPin.coord, scroll_1, origin_1);\n      setOptions(target, styles);\n    }\n  };\n\n  var DraggingApis = /*#__PURE__*/Object.freeze({\n    __proto__: null,\n    snapTo: snapTo$1\n  });\n  var initialAttribute = 'data-initial-z-index';\n\n  var resetZIndex = function (blocker) {\n    parent(blocker.element).filter(isElement).each(function (root) {\n      getOpt(root, initialAttribute).fold(function () {\n        return remove$6(root, 'z-index');\n      }, function (zIndex) {\n        return set$2(root, 'z-index', zIndex);\n      });\n      remove$1(root, initialAttribute);\n    });\n  };\n\n  var changeZIndex = function (blocker) {\n    parent(blocker.element).filter(isElement).each(function (root) {\n      getRaw(root, 'z-index').each(function (zindex) {\n        set$1(root, initialAttribute, zindex);\n      });\n      set$2(root, 'z-index', get$5(blocker.element, 'z-index'));\n    });\n  };\n\n  var instigate = function (anyComponent, blocker) {\n    anyComponent.getSystem().addToGui(blocker);\n    changeZIndex(blocker);\n  };\n\n  var discard = function (blocker) {\n    resetZIndex(blocker);\n    blocker.getSystem().removeFromGui(blocker);\n  };\n\n  var createComponent = function (component, blockerClass, blockerEvents) {\n    return component.getSystem().build(Container.sketch({\n      dom: {\n        styles: {\n          'left': '0px',\n          'top': '0px',\n          'width': '100%',\n          'height': '100%',\n          'position': 'fixed',\n          'z-index': '1000000000000000'\n        },\n        classes: [blockerClass]\n      },\n      events: blockerEvents\n    }));\n  };\n\n  var SnapSchema = optionObjOf('snaps', [strict$1('getSnapPoints'), onHandler('onSensor'), strict$1('leftAttr'), strict$1('topAttr'), defaulted$1('lazyViewport', win), defaulted$1('mustSnap', false)]);\n  var schema$t = [defaulted$1('useFixed', never), strict$1('blockerClass'), defaulted$1('getTarget', identity), defaulted$1('onDrag', noop), defaulted$1('repositionTarget', true), defaulted$1('onDrop', noop), defaultedFunction('getBounds', win), SnapSchema];\n\n  var getCurrentCoord = function (target) {\n    return lift3(getRaw(target, 'left'), getRaw(target, 'top'), getRaw(target, 'position'), function (left, top, position) {\n      var nu = position === 'fixed' ? fixed$1 : offset;\n      return nu(parseInt(left, 10), parseInt(top, 10));\n    }).getOrThunk(function () {\n      var location = absolute(target);\n      return absolute$3(location.left, location.top);\n    });\n  };\n\n  var clampCoords = function (component, coords, scroll, origin, startData) {\n    var bounds = startData.bounds;\n    var absoluteCoord = asAbsolute(coords, scroll, origin);\n    var newX = clamp(absoluteCoord.left, bounds.x, bounds.x + bounds.width - startData.width);\n    var newY = clamp(absoluteCoord.top, bounds.y, bounds.y + bounds.height - startData.height);\n    var newCoords = absolute$3(newX, newY);\n    return coords.fold(function () {\n      var offset$1 = asOffset(newCoords, scroll, origin);\n      return offset(offset$1.left, offset$1.top);\n    }, function () {\n      return newCoords;\n    }, function () {\n      var fixed = asFixed(newCoords, scroll, origin);\n      return fixed$1(fixed.left, fixed.top);\n    });\n  };\n\n  var calcNewCoord = function (component, optSnaps, currentCoord, scroll, origin, delta, startData) {\n    var newCoord = optSnaps.fold(function () {\n      var translated = translate$2(currentCoord, delta.left, delta.top);\n      var fixedCoord = asFixed(translated, scroll, origin);\n      return fixed$1(fixedCoord.left, fixedCoord.top);\n    }, function (snapInfo) {\n      var snapping = moveOrSnap(component, snapInfo, currentCoord, delta, scroll, origin);\n      snapping.extra.each(function (extra) {\n        snapInfo.onSensor(component, extra);\n      });\n      return snapping.coord;\n    });\n    return clampCoords(component, newCoord, scroll, origin, startData);\n  };\n\n  var dragBy = function (component, dragConfig, startData, delta) {\n    var target = dragConfig.getTarget(component.element);\n\n    if (dragConfig.repositionTarget) {\n      var doc = owner(component.element);\n      var scroll_1 = get$9(doc);\n      var origin_1 = getOrigin(target);\n      var currentCoord = getCurrentCoord(target);\n      var newCoord = calcNewCoord(component, dragConfig.snaps, currentCoord, scroll_1, origin_1, delta, startData);\n      var styles = toStyles(newCoord, scroll_1, origin_1);\n      setOptions(target, styles);\n    }\n\n    dragConfig.onDrag(component, target, delta);\n  };\n\n  var calcStartData = function (dragConfig, comp) {\n    return {\n      bounds: dragConfig.getBounds(),\n      height: getOuter$1(comp.element),\n      width: getOuter$2(comp.element)\n    };\n  };\n\n  var move$1 = function (component, dragConfig, dragState, dragMode, event) {\n    var delta = dragState.update(dragMode, event);\n    var dragStartData = dragState.getStartData().getOrThunk(function () {\n      return calcStartData(dragConfig, component);\n    });\n    delta.each(function (dlt) {\n      dragBy(component, dragConfig, dragStartData, dlt);\n    });\n  };\n\n  var stop = function (component, blocker, dragConfig, dragState) {\n    blocker.each(discard);\n    dragConfig.snaps.each(function (snapInfo) {\n      stopDrag(component, snapInfo);\n    });\n    var target = dragConfig.getTarget(component.element);\n    dragState.reset();\n    dragConfig.onDrop(component, target);\n  };\n\n  var handlers = function (events) {\n    return function (dragConfig, dragState) {\n      var updateStartState = function (comp) {\n        dragState.setStartData(calcStartData(dragConfig, comp));\n      };\n\n      return derive(__spreadArrays([run(windowScroll(), function (comp) {\n        dragState.getStartData().each(function () {\n          return updateStartState(comp);\n        });\n      })], events(dragConfig, dragState, updateStartState)));\n    };\n  };\n\n  var init$c = function (dragApi) {\n    return derive([run(mousedown(), dragApi.forceDrop), run(mouseup(), dragApi.drop), run(mousemove(), function (comp, simulatedEvent) {\n      dragApi.move(simulatedEvent.event);\n    }), run(mouseout(), dragApi.delayDrop)]);\n  };\n\n  var getData$1 = function (event) {\n    return Optional.from(SugarPosition(event.x, event.y));\n  };\n\n  var getDelta$1 = function (old, nu) {\n    return SugarPosition(nu.left - old.left, nu.top - old.top);\n  };\n\n  var MouseData = /*#__PURE__*/Object.freeze({\n    __proto__: null,\n    getData: getData$1,\n    getDelta: getDelta$1\n  });\n\n  var events$g = function (dragConfig, dragState, updateStartState) {\n    return [run(mousedown(), function (component, simulatedEvent) {\n      var raw = simulatedEvent.event.raw;\n\n      if (raw.button !== 0) {\n        return;\n      }\n\n      simulatedEvent.stop();\n\n      var stop$1 = function () {\n        return stop(component, Optional.some(blocker), dragConfig, dragState);\n      };\n\n      var delayDrop = DelayedFunction(stop$1, 200);\n      var dragApi = {\n        drop: stop$1,\n        delayDrop: delayDrop.schedule,\n        forceDrop: stop$1,\n        move: function (event) {\n          delayDrop.cancel();\n          move$1(component, dragConfig, dragState, MouseData, event);\n        }\n      };\n      var blocker = createComponent(component, dragConfig.blockerClass, init$c(dragApi));\n\n      var start = function () {\n        updateStartState(component);\n        instigate(component, blocker);\n      };\n\n      start();\n    })];\n  };\n\n  var schema$u = __spreadArrays(schema$t, [output('dragger', {\n    handlers: handlers(events$g)\n  })]);\n\n  var init$d = function (dragApi) {\n    return derive([run(touchstart(), dragApi.forceDrop), run(touchend(), dragApi.drop), run(touchcancel(), dragApi.drop), run(touchmove(), function (comp, simulatedEvent) {\n      dragApi.move(simulatedEvent.event);\n    })]);\n  };\n\n  var getDataFrom = function (touches) {\n    var touch = touches[0];\n    return Optional.some(SugarPosition(touch.clientX, touch.clientY));\n  };\n\n  var getData$2 = function (event) {\n    var raw = event.raw;\n    var touches = raw.touches;\n    return touches.length === 1 ? getDataFrom(touches) : Optional.none();\n  };\n\n  var getDelta$2 = function (old, nu) {\n    return SugarPosition(nu.left - old.left, nu.top - old.top);\n  };\n\n  var TouchData = /*#__PURE__*/Object.freeze({\n    __proto__: null,\n    getData: getData$2,\n    getDelta: getDelta$2\n  });\n\n  var events$h = function (dragConfig, dragState, updateStartState) {\n    var blockerCell = Cell(Optional.none());\n    return [run(touchstart(), function (component, simulatedEvent) {\n      simulatedEvent.stop();\n\n      var stop$1 = function () {\n        stop(component, blockerCell.get(), dragConfig, dragState);\n        blockerCell.set(Optional.none());\n      };\n\n      var dragApi = {\n        drop: stop$1,\n        delayDrop: noop,\n        forceDrop: stop$1,\n        move: function (event) {\n          move$1(component, dragConfig, dragState, TouchData, event);\n        }\n      };\n      var blocker = createComponent(component, dragConfig.blockerClass, init$d(dragApi));\n      blockerCell.set(Optional.some(blocker));\n\n      var start = function () {\n        updateStartState(component);\n        instigate(component, blocker);\n      };\n\n      start();\n    }), run(touchmove(), function (component, simulatedEvent) {\n      simulatedEvent.stop();\n      move$1(component, dragConfig, dragState, TouchData, simulatedEvent.event);\n    }), run(touchend(), function (component, simulatedEvent) {\n      simulatedEvent.stop();\n      stop(component, blockerCell.get(), dragConfig, dragState);\n      blockerCell.set(Optional.none());\n    }), run(touchcancel(), function (component) {\n      stop(component, blockerCell.get(), dragConfig, dragState);\n      blockerCell.set(Optional.none());\n    })];\n  };\n\n  var schema$v = __spreadArrays(schema$t, [output('dragger', {\n    handlers: handlers(events$h)\n  })]);\n\n  var events$i = function (dragConfig, dragState, updateStartState) {\n    return __spreadArrays(events$g(dragConfig, dragState, updateStartState), events$h(dragConfig, dragState, updateStartState));\n  };\n\n  var schema$w = __spreadArrays(schema$t, [output('dragger', {\n    handlers: handlers(events$i)\n  })]);\n\n  var mouse = schema$u;\n  var touch = schema$v;\n  var mouseOrTouch = schema$w;\n  var DraggingBranches = /*#__PURE__*/Object.freeze({\n    __proto__: null,\n    mouse: mouse,\n    touch: touch,\n    mouseOrTouch: mouseOrTouch\n  });\n\n  var init$e = function () {\n    var previous = Optional.none();\n    var startData = Optional.none();\n\n    var reset = function () {\n      previous = Optional.none();\n      startData = Optional.none();\n    };\n\n    var calculateDelta = function (mode, nu) {\n      var result = previous.map(function (old) {\n        return mode.getDelta(old, nu);\n      });\n      previous = Optional.some(nu);\n      return result;\n    };\n\n    var update = function (mode, dragEvent) {\n      return mode.getData(dragEvent).bind(function (nuData) {\n        return calculateDelta(mode, nuData);\n      });\n    };\n\n    var setStartData = function (data) {\n      startData = Optional.some(data);\n    };\n\n    var getStartData = function () {\n      return startData;\n    };\n\n    var readState = constant({});\n    return nu$5({\n      readState: readState,\n      reset: reset,\n      update: update,\n      getStartData: getStartData,\n      setStartData: setStartData\n    });\n  };\n\n  var DragState = /*#__PURE__*/Object.freeze({\n    __proto__: null,\n    init: init$e\n  });\n  var Dragging = createModes$1({\n    branchKey: 'mode',\n    branches: DraggingBranches,\n    name: 'dragging',\n    active: {\n      events: function (dragConfig, dragState) {\n        var dragger = dragConfig.dragger;\n        return dragger.handlers(dragConfig, dragState);\n      }\n    },\n    extra: {\n      snap: function (sConfig) {\n        return {\n          sensor: sConfig.sensor,\n          range: sConfig.range,\n          output: sConfig.output,\n          extra: Optional.from(sConfig.extra)\n        };\n      }\n    },\n    state: DragState,\n    apis: DraggingApis\n  });\n  var snapWidth = 40;\n  var snapOffset = snapWidth / 2;\n\n  var calcSnap = function (selectorOpt, td, x, y, width, height) {\n    return selectorOpt.fold(function () {\n      return Dragging.snap({\n        sensor: absolute$3(x - snapOffset, y - snapOffset),\n        range: SugarPosition(width, height),\n        output: absolute$3(Optional.some(x), Optional.some(y)),\n        extra: {\n          td: td\n        }\n      });\n    }, function (selectorHandle) {\n      var sensorLeft = x - snapOffset;\n      var sensorTop = y - snapOffset;\n      var sensorWidth = snapWidth;\n      var sensorHeight = snapWidth;\n      var rect = selectorHandle.element.dom.getBoundingClientRect();\n      return Dragging.snap({\n        sensor: absolute$3(sensorLeft, sensorTop),\n        range: SugarPosition(sensorWidth, sensorHeight),\n        output: absolute$3(Optional.some(x - rect.width / 2), Optional.some(y - rect.height / 2)),\n        extra: {\n          td: td\n        }\n      });\n    });\n  };\n\n  var getSnapsConfig = function (getSnapPoints, cell, onChange) {\n    var isSameCell = function (cellOpt, td) {\n      return cellOpt.exists(function (currentTd) {\n        return eq$1(currentTd, td);\n      });\n    };\n\n    return {\n      getSnapPoints: getSnapPoints,\n      leftAttr: 'data-drag-left',\n      topAttr: 'data-drag-top',\n      onSensor: function (component, extra) {\n        var td = extra.td;\n\n        if (!isSameCell(cell.get(), td)) {\n          cell.set(Optional.some(td));\n          onChange(td);\n        }\n      },\n      mustSnap: true\n    };\n  };\n\n  var createSelector = function (snaps) {\n    return record(Button.sketch({\n      dom: {\n        tag: 'div',\n        classes: ['tox-selector']\n      },\n      buttonBehaviours: derive$1([Dragging.config({\n        mode: 'mouseOrTouch',\n        blockerClass: 'blocker',\n        snaps: snaps\n      }), Unselecting.config({})]),\n      eventOrder: {\n        mousedown: ['dragging', 'alloy.base.behaviour'],\n        touchstart: ['dragging', 'alloy.base.behaviour']\n      }\n    }));\n  };\n\n  var setup$a = function (editor, sink) {\n    var tlTds = Cell([]);\n    var brTds = Cell([]);\n    var isVisible = Cell(false);\n    var startCell = Cell(Optional.none());\n    var finishCell = Cell(Optional.none());\n\n    var getTopLeftSnap = function (td) {\n      var box = absolute$1(td);\n      return calcSnap(memTopLeft.getOpt(sink), td, box.x, box.y, box.width, box.height);\n    };\n\n    var getTopLeftSnaps = function () {\n      return map(tlTds.get(), function (td) {\n        return getTopLeftSnap(td);\n      });\n    };\n\n    var getBottomRightSnap = function (td) {\n      var box = absolute$1(td);\n      return calcSnap(memBottomRight.getOpt(sink), td, box.right, box.bottom, box.width, box.height);\n    };\n\n    var getBottomRightSnaps = function () {\n      return map(brTds.get(), function (td) {\n        return getBottomRightSnap(td);\n      });\n    };\n\n    var topLeftSnaps = getSnapsConfig(getTopLeftSnaps, startCell, function (start) {\n      finishCell.get().each(function (finish) {\n        editor.fire('TableSelectorChange', {\n          start: start,\n          finish: finish\n        });\n      });\n    });\n    var bottomRightSnaps = getSnapsConfig(getBottomRightSnaps, finishCell, function (finish) {\n      startCell.get().each(function (start) {\n        editor.fire('TableSelectorChange', {\n          start: start,\n          finish: finish\n        });\n      });\n    });\n    var memTopLeft = createSelector(topLeftSnaps);\n    var memBottomRight = createSelector(bottomRightSnaps);\n    var topLeft = build$1(memTopLeft.asSpec());\n    var bottomRight = build$1(memBottomRight.asSpec());\n\n    var showOrHideHandle = function (selector, cell, isAbove, isBelow) {\n      var cellRect = cell.dom.getBoundingClientRect();\n      remove$6(selector.element, 'display');\n      var viewportHeight = defaultView(SugarElement.fromDom(editor.getBody())).dom.innerHeight;\n      var aboveViewport = isAbove(cellRect);\n      var belowViewport = isBelow(cellRect, viewportHeight);\n\n      if (aboveViewport || belowViewport) {\n        set$2(selector.element, 'display', 'none');\n      }\n    };\n\n    var snapTo = function (selector, cell, getSnapConfig, pos) {\n      var snap = getSnapConfig(cell);\n      Dragging.snapTo(selector, snap);\n\n      var isAbove = function (rect) {\n        return rect[pos] < 0;\n      };\n\n      var isBelow = function (rect, viewportHeight) {\n        return rect[pos] > viewportHeight;\n      };\n\n      showOrHideHandle(selector, cell, isAbove, isBelow);\n    };\n\n    var snapTopLeft = function (cell) {\n      return snapTo(topLeft, cell, getTopLeftSnap, 'top');\n    };\n\n    var snapLastTopLeft = function () {\n      return startCell.get().each(snapTopLeft);\n    };\n\n    var snapBottomRight = function (cell) {\n      return snapTo(bottomRight, cell, getBottomRightSnap, 'bottom');\n    };\n\n    var snapLastBottomRight = function () {\n      return finishCell.get().each(snapBottomRight);\n    };\n\n    if (detect$3().deviceType.isTouch()) {\n      editor.on('TableSelectionChange', function (e) {\n        if (!isVisible.get()) {\n          attach$1(sink, topLeft);\n          attach$1(sink, bottomRight);\n          isVisible.set(true);\n        }\n\n        startCell.set(Optional.some(e.start));\n        finishCell.set(Optional.some(e.finish));\n        e.otherCells.each(function (otherCells) {\n          tlTds.set(otherCells.upOrLeftCells);\n          brTds.set(otherCells.downOrRightCells);\n          snapTopLeft(e.start);\n          snapBottomRight(e.finish);\n        });\n      });\n      editor.on('ResizeEditor ResizeWindow ScrollContent', function () {\n        snapLastTopLeft();\n        snapLastBottomRight();\n      });\n      editor.on('TableSelectionClear', function () {\n        if (isVisible.get()) {\n          detach(topLeft);\n          detach(bottomRight);\n          isVisible.set(false);\n        }\n\n        startCell.set(Optional.none());\n        finishCell.set(Optional.none());\n      });\n    }\n  };\n\n  var isHidden$1 = function (elm) {\n    if (elm.nodeType === 1) {\n      if (elm.nodeName === 'BR' || !!elm.getAttribute('data-mce-bogus')) {\n        return true;\n      }\n\n      if (elm.getAttribute('data-mce-type') === 'bookmark') {\n        return true;\n      }\n    }\n\n    return false;\n  };\n\n  var renderElementPath = function (editor, settings, providersBackstage) {\n    if (!settings.delimiter) {\n      settings.delimiter = '\\xBB';\n    }\n\n    var getDataPath = function (data) {\n      var parts = data || [];\n      var newPathElements = map(parts, function (part, index) {\n        return Button.sketch({\n          dom: {\n            tag: 'div',\n            classes: ['tox-statusbar__path-item'],\n            attributes: {\n              'role': 'button',\n              'data-index': index,\n              'tab-index': -1,\n              'aria-level': index + 1\n            },\n            innerHtml: part.name\n          },\n          action: function (_btn) {\n            editor.focus();\n            editor.selection.select(part.element);\n            editor.nodeChanged();\n          },\n          buttonBehaviours: derive$1([DisablingConfigs.button(providersBackstage.isDisabled), receivingConfig()])\n        });\n      });\n      var divider = {\n        dom: {\n          tag: 'div',\n          classes: ['tox-statusbar__path-divider'],\n          attributes: {\n            'aria-hidden': true\n          },\n          innerHtml: ' ' + settings.delimiter + ' '\n        }\n      };\n      return foldl(newPathElements.slice(1), function (acc, element) {\n        var newAcc = acc;\n        newAcc.push(divider);\n        newAcc.push(element);\n        return newAcc;\n      }, [newPathElements[0]]);\n    };\n\n    var updatePath = function (parents) {\n      var newPath = [];\n      var i = parents.length;\n\n      while (i-- > 0) {\n        var parent_1 = parents[i];\n\n        if (parent_1.nodeType === 1 && !isHidden$1(parent_1)) {\n          var args = editor.fire('ResolveName', {\n            name: parent_1.nodeName.toLowerCase(),\n            target: parent_1\n          });\n\n          if (!args.isDefaultPrevented()) {\n            newPath.push({\n              name: args.name,\n              element: parent_1\n            });\n          }\n\n          if (args.isPropagationStopped()) {\n            break;\n          }\n        }\n      }\n\n      return newPath;\n    };\n\n    return {\n      dom: {\n        tag: 'div',\n        classes: ['tox-statusbar__path'],\n        attributes: {\n          role: 'navigation'\n        }\n      },\n      behaviours: derive$1([Keying.config({\n        mode: 'flow',\n        selector: 'div[role=button]'\n      }), Disabling.config({\n        disabled: providersBackstage.isDisabled\n      }), receivingConfig(), Tabstopping.config({}), Replacing.config({}), config('elementPathEvents', [runOnAttached(function (comp, _e) {\n        editor.shortcuts.add('alt+F11', 'focus statusbar elementpath', function () {\n          return Keying.focusIn(comp);\n        });\n        editor.on('NodeChange', function (e) {\n          var newPath = updatePath(e.parents);\n\n          if (newPath.length > 0) {\n            Replacing.set(comp, getDataPath(newPath));\n          } else {\n            Replacing.set(comp, []);\n          }\n        });\n      })])]),\n      components: []\n    };\n  };\n\n  var ResizeTypes;\n\n  (function (ResizeTypes) {\n    ResizeTypes[ResizeTypes['None'] = 0] = 'None';\n    ResizeTypes[ResizeTypes['Both'] = 1] = 'Both';\n    ResizeTypes[ResizeTypes['Vertical'] = 2] = 'Vertical';\n  })(ResizeTypes || (ResizeTypes = {}));\n\n  var getDimensions = function (editor, deltas, resizeType, originalHeight, originalWidth) {\n    var dimensions = {};\n    dimensions.height = calcCappedSize(originalHeight + deltas.top, getMinHeightSetting(editor), getMaxHeightSetting(editor));\n\n    if (resizeType === ResizeTypes.Both) {\n      dimensions.width = calcCappedSize(originalWidth + deltas.left, getMinWidthSetting(editor), getMaxWidthSetting(editor));\n    }\n\n    return dimensions;\n  };\n\n  var resize$3 = function (editor, deltas, resizeType) {\n    var container = SugarElement.fromDom(editor.getContainer());\n    var dimensions = getDimensions(editor, deltas, resizeType, get$7(container), get$8(container));\n    each$1(dimensions, function (val, dim) {\n      return set$2(container, dim, numToPx(val));\n    });\n    fireResizeEditor(editor);\n  };\n\n  var getResizeType = function (editor) {\n    var fallback = !editor.hasPlugin('autoresize');\n    var resize = editor.getParam('resize', fallback);\n\n    if (resize === false) {\n      return ResizeTypes.None;\n    } else if (resize === 'both') {\n      return ResizeTypes.Both;\n    } else {\n      return ResizeTypes.Vertical;\n    }\n  };\n\n  var keyboardHandler = function (editor, resizeType, x, y) {\n    var scale = 20;\n    var delta = SugarPosition(x * scale, y * scale);\n    resize$3(editor, delta, resizeType);\n    return Optional.some(true);\n  };\n\n  var renderResizeHandler = function (editor, providersBackstage) {\n    var resizeType = getResizeType(editor);\n\n    if (resizeType === ResizeTypes.None) {\n      return Optional.none();\n    }\n\n    return Optional.some({\n      dom: {\n        tag: 'div',\n        classes: ['tox-statusbar__resize-handle'],\n        attributes: {\n          title: providersBackstage.translate('Resize')\n        },\n        innerHtml: get$e('resize-handle', providersBackstage.icons)\n      },\n      behaviours: derive$1([Dragging.config({\n        mode: 'mouse',\n        repositionTarget: false,\n        onDrag: function (_comp, _target, delta) {\n          return resize$3(editor, delta, resizeType);\n        },\n        blockerClass: 'tox-blocker'\n      }), Keying.config({\n        mode: 'special',\n        onLeft: function () {\n          return keyboardHandler(editor, resizeType, -1, 0);\n        },\n        onRight: function () {\n          return keyboardHandler(editor, resizeType, 1, 0);\n        },\n        onUp: function () {\n          return keyboardHandler(editor, resizeType, 0, -1);\n        },\n        onDown: function () {\n          return keyboardHandler(editor, resizeType, 0, 1);\n        }\n      }), Tabstopping.config({}), Focusing.config({})])\n    });\n  };\n\n  var renderWordCount = function (editor, providersBackstage) {\n    var _a;\n\n    var replaceCountText = function (comp, count, mode) {\n      return Replacing.set(comp, [text(providersBackstage.translate(['{0} ' + mode, count[mode]]))]);\n    };\n\n    return Button.sketch({\n      dom: {\n        tag: 'button',\n        classes: ['tox-statusbar__wordcount']\n      },\n      components: [],\n      buttonBehaviours: derive$1([DisablingConfigs.button(providersBackstage.isDisabled), receivingConfig(), Tabstopping.config({}), Replacing.config({}), Representing.config({\n        store: {\n          mode: 'memory',\n          initialValue: {\n            mode: 'words',\n            count: {\n              words: 0,\n              characters: 0\n            }\n          }\n        }\n      }), config('wordcount-events', [runOnExecute(function (comp) {\n        var currentVal = Representing.getValue(comp);\n        var newMode = currentVal.mode === 'words' ? 'characters' : 'words';\n        Representing.setValue(comp, {\n          mode: newMode,\n          count: currentVal.count\n        });\n        replaceCountText(comp, currentVal.count, newMode);\n      }), runOnAttached(function (comp) {\n        editor.on('wordCountUpdate', function (e) {\n          var mode = Representing.getValue(comp).mode;\n          Representing.setValue(comp, {\n            mode: mode,\n            count: e.wordCount\n          });\n          replaceCountText(comp, e.wordCount, mode);\n        });\n      })])]),\n      eventOrder: (_a = {}, _a[execute()] = ['disabling', 'alloy.base.behaviour', 'wordcount-events'], _a)\n    });\n  };\n\n  var renderStatusbar = function (editor, providersBackstage) {\n    var renderBranding = function () {\n      var label = global$6.translate(['Powered by {0}', 'Tiny']);\n      var linkHtml = '<a href=\"https://www.tiny.cloud/?utm_campaign=editor_referral&amp;utm_medium=poweredby&amp;utm_source=tinymce&amp;utm_content=v5\" rel=\"noopener\" target=\"_blank\" tabindex=\"-1\" aria-label=\"' + label + '\">' + label + '</a>';\n      return {\n        dom: {\n          tag: 'span',\n          classes: ['tox-statusbar__branding'],\n          innerHtml: linkHtml\n        }\n      };\n    };\n\n    var getTextComponents = function () {\n      var components = [];\n\n      if (editor.getParam('elementpath', true, 'boolean')) {\n        components.push(renderElementPath(editor, {}, providersBackstage));\n      }\n\n      if (editor.hasPlugin('wordcount')) {\n        components.push(renderWordCount(editor, providersBackstage));\n      }\n\n      if (editor.getParam('branding', true, 'boolean')) {\n        components.push(renderBranding());\n      }\n\n      if (components.length > 0) {\n        return [{\n          dom: {\n            tag: 'div',\n            classes: ['tox-statusbar__text-container']\n          },\n          components: components\n        }];\n      }\n\n      return [];\n    };\n\n    var getComponents = function () {\n      var components = getTextComponents();\n      var resizeHandler = renderResizeHandler(editor, providersBackstage);\n      return components.concat(resizeHandler.toArray());\n    };\n\n    return {\n      dom: {\n        tag: 'div',\n        classes: ['tox-statusbar']\n      },\n      components: getComponents()\n    };\n  };\n\n  var setup$b = function (editor) {\n    var _a;\n\n    var isInline = editor.inline;\n    var mode = isInline ? Inline : Iframe;\n    var header = isStickyToolbar(editor) ? StickyHeader : StaticHeader;\n    var lazyOuterContainer = Optional.none();\n    var platform = detect$3();\n    var isIE = platform.browser.isIE();\n    var platformClasses = isIE ? ['tox-platform-ie'] : [];\n    var isTouch = platform.deviceType.isTouch();\n    var touchPlatformClass = 'tox-platform-touch';\n    var deviceClasses = isTouch ? [touchPlatformClass] : [];\n    var isToolbarBottom = isToolbarLocationBottom(editor);\n    var uiContainer = getUiContainer(editor);\n    var dirAttributes = global$6.isRtl() ? {\n      attributes: {\n        dir: 'rtl'\n      }\n    } : {};\n    var verticalDirAttributes = {\n      attributes: (_a = {}, _a[Attribute] = isToolbarBottom ? AttributeValue.BottomToTop : AttributeValue.TopToBottom, _a)\n    };\n\n    var lazyHeader = function () {\n      return lazyOuterContainer.bind(OuterContainer.getHeader);\n    };\n\n    var isHeaderDocked = function () {\n      return header.isDocked(lazyHeader);\n    };\n\n    var resizeUiMothership = function () {\n      set$2(uiMothership.element, 'width', document.body.clientWidth + 'px');\n    };\n\n    var makeSinkDefinition = function () {\n      var isGridUiContainer = eq$1(body(), uiContainer) && get$5(uiContainer, 'display') === 'grid';\n      var sinkSpec = {\n        dom: __assign({\n          tag: 'div',\n          classes: ['tox', 'tox-silver-sink', 'tox-tinymce-aux'].concat(platformClasses).concat(deviceClasses)\n        }, dirAttributes),\n        behaviours: derive$1([Positioning.config({\n          useFixed: function () {\n            return isHeaderDocked();\n          }\n        })])\n      };\n      var reactiveWidthSpec = {\n        dom: {\n          styles: {\n            width: document.body.clientWidth + 'px'\n          }\n        },\n        events: derive([run(windowResize(), resizeUiMothership)])\n      };\n      return deepMerge(sinkSpec, isGridUiContainer ? reactiveWidthSpec : {});\n    };\n\n    var sink = build$1(makeSinkDefinition());\n\n    var lazySink = function () {\n      return Result.value(sink);\n    };\n\n    var memAnchorBar = record({\n      dom: {\n        tag: 'div',\n        classes: ['tox-anchorbar']\n      }\n    });\n\n    var lazyAnchorBar = function () {\n      return lazyOuterContainer.bind(function (container) {\n        return memAnchorBar.getOpt(container);\n      }).getOrDie('Could not find a anchor bar element');\n    };\n\n    var lazyToolbar = function () {\n      return lazyOuterContainer.bind(function (container) {\n        return OuterContainer.getToolbar(container);\n      }).getOrDie('Could not find more toolbar element');\n    };\n\n    var lazyThrobber = function () {\n      return lazyOuterContainer.bind(function (container) {\n        return OuterContainer.getThrobber(container);\n      }).getOrDie('Could not find throbber element');\n    };\n\n    var backstage = init$8(sink, editor, lazyAnchorBar);\n    var partMenubar = OuterContainer.parts.menubar({\n      dom: {\n        tag: 'div',\n        classes: ['tox-menubar']\n      },\n      backstage: backstage,\n      onEscape: function () {\n        editor.focus();\n      }\n    });\n    var toolbarMode = getToolbarMode(editor);\n    var partToolbar = OuterContainer.parts.toolbar(__assign({\n      dom: {\n        tag: 'div',\n        classes: ['tox-toolbar']\n      },\n      getSink: lazySink,\n      providers: backstage.shared.providers,\n      onEscape: function () {\n        editor.focus();\n      },\n      type: toolbarMode,\n      lazyToolbar: lazyToolbar,\n      lazyHeader: function () {\n        return lazyHeader().getOrDie('Could not find header element');\n      }\n    }, verticalDirAttributes));\n    var partMultipleToolbar = OuterContainer.parts['multiple-toolbar']({\n      dom: {\n        tag: 'div',\n        classes: ['tox-toolbar-overlord']\n      },\n      providers: backstage.shared.providers,\n      onEscape: function () {\n        editor.focus();\n      },\n      type: toolbarMode\n    });\n    var partSocket = OuterContainer.parts.socket({\n      dom: {\n        tag: 'div',\n        classes: ['tox-edit-area']\n      }\n    });\n    var partSidebar = OuterContainer.parts.sidebar({\n      dom: {\n        tag: 'div',\n        classes: ['tox-sidebar']\n      }\n    });\n    var partThrobber = OuterContainer.parts.throbber({\n      dom: {\n        tag: 'div',\n        classes: ['tox-throbber']\n      },\n      backstage: backstage\n    });\n    var sb = editor.getParam('statusbar', true, 'boolean');\n    var statusbar = sb && !isInline ? Optional.some(renderStatusbar(editor, backstage.shared.providers)) : Optional.none();\n    var socketSidebarContainer = {\n      dom: {\n        tag: 'div',\n        classes: ['tox-sidebar-wrap']\n      },\n      components: [partSocket, partSidebar]\n    };\n    var hasMultipleToolbar = isMultipleToolbars(editor);\n    var hasToolbar = isToolbarEnabled(editor);\n    var hasMenubar = isMenubarEnabled(editor);\n\n    var getPartToolbar = function () {\n      if (hasMultipleToolbar) {\n        return [partMultipleToolbar];\n      } else if (hasToolbar) {\n        return [partToolbar];\n      } else {\n        return [];\n      }\n    };\n\n    var partHeader = OuterContainer.parts.header({\n      dom: __assign({\n        tag: 'div',\n        classes: ['tox-editor-header']\n      }, verticalDirAttributes),\n      components: flatten([hasMenubar ? [partMenubar] : [], getPartToolbar(), useFixedContainer(editor) ? [] : [memAnchorBar.asSpec()]]),\n      sticky: isStickyToolbar(editor),\n      editor: editor,\n      sharedBackstage: backstage.shared\n    });\n    var editorComponents = flatten([isToolbarBottom ? [] : [partHeader], isInline ? [] : [socketSidebarContainer], isToolbarBottom ? [partHeader] : []]);\n    var editorContainer = {\n      dom: {\n        tag: 'div',\n        classes: ['tox-editor-container']\n      },\n      components: editorComponents\n    };\n    var containerComponents = flatten([[editorContainer], isInline ? [] : statusbar.toArray(), [partThrobber]]);\n    var isHidden = isDistractionFree(editor);\n\n    var attributes = __assign(__assign({\n      role: 'application'\n    }, global$6.isRtl() ? {\n      dir: 'rtl'\n    } : {}), isHidden ? {\n      'aria-hidden': 'true'\n    } : {});\n\n    var outerContainer = build$1(OuterContainer.sketch({\n      dom: {\n        tag: 'div',\n        classes: ['tox', 'tox-tinymce'].concat(isInline ? ['tox-tinymce-inline'] : []).concat(isToolbarBottom ? ['tox-tinymce--toolbar-bottom'] : []).concat(deviceClasses).concat(platformClasses),\n        styles: __assign({\n          visibility: 'hidden'\n        }, isHidden ? {\n          opacity: '0',\n          border: '0'\n        } : {}),\n        attributes: attributes\n      },\n      components: containerComponents,\n      behaviours: derive$1([receivingConfig(), Disabling.config({\n        disableClass: 'tox-tinymce--disabled'\n      }), Keying.config({\n        mode: 'cyclic',\n        selector: '.tox-menubar, .tox-toolbar, .tox-toolbar__primary, .tox-toolbar__overflow--open, .tox-sidebar__overflow--open, .tox-statusbar__path, .tox-statusbar__wordcount, .tox-statusbar__branding a, .tox-statusbar__resize-handle'\n      })])\n    }));\n    lazyOuterContainer = Optional.some(outerContainer);\n    editor.shortcuts.add('alt+F9', 'focus menubar', function () {\n      OuterContainer.focusMenubar(outerContainer);\n    });\n    editor.shortcuts.add('alt+F10', 'focus toolbar', function () {\n      OuterContainer.focusToolbar(outerContainer);\n    });\n    editor.addCommand('ToggleToolbarDrawer', function () {\n      OuterContainer.toggleToolbarDrawer(outerContainer);\n    });\n    editor.addQueryStateHandler('ToggleToolbarDrawer', function () {\n      return OuterContainer.isToolbarDrawerToggled(outerContainer);\n    });\n    var mothership = takeover(outerContainer);\n    var uiMothership = takeover(sink);\n    setup$3(editor, mothership, uiMothership);\n\n    var getUi = function () {\n      var channels = {\n        broadcastAll: uiMothership.broadcast,\n        broadcastOn: uiMothership.broadcastOn,\n        register: noop\n      };\n      return {\n        channels: channels\n      };\n    };\n\n    var setEditorSize = function () {\n      var parsedHeight = numToPx(getHeightWithFallback(editor));\n      var parsedWidth = numToPx(getWidthWithFallback(editor));\n\n      if (!editor.inline) {\n        if (isValidValue('div', 'width', parsedWidth)) {\n          set$2(outerContainer.element, 'width', parsedWidth);\n        }\n\n        if (isValidValue('div', 'height', parsedHeight)) {\n          set$2(outerContainer.element, 'height', parsedHeight);\n        } else {\n          set$2(outerContainer.element, 'height', '200px');\n        }\n      }\n\n      return parsedHeight;\n    };\n\n    var renderUI = function () {\n      header.setup(editor, backstage.shared, lazyHeader);\n      setup$8(editor, backstage);\n      setup$9(editor, lazySink, backstage);\n      setup$6(editor);\n      setup$7(editor, lazyThrobber, backstage.shared);\n      map$2(getToolbarGroups(editor), function (toolbarGroupButtonConfig, name) {\n        editor.ui.registry.addGroupToolbarButton(name, toolbarGroupButtonConfig);\n      });\n\n      var _a = editor.ui.registry.getAll(),\n          buttons = _a.buttons,\n          menuItems = _a.menuItems,\n          contextToolbars = _a.contextToolbars,\n          sidebars = _a.sidebars;\n\n      var toolbarOpt = getMultipleToolbarsSetting(editor);\n      var rawUiConfig = {\n        menuItems: menuItems,\n        menus: getMenus(editor),\n        menubar: getMenubar(editor),\n        toolbar: toolbarOpt.getOrThunk(function () {\n          return getToolbar(editor);\n        }),\n        allowToolbarGroups: toolbarMode === ToolbarMode.floating,\n        buttons: buttons,\n        sidebar: sidebars\n      };\n      register$4(editor, contextToolbars, sink, {\n        backstage: backstage\n      });\n      setup$a(editor, sink);\n      var elm = editor.getElement();\n      var height = setEditorSize();\n      var uiComponents = {\n        mothership: mothership,\n        uiMothership: uiMothership,\n        outerContainer: outerContainer\n      };\n      var args = {\n        targetNode: elm,\n        height: height\n      };\n      return mode.render(editor, uiComponents, rawUiConfig, backstage, args);\n    };\n\n    return {\n      mothership: mothership,\n      uiMothership: uiMothership,\n      backstage: backstage,\n      renderUI: renderUI,\n      getUi: getUi\n    };\n  };\n\n  var describedBy = function (describedElement, describeElement) {\n    var describeId = Optional.from(get$3(describedElement, 'id')).fold(function () {\n      var id = generate$1('dialog-describe');\n      set$1(describeElement, 'id', id);\n      return id;\n    }, identity);\n    set$1(describedElement, 'aria-describedby', describeId);\n  };\n\n  var labelledBy = function (labelledElement, labelElement) {\n    var labelId = getOpt(labelledElement, 'id').fold(function () {\n      var id = generate$1('dialog-label');\n      set$1(labelElement, 'id', id);\n      return id;\n    }, identity);\n    set$1(labelledElement, 'aria-labelledby', labelId);\n  };\n\n  var schema$x = constant([strict$1('lazySink'), option('dragBlockClass'), defaultedFunction('getBounds', win), defaulted$1('useTabstopAt', always), defaulted$1('eventOrder', {}), field$1('modalBehaviours', [Keying]), onKeyboardHandler('onExecute'), onStrictKeyboardHandler('onEscape')]);\n  var basic = {\n    sketch: identity\n  };\n  var parts$f = constant([optional({\n    name: 'draghandle',\n    overrides: function (detail, spec) {\n      return {\n        behaviours: derive$1([Dragging.config({\n          mode: 'mouse',\n          getTarget: function (handle) {\n            return ancestor$2(handle, '[role=\"dialog\"]').getOr(handle);\n          },\n          blockerClass: detail.dragBlockClass.getOrDie(new Error('The drag blocker class was not specified for a dialog with a drag handle: \\n' + JSON.stringify(spec, null, 2)).message),\n          getBounds: detail.getDragBounds\n        })])\n      };\n    }\n  }), required({\n    schema: [strict$1('dom')],\n    name: 'title'\n  }), required({\n    factory: basic,\n    schema: [strict$1('dom')],\n    name: 'close'\n  }), required({\n    factory: basic,\n    schema: [strict$1('dom')],\n    name: 'body'\n  }), optional({\n    factory: basic,\n    schema: [strict$1('dom')],\n    name: 'footer'\n  }), external$1({\n    factory: {\n      sketch: function (spec, detail) {\n        return __assign(__assign({}, spec), {\n          dom: detail.dom,\n          components: detail.components\n        });\n      }\n    },\n    schema: [defaulted$1('dom', {\n      tag: 'div',\n      styles: {\n        position: 'fixed',\n        left: '0px',\n        top: '0px',\n        right: '0px',\n        bottom: '0px'\n      }\n    }), defaulted$1('components', [])],\n    name: 'blocker'\n  })]);\n\n  var block = function (component, config, state, getBusySpec) {\n    set$1(component.element, 'aria-busy', true);\n    var root = config.getRoot(component).getOr(component);\n    var blockerBehaviours = derive$1([Keying.config({\n      mode: 'special',\n      onTab: function () {\n        return Optional.some(true);\n      },\n      onShiftTab: function () {\n        return Optional.some(true);\n      }\n    }), Focusing.config({})]);\n    var blockSpec = getBusySpec(root, blockerBehaviours);\n    var blocker = root.getSystem().build(blockSpec);\n    Replacing.append(root, premade$1(blocker));\n\n    if (blocker.hasConfigured(Keying)) {\n      Keying.focusIn(blocker);\n    }\n\n    if (!state.isBlocked()) {\n      config.onBlock(component);\n    }\n\n    state.blockWith(function () {\n      return Replacing.remove(root, blocker);\n    });\n  };\n\n  var unblock = function (component, config, state) {\n    remove$1(component.element, 'aria-busy');\n\n    if (state.isBlocked()) {\n      config.onUnblock(component);\n    }\n\n    state.clear();\n  };\n\n  var BlockingApis = /*#__PURE__*/Object.freeze({\n    __proto__: null,\n    block: block,\n    unblock: unblock\n  });\n  var BlockingSchema = [defaultedFunction('getRoot', Optional.none), onHandler('onBlock'), onHandler('onUnblock')];\n\n  var init$f = function () {\n    var blocker = destroyable();\n\n    var blockWith = function (destroy) {\n      blocker.set({\n        destroy: destroy\n      });\n    };\n\n    return nu$5({\n      readState: blocker.isSet,\n      blockWith: blockWith,\n      clear: blocker.clear,\n      isBlocked: blocker.isSet\n    });\n  };\n\n  var BlockingState = /*#__PURE__*/Object.freeze({\n    __proto__: null,\n    init: init$f\n  });\n  var Blocking = create$1({\n    fields: BlockingSchema,\n    name: 'blocking',\n    apis: BlockingApis,\n    state: BlockingState\n  });\n\n  var factory$i = function (detail, components, spec, externals) {\n    var _a;\n\n    var dialogComp = Cell(Optional.none());\n\n    var showDialog = function (dialog) {\n      dialogComp.set(Optional.some(dialog));\n      var sink = detail.lazySink(dialog).getOrDie();\n      var externalBlocker = externals.blocker();\n      var blocker = sink.getSystem().build(__assign(__assign({}, externalBlocker), {\n        components: externalBlocker.components.concat([premade$1(dialog)]),\n        behaviours: derive$1([Focusing.config({}), config('dialog-blocker-events', [runOnSource(focusin(), function () {\n          Keying.focusIn(dialog);\n        })])])\n      }));\n      attach$1(sink, blocker);\n      Keying.focusIn(dialog);\n    };\n\n    var hideDialog = function (dialog) {\n      dialogComp.set(Optional.none());\n      parent(dialog.element).each(function (blockerDom) {\n        dialog.getSystem().getByDom(blockerDom).each(function (blocker) {\n          detach(blocker);\n        });\n      });\n    };\n\n    var getDialogBody = function (dialog) {\n      return getPartOrDie(dialog, detail, 'body');\n    };\n\n    var getDialogFooter = function (dialog) {\n      return getPartOrDie(dialog, detail, 'footer');\n    };\n\n    var setBusy = function (dialog, getBusySpec) {\n      Blocking.block(dialog, getBusySpec);\n    };\n\n    var setIdle = function (dialog) {\n      Blocking.unblock(dialog);\n    };\n\n    var modalEventsId = generate$1('modal-events');\n\n    var eventOrder = __assign(__assign({}, detail.eventOrder), (_a = {}, _a[attachedToDom()] = [modalEventsId].concat(detail.eventOrder['alloy.system.attached'] || []), _a));\n\n    return {\n      uid: detail.uid,\n      dom: detail.dom,\n      components: components,\n      apis: {\n        show: showDialog,\n        hide: hideDialog,\n        getBody: getDialogBody,\n        getFooter: getDialogFooter,\n        setIdle: setIdle,\n        setBusy: setBusy\n      },\n      eventOrder: eventOrder,\n      domModification: {\n        attributes: {\n          'role': 'dialog',\n          'aria-modal': 'true'\n        }\n      },\n      behaviours: augment(detail.modalBehaviours, [Replacing.config({}), Keying.config({\n        mode: 'cyclic',\n        onEnter: detail.onExecute,\n        onEscape: detail.onEscape,\n        useTabstopAt: detail.useTabstopAt\n      }), Blocking.config({\n        getRoot: dialogComp.get\n      }), config(modalEventsId, [runOnAttached(function (c) {\n        labelledBy(c.element, getPartOrDie(c, detail, 'title').element);\n        describedBy(c.element, getPartOrDie(c, detail, 'body').element);\n      })])])\n    };\n  };\n\n  var ModalDialog = composite$1({\n    name: 'ModalDialog',\n    configFields: schema$x(),\n    partFields: parts$f(),\n    factory: factory$i,\n    apis: {\n      show: function (apis, dialog) {\n        apis.show(dialog);\n      },\n      hide: function (apis, dialog) {\n        apis.hide(dialog);\n      },\n      getBody: function (apis, dialog) {\n        return apis.getBody(dialog);\n      },\n      getFooter: function (apis, dialog) {\n        return apis.getFooter(dialog);\n      },\n      setBusy: function (apis, dialog, getBusySpec) {\n        apis.setBusy(dialog, getBusySpec);\n      },\n      setIdle: function (apis, dialog) {\n        apis.setIdle(dialog);\n      }\n    }\n  });\n  var dialogToggleMenuItemSchema = objOf([strictString('type'), strictString('name')].concat(commonMenuItemFields));\n  var dialogToggleMenuItemDataProcessor = boolean;\n  var baseFooterButtonFields = [field('name', 'name', defaultedThunk(function () {\n    return generate$1('button-name');\n  }), string), optionString('icon'), defaultedStringEnum('align', 'end', ['start', 'end']), defaultedBoolean('primary', false), defaultedBoolean('disabled', false)];\n\n  var dialogFooterButtonFields = __spreadArrays(baseFooterButtonFields, [strictString('text')]);\n\n  var normalFooterButtonFields = __spreadArrays([strictStringEnum('type', ['submit', 'cancel', 'custom'])], dialogFooterButtonFields);\n\n  var menuFooterButtonFields = __spreadArrays([strictStringEnum('type', ['menu']), optionString('text'), optionString('tooltip'), optionString('icon'), strictArrayOf('items', dialogToggleMenuItemSchema)], baseFooterButtonFields);\n\n  var dialogFooterButtonSchema = choose$1('type', {\n    submit: normalFooterButtonFields,\n    cancel: normalFooterButtonFields,\n    custom: normalFooterButtonFields,\n    menu: menuFooterButtonFields\n  });\n  var alertBannerFields = [strictString('type'), strictString('text'), strictStringEnum('level', ['info', 'warn', 'error', 'success']), strictString('icon'), defaulted$1('url', '')];\n  var alertBannerSchema = objOf(alertBannerFields);\n\n  var createBarFields = function (itemsField) {\n    return [strictString('type'), itemsField];\n  };\n\n  var buttonFields = [strictString('type'), strictString('text'), defaultedBoolean('disabled', false), defaultedBoolean('primary', false), field('name', 'name', defaultedThunk(function () {\n    return generate$1('button-name');\n  }), string), optionString('icon'), defaultedBoolean('borderless', false)];\n  var buttonSchema = objOf(buttonFields);\n  var checkboxFields = [strictString('type'), strictString('name'), strictString('label'), defaultedBoolean('disabled', false)];\n  var checkboxSchema = objOf(checkboxFields);\n  var checkboxDataProcessor = boolean;\n  var formComponentFields = [strictString('type'), strictString('name')];\n  var formComponentWithLabelFields = formComponentFields.concat([optionString('label')]);\n  var collectionFields = formComponentWithLabelFields.concat([defaulted$1('columns', 'auto')]);\n  var collectionSchema = objOf(collectionFields);\n  var collectionDataProcessor = arrOfObj$1([strictString('value'), strictString('text'), strictString('icon')]);\n  var colorInputFields = formComponentWithLabelFields;\n  var colorInputSchema = objOf(colorInputFields);\n  var colorInputDataProcessor = string;\n  var colorPickerFields = formComponentWithLabelFields;\n  var colorPickerSchema = objOf(colorPickerFields);\n  var colorPickerDataProcessor = string;\n  var customEditorFields = formComponentFields.concat([defaultedString('tag', 'textarea'), strictString('scriptId'), strictString('scriptUrl'), defaultedPostMsg('settings', undefined)]);\n  var customEditorFieldsOld = formComponentFields.concat([defaultedString('tag', 'textarea'), strictFunction('init')]);\n  var customEditorSchema = valueOf(function (v) {\n    return asRaw('customeditor.old', objOfOnly(customEditorFieldsOld), v).orThunk(function () {\n      return asRaw('customeditor.new', objOfOnly(customEditorFields), v);\n    });\n  });\n  var customEditorDataProcessor = string;\n  var dropZoneFields = formComponentWithLabelFields;\n  var dropZoneSchema = objOf(dropZoneFields);\n  var dropZoneDataProcessor = arrOfVal();\n\n  var createGridFields = function (itemsField) {\n    return [strictString('type'), strictNumber('columns'), itemsField];\n  };\n\n  var htmlPanelFields = [strictString('type'), strictString('html'), defaultedStringEnum('presets', 'presentation', ['presentation', 'document'])];\n  var htmlPanelSchema = objOf(htmlPanelFields);\n  var iframeFields = formComponentWithLabelFields.concat([defaultedBoolean('sandboxed', true)]);\n  var iframeSchema = objOf(iframeFields);\n  var iframeDataProcessor = string;\n  var imageToolsFields = formComponentWithLabelFields.concat([strictOf('currentState', objOf([strict$1('blob'), strictString('url')]))]);\n  var imageToolsSchema = objOf(imageToolsFields);\n  var inputFields = formComponentWithLabelFields.concat([optionString('inputMode'), optionString('placeholder'), defaultedBoolean('maximized', false), defaultedBoolean('disabled', false)]);\n  var inputSchema = objOf(inputFields);\n  var inputDataProcessor = string;\n\n  var createLabelFields = function (itemsField) {\n    return [strictString('type'), strictString('label'), itemsField];\n  };\n\n  var listBoxSingleItemFields = [strictString('text'), strictString('value')];\n  var listBoxNestedItemFields = [strictString('text'), strictArrayOf('items', thunkOf('items', function () {\n    return listBoxItemSchema;\n  }))];\n  var listBoxItemSchema = oneOf([objOf(listBoxSingleItemFields), objOf(listBoxNestedItemFields)]);\n  var listBoxFields = formComponentWithLabelFields.concat([strictArrayOf('items', listBoxItemSchema), defaultedBoolean('disabled', false)]);\n  var listBoxSchema = objOf(listBoxFields);\n  var listBoxDataProcessor = string;\n  var selectBoxFields = formComponentWithLabelFields.concat([strictArrayOfObj('items', [strictString('text'), strictString('value')]), defaultedNumber('size', 1), defaultedBoolean('disabled', false)]);\n  var selectBoxSchema = objOf(selectBoxFields);\n  var selectBoxDataProcessor = string;\n  var sizeInputFields = formComponentWithLabelFields.concat([defaultedBoolean('constrain', true), defaultedBoolean('disabled', false)]);\n  var sizeInputSchema = objOf(sizeInputFields);\n  var sizeInputDataProcessor = objOf([strictString('width'), strictString('height')]);\n  var tableFields = [strictString('type'), strictArrayOf('header', string), strictArrayOf('cells', arrOf(string))];\n  var tableSchema = objOf(tableFields);\n  var textAreaFields = formComponentWithLabelFields.concat([optionString('placeholder'), defaultedBoolean('maximized', false), defaultedBoolean('disabled', false)]);\n  var textAreaSchema = objOf(textAreaFields);\n  var textAreaDataProcessor = string;\n  var urlInputFields = formComponentWithLabelFields.concat([defaultedStringEnum('filetype', 'file', ['image', 'media', 'file']), defaulted$1('disabled', false)]);\n  var urlInputSchema = objOf(urlInputFields);\n  var urlInputDataProcessor = objOf([strictString('value'), defaulted$1('meta', {})]);\n\n  var createItemsField = function (name) {\n    return field('items', 'items', strict(), arrOf(valueOf(function (v) {\n      return asRaw('Checking item of ' + name, itemSchema$3, v).fold(function (sErr) {\n        return Result.error(formatError(sErr));\n      }, function (passValue) {\n        return Result.value(passValue);\n      });\n    })));\n  };\n\n  var itemSchema$3 = valueThunkOf(function () {\n    return chooseProcessor('type', {\n      alertbanner: alertBannerSchema,\n      bar: objOf(createBarFields(createItemsField('bar'))),\n      button: buttonSchema,\n      checkbox: checkboxSchema,\n      colorinput: colorInputSchema,\n      colorpicker: colorPickerSchema,\n      dropzone: dropZoneSchema,\n      grid: objOf(createGridFields(createItemsField('grid'))),\n      iframe: iframeSchema,\n      input: inputSchema,\n      listbox: listBoxSchema,\n      selectbox: selectBoxSchema,\n      sizeinput: sizeInputSchema,\n      textarea: textAreaSchema,\n      urlinput: urlInputSchema,\n      customeditor: customEditorSchema,\n      htmlpanel: htmlPanelSchema,\n      imagetools: imageToolsSchema,\n      collection: collectionSchema,\n      label: objOf(createLabelFields(createItemsField('label'))),\n      table: tableSchema,\n      panel: panelSchema\n    });\n  });\n  var panelFields = [strictString('type'), defaulted$1('classes', []), strictArrayOf('items', itemSchema$3)];\n  var panelSchema = objOf(panelFields);\n  var tabFields = [field('name', 'name', defaultedThunk(function () {\n    return generate$1('tab-name');\n  }), string), strictString('title'), strictArrayOf('items', itemSchema$3)];\n  var tabPanelFields = [strictString('type'), strictArrayOfObj('tabs', tabFields)];\n  var tabPanelSchema = objOf(tabPanelFields);\n  var dialogButtonFields = dialogFooterButtonFields;\n  var dialogButtonSchema = dialogFooterButtonSchema;\n  var dialogSchema = objOf([strictString('title'), strictOf('body', chooseProcessor('type', {\n    panel: panelSchema,\n    tabpanel: tabPanelSchema\n  })), defaultedString('size', 'normal'), strictArrayOf('buttons', dialogButtonSchema), defaulted$1('initialData', {}), defaultedFunction('onAction', noop), defaultedFunction('onChange', noop), defaultedFunction('onSubmit', noop), defaultedFunction('onClose', noop), defaultedFunction('onCancel', noop), defaulted$1('onTabChange', noop)]);\n\n  var createDialog = function (spec) {\n    return asRaw('dialog', dialogSchema, spec);\n  };\n\n  var urlDialogButtonSchema = objOf(__spreadArrays([strictStringEnum('type', ['cancel', 'custom'])], dialogButtonFields));\n  var urlDialogSchema = objOf([strictString('title'), strictString('url'), optionNumber('height'), optionNumber('width'), optionArrayOf('buttons', urlDialogButtonSchema), defaultedFunction('onAction', noop), defaultedFunction('onCancel', noop), defaultedFunction('onClose', noop), defaultedFunction('onMessage', noop)]);\n\n  var createUrlDialog = function (spec) {\n    return asRaw('dialog', urlDialogSchema, spec);\n  };\n\n  var getAllObjects = function (obj) {\n    if (isObject(obj)) {\n      return [obj].concat(bind(values(obj), getAllObjects));\n    } else if (isArray(obj)) {\n      return bind(obj, getAllObjects);\n    } else {\n      return [];\n    }\n  };\n\n  var isNamedItem = function (obj) {\n    return isString(obj.type) && isString(obj.name);\n  };\n\n  var dataProcessors = {\n    checkbox: checkboxDataProcessor,\n    colorinput: colorInputDataProcessor,\n    colorpicker: colorPickerDataProcessor,\n    dropzone: dropZoneDataProcessor,\n    input: inputDataProcessor,\n    iframe: iframeDataProcessor,\n    sizeinput: sizeInputDataProcessor,\n    selectbox: selectBoxDataProcessor,\n    listbox: listBoxDataProcessor,\n    size: sizeInputDataProcessor,\n    textarea: textAreaDataProcessor,\n    urlinput: urlInputDataProcessor,\n    customeditor: customEditorDataProcessor,\n    collection: collectionDataProcessor,\n    togglemenuitem: dialogToggleMenuItemDataProcessor\n  };\n\n  var getDataProcessor = function (item) {\n    return Optional.from(dataProcessors[item.type]);\n  };\n\n  var getNamedItems = function (structure) {\n    return filter(getAllObjects(structure), isNamedItem);\n  };\n\n  var createDataValidator = function (structure) {\n    var namedItems = getNamedItems(structure);\n    var fields = bind(namedItems, function (item) {\n      return getDataProcessor(item).fold(function () {\n        return [];\n      }, function (schema) {\n        return [strictOf(item.name, schema)];\n      });\n    });\n    return objOf(fields);\n  };\n\n  var extract$1 = function (structure) {\n    var internalDialog = getOrDie(createDialog(structure));\n    var dataValidator = createDataValidator(structure);\n    var initialData = structure.initialData;\n    return {\n      internalDialog: internalDialog,\n      dataValidator: dataValidator,\n      initialData: initialData\n    };\n  };\n\n  var DialogManager = {\n    open: function (factory, structure) {\n      var extraction = extract$1(structure);\n      return factory(extraction.internalDialog, extraction.initialData, extraction.dataValidator);\n    },\n    openUrl: function (factory, structure) {\n      var internalDialog = getOrDie(createUrlDialog(structure));\n      return factory(internalDialog);\n    },\n    redial: function (structure) {\n      return extract$1(structure);\n    }\n  };\n\n  var toValidValues = function (values) {\n    var errors = [];\n    var result = {};\n    each$1(values, function (value, name) {\n      value.fold(function () {\n        errors.push(name);\n      }, function (v) {\n        result[name] = v;\n      });\n    });\n    return errors.length > 0 ? Result.error(errors) : Result.value(result);\n  };\n\n  var renderBodyPanel = function (spec, backstage) {\n    var memForm = record(Form.sketch(function (parts) {\n      return {\n        dom: {\n          tag: 'div',\n          classes: ['tox-form'].concat(spec.classes)\n        },\n        components: map(spec.items, function (item) {\n          return interpretInForm(parts, item, backstage);\n        })\n      };\n    }));\n    return {\n      dom: {\n        tag: 'div',\n        classes: ['tox-dialog__body']\n      },\n      components: [{\n        dom: {\n          tag: 'div',\n          classes: ['tox-dialog__body-content']\n        },\n        components: [memForm.asSpec()]\n      }],\n      behaviours: derive$1([Keying.config({\n        mode: 'acyclic',\n        useTabstopAt: not(isPseudoStop)\n      }), ComposingConfigs.memento(memForm), RepresentingConfigs.memento(memForm, {\n        postprocess: function (formValue) {\n          return toValidValues(formValue).fold(function (err) {\n            console.error(err);\n            return {};\n          }, function (vals) {\n            return vals;\n          });\n        }\n      })])\n    };\n  };\n\n  var factory$j = function (detail, _spec) {\n    return {\n      uid: detail.uid,\n      dom: detail.dom,\n      components: detail.components,\n      events: events$7(detail.action),\n      behaviours: augment(detail.tabButtonBehaviours, [Focusing.config({}), Keying.config({\n        mode: 'execution',\n        useSpace: true,\n        useEnter: true\n      }), Representing.config({\n        store: {\n          mode: 'memory',\n          initialValue: detail.value\n        }\n      })]),\n      domModification: detail.domModification\n    };\n  };\n\n  var TabButton = single$2({\n    name: 'TabButton',\n    configFields: [defaulted$1('uid', undefined), strict$1('value'), field('dom', 'dom', mergeWithThunk(function () {\n      return {\n        attributes: {\n          'role': 'tab',\n          'id': generate$1('aria'),\n          'aria-selected': 'false'\n        }\n      };\n    }), anyValue$1()), option('action'), defaulted$1('domModification', {}), field$1('tabButtonBehaviours', [Focusing, Keying, Representing]), strict$1('view')],\n    factory: factory$j\n  });\n  var schema$y = constant([strict$1('tabs'), strict$1('dom'), defaulted$1('clickToDismiss', false), field$1('tabbarBehaviours', [Highlighting, Keying]), markers(['tabClass', 'selectedClass'])]);\n  var tabsPart = group({\n    factory: TabButton,\n    name: 'tabs',\n    unit: 'tab',\n    overrides: function (barDetail) {\n      var dismissTab$1 = function (tabbar, button) {\n        Highlighting.dehighlight(tabbar, button);\n        emitWith(tabbar, dismissTab(), {\n          tabbar: tabbar,\n          button: button\n        });\n      };\n\n      var changeTab$1 = function (tabbar, button) {\n        Highlighting.highlight(tabbar, button);\n        emitWith(tabbar, changeTab(), {\n          tabbar: tabbar,\n          button: button\n        });\n      };\n\n      return {\n        action: function (button) {\n          var tabbar = button.getSystem().getByUid(barDetail.uid).getOrDie();\n          var activeButton = Highlighting.isHighlighted(tabbar, button);\n\n          var response = function () {\n            if (activeButton && barDetail.clickToDismiss) {\n              return dismissTab$1;\n            } else if (!activeButton) {\n              return changeTab$1;\n            } else {\n              return noop;\n            }\n          }();\n\n          response(tabbar, button);\n        },\n        domModification: {\n          classes: [barDetail.markers.tabClass]\n        }\n      };\n    }\n  });\n  var parts$g = constant([tabsPart]);\n\n  var factory$k = function (detail, components, _spec, _externals) {\n    return {\n      'uid': detail.uid,\n      'dom': detail.dom,\n      components: components,\n      'debug.sketcher': 'Tabbar',\n      'domModification': {\n        attributes: {\n          role: 'tablist'\n        }\n      },\n      'behaviours': augment(detail.tabbarBehaviours, [Highlighting.config({\n        highlightClass: detail.markers.selectedClass,\n        itemClass: detail.markers.tabClass,\n        onHighlight: function (tabbar, tab) {\n          set$1(tab.element, 'aria-selected', 'true');\n        },\n        onDehighlight: function (tabbar, tab) {\n          set$1(tab.element, 'aria-selected', 'false');\n        }\n      }), Keying.config({\n        mode: 'flow',\n        getInitial: function (tabbar) {\n          return Highlighting.getHighlighted(tabbar).map(function (tab) {\n            return tab.element;\n          });\n        },\n        selector: '.' + detail.markers.tabClass,\n        executeOnMove: true\n      })])\n    };\n  };\n\n  var Tabbar = composite$1({\n    name: 'Tabbar',\n    configFields: schema$y(),\n    partFields: parts$g(),\n    factory: factory$k\n  });\n\n  var factory$l = function (detail, _spec) {\n    return {\n      uid: detail.uid,\n      dom: detail.dom,\n      behaviours: augment(detail.tabviewBehaviours, [Replacing.config({})]),\n      domModification: {\n        attributes: {\n          role: 'tabpanel'\n        }\n      }\n    };\n  };\n\n  var Tabview = single$2({\n    name: 'Tabview',\n    configFields: [field$1('tabviewBehaviours', [Replacing])],\n    factory: factory$l\n  });\n  var schema$z = constant([defaulted$1('selectFirst', true), onHandler('onChangeTab'), onHandler('onDismissTab'), defaulted$1('tabs', []), field$1('tabSectionBehaviours', [])]);\n  var barPart = required({\n    factory: Tabbar,\n    schema: [strict$1('dom'), strictObjOf('markers', [strict$1('tabClass'), strict$1('selectedClass')])],\n    name: 'tabbar',\n    defaults: function (detail) {\n      return {\n        tabs: detail.tabs\n      };\n    }\n  });\n  var viewPart = required({\n    factory: Tabview,\n    name: 'tabview'\n  });\n  var parts$h = constant([barPart, viewPart]);\n\n  var factory$m = function (detail, components, _spec, _externals) {\n    var changeTab$1 = function (button) {\n      var tabValue = Representing.getValue(button);\n      getPart(button, detail, 'tabview').each(function (tabview) {\n        var tabWithValue = find(detail.tabs, function (t) {\n          return t.value === tabValue;\n        });\n        tabWithValue.each(function (tabData) {\n          var panel = tabData.view();\n          getOpt(button.element, 'id').each(function (id) {\n            set$1(tabview.element, 'aria-labelledby', id);\n          });\n          Replacing.set(tabview, panel);\n          detail.onChangeTab(tabview, button, panel);\n        });\n      });\n    };\n\n    var changeTabBy = function (section, byPred) {\n      getPart(section, detail, 'tabbar').each(function (tabbar) {\n        byPred(tabbar).each(emitExecute);\n      });\n    };\n\n    return {\n      uid: detail.uid,\n      dom: detail.dom,\n      components: components,\n      behaviours: get$d(detail.tabSectionBehaviours),\n      events: derive(flatten([detail.selectFirst ? [runOnAttached(function (section, _simulatedEvent) {\n        changeTabBy(section, Highlighting.getFirst);\n      })] : [], [run(changeTab(), function (section, simulatedEvent) {\n        var button = simulatedEvent.event.button;\n        changeTab$1(button);\n      }), run(dismissTab(), function (section, simulatedEvent) {\n        var button = simulatedEvent.event.button;\n        detail.onDismissTab(section, button);\n      })]])),\n      apis: {\n        getViewItems: function (section) {\n          return getPart(section, detail, 'tabview').map(function (tabview) {\n            return Replacing.contents(tabview);\n          }).getOr([]);\n        },\n        showTab: function (section, tabKey) {\n          var getTabIfNotActive = function (tabbar) {\n            var candidates = Highlighting.getCandidates(tabbar);\n            var optTab = find(candidates, function (c) {\n              return Representing.getValue(c) === tabKey;\n            });\n            return optTab.filter(function (tab) {\n              return !Highlighting.isHighlighted(tabbar, tab);\n            });\n          };\n\n          changeTabBy(section, getTabIfNotActive);\n        }\n      }\n    };\n  };\n\n  var TabSection = composite$1({\n    name: 'TabSection',\n    configFields: schema$z(),\n    partFields: parts$h(),\n    factory: factory$m,\n    apis: {\n      getViewItems: function (apis, component) {\n        return apis.getViewItems(component);\n      },\n      showTab: function (apis, component, tabKey) {\n        apis.showTab(component, tabKey);\n      }\n    }\n  });\n\n  var measureHeights = function (allTabs, tabview, tabviewComp) {\n    return map(allTabs, function (_tab, i) {\n      Replacing.set(tabviewComp, allTabs[i].view());\n      var rect = tabview.dom.getBoundingClientRect();\n      Replacing.set(tabviewComp, []);\n      return rect.height;\n    });\n  };\n\n  var getMaxHeight = function (heights) {\n    return head(sort(heights, function (a, b) {\n      if (a > b) {\n        return -1;\n      } else if (a < b) {\n        return +1;\n      } else {\n        return 0;\n      }\n    }));\n  };\n\n  var getMaxTabviewHeight = function (dialog, tabview, tablist) {\n    var documentElement$1 = documentElement(dialog).dom;\n    var rootElm = ancestor$2(dialog, '.tox-dialog-wrap').getOr(dialog);\n    var isFixed = get$5(rootElm, 'position') === 'fixed';\n    var maxHeight;\n\n    if (isFixed) {\n      maxHeight = Math.max(documentElement$1.clientHeight, window.innerHeight);\n    } else {\n      maxHeight = Math.max(documentElement$1.offsetHeight, documentElement$1.scrollHeight);\n    }\n\n    var tabviewHeight = get$7(tabview);\n    var isTabListBeside = tabview.dom.offsetLeft >= tablist.dom.offsetLeft + get$8(tablist);\n    var currentTabHeight = isTabListBeside ? Math.max(get$7(tablist), tabviewHeight) : tabviewHeight;\n    var dialogTopMargin = parseInt(get$5(dialog, 'margin-top'), 10) || 0;\n    var dialogBottomMargin = parseInt(get$5(dialog, 'margin-bottom'), 10) || 0;\n    var dialogHeight = get$7(dialog) + dialogTopMargin + dialogBottomMargin;\n    var chromeHeight = dialogHeight - currentTabHeight;\n    return maxHeight - chromeHeight;\n  };\n\n  var showTab = function (allTabs, comp) {\n    head(allTabs).each(function (tab) {\n      return TabSection.showTab(comp, tab.value);\n    });\n  };\n\n  var setTabviewHeight = function (tabview, height) {\n    set$2(tabview, 'height', height + 'px');\n\n    if (!detect$3().browser.isIE()) {\n      set$2(tabview, 'flex-basis', height + 'px');\n    } else {\n      remove$6(tabview, 'flex-basis');\n    }\n  };\n\n  var updateTabviewHeight = function (dialogBody, tabview, maxTabHeight) {\n    ancestor$2(dialogBody, '[role=\"dialog\"]').each(function (dialog) {\n      descendant$1(dialog, '[role=\"tablist\"]').each(function (tablist) {\n        maxTabHeight.get().map(function (height) {\n          set$2(tabview, 'height', '0');\n          set$2(tabview, 'flex-basis', '0');\n          return Math.min(height, getMaxTabviewHeight(dialog, tabview, tablist));\n        }).each(function (height) {\n          setTabviewHeight(tabview, height);\n        });\n      });\n    });\n  };\n\n  var getTabview = function (dialog) {\n    return descendant$1(dialog, '[role=\"tabpanel\"]');\n  };\n\n  var setMode = function (allTabs) {\n    var smartTabHeight = function () {\n      var maxTabHeight = Cell(Optional.none());\n      var extraEvents = [runOnAttached(function (comp) {\n        var dialog = comp.element;\n        getTabview(dialog).each(function (tabview) {\n          set$2(tabview, 'visibility', 'hidden');\n          comp.getSystem().getByDom(tabview).toOptional().each(function (tabviewComp) {\n            var heights = measureHeights(allTabs, tabview, tabviewComp);\n            var maxTabHeightOpt = getMaxHeight(heights);\n            maxTabHeight.set(maxTabHeightOpt);\n          });\n          updateTabviewHeight(dialog, tabview, maxTabHeight);\n          remove$6(tabview, 'visibility');\n          showTab(allTabs, comp);\n          global$2.requestAnimationFrame(function () {\n            updateTabviewHeight(dialog, tabview, maxTabHeight);\n          });\n        });\n      }), run(windowResize(), function (comp) {\n        var dialog = comp.element;\n        getTabview(dialog).each(function (tabview) {\n          updateTabviewHeight(dialog, tabview, maxTabHeight);\n        });\n      }), run(formResizeEvent, function (comp, _se) {\n        var dialog = comp.element;\n        getTabview(dialog).each(function (tabview) {\n          var oldFocus = active(getRootNode(tabview));\n          set$2(tabview, 'visibility', 'hidden');\n          var oldHeight = getRaw(tabview, 'height').map(function (h) {\n            return parseInt(h, 10);\n          });\n          remove$6(tabview, 'height');\n          remove$6(tabview, 'flex-basis');\n          var newHeight = tabview.dom.getBoundingClientRect().height;\n          var hasGrown = oldHeight.forall(function (h) {\n            return newHeight > h;\n          });\n\n          if (hasGrown) {\n            maxTabHeight.set(Optional.from(newHeight));\n            updateTabviewHeight(dialog, tabview, maxTabHeight);\n          } else {\n            oldHeight.each(function (h) {\n              setTabviewHeight(tabview, h);\n            });\n          }\n\n          remove$6(tabview, 'visibility');\n          oldFocus.each(focus$1);\n        });\n      })];\n      var selectFirst = false;\n      return {\n        extraEvents: extraEvents,\n        selectFirst: selectFirst\n      };\n    }();\n\n    var naiveTabHeight = function () {\n      var extraEvents = [];\n      var selectFirst = true;\n      return {\n        extraEvents: extraEvents,\n        selectFirst: selectFirst\n      };\n    }();\n\n    return {\n      smartTabHeight: smartTabHeight,\n      naiveTabHeight: naiveTabHeight\n    };\n  };\n\n  var SendDataToSectionChannel = 'send-data-to-section';\n  var SendDataToViewChannel = 'send-data-to-view';\n\n  var renderTabPanel = function (spec, backstage) {\n    var storedValue = Cell({});\n\n    var updateDataWithForm = function (form) {\n      var formData = Representing.getValue(form);\n      var validData = toValidValues(formData).getOr({});\n      var currentData = storedValue.get();\n      var newData = deepMerge(currentData, validData);\n      storedValue.set(newData);\n    };\n\n    var setDataOnForm = function (form) {\n      var tabData = storedValue.get();\n      Representing.setValue(form, tabData);\n    };\n\n    var oldTab = Cell(null);\n    var allTabs = map(spec.tabs, function (tab) {\n      return {\n        value: tab.name,\n        dom: {\n          tag: 'div',\n          classes: ['tox-dialog__body-nav-item'],\n          innerHtml: backstage.shared.providers.translate(tab.title)\n        },\n        view: function () {\n          return [Form.sketch(function (parts) {\n            return {\n              dom: {\n                tag: 'div',\n                classes: ['tox-form']\n              },\n              components: map(tab.items, function (item) {\n                return interpretInForm(parts, item, backstage);\n              }),\n              formBehaviours: derive$1([Keying.config({\n                mode: 'acyclic',\n                useTabstopAt: not(isPseudoStop)\n              }), config('TabView.form.events', [runOnAttached(setDataOnForm), runOnDetached(updateDataWithForm)]), Receiving.config({\n                channels: wrapAll$1([{\n                  key: SendDataToSectionChannel,\n                  value: {\n                    onReceive: updateDataWithForm\n                  }\n                }, {\n                  key: SendDataToViewChannel,\n                  value: {\n                    onReceive: setDataOnForm\n                  }\n                }])\n              })])\n            };\n          })];\n        }\n      };\n    });\n    var tabMode = setMode(allTabs).smartTabHeight;\n    return TabSection.sketch({\n      dom: {\n        tag: 'div',\n        classes: ['tox-dialog__body']\n      },\n      onChangeTab: function (section, button, _viewItems) {\n        var name = Representing.getValue(button);\n        emitWith(section, formTabChangeEvent, {\n          name: name,\n          oldName: oldTab.get()\n        });\n        oldTab.set(name);\n      },\n      tabs: allTabs,\n      components: [TabSection.parts.tabbar({\n        dom: {\n          tag: 'div',\n          classes: ['tox-dialog__body-nav']\n        },\n        components: [Tabbar.parts.tabs({})],\n        markers: {\n          tabClass: 'tox-tab',\n          selectedClass: 'tox-dialog__body-nav-item--active'\n        },\n        tabbarBehaviours: derive$1([Tabstopping.config({})])\n      }), TabSection.parts.tabview({\n        dom: {\n          tag: 'div',\n          classes: ['tox-dialog__body-content']\n        }\n      })],\n      selectFirst: tabMode.selectFirst,\n      tabSectionBehaviours: derive$1([config('tabpanel', tabMode.extraEvents), Keying.config({\n        mode: 'acyclic'\n      }), Composing.config({\n        find: function (comp) {\n          return head(TabSection.getViewItems(comp));\n        }\n      }), Representing.config({\n        store: {\n          mode: 'manual',\n          getValue: function (tsection) {\n            tsection.getSystem().broadcastOn([SendDataToSectionChannel], {});\n            return storedValue.get();\n          },\n          setValue: function (tsection, value) {\n            storedValue.set(value);\n            tsection.getSystem().broadcastOn([SendDataToViewChannel], {});\n          }\n        }\n      })])\n    });\n  };\n\n  var dialogChannel = generate$1('update-dialog');\n  var titleChannel = generate$1('update-title');\n  var bodyChannel = generate$1('update-body');\n  var footerChannel = generate$1('update-footer');\n  var bodySendMessageChannel = generate$1('body-send-message');\n\n  var renderBody = function (spec, id, backstage, ariaAttrs) {\n    var renderComponents = function (incoming) {\n      switch (incoming.body.type) {\n        case 'tabpanel':\n          {\n            return [renderTabPanel(incoming.body, backstage)];\n          }\n\n        default:\n          {\n            return [renderBodyPanel(incoming.body, backstage)];\n          }\n      }\n    };\n\n    var updateState = function (_comp, incoming) {\n      return Optional.some({\n        isTabPanel: function () {\n          return incoming.body.type === 'tabpanel';\n        }\n      });\n    };\n\n    var ariaAttributes = {\n      'aria-live': 'polite'\n    };\n    return {\n      dom: {\n        tag: 'div',\n        classes: ['tox-dialog__content-js'],\n        attributes: __assign(__assign({}, id.map(function (x) {\n          return {\n            id: x\n          };\n        }).getOr({})), ariaAttrs ? ariaAttributes : {})\n      },\n      components: [],\n      behaviours: derive$1([ComposingConfigs.childAt(0), Reflecting.config({\n        channel: bodyChannel,\n        updateState: updateState,\n        renderComponents: renderComponents,\n        initialData: spec\n      })])\n    };\n  };\n\n  var renderInlineBody = function (spec, contentId, backstage, ariaAttrs) {\n    return renderBody(spec, Optional.some(contentId), backstage, ariaAttrs);\n  };\n\n  var renderModalBody = function (spec, backstage) {\n    var bodySpec = renderBody(spec, Optional.none(), backstage, false);\n    return ModalDialog.parts.body(bodySpec);\n  };\n\n  var renderIframeBody = function (spec) {\n    var bodySpec = {\n      dom: {\n        tag: 'div',\n        classes: ['tox-dialog__content-js']\n      },\n      components: [{\n        dom: {\n          tag: 'div',\n          classes: ['tox-dialog__body-iframe']\n        },\n        components: [craft({\n          dom: {\n            tag: 'iframe',\n            attributes: {\n              src: spec.url\n            }\n          },\n          behaviours: derive$1([Tabstopping.config({}), Focusing.config({})])\n        })]\n      }],\n      behaviours: derive$1([Keying.config({\n        mode: 'acyclic',\n        useTabstopAt: not(isPseudoStop)\n      })])\n    };\n    return ModalDialog.parts.body(bodySpec);\n  };\n\n  var isTouch = global$8.deviceType.isTouch();\n\n  var hiddenHeader = function (title, close) {\n    return {\n      dom: {\n        tag: 'div',\n        styles: {\n          display: 'none'\n        },\n        classes: ['tox-dialog__header']\n      },\n      components: [title, close]\n    };\n  };\n\n  var pClose = function (onClose, providersBackstage) {\n    return ModalDialog.parts.close(Button.sketch({\n      dom: {\n        tag: 'button',\n        classes: ['tox-button', 'tox-button--icon', 'tox-button--naked'],\n        attributes: {\n          'type': 'button',\n          'aria-label': providersBackstage.translate('Close')\n        }\n      },\n      action: onClose,\n      buttonBehaviours: derive$1([Tabstopping.config({})])\n    }));\n  };\n\n  var pUntitled = function () {\n    return ModalDialog.parts.title({\n      dom: {\n        tag: 'div',\n        classes: ['tox-dialog__title'],\n        innerHtml: '',\n        styles: {\n          display: 'none'\n        }\n      }\n    });\n  };\n\n  var pBodyMessage = function (message, providersBackstage) {\n    return ModalDialog.parts.body({\n      dom: {\n        tag: 'div',\n        classes: ['tox-dialog__body']\n      },\n      components: [{\n        dom: {\n          tag: 'div',\n          classes: ['tox-dialog__body-content']\n        },\n        components: [{\n          dom: fromHtml$2('<p>' + providersBackstage.translate(message) + '</p>')\n        }]\n      }]\n    });\n  };\n\n  var pFooter = function (buttons) {\n    return ModalDialog.parts.footer({\n      dom: {\n        tag: 'div',\n        classes: ['tox-dialog__footer']\n      },\n      components: buttons\n    });\n  };\n\n  var pFooterGroup = function (startButtons, endButtons) {\n    return [Container.sketch({\n      dom: {\n        tag: 'div',\n        classes: ['tox-dialog__footer-start']\n      },\n      components: startButtons\n    }), Container.sketch({\n      dom: {\n        tag: 'div',\n        classes: ['tox-dialog__footer-end']\n      },\n      components: endButtons\n    })];\n  };\n\n  var renderDialog = function (spec) {\n    var _a;\n\n    var dialogClass = 'tox-dialog';\n    var blockerClass = dialogClass + '-wrap';\n    var blockerBackdropClass = blockerClass + '__backdrop';\n    var scrollLockClass = dialogClass + '__disable-scroll';\n    return ModalDialog.sketch({\n      lazySink: spec.lazySink,\n      onEscape: function (comp) {\n        spec.onEscape(comp);\n        return Optional.some(true);\n      },\n      useTabstopAt: function (elem) {\n        return !isPseudoStop(elem);\n      },\n      dom: {\n        tag: 'div',\n        classes: [dialogClass].concat(spec.extraClasses),\n        styles: __assign({\n          position: 'relative'\n        }, spec.extraStyles)\n      },\n      components: __spreadArrays([spec.header, spec.body], spec.footer.toArray()),\n      parts: {\n        blocker: {\n          dom: fromHtml$2('<div class=\"' + blockerClass + '\"></div>'),\n          components: [{\n            dom: {\n              tag: 'div',\n              classes: isTouch ? [blockerBackdropClass, blockerBackdropClass + '--opaque'] : [blockerBackdropClass]\n            }\n          }]\n        }\n      },\n      dragBlockClass: blockerClass,\n      modalBehaviours: derive$1(__spreadArrays([Focusing.config({}), config('dialog-events', spec.dialogEvents.concat([runOnSource(focusin(), function (comp, _se) {\n        Keying.focusIn(comp);\n      })])), config('scroll-lock', [runOnAttached(function () {\n        add$2(body(), scrollLockClass);\n      }), runOnDetached(function () {\n        remove$4(body(), scrollLockClass);\n      })])], spec.extraBehaviours)),\n      eventOrder: __assign((_a = {}, _a[execute()] = ['dialog-events'], _a[attachedToDom()] = ['scroll-lock', 'dialog-events', 'alloy.base.behaviour'], _a[detachedFromDom()] = ['alloy.base.behaviour', 'dialog-events', 'scroll-lock'], _a), spec.eventOrder)\n    });\n  };\n\n  var renderClose = function (providersBackstage) {\n    return Button.sketch({\n      dom: {\n        tag: 'button',\n        classes: ['tox-button', 'tox-button--icon', 'tox-button--naked'],\n        attributes: {\n          'type': 'button',\n          'aria-label': providersBackstage.translate('Close'),\n          'title': providersBackstage.translate('Close')\n        }\n      },\n      components: [{\n        dom: {\n          tag: 'div',\n          classes: ['tox-icon'],\n          innerHtml: get$e('close', providersBackstage.icons)\n        }\n      }],\n      action: function (comp) {\n        emit(comp, formCancelEvent);\n      }\n    });\n  };\n\n  var renderTitle = function (spec, id, providersBackstage) {\n    var renderComponents = function (data) {\n      return [text(providersBackstage.translate(data.title))];\n    };\n\n    return {\n      dom: {\n        tag: 'div',\n        classes: ['tox-dialog__title'],\n        attributes: __assign({}, id.map(function (x) {\n          return {\n            id: x\n          };\n        }).getOr({}))\n      },\n      components: renderComponents(spec),\n      behaviours: derive$1([Reflecting.config({\n        channel: titleChannel,\n        renderComponents: renderComponents\n      })])\n    };\n  };\n\n  var renderDragHandle = function () {\n    return {\n      dom: fromHtml$2('<div class=\"tox-dialog__draghandle\"></div>')\n    };\n  };\n\n  var renderInlineHeader = function (spec, titleId, providersBackstage) {\n    return Container.sketch({\n      dom: fromHtml$2('<div class=\"tox-dialog__header\"></div>'),\n      components: [renderTitle(spec, Optional.some(titleId), providersBackstage), renderDragHandle(), renderClose(providersBackstage)],\n      containerBehaviours: derive$1([Dragging.config({\n        mode: 'mouse',\n        blockerClass: 'blocker',\n        getTarget: function (handle) {\n          return closest$3(handle, '[role=\"dialog\"]').getOrDie();\n        },\n        snaps: {\n          getSnapPoints: function () {\n            return [];\n          },\n          leftAttr: 'data-drag-left',\n          topAttr: 'data-drag-top'\n        }\n      })])\n    });\n  };\n\n  var renderModalHeader = function (spec, providersBackstage) {\n    var pTitle = ModalDialog.parts.title(renderTitle(spec, Optional.none(), providersBackstage));\n    var pHandle = ModalDialog.parts.draghandle(renderDragHandle());\n    var pClose = ModalDialog.parts.close(renderClose(providersBackstage));\n    var components = [pTitle].concat(spec.draggable ? [pHandle] : []).concat([pClose]);\n    return Container.sketch({\n      dom: fromHtml$2('<div class=\"tox-dialog__header\"></div>'),\n      components: components\n    });\n  };\n\n  var getHeader = function (title, backstage) {\n    return renderModalHeader({\n      title: backstage.shared.providers.translate(title),\n      draggable: backstage.dialog.isDraggableModal()\n    }, backstage.shared.providers);\n  };\n\n  var getBusySpec = function (message, bs, providers) {\n    return {\n      dom: {\n        tag: 'div',\n        classes: ['tox-dialog__busy-spinner'],\n        attributes: {\n          'aria-label': providers.translate(message)\n        },\n        styles: {\n          left: '0px',\n          right: '0px',\n          bottom: '0px',\n          top: '0px',\n          position: 'absolute'\n        }\n      },\n      behaviours: bs,\n      components: [{\n        dom: fromHtml$2('<div class=\"tox-spinner\"><div></div><div></div><div></div></div>')\n      }]\n    };\n  };\n\n  var getEventExtras = function (lazyDialog, providers, extra) {\n    return {\n      onClose: function () {\n        return extra.closeWindow();\n      },\n      onBlock: function (blockEvent) {\n        ModalDialog.setBusy(lazyDialog(), function (_comp, bs) {\n          return getBusySpec(blockEvent.message, bs, providers);\n        });\n      },\n      onUnblock: function () {\n        ModalDialog.setIdle(lazyDialog());\n      }\n    };\n  };\n\n  var renderModalDialog = function (spec, initialData, dialogEvents, backstage) {\n    var _a;\n\n    var updateState = function (_comp, incoming) {\n      return Optional.some(incoming);\n    };\n\n    return build$1(renderDialog(__assign(__assign({}, spec), {\n      lazySink: backstage.shared.getSink,\n      extraBehaviours: __spreadArrays([Reflecting.config({\n        channel: dialogChannel,\n        updateState: updateState,\n        initialData: initialData\n      }), RepresentingConfigs.memory({})], spec.extraBehaviours),\n      onEscape: function (comp) {\n        emit(comp, formCancelEvent);\n      },\n      dialogEvents: dialogEvents,\n      eventOrder: (_a = {}, _a[receive()] = [Reflecting.name(), Receiving.name()], _a[attachedToDom()] = ['scroll-lock', Reflecting.name(), 'messages', 'dialog-events', 'alloy.base.behaviour'], _a[detachedFromDom()] = ['alloy.base.behaviour', 'dialog-events', 'messages', Reflecting.name(), 'scroll-lock'], _a)\n    })));\n  };\n\n  var mapMenuButtons = function (buttons) {\n    var mapItems = function (button) {\n      var items = map(button.items, function (item) {\n        var cell = Cell(false);\n        return __assign(__assign({}, item), {\n          storage: cell\n        });\n      });\n      return __assign(__assign({}, button), {\n        items: items\n      });\n    };\n\n    return map(buttons, function (button) {\n      if (button.type === 'menu') {\n        return mapItems(button);\n      }\n\n      return button;\n    });\n  };\n\n  var extractCellsToObject = function (buttons) {\n    return foldl(buttons, function (acc, button) {\n      if (button.type === 'menu') {\n        var menuButton = button;\n        return foldl(menuButton.items, function (innerAcc, item) {\n          innerAcc[item.name] = item.storage;\n          return innerAcc;\n        }, acc);\n      }\n\n      return acc;\n    }, {});\n  };\n\n  var initCommonEvents = function (fireApiEvent, extras) {\n    return [runWithTarget(focusin(), onFocus$1), fireApiEvent(formCloseEvent, function (_api, spec) {\n      extras.onClose();\n      spec.onClose();\n    }), fireApiEvent(formCancelEvent, function (api, spec, _event, self) {\n      spec.onCancel(api);\n      emit(self, formCloseEvent);\n    }), run(formUnblockEvent, function (_c, _se) {\n      return extras.onUnblock();\n    }), run(formBlockEvent, function (_c, se) {\n      return extras.onBlock(se.event);\n    })];\n  };\n\n  var initUrlDialog = function (getInstanceApi, extras) {\n    var fireApiEvent = function (eventName, f) {\n      return run(eventName, function (c, se) {\n        withSpec(c, function (spec, _c) {\n          f(getInstanceApi(), spec, se.event, c);\n        });\n      });\n    };\n\n    var withSpec = function (c, f) {\n      Reflecting.getState(c).get().each(function (currentDialog) {\n        f(currentDialog, c);\n      });\n    };\n\n    return __spreadArrays(initCommonEvents(fireApiEvent, extras), [fireApiEvent(formActionEvent, function (api, spec, event) {\n      spec.onAction(api, {\n        name: event.name\n      });\n    })]);\n  };\n\n  var initDialog = function (getInstanceApi, extras, getSink) {\n    var fireApiEvent = function (eventName, f) {\n      return run(eventName, function (c, se) {\n        withSpec(c, function (spec, _c) {\n          f(getInstanceApi(), spec, se.event, c);\n        });\n      });\n    };\n\n    var withSpec = function (c, f) {\n      Reflecting.getState(c).get().each(function (currentDialogInit) {\n        f(currentDialogInit.internalDialog, c);\n      });\n    };\n\n    return __spreadArrays(initCommonEvents(fireApiEvent, extras), [fireApiEvent(formSubmitEvent, function (api, spec) {\n      return spec.onSubmit(api);\n    }), fireApiEvent(formChangeEvent, function (api, spec, event) {\n      spec.onChange(api, {\n        name: event.name\n      });\n    }), fireApiEvent(formActionEvent, function (api, spec, event, component) {\n      var focusIn = function () {\n        return Keying.focusIn(component);\n      };\n\n      var isDisabled = function (focused) {\n        return has$1(focused, 'disabled') || getOpt(focused, 'aria-disabled').exists(function (val) {\n          return val === 'true';\n        });\n      };\n\n      var rootNode = getRootNode(component.element);\n      var current = active(rootNode);\n      spec.onAction(api, {\n        name: event.name,\n        value: event.value\n      });\n      active(rootNode).fold(focusIn, function (focused) {\n        if (isDisabled(focused)) {\n          focusIn();\n        } else if (current.exists(function (cur) {\n          return contains$2(focused, cur) && isDisabled(cur);\n        })) {\n          focusIn();\n        } else {\n          getSink().toOptional().filter(function (sink) {\n            return !contains$2(sink.element, focused);\n          }).each(focusIn);\n        }\n      });\n    }), fireApiEvent(formTabChangeEvent, function (api, spec, event) {\n      spec.onTabChange(api, {\n        newTabName: event.name,\n        oldTabName: event.oldName\n      });\n    }), runOnDetached(function (component) {\n      var api = getInstanceApi();\n      Representing.setValue(component, api.getData());\n    })]);\n  };\n\n  var SilverDialogEvents = {\n    initUrlDialog: initUrlDialog,\n    initDialog: initDialog\n  };\n\n  var makeButton = function (button, backstage) {\n    return renderFooterButton(button, button.type, backstage);\n  };\n\n  var lookup$2 = function (compInSystem, footerButtons, buttonName) {\n    return find(footerButtons, function (button) {\n      return button.name === buttonName;\n    }).bind(function (memButton) {\n      return memButton.memento.getOpt(compInSystem);\n    });\n  };\n\n  var renderComponents = function (_data, state) {\n    var footerButtons = state.map(function (s) {\n      return s.footerButtons;\n    }).getOr([]);\n    var buttonGroups = partition(footerButtons, function (button) {\n      return button.align === 'start';\n    });\n\n    var makeGroup = function (edge, buttons) {\n      return Container.sketch({\n        dom: {\n          tag: 'div',\n          classes: ['tox-dialog__footer-' + edge]\n        },\n        components: map(buttons, function (button) {\n          return button.memento.asSpec();\n        })\n      });\n    };\n\n    var startButtons = makeGroup('start', buttonGroups.pass);\n    var endButtons = makeGroup('end', buttonGroups.fail);\n    return [startButtons, endButtons];\n  };\n\n  var renderFooter = function (initSpec, backstage) {\n    var updateState = function (_comp, data) {\n      var footerButtons = map(data.buttons, function (button) {\n        var memButton = record(makeButton(button, backstage));\n        return {\n          name: button.name,\n          align: button.align,\n          memento: memButton\n        };\n      });\n\n      var lookupByName = function (compInSystem, buttonName) {\n        return lookup$2(compInSystem, footerButtons, buttonName);\n      };\n\n      return Optional.some({\n        lookupByName: lookupByName,\n        footerButtons: footerButtons\n      });\n    };\n\n    return {\n      dom: fromHtml$2('<div class=\"tox-dialog__footer\"></div>'),\n      components: [],\n      behaviours: derive$1([Reflecting.config({\n        channel: footerChannel,\n        initialData: initSpec,\n        updateState: updateState,\n        renderComponents: renderComponents\n      })])\n    };\n  };\n\n  var renderInlineFooter = function (initSpec, backstage) {\n    return renderFooter(initSpec, backstage);\n  };\n\n  var renderModalFooter = function (initSpec, backstage) {\n    return ModalDialog.parts.footer(renderFooter(initSpec, backstage));\n  };\n\n  var getCompByName = function (access, name) {\n    var root = access.getRoot();\n\n    if (root.getSystem().isConnected()) {\n      var form_1 = Composing.getCurrent(access.getFormWrapper()).getOr(access.getFormWrapper());\n      return Form.getField(form_1, name).fold(function () {\n        var footer = access.getFooter();\n        var footerState = Reflecting.getState(footer);\n        return footerState.get().bind(function (f) {\n          return f.lookupByName(form_1, name);\n        });\n      }, function (comp) {\n        return Optional.some(comp);\n      });\n    } else {\n      return Optional.none();\n    }\n  };\n\n  var validateData = function (access, data) {\n    var root = access.getRoot();\n    return Reflecting.getState(root).get().map(function (dialogState) {\n      return getOrDie(asRaw('data', dialogState.dataValidator, data));\n    }).getOr(data);\n  };\n\n  var getDialogApi = function (access, doRedial, menuItemStates) {\n    var withRoot = function (f) {\n      var root = access.getRoot();\n\n      if (root.getSystem().isConnected()) {\n        f(root);\n      }\n    };\n\n    var getData = function () {\n      var root = access.getRoot();\n      var valueComp = root.getSystem().isConnected() ? access.getFormWrapper() : root;\n      var representedValues = Representing.getValue(valueComp);\n      var menuItemCurrentState = map$2(menuItemStates, function (cell) {\n        return cell.get();\n      });\n      return __assign(__assign({}, representedValues), menuItemCurrentState);\n    };\n\n    var setData = function (newData) {\n      withRoot(function (_) {\n        var prevData = instanceApi.getData();\n\n        var mergedData = __assign(__assign({}, prevData), newData);\n\n        var newInternalData = validateData(access, mergedData);\n        var form = access.getFormWrapper();\n        Representing.setValue(form, newInternalData);\n        each$1(menuItemStates, function (v, k) {\n          if (has(mergedData, k)) {\n            v.set(mergedData[k]);\n          }\n        });\n      });\n    };\n\n    var disable = function (name) {\n      getCompByName(access, name).each(Disabling.disable);\n    };\n\n    var enable = function (name) {\n      getCompByName(access, name).each(Disabling.enable);\n    };\n\n    var focus = function (name) {\n      getCompByName(access, name).each(Focusing.focus);\n    };\n\n    var block = function (message) {\n      if (!isString(message)) {\n        throw new Error('The dialogInstanceAPI.block function should be passed a blocking message of type string as an argument');\n      }\n\n      withRoot(function (root) {\n        emitWith(root, formBlockEvent, {\n          message: message\n        });\n      });\n    };\n\n    var unblock = function () {\n      withRoot(function (root) {\n        emit(root, formUnblockEvent);\n      });\n    };\n\n    var showTab = function (name) {\n      withRoot(function (_) {\n        var body = access.getBody();\n        var bodyState = Reflecting.getState(body);\n\n        if (bodyState.get().exists(function (b) {\n          return b.isTabPanel();\n        })) {\n          Composing.getCurrent(body).each(function (tabSection) {\n            TabSection.showTab(tabSection, name);\n          });\n        }\n      });\n    };\n\n    var redial = function (d) {\n      withRoot(function (root) {\n        var dialogInit = doRedial(d);\n        root.getSystem().broadcastOn([dialogChannel], dialogInit);\n        root.getSystem().broadcastOn([titleChannel], dialogInit.internalDialog);\n        root.getSystem().broadcastOn([bodyChannel], dialogInit.internalDialog);\n        root.getSystem().broadcastOn([footerChannel], dialogInit.internalDialog);\n        instanceApi.setData(dialogInit.initialData);\n      });\n    };\n\n    var close = function () {\n      withRoot(function (root) {\n        emit(root, formCloseEvent);\n      });\n    };\n\n    var instanceApi = {\n      getData: getData,\n      setData: setData,\n      disable: disable,\n      enable: enable,\n      focus: focus,\n      block: block,\n      unblock: unblock,\n      showTab: showTab,\n      redial: redial,\n      close: close\n    };\n    return instanceApi;\n  };\n\n  var getDialogSizeClasses = function (size) {\n    switch (size) {\n      case 'large':\n        return ['tox-dialog--width-lg'];\n\n      case 'medium':\n        return ['tox-dialog--width-md'];\n\n      default:\n        return [];\n    }\n  };\n\n  var renderDialog$1 = function (dialogInit, extra, backstage) {\n    var header = getHeader(dialogInit.internalDialog.title, backstage);\n    var body = renderModalBody({\n      body: dialogInit.internalDialog.body\n    }, backstage);\n    var storagedMenuButtons = mapMenuButtons(dialogInit.internalDialog.buttons);\n    var objOfCells = extractCellsToObject(storagedMenuButtons);\n    var footer = renderModalFooter({\n      buttons: storagedMenuButtons\n    }, backstage);\n    var dialogEvents = SilverDialogEvents.initDialog(function () {\n      return instanceApi;\n    }, getEventExtras(function () {\n      return dialog;\n    }, backstage.shared.providers, extra), backstage.shared.getSink);\n    var dialogSize = getDialogSizeClasses(dialogInit.internalDialog.size);\n    var spec = {\n      header: header,\n      body: body,\n      footer: Optional.some(footer),\n      extraClasses: dialogSize,\n      extraBehaviours: [],\n      extraStyles: {}\n    };\n    var dialog = renderModalDialog(spec, dialogInit, dialogEvents, backstage);\n\n    var modalAccess = function () {\n      var getForm = function () {\n        var outerForm = ModalDialog.getBody(dialog);\n        return Composing.getCurrent(outerForm).getOr(outerForm);\n      };\n\n      return {\n        getRoot: function () {\n          return dialog;\n        },\n        getBody: function () {\n          return ModalDialog.getBody(dialog);\n        },\n        getFooter: function () {\n          return ModalDialog.getFooter(dialog);\n        },\n        getFormWrapper: getForm\n      };\n    }();\n\n    var instanceApi = getDialogApi(modalAccess, extra.redial, objOfCells);\n    return {\n      dialog: dialog,\n      instanceApi: instanceApi\n    };\n  };\n\n  var renderInlineDialog = function (dialogInit, extra, backstage, ariaAttrs) {\n    var _a, _b;\n\n    var dialogLabelId = generate$1('dialog-label');\n    var dialogContentId = generate$1('dialog-content');\n\n    var updateState = function (_comp, incoming) {\n      return Optional.some(incoming);\n    };\n\n    var memHeader = record(renderInlineHeader({\n      title: dialogInit.internalDialog.title,\n      draggable: true\n    }, dialogLabelId, backstage.shared.providers));\n    var memBody = record(renderInlineBody({\n      body: dialogInit.internalDialog.body\n    }, dialogContentId, backstage, ariaAttrs));\n    var storagedMenuButtons = mapMenuButtons(dialogInit.internalDialog.buttons);\n    var objOfCells = extractCellsToObject(storagedMenuButtons);\n    var memFooter = record(renderInlineFooter({\n      buttons: storagedMenuButtons\n    }, backstage));\n    var dialogEvents = SilverDialogEvents.initDialog(function () {\n      return instanceApi;\n    }, {\n      onBlock: function (event) {\n        Blocking.block(dialog, function (_comp, bs) {\n          return getBusySpec(event.message, bs, backstage.shared.providers);\n        });\n      },\n      onUnblock: function () {\n        Blocking.unblock(dialog);\n      },\n      onClose: function () {\n        return extra.closeWindow();\n      }\n    }, backstage.shared.getSink);\n    var dialog = build$1({\n      dom: {\n        tag: 'div',\n        classes: ['tox-dialog', 'tox-dialog-inline'],\n        attributes: (_a = {\n          role: 'dialog'\n        }, _a['aria-labelledby'] = dialogLabelId, _a['aria-describedby'] = '' + dialogContentId, _a)\n      },\n      eventOrder: (_b = {}, _b[receive()] = [Reflecting.name(), Receiving.name()], _b[execute()] = ['execute-on-form'], _b[attachedToDom()] = ['reflecting', 'execute-on-form'], _b),\n      behaviours: derive$1([Keying.config({\n        mode: 'cyclic',\n        onEscape: function (c) {\n          emit(c, formCloseEvent);\n          return Optional.some(true);\n        },\n        useTabstopAt: function (elem) {\n          return !isPseudoStop(elem) && (name(elem) !== 'button' || get$3(elem, 'disabled') !== 'disabled');\n        }\n      }), Reflecting.config({\n        channel: dialogChannel,\n        updateState: updateState,\n        initialData: dialogInit\n      }), Focusing.config({}), config('execute-on-form', dialogEvents.concat([runOnSource(focusin(), function (comp, _se) {\n        Keying.focusIn(comp);\n      })])), Blocking.config({\n        getRoot: function () {\n          return Optional.some(dialog);\n        }\n      }), Replacing.config({}), RepresentingConfigs.memory({})]),\n      components: [memHeader.asSpec(), memBody.asSpec(), memFooter.asSpec()]\n    });\n    var instanceApi = getDialogApi({\n      getRoot: function () {\n        return dialog;\n      },\n      getFooter: function () {\n        return memFooter.get(dialog);\n      },\n      getBody: function () {\n        return memBody.get(dialog);\n      },\n      getFormWrapper: function () {\n        var body = memBody.get(dialog);\n        return Composing.getCurrent(body).getOr(body);\n      }\n    }, extra.redial, objOfCells);\n    return {\n      dialog: dialog,\n      instanceApi: instanceApi\n    };\n  };\n\n  var global$h = tinymce.util.Tools.resolve('tinymce.util.URI');\n\n  var getUrlDialogApi = function (root) {\n    var withRoot = function (f) {\n      if (root.getSystem().isConnected()) {\n        f(root);\n      }\n    };\n\n    var block = function (message) {\n      if (!isString(message)) {\n        throw new Error('The urlDialogInstanceAPI.block function should be passed a blocking message of type string as an argument');\n      }\n\n      withRoot(function (root) {\n        emitWith(root, formBlockEvent, {\n          message: message\n        });\n      });\n    };\n\n    var unblock = function () {\n      withRoot(function (root) {\n        emit(root, formUnblockEvent);\n      });\n    };\n\n    var close = function () {\n      withRoot(function (root) {\n        emit(root, formCloseEvent);\n      });\n    };\n\n    var sendMessage = function (data) {\n      withRoot(function (root) {\n        root.getSystem().broadcastOn([bodySendMessageChannel], data);\n      });\n    };\n\n    return {\n      block: block,\n      unblock: unblock,\n      close: close,\n      sendMessage: sendMessage\n    };\n  };\n\n  var SUPPORTED_MESSAGE_ACTIONS = ['insertContent', 'setContent', 'execCommand', 'close', 'block', 'unblock'];\n\n  var isSupportedMessage = function (data) {\n    return isObject(data) && SUPPORTED_MESSAGE_ACTIONS.indexOf(data.mceAction) !== -1;\n  };\n\n  var isCustomMessage = function (data) {\n    return !isSupportedMessage(data) && isObject(data) && has(data, 'mceAction');\n  };\n\n  var handleMessage = function (editor, api, data) {\n    switch (data.mceAction) {\n      case 'insertContent':\n        editor.insertContent(data.content);\n        break;\n\n      case 'setContent':\n        editor.setContent(data.content);\n        break;\n\n      case 'execCommand':\n        var ui = isBoolean(data.ui) ? data.ui : false;\n        editor.execCommand(data.cmd, ui, data.value);\n        break;\n\n      case 'close':\n        api.close();\n        break;\n\n      case 'block':\n        api.block(data.message);\n        break;\n\n      case 'unblock':\n        api.unblock();\n        break;\n    }\n  };\n\n  var renderUrlDialog = function (internalDialog, extra, editor, backstage) {\n    var _a;\n\n    var header = getHeader(internalDialog.title, backstage);\n    var body = renderIframeBody(internalDialog);\n    var footer = internalDialog.buttons.bind(function (buttons) {\n      if (buttons.length === 0) {\n        return Optional.none();\n      } else {\n        return Optional.some(renderModalFooter({\n          buttons: buttons\n        }, backstage));\n      }\n    });\n    var dialogEvents = SilverDialogEvents.initUrlDialog(function () {\n      return instanceApi;\n    }, getEventExtras(function () {\n      return dialog;\n    }, backstage.shared.providers, extra));\n\n    var styles = __assign(__assign({}, internalDialog.height.fold(function () {\n      return {};\n    }, function (height) {\n      return {\n        'height': height + 'px',\n        'max-height': height + 'px'\n      };\n    })), internalDialog.width.fold(function () {\n      return {};\n    }, function (width) {\n      return {\n        'width': width + 'px',\n        'max-width': width + 'px'\n      };\n    }));\n\n    var classes = internalDialog.width.isNone() && internalDialog.height.isNone() ? ['tox-dialog--width-lg'] : [];\n    var iframeUri = new global$h(internalDialog.url, {\n      base_uri: new global$h(window.location.href)\n    });\n    var iframeDomain = iframeUri.protocol + '://' + iframeUri.host + (iframeUri.port ? ':' + iframeUri.port : '');\n    var messageHandlerUnbinder = Cell(Optional.none());\n    var extraBehaviours = [config('messages', [runOnAttached(function () {\n      var unbind = bind$3(SugarElement.fromDom(window), 'message', function (e) {\n        if (iframeUri.isSameOrigin(new global$h(e.raw.origin))) {\n          var data = e.raw.data;\n\n          if (isSupportedMessage(data)) {\n            handleMessage(editor, instanceApi, data);\n          } else if (isCustomMessage(data)) {\n            internalDialog.onMessage(instanceApi, data);\n          }\n        }\n      });\n      messageHandlerUnbinder.set(Optional.some(unbind));\n    }), runOnDetached(function () {\n      messageHandlerUnbinder.get().each(function (unbinder) {\n        return unbinder.unbind();\n      });\n    })]), Receiving.config({\n      channels: (_a = {}, _a[bodySendMessageChannel] = {\n        onReceive: function (comp, data) {\n          descendant$1(comp.element, 'iframe').each(function (iframeEle) {\n            var iframeWin = iframeEle.dom.contentWindow;\n            iframeWin.postMessage(data, iframeDomain);\n          });\n        }\n      }, _a)\n    })];\n    var spec = {\n      header: header,\n      body: body,\n      footer: footer,\n      extraClasses: classes,\n      extraBehaviours: extraBehaviours,\n      extraStyles: styles\n    };\n    var dialog = renderModalDialog(spec, internalDialog, dialogEvents, backstage);\n    var instanceApi = getUrlDialogApi(dialog);\n    return {\n      dialog: dialog,\n      instanceApi: instanceApi\n    };\n  };\n\n  var setup$c = function (extras) {\n    var sharedBackstage = extras.backstage.shared;\n\n    var open = function (message, callback) {\n      var closeDialog = function () {\n        ModalDialog.hide(alertDialog);\n        callback();\n      };\n\n      var memFooterClose = record(renderFooterButton({\n        name: 'close-alert',\n        text: 'OK',\n        primary: true,\n        align: 'end',\n        disabled: false,\n        icon: Optional.none()\n      }, 'cancel', extras.backstage));\n      var titleSpec = pUntitled();\n      var closeSpec = pClose(closeDialog, sharedBackstage.providers);\n      var alertDialog = build$1(renderDialog({\n        lazySink: function () {\n          return sharedBackstage.getSink();\n        },\n        header: hiddenHeader(titleSpec, closeSpec),\n        body: pBodyMessage(message, sharedBackstage.providers),\n        footer: Optional.some(pFooter(pFooterGroup([], [memFooterClose.asSpec()]))),\n        onEscape: closeDialog,\n        extraClasses: ['tox-alert-dialog'],\n        extraBehaviours: [],\n        extraStyles: {},\n        dialogEvents: [run(formCancelEvent, closeDialog)],\n        eventOrder: {}\n      }));\n      ModalDialog.show(alertDialog);\n      var footerCloseButton = memFooterClose.get(alertDialog);\n      Focusing.focus(footerCloseButton);\n    };\n\n    return {\n      open: open\n    };\n  };\n\n  var setup$d = function (extras) {\n    var sharedBackstage = extras.backstage.shared;\n\n    var open = function (message, callback) {\n      var closeDialog = function (state) {\n        ModalDialog.hide(confirmDialog);\n        callback(state);\n      };\n\n      var memFooterYes = record(renderFooterButton({\n        name: 'yes',\n        text: 'Yes',\n        primary: true,\n        align: 'end',\n        disabled: false,\n        icon: Optional.none()\n      }, 'submit', extras.backstage));\n      var footerNo = renderFooterButton({\n        name: 'no',\n        text: 'No',\n        primary: false,\n        align: 'end',\n        disabled: false,\n        icon: Optional.none()\n      }, 'cancel', extras.backstage);\n      var titleSpec = pUntitled();\n      var closeSpec = pClose(function () {\n        return closeDialog(false);\n      }, sharedBackstage.providers);\n      var confirmDialog = build$1(renderDialog({\n        lazySink: function () {\n          return sharedBackstage.getSink();\n        },\n        header: hiddenHeader(titleSpec, closeSpec),\n        body: pBodyMessage(message, sharedBackstage.providers),\n        footer: Optional.some(pFooter(pFooterGroup([], [footerNo, memFooterYes.asSpec()]))),\n        onEscape: function () {\n          return closeDialog(false);\n        },\n        extraClasses: ['tox-confirm-dialog'],\n        extraBehaviours: [],\n        extraStyles: {},\n        dialogEvents: [run(formCancelEvent, function () {\n          return closeDialog(false);\n        }), run(formSubmitEvent, function () {\n          return closeDialog(true);\n        })],\n        eventOrder: {}\n      }));\n      ModalDialog.show(confirmDialog);\n      var footerYesButton = memFooterYes.get(confirmDialog);\n      Focusing.focus(footerYesButton);\n    };\n\n    return {\n      open: open\n    };\n  };\n\n  var validateData$1 = function (data, validator) {\n    return getOrDie(asRaw('data', validator, data));\n  };\n\n  var isAlertOrConfirmDialog = function (target) {\n    return closest$4(target, '.tox-alert-dialog') || closest$4(target, '.tox-confirm-dialog');\n  };\n\n  var inlineAdditionalBehaviours = function (editor, isStickyToolbar, isToolbarLocationTop) {\n    if (isStickyToolbar && isToolbarLocationTop) {\n      return [];\n    } else {\n      return [Docking.config({\n        contextual: {\n          lazyContext: function () {\n            return Optional.some(box(SugarElement.fromDom(editor.getContentAreaContainer())));\n          },\n          fadeInClass: 'tox-dialog-dock-fadein',\n          fadeOutClass: 'tox-dialog-dock-fadeout',\n          transitionClass: 'tox-dialog-dock-transition'\n        },\n        modes: ['top']\n      })];\n    }\n  };\n\n  var setup$e = function (extras) {\n    var backstage = extras.backstage;\n    var editor = extras.editor;\n    var isStickyToolbar$1 = isStickyToolbar(editor);\n    var alertDialog = setup$c(extras);\n    var confirmDialog = setup$d(extras);\n\n    var open = function (config, params, closeWindow) {\n      if (params !== undefined && params.inline === 'toolbar') {\n        return openInlineDialog(config, backstage.shared.anchors.inlineDialog(), closeWindow, params.ariaAttrs);\n      } else if (params !== undefined && params.inline === 'cursor') {\n        return openInlineDialog(config, backstage.shared.anchors.cursor(), closeWindow, params.ariaAttrs);\n      } else {\n        return openModalDialog(config, closeWindow);\n      }\n    };\n\n    var openUrl = function (config, closeWindow) {\n      return openModalUrlDialog(config, closeWindow);\n    };\n\n    var openModalUrlDialog = function (config, closeWindow) {\n      var factory = function (contents) {\n        var dialog = renderUrlDialog(contents, {\n          closeWindow: function () {\n            ModalDialog.hide(dialog.dialog);\n            closeWindow(dialog.instanceApi);\n          }\n        }, editor, backstage);\n        ModalDialog.show(dialog.dialog);\n        return dialog.instanceApi;\n      };\n\n      return DialogManager.openUrl(factory, config);\n    };\n\n    var openModalDialog = function (config, closeWindow) {\n      var factory = function (contents, internalInitialData, dataValidator) {\n        var initialData = internalInitialData;\n        var dialogInit = {\n          dataValidator: dataValidator,\n          initialData: initialData,\n          internalDialog: contents\n        };\n        var dialog = renderDialog$1(dialogInit, {\n          redial: DialogManager.redial,\n          closeWindow: function () {\n            ModalDialog.hide(dialog.dialog);\n            closeWindow(dialog.instanceApi);\n          }\n        }, backstage);\n        ModalDialog.show(dialog.dialog);\n        dialog.instanceApi.setData(initialData);\n        return dialog.instanceApi;\n      };\n\n      return DialogManager.open(factory, config);\n    };\n\n    var openInlineDialog = function (config$1, anchor, closeWindow, ariaAttrs) {\n      var factory = function (contents, internalInitialData, dataValidator) {\n        var initialData = validateData$1(internalInitialData, dataValidator);\n        var inlineDialog = value$3();\n        var isToolbarLocationTop = backstage.shared.header.isPositionedAtTop();\n        var dialogInit = {\n          dataValidator: dataValidator,\n          initialData: initialData,\n          internalDialog: contents\n        };\n\n        var refreshDocking = function () {\n          return inlineDialog.on(function (dialog) {\n            InlineView.reposition(dialog);\n            Docking.refresh(dialog);\n          });\n        };\n\n        var dialogUi = renderInlineDialog(dialogInit, {\n          redial: DialogManager.redial,\n          closeWindow: function () {\n            inlineDialog.on(InlineView.hide);\n            editor.off('ResizeEditor', refreshDocking);\n            inlineDialog.clear();\n            closeWindow(dialogUi.instanceApi);\n          }\n        }, backstage, ariaAttrs);\n        var inlineDialogComp = build$1(InlineView.sketch(__assign(__assign({\n          lazySink: backstage.shared.getSink,\n          dom: {\n            tag: 'div',\n            classes: []\n          },\n          fireDismissalEventInstead: {}\n        }, isToolbarLocationTop ? {} : {\n          fireRepositionEventInstead: {}\n        }), {\n          inlineBehaviours: derive$1(__spreadArrays([config('window-manager-inline-events', [run(dismissRequested(), function (_comp, _se) {\n            emit(dialogUi.dialog, formCancelEvent);\n          })])], inlineAdditionalBehaviours(editor, isStickyToolbar$1, isToolbarLocationTop))),\n          isExtraPart: function (_comp, target) {\n            return isAlertOrConfirmDialog(target);\n          }\n        })));\n        inlineDialog.set(inlineDialogComp);\n        InlineView.showWithin(inlineDialogComp, anchor, premade$1(dialogUi.dialog), Optional.some(body()));\n\n        if (!isStickyToolbar$1 || !isToolbarLocationTop) {\n          Docking.refresh(inlineDialogComp);\n          editor.on('ResizeEditor', refreshDocking);\n        }\n\n        dialogUi.instanceApi.setData(initialData);\n        Keying.focusIn(dialogUi.dialog);\n        return dialogUi.instanceApi;\n      };\n\n      return DialogManager.open(factory, config$1);\n    };\n\n    var confirm = function (message, callback) {\n      confirmDialog.open(message, function (state) {\n        callback(state);\n      });\n    };\n\n    var alert = function (message, callback) {\n      alertDialog.open(message, function () {\n        callback();\n      });\n    };\n\n    var close = function (instanceApi) {\n      instanceApi.close();\n    };\n\n    return {\n      open: open,\n      openUrl: openUrl,\n      alert: alert,\n      close: close,\n      confirm: confirm\n    };\n  };\n\n  function Theme() {\n    global$1.add('silver', function (editor) {\n      var _a = setup$b(editor),\n          uiMothership = _a.uiMothership,\n          backstage = _a.backstage,\n          renderUI = _a.renderUI,\n          getUi = _a.getUi;\n\n      Autocompleter.register(editor, backstage.shared);\n      var windowMgr = setup$e({\n        editor: editor,\n        backstage: backstage\n      });\n      return {\n        renderUI: renderUI,\n        getWindowManagerImpl: constant(windowMgr),\n        getNotificationManagerImpl: function () {\n          return NotificationManagerImpl(editor, {\n            backstage: backstage\n          }, uiMothership);\n        },\n        ui: getUi()\n      };\n    });\n  }\n\n  Theme();\n})();","map":{"version":3,"sources":["/home/lin/phase5/My-Place-Frontend/my-place/node_modules/tinymce/themes/silver/theme.js"],"names":["typeOf","x","t","Array","prototype","isPrototypeOf","constructor","name","String","isType","type","value","isSimpleType","eq","a","isString","isObject","isArray","isBoolean","isUndefined","undefined","isNullable","isNonNullable","isFunction","isNumber","isArrayOf","pred","i","len","length","noop","noarg","f","compose","fa","fb","args","_i","arguments","apply","compose1","fbc","fab","constant","identity","curry","fn","initialArgs","restArgs","all","concat","not","die","msg","Error","never","always","global$1","tinymce","util","Tools","resolve","__assign","Object","assign","s","n","p","hasOwnProperty","call","__rest","e","indexOf","getOwnPropertySymbols","propertyIsEnumerable","__spreadArrays","il","r","k","j","jl","none","NONE","o","isNone","thunk","id","me","fold","_s","is","isSome","getOr","getOrThunk","getOrDie","getOrNull","getOrUndefined","or","orThunk","map","each","bind","exists","forall","filter","equals","equals_","toArray","toString","some","constant_a","self","v","elementEq","b","from","Optional","nativeSlice","slice","nativeIndexOf","nativePush","push","rawIndexOf","ts","xs","contains","range","num","chunk","array","size","eachr","partition","pass","fail","arr","foldr","acc","foldl","findUntil","until","find","findIndex","flatten","reverse","difference","a1","a2","mapToObject","sort","comparator","copy","get","head","last","from$1","findMap","_opt","_f","mapError","_","onValue","toOptional","isValue","isError","error","message","opt","onError","fromOption","err","Result","SimpleResultType","res","stype","serror","svalue","partition$1","results","values","errors","obj","val","map$1","Value","bind$1","bindError","toResult","fromResult","SimpleResult","keys","each$1","props","map$2","tupleMap","tuple","objAcc","internalFilter","onTrue","onFalse","filter$1","mapToArray","find$1","get$1","key","has","hasNonNullableKey","generate","cases","constructors","adt","acase","count","keys$1","argLength","match","branches","branchKeys","join","allReqd","reqKey","foldArgs","target","log","label","console","params","Adt","hasOwnProperty$1","shallow","old","nu","deep","bothObjects","deepMerge","baseMerge","merger","objects","ret","curObject","merge","cached","called","strict","defaultedThunk","asOption","asDefaultedOptionThunk","mergeWithThunk","defaulted","fallback","mergeWith","base","comparison","bothErrors","firstError","secondError","bothValues","partition$2","result","exclude","fields","wrap","_a","wrapAll","keyvalues","kv","exclude$1","wrap$1","wrapAll$1","mergeValues","mergeErrors","consolidate","objs","partitions","mergeValues$1","mergeErrors$1","consolidateObj","consolidateArr","ResultCombine","formatObj","input","JSON","stringify","formatErrors","es","path","getErrorInfo","missingStrict","missingKey","missingBranch","branch","unsupportedFields","unsupported","custom","adt$1","field","state","strictAccess","fallbackAccess","fallbackThunk","optionAccess","optionDefaultedAccess","cExtractOne","strength","okey","presence","prop","bundle","av","extract","bundleAsOption","optValue","outcome","ov","baseThunk","instantiator","cExtract","valueThunk","getDelegate","value$1","validator","getSetKeys","objOfOnly","delegate","objOf","fieldNames","extra","fieldStrings","_instantiator","arrOf","oneOf","props_1","setOf","validateKeys","validatedKeys","validKeys","schema","vk","desc","processor","getP","anyValue","arrOfObj","chooseFrom","ch","vp","choose","choice","chosen","_anyValue","arrOfObj$1","objFields","arrOfVal","valueThunkOf","valueOf","setOf$1","errs","asRaw","extraction","errInfo","formatError","asRawOrDie","chooseProcessor","choose$1","thunkOf","anyValue$1","typedValue","expectedType","actualType","number","string","boolean","functionProcessor","isPostMessageable","every","iter","callbackFn","next","done","postMessageable","validateEnum","strict$1","strictOf","strictNumber","strictString","strictStringEnum","strictBoolean","strictFunction","forbid","_v","strictObjOf","objSchema","strictArrayOfObj","strictArrayOf","option","optionOf","optionNumber","optionString","optionFunction","optionArrayOf","optionObjOf","optionObjOfOnly","defaulted$1","defaultedOf","defaultedNumber","defaultedString","defaultedStringEnum","defaultedBoolean","defaultedFunction","defaultedPostMsg","defaultedArrayOf","defaultedObjOf","state$1","Cell","initial","set","fromHtml","html","scope","doc","document","div","createElement","innerHTML","hasChildNodes","childNodes","fromDom","fromTag","tag","node","fromText","text","createTextNode","dom","fromPoint","docElm","y","elementFromPoint","SugarElement","DeviceType","os","browser","userAgent","mediaMatch","isiPad","isiOS","test","isiPhone","isMobile","isAndroid","isTouch","isTablet","isPhone","iOSwebview","isSafari","isDesktop","isWebView","firstMatch","regexes","find$2","agent","major","minor","group","Number","replace","nu$1","detect","versionRegexes","cleanedAgent","toLowerCase","unknown","Version","detect$1","candidates","candidate","search","detectBrowser","browsers","version","current","detectOs","oses","UaString","checkRange","str","substr","start","contains$1","endsWith","suffix","blank","trim","normalVersionRegex","checkContains","uastring","PlatformInfo","edge","chrome","ie","opera","firefox","safari","unknown$1","nu$2","info","isBrowser","isEdge","isChrome","isIE","isOpera","isFirefox","Browser","windows","ios","android","linux","osx","solaris","freebsd","chromeos","unknown$2","nu$3","isOS","isWindows","isOSX","isLinux","isSolaris","isFreeBSD","isChromeOS","OperatingSystem","detect$2","deviceType","PlatformDetection","query","window","matchMedia","matches","platform","navigator","detect$3","compareDocumentPosition","documentPositionContainedBy","Node","DOCUMENT_POSITION_CONTAINED_BY","DOCUMENT","DOCUMENT_FRAGMENT","ELEMENT","TEXT","element","selector","nodeType","elem","msMatchesSelector","webkitMatchesSelector","mozMatchesSelector","bypassSelector","childElementCount","querySelectorAll","one","querySelector","eq$1","e1","e2","regularContains","d1","d2","ieContains","contains$2","ensureIsRoot","isRoot","ancestor","transform","stop","parentNode","el","transformed","closest","isSource","component","simulatedEvent","event","nu$4","parts","all$1","handlers","handler","any","read","can","abort","run","fuse","constant$1","touchstart","touchmove","touchend","touchcancel","mousedown","mousemove","mouseout","mouseup","mouseover","focusin","focusout","keydown","keyup","change","click","transitionend","selectstart","prefixName","alloy","tap","focus","postBlur","postPaste","receive","execute","focusItem","longpress","sandboxClose","typeaheadCancel","systemInit","documentTouchmove","documentTouchend","windowScroll","windowResize","attachedToDom","detachedFromDom","dismissRequested","repositionRequested","focusShifted","slotVisibility","changeTab","dismissTab","highlight","dehighlight","emit","dispatchWith","emitWith","properties","emitExecute","dispatch","data","getSystem","triggerEvent","dispatchEvent","derive","configs","predicate","preventDefault","prevent","runActionExtra","action","runOnName","runOnSourceName","redirectToUid","uid","getByUid","redirectee","redirectToPart","detail","partName","partUids","runWithTarget","ev","getByDom","closest$1","c","cutter","cut","stopper","runOnSource","runOnAttached","runOnDetached","runOnInit","runOnExecute","Global","Function","nodeName","isType$1","isElement","isText","isDocument","isDocumentFragment","owner","ownerDocument","documentOrOwner","dos","documentElement","defaultView","parent","offsetParent","nextSibling","children","child","index","cs","firstChild","isShadowRoot","host","supported","Element","attachShadow","getRootNode","isSupported","getContentContainer","body","isInShadowRoot","getShadowRoot","getShadowHost","getOriginalEventTarget","isOpenShadowHost","composed","composedPath","shadowRoot","before","marker","parent$1","insertBefore","after","sibling","append","prepend","firstChild$1","appendChild","appendAt","before$1","elements","append$1","empty","textContent","rogue","remove","removeChild","unwrap","wrapper","children$1","fromHtml$1","get$2","content","owner$1","docDom","fragment","createDocumentFragment","contentElements","getOuter","container","clone","cloneNode","rawSet","setAttribute","set$1","setAll","attrs","get$3","getAttribute","getOpt","has$1","hasAttribute","remove$1","removeAttribute","original","isDeep","shallow$1","getHtml","isRecursive","originator","events","warn","DefaultEvents","freeze","__proto__","unique","generate$1","prefix","date","Date","time","getTime","random","Math","floor","idAttr","prefix$1","idAttr$1","write","writeOnly","defineProperty","writable","read$1","generate$2","make","NoContextApi","getComp","debugInfo","triggerFocus","triggerEscape","build","addToWorld","removeFromWorld","addToGui","removeFromGui","broadcast","broadcastOn","broadcastEvent","isConnected","singleton","markAsBehaviourApi","apiName","apiFunction","endIndex","openBracketIndex","parameters","substring","split","toFunctionAnnotation","cleanParameters","markAsExtraApi","extraName","markAsSketchApi","premadeTag","premade","comp","getPremade","spec","makeApi","rest","getApis","NoState","init","nu$5","readState","generateFrom","validated","behaviours","list","optBlobThunk","output","blob","config","getBehaviours","bData","getData","byInnerKey","indexKey","chain","nu$6","classes","attributes","styles","merge$1","defnA","mod","combine","baseMod","modsByBehaviour","behaviour","exhibit","byAspect","modification","combineObjects","combinedClasses","combinedAttributes","combinedStyles","sortKeys","keyName","order","sorted","aKey","bKey","aIndex","bIndex","uncurried","purpose","curried","cHandler","curryArgs","descHandler","extraArgs","getCurried","behaviourTuple","nameToHandlers","groupByEvents","behaviourEvents","combine$1","eventOrder","byEventName","combineGroups","assemble","rawHandler","missingOrderError","eventName","tuples","fuse$1","sortedTuples","combined","assembled","baseBehaviour","toInfo","toDefinition","domChildren","components","toModification","domModification","toEvents","read$2","attr","add","remove$2","supports","classList","get$4","add$1","clazz","remove$3","add$2","cleanClass","remove$4","has$2","add$3","remove$5","isSupported$1","style","getPropertyValue","inBody","getBody","internalSet","property","setProperty","internalRemove","removeProperty","set$2","setAll$1","css","setOptions","get$5","getComputedStyle","getUnsafeProperty","getRaw","raw","getAllRaw","ruleName","item","isValidValue","remove$6","reflow","offsetWidth","get$6","set$3","renderToDom","definition","subject","innerHtml","getBehaviours$1","generateFrom$1","generate$3","getDomDefinition","bList","infoModification","baseModification","getEvents","baseEvents","getMe","systemApi","bBlob","modDefinition","subcomponents","connect","newApi","disconnect","syncComponents","subs","hasConfigured","apis","behaviourName","buildSubcomponents","build$1","buildFromSpec","userSpec","specEvents","completeSpec","external","extSpec","uids","userSpecWithUid","prebuilt","premade$1","Dimension","getOffset","h","parseFloat","aggregate","parseInt","isNaN","max","cumulativeInclusions","absoluteMax","api","getBoundingClientRect","height","offsetHeight","get$7","getOuter$1","setMax","inclusions","absMax","left","top","translate","SugarPosition","boxPosition","box","firstDefinedOrZero","absolute","win","offsetLeft","offsetTop","scrollTop","pageYOffset","scrollLeft","pageXOffset","clientTop","clientLeft","viewport","api$1","set$4","get$8","getOuter$2","setMax$1","mkEvent","kill","fromRawEvent","rawEvent","stopPropagation","clientX","clientY","handle","binder","useCapture","wrapped","addEventListener","unbind","bind$2","capture","removeEventListener","get$9","_DOC","to","scrollTo","get$a","_win","bounds","width","right","bottom","getBounds","scroll","clientWidth","clientHeight","visualViewport","pageLeft","pageTop","walkUp","navigation","frame","view","pathTo","d","paths","frameElement","Navigation","find$3","frames","offset","loc","pointed","point","rect","bounds$1","xy","w","absolute$1","position","ClosestOrAncestor","ancestor$1","descendant","descend","child_1","closest$2","ancestor$2","descendant$1","closest$3","is$1","find$4","queryElem","dependent","dep","manager","ariaId","link","unlink","isAriaPartOf","isPartOf","unknown$3","EventConfiguration","eventConfig","makeEventLogger","initialTarget","sequence","startTime","logEventCut","_name","logEventStopped","logNoParent","logEventNoHandlers","logEventResponse","finishTime","processEvent","status","patterns","NORMAL","noLogger","LOGGING","logger","STOP","getTrace","stack","lines","line","ignoreEvent","monitorEvent","menuFields","itemFields","itemSchema","_initSize","itemMarkers","tieredMenuMarkers","markers","required","onPresenceHandler","fieldName","trace","onHandler","onKeyboardHandler","onStrictHandler","onStrictKeyboardHandler","snapshot","initSize","nu$7","bubble","direction","boundsRestriction","adt$2","southeast","southwest","northeast","northwest","south","north","east","west","cata","cataVertical","middle","cataHorizontal","getRestriction","anchor","restriction","restrictions","dir","adjustBounds","boundsRestrictions","bubbleOffsets","applyRestriction","bubbleOffset","adjustedLeft","adjustedTop","adjustedRight","adjustedBottom","eastX","middleX","westX","northY","southY","centreY","eastEdgeX","westEdgeX","southeast$1","bubbles","southwest$1","northeast$1","northwest$1","north$1","south$1","east$1","west$1","all$2","allRtl","aboveOrBelow","aboveOrBelowRtl","belowOrAbove","belowOrAboveRtl","chooseChannels","channels","universal","events$1","receiveConfig","channelMap","receivingData","targetChannels","channelInfo","channelSchema","onReceive","ActiveReceiving","ReceivingSchema","executeEvent","bConfig","bState","executor","loadEvent","_simulatedEvent","create","active","configSchema","schemaSchema","doCreate","createModes","modes","wrapApi","bName","revokeBehaviour","getConfig","wrappedApis","apiF","wrappedExtra","extraF","revoke","prepared","configAsRaw","initialConfig","behaviourInfo","exhibitor","derive$1","capabilities","simpleSchema","create$1","modeSchema","createModes$1","branchKey","Receiving","posConfig","useFixed","ActivePosition","getDocument","focus$1","blur","hasFocus","root","activeElement","preserve","refocus","focused","oldFocus","newFocus","NuPositionCss","applyPositionCss","addPx","adt$3","relative","fixed","positionWithDirection","posName","decision","decisionX","decisionY","decisionWidth","decisionHeight","decisionRight","decisionBottom","reposition","origin","toBox","rel","viewport$1","pos","removeScroll","outerScroll","cata$1","onNone","onRelative","onFixed","none$1","anchorBox","box$1","cycleBy","delta","min","clamp","adt$4","fit","nofit","calcReposition","newX","newY","boundsX","boundsY","boundsWidth","boundsHeight","xInBounds","yInBounds","originInBounds","xFit","yFit","sizeInBounds","deltaW","abs","deltaH","maxX","maxY","limitX","limitY","attempt","candidateX","candidateY","bubbleLeft","bubbleTop","adjustedBounds","boundsBottom","boundsRight","upAvailable","downAvailable","maxHeight","westAvailable","eastAvailable","maxWidth","on","classesOn","off","classesOff","candidateYforTest","attempts","elementBox","panelWidth","panelHeight","attemptBestFit","layout","attemptLayout","newReposition","newDeltaW","newDeltaH","improved","abc","bestNext","elementSize","options","preference","setClasses","classInfo","setHeight","maxHeightFunction","setWidth","maxWidthFunction","setMaxHeight","anchored","available","expandable","defaultOr","dephault","simple","layouts","overrideOptions","go","allAlignments","nu$8","yoffset","getClasses","xDelta","yDelta","alignmentsOn","alignmentsOff","innerNorthwest","innerNortheast","innerNorth","innerSouthwest","innerSoutheast","innerSouth","innerWest","innerEast","nu$9","onDirection","isLtr","isRtl","getDirection","AttributeValue","Attribute","isBottomToTopDir","BottomToTop","schema$1","get$b","defaultLtr","defaultRtl","defaultBottomLtr","defaultBottomRtl","dirElement","isBottomToTop","customLtr","ls","onLtr","customRtl","onRtl","ltr","onBottomLtr","rtl","onBottomRtl","placement","anchorInfo","hotspot","overrides","placer","HotspotAnchor","placement$1","MakeshiftAnchor","adt$5","screen","toFixed","toAbsolute","sum","points","sumAsFixed","positions","sumAsAbsolute","absolute$2","hasSameOwner","frameOwner","compOwner","getRootPoint","capRect","newLeft","newTop","newWidth","newHeight","calcNewAnchor","optBox","rootPoint","topLeft","layoutsLtr","showAbove","layoutsRtl","placement$2","nodeBox","NodeAnchor","zeroWidth","nbsp","create$2","soffset","finish","foffset","SimRange","adt$6","cata$2","onBefore","onOn","onAfter","getStart","situ","before$2","after$1","Situ","adt$7","domRange","exact","exactFromRange","simRange","getStart$1","selection","rng","startContainer","startSitu","_finishSitu","_soffset","_finish","_foffset","relative$1","getWin","range$1","SimSelection","setStart","setStartBefore","setStartAfter","setFinish","setEndBefore","setEnd","setEndAfter","relativeToNative","finishSitu","createRange","exactToNative","toRect","getFirstRect","rects","getClientRects","adt$8","fromRange","startOffset","endContainer","endOffset","getRanges","doDiagnose","ranges","collapsed","reversed","rev","diagnose","asLtrRange","diagnosis","NodeValue","getOption","nodeValue","api$2","get$c","getEnd","isTextNodeWithCursorPosition","elementsWithCursorPosition","isCursorPosition","hasCursorPosition","last$1","descendantRtl","descendants","makeRange","after$2","same","getNativeSelection","getSelection","readRange","rangeCount","firstRng","getRangeAt","lastRng","doGetExact","anchorNode","focusNode","focus_1","anchorOffset","focusOffset","getExact","sel","getFirstRect$1","descendOnce","descendOnce$1","getAnchorSelection","modStart","modFinish","placement$3","selectionBox","optRect","rawRect","targetElement","SelectionAnchor","eastX$1","westX$1","northY$1","southY$1","southeast$2","southwest$2","northeast$2","northwest$2","all$3","allRtl$1","placement$4","submenuInfo","SubmenuAnchor","AnchorSchema","submenu","makeshift","getFixedOrigin","getRelativeOrigin","place","anchoring","placee","position$1","posState","positionWithin","boxElement","boundsBox","positionWithinBounds","anchorage","oldVisibility","doPlace","vis","getMode","pConfig","_pState","PositionApis","PositionSchema","Positioning","fireDetaching","fireAttaching","attach","detachChildren","childComp","replaceChildren","newChildren","deleted","attach$1","attachWith","insertion","doDetach","detach","detachChildren$1","attachSystem","guiSystem","attachSystemWith","attachSystemAfter","inserter","detachSystem","rebuild","sandbox","sConfig","sState","_data","getAttachPoint","built","open","newState","onOpen","setContent","openWhileCloaked","transaction","cloak","decloak","close","onClose","clear","isOpen","_sandbox","_sConfig","isPartOf$1","getState","store","cssKey","newValue","restore","oldValue","_sState","sink","cloakVisibilityAttr","hasPosition","SandboxApis","events$2","sandboxConfig","sandboxState","ActiveSandbox","SandboxSchema","contents","SandboxState","Sandboxing","dismissPopups","repositionPopups","mouseReleased","schema$2","receivingChannel","rawSpec","isPart","isExtraPart","fireEventInstead","fe","schema$3","receivingChannel$1","doReposition","onLoad","repConfig","repState","onUnload","setValue","getValue","getState$1","RepresentApis","events$3","resetOnDom","_se","ActiveRepresenting","memory","mode","isNotSet","manual","dataset","dataByValue","dataByText","lookup","itemString","update","items","currentDataByValue","currentDataByText","newDataByValue","newDataByText","meta","init$1","RepresentState","setValue$1","onSetValue","getValue$1","getDataKey","getFallbackEntry","onLoad$1","initialValue","onUnload$1","DatasetStore","getValue$2","_repState","setValue$2","onLoad$2","ManualStore","setValue$3","getValue$3","onLoad$3","initVal","onUnload$2","MemoryStore","RepresentSchema","Representing","setValueFrom","source","field$1","forbidden","get$d","dump","augment","SketchBehaviours","_placeholder","adt$9","single","multiple","isSubstituted","subPlaceholder","compSpec","placeholders","newSpec","scan","uiType","substitute","req","childSpecs","substituted","valuesThunk","preprocessor","preprocess","substituteAll","oneReplace","replacements","used","substitutePlaces","ps","ph","placeholder","adt$a","optional","fFactory","sketch","fSchema","fName","fPname","typeSpec","fGroupSchema","fDefaults","fOverrides","requiredSpec","externalSpec","optionalSpec","groupSpec","asNamedPart","part","name$1","asCommon","convert","adtConstructor","partSchema","external$1","PartType","combine$2","partSpec","partValidated","defaults","internals","externals","pname","factory","_partSpec","_partValidated","units","u","generate$4","np","g","doGenerateOne","generateOne","schemas","names","substitutes","getPart","partKey","getPartOrDie","getParts","partKeys","system","pk","getAllParts","pUid","_k","getAllPartNames","getPartsOrDie","defaultUids","baseUid","partTypes","partNames","pn","defaultUidsSchema","AlloyParts","partSchemas","partUidsSchemas","asRawOrDie$1","baseS","single$1","specWithUid","supplyUid","composite","partUidsSchema","components$1","hasUid","isSketchSpec","singleSchema","compositeSchema","single$2","rawConfig","configFields","extraApis","composite$1","partFields","cat","lift2","oa","ob","lift3","oc","mapFrom","someIf","inside","getCurrent","composeConfig","_composeState","ComposeApis","ComposeSchema","Composing","dehighlightAllExcept","hConfig","hState","skip","highlighted","highlightClass","skipComp","onDehighlight","dehighlightAll","dehighlight$1","isHighlighted","highlight$1","onHighlight","highlightFirst","getFirst","firstComp","highlightLast","getLast","lastComp","highlightAt","getByIndex","highlightBy","getCandidates","targetComp","queryTarget","getHighlighted","_hState","itemClass","getDelta","selected","dest","getPrevious","getNext","HighlightApis","HighlightSchema","Highlighting","BACKSPACE","TAB","ENTER","ESCAPE","SPACE","LEFT","UP","RIGHT","DOWN","cyclePrev","tryPrev","cycleNext","tryNext","inSet","which","and","preds","isShift","shiftKey","isControl","ctrlKey","isNotShift","rule","classification","choose$2","transitions","transition","reportFocusShifting","prevFocus","noChange","focusee","highlights","FocusInsideModes","typical","infoSchema","stateInit","getKeydownRules","getKeyupRules","optFocusIn","processKey","getRules","keyingConfig","keyingState","rules","onFocusHandler","focusInside","OnFocusMode","focusIn","tryGoInsideComponent","isEnterOrSpace","OnEnterOrSpaceMode","keyboardEvents","create$3","cyclicField","isVisible","tabbingConfig","visibilitySelector","findInitial","tabstops","visibles","firstTabstop","findCurrent","focusManager","isTabstop","useTabstopAt","_tabbingState","goFromTabstop","stopIndex","cycle","cyclic","tabstop","optStopIndex","goBackwards","navigate","goForwards","onEnter","exit","onEscape","AcyclicType","CyclicType","doDefaultExecute","defaultExecute","isComplex","stopEventForFirefox","_component","schema$4","execute$1","executeConfig","_executeState","spaceExec","useSpace","enterExec","useEnter","downExec","useDown","execKeys","useControlEnter","ExecutionType","flatgrid","dimensions","setGridSize","numRows","numColumns","getNumRows","getNumColumns","init$2","KeyingState","useH","movement","move","use","west$2","moveLeft","moveRight","east$2","useV","north$2","south$2","isHidden","locate","locateVisible","visible","findIndex$1","withGrid","numCols","oldRow","oldColumn","address","newIndex","row","column","cycleHorizontal","onLastRow","colsInRow","newColumn","cycleVertical","newRow","newCol","cycleRight","cycleLeft","cycleUp","cycleDown","schema$5","gridConfig","_gridState","first","execute$2","doMove","gridState","identified","handleTab","captureTab","doEscape","moveNorth","moveSouth","getKeydownRules$1","getKeyupRules$1","FlatgridType","horizontal","isDisabledButton","tryCycle","schema$6","findCurrent$1","flowConfig","execute$3","focusIn$1","_state","getInitial","moveLeft$1","moveRight$1","doMove$1","flowState","executeOnMove","doEscape$1","getKeydownRules$2","_flowState","westMovers","allowVertical","eastMovers","getKeyupRules$2","FlowType","toCell","matrix","rowIndex","columnIndex","cell","cycleHorizontal$1","startCol","deltaCol","newColIndex","cycleVertical$1","colIndex","startRow","deltaRow","nextRowIndex","colsInNextRow","nextColIndex","moveHorizontal","moveVertical","cycleRight$1","cycleLeft$1","cycleUp$1","cycleDown$1","moveLeft$2","moveRight$2","moveUp","moveDown","schema$7","focusIn$2","matrixConfig","previousSelector","selectors","execute$4","toMatrix","rows","doMove$2","ifCycle","ifMove","cycles","inRow","cellsInRow","allRows","moveLeft$3","moveRight$3","moveNorth$1","moveSouth$1","getKeydownRules$3","getKeyupRules$3","MatrixType","schema$8","execute$5","menuConfig","focusIn$3","moveUp$1","moveDown$1","fireShiftTab","menuState","moveOnTab","fireTab","getKeydownRules$4","getKeyupRules$4","MenuType","schema$9","getKeydownRules$5","specialInfo","onSpace","onShiftEnter","onShiftTab","onTab","onUp","onDown","onLeft","onRight","getKeyupRules$5","stopSpaceKeyup","SpecialType","acyclic","flow","flatgrid$1","execution","menu","special","KeyboardBranches","isFlatgridState","keyState","Keying","keyConfig","sendFocusIn","set$5","replaceConfig","replaceState","insert","childSpec","append$2","appendee","prepend$1","prependee","remove$7","removee","foundChild","_replaceConfig","replaceAt","replaceeIndex","replacer","replacee","replaceBy","replaceePred","ReplaceApis","Replacing","events$4","eventHandlers","focus$2","focusConfig","ignore","onFocus","blur$1","isFocused","FocusApis","exhibit$1","tabindex","events$5","stopMousedown","ActiveFocus","FocusSchema","Focusing","SetupBehaviourCellState","initialState","updateAriaState","toggleConfig","toggleState","ariaInfo","aria","updateClass","toggleClass","toggle","set$6","on$1","isOn","onLoad$4","ToggleApis","exhibit$2","events$6","load","toggleOnExecute","ActiveToggle","updatePressed","syncWithExpanded","updateExpanded","updateSelected","updateChecked","ToggleSchema","pressed","checked","expanded","Toggling","pointerEvents","onClick","events$7","optAction","executeHandler","hoverEvent","focusEvent","onHover","hover","focus$3","builder","toggling","hasSubmenu","itemBehaviours","tConfig","ignoreFocus","schema$a","builder$1","schema$b","owner$2","builder$2","focusWidget","widget","onHorizontalArrow","autofocus","setSource","_widget","widgetBehaviours","schema$c","itemSchema$1","separator","configureGrid","movementInfo","configureMatrix","rowSelector","configureMenu","parts$1","itemInfo","unit","fakeFocus","schema$d","grid","focus$4","make$1","_spec","_externals","menuBehaviours","selectedItem","role","Menu","transpose","byItem","byMenu","triggerItem","triggerMenu","generate$5","menus","expansions","menuItems","menuPaths","_triggerItem","init$3","primary","directory","isClear","setMenuBuilt","menuName","setContents","sPrimary","sMenus","sExpansions","sPaths","getTriggeringItem","menuValue","getTriggerData","getItemByValue","getPreparedMenu","triggeringItemValue","triggeredItem","triggeredMenu","triggeringItem","triggeringPath","getTriggeringPath","itemValue","extraPath","lookupItem","revPath","triggers","menuIndex","expand","collapse","refresh","lookupMenu","extractPreparedMenu","otherMenus","menuValues","getPrimary","getMenus","prep","LayeredState","make$2","_rawUiSpec","submenuParentItems","buildMenus","primaryName","makeSketch","nbMenu","layeredState","setup","componentMap","toDirectory","getItemValue","_container","_menuName","setActiveMenu","mv","closeOthers","others","backgroundMenu","stayInDom","getSubmenuParents","parentItems","itemComp","updateAriaExpansions","updateMenuPath","latestMenuName","menuPrep","activeMenu","ExpandHighlightDecision","buildIfRequired","expandRight","HighlightSubmenu","activeMenuPrep","onOpenSubmenu","collapseLeft","onCollapseMenu","updateView","keyOnItem","getSource","onExecute","onOpenMenu","highlightImmediately","navigateOnHover","HighlightParent","getActiveItem","collapseMenuApi","currentItem","highlightPrimary","extractMenuFromContainer","repositionMenus","maybeActivePrimary","allMenus","preparedMenus","primaryMenu","onRepositionMenu","collapseMenu","tmenuBehaviours","_keyInfo","selectedMenu","collapseItem","tieredData","singleData","collapseItem$1","tieredMenu","tmenu","makeMenu","menuSandbox","menuSpec","lazySink","isFirstTierSubmenu","triggeringPaths","getSubmenuLayouts","submenuTriggers","st","submenuLayouts","isPartOfRelated","related","getRelated","thing","showAt","showWithin","showWithinBounds","showMenuAt","showMenuWithinBounds","hide","getContent","inlineBehaviours","onShow","onHide","fireDismissalEventInstead","fireRepositionEventInstead","InlineView","westEdgeX$1","middleX$1","eastEdgeX$1","northY$2","southY$2","southeast$3","southwest$3","northeast$3","northwest$3","north$3","south$3","global$2","factory$1","lookupAttr","getModAttributes","roleAttrs","buttonBehaviours","Button","record","anyInSystem","asSpec","defaultIcon","icons","get$e","getFirst$1","notificationIconMap","success","warning","factory$2","memBannerText","translationProvider","renderPercentBar","percent","renderPercentText","memBannerProgress","progress","updateProgress","updateText","text$1","banner","iconChoices","icon","level","memButton","iconProvider","onAction","closeButton","Notification","NotificationManagerImpl","editor","extras","uiMothership","backstage","getLayoutDirection","prePositionNotifications","notifications","notification","moveTo","positionNotifications","firstItem","moveRel","getEl","settings","closeCallback","hideCloseButton","timeout","notificationWrapper","progressBar","shared","providers","getSink","header","isPositionedAtTop","setTimeout","layoutDirection_1","nodeAnchor","anchors","nuText","getArgs","rate","timer","cancel","clearTimeout","throttle","last$2","global$3","isBoundary","isBlock","getContentEditable","repeatLeft","process","rootNode","backwards","autocompleteSelector","create$4","detect$4","getNode","getDoc","extractContents","insertNode","elm","normalize","setCursorLocation","isValidTextRange","getText","isWhitespace","chr","stripTriggerChar","triggerCh","findChar","char","charAt","findStart","initRange","minChars","findTriggerChIndex","getParent","getRoot","spot","cloneRange","triggerCharIndex","lastIndexOf","triggerChar","getContext","createRng","selectNode","onKeypress","redirectKeyToItem","getItem","getView","isActive","cancelIfNecessary","isMenuOpen","stopImmediatePropagation","isProcessingAction","AutocompleterEditorEvents","global$4","point$1","isText$1","isElement$1","toLast","toLeaf","isPreviousCharContent","leaf","isStartOfWord","getTriggerContext","database","triggerChars","getDatabase","getRng","context","lookupWithContext","fetchOptions","startText","autocompleters","lookupByChar","autocompleter","lookupData","ac","fetchResult","fetch","maxResults","then","matchText","columns","highlightOn","separatorMenuItemSchema","createSeparatorMenuItem","autocompleterItemSchema","autocompleterSchema","createSeparatorItem","createAutocompleterItem","createAutocompleter","baseToolbarButtonFields","toolbarButtonSchema","createToolbarButton","baseToolbarToggleButtonFields","toggleButtonSchema","createToggleButton","contextBarFields","contextButtonFields","contextToggleButtonFields","launchButtonFields","launchToggleButtonFields","toggleOrNormal","contextformbutton","contextformtogglebutton","contextFormSchema","createContextForm","contextToolbarSchema","createContextToolbar","stringArray","register","popups","ui","registry","getAll","popup","datasetValues","dv","ItemResponse","ItemResponse$1","navClass","selectableClass","colorClass","presetClasses","normal","color","tickedClass","groupHeadingClass","iconClass","textClass","accessoryClass","caretClass","checkmarkClass","activeClass","iconClassRtl","containerClass","containerColumnClass","containerRowClass","containerAlignRightClass","containerAlignLeftClass","containerValignTopClass","containerValignMiddleClass","containerValignBottomClass","classForPreset","presets","forMenu","hasIcons","markers$1","menuClasses","dom$1","chunk$1","rowDom","chunks","forSwatch","forToolbar","preprocessCollection","isSeparator","allSplits","currentSplit","forCollection","initItems","_hasIcons","_item","forHorizontalCollection","menuHasIcons","handleError","createHorizontalPartialMenuWithAlloyItems","_columns","_presets","structure","createPartialMenuWithAlloyItems","cardImageFields","cardImageSchema","cardTextFields","cardTextSchema","itemSchema$2","cardimage","cardtext","cardcontainer","cardContainerSchema","commonMenuItemFields","cardMenuItemSchema","createCardMenuItem","choiceMenuItemSchema","createChoiceMenuItem","fancyTypes","fancyMenuItemSchema","createFancyMenuItem","menuItemSchema","createMenuItem","nestedMenuItemSchema","createNestedMenuItem","toggleMenuItemSchema","createToggleMenuItem","detectSize","margin","selectorClass","descendants$1","columnLength","thisTop","cTop","ceil","namedEvents","unnamedEvents","SimpleBehaviours","ExclusivityChannel","ShowTooltipEvent","HideTooltipEvent","hideAllExclusive","_tConfig","_tState","setComponents","tState","specs","getTooltip","tooltip","TooltippingApis","events$8","tooltipConfig","clearTooltip","clearTimer","show","isShowing","tooltipDom","tooltipComponents","setTooltip","resetTimer","delay","ActiveTooltipping","TooltippingSchema","init$4","TooltippingState","Tooltipping","escape","global$5","global$6","nativeDisabled","onLoad$5","disableConfig","disableState","disabled","disable","enable","hasNative","useNative","nativeIsDisabled","nativeDisable","nativeEnable","ariaIsDisabled","ariaDisable","ariaEnable","_disableState","disableClass","onDisabled","onEnabled","isDisabled","set$7","DisableApis","exhibit$3","events$9","ActiveDisable","DisableSchema","Disabling","global$7","getSkinUrl","skin","getParam","skinUrl","skinName","documentBaseURI","baseURL","isReadOnly","isSkinDisabled","getHeightSetting","getElement","getWidthSetting","DOM","getStyle","getMinWidthSetting","getMinHeightSetting","getMaxWidthSetting","getMaxHeightSetting","getUserStyleFormats","isMergeStyleFormats","getLineHeightFormats","getRemovedMenuItems","isMenubarEnabled","isToolbarEnabled","toolbar","isToolbarTrue","isToolbarString","isToolbarObjectArray","isMultipleToolbars","getMultipleToolbarsSetting","toolbars","toolbarArray","ToolbarMode","getToolbarMode","ToolbarLocation","getToolbarGroups","getToolbarLocation","auto","isToolbarLocationBottom","fixedContainerSelector","fixedToolbarContainerTarget","isToolbarPersist","fixedContainerTarget","inline","useFixedContainer","getUiContainer","fixedContainer","isDistractionFree","isStickyToolbar","isDraggableModal","getMenubar","getToolbar","getFilePickerCallback","getFilePickerTypes","getFileBrowserCallbackTypes","noTypeaheadUrls","getAnchorTop","getAnchorBottom","getFilePickerValidatorHandler","ReadOnlyChannel","ReadOnlyDataSchema","broadcastReadonly","uiComponents","readonly","outerContainer","mothership","setupReadonlyModeSwitch","setMode","receivingConfig","button","splitButton","toolbarButton","DisablingConfigs","runWithApi","getApi","onControlAttached","editorOffCell","onDestroy","onSetup","onControlDetached","onMenuItemExecute","itemResponse","triggersSubmenu","CLOSE_ON_EXECUTE","menuItemEventOrder","componentRenderPipeline","renderCommonItem","providersbackstage","optComponents","buildData","global$8","convertText","mac","alt","ctrl","shift","access","other","shortcut","updated","segment","renderIcon","iconHtml","renderText","renderHtml","renderStyledText","renderShortcut","renderCheckmark","renderSubmenuCaret","renderDownwardsCaret","renderContainer","directionClass","alignClass","align","getValignClass","valign","renderImage","src","renderColorStructure","itemText","iconSvg","providerBackstage","colorPickerCommand","removeColorCommand","getDom","common","title","baseDom","renderItemDomStructure","rtlClass","ariaLabel","domTitle","renderNormalItemStructure","renderIcons","textRender","leftIcon","checkmark","checkMark","htmlContent","menuItem","shortcutContent","caret","rtlIcon","rtlTransform","renderItemStructure","providersBackstage","fallbackIcon","getIconName","iconName","needRtlClass","iconContent","tooltipBehaviour","sharedBackstage","tooltipWorker","_tooltip","encodeText","encode","replaceText","translated","encoded","escapedMatchRegex","RegExp","renderAutocompleteItem","useText","onItemValueHandler","_api","render","shouldHighlight","cardText","renderCardMenuItem","setDisabled","renderChoiceItem","isSelected","setActive","parts$2","hexColour","shorthandRegex","longformRegex","isHexString","hex","getLongForm","hexString","m","extractValues","longForm","splitForm","exec","toHex","toUpperCase","fromRgba","rgbaColour","red","green","blue","round","rgbRegex","rgbaRegex","alpha","isRgbaComponent","fromHsv","hsv","hue","saturation","brightness","side","chroma","fromHex","fromStringValues","fromString","rgbaString","rgbMatch","rgbaMatch","rgba","fireSkinLoaded","fire","fireSkinLoadError","fireResizeEditor","fireResizeContent","fireScrollContent","fireTextColorChange","global$9","storageName","ColorCache","storageString","localstorage","parse","prune","diff","cache","unshift","pop","setItem","idx","splice","choiceItem","defaultColors","colorCache","mapColors","colorMap","colors","canvas","ctx","byteAsHex","colorByte","alphaByte","bg","colorByteWithWhiteBg","asHexColor","clearRect","fillStyle","fillRect","getImageData","getColorCols","defaultCols","hasCustomColors","getColorMap","getColors","unmapped","getCurrentColors","addColor","getCurrentColor","format","getParents","applyFormat","undoManager","transact","formatter","nodeChanged","removeFormat","registerCommands","addCommand","calcCols","sqrt","getColorCols$1","getAdditionalColors","hasCustom","applyColor","onChoice","dialog","colorPickerDialog","colorOpt","execCommand","getColors$1","getFetch","callback","setIconColor","splitButtonApi","newColor","setIconFill","registerTextColorButton","lastColor","addSplitButton","select","optCurrentRgb","currentRgb","currentHex","_splitButtonApi","onItemAction","registerTextColorMenuItem","addNestedMenuItem","getSubmenuItems","fancytype","isValid","onSubmit","colorpicker","windowManager","alert","details","initialData","buttons","onCancel","register$1","lastForeColor","lastBackColor","createPartialChoiceMenu","presetItemTypes","alloyItems","createChoiceItems","itemPresets","deriveMenuMovement","menuMarkers","rowClass","deriveCollectionMovement","renderColorSwatchItem","colorinput","widgetSpec","cellOverEvent","cellExecuteEvent","makeCell","col","labelId","emitCellOver","se","makeCells","cells","selectCells","selectedRow","selectedColumn","makeComponents","cellRow","makeLabelText","renderInsertTableMenuItem","sizeLabelId","memLabel","fancyMenuItems","inserttable","colorswatch","valueOpt","renderFancyMenuItem","renderNestedItem","downwardsCaret","renderNormalItem","renderSeparatorItem","renderToggleMenuItem","autocomplete","nested","toggle$1","fancy","card","FocusMode","createMenuItemFromBridge","isHorizontalMenu","parseForHorizontalMenu","menuitem","createAutocompleteItems","createPartialMenu","itemHasIcon","createItem","createPartial","createTieredDataFrom","partialMenu","createMenuFrom","focusMode","ContentFocus","register$2","activeAutocompleter","processingAction","hideIfNecessary","lastElement","getAutocompleters","getCombinedItems","choices","itemMeta","nr","autocompleterApi","reload","BUBBLE_TO_SANDBOX","commenceIfNecessary","matchLength","display","ld","doLookup","newContext","lookupInfo","combinedItems","autocompleterUiApi","hasPlugin","Autocompleter","filter$2","bind$3","capture$1","fromRawEvent$1","closest$4","DelayedFunction","fun","ref","schedule","SIGNIFICANT_MOVE","LONGPRESS_DELAY","getTouch","touches","isFarEnough","touch","distX","distY","monitor","startData","longpressFired","longpress$1","handleTouchstart","handleTouchmove","handleTouchend","isSame","fireIfReady","isDangerous","keyEv","settingsSchema","bindFocus","bindBlur","setup$1","rawSettings","tapEvent","simpleEvents","tapStopped","stopped","pasteTimeout","onPaste","onKeydown","stopBackspace","onFocusIn","focusoutTimeout","onFocusOut","derive$2","rawTarget","fromSource","isStopped","isCut","fromExternal","adt$b","resume","complete","doTriggerHandler","eventType","handlerInfo","eventHandler","doTriggerOnUntilStopped","triggerHandler","listeners","_logger","listener","triggerUntilStopped","triggerOnUntilStopped","broadcastHandler","EventRegistry","registerId","findHandler","filterByType","isAboveRoot","unregisterId","handlersById","_eventName","Registry","readOrTag","failOnDuplicate","tagId","conflict","unregister","getById","factory$3","domWithoutAttributes","containerBehaviours","Container","takeover","domEvents","_alloyId","broadcast$1","destroy","broadcastData","receivers","receiver","renderBar","interpreter","schema$e","parts$3","excludeFactory","factory$4","fieldBehaviours","descriptor","descriptorId","getField","getLabel","FormField","exhibit$4","tabConfig","tabAttr","ActiveTabstopping","TabstopSchema","Tabstopping","global$a","renderFormFieldWith","pLabel","pField","extraClasses","extraBehaviours","renderFormFieldSpecWith","renderFormField","renderFormFieldDomWith","renderFormFieldDom","renderLabel","formChangeEvent","formCloseEvent","formCancelEvent","formActionEvent","formSubmitEvent","formBlockEvent","formUnblockEvent","formTabChangeEvent","formResizeEvent","renderCollection","runOnItem","htmlLines","mapItemName","disabledClass","encodeAllRaw","tgt","collectionEvents","currentActive","iterCollectionItems","applyAttributes","childElm","schema$f","focusBehaviours","selectOnFocus","setSelectionRange","inputBehaviours","dom$2","inputAttributes","inputStyles","inputClasses","factory$5","Input","exports$1","module","exports","define","require","amd","global","EphoxContactWrapper","code","cachedSetTimeout","cachedClearTimeout","defaultSetTimout","defaultClearTimeout","runTimeout","runClearTimeout","queue","draining","currentQueue","queueIndex","cleanUpNextTick","drainQueue","nextTick","Item","env","argv","versions","addListener","once","removeListener","removeAllListeners","prependListener","prependOnceListener","binding","cwd","chdir","umask","setImmediate","setTimeoutFunc","thisArg","Promise","TypeError","_handled","_value","_deferreds","doResolve","deferred","_immediateFn","cb","onFulfilled","onRejected","reject","promise","finale","_unhandledRejectionFn","Handler","reason","ex","prom","remaining","race","_setImmediateFn","_setUnhandledRejectionFn","clearImmediate","immediateIds","nextImmediateId","Timeout","setInterval","clearInterval","clearFn","_id","_clearFn","unref","enroll","msecs","_idleTimeoutId","_idleTimeout","unenroll","_unrefActive","onTimeout","_onTimeout","onNextTick","promisePolyfill","boltExport","nu$a","baseFn","callbacks","nCallback","isReady","cbs","pure","LazyValue","errorReporter","make$3","aFutureB","toPromise","anonBind","futureB","toLazy","toCached","nu$b","pure$1","Future","ariaElements","isAriaElement","markValid","invalidConfig","invalidClass","notify","notifyInfo","getContainer","validHtml","onValid","markInvalid","invalidState","onInvalid","_invalidState","validatorInfo","validate","run$1","onValidate","valid","isInvalid","InvalidateApis","events$a","onEvent","validateOnLoad","ActiveInvalidate","InvalidateSchema","Invalidating","validation","getCoupled","coupleConfig","coupleState","getOrCreate","CouplingApis","CouplingSchema","init$5","coupled","CouplingState","Coupling","partType","HighlightOnOpen","getAnchor","getHotspot","getAnchorOverrides","mapFetch","fetcher","openF","highlightOnOpen","futureData","getLazySink","tdata","HighlightFirst","open$1","onOpenSync","processed","close$1","_onOpenSync","_highlightOnOpen","togglePopup","showing","matchWidth","useMinWidth","buttonWidth","sinkDetail","internalSink","lazySinkFn","doRepositionMenus","makeSandbox","ariaOwner","sandboxClasses","sandboxBehaviours","sandboxFields","schema$g","parts$4","factory$6","switchToMenu","HighlightNone","triggerExecute","dropdownBehaviours","Dropdown","exhibit$5","unselectable","events$b","ActiveUnselecting","Unselecting","renderPanelButton","colorInputChangeEvent","colorSwatchChangeEvent","colorPickerCancelEvent","renderColorInput","colorInputBackstage","inputValue","span","emitSwatchChange","colorBit","memColorButton","colorPicker","colorButton","_field","labelPart","edgePart","model","edgeActions","det","mouseIsDown","tlEdgePart","tedgePart","trEdgePart","redgePart","brEdgePart","bedgePart","blEdgePart","ledgePart","thumbPart","spectrumPart","modelDetail","getValueFromEvent","spectrum","SliderParts","_sliderChangeEvent","sliderChangeEvent","isTouchEvent","evt","getEventSource","touchEvent","mouseEvent","r$1","l","minX","minY","min1X","min1Y","max1X","max1Y","range$2","xRange","yRange","halfX","halfY","step","stepSize","snap","snapToGrid","snapStart","rounded","hasEdge","edgeName","hasLEdge","hasREdge","hasTEdge","hasBEdge","currentValue","xValue","yValue","xyValue","fireSliderChange","setToTLEdgeXY","setToTEdge","setToTEdgeXY","setToTREdgeXY","setToREdge","setToREdgeXY","setToBREdgeXY","setToBEdge","setToBEdgeXY","setToBLEdgeXY","setToLEdge","setToLEdgeXY","reduceBy","increaseBy","capValue","snapValueOf","initValue","extraValue","remainder","adjustment","rawSteps","maxSteps","numSteps","findOffsetOf","findValueOf","hasMinEdge","hasMaxEdge","minBound","maxBound","screenRange","capMin","capMax","findOffsetOfValue","maxOffset","centerMinEdge","centerMaxEdge","getBounds$1","getBoundsProperty","getMinXBounds","getMaxXBounds","getMinYBounds","getMaxYBounds","getXScreenRange","getYScreenRange","getCenterOffsetOf","componentMinEdge","componentMaxEdge","spectrumMinEdge","getXCenterOffSetOf","componentBounds","spectrumBounds","getYCenterOffSetOf","fireSliderChange$1","sliderValue","findValueOfOffset","sliderVal","setToMin","setToMax","moveBy","handleMovement","findOffsetOfValue$1","minEdge","maxEdge","minOffset","findPositionOfValue","slider","setPositionFromValue","thumb","edges","getSpectrum","getLeftEdge","getRightEdge","thumbRadius","HorizontalModel","fireSliderChange$2","sliderValue$1","findValueOfOffset$1","setValueFrom$1","setToMin$1","setToMax$1","moveBy$1","handleMovement$1","getValueFromEvent$1","findOffsetOfValue$2","findPositionOfValue$1","setPositionFromValue$1","getTopEdge","getBottomEdge","onLeft$1","onRight$1","onUp$1","onDown$1","edgeActions$1","VerticalModel","fireSliderChange$3","sliderValue$2","setValueFrom$2","moveBy$2","isVerticalMovement","handleMovement$2","setToMin$2","mX","mY","setToMax$2","getValueFromEvent$2","setPositionFromValue$2","xPos","yPos","thumbXRadius","thumbYRadius","onLeft$2","onRight$2","onUp$2","onDown$2","edgeActions$2","TwoDModel","SliderSchema","getThumb","changeValue","onChange","resetToMin","resetToMax","fireOnChoose","onChoose","wasDown","onDragStart","onDragEnd","sliderBehaviours","getInitialValue","onInit","Slider","hsvColour","fromRgb","minRGB","maxRGB","hexToHsv","hsvToHex","fieldsUpdate","sliderUpdate","paletteUpdate","sliderFactory","getClass","_thumb","owner$3","schema$h","getPartName","sketch$1","fSpec","fieldParts","make$4","toResult$1","formBehaviours","form","resPs","resPThunk","pName","Form","validInput","invalidInput","validatingInput","translatePrefix","rgbFormFactory","onValidHexx","onInvalidHexx","invalidation","renderTextField","description","helptext","comps","concats","copyRgbToHex","hexField","copyRgbToForm","rgb","memPreview","updatePreview","preview","copyHexToRgb","setValueRgb","getValueRgb","onInvalidInput","onValidHex","onValidRgb","isHexInputEvent","onValidInput","formPartStrings","redStrings","greenStrings","blueStrings","hexStrings","updateHex","rgbFormSketcher","paletteFactory","_translate","setColour","grdWhite","createLinearGradient","addColorStop","grdBlack","setPaletteHue","setPaletteThumb","_detail","_slider","saturationBrightnessPaletteSketcher","setHue","_apis","setThumb","makeFactory","rgbForm","onInvalidHex","sbPalette","hueSliderToDegrees","hueDegreesToSlider","paletteRgba","paletteHue","memSlider","memPalette","memRgb","updatePalette","_hex","palette","updateFields","updateSlider","updatePaletteThumb","updateState","runUpdates","updates","onPaletteUpdate","oldHue","newHsv","newHex","onSliderUpdate","oldRgb","oldHsv","onFieldsUpdate","colourPickerSketcher","self$1","memento","mem","childAt","ComposingConfigs","english","getEnglishText","translate$1","renderColorPicker","colourPickerFactory","memPicker","picker","optRgbForm","optHex","formValues","pattern","global$b","isOldCustomEditor","renderCustomEditor","editorApi","memReplaced","ta","scriptId","scriptUrl","ea","cvalue","ed","global$c","processors","memento$1","rawProcessors","rawValue","postprocess","withComp","optInitialValue","getter","setter","withElement","domValue","domHtml","memory$1","RepresentingConfigs","defaultImageFileTypes","filterByExtension","files","allowedImageFileTypes","explode","getSetting","isFileInAllowedTypes","file","renderDropZone","actions","onDrop","transferEvent","handleFiles","dataTransfer","onSelect","memInput","accept","renderField","inputComp","renderGrid","beforeObject","afterObject","craftWithClasses","outline","craft","triggerTab","onFocus$1","isPseudoStop","platformNeedsSandboxing","getDynamicSource","isSandbox","cachedValue","_frameComponent","frameComponent","contentWindow","renderIFrame","sandboxed","sourcing","create$5","resize","clone$1","tCanvas","get2dContext","drawImage","getWidth","image","naturalWidth","getHeight","naturalHeight","anyWindow","asap","immediateFn","catch","values_1","Promise$1","blobToImage","blobUrl","URL","createObjectURL","Image","removeListeners","loaded","dataUriToBlobSync","uri","mimetype","base64","sliceSize","byteCharacters","atob","bytesLength","slicesCount","byteArrays","sliceIndex","begin","end","bytes","charCodeAt","Uint8Array","Blob","dataUriToBlob","canvasToBlob","quality","HTMLCanvasElement","toBlob","toDataURL","canvasToDataURL","blobToCanvas","revokeImageUrl","blobToDataUri","reader","FileReader","onloadend","readAsDataURL","revokeObjectURL","create$6","getCanvas","initialType","getType","toBase64","toAdjustedBlob","toAdjustedDataURL","toAdjustedBase64","dataurl","toCanvas","fromBlob","fromCanvas","blobToImageResult","clamp$1","parsedValue","identity$1","DELTA_INDEX","multiply","matrix1","matrix2","out","adjustContrast","adjustBrightness","adjustColors","adjustR","adjustG","adjustB","colorFilter","ir","applyColorFilter","applyMatrix","pixelsData","m0","m1","m2","m3","m4","m5","m6","m7","m8","m9","m10","m11","m12","m13","m14","m15","m16","m17","m18","m19","pixels","putImageData","convoluteFilter","applyConvoluteFilter","pIn","pOut","aMatrix","halfSide","drgba","cy","cx","scx","scy","innerOffset","wt","pixelsIn","pixelsOut","functionColorFilter","colorFn","filterImpl","applyLookup","complexAdjustableColorFilter","matrixAdjustFn","adjust","basicColorFilter","basicConvolutionFilter","kernel","invert","contrast","colorize","sharpen","gamma","pow","scale","dW","dH","sW","sH","wRatio","hRatio","scaleCapped","scaled","_scale","ceilWithPrecision","precision","mul","upper","rotate","angle","applyRotate","degrees","rad","PI","sin","cos","flip","axis","applyFlip","crop","applyCrop","resize$1","newCanvas","invert$1","sharpen$1","gamma$1","colorize$1","brightness$1","contrast$1","flip$1","crop$1","resize$2","rotate$1","renderIcon$1","renderIconFromPack","iconsProvider","renderReplacableIconFromPack","renderLabel$1","_a$1","internalToolbarButtonExecute","onToolbarButtonExecute","itemApi","buttonApi","toolbarButtonEventOrder","updateMenuText","updateMenuIcon","renderCommonDropdown","optMemDisplayText","optMemDisplayIcon","onLeftOrRightInMenu","dropdown","tooltipAttributes","translatedTooltip","memDropdown","displayText","displayIcon","isMenuItemReference","isExpandingMenuItem","separator$1","unwrapReferences","realItems","getFromExpandingItem","submenuItems","newMenus","newExpansions","getFromItem","generateValueIfRequired","itemWithValue","newData","build$2","mainMenu","submenus","getMenuButtonApi","renderMenuButton","_comp","getFetch$1","getButton","getMenuItemAction","storage","orig","getMenuItemSetup","renderCommonSpec","actionOpt","domFinal","renderIconButtonSpec","renderIconButton","iconButtonSpec","renderButtonSpec","translatedText","borderless","renderButton","buttonSpec","getAction","buttonType","isMenuFooterButtonSpec","isNormalFooterButtonSpec","renderFooterButton","memButton_1","menuButtonSpec","fixedSpec","renderDialogButton","schema$i","coupledPart","selfName","otherName","lock","onLockedChange","parts$5","locked","lockClass","factory$7","coupledFieldBehaviours","field1Name","field1","field2Name","field2","getField1","getField2","getLock","FormCoupledInputs","formatSize","unitDec","maxDecimal","numText","parseSize","sizeText","numPattern","convertUnit","inInch","noSizeConversion","_input","ratioSizeConversion","makeRatioConverter","currentFieldText","otherFieldText","cValue","oValue","cSize","oSize","renderSizeInput","converter","ratioEvent","pLock","formGroup","getFieldPart","isField1","widthField","heightField","_lock","newSize","optCurrent","optOther","value1","value2","undo","redo","zoom","back","swap","tempTransform","transformApply","internal","saveState","disable$1","enable$1","external$2","renderEditPanel","imagePanel","createButton","createIconButton","disableAllComponents","eventcomp","enableAllComponents","panelDom","noop$1","emit$1","emitDisable","emitEnable","emitTransform","emitTempTransform","getBackSwap","memContainer","ButtonPanel","emitTransformApply","createBackButton","createSpacer","createApplyButton","makeCropTransform","getRect","cropPanelComponents","hideCrop","CropPanel","memSize","constrain","makeResizeTransform","resizePanelComponents","sizeInput","ResizePanel","makeValueTransform","horizontalFlip","verticalFlip","counterclockwiseRotate","clockwiseRotate","flipRotateOnAction","operation","flipRotateComponents","FlipRotatePanel","makeSlider","makeVariableSlider","valTransform","variableFilterPanelComponents","createVariableFilterPanel","filterPanelComponents","FilterPanel","BrightnessPanel","ContrastPanel","GammaPanel","makeColorTransform","makeColorSlider","redOpt","memRed","blueOpt","memBlue","greenOpt","memGreen","colorizePanelComponents","ColorizePanel","getTransformPanelEvent","panel","cropPanelUpdate","_anyInSystem","showCrop","resizePanelUpdate","measurements","getMeasurements","sharpenTransform","invertTransform","buttonPanelComponents","getApplyButton","global$d","global$e","global$f","global$g","getDocumentSize","scrollWidth","scrollHeight","updateWithTouchData","changedTouches","DragHelper","$eventOverlay","downButton","startX","startY","handleElement","getElementById","docSize","cursor","handleElm","screenX","screenY","runtimeStyle","zIndex","opacity","appendTo","drag","deltaX","deltaY","create$7","currentRect","viewPortRect","clampRect","containerElm","dragHelpers","handles","xMul","yMul","blockers","getAbsoluteRect","outerRect","relativeRect","getRelativeRect","innerRect","getInnerRect","moveRect","startRect","instance","setInnerRect","createDragHelper","blocker","repaint","activeHandle","moveAndBlock","keyCode","SPACEBAR","toggleVisibility","updateElementRect","setRect","setViewPortRect","setClampRect","helper","extend","CropRect","loadImage","renderImagePanel","initialUrl","memBg","zoomState","cropRect","rectState","viewRectState","repaintImg","img","panelW","panelH","cRect","zoomFit","updateSrc","url","aImg","lastViewRect","viewRect","inflate","currentZoom","newZoom","newRect","setButtonEnabled","enabled","renderSideBar","updateButtonUndoStates","undoEnabled","redoEnabled","memUndo","memRedo","UndoStack","removed","canUndo","canRedo","makeState","blobState","tempState","undoStack","getBlobState","setBlobState","getTempState","temp","updateTempState","newTempState","createState","destroyTempState","destroyState","destroyStates","states","addBlobState","addTempState","applyTempState","postApply","currentState","getHistoryStates","renderImageTools","historyStates","sideBar","disableUndoRedo","_oImg","unblock","imageResultToBlob","block","editPanel","applyButton","blobManipulate","oImg","manipulate","tempManipulate","manipulateApply","currentUrl","renderLabel$2","backstageShared","isSingleListItem","dataAttribute","fetchItems","dropdownComp","selectedValue","findItemByValue","renderListBox","initialItem","sketchSpec","listBoxWrap","renderPanel","factory$8","initialValues","selectClasses","selectAttributes","selectBehaviours","found","HtmlSelect","renderSelectBox","translatedOptions","chevron","selectWrap","renderTable","renderTh","renderHeader","renderTd","renderTr","renderRows","baseInputBehaviours","multiline","validatingBehaviours","vl","inputMode","inputmode","classname","flex","extraClasses2","maximized","renderInput","renderTextarea","events$c","streamConfig","streamState","streams","stream","cancelEvent","ActiveStreaming","_config","setTimer","init$6","StreamingState","setup$2","streamInfo","sInfo","throttler","onStream","stopEvent","StreamingSchema","Streaming","setValueFromItem","itemData","setCursorAtEnd","setSelectionOn","setSelectionToEnd","attemptSelectOver","selectsOver","inputDisplay_1","getDisplayText","itemDisplay","itemExecute","make$5","navigateList","highlighter","previewing","focusBehaviours$1","responseTime","focusInInput","previousValue_1","pv","sandboxIsOpen","openClass","onItemExecute","dismissOnBlur","typeahead","typeaheadBehaviours","schema$j","parts$6","populateFromBrowse","Typeahead","wrap$2","bindFuture","resA","bindResult","mapResult","foldResult","whenError","whenValue","withTimeout","errorThunk","timedOut","nu$c","worker","value$2","error$1","fromResult$1","fromFuture","future","fromPromise","completer","FutureResult","separator$2","toMenuItem","staticMenuItem","toMenuItems","targets","filterLinkTargets","filteredTargets","headerTargets","linkInfo","anchorTargets","anchorTargetTop","anchorTop","anchorTargetBottom","anchorBottom","historyTargets","history","joinMenuLists","bothEmpty","filterByQuery","term","lowerCaseTerm","getItems","fileType","urlBackstage","urlInputValue","getLinkInformation","getHistory","errorId","renderUrlInput","updateHistory","urlEntry","addToHistory","filetype","memUrlBox","_newValue","getValidationHandler","memInvalidIcon","invalidComp","_menu","_entry","makeIcon","errId","memStatus","optUrlPicker","getUrlPicker","browseUrlEvent","memUrlPickerButton","controlHWrapper","openUrlPicker","componentData","urlData","fieldname","chosenData","renderAlertBanner","iconTooltip","renderCheckbox","repBehaviour","toggleCheckboxHandler","className","memIcons","renderHtmlPanel","make$6","makeIframe","iframeSpec","factories","bar","collection","alertbanner","textarea","iframe","checkbox","dropzone","listbox","selectbox","sizeinput","urlinput","customeditor","htmlpanel","imagetools","table","noFormParts","interpretInForm","oldBackstage","newBackstage","interpretParts","interpretWithoutForm","bubbleAlignments","valignCentre","alignCentre","alignLeft","alignRight","getInlineDialogAnchor","contentAreaElement","lazyAnchorbar","lazyUseEditableAreaAnchor","editableAreaAnchor","standardAnchor","getBannerAnchor","getCursorAnchor","bodyElement","getNodeAnchor","getAnchors","isToolbarTop","useFixedToolbarContainer","getContentAreaContainer","inlineDialog","hasCustomColors$1","getColors$2","getColorCols$2","ColorInputBackstage","isDraggableModal$1","DialogBackstage","HeaderBackstage","getDockingMode","setDockingMode","defaultStyleFormats","isNestedFormat","isBlockFormat","isInlineFormat","isSelectorFormat","mapFormats","userFormats","fmt","customFormats","formats","formatName","formatNameWithPrefix","registerCustomFormats","registerFormats","getStyleFormats","registeredUserFormats","processBasic","isSelectedFor","getPreviewFor","formatterSpec","getStylePreview","register$3","enrichSupported","enrichMenu","submenuSpec","enrichCustom","customSpec","newItem","doEnrich","newItems_1","getStyleItems","init$7","parseStyle","getCssText","settingsFormats","settingsFlattenedFormats","eventsFormats","eventsFlattenedFormats","replaceSettings","_e","enriched","modifications","fromSettings","fromEvents","getFlattenedKeys","isElement$2","trim$1","hasContentEditableState","contentEditable","isContentEditableTrue","isContentEditableFalse","create$8","isChildOfContentEditableTrue","getElementText","innerText","getOrGenerateId","isAnchor","isValidAnchor","isEditable","isHeader","isValidHeader","getLevel","headerTarget","headerId","anchorTarget","anchorId","anchorText","getHeaderTargets","elms","getAnchorTargets","getTargetElements","hasTitle","find$5","LinkTargets","STORAGE_KEY","HISTORY_LENGTH","isHttpUrl","isArrayOfUrl","isRecordOfUrlArray","getAllHistory","unparsedHistory","SyntaxError","setAllHistory","itemsWithoutUrl","isTruthy","makeMap","getPicker","getPickerTypes","optFileTypes","optLegacyTypes","optTypes","_picker","types","getPickerSetting","pickerTypes","entry","getTextSetting","UrlInputBackstage","init$8","contextMenuState","styleselect","isContextMenuOpen","setContextMenuState","expandable$1","showContextToolbarEvent","hideContextToolbarEvent","schema$k","enhanceGroups","parts$7","factory$9","setGroups","groups","getGroupContainer","shell","toolbarBehaviours","Toolbar","generate$6","output$1","within","withinWidth","apportion","total","parray","toUnit","fitLast","fits","overflow","overflower","fitAll","tryFit","divide","partition$3","storedGroups","bGroups","findFocusedComp","focusedElm","setOverflow","overflowGroup","builtGroups","focusedComp","availableWidth","overflows","schema$l","schema$m","parts$8","schema$n","parts$9","toggledClass","toggle$2","toolbarSandbox","position$2","bounder","setGroups$1","makeSandbox$1","factory$a","FloatingToolbarButton","schema$o","parts$a","factory$b","tgroupBehaviours","itemSelector","ToolbarGroup","buildGroups","refresh$1","memFloatingToolbarButton","overflowGroups","floatingToolbarButton","factory$c","getOverflowBounds","overflowToggledClass","splitToolbarBehaviours","getOverflow","SplitFloatingToolbar","getAnimationRoot","slideConfig","getDimensionProperty","dimension","getDimension","disableTransitions","shrinkingClass","growingClass","setShrunk","closedClass","setGrown","doImmediateShrink","slideState","_calculatedSize","setCollapsed","onStartShrink","onShrunk","doStartShrink","calculatedSize","doStartSmartShrink","shrinker","doStartGrow","wasShrinking","beforeSize","fullSize","startPartialGrow","startCompleteGrow","setStartSize","setExpanded","onStartGrow","refresh$2","isExpanded","grow","shrink","immediateShrink","hasGrown","hasShrunk","isCollapsed","isGrowing","_slideState","isShrinking","isTransitioning","toggleGrow","SlidingApis","exhibit$6","events$d","propertyName","onGrown","ActiveSliding","SlidingSchema","init$9","SlidingState","Sliding","schema$p","parts$b","onClosed","onOpened","isOpen$1","toggleToolbar","overf","refresh$3","factory$d","toolbarToggleEvent","doSetGroups","_button","SplitSlidingToolbar","toolbarHeightChange","renderToolbarGroupCommon","toolbarGroup","renderToolbarGroup","getToolbarbehaviours","toolbarSpec","modeName","onAttached","initGroups","renderMoreToolbarCommon","cyclicKeying","renderFloatingMoreToolbar","baseSpec","overflowXOffset","headerElem","moreDrawerData","lazyHeader","headerBounds","docElem","docBounds","renderSlidingMoreToolbar","renderToolbar","scrolling","groupToolbarButtonSchema","createGroupToolbarButton","baseMenuButtonFields","MenuButtonSchema","createMenuButton","splitButtonSchema","createSplitButton","events$e","reflectingConfig","reflectingState","renderComponents","newComponents","channel","rawData","ActiveReflecting","getState$2","reflectState","ReflectingApis","ReflectingSchema","init$a","optS","ReflectingState","Reflecting","schema$q","arrowPart","arrow","buttonPart","btn","splitDropdown","parts$c","factory$e","openMenu","executeOnButton","buttonEvents","ariaDescriptor","splitDropdownBehaviours","SplitDropdown","getButtonApi","getToggleApi","getTooltipAttributes","focusButtonEvent","rtlIcon$1","rtlTransform$1","renderCommonStructure","_d","needsRtlClass","renderFloatingToolbarButton","identifyButtons","renderCommonToolbarButton","specialisation","toolbarButtonBehaviours","renderToolbarButton","renderToolbarButtonWith","bonusEvents","renderToolbarToggleButton","renderToolbarToggleButtonWith","fetchChoices","renderSplitButton","displayChannel","underlinePath","setIconStroke","buttonComp","_b","_c","getFormApi","runOnExecute$1","formApi","renderContextButton","bridged","renderContextToggleButton","generateOne$1","generate$7","mementos","asSpecs","findPrimary","compInSystem","buildInitGroups","commands","renderContextForm","toolbarType","ContextForm","getHorizontalBounds","contentAreaBox","viewportBounds","contentBoxWidth","maxViewportWidth","getVerticalBounds","isToolbarLocationTop","headerBox","isToolbarBelowContentArea","isToolbarAbove","containerBounds","getContextToolbarBounds","toolbarOrMenubarEnabled","matchTargetWith","ctxs","toolbarApi","contextToolbars","contextForms","filterByPositionForStartNode","doesPositionExist","filterToolbarsByPosition","hasSelectionToolbars","hasNodeToolbars","nodeToolbars","selectionToolbars","filterByPositionForAncestorNode","findPosition_1","basePosition","matchStartNode","nodeCandidates","editorCandidates","nodeMatches","editorMatches","matchAncestor","startNode","scopes","ancestorElem","inNodeScope","lookup$1","rootElem","isOutsideRoot","inEditorScope","categorise","forms","formNavigators","lookupTable","registerForm","contextForm","launch","registerToolbar","contextToolbar","forwardSlideEvent","backSlideEvent","changeSlideEvent","resizingClass","renderContextToolbar","currentWidth","newContents","oldContents","forwardContents","generateSelectItems","_editor","generateItem","rawItem","response","si","invalid","validateItems","preItems","getCurrentValue","shouldHide","createMenuItems","createSelectButton","getComponent","rawFormats","buildBasicStaticDataset","Delimiter","delimiter","SemiColon","buildBasicSettingsDataset","settingName","alignMenuItems","command","getSpec","getMatchingValue","_format","updateSelectMenuIcon","alignment","canApply","createAlignSelect","alignSelectMenu","defaultFontsFormats","systemStackFonts","splitFonts","fontFamily","fonts","font","isSystemFontStack","matchesSystemStack","getSpec$1","getFirstFont","queryCommandValue","matchOpt","updateSelectMenuText","createFontSelect","fontSelectMenu","defaultFontsizeFormats","legacyFontSizes","keywordFontSizes","round$1","factor","toPt","fontSize","toLegacy","getSpec$2","_loop_1","pt","legacy","Space","createFontsizeSelect","fontsizeSelectMenu","findNearest","getStyles","revocable","doRevoke","isSet","destroyable","unbindable","value$3","onSetupFormatToggle","boundCallback","formatChanged","initialized","onActionToggleFormat","defaultBlocks","getSpec$3","detectedFormat","createFormatSelect","formatSelectMenu","getSpec$4","getFormatItems","flattenedItems","createStyleSelect","styleSelectMenu","defaultToolbar","renderFromBridge","bridgeBuilder","togglebutton","menubutton","splitbutton","grouptoolbarbutton","identify","allowToolbarGroups","TopToBottom","floating","styleSelectButton","fontsizeSelectButton","fontSelectButton","formatButton","alignMenuButton","extractFrom","bespokeButtons","fontsizeselect","fontselect","formatselect","removeUnusedDefaults","filteredItemGroups","subItem","convertStringToolbar","strToolbar","groupsStrings","isToolbarGroupSettingArray","createToolbar","toolbarConfig","lookupButton","toolbarItem","prefixes","toolbarGroups","bubbleSize","bubbleAlignments$1","anchorOverrides","desktopAnchorSpecLayouts","mobileAnchorSpecLayouts","getAnchorLayout","register$4","registryContextToolbars","contextbar","isRangeOverlapping","aTop","aBottom","bTop","bBottom","getLastElementVerticalBound","nodeBounds","ele","diffTop","shouldContextToolbarHide","lastElementBounds","contextToolbarBounds","lastAnchor","forceHide","hideOrRepositionIfNecessary","contextBarEle","wrapInPopDialog","shortcuts","getScopes","alloySpec","buildToolbar","buildContextToolbarGroups","allButtons","buildContextMenuGroups","default","toolbarKey","launchContext","sElem","launchContextToolbar","asyncOpen","setEditorTimeout","setup$3","ship","fireDismissPopups","onTouchstart","onTouchmove","onTouchend","onMousedown","onMouseup","onContentClick","onContentMouseup","onWindowScroll","onWindowResize","onEditorResize","onEditorProgress","parts$d","partType$1","schema$r","customListDetail","itemsPart","parts$e","name$2","factory$f","_external","setItems","getListContainer","itemComps","numListsRequired","numListsToAdd","itemsToAdd","makeItem","itemsToRemove","builtLists","setupItem","listBehaviours","CustomList","setup$4","isDocked","getBehaviours$2","StaticHeader","getOffsetParent","isFixed","offsetParent$1","getOrigin","morphAdt","static","appear","contextualInfo","transitionClass","fadeOutClass","fadeInClass","disappear","isPartiallyVisible","isTopCompletelyVisible","isBottomCompletelyVisible","isVisibleForModes","getPrior","getInitialPosition","storePrior","setInitialPosition","revertToOriginal","offsetBox_1","_left","_top","_right","_bottom","morphToOriginal","getModes","morphToFixed","winBox","top_1","isTop","getMorph","getMorphToOriginal","morphToStatic","onUndocked","morphToCoord","method","onDocked","updateVisibility","morphToDocked","contextual","contextInfo","lazyContext","setVisible","refreshInternal","lazyViewport","morph","setDocked","resetInternal","refresh$4","reset","isDocked$1","setModes","DockingApis","events$f","dockInfo","dockState","onShown","onHidden","ActiveDocking","DockingSchema","init$b","docked","initialBounds","DockingState","Docking","visibility","editorStickyOnClass","editorStickyOffClass","scrollFromBehindHeader","containerHeader","viewHeight","innerHeight","scrollPos","markerElement","markerPos","markerHeight","markerTop","markerBottom","editorHeaderPos","editorHeaderHeight","editorHeaderTop","editorHeaderBottom","editorHeaderDockedAtTop","editorHeaderDockedAtBottom","isDockedMode","updateIframeContentFlow","getOccupiedHeight","parentElem","padding","parentWidth","updateSinkVisibility","sinkElem","updateEditorClasses","editorContainer","restoreFocus","focusedElem","ownerDoc","activeElm","findFocusedElem","rootElm","setup$5","isDocked$2","getIframeBehaviours","getBehaviours$3","runOnSinkElement","onDockingSwitch","additionalBehaviours","headerHeight","boxHeight","topBound","StickyHeader","sticky","factory$g","setMenus","activeButton","hoveredButton","activeComp","hoveredComp","prev","SilverMenubar","owner$4","schema$s","getPartName$1","sketch$2","sSpec","slot","make$7","getSlotNames","getSlot","onSlot","def","onSlots","doShowing","_key","doShow","doHide","hideSlot","hideSlots","hideAllSlots","showSlot","slotBehaviours","slotApis","SlotContainer","sidebarSchema","createSidebar","setup$6","sidebars","addToggleButton","handleToggle","makePanels","panelConfigs","sidepanel","optSidePanelSpec","sidePanelSpec","makeSidebar","slotContainer","setSidebar","sidebar","optSlider","toggleSidebar","optSlotContainer","whichSidebar","sidebarOpen","fixSize","autoSize","renderSidebar","getAttrs","fromHtml$2","renderSpinner","toggleThrobber","renderThrobber","setup$7","lazyThrobber","throbberState","timerId","factory$h","getSocket","getHeader","setToolbar","setToolbars","mToolbar","refreshToolbar","toggleToolbarDrawer","isToolbarDrawerToggled","getThrobber","focusToolbar","optToolbar","setMenubar","menubar","focusMenubar","partMenubar","toolbarFactory","sliding","partMultipleToolbar","_mToolbar","tc","_index","partToolbar","renderer","lazyToolbar","lazyMoreButton","partHeader","partSocket","partSidebar","partThrobber","OuterContainer","grps","grp","renderedToolbars","defaultMenubar","defaultMenus","edit","tools","help","make$8","removedMenuItems","itemName","removedMenuItem","parseItemsString","identifyMenus","rawMenuData","userDefinedMenus","validMenus","menuData","isNotSeparator","fireSkinLoaded$1","_skinLoaded","fireSkinLoadError$1","loadStylesheet","stylesheetUrl","styleSheetLoader","unload","loadUiSkins","skinUiCss","loadShadowDomUiSkins","isInShadowRoot$1","shadowDomSkinCss","loadSkin","isInline","contentCSS","rawUiConfig","toolbarButtonsConfig","detection","isiOS12","setupEvents","initialDocEle","lastWindowDimensions","innerWidth","lastDocumentDimensions","resizeWindow","outer","resizeDocument","docEle","inner","elementLoad","render$1","lastToolbarWidth","eTargetNode","targetNode","uiRoot","socket","limit","unbinder","_ui","addQueryValueHandler","toolbarMode","refreshDrawer","iframeContainer","Iframe","parseToInt","re","numToPx","calcCappedSize","minSize","maxSize","minOverride","maxOverride","getHeight$1","baseHeight","minHeight","getHeightWithFallback","getWidth$1","baseWidth","minWidth","getWidthWithFallback","InlineHeader","targetElm","floatContainer","isSticky","editorMaxWidthOpt","headerBackstage","isSplitToolbar","calcToolbarOffset","tbar","calcMode","toolbar_1","toolbarHeight","targetBounds","roomAtTop","docHeight","roomAtBottom","winBounds","isRoomAtBottomViewport","setupMode","verticalDir","updateChromeWidth","bodyMargin","updateChromePosition","repositionPopups$1","updateChromeUi","resetDocking","floatContainerComp","updateMode","updateUi","currentMode","newMode","addClass","removeClass","getTargetPosAndBounds","setupEvents$1","toolbarPersist","prevPosAndBounds","resizeContent","prevPos","prevBounds","hasResized","requestAnimationFrame","render$2","uiContainer","delayedRender","Inline","register$5","alignToolbarButtons","cmd","alignNoneToolbarButton","addButton","register$6","toggleOutdentState","queryCommandState","onNodeChange","registerButtons","register$7","unsupportedLength","decimalDigits","signedInteger","exponentPart","dot","unsignedDecimalLiteral","float","isUnit","accepted","check","unitRaw","normalise","normaliseLineHeight","getLineHeights","Map","lastApi","registerMenuItems","registerButtons$1","addMenuButton","register$8","toggleFormat","registerFormatButtons","_idx","name_1","registerCommandButtons","registerCommandToggleButtons","registerButtons$2","registerMenuItems$1","addMenuItem","register$9","toggleUndoRedoState","checkState","onUndoStateChange","registerMenuItems$2","registerButtons$3","register$a","toggleVisualAidState","hasVisual","onVisualAid","registerMenuItems$3","addToggleMenuItem","registerToolbarButton","register$b","setup$8","nu$d","transpose$1","dx","dy","isTouchEvent$1","fromPageXY","pageX","pageY","fromClientXY","transposeContentAreaContainer","containerPos","getPos","getPointAnchor","getSelectionAnchor","getNodeAnchor$1","initAndShow","buildMenu","contextmenu","useNodeAnchor","anchorSpec","bubbleSize$1","bubbleAlignments$2","isTouchWithinSelection","touch_1","rngRectOpt","rngRect","getPointAnchorSpec","setupiOSOverrides","originalSelection","selectionReset","setRng","unbindEventListeners","preventMousedown","clearSelectionReset","initAndShow$1","shouldHighlightImmediately","openiOS_1","patchPipeConfig","shouldNeverUseNative","getMenuItems","defaultItems","contextMenus","isContextMenuDisabled","getContextMenu","getAvoidOverlapSelector","isSeparator$1","separator$3","makeContextItem","commonMenuItem","addContextMenuGroup","groupItems","lastMenuItem","generateContextMenu","selectedElement","sections","allItems","isNativeOverrideKeyEvent","isTriggeredByKeyboard","pointerType","getSelectedElement","shouldUseNodeAnchor","setup$9","hideContextMenu","showContextMenu","initAndShow$2","hideEvents","adt$c","subtract","add$4","transform$1","changes","asFixed","coord","asAbsolute","asOffset","withinRange","coord1","coord2","getDeltas","toStyles","stylesOpt","translate$2","absolute$3","fixed$1","absorb","partialCoord","originalCoord","absorbOne","stencil","optX","optY","parseAttrToInt","NaN","get$f","snapsInfo","leftAttr","topAttr","set$8","getCoords","snapInfo","moveOrSnap","newCoord","mustSnap","findClosestSnap","findSnap","fixedCoord","spanned","stopDrag","findMatchingSnap","snaps","sensor","inRange","getSnapPoints","matchSnap","bestSnap","deltas","bestDeltas","currAvg","bestAvg","snapTo","snapTo$1","dragConfig","getTarget","repositionTarget","scroll_1","origin_1","snapPin","DraggingApis","initialAttribute","resetZIndex","changeZIndex","zindex","instigate","anyComponent","discard","createComponent","blockerClass","blockerEvents","SnapSchema","schema$t","getCurrentCoord","location","clampCoords","coords","absoluteCoord","newCoords","offset$1","calcNewCoord","optSnaps","currentCoord","snapping","onSensor","dragBy","onDrag","calcStartData","move$1","dragState","dragMode","dragStartData","getStartData","dlt","updateStartState","setStartData","init$c","dragApi","forceDrop","drop","delayDrop","getData$1","getDelta$1","MouseData","events$g","stop$1","schema$u","init$d","getDataFrom","getData$2","getDelta$2","TouchData","events$h","blockerCell","schema$v","events$i","schema$w","mouse","mouseOrTouch","DraggingBranches","init$e","previous","calculateDelta","dragEvent","nuData","DragState","Dragging","dragger","snapWidth","snapOffset","calcSnap","selectorOpt","td","selectorHandle","sensorLeft","sensorTop","sensorWidth","sensorHeight","getSnapsConfig","isSameCell","cellOpt","currentTd","createSelector","setup$a","tlTds","brTds","startCell","finishCell","getTopLeftSnap","memTopLeft","getTopLeftSnaps","getBottomRightSnap","memBottomRight","getBottomRightSnaps","topLeftSnaps","bottomRightSnaps","bottomRight","showOrHideHandle","isAbove","isBelow","cellRect","viewportHeight","aboveViewport","belowViewport","getSnapConfig","snapTopLeft","snapLastTopLeft","snapBottomRight","snapLastBottomRight","otherCells","upOrLeftCells","downOrRightCells","isHidden$1","renderElementPath","getDataPath","newPathElements","_btn","divider","newAcc","updatePath","parents","newPath","parent_1","isDefaultPrevented","isPropagationStopped","ResizeTypes","getDimensions","resizeType","originalHeight","originalWidth","Both","resize$3","dim","getResizeType","None","Vertical","keyboardHandler","renderResizeHandler","_target","renderWordCount","replaceCountText","words","characters","currentVal","wordCount","renderStatusbar","renderBranding","linkHtml","getTextComponents","getComponents","resizeHandler","setup$b","lazyOuterContainer","platformClasses","touchPlatformClass","deviceClasses","isToolbarBottom","dirAttributes","verticalDirAttributes","isHeaderDocked","resizeUiMothership","makeSinkDefinition","isGridUiContainer","sinkSpec","reactiveWidthSpec","memAnchorBar","lazyAnchorBar","throbber","sb","statusbar","socketSidebarContainer","hasMultipleToolbar","hasToolbar","hasMenubar","getPartToolbar","editorComponents","containerComponents","border","addQueryStateHandler","getUi","broadcastAll","setEditorSize","parsedHeight","parsedWidth","renderUI","toolbarGroupButtonConfig","addGroupToolbarButton","toolbarOpt","describedBy","describedElement","describeElement","describeId","labelledBy","labelledElement","labelElement","schema$x","basic","parts$f","dragBlockClass","getDragBounds","getBusySpec","blockerBehaviours","blockSpec","isBlocked","onBlock","blockWith","onUnblock","BlockingApis","BlockingSchema","init$f","BlockingState","Blocking","factory$i","dialogComp","showDialog","externalBlocker","hideDialog","blockerDom","getDialogBody","getDialogFooter","setBusy","setIdle","modalEventsId","getFooter","modalBehaviours","ModalDialog","dialogToggleMenuItemSchema","dialogToggleMenuItemDataProcessor","baseFooterButtonFields","dialogFooterButtonFields","normalFooterButtonFields","menuFooterButtonFields","dialogFooterButtonSchema","submit","alertBannerFields","alertBannerSchema","createBarFields","itemsField","buttonFields","buttonSchema","checkboxFields","checkboxSchema","checkboxDataProcessor","formComponentFields","formComponentWithLabelFields","collectionFields","collectionSchema","collectionDataProcessor","colorInputFields","colorInputSchema","colorInputDataProcessor","colorPickerFields","colorPickerSchema","colorPickerDataProcessor","customEditorFields","customEditorFieldsOld","customEditorSchema","customEditorDataProcessor","dropZoneFields","dropZoneSchema","dropZoneDataProcessor","createGridFields","htmlPanelFields","htmlPanelSchema","iframeFields","iframeSchema","iframeDataProcessor","imageToolsFields","imageToolsSchema","inputFields","inputSchema","inputDataProcessor","createLabelFields","listBoxSingleItemFields","listBoxNestedItemFields","listBoxItemSchema","listBoxFields","listBoxSchema","listBoxDataProcessor","selectBoxFields","selectBoxSchema","selectBoxDataProcessor","sizeInputFields","sizeInputSchema","sizeInputDataProcessor","tableFields","tableSchema","textAreaFields","textAreaSchema","textAreaDataProcessor","urlInputFields","urlInputSchema","urlInputDataProcessor","createItemsField","itemSchema$3","sErr","passValue","panelSchema","panelFields","tabFields","tabPanelFields","tabPanelSchema","dialogButtonFields","dialogButtonSchema","dialogSchema","tabpanel","createDialog","urlDialogButtonSchema","urlDialogSchema","createUrlDialog","getAllObjects","isNamedItem","dataProcessors","togglemenuitem","getDataProcessor","getNamedItems","createDataValidator","namedItems","extract$1","internalDialog","dataValidator","DialogManager","openUrl","redial","toValidValues","renderBodyPanel","memForm","formValue","vals","factory$j","tabButtonBehaviours","TabButton","schema$y","tabsPart","barDetail","dismissTab$1","tabbar","changeTab$1","clickToDismiss","tabClass","parts$g","factory$k","tabbarBehaviours","selectedClass","tab","Tabbar","factory$l","tabviewBehaviours","Tabview","schema$z","barPart","tabs","viewPart","parts$h","factory$m","tabValue","tabview","tabWithValue","tabData","onChangeTab","changeTabBy","section","byPred","tabSectionBehaviours","selectFirst","onDismissTab","getViewItems","showTab","tabKey","getTabIfNotActive","optTab","TabSection","measureHeights","allTabs","tabviewComp","_tab","getMaxHeight","heights","getMaxTabviewHeight","tablist","documentElement$1","tabviewHeight","isTabListBeside","currentTabHeight","dialogTopMargin","dialogBottomMargin","dialogHeight","chromeHeight","setTabviewHeight","updateTabviewHeight","dialogBody","maxTabHeight","getTabview","smartTabHeight","extraEvents","maxTabHeightOpt","oldHeight","naiveTabHeight","SendDataToSectionChannel","SendDataToViewChannel","renderTabPanel","storedValue","updateDataWithForm","formData","validData","currentData","setDataOnForm","oldTab","tabMode","_viewItems","oldName","tsection","dialogChannel","titleChannel","bodyChannel","footerChannel","bodySendMessageChannel","renderBody","ariaAttrs","incoming","isTabPanel","ariaAttributes","renderInlineBody","contentId","renderModalBody","bodySpec","renderIframeBody","hiddenHeader","pClose","pUntitled","pBodyMessage","pFooter","footer","pFooterGroup","startButtons","endButtons","renderDialog","dialogClass","blockerBackdropClass","scrollLockClass","extraStyles","dialogEvents","renderClose","renderTitle","renderDragHandle","renderInlineHeader","titleId","renderModalHeader","pTitle","pHandle","draghandle","draggable","bs","getEventExtras","lazyDialog","closeWindow","blockEvent","renderModalDialog","mapMenuButtons","mapItems","extractCellsToObject","menuButton","innerAcc","initCommonEvents","fireApiEvent","_event","initUrlDialog","getInstanceApi","withSpec","currentDialog","initDialog","currentDialogInit","cur","onTabChange","newTabName","oldTabName","SilverDialogEvents","makeButton","lookup$2","footerButtons","buttonName","buttonGroups","makeGroup","renderFooter","initSpec","lookupByName","renderInlineFooter","renderModalFooter","getCompByName","form_1","getFormWrapper","footerState","validateData","dialogState","getDialogApi","doRedial","menuItemStates","withRoot","valueComp","representedValues","menuItemCurrentState","setData","prevData","instanceApi","mergedData","newInternalData","bodyState","tabSection","dialogInit","getDialogSizeClasses","renderDialog$1","storagedMenuButtons","objOfCells","dialogSize","modalAccess","getForm","outerForm","renderInlineDialog","dialogLabelId","dialogContentId","memHeader","memBody","memFooter","global$h","getUrlDialogApi","sendMessage","SUPPORTED_MESSAGE_ACTIONS","isSupportedMessage","mceAction","isCustomMessage","handleMessage","insertContent","renderUrlDialog","iframeUri","base_uri","href","iframeDomain","protocol","port","messageHandlerUnbinder","isSameOrigin","onMessage","iframeEle","iframeWin","postMessage","setup$c","closeDialog","alertDialog","memFooterClose","titleSpec","closeSpec","footerCloseButton","setup$d","confirmDialog","memFooterYes","footerNo","footerYesButton","validateData$1","isAlertOrConfirmDialog","inlineAdditionalBehaviours","setup$e","isStickyToolbar$1","openInlineDialog","openModalDialog","openModalUrlDialog","internalInitialData","config$1","refreshDocking","dialogUi","inlineDialogComp","confirm","Theme","windowMgr","getWindowManagerImpl","getNotificationManagerImpl"],"mappings":"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","sourcesContent":["/**\n * Copyright (c) Tiny Technologies, Inc. All rights reserved.\n * Licensed under the LGPL or a commercial license.\n * For LGPL see License.txt in the project root for license information.\n * For commercial licenses see https://www.tiny.cloud/\n *\n * Version: 5.8.2 (2021-06-23)\n */\n(function () {\n    'use strict';\n\n    var typeOf = function (x) {\n      var t = typeof x;\n      if (x === null) {\n        return 'null';\n      } else if (t === 'object' && (Array.prototype.isPrototypeOf(x) || x.constructor && x.constructor.name === 'Array')) {\n        return 'array';\n      } else if (t === 'object' && (String.prototype.isPrototypeOf(x) || x.constructor && x.constructor.name === 'String')) {\n        return 'string';\n      } else {\n        return t;\n      }\n    };\n    var isType = function (type) {\n      return function (value) {\n        return typeOf(value) === type;\n      };\n    };\n    var isSimpleType = function (type) {\n      return function (value) {\n        return typeof value === type;\n      };\n    };\n    var eq = function (t) {\n      return function (a) {\n        return t === a;\n      };\n    };\n    var isString = isType('string');\n    var isObject = isType('object');\n    var isArray = isType('array');\n    var isBoolean = isSimpleType('boolean');\n    var isUndefined = eq(undefined);\n    var isNullable = function (a) {\n      return a === null || a === undefined;\n    };\n    var isNonNullable = function (a) {\n      return !isNullable(a);\n    };\n    var isFunction = isSimpleType('function');\n    var isNumber = isSimpleType('number');\n    var isArrayOf = function (value, pred) {\n      if (isArray(value)) {\n        for (var i = 0, len = value.length; i < len; ++i) {\n          if (!pred(value[i])) {\n            return false;\n          }\n        }\n        return true;\n      }\n      return false;\n    };\n\n    var noop = function () {\n    };\n    var noarg = function (f) {\n      return function () {\n        return f();\n      };\n    };\n    var compose = function (fa, fb) {\n      return function () {\n        var args = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n          args[_i] = arguments[_i];\n        }\n        return fa(fb.apply(null, args));\n      };\n    };\n    var compose1 = function (fbc, fab) {\n      return function (a) {\n        return fbc(fab(a));\n      };\n    };\n    var constant = function (value) {\n      return function () {\n        return value;\n      };\n    };\n    var identity = function (x) {\n      return x;\n    };\n    function curry(fn) {\n      var initialArgs = [];\n      for (var _i = 1; _i < arguments.length; _i++) {\n        initialArgs[_i - 1] = arguments[_i];\n      }\n      return function () {\n        var restArgs = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n          restArgs[_i] = arguments[_i];\n        }\n        var all = initialArgs.concat(restArgs);\n        return fn.apply(null, all);\n      };\n    }\n    var not = function (f) {\n      return function (t) {\n        return !f(t);\n      };\n    };\n    var die = function (msg) {\n      return function () {\n        throw new Error(msg);\n      };\n    };\n    var never = constant(false);\n    var always = constant(true);\n\n    var global$1 = tinymce.util.Tools.resolve('tinymce.ThemeManager');\n\n    var __assign = function () {\n      __assign = Object.assign || function __assign(t) {\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\n          s = arguments[i];\n          for (var p in s)\n            if (Object.prototype.hasOwnProperty.call(s, p))\n              t[p] = s[p];\n        }\n        return t;\n      };\n      return __assign.apply(this, arguments);\n    };\n    function __rest(s, e) {\n      var t = {};\n      for (var p in s)\n        if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0)\n          t[p] = s[p];\n      if (s != null && typeof Object.getOwnPropertySymbols === 'function')\n        for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) {\n          if (e.indexOf(p[i]) < 0 && Object.prototype.propertyIsEnumerable.call(s, p[i]))\n            t[p[i]] = s[p[i]];\n        }\n      return t;\n    }\n    function __spreadArrays() {\n      for (var s = 0, i = 0, il = arguments.length; i < il; i++)\n        s += arguments[i].length;\n      for (var r = Array(s), k = 0, i = 0; i < il; i++)\n        for (var a = arguments[i], j = 0, jl = a.length; j < jl; j++, k++)\n          r[k] = a[j];\n      return r;\n    }\n\n    var none = function () {\n      return NONE;\n    };\n    var NONE = function () {\n      var eq = function (o) {\n        return o.isNone();\n      };\n      var call = function (thunk) {\n        return thunk();\n      };\n      var id = function (n) {\n        return n;\n      };\n      var me = {\n        fold: function (n, _s) {\n          return n();\n        },\n        is: never,\n        isSome: never,\n        isNone: always,\n        getOr: id,\n        getOrThunk: call,\n        getOrDie: function (msg) {\n          throw new Error(msg || 'error: getOrDie called on none.');\n        },\n        getOrNull: constant(null),\n        getOrUndefined: constant(undefined),\n        or: id,\n        orThunk: call,\n        map: none,\n        each: noop,\n        bind: none,\n        exists: never,\n        forall: always,\n        filter: none,\n        equals: eq,\n        equals_: eq,\n        toArray: function () {\n          return [];\n        },\n        toString: constant('none()')\n      };\n      return me;\n    }();\n    var some = function (a) {\n      var constant_a = constant(a);\n      var self = function () {\n        return me;\n      };\n      var bind = function (f) {\n        return f(a);\n      };\n      var me = {\n        fold: function (n, s) {\n          return s(a);\n        },\n        is: function (v) {\n          return a === v;\n        },\n        isSome: always,\n        isNone: never,\n        getOr: constant_a,\n        getOrThunk: constant_a,\n        getOrDie: constant_a,\n        getOrNull: constant_a,\n        getOrUndefined: constant_a,\n        or: self,\n        orThunk: self,\n        map: function (f) {\n          return some(f(a));\n        },\n        each: function (f) {\n          f(a);\n        },\n        bind: bind,\n        exists: bind,\n        forall: bind,\n        filter: function (f) {\n          return f(a) ? me : NONE;\n        },\n        toArray: function () {\n          return [a];\n        },\n        toString: function () {\n          return 'some(' + a + ')';\n        },\n        equals: function (o) {\n          return o.is(a);\n        },\n        equals_: function (o, elementEq) {\n          return o.fold(never, function (b) {\n            return elementEq(a, b);\n          });\n        }\n      };\n      return me;\n    };\n    var from = function (value) {\n      return value === null || value === undefined ? NONE : some(value);\n    };\n    var Optional = {\n      some: some,\n      none: none,\n      from: from\n    };\n\n    var nativeSlice = Array.prototype.slice;\n    var nativeIndexOf = Array.prototype.indexOf;\n    var nativePush = Array.prototype.push;\n    var rawIndexOf = function (ts, t) {\n      return nativeIndexOf.call(ts, t);\n    };\n    var indexOf = function (xs, x) {\n      var r = rawIndexOf(xs, x);\n      return r === -1 ? Optional.none() : Optional.some(r);\n    };\n    var contains = function (xs, x) {\n      return rawIndexOf(xs, x) > -1;\n    };\n    var exists = function (xs, pred) {\n      for (var i = 0, len = xs.length; i < len; i++) {\n        var x = xs[i];\n        if (pred(x, i)) {\n          return true;\n        }\n      }\n      return false;\n    };\n    var range = function (num, f) {\n      var r = [];\n      for (var i = 0; i < num; i++) {\n        r.push(f(i));\n      }\n      return r;\n    };\n    var chunk = function (array, size) {\n      var r = [];\n      for (var i = 0; i < array.length; i += size) {\n        var s = nativeSlice.call(array, i, i + size);\n        r.push(s);\n      }\n      return r;\n    };\n    var map = function (xs, f) {\n      var len = xs.length;\n      var r = new Array(len);\n      for (var i = 0; i < len; i++) {\n        var x = xs[i];\n        r[i] = f(x, i);\n      }\n      return r;\n    };\n    var each = function (xs, f) {\n      for (var i = 0, len = xs.length; i < len; i++) {\n        var x = xs[i];\n        f(x, i);\n      }\n    };\n    var eachr = function (xs, f) {\n      for (var i = xs.length - 1; i >= 0; i--) {\n        var x = xs[i];\n        f(x, i);\n      }\n    };\n    var partition = function (xs, pred) {\n      var pass = [];\n      var fail = [];\n      for (var i = 0, len = xs.length; i < len; i++) {\n        var x = xs[i];\n        var arr = pred(x, i) ? pass : fail;\n        arr.push(x);\n      }\n      return {\n        pass: pass,\n        fail: fail\n      };\n    };\n    var filter = function (xs, pred) {\n      var r = [];\n      for (var i = 0, len = xs.length; i < len; i++) {\n        var x = xs[i];\n        if (pred(x, i)) {\n          r.push(x);\n        }\n      }\n      return r;\n    };\n    var foldr = function (xs, f, acc) {\n      eachr(xs, function (x) {\n        acc = f(acc, x);\n      });\n      return acc;\n    };\n    var foldl = function (xs, f, acc) {\n      each(xs, function (x) {\n        acc = f(acc, x);\n      });\n      return acc;\n    };\n    var findUntil = function (xs, pred, until) {\n      for (var i = 0, len = xs.length; i < len; i++) {\n        var x = xs[i];\n        if (pred(x, i)) {\n          return Optional.some(x);\n        } else if (until(x, i)) {\n          break;\n        }\n      }\n      return Optional.none();\n    };\n    var find = function (xs, pred) {\n      return findUntil(xs, pred, never);\n    };\n    var findIndex = function (xs, pred) {\n      for (var i = 0, len = xs.length; i < len; i++) {\n        var x = xs[i];\n        if (pred(x, i)) {\n          return Optional.some(i);\n        }\n      }\n      return Optional.none();\n    };\n    var flatten = function (xs) {\n      var r = [];\n      for (var i = 0, len = xs.length; i < len; ++i) {\n        if (!isArray(xs[i])) {\n          throw new Error('Arr.flatten item ' + i + ' was not an array, input: ' + xs);\n        }\n        nativePush.apply(r, xs[i]);\n      }\n      return r;\n    };\n    var bind = function (xs, f) {\n      return flatten(map(xs, f));\n    };\n    var forall = function (xs, pred) {\n      for (var i = 0, len = xs.length; i < len; ++i) {\n        var x = xs[i];\n        if (pred(x, i) !== true) {\n          return false;\n        }\n      }\n      return true;\n    };\n    var reverse = function (xs) {\n      var r = nativeSlice.call(xs, 0);\n      r.reverse();\n      return r;\n    };\n    var difference = function (a1, a2) {\n      return filter(a1, function (x) {\n        return !contains(a2, x);\n      });\n    };\n    var mapToObject = function (xs, f) {\n      var r = {};\n      for (var i = 0, len = xs.length; i < len; i++) {\n        var x = xs[i];\n        r[String(x)] = f(x, i);\n      }\n      return r;\n    };\n    var sort = function (xs, comparator) {\n      var copy = nativeSlice.call(xs, 0);\n      copy.sort(comparator);\n      return copy;\n    };\n    var get = function (xs, i) {\n      return i >= 0 && i < xs.length ? Optional.some(xs[i]) : Optional.none();\n    };\n    var head = function (xs) {\n      return get(xs, 0);\n    };\n    var last = function (xs) {\n      return get(xs, xs.length - 1);\n    };\n    var from$1 = isFunction(Array.from) ? Array.from : function (x) {\n      return nativeSlice.call(x);\n    };\n    var findMap = function (arr, f) {\n      for (var i = 0; i < arr.length; i++) {\n        var r = f(arr[i], i);\n        if (r.isSome()) {\n          return r;\n        }\n      }\n      return Optional.none();\n    };\n\n    var value = function (o) {\n      var is = function (v) {\n        return o === v;\n      };\n      var or = function (_opt) {\n        return value(o);\n      };\n      var orThunk = function (_f) {\n        return value(o);\n      };\n      var map = function (f) {\n        return value(f(o));\n      };\n      var mapError = function (_f) {\n        return value(o);\n      };\n      var each = function (f) {\n        f(o);\n      };\n      var bind = function (f) {\n        return f(o);\n      };\n      var fold = function (_, onValue) {\n        return onValue(o);\n      };\n      var exists = function (f) {\n        return f(o);\n      };\n      var forall = function (f) {\n        return f(o);\n      };\n      var toOptional = function () {\n        return Optional.some(o);\n      };\n      return {\n        is: is,\n        isValue: always,\n        isError: never,\n        getOr: constant(o),\n        getOrThunk: constant(o),\n        getOrDie: constant(o),\n        or: or,\n        orThunk: orThunk,\n        fold: fold,\n        map: map,\n        mapError: mapError,\n        each: each,\n        bind: bind,\n        exists: exists,\n        forall: forall,\n        toOptional: toOptional\n      };\n    };\n    var error = function (message) {\n      var getOrThunk = function (f) {\n        return f();\n      };\n      var getOrDie = function () {\n        return die(String(message))();\n      };\n      var or = function (opt) {\n        return opt;\n      };\n      var orThunk = function (f) {\n        return f();\n      };\n      var map = function (_f) {\n        return error(message);\n      };\n      var mapError = function (f) {\n        return error(f(message));\n      };\n      var bind = function (_f) {\n        return error(message);\n      };\n      var fold = function (onError, _) {\n        return onError(message);\n      };\n      return {\n        is: never,\n        isValue: never,\n        isError: always,\n        getOr: identity,\n        getOrThunk: getOrThunk,\n        getOrDie: getOrDie,\n        or: or,\n        orThunk: orThunk,\n        fold: fold,\n        map: map,\n        mapError: mapError,\n        each: noop,\n        bind: bind,\n        exists: never,\n        forall: always,\n        toOptional: Optional.none\n      };\n    };\n    var fromOption = function (opt, err) {\n      return opt.fold(function () {\n        return error(err);\n      }, value);\n    };\n    var Result = {\n      value: value,\n      error: error,\n      fromOption: fromOption\n    };\n\n    var SimpleResultType;\n    (function (SimpleResultType) {\n      SimpleResultType[SimpleResultType['Error'] = 0] = 'Error';\n      SimpleResultType[SimpleResultType['Value'] = 1] = 'Value';\n    }(SimpleResultType || (SimpleResultType = {})));\n    var fold = function (res, onError, onValue) {\n      return res.stype === SimpleResultType.Error ? onError(res.serror) : onValue(res.svalue);\n    };\n    var partition$1 = function (results) {\n      var values = [];\n      var errors = [];\n      each(results, function (obj) {\n        fold(obj, function (err) {\n          return errors.push(err);\n        }, function (val) {\n          return values.push(val);\n        });\n      });\n      return {\n        values: values,\n        errors: errors\n      };\n    };\n    var mapError = function (res, f) {\n      if (res.stype === SimpleResultType.Error) {\n        return {\n          stype: SimpleResultType.Error,\n          serror: f(res.serror)\n        };\n      } else {\n        return res;\n      }\n    };\n    var map$1 = function (res, f) {\n      if (res.stype === SimpleResultType.Value) {\n        return {\n          stype: SimpleResultType.Value,\n          svalue: f(res.svalue)\n        };\n      } else {\n        return res;\n      }\n    };\n    var bind$1 = function (res, f) {\n      if (res.stype === SimpleResultType.Value) {\n        return f(res.svalue);\n      } else {\n        return res;\n      }\n    };\n    var bindError = function (res, f) {\n      if (res.stype === SimpleResultType.Error) {\n        return f(res.serror);\n      } else {\n        return res;\n      }\n    };\n    var svalue = function (v) {\n      return {\n        stype: SimpleResultType.Value,\n        svalue: v\n      };\n    };\n    var serror = function (e) {\n      return {\n        stype: SimpleResultType.Error,\n        serror: e\n      };\n    };\n    var toResult = function (res) {\n      return fold(res, Result.error, Result.value);\n    };\n    var fromResult = function (res) {\n      return res.fold(serror, svalue);\n    };\n    var SimpleResult = {\n      fromResult: fromResult,\n      toResult: toResult,\n      svalue: svalue,\n      partition: partition$1,\n      serror: serror,\n      bind: bind$1,\n      bindError: bindError,\n      map: map$1,\n      mapError: mapError,\n      fold: fold\n    };\n\n    var keys = Object.keys;\n    var hasOwnProperty = Object.hasOwnProperty;\n    var each$1 = function (obj, f) {\n      var props = keys(obj);\n      for (var k = 0, len = props.length; k < len; k++) {\n        var i = props[k];\n        var x = obj[i];\n        f(x, i);\n      }\n    };\n    var map$2 = function (obj, f) {\n      return tupleMap(obj, function (x, i) {\n        return {\n          k: i,\n          v: f(x, i)\n        };\n      });\n    };\n    var tupleMap = function (obj, f) {\n      var r = {};\n      each$1(obj, function (x, i) {\n        var tuple = f(x, i);\n        r[tuple.k] = tuple.v;\n      });\n      return r;\n    };\n    var objAcc = function (r) {\n      return function (x, i) {\n        r[i] = x;\n      };\n    };\n    var internalFilter = function (obj, pred, onTrue, onFalse) {\n      var r = {};\n      each$1(obj, function (x, i) {\n        (pred(x, i) ? onTrue : onFalse)(x, i);\n      });\n      return r;\n    };\n    var filter$1 = function (obj, pred) {\n      var t = {};\n      internalFilter(obj, pred, objAcc(t), noop);\n      return t;\n    };\n    var mapToArray = function (obj, f) {\n      var r = [];\n      each$1(obj, function (value, name) {\n        r.push(f(value, name));\n      });\n      return r;\n    };\n    var find$1 = function (obj, pred) {\n      var props = keys(obj);\n      for (var k = 0, len = props.length; k < len; k++) {\n        var i = props[k];\n        var x = obj[i];\n        if (pred(x, i, obj)) {\n          return Optional.some(x);\n        }\n      }\n      return Optional.none();\n    };\n    var values = function (obj) {\n      return mapToArray(obj, function (v) {\n        return v;\n      });\n    };\n    var get$1 = function (obj, key) {\n      return has(obj, key) ? Optional.from(obj[key]) : Optional.none();\n    };\n    var has = function (obj, key) {\n      return hasOwnProperty.call(obj, key);\n    };\n    var hasNonNullableKey = function (obj, key) {\n      return has(obj, key) && obj[key] !== undefined && obj[key] !== null;\n    };\n\n    var generate = function (cases) {\n      if (!isArray(cases)) {\n        throw new Error('cases must be an array');\n      }\n      if (cases.length === 0) {\n        throw new Error('there must be at least one case');\n      }\n      var constructors = [];\n      var adt = {};\n      each(cases, function (acase, count) {\n        var keys$1 = keys(acase);\n        if (keys$1.length !== 1) {\n          throw new Error('one and only one name per case');\n        }\n        var key = keys$1[0];\n        var value = acase[key];\n        if (adt[key] !== undefined) {\n          throw new Error('duplicate key detected:' + key);\n        } else if (key === 'cata') {\n          throw new Error('cannot have a case named cata (sorry)');\n        } else if (!isArray(value)) {\n          throw new Error('case arguments must be an array');\n        }\n        constructors.push(key);\n        adt[key] = function () {\n          var args = [];\n          for (var _i = 0; _i < arguments.length; _i++) {\n            args[_i] = arguments[_i];\n          }\n          var argLength = args.length;\n          if (argLength !== value.length) {\n            throw new Error('Wrong number of arguments to case ' + key + '. Expected ' + value.length + ' (' + value + '), got ' + argLength);\n          }\n          var match = function (branches) {\n            var branchKeys = keys(branches);\n            if (constructors.length !== branchKeys.length) {\n              throw new Error('Wrong number of arguments to match. Expected: ' + constructors.join(',') + '\\nActual: ' + branchKeys.join(','));\n            }\n            var allReqd = forall(constructors, function (reqKey) {\n              return contains(branchKeys, reqKey);\n            });\n            if (!allReqd) {\n              throw new Error('Not all branches were specified when using match. Specified: ' + branchKeys.join(', ') + '\\nRequired: ' + constructors.join(', '));\n            }\n            return branches[key].apply(null, args);\n          };\n          return {\n            fold: function () {\n              var foldArgs = [];\n              for (var _i = 0; _i < arguments.length; _i++) {\n                foldArgs[_i] = arguments[_i];\n              }\n              if (foldArgs.length !== cases.length) {\n                throw new Error('Wrong number of arguments to fold. Expected ' + cases.length + ', got ' + foldArgs.length);\n              }\n              var target = foldArgs[count];\n              return target.apply(null, args);\n            },\n            match: match,\n            log: function (label) {\n              console.log(label, {\n                constructors: constructors,\n                constructor: key,\n                params: args\n              });\n            }\n          };\n        };\n      });\n      return adt;\n    };\n    var Adt = { generate: generate };\n\n    var hasOwnProperty$1 = Object.prototype.hasOwnProperty;\n    var shallow = function (old, nu) {\n      return nu;\n    };\n    var deep = function (old, nu) {\n      var bothObjects = isObject(old) && isObject(nu);\n      return bothObjects ? deepMerge(old, nu) : nu;\n    };\n    var baseMerge = function (merger) {\n      return function () {\n        var objects = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n          objects[_i] = arguments[_i];\n        }\n        if (objects.length === 0) {\n          throw new Error('Can\\'t merge zero objects');\n        }\n        var ret = {};\n        for (var j = 0; j < objects.length; j++) {\n          var curObject = objects[j];\n          for (var key in curObject) {\n            if (hasOwnProperty$1.call(curObject, key)) {\n              ret[key] = merger(ret[key], curObject[key]);\n            }\n          }\n        }\n        return ret;\n      };\n    };\n    var deepMerge = baseMerge(deep);\n    var merge = baseMerge(shallow);\n\n    var cached = function (f) {\n      var called = false;\n      var r;\n      return function () {\n        var args = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n          args[_i] = arguments[_i];\n        }\n        if (!called) {\n          called = true;\n          r = f.apply(null, args);\n        }\n        return r;\n      };\n    };\n\n    var adt = Adt.generate([\n      { strict: [] },\n      { defaultedThunk: ['fallbackThunk'] },\n      { asOption: [] },\n      { asDefaultedOptionThunk: ['fallbackThunk'] },\n      { mergeWithThunk: ['baseThunk'] }\n    ]);\n    var defaulted = function (fallback) {\n      return adt.defaultedThunk(constant(fallback));\n    };\n    var mergeWith = function (base) {\n      return adt.mergeWithThunk(constant(base));\n    };\n    var strict = adt.strict;\n    var asOption = adt.asOption;\n    var defaultedThunk = adt.defaultedThunk;\n    var asDefaultedOptionThunk = adt.asDefaultedOptionThunk;\n    var mergeWithThunk = adt.mergeWithThunk;\n\n    var comparison = Adt.generate([\n      {\n        bothErrors: [\n          'error1',\n          'error2'\n        ]\n      },\n      {\n        firstError: [\n          'error1',\n          'value2'\n        ]\n      },\n      {\n        secondError: [\n          'value1',\n          'error2'\n        ]\n      },\n      {\n        bothValues: [\n          'value1',\n          'value2'\n        ]\n      }\n    ]);\n    var partition$2 = function (results) {\n      var errors = [];\n      var values = [];\n      each(results, function (result) {\n        result.fold(function (err) {\n          errors.push(err);\n        }, function (value) {\n          values.push(value);\n        });\n      });\n      return {\n        errors: errors,\n        values: values\n      };\n    };\n\n    var exclude = function (obj, fields) {\n      var r = {};\n      each$1(obj, function (v, k) {\n        if (!contains(fields, k)) {\n          r[k] = v;\n        }\n      });\n      return r;\n    };\n\n    var wrap = function (key, value) {\n      var _a;\n      return _a = {}, _a[key] = value, _a;\n    };\n    var wrapAll = function (keyvalues) {\n      var r = {};\n      each(keyvalues, function (kv) {\n        r[kv.key] = kv.value;\n      });\n      return r;\n    };\n\n    var exclude$1 = function (obj, fields) {\n      return exclude(obj, fields);\n    };\n    var wrap$1 = function (key, value) {\n      return wrap(key, value);\n    };\n    var wrapAll$1 = function (keyvalues) {\n      return wrapAll(keyvalues);\n    };\n    var mergeValues = function (values, base) {\n      return values.length === 0 ? Result.value(base) : Result.value(deepMerge(base, merge.apply(undefined, values)));\n    };\n    var mergeErrors = function (errors) {\n      return Result.error(flatten(errors));\n    };\n    var consolidate = function (objs, base) {\n      var partitions = partition$2(objs);\n      return partitions.errors.length > 0 ? mergeErrors(partitions.errors) : mergeValues(partitions.values, base);\n    };\n\n    var mergeValues$1 = function (values, base) {\n      return values.length > 0 ? SimpleResult.svalue(deepMerge(base, merge.apply(undefined, values))) : SimpleResult.svalue(base);\n    };\n    var mergeErrors$1 = function (errors) {\n      return compose(SimpleResult.serror, flatten)(errors);\n    };\n    var consolidateObj = function (objects, base) {\n      var partition = SimpleResult.partition(objects);\n      return partition.errors.length > 0 ? mergeErrors$1(partition.errors) : mergeValues$1(partition.values, base);\n    };\n    var consolidateArr = function (objects) {\n      var partitions = SimpleResult.partition(objects);\n      return partitions.errors.length > 0 ? mergeErrors$1(partitions.errors) : SimpleResult.svalue(partitions.values);\n    };\n    var ResultCombine = {\n      consolidateObj: consolidateObj,\n      consolidateArr: consolidateArr\n    };\n\n    var formatObj = function (input) {\n      return isObject(input) && keys(input).length > 100 ? ' removed due to size' : JSON.stringify(input, null, 2);\n    };\n    var formatErrors = function (errors) {\n      var es = errors.length > 10 ? errors.slice(0, 10).concat([{\n          path: [],\n          getErrorInfo: function () {\n            return '... (only showing first ten failures)';\n          }\n        }]) : errors;\n      return map(es, function (e) {\n        return 'Failed path: (' + e.path.join(' > ') + ')\\n' + e.getErrorInfo();\n      });\n    };\n\n    var nu = function (path, getErrorInfo) {\n      return SimpleResult.serror([{\n          path: path,\n          getErrorInfo: getErrorInfo\n        }]);\n    };\n    var missingStrict = function (path, key, obj) {\n      return nu(path, function () {\n        return 'Could not find valid *strict* value for \"' + key + '\" in ' + formatObj(obj);\n      });\n    };\n    var missingKey = function (path, key) {\n      return nu(path, function () {\n        return 'Choice schema did not contain choice key: \"' + key + '\"';\n      });\n    };\n    var missingBranch = function (path, branches, branch) {\n      return nu(path, function () {\n        return 'The chosen schema: \"' + branch + '\" did not exist in branches: ' + formatObj(branches);\n      });\n    };\n    var unsupportedFields = function (path, unsupported) {\n      return nu(path, function () {\n        return 'There are unsupported fields: [' + unsupported.join(', ') + '] specified';\n      });\n    };\n    var custom = function (path, err) {\n      return nu(path, function () {\n        return err;\n      });\n    };\n\n    var adt$1 = Adt.generate([\n      {\n        field: [\n          'key',\n          'okey',\n          'presence',\n          'prop'\n        ]\n      },\n      {\n        state: [\n          'okey',\n          'instantiator'\n        ]\n      }\n    ]);\n    var strictAccess = function (path, obj, key) {\n      return get$1(obj, key).fold(function () {\n        return missingStrict(path, key, obj);\n      }, SimpleResult.svalue);\n    };\n    var fallbackAccess = function (obj, key, fallbackThunk) {\n      var v = get$1(obj, key).fold(function () {\n        return fallbackThunk(obj);\n      }, identity);\n      return SimpleResult.svalue(v);\n    };\n    var optionAccess = function (obj, key) {\n      return SimpleResult.svalue(get$1(obj, key));\n    };\n    var optionDefaultedAccess = function (obj, key, fallback) {\n      var opt = get$1(obj, key).map(function (val) {\n        return val === true ? fallback(obj) : val;\n      });\n      return SimpleResult.svalue(opt);\n    };\n    var cExtractOne = function (path, obj, field, strength) {\n      return field.fold(function (key, okey, presence, prop) {\n        var bundle = function (av) {\n          var result = prop.extract(path.concat([key]), strength, av);\n          return SimpleResult.map(result, function (res) {\n            return wrap(okey, strength(res));\n          });\n        };\n        var bundleAsOption = function (optValue) {\n          return optValue.fold(function () {\n            var outcome = wrap(okey, strength(Optional.none()));\n            return SimpleResult.svalue(outcome);\n          }, function (ov) {\n            var result = prop.extract(path.concat([key]), strength, ov);\n            return SimpleResult.map(result, function (res) {\n              return wrap(okey, strength(Optional.some(res)));\n            });\n          });\n        };\n        return function () {\n          return presence.fold(function () {\n            return SimpleResult.bind(strictAccess(path, obj, key), bundle);\n          }, function (fallbackThunk) {\n            return SimpleResult.bind(fallbackAccess(obj, key, fallbackThunk), bundle);\n          }, function () {\n            return SimpleResult.bind(optionAccess(obj, key), bundleAsOption);\n          }, function (fallbackThunk) {\n            return SimpleResult.bind(optionDefaultedAccess(obj, key, fallbackThunk), bundleAsOption);\n          }, function (baseThunk) {\n            var base = baseThunk(obj);\n            var result = SimpleResult.map(fallbackAccess(obj, key, constant({})), function (v) {\n              return deepMerge(base, v);\n            });\n            return SimpleResult.bind(result, bundle);\n          });\n        }();\n      }, function (okey, instantiator) {\n        var state = instantiator(obj);\n        return SimpleResult.svalue(wrap(okey, strength(state)));\n      });\n    };\n    var cExtract = function (path, obj, fields, strength) {\n      var results = map(fields, function (field) {\n        return cExtractOne(path, obj, field, strength);\n      });\n      return ResultCombine.consolidateObj(results, {});\n    };\n    var valueThunk = function (getDelegate) {\n      var extract = function (path, strength, val) {\n        return getDelegate().extract(path, strength, val);\n      };\n      var toString = function () {\n        return getDelegate().toString();\n      };\n      return {\n        extract: extract,\n        toString: toString\n      };\n    };\n    var value$1 = function (validator) {\n      var extract = function (path, strength, val) {\n        return SimpleResult.bindError(validator(val, strength), function (err) {\n          return custom(path, err);\n        });\n      };\n      var toString = function () {\n        return 'val';\n      };\n      return {\n        extract: extract,\n        toString: toString\n      };\n    };\n    var getSetKeys = function (obj) {\n      return keys(filter$1(obj, function (value) {\n        return value !== undefined && value !== null;\n      }));\n    };\n    var objOfOnly = function (fields) {\n      var delegate = objOf(fields);\n      var fieldNames = foldr(fields, function (acc, f) {\n        return f.fold(function (key) {\n          return deepMerge(acc, wrap$1(key, true));\n        }, constant(acc));\n      }, {});\n      var extract = function (path, strength, o) {\n        var keys = isBoolean(o) ? [] : getSetKeys(o);\n        var extra = filter(keys, function (k) {\n          return !hasNonNullableKey(fieldNames, k);\n        });\n        return extra.length === 0 ? delegate.extract(path, strength, o) : unsupportedFields(path, extra);\n      };\n      return {\n        extract: extract,\n        toString: delegate.toString\n      };\n    };\n    var objOf = function (fields) {\n      var extract = function (path, strength, o) {\n        return cExtract(path, o, fields, strength);\n      };\n      var toString = function () {\n        var fieldStrings = map(fields, function (field) {\n          return field.fold(function (key, okey, presence, prop) {\n            return key + ' -> ' + prop.toString();\n          }, function (okey, _instantiator) {\n            return 'state(' + okey + ')';\n          });\n        });\n        return 'obj{\\n' + fieldStrings.join('\\n') + '}';\n      };\n      return {\n        extract: extract,\n        toString: toString\n      };\n    };\n    var arrOf = function (prop) {\n      var extract = function (path, strength, array) {\n        var results = map(array, function (a, i) {\n          return prop.extract(path.concat(['[' + i + ']']), strength, a);\n        });\n        return ResultCombine.consolidateArr(results);\n      };\n      var toString = function () {\n        return 'array(' + prop.toString() + ')';\n      };\n      return {\n        extract: extract,\n        toString: toString\n      };\n    };\n    var oneOf = function (props) {\n      var extract = function (path, strength, val) {\n        var errors = [];\n        for (var _i = 0, props_1 = props; _i < props_1.length; _i++) {\n          var prop = props_1[_i];\n          var res = prop.extract(path, strength, val);\n          if (res.stype === SimpleResultType.Value) {\n            return res;\n          }\n          errors.push(res);\n        }\n        return ResultCombine.consolidateArr(errors);\n      };\n      var toString = function () {\n        return 'oneOf(' + map(props, function (prop) {\n          return prop.toString();\n        }).join(', ') + ')';\n      };\n      return {\n        extract: extract,\n        toString: toString\n      };\n    };\n    var setOf = function (validator, prop) {\n      var validateKeys = function (path, keys) {\n        return arrOf(value$1(validator)).extract(path, identity, keys);\n      };\n      var extract = function (path, strength, o) {\n        var keys$1 = keys(o);\n        var validatedKeys = validateKeys(path, keys$1);\n        return SimpleResult.bind(validatedKeys, function (validKeys) {\n          var schema = map(validKeys, function (vk) {\n            return adt$1.field(vk, vk, strict(), prop);\n          });\n          return objOf(schema).extract(path, strength, o);\n        });\n      };\n      var toString = function () {\n        return 'setOf(' + prop.toString() + ')';\n      };\n      return {\n        extract: extract,\n        toString: toString\n      };\n    };\n    var thunk = function (desc, processor) {\n      var getP = cached(function () {\n        return processor();\n      });\n      var extract = function (path, strength, val) {\n        return getP().extract(path, strength, val);\n      };\n      var toString = function () {\n        return getP().toString();\n      };\n      return {\n        extract: extract,\n        toString: toString\n      };\n    };\n    var anyValue = constant(value$1(SimpleResult.svalue));\n    var arrOfObj = compose(arrOf, objOf);\n    var state = adt$1.state;\n    var field = adt$1.field;\n\n    var chooseFrom = function (path, strength, input, branches, ch) {\n      var fields = get$1(branches, ch);\n      return fields.fold(function () {\n        return missingBranch(path, branches, ch);\n      }, function (vp) {\n        return vp.extract(path.concat(['branch: ' + ch]), strength, input);\n      });\n    };\n    var choose = function (key, branches) {\n      var extract = function (path, strength, input) {\n        var choice = get$1(input, key);\n        return choice.fold(function () {\n          return missingKey(path, key);\n        }, function (chosen) {\n          return chooseFrom(path, strength, input, branches, chosen);\n        });\n      };\n      var toString = function () {\n        return 'chooseOn(' + key + '). Possible values: ' + keys(branches);\n      };\n      return {\n        extract: extract,\n        toString: toString\n      };\n    };\n\n    var _anyValue = value$1(SimpleResult.svalue);\n    var arrOfObj$1 = function (objFields) {\n      return arrOfObj(objFields);\n    };\n    var arrOfVal = function () {\n      return arrOf(_anyValue);\n    };\n    var valueThunkOf = valueThunk;\n    var valueOf = function (validator) {\n      return value$1(function (v) {\n        return validator(v).fold(SimpleResult.serror, SimpleResult.svalue);\n      });\n    };\n    var setOf$1 = function (validator, prop) {\n      return setOf(function (v) {\n        return SimpleResult.fromResult(validator(v));\n      }, prop);\n    };\n    var extract = function (label, prop, strength, obj) {\n      var res = prop.extract([label], strength, obj);\n      return SimpleResult.mapError(res, function (errs) {\n        return {\n          input: obj,\n          errors: errs\n        };\n      });\n    };\n    var asRaw = function (label, prop, obj) {\n      return SimpleResult.toResult(extract(label, prop, identity, obj));\n    };\n    var getOrDie = function (extraction) {\n      return extraction.fold(function (errInfo) {\n        throw new Error(formatError(errInfo));\n      }, identity);\n    };\n    var asRawOrDie = function (label, prop, obj) {\n      return getOrDie(asRaw(label, prop, obj));\n    };\n    var formatError = function (errInfo) {\n      return 'Errors: \\n' + formatErrors(errInfo.errors).join('\\n') + '\\n\\nInput object: ' + formatObj(errInfo.input);\n    };\n    var chooseProcessor = function (key, branches) {\n      return choose(key, branches);\n    };\n    var choose$1 = function (key, branches) {\n      return choose(key, map$2(branches, objOf));\n    };\n    var thunkOf = function (desc, schema) {\n      return thunk(desc, schema);\n    };\n    var anyValue$1 = constant(_anyValue);\n    var typedValue = function (validator, expectedType) {\n      return value$1(function (a) {\n        var actualType = typeof a;\n        return validator(a) ? SimpleResult.svalue(a) : SimpleResult.serror('Expected type: ' + expectedType + ' but got: ' + actualType);\n      });\n    };\n    var number = typedValue(isNumber, 'number');\n    var string = typedValue(isString, 'string');\n    var boolean = typedValue(isBoolean, 'boolean');\n    var functionProcessor = typedValue(isFunction, 'function');\n    var isPostMessageable = function (val) {\n      var every = function (iter, callbackFn) {\n        var result = iter.next();\n        while (!result.done) {\n          if (!callbackFn(result.value)) {\n            return false;\n          }\n          result = iter.next();\n        }\n        return true;\n      };\n      if (Object(val) !== val) {\n        return true;\n      }\n      switch ({}.toString.call(val).slice(8, -1)) {\n      case 'Boolean':\n      case 'Number':\n      case 'String':\n      case 'Date':\n      case 'RegExp':\n      case 'Blob':\n      case 'FileList':\n      case 'ImageData':\n      case 'ImageBitmap':\n      case 'ArrayBuffer':\n        return true;\n      case 'Array':\n      case 'Object':\n        return Object.keys(val).every(function (prop) {\n          return isPostMessageable(val[prop]);\n        });\n      case 'Map':\n        return every(val.keys(), isPostMessageable) && every(val.values(), isPostMessageable);\n      case 'Set':\n        return every(val.keys(), isPostMessageable);\n      default:\n        return false;\n      }\n    };\n    var postMessageable = value$1(function (a) {\n      return isPostMessageable(a) ? SimpleResult.svalue(a) : SimpleResult.serror('Expected value to be acceptable for sending via postMessage');\n    });\n\n    var validateEnum = function (values) {\n      return valueOf(function (value) {\n        return contains(values, value) ? Result.value(value) : Result.error('Unsupported value: \"' + value + '\", choose one of \"' + values.join(', ') + '\".');\n      });\n    };\n    var strict$1 = function (key) {\n      return field(key, key, strict(), anyValue());\n    };\n    var strictOf = function (key, schema) {\n      return field(key, key, strict(), schema);\n    };\n    var strictNumber = function (key) {\n      return strictOf(key, number);\n    };\n    var strictString = function (key) {\n      return strictOf(key, string);\n    };\n    var strictStringEnum = function (key, values) {\n      return field(key, key, strict(), validateEnum(values));\n    };\n    var strictBoolean = function (key) {\n      return strictOf(key, boolean);\n    };\n    var strictFunction = function (key) {\n      return strictOf(key, functionProcessor);\n    };\n    var forbid = function (key, message) {\n      return field(key, key, asOption(), value$1(function (_v) {\n        return SimpleResult.serror('The field: ' + key + ' is forbidden. ' + message);\n      }));\n    };\n    var strictObjOf = function (key, objSchema) {\n      return field(key, key, strict(), objOf(objSchema));\n    };\n    var strictArrayOfObj = function (key, objFields) {\n      return field(key, key, strict(), arrOfObj(objFields));\n    };\n    var strictArrayOf = function (key, schema) {\n      return field(key, key, strict(), arrOf(schema));\n    };\n    var option = function (key) {\n      return field(key, key, asOption(), anyValue());\n    };\n    var optionOf = function (key, schema) {\n      return field(key, key, asOption(), schema);\n    };\n    var optionNumber = function (key) {\n      return optionOf(key, number);\n    };\n    var optionString = function (key) {\n      return optionOf(key, string);\n    };\n    var optionFunction = function (key) {\n      return optionOf(key, functionProcessor);\n    };\n    var optionArrayOf = function (key, schema) {\n      return optionOf(key, arrOf(schema));\n    };\n    var optionObjOf = function (key, objSchema) {\n      return optionOf(key, objOf(objSchema));\n    };\n    var optionObjOfOnly = function (key, objSchema) {\n      return optionOf(key, objOfOnly(objSchema));\n    };\n    var defaulted$1 = function (key, fallback) {\n      return field(key, key, defaulted(fallback), anyValue());\n    };\n    var defaultedOf = function (key, fallback, schema) {\n      return field(key, key, defaulted(fallback), schema);\n    };\n    var defaultedNumber = function (key, fallback) {\n      return defaultedOf(key, fallback, number);\n    };\n    var defaultedString = function (key, fallback) {\n      return defaultedOf(key, fallback, string);\n    };\n    var defaultedStringEnum = function (key, fallback, values) {\n      return defaultedOf(key, fallback, validateEnum(values));\n    };\n    var defaultedBoolean = function (key, fallback) {\n      return defaultedOf(key, fallback, boolean);\n    };\n    var defaultedFunction = function (key, fallback) {\n      return defaultedOf(key, fallback, functionProcessor);\n    };\n    var defaultedPostMsg = function (key, fallback) {\n      return defaultedOf(key, fallback, postMessageable);\n    };\n    var defaultedArrayOf = function (key, fallback, schema) {\n      return defaultedOf(key, fallback, arrOf(schema));\n    };\n    var defaultedObjOf = function (key, fallback, objSchema) {\n      return defaultedOf(key, fallback, objOf(objSchema));\n    };\n    var state$1 = function (okey, instantiator) {\n      return state(okey, instantiator);\n    };\n\n    var Cell = function (initial) {\n      var value = initial;\n      var get = function () {\n        return value;\n      };\n      var set = function (v) {\n        value = v;\n      };\n      return {\n        get: get,\n        set: set\n      };\n    };\n\n    var fromHtml = function (html, scope) {\n      var doc = scope || document;\n      var div = doc.createElement('div');\n      div.innerHTML = html;\n      if (!div.hasChildNodes() || div.childNodes.length > 1) {\n        console.error('HTML does not have a single root node', html);\n        throw new Error('HTML must have a single root node');\n      }\n      return fromDom(div.childNodes[0]);\n    };\n    var fromTag = function (tag, scope) {\n      var doc = scope || document;\n      var node = doc.createElement(tag);\n      return fromDom(node);\n    };\n    var fromText = function (text, scope) {\n      var doc = scope || document;\n      var node = doc.createTextNode(text);\n      return fromDom(node);\n    };\n    var fromDom = function (node) {\n      if (node === null || node === undefined) {\n        throw new Error('Node cannot be null or undefined');\n      }\n      return { dom: node };\n    };\n    var fromPoint = function (docElm, x, y) {\n      return Optional.from(docElm.dom.elementFromPoint(x, y)).map(fromDom);\n    };\n    var SugarElement = {\n      fromHtml: fromHtml,\n      fromTag: fromTag,\n      fromText: fromText,\n      fromDom: fromDom,\n      fromPoint: fromPoint\n    };\n\n    var DeviceType = function (os, browser, userAgent, mediaMatch) {\n      var isiPad = os.isiOS() && /ipad/i.test(userAgent) === true;\n      var isiPhone = os.isiOS() && !isiPad;\n      var isMobile = os.isiOS() || os.isAndroid();\n      var isTouch = isMobile || mediaMatch('(pointer:coarse)');\n      var isTablet = isiPad || !isiPhone && isMobile && mediaMatch('(min-device-width:768px)');\n      var isPhone = isiPhone || isMobile && !isTablet;\n      var iOSwebview = browser.isSafari() && os.isiOS() && /safari/i.test(userAgent) === false;\n      var isDesktop = !isPhone && !isTablet && !iOSwebview;\n      return {\n        isiPad: constant(isiPad),\n        isiPhone: constant(isiPhone),\n        isTablet: constant(isTablet),\n        isPhone: constant(isPhone),\n        isTouch: constant(isTouch),\n        isAndroid: os.isAndroid,\n        isiOS: os.isiOS,\n        isWebView: constant(iOSwebview),\n        isDesktop: constant(isDesktop)\n      };\n    };\n\n    var firstMatch = function (regexes, s) {\n      for (var i = 0; i < regexes.length; i++) {\n        var x = regexes[i];\n        if (x.test(s)) {\n          return x;\n        }\n      }\n      return undefined;\n    };\n    var find$2 = function (regexes, agent) {\n      var r = firstMatch(regexes, agent);\n      if (!r) {\n        return {\n          major: 0,\n          minor: 0\n        };\n      }\n      var group = function (i) {\n        return Number(agent.replace(r, '$' + i));\n      };\n      return nu$1(group(1), group(2));\n    };\n    var detect = function (versionRegexes, agent) {\n      var cleanedAgent = String(agent).toLowerCase();\n      if (versionRegexes.length === 0) {\n        return unknown();\n      }\n      return find$2(versionRegexes, cleanedAgent);\n    };\n    var unknown = function () {\n      return nu$1(0, 0);\n    };\n    var nu$1 = function (major, minor) {\n      return {\n        major: major,\n        minor: minor\n      };\n    };\n    var Version = {\n      nu: nu$1,\n      detect: detect,\n      unknown: unknown\n    };\n\n    var detect$1 = function (candidates, userAgent) {\n      var agent = String(userAgent).toLowerCase();\n      return find(candidates, function (candidate) {\n        return candidate.search(agent);\n      });\n    };\n    var detectBrowser = function (browsers, userAgent) {\n      return detect$1(browsers, userAgent).map(function (browser) {\n        var version = Version.detect(browser.versionRegexes, userAgent);\n        return {\n          current: browser.name,\n          version: version\n        };\n      });\n    };\n    var detectOs = function (oses, userAgent) {\n      return detect$1(oses, userAgent).map(function (os) {\n        var version = Version.detect(os.versionRegexes, userAgent);\n        return {\n          current: os.name,\n          version: version\n        };\n      });\n    };\n    var UaString = {\n      detectBrowser: detectBrowser,\n      detectOs: detectOs\n    };\n\n    var checkRange = function (str, substr, start) {\n      return substr === '' || str.length >= substr.length && str.substr(start, start + substr.length) === substr;\n    };\n    var contains$1 = function (str, substr) {\n      return str.indexOf(substr) !== -1;\n    };\n    var endsWith = function (str, suffix) {\n      return checkRange(str, suffix, str.length - suffix.length);\n    };\n    var blank = function (r) {\n      return function (s) {\n        return s.replace(r, '');\n      };\n    };\n    var trim = blank(/^\\s+|\\s+$/g);\n\n    var normalVersionRegex = /.*?version\\/\\ ?([0-9]+)\\.([0-9]+).*/;\n    var checkContains = function (target) {\n      return function (uastring) {\n        return contains$1(uastring, target);\n      };\n    };\n    var browsers = [\n      {\n        name: 'Edge',\n        versionRegexes: [/.*?edge\\/ ?([0-9]+)\\.([0-9]+)$/],\n        search: function (uastring) {\n          return contains$1(uastring, 'edge/') && contains$1(uastring, 'chrome') && contains$1(uastring, 'safari') && contains$1(uastring, 'applewebkit');\n        }\n      },\n      {\n        name: 'Chrome',\n        versionRegexes: [\n          /.*?chrome\\/([0-9]+)\\.([0-9]+).*/,\n          normalVersionRegex\n        ],\n        search: function (uastring) {\n          return contains$1(uastring, 'chrome') && !contains$1(uastring, 'chromeframe');\n        }\n      },\n      {\n        name: 'IE',\n        versionRegexes: [\n          /.*?msie\\ ?([0-9]+)\\.([0-9]+).*/,\n          /.*?rv:([0-9]+)\\.([0-9]+).*/\n        ],\n        search: function (uastring) {\n          return contains$1(uastring, 'msie') || contains$1(uastring, 'trident');\n        }\n      },\n      {\n        name: 'Opera',\n        versionRegexes: [\n          normalVersionRegex,\n          /.*?opera\\/([0-9]+)\\.([0-9]+).*/\n        ],\n        search: checkContains('opera')\n      },\n      {\n        name: 'Firefox',\n        versionRegexes: [/.*?firefox\\/\\ ?([0-9]+)\\.([0-9]+).*/],\n        search: checkContains('firefox')\n      },\n      {\n        name: 'Safari',\n        versionRegexes: [\n          normalVersionRegex,\n          /.*?cpu os ([0-9]+)_([0-9]+).*/\n        ],\n        search: function (uastring) {\n          return (contains$1(uastring, 'safari') || contains$1(uastring, 'mobile/')) && contains$1(uastring, 'applewebkit');\n        }\n      }\n    ];\n    var oses = [\n      {\n        name: 'Windows',\n        search: checkContains('win'),\n        versionRegexes: [/.*?windows\\ nt\\ ?([0-9]+)\\.([0-9]+).*/]\n      },\n      {\n        name: 'iOS',\n        search: function (uastring) {\n          return contains$1(uastring, 'iphone') || contains$1(uastring, 'ipad');\n        },\n        versionRegexes: [\n          /.*?version\\/\\ ?([0-9]+)\\.([0-9]+).*/,\n          /.*cpu os ([0-9]+)_([0-9]+).*/,\n          /.*cpu iphone os ([0-9]+)_([0-9]+).*/\n        ]\n      },\n      {\n        name: 'Android',\n        search: checkContains('android'),\n        versionRegexes: [/.*?android\\ ?([0-9]+)\\.([0-9]+).*/]\n      },\n      {\n        name: 'OSX',\n        search: checkContains('mac os x'),\n        versionRegexes: [/.*?mac\\ os\\ x\\ ?([0-9]+)_([0-9]+).*/]\n      },\n      {\n        name: 'Linux',\n        search: checkContains('linux'),\n        versionRegexes: []\n      },\n      {\n        name: 'Solaris',\n        search: checkContains('sunos'),\n        versionRegexes: []\n      },\n      {\n        name: 'FreeBSD',\n        search: checkContains('freebsd'),\n        versionRegexes: []\n      },\n      {\n        name: 'ChromeOS',\n        search: checkContains('cros'),\n        versionRegexes: [/.*?chrome\\/([0-9]+)\\.([0-9]+).*/]\n      }\n    ];\n    var PlatformInfo = {\n      browsers: constant(browsers),\n      oses: constant(oses)\n    };\n\n    var edge = 'Edge';\n    var chrome = 'Chrome';\n    var ie = 'IE';\n    var opera = 'Opera';\n    var firefox = 'Firefox';\n    var safari = 'Safari';\n    var unknown$1 = function () {\n      return nu$2({\n        current: undefined,\n        version: Version.unknown()\n      });\n    };\n    var nu$2 = function (info) {\n      var current = info.current;\n      var version = info.version;\n      var isBrowser = function (name) {\n        return function () {\n          return current === name;\n        };\n      };\n      return {\n        current: current,\n        version: version,\n        isEdge: isBrowser(edge),\n        isChrome: isBrowser(chrome),\n        isIE: isBrowser(ie),\n        isOpera: isBrowser(opera),\n        isFirefox: isBrowser(firefox),\n        isSafari: isBrowser(safari)\n      };\n    };\n    var Browser = {\n      unknown: unknown$1,\n      nu: nu$2,\n      edge: constant(edge),\n      chrome: constant(chrome),\n      ie: constant(ie),\n      opera: constant(opera),\n      firefox: constant(firefox),\n      safari: constant(safari)\n    };\n\n    var windows = 'Windows';\n    var ios = 'iOS';\n    var android = 'Android';\n    var linux = 'Linux';\n    var osx = 'OSX';\n    var solaris = 'Solaris';\n    var freebsd = 'FreeBSD';\n    var chromeos = 'ChromeOS';\n    var unknown$2 = function () {\n      return nu$3({\n        current: undefined,\n        version: Version.unknown()\n      });\n    };\n    var nu$3 = function (info) {\n      var current = info.current;\n      var version = info.version;\n      var isOS = function (name) {\n        return function () {\n          return current === name;\n        };\n      };\n      return {\n        current: current,\n        version: version,\n        isWindows: isOS(windows),\n        isiOS: isOS(ios),\n        isAndroid: isOS(android),\n        isOSX: isOS(osx),\n        isLinux: isOS(linux),\n        isSolaris: isOS(solaris),\n        isFreeBSD: isOS(freebsd),\n        isChromeOS: isOS(chromeos)\n      };\n    };\n    var OperatingSystem = {\n      unknown: unknown$2,\n      nu: nu$3,\n      windows: constant(windows),\n      ios: constant(ios),\n      android: constant(android),\n      linux: constant(linux),\n      osx: constant(osx),\n      solaris: constant(solaris),\n      freebsd: constant(freebsd),\n      chromeos: constant(chromeos)\n    };\n\n    var detect$2 = function (userAgent, mediaMatch) {\n      var browsers = PlatformInfo.browsers();\n      var oses = PlatformInfo.oses();\n      var browser = UaString.detectBrowser(browsers, userAgent).fold(Browser.unknown, Browser.nu);\n      var os = UaString.detectOs(oses, userAgent).fold(OperatingSystem.unknown, OperatingSystem.nu);\n      var deviceType = DeviceType(os, browser, userAgent, mediaMatch);\n      return {\n        browser: browser,\n        os: os,\n        deviceType: deviceType\n      };\n    };\n    var PlatformDetection = { detect: detect$2 };\n\n    var mediaMatch = function (query) {\n      return window.matchMedia(query).matches;\n    };\n    var platform = cached(function () {\n      return PlatformDetection.detect(navigator.userAgent, mediaMatch);\n    });\n    var detect$3 = function () {\n      return platform();\n    };\n\n    var compareDocumentPosition = function (a, b, match) {\n      return (a.compareDocumentPosition(b) & match) !== 0;\n    };\n    var documentPositionContainedBy = function (a, b) {\n      return compareDocumentPosition(a, b, Node.DOCUMENT_POSITION_CONTAINED_BY);\n    };\n\n    var DOCUMENT = 9;\n    var DOCUMENT_FRAGMENT = 11;\n    var ELEMENT = 1;\n    var TEXT = 3;\n\n    var is = function (element, selector) {\n      var dom = element.dom;\n      if (dom.nodeType !== ELEMENT) {\n        return false;\n      } else {\n        var elem = dom;\n        if (elem.matches !== undefined) {\n          return elem.matches(selector);\n        } else if (elem.msMatchesSelector !== undefined) {\n          return elem.msMatchesSelector(selector);\n        } else if (elem.webkitMatchesSelector !== undefined) {\n          return elem.webkitMatchesSelector(selector);\n        } else if (elem.mozMatchesSelector !== undefined) {\n          return elem.mozMatchesSelector(selector);\n        } else {\n          throw new Error('Browser lacks native selectors');\n        }\n      }\n    };\n    var bypassSelector = function (dom) {\n      return dom.nodeType !== ELEMENT && dom.nodeType !== DOCUMENT && dom.nodeType !== DOCUMENT_FRAGMENT || dom.childElementCount === 0;\n    };\n    var all = function (selector, scope) {\n      var base = scope === undefined ? document : scope.dom;\n      return bypassSelector(base) ? [] : map(base.querySelectorAll(selector), SugarElement.fromDom);\n    };\n    var one = function (selector, scope) {\n      var base = scope === undefined ? document : scope.dom;\n      return bypassSelector(base) ? Optional.none() : Optional.from(base.querySelector(selector)).map(SugarElement.fromDom);\n    };\n\n    var eq$1 = function (e1, e2) {\n      return e1.dom === e2.dom;\n    };\n    var regularContains = function (e1, e2) {\n      var d1 = e1.dom;\n      var d2 = e2.dom;\n      return d1 === d2 ? false : d1.contains(d2);\n    };\n    var ieContains = function (e1, e2) {\n      return documentPositionContainedBy(e1.dom, e2.dom);\n    };\n    var contains$2 = function (e1, e2) {\n      return detect$3().browser.isIE() ? ieContains(e1, e2) : regularContains(e1, e2);\n    };\n\n    var ensureIsRoot = function (isRoot) {\n      return isFunction(isRoot) ? isRoot : never;\n    };\n    var ancestor = function (scope, transform, isRoot) {\n      var element = scope.dom;\n      var stop = ensureIsRoot(isRoot);\n      while (element.parentNode) {\n        element = element.parentNode;\n        var el = SugarElement.fromDom(element);\n        var transformed = transform(el);\n        if (transformed.isSome()) {\n          return transformed;\n        } else if (stop(el)) {\n          break;\n        }\n      }\n      return Optional.none();\n    };\n    var closest = function (scope, transform, isRoot) {\n      var current = transform(scope);\n      var stop = ensureIsRoot(isRoot);\n      return current.orThunk(function () {\n        return stop(scope) ? Optional.none() : ancestor(scope, transform, stop);\n      });\n    };\n\n    var isSource = function (component, simulatedEvent) {\n      return eq$1(component.element, simulatedEvent.event.target);\n    };\n\n    var nu$4 = function (parts) {\n      if (!hasNonNullableKey(parts, 'can') && !hasNonNullableKey(parts, 'abort') && !hasNonNullableKey(parts, 'run')) {\n        throw new Error('EventHandler defined by: ' + JSON.stringify(parts, null, 2) + ' does not have can, abort, or run!');\n      }\n      return asRawOrDie('Extracting event.handler', objOfOnly([\n        defaulted$1('can', always),\n        defaulted$1('abort', never),\n        defaulted$1('run', noop)\n      ]), parts);\n    };\n    var all$1 = function (handlers, f) {\n      return function () {\n        var args = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n          args[_i] = arguments[_i];\n        }\n        return foldl(handlers, function (acc, handler) {\n          return acc && f(handler).apply(undefined, args);\n        }, true);\n      };\n    };\n    var any = function (handlers, f) {\n      return function () {\n        var args = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n          args[_i] = arguments[_i];\n        }\n        return foldl(handlers, function (acc, handler) {\n          return acc || f(handler).apply(undefined, args);\n        }, false);\n      };\n    };\n    var read = function (handler) {\n      return isFunction(handler) ? {\n        can: always,\n        abort: never,\n        run: handler\n      } : handler;\n    };\n    var fuse = function (handlers) {\n      var can = all$1(handlers, function (handler) {\n        return handler.can;\n      });\n      var abort = any(handlers, function (handler) {\n        return handler.abort;\n      });\n      var run = function () {\n        var args = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n          args[_i] = arguments[_i];\n        }\n        each(handlers, function (handler) {\n          handler.run.apply(undefined, args);\n        });\n      };\n      return nu$4({\n        can: can,\n        abort: abort,\n        run: run\n      });\n    };\n\n    var constant$1 = constant;\n    var touchstart = constant$1('touchstart');\n    var touchmove = constant$1('touchmove');\n    var touchend = constant$1('touchend');\n    var touchcancel = constant$1('touchcancel');\n    var mousedown = constant$1('mousedown');\n    var mousemove = constant$1('mousemove');\n    var mouseout = constant$1('mouseout');\n    var mouseup = constant$1('mouseup');\n    var mouseover = constant$1('mouseover');\n    var focusin = constant$1('focusin');\n    var focusout = constant$1('focusout');\n    var keydown = constant$1('keydown');\n    var keyup = constant$1('keyup');\n    var input = constant$1('input');\n    var change = constant$1('change');\n    var click = constant$1('click');\n    var transitionend = constant$1('transitionend');\n    var selectstart = constant$1('selectstart');\n\n    var prefixName = function (name) {\n      return constant('alloy.' + name);\n    };\n    var alloy = { tap: prefixName('tap') };\n    var focus = prefixName('focus');\n    var postBlur = prefixName('blur.post');\n    var postPaste = prefixName('paste.post');\n    var receive = prefixName('receive');\n    var execute = prefixName('execute');\n    var focusItem = prefixName('focus.item');\n    var tap = alloy.tap;\n    var longpress = prefixName('longpress');\n    var sandboxClose = prefixName('sandbox.close');\n    var typeaheadCancel = prefixName('typeahead.cancel');\n    var systemInit = prefixName('system.init');\n    var documentTouchmove = prefixName('system.touchmove');\n    var documentTouchend = prefixName('system.touchend');\n    var windowScroll = prefixName('system.scroll');\n    var windowResize = prefixName('system.resize');\n    var attachedToDom = prefixName('system.attached');\n    var detachedFromDom = prefixName('system.detached');\n    var dismissRequested = prefixName('system.dismissRequested');\n    var repositionRequested = prefixName('system.repositionRequested');\n    var focusShifted = prefixName('focusmanager.shifted');\n    var slotVisibility = prefixName('slotcontainer.visibility');\n    var changeTab = prefixName('change.tab');\n    var dismissTab = prefixName('dismiss.tab');\n    var highlight = prefixName('highlight');\n    var dehighlight = prefixName('dehighlight');\n\n    var emit = function (component, event) {\n      dispatchWith(component, component.element, event, {});\n    };\n    var emitWith = function (component, event, properties) {\n      dispatchWith(component, component.element, event, properties);\n    };\n    var emitExecute = function (component) {\n      emit(component, execute());\n    };\n    var dispatch = function (component, target, event) {\n      dispatchWith(component, target, event, {});\n    };\n    var dispatchWith = function (component, target, event, properties) {\n      var data = __assign({ target: target }, properties);\n      component.getSystem().triggerEvent(event, target, data);\n    };\n    var dispatchEvent = function (component, target, event, simulatedEvent) {\n      component.getSystem().triggerEvent(event, target, simulatedEvent.event);\n    };\n\n    var derive = function (configs) {\n      return wrapAll$1(configs);\n    };\n    var abort = function (name, predicate) {\n      return {\n        key: name,\n        value: nu$4({ abort: predicate })\n      };\n    };\n    var can = function (name, predicate) {\n      return {\n        key: name,\n        value: nu$4({ can: predicate })\n      };\n    };\n    var preventDefault = function (name) {\n      return {\n        key: name,\n        value: nu$4({\n          run: function (component, simulatedEvent) {\n            simulatedEvent.event.prevent();\n          }\n        })\n      };\n    };\n    var run = function (name, handler) {\n      return {\n        key: name,\n        value: nu$4({ run: handler })\n      };\n    };\n    var runActionExtra = function (name, action, extra) {\n      return {\n        key: name,\n        value: nu$4({\n          run: function (component, simulatedEvent) {\n            action.apply(undefined, [\n              component,\n              simulatedEvent\n            ].concat(extra));\n          }\n        })\n      };\n    };\n    var runOnName = function (name) {\n      return function (handler) {\n        return run(name, handler);\n      };\n    };\n    var runOnSourceName = function (name) {\n      return function (handler) {\n        return {\n          key: name,\n          value: nu$4({\n            run: function (component, simulatedEvent) {\n              if (isSource(component, simulatedEvent)) {\n                handler(component, simulatedEvent);\n              }\n            }\n          })\n        };\n      };\n    };\n    var redirectToUid = function (name, uid) {\n      return run(name, function (component, simulatedEvent) {\n        component.getSystem().getByUid(uid).each(function (redirectee) {\n          dispatchEvent(redirectee, redirectee.element, name, simulatedEvent);\n        });\n      });\n    };\n    var redirectToPart = function (name, detail, partName) {\n      var uid = detail.partUids[partName];\n      return redirectToUid(name, uid);\n    };\n    var runWithTarget = function (name, f) {\n      return run(name, function (component, simulatedEvent) {\n        var ev = simulatedEvent.event;\n        var target = component.getSystem().getByDom(ev.target).fold(function () {\n          var closest$1 = closest(ev.target, function (el) {\n            return component.getSystem().getByDom(el).toOptional();\n          }, never);\n          return closest$1.getOr(component);\n        }, function (c) {\n          return c;\n        });\n        f(component, target, simulatedEvent);\n      });\n    };\n    var cutter = function (name) {\n      return run(name, function (component, simulatedEvent) {\n        simulatedEvent.cut();\n      });\n    };\n    var stopper = function (name) {\n      return run(name, function (component, simulatedEvent) {\n        simulatedEvent.stop();\n      });\n    };\n    var runOnSource = function (name, f) {\n      return runOnSourceName(name)(f);\n    };\n    var runOnAttached = runOnSourceName(attachedToDom());\n    var runOnDetached = runOnSourceName(detachedFromDom());\n    var runOnInit = runOnSourceName(systemInit());\n    var runOnExecute = runOnName(execute());\n\n    var Global = typeof window !== 'undefined' ? window : Function('return this;')();\n\n    var name = function (element) {\n      var r = element.dom.nodeName;\n      return r.toLowerCase();\n    };\n    var type = function (element) {\n      return element.dom.nodeType;\n    };\n    var isType$1 = function (t) {\n      return function (element) {\n        return type(element) === t;\n      };\n    };\n    var isElement = isType$1(ELEMENT);\n    var isText = isType$1(TEXT);\n    var isDocument = isType$1(DOCUMENT);\n    var isDocumentFragment = isType$1(DOCUMENT_FRAGMENT);\n\n    var owner = function (element) {\n      return SugarElement.fromDom(element.dom.ownerDocument);\n    };\n    var documentOrOwner = function (dos) {\n      return isDocument(dos) ? dos : owner(dos);\n    };\n    var documentElement = function (element) {\n      return SugarElement.fromDom(documentOrOwner(element).dom.documentElement);\n    };\n    var defaultView = function (element) {\n      return SugarElement.fromDom(documentOrOwner(element).dom.defaultView);\n    };\n    var parent = function (element) {\n      return Optional.from(element.dom.parentNode).map(SugarElement.fromDom);\n    };\n    var parentNode = function (element) {\n      return parent(element);\n    };\n    var offsetParent = function (element) {\n      return Optional.from(element.dom.offsetParent).map(SugarElement.fromDom);\n    };\n    var nextSibling = function (element) {\n      return Optional.from(element.dom.nextSibling).map(SugarElement.fromDom);\n    };\n    var children = function (element) {\n      return map(element.dom.childNodes, SugarElement.fromDom);\n    };\n    var child = function (element, index) {\n      var cs = element.dom.childNodes;\n      return Optional.from(cs[index]).map(SugarElement.fromDom);\n    };\n    var firstChild = function (element) {\n      return child(element, 0);\n    };\n\n    var isShadowRoot = function (dos) {\n      return isDocumentFragment(dos) && isNonNullable(dos.dom.host);\n    };\n    var supported = isFunction(Element.prototype.attachShadow) && isFunction(Node.prototype.getRootNode);\n    var isSupported = constant(supported);\n    var getRootNode = supported ? function (e) {\n      return SugarElement.fromDom(e.dom.getRootNode());\n    } : documentOrOwner;\n    var getContentContainer = function (dos) {\n      return isShadowRoot(dos) ? dos : SugarElement.fromDom(documentOrOwner(dos).dom.body);\n    };\n    var isInShadowRoot = function (e) {\n      return getShadowRoot(e).isSome();\n    };\n    var getShadowRoot = function (e) {\n      var r = getRootNode(e);\n      return isShadowRoot(r) ? Optional.some(r) : Optional.none();\n    };\n    var getShadowHost = function (e) {\n      return SugarElement.fromDom(e.dom.host);\n    };\n    var getOriginalEventTarget = function (event) {\n      if (isSupported() && isNonNullable(event.target)) {\n        var el = SugarElement.fromDom(event.target);\n        if (isElement(el) && isOpenShadowHost(el)) {\n          if (event.composed && event.composedPath) {\n            var composedPath = event.composedPath();\n            if (composedPath) {\n              return head(composedPath);\n            }\n          }\n        }\n      }\n      return Optional.from(event.target);\n    };\n    var isOpenShadowHost = function (element) {\n      return isNonNullable(element.dom.shadowRoot);\n    };\n\n    var before = function (marker, element) {\n      var parent$1 = parent(marker);\n      parent$1.each(function (v) {\n        v.dom.insertBefore(element.dom, marker.dom);\n      });\n    };\n    var after = function (marker, element) {\n      var sibling = nextSibling(marker);\n      sibling.fold(function () {\n        var parent$1 = parent(marker);\n        parent$1.each(function (v) {\n          append(v, element);\n        });\n      }, function (v) {\n        before(v, element);\n      });\n    };\n    var prepend = function (parent, element) {\n      var firstChild$1 = firstChild(parent);\n      firstChild$1.fold(function () {\n        append(parent, element);\n      }, function (v) {\n        parent.dom.insertBefore(element.dom, v.dom);\n      });\n    };\n    var append = function (parent, element) {\n      parent.dom.appendChild(element.dom);\n    };\n    var appendAt = function (parent, element, index) {\n      child(parent, index).fold(function () {\n        append(parent, element);\n      }, function (v) {\n        before(v, element);\n      });\n    };\n\n    var before$1 = function (marker, elements) {\n      each(elements, function (x) {\n        before(marker, x);\n      });\n    };\n    var append$1 = function (parent, elements) {\n      each(elements, function (x) {\n        append(parent, x);\n      });\n    };\n\n    var empty = function (element) {\n      element.dom.textContent = '';\n      each(children(element), function (rogue) {\n        remove(rogue);\n      });\n    };\n    var remove = function (element) {\n      var dom = element.dom;\n      if (dom.parentNode !== null) {\n        dom.parentNode.removeChild(dom);\n      }\n    };\n    var unwrap = function (wrapper) {\n      var children$1 = children(wrapper);\n      if (children$1.length > 0) {\n        before$1(wrapper, children$1);\n      }\n      remove(wrapper);\n    };\n\n    var fromHtml$1 = function (html, scope) {\n      var doc = scope || document;\n      var div = doc.createElement('div');\n      div.innerHTML = html;\n      return children(SugarElement.fromDom(div));\n    };\n\n    var get$2 = function (element) {\n      return element.dom.innerHTML;\n    };\n    var set = function (element, content) {\n      var owner$1 = owner(element);\n      var docDom = owner$1.dom;\n      var fragment = SugarElement.fromDom(docDom.createDocumentFragment());\n      var contentElements = fromHtml$1(content, docDom);\n      append$1(fragment, contentElements);\n      empty(element);\n      append(element, fragment);\n    };\n    var getOuter = function (element) {\n      var container = SugarElement.fromTag('div');\n      var clone = SugarElement.fromDom(element.dom.cloneNode(true));\n      append(container, clone);\n      return get$2(container);\n    };\n\n    var rawSet = function (dom, key, value) {\n      if (isString(value) || isBoolean(value) || isNumber(value)) {\n        dom.setAttribute(key, value + '');\n      } else {\n        console.error('Invalid call to Attribute.set. Key ', key, ':: Value ', value, ':: Element ', dom);\n        throw new Error('Attribute value was not simple');\n      }\n    };\n    var set$1 = function (element, key, value) {\n      rawSet(element.dom, key, value);\n    };\n    var setAll = function (element, attrs) {\n      var dom = element.dom;\n      each$1(attrs, function (v, k) {\n        rawSet(dom, k, v);\n      });\n    };\n    var get$3 = function (element, key) {\n      var v = element.dom.getAttribute(key);\n      return v === null ? undefined : v;\n    };\n    var getOpt = function (element, key) {\n      return Optional.from(get$3(element, key));\n    };\n    var has$1 = function (element, key) {\n      var dom = element.dom;\n      return dom && dom.hasAttribute ? dom.hasAttribute(key) : false;\n    };\n    var remove$1 = function (element, key) {\n      element.dom.removeAttribute(key);\n    };\n\n    var clone = function (original, isDeep) {\n      return SugarElement.fromDom(original.dom.cloneNode(isDeep));\n    };\n    var shallow$1 = function (original) {\n      return clone(original, false);\n    };\n\n    var getHtml = function (element) {\n      if (isShadowRoot(element)) {\n        return '#shadow-root';\n      } else {\n        var clone = shallow$1(element);\n        return getOuter(clone);\n      }\n    };\n\n    var element = function (elem) {\n      return getHtml(elem);\n    };\n\n    var isRecursive = function (component, originator, target) {\n      return eq$1(originator, component.element) && !eq$1(originator, target);\n    };\n    var events = derive([can(focus(), function (component, simulatedEvent) {\n        var event = simulatedEvent.event;\n        var originator = event.originator;\n        var target = event.target;\n        if (isRecursive(component, originator, target)) {\n          console.warn(focus() + ' did not get interpreted by the desired target. ' + '\\nOriginator: ' + element(originator) + '\\nTarget: ' + element(target) + '\\nCheck the ' + focus() + ' event handlers');\n          return false;\n        } else {\n          return true;\n        }\n      })]);\n\n    var DefaultEvents = /*#__PURE__*/Object.freeze({\n        __proto__: null,\n        events: events\n    });\n\n    var unique = 0;\n    var generate$1 = function (prefix) {\n      var date = new Date();\n      var time = date.getTime();\n      var random = Math.floor(Math.random() * 1000000000);\n      unique++;\n      return prefix + '_' + random + unique + String(time);\n    };\n\n    var prefix = constant('alloy-id-');\n    var idAttr = constant('data-alloy-id');\n\n    var prefix$1 = prefix();\n    var idAttr$1 = idAttr();\n    var write = function (label, elem) {\n      var id = generate$1(prefix$1 + label);\n      writeOnly(elem, id);\n      return id;\n    };\n    var writeOnly = function (elem, uid) {\n      Object.defineProperty(elem.dom, idAttr$1, {\n        value: uid,\n        writable: true\n      });\n    };\n    var read$1 = function (elem) {\n      var id = isElement(elem) ? elem.dom[idAttr$1] : null;\n      return Optional.from(id);\n    };\n    var generate$2 = function (prefix) {\n      return generate$1(prefix);\n    };\n\n    var make = identity;\n\n    var NoContextApi = function (getComp) {\n      var fail = function (event) {\n        return function () {\n          throw new Error('The component must be in a context to send: ' + event + (getComp ? '\\n' + element(getComp().element) + ' is not in context.' : ''));\n        };\n      };\n      return {\n        debugInfo: constant('fake'),\n        triggerEvent: fail('triggerEvent'),\n        triggerFocus: fail('triggerFocus'),\n        triggerEscape: fail('triggerEscape'),\n        build: fail('build'),\n        addToWorld: fail('addToWorld'),\n        removeFromWorld: fail('removeFromWorld'),\n        addToGui: fail('addToGui'),\n        removeFromGui: fail('removeFromGui'),\n        getByUid: fail('getByUid'),\n        getByDom: fail('getByDom'),\n        broadcast: fail('broadcast'),\n        broadcastOn: fail('broadcastOn'),\n        broadcastEvent: fail('broadcastEvent'),\n        isConnected: never\n      };\n    };\n    var singleton = NoContextApi();\n\n    var markAsBehaviourApi = function (f, apiName, apiFunction) {\n      var delegate = apiFunction.toString();\n      var endIndex = delegate.indexOf(')') + 1;\n      var openBracketIndex = delegate.indexOf('(');\n      var parameters = delegate.substring(openBracketIndex + 1, endIndex - 1).split(/,\\s*/);\n      f.toFunctionAnnotation = function () {\n        return {\n          name: apiName,\n          parameters: cleanParameters(parameters.slice(0, 1).concat(parameters.slice(3)))\n        };\n      };\n      return f;\n    };\n    var cleanParameters = function (parameters) {\n      return map(parameters, function (p) {\n        return endsWith(p, '/*') ? p.substring(0, p.length - '/*'.length) : p;\n      });\n    };\n    var markAsExtraApi = function (f, extraName) {\n      var delegate = f.toString();\n      var endIndex = delegate.indexOf(')') + 1;\n      var openBracketIndex = delegate.indexOf('(');\n      var parameters = delegate.substring(openBracketIndex + 1, endIndex - 1).split(/,\\s*/);\n      f.toFunctionAnnotation = function () {\n        return {\n          name: extraName,\n          parameters: cleanParameters(parameters)\n        };\n      };\n      return f;\n    };\n    var markAsSketchApi = function (f, apiFunction) {\n      var delegate = apiFunction.toString();\n      var endIndex = delegate.indexOf(')') + 1;\n      var openBracketIndex = delegate.indexOf('(');\n      var parameters = delegate.substring(openBracketIndex + 1, endIndex - 1).split(/,\\s*/);\n      f.toFunctionAnnotation = function () {\n        return {\n          name: 'OVERRIDE',\n          parameters: cleanParameters(parameters.slice(1))\n        };\n      };\n      return f;\n    };\n\n    var premadeTag = generate$1('alloy-premade');\n    var premade = function (comp) {\n      return wrap$1(premadeTag, comp);\n    };\n    var getPremade = function (spec) {\n      return get$1(spec, premadeTag);\n    };\n    var makeApi = function (f) {\n      return markAsSketchApi(function (component) {\n        var rest = [];\n        for (var _i = 1; _i < arguments.length; _i++) {\n          rest[_i - 1] = arguments[_i];\n        }\n        return f.apply(void 0, __spreadArrays([\n          component.getApis(),\n          component\n        ], rest));\n      }, f);\n    };\n\n    var NoState = {\n      init: function () {\n        return nu$5({\n          readState: function () {\n            return 'No State required';\n          }\n        });\n      }\n    };\n    var nu$5 = function (spec) {\n      return spec;\n    };\n\n    var generateFrom = function (spec, all) {\n      var schema = map(all, function (a) {\n        return optionObjOf(a.name(), [\n          strict$1('config'),\n          defaulted$1('state', NoState)\n        ]);\n      });\n      var validated = asRaw('component.behaviours', objOf(schema), spec.behaviours).fold(function (errInfo) {\n        throw new Error(formatError(errInfo) + '\\nComplete spec:\\n' + JSON.stringify(spec, null, 2));\n      }, function (v) {\n        return v;\n      });\n      return {\n        list: all,\n        data: map$2(validated, function (optBlobThunk) {\n          var output = optBlobThunk.map(function (blob) {\n            return {\n              config: blob.config,\n              state: blob.state.init(blob.config)\n            };\n          });\n          return function () {\n            return output;\n          };\n        })\n      };\n    };\n    var getBehaviours = function (bData) {\n      return bData.list;\n    };\n    var getData = function (bData) {\n      return bData.data;\n    };\n\n    var byInnerKey = function (data, tuple) {\n      var r = {};\n      each$1(data, function (detail, key) {\n        each$1(detail, function (value, indexKey) {\n          var chain = get$1(r, indexKey).getOr([]);\n          r[indexKey] = chain.concat([tuple(key, value)]);\n        });\n      });\n      return r;\n    };\n\n    var nu$6 = function (s) {\n      return {\n        classes: s.classes !== undefined ? s.classes : [],\n        attributes: s.attributes !== undefined ? s.attributes : {},\n        styles: s.styles !== undefined ? s.styles : {}\n      };\n    };\n    var merge$1 = function (defnA, mod) {\n      return __assign(__assign({}, defnA), {\n        attributes: __assign(__assign({}, defnA.attributes), mod.attributes),\n        styles: __assign(__assign({}, defnA.styles), mod.styles),\n        classes: defnA.classes.concat(mod.classes)\n      });\n    };\n\n    var combine = function (info, baseMod, behaviours, base) {\n      var modsByBehaviour = __assign({}, baseMod);\n      each(behaviours, function (behaviour) {\n        modsByBehaviour[behaviour.name()] = behaviour.exhibit(info, base);\n      });\n      var byAspect = byInnerKey(modsByBehaviour, function (name, modification) {\n        return {\n          name: name,\n          modification: modification\n        };\n      });\n      var combineObjects = function (objects) {\n        return foldr(objects, function (b, a) {\n          return __assign(__assign({}, a.modification), b);\n        }, {});\n      };\n      var combinedClasses = foldr(byAspect.classes, function (b, a) {\n        return a.modification.concat(b);\n      }, []);\n      var combinedAttributes = combineObjects(byAspect.attributes);\n      var combinedStyles = combineObjects(byAspect.styles);\n      return nu$6({\n        classes: combinedClasses,\n        attributes: combinedAttributes,\n        styles: combinedStyles\n      });\n    };\n\n    var sortKeys = function (label, keyName, array, order) {\n      try {\n        var sorted = sort(array, function (a, b) {\n          var aKey = a[keyName];\n          var bKey = b[keyName];\n          var aIndex = order.indexOf(aKey);\n          var bIndex = order.indexOf(bKey);\n          if (aIndex === -1) {\n            throw new Error('The ordering for ' + label + ' does not have an entry for ' + aKey + '.\\nOrder specified: ' + JSON.stringify(order, null, 2));\n          }\n          if (bIndex === -1) {\n            throw new Error('The ordering for ' + label + ' does not have an entry for ' + bKey + '.\\nOrder specified: ' + JSON.stringify(order, null, 2));\n          }\n          if (aIndex < bIndex) {\n            return -1;\n          } else if (bIndex < aIndex) {\n            return 1;\n          } else {\n            return 0;\n          }\n        });\n        return Result.value(sorted);\n      } catch (err) {\n        return Result.error([err]);\n      }\n    };\n\n    var uncurried = function (handler, purpose) {\n      return {\n        handler: handler,\n        purpose: purpose\n      };\n    };\n    var curried = function (handler, purpose) {\n      return {\n        cHandler: handler,\n        purpose: purpose\n      };\n    };\n    var curryArgs = function (descHandler, extraArgs) {\n      return curried(curry.apply(undefined, [descHandler.handler].concat(extraArgs)), descHandler.purpose);\n    };\n    var getCurried = function (descHandler) {\n      return descHandler.cHandler;\n    };\n\n    var behaviourTuple = function (name, handler) {\n      return {\n        name: name,\n        handler: handler\n      };\n    };\n    var nameToHandlers = function (behaviours, info) {\n      var r = {};\n      each(behaviours, function (behaviour) {\n        r[behaviour.name()] = behaviour.handlers(info);\n      });\n      return r;\n    };\n    var groupByEvents = function (info, behaviours, base) {\n      var behaviourEvents = __assign(__assign({}, base), nameToHandlers(behaviours, info));\n      return byInnerKey(behaviourEvents, behaviourTuple);\n    };\n    var combine$1 = function (info, eventOrder, behaviours, base) {\n      var byEventName = groupByEvents(info, behaviours, base);\n      return combineGroups(byEventName, eventOrder);\n    };\n    var assemble = function (rawHandler) {\n      var handler = read(rawHandler);\n      return function (component, simulatedEvent) {\n        var rest = [];\n        for (var _i = 2; _i < arguments.length; _i++) {\n          rest[_i - 2] = arguments[_i];\n        }\n        var args = [\n          component,\n          simulatedEvent\n        ].concat(rest);\n        if (handler.abort.apply(undefined, args)) {\n          simulatedEvent.stop();\n        } else if (handler.can.apply(undefined, args)) {\n          handler.run.apply(undefined, args);\n        }\n      };\n    };\n    var missingOrderError = function (eventName, tuples) {\n      return Result.error(['The event (' + eventName + ') has more than one behaviour that listens to it.\\nWhen this occurs, you must ' + 'specify an event ordering for the behaviours in your spec (e.g. [ \"listing\", \"toggling\" ]).\\nThe behaviours that ' + 'can trigger it are: ' + JSON.stringify(map(tuples, function (c) {\n          return c.name;\n        }), null, 2)]);\n    };\n    var fuse$1 = function (tuples, eventOrder, eventName) {\n      var order = eventOrder[eventName];\n      if (!order) {\n        return missingOrderError(eventName, tuples);\n      } else {\n        return sortKeys('Event: ' + eventName, 'name', tuples, order).map(function (sortedTuples) {\n          var handlers = map(sortedTuples, function (tuple) {\n            return tuple.handler;\n          });\n          return fuse(handlers);\n        });\n      }\n    };\n    var combineGroups = function (byEventName, eventOrder) {\n      var r = mapToArray(byEventName, function (tuples, eventName) {\n        var combined = tuples.length === 1 ? Result.value(tuples[0].handler) : fuse$1(tuples, eventOrder, eventName);\n        return combined.map(function (handler) {\n          var assembled = assemble(handler);\n          var purpose = tuples.length > 1 ? filter(eventOrder[eventName], function (o) {\n            return exists(tuples, function (t) {\n              return t.name === o;\n            });\n          }).join(' > ') : tuples[0].name;\n          return wrap$1(eventName, uncurried(assembled, purpose));\n        });\n      });\n      return consolidate(r, {});\n    };\n\n    var baseBehaviour = 'alloy.base.behaviour';\n    var toInfo = function (spec) {\n      var _a;\n      return asRaw('custom.definition', objOf([\n        field('dom', 'dom', strict(), objOf([\n          strict$1('tag'),\n          defaulted$1('styles', {}),\n          defaulted$1('classes', []),\n          defaulted$1('attributes', {}),\n          option('value'),\n          option('innerHtml')\n        ])),\n        strict$1('components'),\n        strict$1('uid'),\n        defaulted$1('events', {}),\n        defaulted$1('apis', {}),\n        field('eventOrder', 'eventOrder', mergeWith((_a = {}, _a[execute()] = [\n          'disabling',\n          baseBehaviour,\n          'toggling',\n          'typeaheadevents'\n        ], _a[focus()] = [\n          baseBehaviour,\n          'focusing',\n          'keying'\n        ], _a[systemInit()] = [\n          baseBehaviour,\n          'disabling',\n          'toggling',\n          'representing'\n        ], _a[input()] = [\n          baseBehaviour,\n          'representing',\n          'streaming',\n          'invalidating'\n        ], _a[detachedFromDom()] = [\n          baseBehaviour,\n          'representing',\n          'item-events',\n          'tooltipping'\n        ], _a[mousedown()] = [\n          'focusing',\n          baseBehaviour,\n          'item-type-events'\n        ], _a[touchstart()] = [\n          'focusing',\n          baseBehaviour,\n          'item-type-events'\n        ], _a[mouseover()] = [\n          'item-type-events',\n          'tooltipping'\n        ], _a[receive()] = [\n          'receiving',\n          'reflecting',\n          'tooltipping'\n        ], _a)), anyValue$1()),\n        option('domModification')\n      ]), spec);\n    };\n    var toDefinition = function (detail) {\n      return __assign(__assign({}, detail.dom), {\n        uid: detail.uid,\n        domChildren: map(detail.components, function (comp) {\n          return comp.element;\n        })\n      });\n    };\n    var toModification = function (detail) {\n      return detail.domModification.fold(function () {\n        return nu$6({});\n      }, nu$6);\n    };\n    var toEvents = function (info) {\n      return info.events;\n    };\n\n    var read$2 = function (element, attr) {\n      var value = get$3(element, attr);\n      return value === undefined || value === '' ? [] : value.split(' ');\n    };\n    var add = function (element, attr, id) {\n      var old = read$2(element, attr);\n      var nu = old.concat([id]);\n      set$1(element, attr, nu.join(' '));\n      return true;\n    };\n    var remove$2 = function (element, attr, id) {\n      var nu = filter(read$2(element, attr), function (v) {\n        return v !== id;\n      });\n      if (nu.length > 0) {\n        set$1(element, attr, nu.join(' '));\n      } else {\n        remove$1(element, attr);\n      }\n      return false;\n    };\n\n    var supports = function (element) {\n      return element.dom.classList !== undefined;\n    };\n    var get$4 = function (element) {\n      return read$2(element, 'class');\n    };\n    var add$1 = function (element, clazz) {\n      return add(element, 'class', clazz);\n    };\n    var remove$3 = function (element, clazz) {\n      return remove$2(element, 'class', clazz);\n    };\n\n    var add$2 = function (element, clazz) {\n      if (supports(element)) {\n        element.dom.classList.add(clazz);\n      } else {\n        add$1(element, clazz);\n      }\n    };\n    var cleanClass = function (element) {\n      var classList = supports(element) ? element.dom.classList : get$4(element);\n      if (classList.length === 0) {\n        remove$1(element, 'class');\n      }\n    };\n    var remove$4 = function (element, clazz) {\n      if (supports(element)) {\n        var classList = element.dom.classList;\n        classList.remove(clazz);\n      } else {\n        remove$3(element, clazz);\n      }\n      cleanClass(element);\n    };\n    var has$2 = function (element, clazz) {\n      return supports(element) && element.dom.classList.contains(clazz);\n    };\n\n    var add$3 = function (element, classes) {\n      each(classes, function (x) {\n        add$2(element, x);\n      });\n    };\n    var remove$5 = function (element, classes) {\n      each(classes, function (x) {\n        remove$4(element, x);\n      });\n    };\n\n    var isSupported$1 = function (dom) {\n      return dom.style !== undefined && isFunction(dom.style.getPropertyValue);\n    };\n\n    var inBody = function (element) {\n      var dom = isText(element) ? element.dom.parentNode : element.dom;\n      if (dom === undefined || dom === null || dom.ownerDocument === null) {\n        return false;\n      }\n      var doc = dom.ownerDocument;\n      return getShadowRoot(SugarElement.fromDom(dom)).fold(function () {\n        return doc.body.contains(dom);\n      }, compose1(inBody, getShadowHost));\n    };\n    var body = function () {\n      return getBody(SugarElement.fromDom(document));\n    };\n    var getBody = function (doc) {\n      var b = doc.dom.body;\n      if (b === null || b === undefined) {\n        throw new Error('Body is not available yet');\n      }\n      return SugarElement.fromDom(b);\n    };\n\n    var internalSet = function (dom, property, value) {\n      if (!isString(value)) {\n        console.error('Invalid call to CSS.set. Property ', property, ':: Value ', value, ':: Element ', dom);\n        throw new Error('CSS value must be a string: ' + value);\n      }\n      if (isSupported$1(dom)) {\n        dom.style.setProperty(property, value);\n      }\n    };\n    var internalRemove = function (dom, property) {\n      if (isSupported$1(dom)) {\n        dom.style.removeProperty(property);\n      }\n    };\n    var set$2 = function (element, property, value) {\n      var dom = element.dom;\n      internalSet(dom, property, value);\n    };\n    var setAll$1 = function (element, css) {\n      var dom = element.dom;\n      each$1(css, function (v, k) {\n        internalSet(dom, k, v);\n      });\n    };\n    var setOptions = function (element, css) {\n      var dom = element.dom;\n      each$1(css, function (v, k) {\n        v.fold(function () {\n          internalRemove(dom, k);\n        }, function (value) {\n          internalSet(dom, k, value);\n        });\n      });\n    };\n    var get$5 = function (element, property) {\n      var dom = element.dom;\n      var styles = window.getComputedStyle(dom);\n      var r = styles.getPropertyValue(property);\n      return r === '' && !inBody(element) ? getUnsafeProperty(dom, property) : r;\n    };\n    var getUnsafeProperty = function (dom, property) {\n      return isSupported$1(dom) ? dom.style.getPropertyValue(property) : '';\n    };\n    var getRaw = function (element, property) {\n      var dom = element.dom;\n      var raw = getUnsafeProperty(dom, property);\n      return Optional.from(raw).filter(function (r) {\n        return r.length > 0;\n      });\n    };\n    var getAllRaw = function (element) {\n      var css = {};\n      var dom = element.dom;\n      if (isSupported$1(dom)) {\n        for (var i = 0; i < dom.style.length; i++) {\n          var ruleName = dom.style.item(i);\n          css[ruleName] = dom.style[ruleName];\n        }\n      }\n      return css;\n    };\n    var isValidValue = function (tag, property, value) {\n      var element = SugarElement.fromTag(tag);\n      set$2(element, property, value);\n      var style = getRaw(element, property);\n      return style.isSome();\n    };\n    var remove$6 = function (element, property) {\n      var dom = element.dom;\n      internalRemove(dom, property);\n      if (getOpt(element, 'style').map(trim).is('')) {\n        remove$1(element, 'style');\n      }\n    };\n    var reflow = function (e) {\n      return e.dom.offsetWidth;\n    };\n\n    var get$6 = function (element) {\n      return element.dom.value;\n    };\n    var set$3 = function (element, value) {\n      if (value === undefined) {\n        throw new Error('Value.set was undefined');\n      }\n      element.dom.value = value;\n    };\n\n    var renderToDom = function (definition) {\n      var subject = SugarElement.fromTag(definition.tag);\n      setAll(subject, definition.attributes);\n      add$3(subject, definition.classes);\n      setAll$1(subject, definition.styles);\n      definition.innerHtml.each(function (html) {\n        return set(subject, html);\n      });\n      var children = definition.domChildren;\n      append$1(subject, children);\n      definition.value.each(function (value) {\n        set$3(subject, value);\n      });\n      if (!definition.uid) {\n        debugger;\n      }\n      writeOnly(subject, definition.uid);\n      return subject;\n    };\n\n    var getBehaviours$1 = function (spec) {\n      var behaviours = get$1(spec, 'behaviours').getOr({});\n      var keys$1 = filter(keys(behaviours), function (k) {\n        return behaviours[k] !== undefined;\n      });\n      return map(keys$1, function (k) {\n        return behaviours[k].me;\n      });\n    };\n    var generateFrom$1 = function (spec, all) {\n      return generateFrom(spec, all);\n    };\n    var generate$3 = function (spec) {\n      var all = getBehaviours$1(spec);\n      return generateFrom$1(spec, all);\n    };\n\n    var getDomDefinition = function (info, bList, bData) {\n      var definition = toDefinition(info);\n      var infoModification = toModification(info);\n      var baseModification = { 'alloy.base.modification': infoModification };\n      var modification = bList.length > 0 ? combine(bData, baseModification, bList, definition) : infoModification;\n      return merge$1(definition, modification);\n    };\n    var getEvents = function (info, bList, bData) {\n      var baseEvents = { 'alloy.base.behaviour': toEvents(info) };\n      return combine$1(bData, info.eventOrder, bList, baseEvents).getOrDie();\n    };\n    var build = function (spec) {\n      var getMe = function () {\n        return me;\n      };\n      var systemApi = Cell(singleton);\n      var info = getOrDie(toInfo(spec));\n      var bBlob = generate$3(spec);\n      var bList = getBehaviours(bBlob);\n      var bData = getData(bBlob);\n      var modDefinition = getDomDefinition(info, bList, bData);\n      var item = renderToDom(modDefinition);\n      var events = getEvents(info, bList, bData);\n      var subcomponents = Cell(info.components);\n      var connect = function (newApi) {\n        systemApi.set(newApi);\n      };\n      var disconnect = function () {\n        systemApi.set(NoContextApi(getMe));\n      };\n      var syncComponents = function () {\n        var children$1 = children(item);\n        var subs = bind(children$1, function (child) {\n          return systemApi.get().getByDom(child).fold(function () {\n            return [];\n          }, function (c) {\n            return [c];\n          });\n        });\n        subcomponents.set(subs);\n      };\n      var config = function (behaviour) {\n        var b = bData;\n        var f = isFunction(b[behaviour.name()]) ? b[behaviour.name()] : function () {\n          throw new Error('Could not find ' + behaviour.name() + ' in ' + JSON.stringify(spec, null, 2));\n        };\n        return f();\n      };\n      var hasConfigured = function (behaviour) {\n        return isFunction(bData[behaviour.name()]);\n      };\n      var getApis = function () {\n        return info.apis;\n      };\n      var readState = function (behaviourName) {\n        return bData[behaviourName]().map(function (b) {\n          return b.state.readState();\n        }).getOr('not enabled');\n      };\n      var me = {\n        getSystem: systemApi.get,\n        config: config,\n        hasConfigured: hasConfigured,\n        spec: spec,\n        readState: readState,\n        getApis: getApis,\n        connect: connect,\n        disconnect: disconnect,\n        element: item,\n        syncComponents: syncComponents,\n        components: subcomponents.get,\n        events: events\n      };\n      return me;\n    };\n\n    var buildSubcomponents = function (spec) {\n      var components = get$1(spec, 'components').getOr([]);\n      return map(components, build$1);\n    };\n    var buildFromSpec = function (userSpec) {\n      var _a = make(userSpec), specEvents = _a.events, spec = __rest(_a, ['events']);\n      var components = buildSubcomponents(spec);\n      var completeSpec = __assign(__assign({}, spec), {\n        events: __assign(__assign({}, DefaultEvents), specEvents),\n        components: components\n      });\n      return Result.value(build(completeSpec));\n    };\n    var text = function (textContent) {\n      var element = SugarElement.fromText(textContent);\n      return external({ element: element });\n    };\n    var external = function (spec) {\n      var extSpec = asRawOrDie('external.component', objOfOnly([\n        strict$1('element'),\n        option('uid')\n      ]), spec);\n      var systemApi = Cell(NoContextApi());\n      var connect = function (newApi) {\n        systemApi.set(newApi);\n      };\n      var disconnect = function () {\n        systemApi.set(NoContextApi(function () {\n          return me;\n        }));\n      };\n      extSpec.uid.each(function (uid) {\n        writeOnly(extSpec.element, uid);\n      });\n      var me = {\n        getSystem: systemApi.get,\n        config: Optional.none,\n        hasConfigured: never,\n        connect: connect,\n        disconnect: disconnect,\n        getApis: function () {\n          return {};\n        },\n        element: extSpec.element,\n        spec: spec,\n        readState: constant('No state'),\n        syncComponents: noop,\n        components: constant([]),\n        events: {}\n      };\n      return premade(me);\n    };\n    var uids = generate$2;\n    var build$1 = function (spec) {\n      return getPremade(spec).fold(function () {\n        var userSpecWithUid = spec.hasOwnProperty('uid') ? spec : __assign({ uid: uids('') }, spec);\n        return buildFromSpec(userSpecWithUid).getOrDie();\n      }, function (prebuilt) {\n        return prebuilt;\n      });\n    };\n    var premade$1 = premade;\n\n    var Dimension = function (name, getOffset) {\n      var set = function (element, h) {\n        if (!isNumber(h) && !h.match(/^[0-9]+$/)) {\n          throw new Error(name + '.set accepts only positive integer values. Value was ' + h);\n        }\n        var dom = element.dom;\n        if (isSupported$1(dom)) {\n          dom.style[name] = h + 'px';\n        }\n      };\n      var get = function (element) {\n        var r = getOffset(element);\n        if (r <= 0 || r === null) {\n          var css = get$5(element, name);\n          return parseFloat(css) || 0;\n        }\n        return r;\n      };\n      var getOuter = get;\n      var aggregate = function (element, properties) {\n        return foldl(properties, function (acc, property) {\n          var val = get$5(element, property);\n          var value = val === undefined ? 0 : parseInt(val, 10);\n          return isNaN(value) ? acc : acc + value;\n        }, 0);\n      };\n      var max = function (element, value, properties) {\n        var cumulativeInclusions = aggregate(element, properties);\n        var absoluteMax = value > cumulativeInclusions ? value - cumulativeInclusions : 0;\n        return absoluteMax;\n      };\n      return {\n        set: set,\n        get: get,\n        getOuter: getOuter,\n        aggregate: aggregate,\n        max: max\n      };\n    };\n\n    var api = Dimension('height', function (element) {\n      var dom = element.dom;\n      return inBody(element) ? dom.getBoundingClientRect().height : dom.offsetHeight;\n    });\n    var get$7 = function (element) {\n      return api.get(element);\n    };\n    var getOuter$1 = function (element) {\n      return api.getOuter(element);\n    };\n    var setMax = function (element, value) {\n      var inclusions = [\n        'margin-top',\n        'border-top-width',\n        'padding-top',\n        'padding-bottom',\n        'border-bottom-width',\n        'margin-bottom'\n      ];\n      var absMax = api.max(element, value, inclusions);\n      set$2(element, 'max-height', absMax + 'px');\n    };\n\n    var r = function (left, top) {\n      var translate = function (x, y) {\n        return r(left + x, top + y);\n      };\n      return {\n        left: left,\n        top: top,\n        translate: translate\n      };\n    };\n    var SugarPosition = r;\n\n    var boxPosition = function (dom) {\n      var box = dom.getBoundingClientRect();\n      return SugarPosition(box.left, box.top);\n    };\n    var firstDefinedOrZero = function (a, b) {\n      if (a !== undefined) {\n        return a;\n      } else {\n        return b !== undefined ? b : 0;\n      }\n    };\n    var absolute = function (element) {\n      var doc = element.dom.ownerDocument;\n      var body = doc.body;\n      var win = doc.defaultView;\n      var html = doc.documentElement;\n      if (body === element.dom) {\n        return SugarPosition(body.offsetLeft, body.offsetTop);\n      }\n      var scrollTop = firstDefinedOrZero(win === null || win === void 0 ? void 0 : win.pageYOffset, html.scrollTop);\n      var scrollLeft = firstDefinedOrZero(win === null || win === void 0 ? void 0 : win.pageXOffset, html.scrollLeft);\n      var clientTop = firstDefinedOrZero(html.clientTop, body.clientTop);\n      var clientLeft = firstDefinedOrZero(html.clientLeft, body.clientLeft);\n      return viewport(element).translate(scrollLeft - clientLeft, scrollTop - clientTop);\n    };\n    var viewport = function (element) {\n      var dom = element.dom;\n      var doc = dom.ownerDocument;\n      var body = doc.body;\n      if (body === dom) {\n        return SugarPosition(body.offsetLeft, body.offsetTop);\n      }\n      if (!inBody(element)) {\n        return SugarPosition(0, 0);\n      }\n      return boxPosition(dom);\n    };\n\n    var api$1 = Dimension('width', function (element) {\n      return element.dom.offsetWidth;\n    });\n    var set$4 = function (element, h) {\n      return api$1.set(element, h);\n    };\n    var get$8 = function (element) {\n      return api$1.get(element);\n    };\n    var getOuter$2 = function (element) {\n      return api$1.getOuter(element);\n    };\n    var setMax$1 = function (element, value) {\n      var inclusions = [\n        'margin-left',\n        'border-left-width',\n        'padding-left',\n        'padding-right',\n        'border-right-width',\n        'margin-right'\n      ];\n      var absMax = api$1.max(element, value, inclusions);\n      set$2(element, 'max-width', absMax + 'px');\n    };\n\n    var mkEvent = function (target, x, y, stop, prevent, kill, raw) {\n      return {\n        target: target,\n        x: x,\n        y: y,\n        stop: stop,\n        prevent: prevent,\n        kill: kill,\n        raw: raw\n      };\n    };\n    var fromRawEvent = function (rawEvent) {\n      var target = SugarElement.fromDom(getOriginalEventTarget(rawEvent).getOr(rawEvent.target));\n      var stop = function () {\n        return rawEvent.stopPropagation();\n      };\n      var prevent = function () {\n        return rawEvent.preventDefault();\n      };\n      var kill = compose(prevent, stop);\n      return mkEvent(target, rawEvent.clientX, rawEvent.clientY, stop, prevent, kill, rawEvent);\n    };\n    var handle = function (filter, handler) {\n      return function (rawEvent) {\n        if (filter(rawEvent)) {\n          handler(fromRawEvent(rawEvent));\n        }\n      };\n    };\n    var binder = function (element, event, filter, handler, useCapture) {\n      var wrapped = handle(filter, handler);\n      element.dom.addEventListener(event, wrapped, useCapture);\n      return { unbind: curry(unbind, element, event, wrapped, useCapture) };\n    };\n    var bind$2 = function (element, event, filter, handler) {\n      return binder(element, event, filter, handler, false);\n    };\n    var capture = function (element, event, filter, handler) {\n      return binder(element, event, filter, handler, true);\n    };\n    var unbind = function (element, event, handler, useCapture) {\n      element.dom.removeEventListener(event, handler, useCapture);\n    };\n\n    var get$9 = function (_DOC) {\n      var doc = _DOC !== undefined ? _DOC.dom : document;\n      var x = doc.body.scrollLeft || doc.documentElement.scrollLeft;\n      var y = doc.body.scrollTop || doc.documentElement.scrollTop;\n      return SugarPosition(x, y);\n    };\n    var to = function (x, y, _DOC) {\n      var doc = _DOC !== undefined ? _DOC.dom : document;\n      var win = doc.defaultView;\n      if (win) {\n        win.scrollTo(x, y);\n      }\n    };\n\n    var get$a = function (_win) {\n      var win = _win === undefined ? window : _win;\n      return Optional.from(win['visualViewport']);\n    };\n    var bounds = function (x, y, width, height) {\n      return {\n        x: x,\n        y: y,\n        width: width,\n        height: height,\n        right: x + width,\n        bottom: y + height\n      };\n    };\n    var getBounds = function (_win) {\n      var win = _win === undefined ? window : _win;\n      var doc = win.document;\n      var scroll = get$9(SugarElement.fromDom(doc));\n      return get$a(win).fold(function () {\n        var html = win.document.documentElement;\n        var width = html.clientWidth;\n        var height = html.clientHeight;\n        return bounds(scroll.left, scroll.top, width, height);\n      }, function (visualViewport) {\n        return bounds(Math.max(visualViewport.pageLeft, scroll.left), Math.max(visualViewport.pageTop, scroll.top), visualViewport.width, visualViewport.height);\n      });\n    };\n\n    var walkUp = function (navigation, doc) {\n      var frame = navigation.view(doc);\n      return frame.fold(constant([]), function (f) {\n        var parent = navigation.owner(f);\n        var rest = walkUp(navigation, parent);\n        return [f].concat(rest);\n      });\n    };\n    var pathTo = function (element, navigation) {\n      var d = navigation.owner(element);\n      var paths = walkUp(navigation, d);\n      return Optional.some(paths);\n    };\n\n    var view = function (doc) {\n      var _a;\n      var element = doc.dom === document ? Optional.none() : Optional.from((_a = doc.dom.defaultView) === null || _a === void 0 ? void 0 : _a.frameElement);\n      return element.map(SugarElement.fromDom);\n    };\n    var owner$1 = function (element) {\n      return owner(element);\n    };\n\n    var Navigation = /*#__PURE__*/Object.freeze({\n        __proto__: null,\n        view: view,\n        owner: owner$1\n    });\n\n    var find$3 = function (element) {\n      var doc = SugarElement.fromDom(document);\n      var scroll = get$9(doc);\n      var path = pathTo(element, Navigation);\n      return path.fold(curry(absolute, element), function (frames) {\n        var offset = viewport(element);\n        var r = foldr(frames, function (b, a) {\n          var loc = viewport(a);\n          return {\n            left: b.left + loc.left,\n            top: b.top + loc.top\n          };\n        }, {\n          left: 0,\n          top: 0\n        });\n        return SugarPosition(r.left + offset.left + scroll.left, r.top + offset.top + scroll.top);\n      });\n    };\n\n    var pointed = function (point, width, height) {\n      return {\n        point: point,\n        width: width,\n        height: height\n      };\n    };\n    var rect = function (x, y, width, height) {\n      return {\n        x: x,\n        y: y,\n        width: width,\n        height: height\n      };\n    };\n    var bounds$1 = function (x, y, width, height) {\n      return {\n        x: x,\n        y: y,\n        width: width,\n        height: height,\n        right: x + width,\n        bottom: y + height\n      };\n    };\n    var box = function (element) {\n      var xy = absolute(element);\n      var w = getOuter$2(element);\n      var h = getOuter$1(element);\n      return bounds$1(xy.left, xy.top, w, h);\n    };\n    var absolute$1 = function (element) {\n      var position = find$3(element);\n      var width = getOuter$2(element);\n      var height = getOuter$1(element);\n      return bounds$1(position.left, position.top, width, height);\n    };\n    var win = function () {\n      return getBounds(window);\n    };\n\n    function ClosestOrAncestor (is, ancestor, scope, a, isRoot) {\n      if (is(scope, a)) {\n        return Optional.some(scope);\n      } else if (isFunction(isRoot) && isRoot(scope)) {\n        return Optional.none();\n      } else {\n        return ancestor(scope, a, isRoot);\n      }\n    }\n\n    var ancestor$1 = function (scope, predicate, isRoot) {\n      var element = scope.dom;\n      var stop = isFunction(isRoot) ? isRoot : never;\n      while (element.parentNode) {\n        element = element.parentNode;\n        var el = SugarElement.fromDom(element);\n        if (predicate(el)) {\n          return Optional.some(el);\n        } else if (stop(el)) {\n          break;\n        }\n      }\n      return Optional.none();\n    };\n    var closest$1 = function (scope, predicate, isRoot) {\n      var is = function (s, test) {\n        return test(s);\n      };\n      return ClosestOrAncestor(is, ancestor$1, scope, predicate, isRoot);\n    };\n    var descendant = function (scope, predicate) {\n      var descend = function (node) {\n        for (var i = 0; i < node.childNodes.length; i++) {\n          var child_1 = SugarElement.fromDom(node.childNodes[i]);\n          if (predicate(child_1)) {\n            return Optional.some(child_1);\n          }\n          var res = descend(node.childNodes[i]);\n          if (res.isSome()) {\n            return res;\n          }\n        }\n        return Optional.none();\n      };\n      return descend(scope.dom);\n    };\n\n    var closest$2 = function (scope, predicate, isRoot) {\n      return closest$1(scope, predicate, isRoot).isSome();\n    };\n\n    var ancestor$2 = function (scope, selector, isRoot) {\n      return ancestor$1(scope, function (e) {\n        return is(e, selector);\n      }, isRoot);\n    };\n    var descendant$1 = function (scope, selector) {\n      return one(selector, scope);\n    };\n    var closest$3 = function (scope, selector, isRoot) {\n      var is$1 = function (element, selector) {\n        return is(element, selector);\n      };\n      return ClosestOrAncestor(is$1, ancestor$2, scope, selector, isRoot);\n    };\n\n    var find$4 = function (queryElem) {\n      var dependent = closest$1(queryElem, function (elem) {\n        if (!isElement(elem)) {\n          return false;\n        }\n        var id = get$3(elem, 'id');\n        return id !== undefined && id.indexOf('aria-owns') > -1;\n      });\n      return dependent.bind(function (dep) {\n        var id = get$3(dep, 'id');\n        var dos = getRootNode(dep);\n        return descendant$1(dos, '[aria-owns=\"' + id + '\"]');\n      });\n    };\n    var manager = function () {\n      var ariaId = generate$1('aria-owns');\n      var link = function (elem) {\n        set$1(elem, 'aria-owns', ariaId);\n      };\n      var unlink = function (elem) {\n        remove$1(elem, 'aria-owns');\n      };\n      return {\n        id: ariaId,\n        link: link,\n        unlink: unlink\n      };\n    };\n\n    var isAriaPartOf = function (component, queryElem) {\n      return find$4(queryElem).exists(function (owner) {\n        return isPartOf(component, owner);\n      });\n    };\n    var isPartOf = function (component, queryElem) {\n      return closest$2(queryElem, function (el) {\n        return eq$1(el, component.element);\n      }, never) || isAriaPartOf(component, queryElem);\n    };\n\n    var unknown$3 = 'unknown';\n    var EventConfiguration;\n    (function (EventConfiguration) {\n      EventConfiguration[EventConfiguration['STOP'] = 0] = 'STOP';\n      EventConfiguration[EventConfiguration['NORMAL'] = 1] = 'NORMAL';\n      EventConfiguration[EventConfiguration['LOGGING'] = 2] = 'LOGGING';\n    }(EventConfiguration || (EventConfiguration = {})));\n    var eventConfig = Cell({});\n    var makeEventLogger = function (eventName, initialTarget) {\n      var sequence = [];\n      var startTime = new Date().getTime();\n      return {\n        logEventCut: function (_name, target, purpose) {\n          sequence.push({\n            outcome: 'cut',\n            target: target,\n            purpose: purpose\n          });\n        },\n        logEventStopped: function (_name, target, purpose) {\n          sequence.push({\n            outcome: 'stopped',\n            target: target,\n            purpose: purpose\n          });\n        },\n        logNoParent: function (_name, target, purpose) {\n          sequence.push({\n            outcome: 'no-parent',\n            target: target,\n            purpose: purpose\n          });\n        },\n        logEventNoHandlers: function (_name, target) {\n          sequence.push({\n            outcome: 'no-handlers-left',\n            target: target\n          });\n        },\n        logEventResponse: function (_name, target, purpose) {\n          sequence.push({\n            outcome: 'response',\n            purpose: purpose,\n            target: target\n          });\n        },\n        write: function () {\n          var finishTime = new Date().getTime();\n          if (contains([\n              'mousemove',\n              'mouseover',\n              'mouseout',\n              systemInit()\n            ], eventName)) {\n            return;\n          }\n          console.log(eventName, {\n            event: eventName,\n            time: finishTime - startTime,\n            target: initialTarget.dom,\n            sequence: map(sequence, function (s) {\n              if (!contains([\n                  'cut',\n                  'stopped',\n                  'response'\n                ], s.outcome)) {\n                return s.outcome;\n              } else {\n                return '{' + s.purpose + '} ' + s.outcome + ' at (' + element(s.target) + ')';\n              }\n            })\n          });\n        }\n      };\n    };\n    var processEvent = function (eventName, initialTarget, f) {\n      var status = get$1(eventConfig.get(), eventName).orThunk(function () {\n        var patterns = keys(eventConfig.get());\n        return findMap(patterns, function (p) {\n          return eventName.indexOf(p) > -1 ? Optional.some(eventConfig.get()[p]) : Optional.none();\n        });\n      }).getOr(EventConfiguration.NORMAL);\n      switch (status) {\n      case EventConfiguration.NORMAL:\n        return f(noLogger());\n      case EventConfiguration.LOGGING: {\n          var logger = makeEventLogger(eventName, initialTarget);\n          var output = f(logger);\n          logger.write();\n          return output;\n        }\n      case EventConfiguration.STOP:\n        return true;\n      }\n    };\n    var path = [\n      'alloy/data/Fields',\n      'alloy/debugging/Debugging'\n    ];\n    var getTrace = function () {\n      var err = new Error();\n      if (err.stack !== undefined) {\n        var lines = err.stack.split('\\n');\n        return find(lines, function (line) {\n          return line.indexOf('alloy') > 0 && !exists(path, function (p) {\n            return line.indexOf(p) > -1;\n          });\n        }).getOr(unknown$3);\n      } else {\n        return unknown$3;\n      }\n    };\n    var ignoreEvent = {\n      logEventCut: noop,\n      logEventStopped: noop,\n      logNoParent: noop,\n      logEventNoHandlers: noop,\n      logEventResponse: noop,\n      write: noop\n    };\n    var monitorEvent = function (eventName, initialTarget, f) {\n      return processEvent(eventName, initialTarget, f);\n    };\n    var noLogger = constant(ignoreEvent);\n\n    var menuFields = constant([\n      strict$1('menu'),\n      strict$1('selectedMenu')\n    ]);\n    var itemFields = constant([\n      strict$1('item'),\n      strict$1('selectedItem')\n    ]);\n    var schema = constant(objOf(itemFields().concat(menuFields())));\n    var itemSchema = constant(objOf(itemFields()));\n\n    var _initSize = strictObjOf('initSize', [\n      strict$1('numColumns'),\n      strict$1('numRows')\n    ]);\n    var itemMarkers = function () {\n      return strictOf('markers', itemSchema());\n    };\n    var tieredMenuMarkers = function () {\n      return strictObjOf('markers', [strict$1('backgroundMenu')].concat(menuFields()).concat(itemFields()));\n    };\n    var markers = function (required) {\n      return strictObjOf('markers', map(required, strict$1));\n    };\n    var onPresenceHandler = function (label, fieldName, presence) {\n      var trace = getTrace();\n      return field(fieldName, fieldName, presence, valueOf(function (f) {\n        return Result.value(function () {\n          var args = [];\n          for (var _i = 0; _i < arguments.length; _i++) {\n            args[_i] = arguments[_i];\n          }\n          return f.apply(undefined, args);\n        });\n      }));\n    };\n    var onHandler = function (fieldName) {\n      return onPresenceHandler('onHandler', fieldName, defaulted(noop));\n    };\n    var onKeyboardHandler = function (fieldName) {\n      return onPresenceHandler('onKeyboardHandler', fieldName, defaulted(Optional.none));\n    };\n    var onStrictHandler = function (fieldName) {\n      return onPresenceHandler('onHandler', fieldName, strict());\n    };\n    var onStrictKeyboardHandler = function (fieldName) {\n      return onPresenceHandler('onKeyboardHandler', fieldName, strict());\n    };\n    var output = function (name, value) {\n      return state$1(name, constant(value));\n    };\n    var snapshot = function (name) {\n      return state$1(name, identity);\n    };\n    var initSize = constant(_initSize);\n\n    var nu$7 = function (x, y, bubble, direction, boundsRestriction, label) {\n      return {\n        x: x,\n        y: y,\n        bubble: bubble,\n        direction: direction,\n        boundsRestriction: boundsRestriction,\n        label: label\n      };\n    };\n\n    var adt$2 = Adt.generate([\n      { southeast: [] },\n      { southwest: [] },\n      { northeast: [] },\n      { northwest: [] },\n      { south: [] },\n      { north: [] },\n      { east: [] },\n      { west: [] }\n    ]);\n    var cata = function (subject, southeast, southwest, northeast, northwest, south, north, east, west) {\n      return subject.fold(southeast, southwest, northeast, northwest, south, north, east, west);\n    };\n    var cataVertical = function (subject, south, middle, north) {\n      return subject.fold(south, south, north, north, south, north, middle, middle);\n    };\n    var cataHorizontal = function (subject, east, middle, west) {\n      return subject.fold(east, west, east, west, middle, middle, east, west);\n    };\n    var southeast = adt$2.southeast;\n    var southwest = adt$2.southwest;\n    var northeast = adt$2.northeast;\n    var northwest = adt$2.northwest;\n    var south = adt$2.south;\n    var north = adt$2.north;\n    var east = adt$2.east;\n    var west = adt$2.west;\n\n    var getRestriction = function (anchor, restriction) {\n      switch (restriction) {\n      case 1:\n        return anchor.x;\n      case 0:\n        return anchor.x + anchor.width;\n      case 2:\n        return anchor.y;\n      case 3:\n        return anchor.y + anchor.height;\n      }\n    };\n    var boundsRestriction = function (anchor, restrictions) {\n      return mapToObject([\n        'left',\n        'right',\n        'top',\n        'bottom'\n      ], function (dir) {\n        return get$1(restrictions, dir).map(function (restriction) {\n          return getRestriction(anchor, restriction);\n        });\n      });\n    };\n    var adjustBounds = function (bounds, boundsRestrictions, bubbleOffsets) {\n      var applyRestriction = function (dir, current) {\n        var bubbleOffset = dir === 'top' || dir === 'bottom' ? bubbleOffsets.top : bubbleOffsets.left;\n        return get$1(boundsRestrictions, dir).bind(identity).bind(function (restriction) {\n          if (dir === 'left' || dir === 'top') {\n            return restriction >= current ? Optional.some(restriction) : Optional.none();\n          } else {\n            return restriction <= current ? Optional.some(restriction) : Optional.none();\n          }\n        }).map(function (restriction) {\n          return restriction + bubbleOffset;\n        }).getOr(current);\n      };\n      var adjustedLeft = applyRestriction('left', bounds.x);\n      var adjustedTop = applyRestriction('top', bounds.y);\n      var adjustedRight = applyRestriction('right', bounds.right);\n      var adjustedBottom = applyRestriction('bottom', bounds.bottom);\n      return bounds$1(adjustedLeft, adjustedTop, adjustedRight - adjustedLeft, adjustedBottom - adjustedTop);\n    };\n\n    var eastX = function (anchor) {\n      return anchor.x;\n    };\n    var middleX = function (anchor, element) {\n      return anchor.x + anchor.width / 2 - element.width / 2;\n    };\n    var westX = function (anchor, element) {\n      return anchor.x + anchor.width - element.width;\n    };\n    var northY = function (anchor, element) {\n      return anchor.y - element.height;\n    };\n    var southY = function (anchor) {\n      return anchor.y + anchor.height;\n    };\n    var centreY = function (anchor, element) {\n      return anchor.y + anchor.height / 2 - element.height / 2;\n    };\n    var eastEdgeX = function (anchor) {\n      return anchor.x + anchor.width;\n    };\n    var westEdgeX = function (anchor, element) {\n      return anchor.x - element.width;\n    };\n    var southeast$1 = function (anchor, element, bubbles) {\n      return nu$7(eastX(anchor), southY(anchor), bubbles.southeast(), southeast(), boundsRestriction(anchor, {\n        left: 1,\n        top: 3\n      }), 'layout-se');\n    };\n    var southwest$1 = function (anchor, element, bubbles) {\n      return nu$7(westX(anchor, element), southY(anchor), bubbles.southwest(), southwest(), boundsRestriction(anchor, {\n        right: 0,\n        top: 3\n      }), 'layout-sw');\n    };\n    var northeast$1 = function (anchor, element, bubbles) {\n      return nu$7(eastX(anchor), northY(anchor, element), bubbles.northeast(), northeast(), boundsRestriction(anchor, {\n        left: 1,\n        bottom: 2\n      }), 'layout-ne');\n    };\n    var northwest$1 = function (anchor, element, bubbles) {\n      return nu$7(westX(anchor, element), northY(anchor, element), bubbles.northwest(), northwest(), boundsRestriction(anchor, {\n        right: 0,\n        bottom: 2\n      }), 'layout-nw');\n    };\n    var north$1 = function (anchor, element, bubbles) {\n      return nu$7(middleX(anchor, element), northY(anchor, element), bubbles.north(), north(), boundsRestriction(anchor, { bottom: 2 }), 'layout-n');\n    };\n    var south$1 = function (anchor, element, bubbles) {\n      return nu$7(middleX(anchor, element), southY(anchor), bubbles.south(), south(), boundsRestriction(anchor, { top: 3 }), 'layout-s');\n    };\n    var east$1 = function (anchor, element, bubbles) {\n      return nu$7(eastEdgeX(anchor), centreY(anchor, element), bubbles.east(), east(), boundsRestriction(anchor, { left: 0 }), 'layout-e');\n    };\n    var west$1 = function (anchor, element, bubbles) {\n      return nu$7(westEdgeX(anchor, element), centreY(anchor, element), bubbles.west(), west(), boundsRestriction(anchor, { right: 1 }), 'layout-w');\n    };\n    var all$2 = function () {\n      return [\n        southeast$1,\n        southwest$1,\n        northeast$1,\n        northwest$1,\n        south$1,\n        north$1,\n        east$1,\n        west$1\n      ];\n    };\n    var allRtl = function () {\n      return [\n        southwest$1,\n        southeast$1,\n        northwest$1,\n        northeast$1,\n        south$1,\n        north$1,\n        east$1,\n        west$1\n      ];\n    };\n    var aboveOrBelow = function () {\n      return [\n        northeast$1,\n        northwest$1,\n        southeast$1,\n        southwest$1,\n        north$1,\n        south$1\n      ];\n    };\n    var aboveOrBelowRtl = function () {\n      return [\n        northwest$1,\n        northeast$1,\n        southwest$1,\n        southeast$1,\n        north$1,\n        south$1\n      ];\n    };\n    var belowOrAbove = function () {\n      return [\n        southeast$1,\n        southwest$1,\n        northeast$1,\n        northwest$1,\n        south$1,\n        north$1\n      ];\n    };\n    var belowOrAboveRtl = function () {\n      return [\n        southwest$1,\n        southeast$1,\n        northwest$1,\n        northeast$1,\n        south$1,\n        north$1\n      ];\n    };\n\n    var chooseChannels = function (channels, message) {\n      return message.universal ? channels : filter(channels, function (ch) {\n        return contains(message.channels, ch);\n      });\n    };\n    var events$1 = function (receiveConfig) {\n      return derive([run(receive(), function (component, message) {\n          var channelMap = receiveConfig.channels;\n          var channels = keys(channelMap);\n          var receivingData = message;\n          var targetChannels = chooseChannels(channels, receivingData);\n          each(targetChannels, function (ch) {\n            var channelInfo = channelMap[ch];\n            var channelSchema = channelInfo.schema;\n            var data = asRawOrDie('channel[' + ch + '] data\\nReceiver: ' + element(component.element), channelSchema, receivingData.data);\n            channelInfo.onReceive(component, data);\n          });\n        })]);\n    };\n\n    var ActiveReceiving = /*#__PURE__*/Object.freeze({\n        __proto__: null,\n        events: events$1\n    });\n\n    var ReceivingSchema = [strictOf('channels', setOf$1(Result.value, objOfOnly([\n        onStrictHandler('onReceive'),\n        defaulted$1('schema', anyValue$1())\n      ])))];\n\n    var executeEvent = function (bConfig, bState, executor) {\n      return runOnExecute(function (component) {\n        executor(component, bConfig, bState);\n      });\n    };\n    var loadEvent = function (bConfig, bState, f) {\n      return runOnInit(function (component, _simulatedEvent) {\n        f(component, bConfig, bState);\n      });\n    };\n    var create = function (schema, name, active, apis, extra, state) {\n      var configSchema = objOfOnly(schema);\n      var schemaSchema = optionObjOf(name, [optionObjOfOnly('config', schema)]);\n      return doCreate(configSchema, schemaSchema, name, active, apis, extra, state);\n    };\n    var createModes = function (modes, name, active, apis, extra, state) {\n      var configSchema = modes;\n      var schemaSchema = optionObjOf(name, [optionOf('config', modes)]);\n      return doCreate(configSchema, schemaSchema, name, active, apis, extra, state);\n    };\n    var wrapApi = function (bName, apiFunction, apiName) {\n      var f = function (component) {\n        var rest = [];\n        for (var _i = 1; _i < arguments.length; _i++) {\n          rest[_i - 1] = arguments[_i];\n        }\n        var args = [component].concat(rest);\n        return component.config({ name: constant(bName) }).fold(function () {\n          throw new Error('We could not find any behaviour configuration for: ' + bName + '. Using API: ' + apiName);\n        }, function (info) {\n          var rest = Array.prototype.slice.call(args, 1);\n          return apiFunction.apply(undefined, [\n            component,\n            info.config,\n            info.state\n          ].concat(rest));\n        });\n      };\n      return markAsBehaviourApi(f, apiName, apiFunction);\n    };\n    var revokeBehaviour = function (name) {\n      return {\n        key: name,\n        value: undefined\n      };\n    };\n    var doCreate = function (configSchema, schemaSchema, name, active, apis, extra, state) {\n      var getConfig = function (info) {\n        return hasNonNullableKey(info, name) ? info[name]() : Optional.none();\n      };\n      var wrappedApis = map$2(apis, function (apiF, apiName) {\n        return wrapApi(name, apiF, apiName);\n      });\n      var wrappedExtra = map$2(extra, function (extraF, extraName) {\n        return markAsExtraApi(extraF, extraName);\n      });\n      var me = __assign(__assign(__assign({}, wrappedExtra), wrappedApis), {\n        revoke: curry(revokeBehaviour, name),\n        config: function (spec) {\n          var prepared = asRawOrDie(name + '-config', configSchema, spec);\n          return {\n            key: name,\n            value: {\n              config: prepared,\n              me: me,\n              configAsRaw: cached(function () {\n                return asRawOrDie(name + '-config', configSchema, spec);\n              }),\n              initialConfig: spec,\n              state: state\n            }\n          };\n        },\n        schema: constant(schemaSchema),\n        exhibit: function (info, base) {\n          return getConfig(info).bind(function (behaviourInfo) {\n            return get$1(active, 'exhibit').map(function (exhibitor) {\n              return exhibitor(base, behaviourInfo.config, behaviourInfo.state);\n            });\n          }).getOr(nu$6({}));\n        },\n        name: constant(name),\n        handlers: function (info) {\n          return getConfig(info).map(function (behaviourInfo) {\n            var getEvents = get$1(active, 'events').getOr(function () {\n              return {};\n            });\n            return getEvents(behaviourInfo.config, behaviourInfo.state);\n          }).getOr({});\n        }\n      });\n      return me;\n    };\n\n    var derive$1 = function (capabilities) {\n      return wrapAll$1(capabilities);\n    };\n    var simpleSchema = objOfOnly([\n      strict$1('fields'),\n      strict$1('name'),\n      defaulted$1('active', {}),\n      defaulted$1('apis', {}),\n      defaulted$1('state', NoState),\n      defaulted$1('extra', {})\n    ]);\n    var create$1 = function (data) {\n      var value = asRawOrDie('Creating behaviour: ' + data.name, simpleSchema, data);\n      return create(value.fields, value.name, value.active, value.apis, value.extra, value.state);\n    };\n    var modeSchema = objOfOnly([\n      strict$1('branchKey'),\n      strict$1('branches'),\n      strict$1('name'),\n      defaulted$1('active', {}),\n      defaulted$1('apis', {}),\n      defaulted$1('state', NoState),\n      defaulted$1('extra', {})\n    ]);\n    var createModes$1 = function (data) {\n      var value = asRawOrDie('Creating behaviour: ' + data.name, modeSchema, data);\n      return createModes(choose$1(value.branchKey, value.branches), value.name, value.active, value.apis, value.extra, value.state);\n    };\n    var revoke = constant(undefined);\n\n    var Receiving = create$1({\n      fields: ReceivingSchema,\n      name: 'receiving',\n      active: ActiveReceiving\n    });\n\n    var exhibit = function (base, posConfig) {\n      return nu$6({\n        classes: [],\n        styles: posConfig.useFixed() ? {} : { position: 'relative' }\n      });\n    };\n\n    var ActivePosition = /*#__PURE__*/Object.freeze({\n        __proto__: null,\n        exhibit: exhibit\n    });\n\n    var getDocument = function () {\n      return SugarElement.fromDom(document);\n    };\n\n    var focus$1 = function (element) {\n      return element.dom.focus();\n    };\n    var blur = function (element) {\n      return element.dom.blur();\n    };\n    var hasFocus = function (element) {\n      var root = getRootNode(element).dom;\n      return element.dom === root.activeElement;\n    };\n    var active = function (root) {\n      if (root === void 0) {\n        root = getDocument();\n      }\n      return Optional.from(root.dom.activeElement).map(SugarElement.fromDom);\n    };\n    var search = function (element) {\n      return active(getRootNode(element)).filter(function (e) {\n        return element.dom.contains(e.dom);\n      });\n    };\n\n    var preserve = function (f, container) {\n      var dos = getRootNode(container);\n      var refocus = active(dos).bind(function (focused) {\n        var hasFocus = function (elem) {\n          return eq$1(focused, elem);\n        };\n        return hasFocus(container) ? Optional.some(container) : descendant(container, hasFocus);\n      });\n      var result = f(container);\n      refocus.each(function (oldFocus) {\n        active(dos).filter(function (newFocus) {\n          return eq$1(newFocus, oldFocus);\n        }).fold(function () {\n          focus$1(oldFocus);\n        }, noop);\n      });\n      return result;\n    };\n\n    var NuPositionCss = function (position, left, top, right, bottom) {\n      return {\n        position: position,\n        left: left,\n        top: top,\n        right: right,\n        bottom: bottom\n      };\n    };\n    var applyPositionCss = function (element, position) {\n      var addPx = function (num) {\n        return num + 'px';\n      };\n      setOptions(element, {\n        position: Optional.some(position.position),\n        left: position.left.map(addPx),\n        top: position.top.map(addPx),\n        right: position.right.map(addPx),\n        bottom: position.bottom.map(addPx)\n      });\n    };\n\n    var adt$3 = Adt.generate([\n      { none: [] },\n      {\n        relative: [\n          'x',\n          'y',\n          'width',\n          'height'\n        ]\n      },\n      {\n        fixed: [\n          'x',\n          'y',\n          'width',\n          'height'\n        ]\n      }\n    ]);\n    var positionWithDirection = function (posName, decision, x, y, width, height) {\n      var decisionX = decision.x - x;\n      var decisionY = decision.y - y;\n      var decisionWidth = decision.width;\n      var decisionHeight = decision.height;\n      var decisionRight = width - (decisionX + decisionWidth);\n      var decisionBottom = height - (decisionY + decisionHeight);\n      var left = Optional.some(decisionX);\n      var top = Optional.some(decisionY);\n      var right = Optional.some(decisionRight);\n      var bottom = Optional.some(decisionBottom);\n      var none = Optional.none();\n      return cata(decision.direction, function () {\n        return NuPositionCss(posName, left, top, none, none);\n      }, function () {\n        return NuPositionCss(posName, none, top, right, none);\n      }, function () {\n        return NuPositionCss(posName, left, none, none, bottom);\n      }, function () {\n        return NuPositionCss(posName, none, none, right, bottom);\n      }, function () {\n        return NuPositionCss(posName, left, top, none, none);\n      }, function () {\n        return NuPositionCss(posName, left, none, none, bottom);\n      }, function () {\n        return NuPositionCss(posName, left, top, none, none);\n      }, function () {\n        return NuPositionCss(posName, none, top, right, none);\n      });\n    };\n    var reposition = function (origin, decision) {\n      return origin.fold(function () {\n        return NuPositionCss('absolute', Optional.some(decision.x), Optional.some(decision.y), Optional.none(), Optional.none());\n      }, function (x, y, width, height) {\n        return positionWithDirection('absolute', decision, x, y, width, height);\n      }, function (x, y, width, height) {\n        return positionWithDirection('fixed', decision, x, y, width, height);\n      });\n    };\n    var toBox = function (origin, element) {\n      var rel = curry(find$3, element);\n      var position = origin.fold(rel, rel, function () {\n        var scroll = get$9();\n        return find$3(element).translate(-scroll.left, -scroll.top);\n      });\n      var width = getOuter$2(element);\n      var height = getOuter$1(element);\n      return bounds$1(position.left, position.top, width, height);\n    };\n    var viewport$1 = function (origin, getBounds) {\n      return getBounds.fold(function () {\n        return origin.fold(win, win, bounds$1);\n      }, function (b) {\n        return origin.fold(b, b, function () {\n          var bounds = b();\n          var pos = translate(origin, bounds.x, bounds.y);\n          return bounds$1(pos.left, pos.top, bounds.width, bounds.height);\n        });\n      });\n    };\n    var translate = function (origin, x, y) {\n      var pos = SugarPosition(x, y);\n      var removeScroll = function () {\n        var outerScroll = get$9();\n        return pos.translate(-outerScroll.left, -outerScroll.top);\n      };\n      return origin.fold(constant(pos), constant(pos), removeScroll);\n    };\n    var cata$1 = function (subject, onNone, onRelative, onFixed) {\n      return subject.fold(onNone, onRelative, onFixed);\n    };\n    var none$1 = adt$3.none;\n    var relative = adt$3.relative;\n    var fixed = adt$3.fixed;\n\n    var anchor = function (anchorBox, origin) {\n      return {\n        anchorBox: anchorBox,\n        origin: origin\n      };\n    };\n    var box$1 = function (anchorBox, origin) {\n      return anchor(anchorBox, origin);\n    };\n\n    var cycleBy = function (value, delta, min, max) {\n      var r = value + delta;\n      if (r > max) {\n        return min;\n      } else if (r < min) {\n        return max;\n      } else {\n        return r;\n      }\n    };\n    var clamp = function (value, min, max) {\n      return Math.min(Math.max(value, min), max);\n    };\n\n    var adt$4 = Adt.generate([\n      { fit: ['reposition'] },\n      {\n        nofit: [\n          'reposition',\n          'deltaW',\n          'deltaH'\n        ]\n      }\n    ]);\n    var calcReposition = function (newX, newY, width, height, bounds) {\n      var boundsX = bounds.x;\n      var boundsY = bounds.y;\n      var boundsWidth = bounds.width;\n      var boundsHeight = bounds.height;\n      var xInBounds = newX >= boundsX;\n      var yInBounds = newY >= boundsY;\n      var originInBounds = xInBounds && yInBounds;\n      var xFit = newX + width <= boundsX + boundsWidth;\n      var yFit = newY + height <= boundsY + boundsHeight;\n      var sizeInBounds = xFit && yFit;\n      var deltaW = Math.abs(Math.min(width, xInBounds ? boundsX + boundsWidth - newX : boundsX - (newX + width)));\n      var deltaH = Math.abs(Math.min(height, yInBounds ? boundsY + boundsHeight - newY : boundsY - (newY + height)));\n      var maxX = Math.max(bounds.x, bounds.right - width);\n      var maxY = Math.max(bounds.y, bounds.bottom - height);\n      var limitX = clamp(newX, bounds.x, maxX);\n      var limitY = clamp(newY, bounds.y, maxY);\n      return {\n        originInBounds: originInBounds,\n        sizeInBounds: sizeInBounds,\n        limitX: limitX,\n        limitY: limitY,\n        deltaW: deltaW,\n        deltaH: deltaH\n      };\n    };\n    var attempt = function (candidate, width, height, bounds) {\n      var candidateX = candidate.x;\n      var candidateY = candidate.y;\n      var bubbleOffsets = candidate.bubble.offset;\n      var bubbleLeft = bubbleOffsets.left;\n      var bubbleTop = bubbleOffsets.top;\n      var adjustedBounds = adjustBounds(bounds, candidate.boundsRestriction, bubbleOffsets);\n      var boundsY = adjustedBounds.y;\n      var boundsBottom = adjustedBounds.bottom;\n      var boundsX = adjustedBounds.x;\n      var boundsRight = adjustedBounds.right;\n      var newX = candidateX + bubbleLeft;\n      var newY = candidateY + bubbleTop;\n      var _a = calcReposition(newX, newY, width, height, adjustedBounds), originInBounds = _a.originInBounds, sizeInBounds = _a.sizeInBounds, limitX = _a.limitX, limitY = _a.limitY, deltaW = _a.deltaW, deltaH = _a.deltaH;\n      var upAvailable = constant(limitY + deltaH - boundsY);\n      var downAvailable = constant(boundsBottom - limitY);\n      var maxHeight = cataVertical(candidate.direction, downAvailable, downAvailable, upAvailable);\n      var westAvailable = constant(limitX + deltaW - boundsX);\n      var eastAvailable = constant(boundsRight - limitX);\n      var maxWidth = cataHorizontal(candidate.direction, eastAvailable, eastAvailable, westAvailable);\n      var reposition = {\n        x: limitX,\n        y: limitY,\n        width: deltaW,\n        height: deltaH,\n        maxHeight: maxHeight,\n        maxWidth: maxWidth,\n        direction: candidate.direction,\n        classes: {\n          on: candidate.bubble.classesOn,\n          off: candidate.bubble.classesOff\n        },\n        label: candidate.label,\n        candidateYforTest: newY\n      };\n      return originInBounds && sizeInBounds ? adt$4.fit(reposition) : adt$4.nofit(reposition, deltaW, deltaH);\n    };\n    var attempts = function (candidates, anchorBox, elementBox, bubbles, bounds) {\n      var panelWidth = elementBox.width;\n      var panelHeight = elementBox.height;\n      var attemptBestFit = function (layout, reposition, deltaW, deltaH) {\n        var next = layout(anchorBox, elementBox, bubbles);\n        var attemptLayout = attempt(next, panelWidth, panelHeight, bounds);\n        return attemptLayout.fold(adt$4.fit, function (newReposition, newDeltaW, newDeltaH) {\n          var improved = newDeltaH > deltaH || newDeltaW > deltaW;\n          return improved ? adt$4.nofit(newReposition, newDeltaW, newDeltaH) : adt$4.nofit(reposition, deltaW, deltaH);\n        });\n      };\n      var abc = foldl(candidates, function (b, a) {\n        var bestNext = curry(attemptBestFit, a);\n        return b.fold(adt$4.fit, bestNext);\n      }, adt$4.nofit({\n        x: anchorBox.x,\n        y: anchorBox.y,\n        width: elementBox.width,\n        height: elementBox.height,\n        maxHeight: elementBox.height,\n        maxWidth: elementBox.width,\n        direction: southeast(),\n        classes: {\n          on: [],\n          off: []\n        },\n        label: 'none',\n        candidateYforTest: anchorBox.y\n      }, -1, -1));\n      return abc.fold(identity, identity);\n    };\n\n    var elementSize = function (p) {\n      return {\n        width: getOuter$2(p),\n        height: getOuter$1(p)\n      };\n    };\n    var layout = function (anchorBox, element, bubbles, options) {\n      remove$6(element, 'max-height');\n      remove$6(element, 'max-width');\n      var elementBox = elementSize(element);\n      return attempts(options.preference, anchorBox, elementBox, bubbles, options.bounds);\n    };\n    var setClasses = function (element, decision) {\n      var classInfo = decision.classes;\n      remove$5(element, classInfo.off);\n      add$3(element, classInfo.on);\n    };\n    var setHeight = function (element, decision, options) {\n      var maxHeightFunction = options.maxHeightFunction;\n      maxHeightFunction(element, decision.maxHeight);\n    };\n    var setWidth = function (element, decision, options) {\n      var maxWidthFunction = options.maxWidthFunction;\n      maxWidthFunction(element, decision.maxWidth);\n    };\n    var position = function (element, decision, options) {\n      applyPositionCss(element, reposition(options.origin, decision));\n    };\n\n    var setMaxHeight = function (element, maxHeight) {\n      setMax(element, Math.floor(maxHeight));\n    };\n    var anchored = constant(function (element, available) {\n      setMaxHeight(element, available);\n      setAll$1(element, {\n        'overflow-x': 'hidden',\n        'overflow-y': 'auto'\n      });\n    });\n    var expandable = constant(function (element, available) {\n      setMaxHeight(element, available);\n    });\n\n    var defaultOr = function (options, key, dephault) {\n      return options[key] === undefined ? dephault : options[key];\n    };\n    var simple = function (anchor, element, bubble, layouts, getBounds, overrideOptions) {\n      var maxHeightFunction = defaultOr(overrideOptions, 'maxHeightFunction', anchored());\n      var maxWidthFunction = defaultOr(overrideOptions, 'maxWidthFunction', noop);\n      var anchorBox = anchor.anchorBox;\n      var origin = anchor.origin;\n      var options = {\n        bounds: viewport$1(origin, getBounds),\n        origin: origin,\n        preference: layouts,\n        maxHeightFunction: maxHeightFunction,\n        maxWidthFunction: maxWidthFunction\n      };\n      go(anchorBox, element, bubble, options);\n    };\n    var go = function (anchorBox, element, bubble, options) {\n      var decision = layout(anchorBox, element, bubble, options);\n      position(element, decision, options);\n      setClasses(element, decision);\n      setHeight(element, decision, options);\n      setWidth(element, decision, options);\n    };\n\n    var allAlignments = [\n      'valignCentre',\n      'alignLeft',\n      'alignRight',\n      'alignCentre',\n      'top',\n      'bottom',\n      'left',\n      'right'\n    ];\n    var nu$8 = function (width, yoffset, classes) {\n      var getClasses = function (prop) {\n        return get$1(classes, prop).getOr([]);\n      };\n      var make = function (xDelta, yDelta, alignmentsOn) {\n        var alignmentsOff = difference(allAlignments, alignmentsOn);\n        return {\n          offset: SugarPosition(xDelta, yDelta),\n          classesOn: bind(alignmentsOn, getClasses),\n          classesOff: bind(alignmentsOff, getClasses)\n        };\n      };\n      return {\n        southeast: function () {\n          return make(-width, yoffset, [\n            'top',\n            'alignLeft'\n          ]);\n        },\n        southwest: function () {\n          return make(width, yoffset, [\n            'top',\n            'alignRight'\n          ]);\n        },\n        south: function () {\n          return make(-width / 2, yoffset, [\n            'top',\n            'alignCentre'\n          ]);\n        },\n        northeast: function () {\n          return make(-width, -yoffset, [\n            'bottom',\n            'alignLeft'\n          ]);\n        },\n        northwest: function () {\n          return make(width, -yoffset, [\n            'bottom',\n            'alignRight'\n          ]);\n        },\n        north: function () {\n          return make(-width / 2, -yoffset, [\n            'bottom',\n            'alignCentre'\n          ]);\n        },\n        east: function () {\n          return make(width, -yoffset / 2, [\n            'valignCentre',\n            'left'\n          ]);\n        },\n        west: function () {\n          return make(-width, -yoffset / 2, [\n            'valignCentre',\n            'right'\n          ]);\n        },\n        innerNorthwest: function () {\n          return make(-width, yoffset, [\n            'top',\n            'alignRight'\n          ]);\n        },\n        innerNortheast: function () {\n          return make(width, yoffset, [\n            'top',\n            'alignLeft'\n          ]);\n        },\n        innerNorth: function () {\n          return make(-width / 2, yoffset, [\n            'top',\n            'alignCentre'\n          ]);\n        },\n        innerSouthwest: function () {\n          return make(-width, -yoffset, [\n            'bottom',\n            'alignRight'\n          ]);\n        },\n        innerSoutheast: function () {\n          return make(width, -yoffset, [\n            'bottom',\n            'alignLeft'\n          ]);\n        },\n        innerSouth: function () {\n          return make(-width / 2, -yoffset, [\n            'bottom',\n            'alignCentre'\n          ]);\n        },\n        innerWest: function () {\n          return make(width, -yoffset / 2, [\n            'valignCentre',\n            'right'\n          ]);\n        },\n        innerEast: function () {\n          return make(-width, -yoffset / 2, [\n            'valignCentre',\n            'left'\n          ]);\n        }\n      };\n    };\n    var fallback = function () {\n      return nu$8(0, 0, {});\n    };\n\n    var nu$9 = function (x) {\n      return x;\n    };\n\n    var onDirection = function (isLtr, isRtl) {\n      return function (element) {\n        return getDirection(element) === 'rtl' ? isRtl : isLtr;\n      };\n    };\n    var getDirection = function (element) {\n      return get$5(element, 'direction') === 'rtl' ? 'rtl' : 'ltr';\n    };\n\n    var AttributeValue;\n    (function (AttributeValue) {\n      AttributeValue['TopToBottom'] = 'toptobottom';\n      AttributeValue['BottomToTop'] = 'bottomtotop';\n    }(AttributeValue || (AttributeValue = {})));\n    var Attribute = 'data-alloy-vertical-dir';\n    var isBottomToTopDir = function (el) {\n      return closest$2(el, function (current) {\n        return isElement(current) && get$3(current, 'data-alloy-vertical-dir') === AttributeValue.BottomToTop;\n      });\n    };\n\n    var schema$1 = function () {\n      return optionObjOf('layouts', [\n        strict$1('onLtr'),\n        strict$1('onRtl'),\n        option('onBottomLtr'),\n        option('onBottomRtl')\n      ]);\n    };\n    var get$b = function (elem, info, defaultLtr, defaultRtl, defaultBottomLtr, defaultBottomRtl, dirElement) {\n      var isBottomToTop = dirElement.map(isBottomToTopDir).getOr(false);\n      var customLtr = info.layouts.map(function (ls) {\n        return ls.onLtr(elem);\n      });\n      var customRtl = info.layouts.map(function (ls) {\n        return ls.onRtl(elem);\n      });\n      var ltr = isBottomToTop ? info.layouts.bind(function (ls) {\n        return ls.onBottomLtr.map(function (f) {\n          return f(elem);\n        });\n      }).or(customLtr).getOr(defaultBottomLtr) : customLtr.getOr(defaultLtr);\n      var rtl = isBottomToTop ? info.layouts.bind(function (ls) {\n        return ls.onBottomRtl.map(function (f) {\n          return f(elem);\n        });\n      }).or(customRtl).getOr(defaultBottomRtl) : customRtl.getOr(defaultRtl);\n      var f = onDirection(ltr, rtl);\n      return f(elem);\n    };\n\n    var placement = function (component, anchorInfo, origin) {\n      var hotspot = anchorInfo.hotspot;\n      var anchorBox = toBox(origin, hotspot.element);\n      var layouts = get$b(component.element, anchorInfo, belowOrAbove(), belowOrAboveRtl(), aboveOrBelow(), aboveOrBelowRtl(), Optional.some(anchorInfo.hotspot.element));\n      return Optional.some(nu$9({\n        anchorBox: anchorBox,\n        bubble: anchorInfo.bubble.getOr(fallback()),\n        overrides: anchorInfo.overrides,\n        layouts: layouts,\n        placer: Optional.none()\n      }));\n    };\n    var HotspotAnchor = [\n      strict$1('hotspot'),\n      option('bubble'),\n      defaulted$1('overrides', {}),\n      schema$1(),\n      output('placement', placement)\n    ];\n\n    var placement$1 = function (component, anchorInfo, origin) {\n      var pos = translate(origin, anchorInfo.x, anchorInfo.y);\n      var anchorBox = bounds$1(pos.left, pos.top, anchorInfo.width, anchorInfo.height);\n      var layouts = get$b(component.element, anchorInfo, all$2(), allRtl(), all$2(), allRtl(), Optional.none());\n      return Optional.some(nu$9({\n        anchorBox: anchorBox,\n        bubble: anchorInfo.bubble,\n        overrides: anchorInfo.overrides,\n        layouts: layouts,\n        placer: Optional.none()\n      }));\n    };\n    var MakeshiftAnchor = [\n      strict$1('x'),\n      strict$1('y'),\n      defaulted$1('height', 0),\n      defaulted$1('width', 0),\n      defaulted$1('bubble', fallback()),\n      defaulted$1('overrides', {}),\n      schema$1(),\n      output('placement', placement$1)\n    ];\n\n    var adt$5 = Adt.generate([\n      { screen: ['point'] },\n      {\n        absolute: [\n          'point',\n          'scrollLeft',\n          'scrollTop'\n        ]\n      }\n    ]);\n    var toFixed = function (pos) {\n      return pos.fold(identity, function (point, scrollLeft, scrollTop) {\n        return point.translate(-scrollLeft, -scrollTop);\n      });\n    };\n    var toAbsolute = function (pos) {\n      return pos.fold(identity, identity);\n    };\n    var sum = function (points) {\n      return foldl(points, function (b, a) {\n        return b.translate(a.left, a.top);\n      }, SugarPosition(0, 0));\n    };\n    var sumAsFixed = function (positions) {\n      var points = map(positions, toFixed);\n      return sum(points);\n    };\n    var sumAsAbsolute = function (positions) {\n      var points = map(positions, toAbsolute);\n      return sum(points);\n    };\n    var screen = adt$5.screen;\n    var absolute$2 = adt$5.absolute;\n\n    var getOffset = function (component, origin, anchorInfo) {\n      var win = defaultView(anchorInfo.root).dom;\n      var hasSameOwner = function (frame) {\n        var frameOwner = owner(frame);\n        var compOwner = owner(component.element);\n        return eq$1(frameOwner, compOwner);\n      };\n      return Optional.from(win.frameElement).map(SugarElement.fromDom).filter(hasSameOwner).map(absolute);\n    };\n    var getRootPoint = function (component, origin, anchorInfo) {\n      var doc = owner(component.element);\n      var outerScroll = get$9(doc);\n      var offset = getOffset(component, origin, anchorInfo).getOr(outerScroll);\n      return absolute$2(offset, outerScroll.left, outerScroll.top);\n    };\n\n    var capRect = function (left, top, width, height) {\n      var newLeft = left, newTop = top, newWidth = width, newHeight = height;\n      if (left < 0) {\n        newLeft = 0;\n        newWidth = width + left;\n      }\n      if (top < 0) {\n        newTop = 0;\n        newHeight = height + top;\n      }\n      var point = screen(SugarPosition(newLeft, newTop));\n      return Optional.some(pointed(point, newWidth, newHeight));\n    };\n    var calcNewAnchor = function (optBox, rootPoint, anchorInfo, origin, elem) {\n      return optBox.map(function (box) {\n        var points = [\n          rootPoint,\n          box.point\n        ];\n        var topLeft = cata$1(origin, function () {\n          return sumAsAbsolute(points);\n        }, function () {\n          return sumAsAbsolute(points);\n        }, function () {\n          return sumAsFixed(points);\n        });\n        var anchorBox = rect(topLeft.left, topLeft.top, box.width, box.height);\n        var layoutsLtr = anchorInfo.showAbove ? aboveOrBelow() : belowOrAbove();\n        var layoutsRtl = anchorInfo.showAbove ? aboveOrBelowRtl() : belowOrAboveRtl();\n        var layouts = get$b(elem, anchorInfo, layoutsLtr, layoutsRtl, layoutsLtr, layoutsRtl, Optional.none());\n        return nu$9({\n          anchorBox: anchorBox,\n          bubble: anchorInfo.bubble.getOr(fallback()),\n          overrides: anchorInfo.overrides,\n          layouts: layouts,\n          placer: Optional.none()\n        });\n      });\n    };\n\n    var placement$2 = function (component, anchorInfo, origin) {\n      var rootPoint = getRootPoint(component, origin, anchorInfo);\n      return anchorInfo.node.filter(inBody).bind(function (target) {\n        var rect = target.dom.getBoundingClientRect();\n        var nodeBox = capRect(rect.left, rect.top, rect.width, rect.height);\n        var elem = anchorInfo.node.getOr(component.element);\n        return calcNewAnchor(nodeBox, rootPoint, anchorInfo, origin, elem);\n      });\n    };\n    var NodeAnchor = [\n      strict$1('node'),\n      strict$1('root'),\n      option('bubble'),\n      schema$1(),\n      defaulted$1('overrides', {}),\n      defaulted$1('showAbove', false),\n      output('placement', placement$2)\n    ];\n\n    var zeroWidth = '\\uFEFF';\n    var nbsp = '\\xA0';\n\n    var create$2 = function (start, soffset, finish, foffset) {\n      return {\n        start: start,\n        soffset: soffset,\n        finish: finish,\n        foffset: foffset\n      };\n    };\n    var SimRange = { create: create$2 };\n\n    var adt$6 = Adt.generate([\n      { before: ['element'] },\n      {\n        on: [\n          'element',\n          'offset'\n        ]\n      },\n      { after: ['element'] }\n    ]);\n    var cata$2 = function (subject, onBefore, onOn, onAfter) {\n      return subject.fold(onBefore, onOn, onAfter);\n    };\n    var getStart = function (situ) {\n      return situ.fold(identity, identity, identity);\n    };\n    var before$2 = adt$6.before;\n    var on = adt$6.on;\n    var after$1 = adt$6.after;\n    var Situ = {\n      before: before$2,\n      on: on,\n      after: after$1,\n      cata: cata$2,\n      getStart: getStart\n    };\n\n    var adt$7 = Adt.generate([\n      { domRange: ['rng'] },\n      {\n        relative: [\n          'startSitu',\n          'finishSitu'\n        ]\n      },\n      {\n        exact: [\n          'start',\n          'soffset',\n          'finish',\n          'foffset'\n        ]\n      }\n    ]);\n    var exactFromRange = function (simRange) {\n      return adt$7.exact(simRange.start, simRange.soffset, simRange.finish, simRange.foffset);\n    };\n    var getStart$1 = function (selection) {\n      return selection.match({\n        domRange: function (rng) {\n          return SugarElement.fromDom(rng.startContainer);\n        },\n        relative: function (startSitu, _finishSitu) {\n          return Situ.getStart(startSitu);\n        },\n        exact: function (start, _soffset, _finish, _foffset) {\n          return start;\n        }\n      });\n    };\n    var domRange = adt$7.domRange;\n    var relative$1 = adt$7.relative;\n    var exact = adt$7.exact;\n    var getWin = function (selection) {\n      var start = getStart$1(selection);\n      return defaultView(start);\n    };\n    var range$1 = SimRange.create;\n    var SimSelection = {\n      domRange: domRange,\n      relative: relative$1,\n      exact: exact,\n      exactFromRange: exactFromRange,\n      getWin: getWin,\n      range: range$1\n    };\n\n    var setStart = function (rng, situ) {\n      situ.fold(function (e) {\n        rng.setStartBefore(e.dom);\n      }, function (e, o) {\n        rng.setStart(e.dom, o);\n      }, function (e) {\n        rng.setStartAfter(e.dom);\n      });\n    };\n    var setFinish = function (rng, situ) {\n      situ.fold(function (e) {\n        rng.setEndBefore(e.dom);\n      }, function (e, o) {\n        rng.setEnd(e.dom, o);\n      }, function (e) {\n        rng.setEndAfter(e.dom);\n      });\n    };\n    var relativeToNative = function (win, startSitu, finishSitu) {\n      var range = win.document.createRange();\n      setStart(range, startSitu);\n      setFinish(range, finishSitu);\n      return range;\n    };\n    var exactToNative = function (win, start, soffset, finish, foffset) {\n      var rng = win.document.createRange();\n      rng.setStart(start.dom, soffset);\n      rng.setEnd(finish.dom, foffset);\n      return rng;\n    };\n    var toRect = function (rect) {\n      return {\n        left: rect.left,\n        top: rect.top,\n        right: rect.right,\n        bottom: rect.bottom,\n        width: rect.width,\n        height: rect.height\n      };\n    };\n    var getFirstRect = function (rng) {\n      var rects = rng.getClientRects();\n      var rect = rects.length > 0 ? rects[0] : rng.getBoundingClientRect();\n      return rect.width > 0 || rect.height > 0 ? Optional.some(rect).map(toRect) : Optional.none();\n    };\n\n    var adt$8 = Adt.generate([\n      {\n        ltr: [\n          'start',\n          'soffset',\n          'finish',\n          'foffset'\n        ]\n      },\n      {\n        rtl: [\n          'start',\n          'soffset',\n          'finish',\n          'foffset'\n        ]\n      }\n    ]);\n    var fromRange = function (win, type, range) {\n      return type(SugarElement.fromDom(range.startContainer), range.startOffset, SugarElement.fromDom(range.endContainer), range.endOffset);\n    };\n    var getRanges = function (win, selection) {\n      return selection.match({\n        domRange: function (rng) {\n          return {\n            ltr: constant(rng),\n            rtl: Optional.none\n          };\n        },\n        relative: function (startSitu, finishSitu) {\n          return {\n            ltr: cached(function () {\n              return relativeToNative(win, startSitu, finishSitu);\n            }),\n            rtl: cached(function () {\n              return Optional.some(relativeToNative(win, finishSitu, startSitu));\n            })\n          };\n        },\n        exact: function (start, soffset, finish, foffset) {\n          return {\n            ltr: cached(function () {\n              return exactToNative(win, start, soffset, finish, foffset);\n            }),\n            rtl: cached(function () {\n              return Optional.some(exactToNative(win, finish, foffset, start, soffset));\n            })\n          };\n        }\n      });\n    };\n    var doDiagnose = function (win, ranges) {\n      var rng = ranges.ltr();\n      if (rng.collapsed) {\n        var reversed = ranges.rtl().filter(function (rev) {\n          return rev.collapsed === false;\n        });\n        return reversed.map(function (rev) {\n          return adt$8.rtl(SugarElement.fromDom(rev.endContainer), rev.endOffset, SugarElement.fromDom(rev.startContainer), rev.startOffset);\n        }).getOrThunk(function () {\n          return fromRange(win, adt$8.ltr, rng);\n        });\n      } else {\n        return fromRange(win, adt$8.ltr, rng);\n      }\n    };\n    var diagnose = function (win, selection) {\n      var ranges = getRanges(win, selection);\n      return doDiagnose(win, ranges);\n    };\n    var asLtrRange = function (win, selection) {\n      var diagnosis = diagnose(win, selection);\n      return diagnosis.match({\n        ltr: function (start, soffset, finish, foffset) {\n          var rng = win.document.createRange();\n          rng.setStart(start.dom, soffset);\n          rng.setEnd(finish.dom, foffset);\n          return rng;\n        },\n        rtl: function (start, soffset, finish, foffset) {\n          var rng = win.document.createRange();\n          rng.setStart(finish.dom, foffset);\n          rng.setEnd(start.dom, soffset);\n          return rng;\n        }\n      });\n    };\n    var ltr = adt$8.ltr;\n    var rtl = adt$8.rtl;\n\n    var NodeValue = function (is, name) {\n      var get = function (element) {\n        if (!is(element)) {\n          throw new Error('Can only get ' + name + ' value of a ' + name + ' node');\n        }\n        return getOption(element).getOr('');\n      };\n      var getOption = function (element) {\n        return is(element) ? Optional.from(element.dom.nodeValue) : Optional.none();\n      };\n      var set = function (element, value) {\n        if (!is(element)) {\n          throw new Error('Can only set raw ' + name + ' value of a ' + name + ' node');\n        }\n        element.dom.nodeValue = value;\n      };\n      return {\n        get: get,\n        getOption: getOption,\n        set: set\n      };\n    };\n\n    var api$2 = NodeValue(isText, 'text');\n    var get$c = function (element) {\n      return api$2.get(element);\n    };\n    var getOption = function (element) {\n      return api$2.getOption(element);\n    };\n\n    var getEnd = function (element) {\n      return name(element) === 'img' ? 1 : getOption(element).fold(function () {\n        return children(element).length;\n      }, function (v) {\n        return v.length;\n      });\n    };\n    var isTextNodeWithCursorPosition = function (el) {\n      return getOption(el).filter(function (text) {\n        return text.trim().length !== 0 || text.indexOf(nbsp) > -1;\n      }).isSome();\n    };\n    var elementsWithCursorPosition = [\n      'img',\n      'br'\n    ];\n    var isCursorPosition = function (elem) {\n      var hasCursorPosition = isTextNodeWithCursorPosition(elem);\n      return hasCursorPosition || contains(elementsWithCursorPosition, name(elem));\n    };\n\n    var last$1 = function (element) {\n      return descendantRtl(element, isCursorPosition);\n    };\n    var descendantRtl = function (scope, predicate) {\n      var descend = function (element) {\n        var children$1 = children(element);\n        for (var i = children$1.length - 1; i >= 0; i--) {\n          var child = children$1[i];\n          if (predicate(child)) {\n            return Optional.some(child);\n          }\n          var res = descend(child);\n          if (res.isSome()) {\n            return res;\n          }\n        }\n        return Optional.none();\n      };\n      return descend(scope);\n    };\n\n    var descendants = function (scope, selector) {\n      return all(selector, scope);\n    };\n\n    var makeRange = function (start, soffset, finish, foffset) {\n      var doc = owner(start);\n      var rng = doc.dom.createRange();\n      rng.setStart(start.dom, soffset);\n      rng.setEnd(finish.dom, foffset);\n      return rng;\n    };\n    var after$2 = function (start, soffset, finish, foffset) {\n      var r = makeRange(start, soffset, finish, foffset);\n      var same = eq$1(start, finish) && soffset === foffset;\n      return r.collapsed && !same;\n    };\n\n    var getNativeSelection = function (win) {\n      return Optional.from(win.getSelection());\n    };\n    var readRange = function (selection) {\n      if (selection.rangeCount > 0) {\n        var firstRng = selection.getRangeAt(0);\n        var lastRng = selection.getRangeAt(selection.rangeCount - 1);\n        return Optional.some(SimRange.create(SugarElement.fromDom(firstRng.startContainer), firstRng.startOffset, SugarElement.fromDom(lastRng.endContainer), lastRng.endOffset));\n      } else {\n        return Optional.none();\n      }\n    };\n    var doGetExact = function (selection) {\n      if (selection.anchorNode === null || selection.focusNode === null) {\n        return readRange(selection);\n      } else {\n        var anchor = SugarElement.fromDom(selection.anchorNode);\n        var focus_1 = SugarElement.fromDom(selection.focusNode);\n        return after$2(anchor, selection.anchorOffset, focus_1, selection.focusOffset) ? Optional.some(SimRange.create(anchor, selection.anchorOffset, focus_1, selection.focusOffset)) : readRange(selection);\n      }\n    };\n    var getExact = function (win) {\n      return getNativeSelection(win).filter(function (sel) {\n        return sel.rangeCount > 0;\n      }).bind(doGetExact);\n    };\n    var getFirstRect$1 = function (win, selection) {\n      var rng = asLtrRange(win, selection);\n      return getFirstRect(rng);\n    };\n\n    var point = function (element, offset) {\n      return {\n        element: element,\n        offset: offset\n      };\n    };\n    var descendOnce = function (element, offset) {\n      var children$1 = children(element);\n      if (children$1.length === 0) {\n        return point(element, offset);\n      } else if (offset < children$1.length) {\n        return point(children$1[offset], 0);\n      } else {\n        var last = children$1[children$1.length - 1];\n        var len = isText(last) ? get$c(last).length : children(last).length;\n        return point(last, len);\n      }\n    };\n\n    var descendOnce$1 = function (element, offset) {\n      return isText(element) ? point(element, offset) : descendOnce(element, offset);\n    };\n    var getAnchorSelection = function (win, anchorInfo) {\n      var getSelection = anchorInfo.getSelection.getOrThunk(function () {\n        return function () {\n          return getExact(win);\n        };\n      });\n      return getSelection().map(function (sel) {\n        var modStart = descendOnce$1(sel.start, sel.soffset);\n        var modFinish = descendOnce$1(sel.finish, sel.foffset);\n        return SimSelection.range(modStart.element, modStart.offset, modFinish.element, modFinish.offset);\n      });\n    };\n    var placement$3 = function (component, anchorInfo, origin) {\n      var win = defaultView(anchorInfo.root).dom;\n      var rootPoint = getRootPoint(component, origin, anchorInfo);\n      var selectionBox = getAnchorSelection(win, anchorInfo).bind(function (sel) {\n        var optRect = getFirstRect$1(win, SimSelection.exactFromRange(sel)).orThunk(function () {\n          var x = SugarElement.fromText(zeroWidth);\n          before(sel.start, x);\n          return getFirstRect$1(win, SimSelection.exact(x, 0, x, 1)).map(function (rect) {\n            remove(x);\n            return rect;\n          });\n        });\n        return optRect.bind(function (rawRect) {\n          return capRect(rawRect.left, rawRect.top, rawRect.width, rawRect.height);\n        });\n      });\n      var targetElement = getAnchorSelection(win, anchorInfo).bind(function (sel) {\n        return isElement(sel.start) ? Optional.some(sel.start) : parentNode(sel.start);\n      });\n      var elem = targetElement.getOr(component.element);\n      return calcNewAnchor(selectionBox, rootPoint, anchorInfo, origin, elem);\n    };\n    var SelectionAnchor = [\n      option('getSelection'),\n      strict$1('root'),\n      option('bubble'),\n      schema$1(),\n      defaulted$1('overrides', {}),\n      defaulted$1('showAbove', false),\n      output('placement', placement$3)\n    ];\n\n    var eastX$1 = function (anchor) {\n      return anchor.x + anchor.width;\n    };\n    var westX$1 = function (anchor, element) {\n      return anchor.x - element.width;\n    };\n    var northY$1 = function (anchor, element) {\n      return anchor.y - element.height + anchor.height;\n    };\n    var southY$1 = function (anchor) {\n      return anchor.y;\n    };\n    var southeast$2 = function (anchor, element, bubbles) {\n      return nu$7(eastX$1(anchor), southY$1(anchor), bubbles.southeast(), southeast(), boundsRestriction(anchor, {\n        left: 0,\n        top: 2\n      }), 'link-layout-se');\n    };\n    var southwest$2 = function (anchor, element, bubbles) {\n      return nu$7(westX$1(anchor, element), southY$1(anchor), bubbles.southwest(), southwest(), boundsRestriction(anchor, {\n        right: 1,\n        top: 2\n      }), 'link-layout-sw');\n    };\n    var northeast$2 = function (anchor, element, bubbles) {\n      return nu$7(eastX$1(anchor), northY$1(anchor, element), bubbles.northeast(), northeast(), boundsRestriction(anchor, {\n        left: 0,\n        bottom: 3\n      }), 'link-layout-ne');\n    };\n    var northwest$2 = function (anchor, element, bubbles) {\n      return nu$7(westX$1(anchor, element), northY$1(anchor, element), bubbles.northwest(), northwest(), boundsRestriction(anchor, {\n        right: 1,\n        bottom: 3\n      }), 'link-layout-nw');\n    };\n    var all$3 = function () {\n      return [\n        southeast$2,\n        southwest$2,\n        northeast$2,\n        northwest$2\n      ];\n    };\n    var allRtl$1 = function () {\n      return [\n        southwest$2,\n        southeast$2,\n        northwest$2,\n        northeast$2\n      ];\n    };\n\n    var placement$4 = function (component, submenuInfo, origin) {\n      var anchorBox = toBox(origin, submenuInfo.item.element);\n      var layouts = get$b(component.element, submenuInfo, all$3(), allRtl$1(), all$3(), allRtl$1(), Optional.none());\n      return Optional.some(nu$9({\n        anchorBox: anchorBox,\n        bubble: fallback(),\n        overrides: submenuInfo.overrides,\n        layouts: layouts,\n        placer: Optional.none()\n      }));\n    };\n    var SubmenuAnchor = [\n      strict$1('item'),\n      schema$1(),\n      defaulted$1('overrides', {}),\n      output('placement', placement$4)\n    ];\n\n    var AnchorSchema = choose$1('anchor', {\n      selection: SelectionAnchor,\n      node: NodeAnchor,\n      hotspot: HotspotAnchor,\n      submenu: SubmenuAnchor,\n      makeshift: MakeshiftAnchor\n    });\n\n    var getFixedOrigin = function () {\n      var html = document.documentElement;\n      return fixed(0, 0, html.clientWidth, html.clientHeight);\n    };\n    var getRelativeOrigin = function (component) {\n      var position = absolute(component.element);\n      var bounds = component.element.dom.getBoundingClientRect();\n      return relative(position.left, position.top, bounds.width, bounds.height);\n    };\n    var place = function (component, origin, anchoring, getBounds, placee) {\n      var anchor = box$1(anchoring.anchorBox, origin);\n      simple(anchor, placee.element, anchoring.bubble, anchoring.layouts, getBounds, anchoring.overrides);\n    };\n    var position$1 = function (component, posConfig, posState, anchor, placee) {\n      positionWithin(component, posConfig, posState, anchor, placee, Optional.none());\n    };\n    var positionWithin = function (component, posConfig, posState, anchor, placee, boxElement) {\n      var boundsBox = boxElement.map(box);\n      return positionWithinBounds(component, posConfig, posState, anchor, placee, boundsBox);\n    };\n    var positionWithinBounds = function (component, posConfig, posState, anchor, placee, bounds) {\n      var anchorage = asRawOrDie('positioning anchor.info', AnchorSchema, anchor);\n      preserve(function () {\n        set$2(placee.element, 'position', 'fixed');\n        var oldVisibility = getRaw(placee.element, 'visibility');\n        set$2(placee.element, 'visibility', 'hidden');\n        var origin = posConfig.useFixed() ? getFixedOrigin() : getRelativeOrigin(component);\n        var placer = anchorage.placement;\n        var getBounds = bounds.map(constant).or(posConfig.getBounds);\n        placer(component, anchorage, origin).each(function (anchoring) {\n          var doPlace = anchoring.placer.getOr(place);\n          doPlace(component, origin, anchoring, getBounds, placee);\n        });\n        oldVisibility.fold(function () {\n          remove$6(placee.element, 'visibility');\n        }, function (vis) {\n          set$2(placee.element, 'visibility', vis);\n        });\n        if (getRaw(placee.element, 'left').isNone() && getRaw(placee.element, 'top').isNone() && getRaw(placee.element, 'right').isNone() && getRaw(placee.element, 'bottom').isNone() && getRaw(placee.element, 'position').is('fixed')) {\n          remove$6(placee.element, 'position');\n        }\n      }, placee.element);\n    };\n    var getMode = function (component, pConfig, _pState) {\n      return pConfig.useFixed() ? 'fixed' : 'absolute';\n    };\n\n    var PositionApis = /*#__PURE__*/Object.freeze({\n        __proto__: null,\n        position: position$1,\n        positionWithin: positionWithin,\n        positionWithinBounds: positionWithinBounds,\n        getMode: getMode\n    });\n\n    var PositionSchema = [\n      defaulted$1('useFixed', never),\n      option('getBounds')\n    ];\n\n    var Positioning = create$1({\n      fields: PositionSchema,\n      name: 'positioning',\n      active: ActivePosition,\n      apis: PositionApis\n    });\n\n    var fireDetaching = function (component) {\n      emit(component, detachedFromDom());\n      var children = component.components();\n      each(children, fireDetaching);\n    };\n    var fireAttaching = function (component) {\n      var children = component.components();\n      each(children, fireAttaching);\n      emit(component, attachedToDom());\n    };\n    var attach = function (parent, child) {\n      append(parent.element, child.element);\n    };\n    var detachChildren = function (component) {\n      each(component.components(), function (childComp) {\n        return remove(childComp.element);\n      });\n      empty(component.element);\n      component.syncComponents();\n    };\n    var replaceChildren = function (component, newChildren) {\n      var subs = component.components();\n      detachChildren(component);\n      var deleted = difference(subs, newChildren);\n      each(deleted, function (comp) {\n        fireDetaching(comp);\n        component.getSystem().removeFromWorld(comp);\n      });\n      each(newChildren, function (childComp) {\n        if (!childComp.getSystem().isConnected()) {\n          component.getSystem().addToWorld(childComp);\n          attach(component, childComp);\n          if (inBody(component.element)) {\n            fireAttaching(childComp);\n          }\n        } else {\n          attach(component, childComp);\n        }\n        component.syncComponents();\n      });\n    };\n\n    var attach$1 = function (parent, child) {\n      attachWith(parent, child, append);\n    };\n    var attachWith = function (parent, child, insertion) {\n      parent.getSystem().addToWorld(child);\n      insertion(parent.element, child.element);\n      if (inBody(parent.element)) {\n        fireAttaching(child);\n      }\n      parent.syncComponents();\n    };\n    var doDetach = function (component) {\n      fireDetaching(component);\n      remove(component.element);\n      component.getSystem().removeFromWorld(component);\n    };\n    var detach = function (component) {\n      var parent$1 = parent(component.element).bind(function (p) {\n        return component.getSystem().getByDom(p).toOptional();\n      });\n      doDetach(component);\n      parent$1.each(function (p) {\n        p.syncComponents();\n      });\n    };\n    var detachChildren$1 = function (component) {\n      var subs = component.components();\n      each(subs, doDetach);\n      empty(component.element);\n      component.syncComponents();\n    };\n    var attachSystem = function (element, guiSystem) {\n      attachSystemWith(element, guiSystem, append);\n    };\n    var attachSystemAfter = function (element, guiSystem) {\n      attachSystemWith(element, guiSystem, after);\n    };\n    var attachSystemWith = function (element, guiSystem, inserter) {\n      inserter(element, guiSystem.element);\n      var children$1 = children(guiSystem.element);\n      each(children$1, function (child) {\n        guiSystem.getByDom(child).each(fireAttaching);\n      });\n    };\n    var detachSystem = function (guiSystem) {\n      var children$1 = children(guiSystem.element);\n      each(children$1, function (child) {\n        guiSystem.getByDom(child).each(fireDetaching);\n      });\n      remove(guiSystem.element);\n    };\n\n    var rebuild = function (sandbox, sConfig, sState, data) {\n      sState.get().each(function (_data) {\n        detachChildren$1(sandbox);\n      });\n      var point = sConfig.getAttachPoint(sandbox);\n      attach$1(point, sandbox);\n      var built = sandbox.getSystem().build(data);\n      attach$1(sandbox, built);\n      sState.set(built);\n      return built;\n    };\n    var open = function (sandbox, sConfig, sState, data) {\n      var newState = rebuild(sandbox, sConfig, sState, data);\n      sConfig.onOpen(sandbox, newState);\n      return newState;\n    };\n    var setContent = function (sandbox, sConfig, sState, data) {\n      return sState.get().map(function () {\n        return rebuild(sandbox, sConfig, sState, data);\n      });\n    };\n    var openWhileCloaked = function (sandbox, sConfig, sState, data, transaction) {\n      cloak(sandbox, sConfig);\n      open(sandbox, sConfig, sState, data);\n      transaction();\n      decloak(sandbox, sConfig);\n    };\n    var close = function (sandbox, sConfig, sState) {\n      sState.get().each(function (data) {\n        detachChildren$1(sandbox);\n        detach(sandbox);\n        sConfig.onClose(sandbox, data);\n        sState.clear();\n      });\n    };\n    var isOpen = function (_sandbox, _sConfig, sState) {\n      return sState.isOpen();\n    };\n    var isPartOf$1 = function (sandbox, sConfig, sState, queryElem) {\n      return isOpen(sandbox, sConfig, sState) && sState.get().exists(function (data) {\n        return sConfig.isPartOf(sandbox, data, queryElem);\n      });\n    };\n    var getState = function (_sandbox, _sConfig, sState) {\n      return sState.get();\n    };\n    var store = function (sandbox, cssKey, attr, newValue) {\n      getRaw(sandbox.element, cssKey).fold(function () {\n        remove$1(sandbox.element, attr);\n      }, function (v) {\n        set$1(sandbox.element, attr, v);\n      });\n      set$2(sandbox.element, cssKey, newValue);\n    };\n    var restore = function (sandbox, cssKey, attr) {\n      getOpt(sandbox.element, attr).fold(function () {\n        return remove$6(sandbox.element, cssKey);\n      }, function (oldValue) {\n        return set$2(sandbox.element, cssKey, oldValue);\n      });\n    };\n    var cloak = function (sandbox, sConfig, _sState) {\n      var sink = sConfig.getAttachPoint(sandbox);\n      set$2(sandbox.element, 'position', Positioning.getMode(sink));\n      store(sandbox, 'visibility', sConfig.cloakVisibilityAttr, 'hidden');\n    };\n    var hasPosition = function (element) {\n      return exists([\n        'top',\n        'left',\n        'right',\n        'bottom'\n      ], function (pos) {\n        return getRaw(element, pos).isSome();\n      });\n    };\n    var decloak = function (sandbox, sConfig, _sState) {\n      if (!hasPosition(sandbox.element)) {\n        remove$6(sandbox.element, 'position');\n      }\n      restore(sandbox, 'visibility', sConfig.cloakVisibilityAttr);\n    };\n\n    var SandboxApis = /*#__PURE__*/Object.freeze({\n        __proto__: null,\n        cloak: cloak,\n        decloak: decloak,\n        open: open,\n        openWhileCloaked: openWhileCloaked,\n        close: close,\n        isOpen: isOpen,\n        isPartOf: isPartOf$1,\n        getState: getState,\n        setContent: setContent\n    });\n\n    var events$2 = function (sandboxConfig, sandboxState) {\n      return derive([run(sandboxClose(), function (sandbox, _simulatedEvent) {\n          close(sandbox, sandboxConfig, sandboxState);\n        })]);\n    };\n\n    var ActiveSandbox = /*#__PURE__*/Object.freeze({\n        __proto__: null,\n        events: events$2\n    });\n\n    var SandboxSchema = [\n      onHandler('onOpen'),\n      onHandler('onClose'),\n      strict$1('isPartOf'),\n      strict$1('getAttachPoint'),\n      defaulted$1('cloakVisibilityAttr', 'data-precloak-visibility')\n    ];\n\n    var init = function () {\n      var contents = Cell(Optional.none());\n      var readState = constant('not-implemented');\n      var isOpen = function () {\n        return contents.get().isSome();\n      };\n      var set = function (comp) {\n        contents.set(Optional.some(comp));\n      };\n      var get = function () {\n        return contents.get();\n      };\n      var clear = function () {\n        contents.set(Optional.none());\n      };\n      return nu$5({\n        readState: readState,\n        isOpen: isOpen,\n        clear: clear,\n        set: set,\n        get: get\n      });\n    };\n\n    var SandboxState = /*#__PURE__*/Object.freeze({\n        __proto__: null,\n        init: init\n    });\n\n    var Sandboxing = create$1({\n      fields: SandboxSchema,\n      name: 'sandboxing',\n      active: ActiveSandbox,\n      apis: SandboxApis,\n      state: SandboxState\n    });\n\n    var dismissPopups = constant('dismiss.popups');\n    var repositionPopups = constant('reposition.popups');\n    var mouseReleased = constant('mouse.released');\n\n    var schema$2 = objOfOnly([\n      defaulted$1('isExtraPart', never),\n      optionObjOf('fireEventInstead', [defaulted$1('event', dismissRequested())])\n    ]);\n    var receivingChannel = function (rawSpec) {\n      var _a;\n      var detail = asRawOrDie('Dismissal', schema$2, rawSpec);\n      return _a = {}, _a[dismissPopups()] = {\n        schema: objOfOnly([strict$1('target')]),\n        onReceive: function (sandbox, data) {\n          if (Sandboxing.isOpen(sandbox)) {\n            var isPart = Sandboxing.isPartOf(sandbox, data.target) || detail.isExtraPart(sandbox, data.target);\n            if (!isPart) {\n              detail.fireEventInstead.fold(function () {\n                return Sandboxing.close(sandbox);\n              }, function (fe) {\n                return emit(sandbox, fe.event);\n              });\n            }\n          }\n        }\n      }, _a;\n    };\n\n    var schema$3 = objOfOnly([\n      optionObjOf('fireEventInstead', [defaulted$1('event', repositionRequested())]),\n      strictFunction('doReposition')\n    ]);\n    var receivingChannel$1 = function (rawSpec) {\n      var _a;\n      var detail = asRawOrDie('Reposition', schema$3, rawSpec);\n      return _a = {}, _a[repositionPopups()] = {\n        onReceive: function (sandbox) {\n          if (Sandboxing.isOpen(sandbox)) {\n            detail.fireEventInstead.fold(function () {\n              return detail.doReposition(sandbox);\n            }, function (fe) {\n              return emit(sandbox, fe.event);\n            });\n          }\n        }\n      }, _a;\n    };\n\n    var onLoad = function (component, repConfig, repState) {\n      repConfig.store.manager.onLoad(component, repConfig, repState);\n    };\n    var onUnload = function (component, repConfig, repState) {\n      repConfig.store.manager.onUnload(component, repConfig, repState);\n    };\n    var setValue = function (component, repConfig, repState, data) {\n      repConfig.store.manager.setValue(component, repConfig, repState, data);\n    };\n    var getValue = function (component, repConfig, repState) {\n      return repConfig.store.manager.getValue(component, repConfig, repState);\n    };\n    var getState$1 = function (component, repConfig, repState) {\n      return repState;\n    };\n\n    var RepresentApis = /*#__PURE__*/Object.freeze({\n        __proto__: null,\n        onLoad: onLoad,\n        onUnload: onUnload,\n        setValue: setValue,\n        getValue: getValue,\n        getState: getState$1\n    });\n\n    var events$3 = function (repConfig, repState) {\n      var es = repConfig.resetOnDom ? [\n        runOnAttached(function (comp, _se) {\n          onLoad(comp, repConfig, repState);\n        }),\n        runOnDetached(function (comp, _se) {\n          onUnload(comp, repConfig, repState);\n        })\n      ] : [loadEvent(repConfig, repState, onLoad)];\n      return derive(es);\n    };\n\n    var ActiveRepresenting = /*#__PURE__*/Object.freeze({\n        __proto__: null,\n        events: events$3\n    });\n\n    var memory = function () {\n      var data = Cell(null);\n      var readState = function () {\n        return {\n          mode: 'memory',\n          value: data.get()\n        };\n      };\n      var isNotSet = function () {\n        return data.get() === null;\n      };\n      var clear = function () {\n        data.set(null);\n      };\n      return nu$5({\n        set: data.set,\n        get: data.get,\n        isNotSet: isNotSet,\n        clear: clear,\n        readState: readState\n      });\n    };\n    var manual = function () {\n      var readState = noop;\n      return nu$5({ readState: readState });\n    };\n    var dataset = function () {\n      var dataByValue = Cell({});\n      var dataByText = Cell({});\n      var readState = function () {\n        return {\n          mode: 'dataset',\n          dataByValue: dataByValue.get(),\n          dataByText: dataByText.get()\n        };\n      };\n      var clear = function () {\n        dataByValue.set({});\n        dataByText.set({});\n      };\n      var lookup = function (itemString) {\n        return get$1(dataByValue.get(), itemString).orThunk(function () {\n          return get$1(dataByText.get(), itemString);\n        });\n      };\n      var update = function (items) {\n        var currentDataByValue = dataByValue.get();\n        var currentDataByText = dataByText.get();\n        var newDataByValue = {};\n        var newDataByText = {};\n        each(items, function (item) {\n          newDataByValue[item.value] = item;\n          get$1(item, 'meta').each(function (meta) {\n            get$1(meta, 'text').each(function (text) {\n              newDataByText[text] = item;\n            });\n          });\n        });\n        dataByValue.set(__assign(__assign({}, currentDataByValue), newDataByValue));\n        dataByText.set(__assign(__assign({}, currentDataByText), newDataByText));\n      };\n      return nu$5({\n        readState: readState,\n        lookup: lookup,\n        update: update,\n        clear: clear\n      });\n    };\n    var init$1 = function (spec) {\n      return spec.store.manager.state(spec);\n    };\n\n    var RepresentState = /*#__PURE__*/Object.freeze({\n        __proto__: null,\n        memory: memory,\n        dataset: dataset,\n        manual: manual,\n        init: init$1\n    });\n\n    var setValue$1 = function (component, repConfig, repState, data) {\n      var store = repConfig.store;\n      repState.update([data]);\n      store.setValue(component, data);\n      repConfig.onSetValue(component, data);\n    };\n    var getValue$1 = function (component, repConfig, repState) {\n      var store = repConfig.store;\n      var key = store.getDataKey(component);\n      return repState.lookup(key).fold(function () {\n        return store.getFallbackEntry(key);\n      }, function (data) {\n        return data;\n      });\n    };\n    var onLoad$1 = function (component, repConfig, repState) {\n      var store = repConfig.store;\n      store.initialValue.each(function (data) {\n        setValue$1(component, repConfig, repState, data);\n      });\n    };\n    var onUnload$1 = function (component, repConfig, repState) {\n      repState.clear();\n    };\n    var DatasetStore = [\n      option('initialValue'),\n      strict$1('getFallbackEntry'),\n      strict$1('getDataKey'),\n      strict$1('setValue'),\n      output('manager', {\n        setValue: setValue$1,\n        getValue: getValue$1,\n        onLoad: onLoad$1,\n        onUnload: onUnload$1,\n        state: dataset\n      })\n    ];\n\n    var getValue$2 = function (component, repConfig, _repState) {\n      return repConfig.store.getValue(component);\n    };\n    var setValue$2 = function (component, repConfig, _repState, data) {\n      repConfig.store.setValue(component, data);\n      repConfig.onSetValue(component, data);\n    };\n    var onLoad$2 = function (component, repConfig, _repState) {\n      repConfig.store.initialValue.each(function (data) {\n        repConfig.store.setValue(component, data);\n      });\n    };\n    var ManualStore = [\n      strict$1('getValue'),\n      defaulted$1('setValue', noop),\n      option('initialValue'),\n      output('manager', {\n        setValue: setValue$2,\n        getValue: getValue$2,\n        onLoad: onLoad$2,\n        onUnload: noop,\n        state: NoState.init\n      })\n    ];\n\n    var setValue$3 = function (component, repConfig, repState, data) {\n      repState.set(data);\n      repConfig.onSetValue(component, data);\n    };\n    var getValue$3 = function (component, repConfig, repState) {\n      return repState.get();\n    };\n    var onLoad$3 = function (component, repConfig, repState) {\n      repConfig.store.initialValue.each(function (initVal) {\n        if (repState.isNotSet()) {\n          repState.set(initVal);\n        }\n      });\n    };\n    var onUnload$2 = function (component, repConfig, repState) {\n      repState.clear();\n    };\n    var MemoryStore = [\n      option('initialValue'),\n      output('manager', {\n        setValue: setValue$3,\n        getValue: getValue$3,\n        onLoad: onLoad$3,\n        onUnload: onUnload$2,\n        state: memory\n      })\n    ];\n\n    var RepresentSchema = [\n      defaultedOf('store', { mode: 'memory' }, choose$1('mode', {\n        memory: MemoryStore,\n        manual: ManualStore,\n        dataset: DatasetStore\n      })),\n      onHandler('onSetValue'),\n      defaulted$1('resetOnDom', false)\n    ];\n\n    var Representing = create$1({\n      fields: RepresentSchema,\n      name: 'representing',\n      active: ActiveRepresenting,\n      apis: RepresentApis,\n      extra: {\n        setValueFrom: function (component, source) {\n          var value = Representing.getValue(source);\n          Representing.setValue(component, value);\n        }\n      },\n      state: RepresentState\n    });\n\n    var field$1 = function (name, forbidden) {\n      return defaultedObjOf(name, {}, map(forbidden, function (f) {\n        return forbid(f.name(), 'Cannot configure ' + f.name() + ' for ' + name);\n      }).concat([state$1('dump', identity)]));\n    };\n    var get$d = function (data) {\n      return data.dump;\n    };\n    var augment = function (data, original) {\n      return __assign(__assign({}, data.dump), derive$1(original));\n    };\n    var SketchBehaviours = {\n      field: field$1,\n      augment: augment,\n      get: get$d\n    };\n\n    var _placeholder = 'placeholder';\n    var adt$9 = Adt.generate([\n      {\n        single: [\n          'required',\n          'valueThunk'\n        ]\n      },\n      {\n        multiple: [\n          'required',\n          'valueThunks'\n        ]\n      }\n    ]);\n    var isSubstituted = function (spec) {\n      return has(spec, 'uiType');\n    };\n    var subPlaceholder = function (owner, detail, compSpec, placeholders) {\n      if (owner.exists(function (o) {\n          return o !== compSpec.owner;\n        })) {\n        return adt$9.single(true, constant(compSpec));\n      }\n      return get$1(placeholders, compSpec.name).fold(function () {\n        throw new Error('Unknown placeholder component: ' + compSpec.name + '\\nKnown: [' + keys(placeholders) + ']\\nNamespace: ' + owner.getOr('none') + '\\nSpec: ' + JSON.stringify(compSpec, null, 2));\n      }, function (newSpec) {\n        return newSpec.replace();\n      });\n    };\n    var scan = function (owner, detail, compSpec, placeholders) {\n      if (isSubstituted(compSpec) && compSpec.uiType === _placeholder) {\n        return subPlaceholder(owner, detail, compSpec, placeholders);\n      } else {\n        return adt$9.single(false, constant(compSpec));\n      }\n    };\n    var substitute = function (owner, detail, compSpec, placeholders) {\n      var base = scan(owner, detail, compSpec, placeholders);\n      return base.fold(function (req, valueThunk) {\n        var value = isSubstituted(compSpec) ? valueThunk(detail, compSpec.config, compSpec.validated) : valueThunk(detail);\n        var childSpecs = get$1(value, 'components').getOr([]);\n        var substituted = bind(childSpecs, function (c) {\n          return substitute(owner, detail, c, placeholders);\n        });\n        return [__assign(__assign({}, value), { components: substituted })];\n      }, function (req, valuesThunk) {\n        if (isSubstituted(compSpec)) {\n          var values = valuesThunk(detail, compSpec.config, compSpec.validated);\n          var preprocessor = compSpec.validated.preprocess.getOr(identity);\n          return preprocessor(values);\n        } else {\n          return valuesThunk(detail);\n        }\n      });\n    };\n    var substituteAll = function (owner, detail, components, placeholders) {\n      return bind(components, function (c) {\n        return substitute(owner, detail, c, placeholders);\n      });\n    };\n    var oneReplace = function (label, replacements) {\n      var called = false;\n      var used = function () {\n        return called;\n      };\n      var replace = function () {\n        if (called) {\n          throw new Error('Trying to use the same placeholder more than once: ' + label);\n        }\n        called = true;\n        return replacements;\n      };\n      var required = function () {\n        return replacements.fold(function (req, _) {\n          return req;\n        }, function (req, _) {\n          return req;\n        });\n      };\n      return {\n        name: constant(label),\n        required: required,\n        used: used,\n        replace: replace\n      };\n    };\n    var substitutePlaces = function (owner, detail, components, placeholders) {\n      var ps = map$2(placeholders, function (ph, name) {\n        return oneReplace(name, ph);\n      });\n      var outcome = substituteAll(owner, detail, components, ps);\n      each$1(ps, function (p) {\n        if (p.used() === false && p.required()) {\n          throw new Error('Placeholder: ' + p.name() + ' was not found in components list\\nNamespace: ' + owner.getOr('none') + '\\nComponents: ' + JSON.stringify(detail.components, null, 2));\n        }\n      });\n      return outcome;\n    };\n    var single = adt$9.single;\n    var multiple = adt$9.multiple;\n    var placeholder = constant(_placeholder);\n\n    var adt$a = Adt.generate([\n      { required: ['data'] },\n      { external: ['data'] },\n      { optional: ['data'] },\n      { group: ['data'] }\n    ]);\n    var fFactory = defaulted$1('factory', { sketch: identity });\n    var fSchema = defaulted$1('schema', []);\n    var fName = strict$1('name');\n    var fPname = field('pname', 'pname', defaultedThunk(function (typeSpec) {\n      return '<alloy.' + generate$1(typeSpec.name) + '>';\n    }), anyValue$1());\n    var fGroupSchema = state$1('schema', function () {\n      return [option('preprocess')];\n    });\n    var fDefaults = defaulted$1('defaults', constant({}));\n    var fOverrides = defaulted$1('overrides', constant({}));\n    var requiredSpec = objOf([\n      fFactory,\n      fSchema,\n      fName,\n      fPname,\n      fDefaults,\n      fOverrides\n    ]);\n    var externalSpec = objOf([\n      fFactory,\n      fSchema,\n      fName,\n      fDefaults,\n      fOverrides\n    ]);\n    var optionalSpec = objOf([\n      fFactory,\n      fSchema,\n      fName,\n      fPname,\n      fDefaults,\n      fOverrides\n    ]);\n    var groupSpec = objOf([\n      fFactory,\n      fGroupSchema,\n      fName,\n      strict$1('unit'),\n      fPname,\n      fDefaults,\n      fOverrides\n    ]);\n    var asNamedPart = function (part) {\n      return part.fold(Optional.some, Optional.none, Optional.some, Optional.some);\n    };\n    var name$1 = function (part) {\n      var get = function (data) {\n        return data.name;\n      };\n      return part.fold(get, get, get, get);\n    };\n    var asCommon = function (part) {\n      return part.fold(identity, identity, identity, identity);\n    };\n    var convert = function (adtConstructor, partSchema) {\n      return function (spec) {\n        var data = asRawOrDie('Converting part type', partSchema, spec);\n        return adtConstructor(data);\n      };\n    };\n    var required = convert(adt$a.required, requiredSpec);\n    var external$1 = convert(adt$a.external, externalSpec);\n    var optional = convert(adt$a.optional, optionalSpec);\n    var group = convert(adt$a.group, groupSpec);\n    var original = constant('entirety');\n\n    var PartType = /*#__PURE__*/Object.freeze({\n        __proto__: null,\n        required: required,\n        external: external$1,\n        optional: optional,\n        group: group,\n        asNamedPart: asNamedPart,\n        name: name$1,\n        asCommon: asCommon,\n        original: original\n    });\n\n    var combine$2 = function (detail, data, partSpec, partValidated) {\n      return deepMerge(data.defaults(detail, partSpec, partValidated), partSpec, { uid: detail.partUids[data.name] }, data.overrides(detail, partSpec, partValidated));\n    };\n    var subs = function (owner, detail, parts) {\n      var internals = {};\n      var externals = {};\n      each(parts, function (part) {\n        part.fold(function (data) {\n          internals[data.pname] = single(true, function (detail, partSpec, partValidated) {\n            return data.factory.sketch(combine$2(detail, data, partSpec, partValidated));\n          });\n        }, function (data) {\n          var partSpec = detail.parts[data.name];\n          externals[data.name] = constant(data.factory.sketch(combine$2(detail, data, partSpec[original()]), partSpec));\n        }, function (data) {\n          internals[data.pname] = single(false, function (detail, partSpec, partValidated) {\n            return data.factory.sketch(combine$2(detail, data, partSpec, partValidated));\n          });\n        }, function (data) {\n          internals[data.pname] = multiple(true, function (detail, _partSpec, _partValidated) {\n            var units = detail[data.name];\n            return map(units, function (u) {\n              return data.factory.sketch(deepMerge(data.defaults(detail, u, _partValidated), u, data.overrides(detail, u)));\n            });\n          });\n        });\n      });\n      return {\n        internals: constant(internals),\n        externals: constant(externals)\n      };\n    };\n\n    var generate$4 = function (owner, parts) {\n      var r = {};\n      each(parts, function (part) {\n        asNamedPart(part).each(function (np) {\n          var g = doGenerateOne(owner, np.pname);\n          r[np.name] = function (config) {\n            var validated = asRawOrDie('Part: ' + np.name + ' in ' + owner, objOf(np.schema), config);\n            return __assign(__assign({}, g), {\n              config: config,\n              validated: validated\n            });\n          };\n        });\n      });\n      return r;\n    };\n    var doGenerateOne = function (owner, pname) {\n      return {\n        uiType: placeholder(),\n        owner: owner,\n        name: pname\n      };\n    };\n    var generateOne = function (owner, pname, config) {\n      return {\n        uiType: placeholder(),\n        owner: owner,\n        name: pname,\n        config: config,\n        validated: {}\n      };\n    };\n    var schemas = function (parts) {\n      return bind(parts, function (part) {\n        return part.fold(Optional.none, Optional.some, Optional.none, Optional.none).map(function (data) {\n          return strictObjOf(data.name, data.schema.concat([snapshot(original())]));\n        }).toArray();\n      });\n    };\n    var names = function (parts) {\n      return map(parts, name$1);\n    };\n    var substitutes = function (owner, detail, parts) {\n      return subs(owner, detail, parts);\n    };\n    var components = function (owner, detail, internals) {\n      return substitutePlaces(Optional.some(owner), detail, detail.components, internals);\n    };\n    var getPart = function (component, detail, partKey) {\n      var uid = detail.partUids[partKey];\n      return component.getSystem().getByUid(uid).toOptional();\n    };\n    var getPartOrDie = function (component, detail, partKey) {\n      return getPart(component, detail, partKey).getOrDie('Could not find part: ' + partKey);\n    };\n    var getParts = function (component, detail, partKeys) {\n      var r = {};\n      var uids = detail.partUids;\n      var system = component.getSystem();\n      each(partKeys, function (pk) {\n        r[pk] = constant(system.getByUid(uids[pk]));\n      });\n      return r;\n    };\n    var getAllParts = function (component, detail) {\n      var system = component.getSystem();\n      return map$2(detail.partUids, function (pUid, _k) {\n        return constant(system.getByUid(pUid));\n      });\n    };\n    var getAllPartNames = function (detail) {\n      return keys(detail.partUids);\n    };\n    var getPartsOrDie = function (component, detail, partKeys) {\n      var r = {};\n      var uids = detail.partUids;\n      var system = component.getSystem();\n      each(partKeys, function (pk) {\n        r[pk] = constant(system.getByUid(uids[pk]).getOrDie());\n      });\n      return r;\n    };\n    var defaultUids = function (baseUid, partTypes) {\n      var partNames = names(partTypes);\n      return wrapAll$1(map(partNames, function (pn) {\n        return {\n          key: pn,\n          value: baseUid + '-' + pn\n        };\n      }));\n    };\n    var defaultUidsSchema = function (partTypes) {\n      return field('partUids', 'partUids', mergeWithThunk(function (spec) {\n        return defaultUids(spec.uid, partTypes);\n      }), anyValue$1());\n    };\n\n    var AlloyParts = /*#__PURE__*/Object.freeze({\n        __proto__: null,\n        generate: generate$4,\n        generateOne: generateOne,\n        schemas: schemas,\n        names: names,\n        substitutes: substitutes,\n        components: components,\n        defaultUids: defaultUids,\n        defaultUidsSchema: defaultUidsSchema,\n        getAllParts: getAllParts,\n        getAllPartNames: getAllPartNames,\n        getPart: getPart,\n        getPartOrDie: getPartOrDie,\n        getParts: getParts,\n        getPartsOrDie: getPartsOrDie\n    });\n\n    var base = function (partSchemas, partUidsSchemas) {\n      var ps = partSchemas.length > 0 ? [strictObjOf('parts', partSchemas)] : [];\n      return ps.concat([\n        strict$1('uid'),\n        defaulted$1('dom', {}),\n        defaulted$1('components', []),\n        snapshot('originalSpec'),\n        defaulted$1('debug.sketcher', {})\n      ]).concat(partUidsSchemas);\n    };\n    var asRawOrDie$1 = function (label, schema, spec, partSchemas, partUidsSchemas) {\n      var baseS = base(partSchemas, partUidsSchemas);\n      return asRawOrDie(label + ' [SpecSchema]', objOfOnly(baseS.concat(schema)), spec);\n    };\n\n    var single$1 = function (owner, schema, factory, spec) {\n      var specWithUid = supplyUid(spec);\n      var detail = asRawOrDie$1(owner, schema, specWithUid, [], []);\n      return factory(detail, specWithUid);\n    };\n    var composite = function (owner, schema, partTypes, factory, spec) {\n      var specWithUid = supplyUid(spec);\n      var partSchemas = schemas(partTypes);\n      var partUidsSchema = defaultUidsSchema(partTypes);\n      var detail = asRawOrDie$1(owner, schema, specWithUid, partSchemas, [partUidsSchema]);\n      var subs = substitutes(owner, detail, partTypes);\n      var components$1 = components(owner, detail, subs.internals());\n      return factory(detail, components$1, specWithUid, subs.externals());\n    };\n    var hasUid = function (spec) {\n      return has(spec, 'uid');\n    };\n    var supplyUid = function (spec) {\n      return hasUid(spec) ? spec : __assign(__assign({}, spec), { uid: generate$2('uid') });\n    };\n\n    var isSketchSpec = function (spec) {\n      return spec.uid !== undefined;\n    };\n    var singleSchema = objOfOnly([\n      strict$1('name'),\n      strict$1('factory'),\n      strict$1('configFields'),\n      defaulted$1('apis', {}),\n      defaulted$1('extraApis', {})\n    ]);\n    var compositeSchema = objOfOnly([\n      strict$1('name'),\n      strict$1('factory'),\n      strict$1('configFields'),\n      strict$1('partFields'),\n      defaulted$1('apis', {}),\n      defaulted$1('extraApis', {})\n    ]);\n    var single$2 = function (rawConfig) {\n      var config = asRawOrDie('Sketcher for ' + rawConfig.name, singleSchema, rawConfig);\n      var sketch = function (spec) {\n        return single$1(config.name, config.configFields, config.factory, spec);\n      };\n      var apis = map$2(config.apis, makeApi);\n      var extraApis = map$2(config.extraApis, function (f, k) {\n        return markAsExtraApi(f, k);\n      });\n      return __assign(__assign({\n        name: config.name,\n        configFields: config.configFields,\n        sketch: sketch\n      }, apis), extraApis);\n    };\n    var composite$1 = function (rawConfig) {\n      var config = asRawOrDie('Sketcher for ' + rawConfig.name, compositeSchema, rawConfig);\n      var sketch = function (spec) {\n        return composite(config.name, config.configFields, config.partFields, config.factory, spec);\n      };\n      var parts = generate$4(config.name, config.partFields);\n      var apis = map$2(config.apis, makeApi);\n      var extraApis = map$2(config.extraApis, function (f, k) {\n        return markAsExtraApi(f, k);\n      });\n      return __assign(__assign({\n        name: config.name,\n        partFields: config.partFields,\n        configFields: config.configFields,\n        sketch: sketch,\n        parts: parts\n      }, apis), extraApis);\n    };\n\n    var cat = function (arr) {\n      var r = [];\n      var push = function (x) {\n        r.push(x);\n      };\n      for (var i = 0; i < arr.length; i++) {\n        arr[i].each(push);\n      }\n      return r;\n    };\n    var sequence = function (arr) {\n      var r = [];\n      for (var i = 0; i < arr.length; i++) {\n        var x = arr[i];\n        if (x.isSome()) {\n          r.push(x.getOrDie());\n        } else {\n          return Optional.none();\n        }\n      }\n      return Optional.some(r);\n    };\n    var lift2 = function (oa, ob, f) {\n      return oa.isSome() && ob.isSome() ? Optional.some(f(oa.getOrDie(), ob.getOrDie())) : Optional.none();\n    };\n    var lift3 = function (oa, ob, oc, f) {\n      return oa.isSome() && ob.isSome() && oc.isSome() ? Optional.some(f(oa.getOrDie(), ob.getOrDie(), oc.getOrDie())) : Optional.none();\n    };\n    var mapFrom = function (a, f) {\n      return a !== undefined && a !== null ? Optional.some(f(a)) : Optional.none();\n    };\n    var someIf = function (b, a) {\n      return b ? Optional.some(a) : Optional.none();\n    };\n\n    var inside = function (target) {\n      return name(target) === 'input' && get$3(target, 'type') !== 'radio' || name(target) === 'textarea';\n    };\n\n    var getCurrent = function (component, composeConfig, _composeState) {\n      return composeConfig.find(component);\n    };\n\n    var ComposeApis = /*#__PURE__*/Object.freeze({\n        __proto__: null,\n        getCurrent: getCurrent\n    });\n\n    var ComposeSchema = [strict$1('find')];\n\n    var Composing = create$1({\n      fields: ComposeSchema,\n      name: 'composing',\n      apis: ComposeApis\n    });\n\n    var dehighlightAllExcept = function (component, hConfig, hState, skip) {\n      var highlighted = descendants(component.element, '.' + hConfig.highlightClass);\n      each(highlighted, function (h) {\n        if (!exists(skip, function (skipComp) {\n            return skipComp.element === h;\n          })) {\n          remove$4(h, hConfig.highlightClass);\n          component.getSystem().getByDom(h).each(function (target) {\n            hConfig.onDehighlight(component, target);\n            emit(target, dehighlight());\n          });\n        }\n      });\n    };\n    var dehighlightAll = function (component, hConfig, hState) {\n      return dehighlightAllExcept(component, hConfig, hState, []);\n    };\n    var dehighlight$1 = function (component, hConfig, hState, target) {\n      if (isHighlighted(component, hConfig, hState, target)) {\n        remove$4(target.element, hConfig.highlightClass);\n        hConfig.onDehighlight(component, target);\n        emit(target, dehighlight());\n      }\n    };\n    var highlight$1 = function (component, hConfig, hState, target) {\n      dehighlightAllExcept(component, hConfig, hState, [target]);\n      if (!isHighlighted(component, hConfig, hState, target)) {\n        add$2(target.element, hConfig.highlightClass);\n        hConfig.onHighlight(component, target);\n        emit(target, highlight());\n      }\n    };\n    var highlightFirst = function (component, hConfig, hState) {\n      getFirst(component, hConfig).each(function (firstComp) {\n        highlight$1(component, hConfig, hState, firstComp);\n      });\n    };\n    var highlightLast = function (component, hConfig, hState) {\n      getLast(component, hConfig).each(function (lastComp) {\n        highlight$1(component, hConfig, hState, lastComp);\n      });\n    };\n    var highlightAt = function (component, hConfig, hState, index) {\n      getByIndex(component, hConfig, hState, index).fold(function (err) {\n        throw err;\n      }, function (firstComp) {\n        highlight$1(component, hConfig, hState, firstComp);\n      });\n    };\n    var highlightBy = function (component, hConfig, hState, predicate) {\n      var candidates = getCandidates(component, hConfig);\n      var targetComp = find(candidates, predicate);\n      targetComp.each(function (c) {\n        highlight$1(component, hConfig, hState, c);\n      });\n    };\n    var isHighlighted = function (component, hConfig, hState, queryTarget) {\n      return has$2(queryTarget.element, hConfig.highlightClass);\n    };\n    var getHighlighted = function (component, hConfig, _hState) {\n      return descendant$1(component.element, '.' + hConfig.highlightClass).bind(function (e) {\n        return component.getSystem().getByDom(e).toOptional();\n      });\n    };\n    var getByIndex = function (component, hConfig, hState, index) {\n      var items = descendants(component.element, '.' + hConfig.itemClass);\n      return Optional.from(items[index]).fold(function () {\n        return Result.error(new Error('No element found with index ' + index));\n      }, component.getSystem().getByDom);\n    };\n    var getFirst = function (component, hConfig, _hState) {\n      return descendant$1(component.element, '.' + hConfig.itemClass).bind(function (e) {\n        return component.getSystem().getByDom(e).toOptional();\n      });\n    };\n    var getLast = function (component, hConfig, _hState) {\n      var items = descendants(component.element, '.' + hConfig.itemClass);\n      var last = items.length > 0 ? Optional.some(items[items.length - 1]) : Optional.none();\n      return last.bind(function (c) {\n        return component.getSystem().getByDom(c).toOptional();\n      });\n    };\n    var getDelta = function (component, hConfig, hState, delta) {\n      var items = descendants(component.element, '.' + hConfig.itemClass);\n      var current = findIndex(items, function (item) {\n        return has$2(item, hConfig.highlightClass);\n      });\n      return current.bind(function (selected) {\n        var dest = cycleBy(selected, delta, 0, items.length - 1);\n        return component.getSystem().getByDom(items[dest]).toOptional();\n      });\n    };\n    var getPrevious = function (component, hConfig, hState) {\n      return getDelta(component, hConfig, hState, -1);\n    };\n    var getNext = function (component, hConfig, hState) {\n      return getDelta(component, hConfig, hState, +1);\n    };\n    var getCandidates = function (component, hConfig, _hState) {\n      var items = descendants(component.element, '.' + hConfig.itemClass);\n      return cat(map(items, function (i) {\n        return component.getSystem().getByDom(i).toOptional();\n      }));\n    };\n\n    var HighlightApis = /*#__PURE__*/Object.freeze({\n        __proto__: null,\n        dehighlightAll: dehighlightAll,\n        dehighlight: dehighlight$1,\n        highlight: highlight$1,\n        highlightFirst: highlightFirst,\n        highlightLast: highlightLast,\n        highlightAt: highlightAt,\n        highlightBy: highlightBy,\n        isHighlighted: isHighlighted,\n        getHighlighted: getHighlighted,\n        getFirst: getFirst,\n        getLast: getLast,\n        getPrevious: getPrevious,\n        getNext: getNext,\n        getCandidates: getCandidates\n    });\n\n    var HighlightSchema = [\n      strict$1('highlightClass'),\n      strict$1('itemClass'),\n      onHandler('onHighlight'),\n      onHandler('onDehighlight')\n    ];\n\n    var Highlighting = create$1({\n      fields: HighlightSchema,\n      name: 'highlighting',\n      apis: HighlightApis\n    });\n\n    var BACKSPACE = [8];\n    var TAB = [9];\n    var ENTER = [13];\n    var ESCAPE = [27];\n    var SPACE = [32];\n    var LEFT = [37];\n    var UP = [38];\n    var RIGHT = [39];\n    var DOWN = [40];\n\n    var cyclePrev = function (values, index, predicate) {\n      var before = reverse(values.slice(0, index));\n      var after = reverse(values.slice(index + 1));\n      return find(before.concat(after), predicate);\n    };\n    var tryPrev = function (values, index, predicate) {\n      var before = reverse(values.slice(0, index));\n      return find(before, predicate);\n    };\n    var cycleNext = function (values, index, predicate) {\n      var before = values.slice(0, index);\n      var after = values.slice(index + 1);\n      return find(after.concat(before), predicate);\n    };\n    var tryNext = function (values, index, predicate) {\n      var after = values.slice(index + 1);\n      return find(after, predicate);\n    };\n\n    var inSet = function (keys) {\n      return function (event) {\n        var raw = event.raw;\n        return contains(keys, raw.which);\n      };\n    };\n    var and = function (preds) {\n      return function (event) {\n        return forall(preds, function (pred) {\n          return pred(event);\n        });\n      };\n    };\n    var isShift = function (event) {\n      var raw = event.raw;\n      return raw.shiftKey === true;\n    };\n    var isControl = function (event) {\n      var raw = event.raw;\n      return raw.ctrlKey === true;\n    };\n    var isNotShift = not(isShift);\n\n    var rule = function (matches, action) {\n      return {\n        matches: matches,\n        classification: action\n      };\n    };\n    var choose$2 = function (transitions, event) {\n      var transition = find(transitions, function (t) {\n        return t.matches(event);\n      });\n      return transition.map(function (t) {\n        return t.classification;\n      });\n    };\n\n    var reportFocusShifting = function (component, prevFocus, newFocus) {\n      var noChange = prevFocus.exists(function (p) {\n        return newFocus.exists(function (n) {\n          return eq$1(n, p);\n        });\n      });\n      if (!noChange) {\n        emitWith(component, focusShifted(), {\n          prevFocus: prevFocus,\n          newFocus: newFocus\n        });\n      }\n    };\n    var dom = function () {\n      var get = function (component) {\n        return search(component.element);\n      };\n      var set = function (component, focusee) {\n        var prevFocus = get(component);\n        component.getSystem().triggerFocus(focusee, component.element);\n        var newFocus = get(component);\n        reportFocusShifting(component, prevFocus, newFocus);\n      };\n      return {\n        get: get,\n        set: set\n      };\n    };\n    var highlights = function () {\n      var get = function (component) {\n        return Highlighting.getHighlighted(component).map(function (item) {\n          return item.element;\n        });\n      };\n      var set = function (component, element) {\n        var prevFocus = get(component);\n        component.getSystem().getByDom(element).fold(noop, function (item) {\n          Highlighting.highlight(component, item);\n        });\n        var newFocus = get(component);\n        reportFocusShifting(component, prevFocus, newFocus);\n      };\n      return {\n        get: get,\n        set: set\n      };\n    };\n\n    var FocusInsideModes;\n    (function (FocusInsideModes) {\n      FocusInsideModes['OnFocusMode'] = 'onFocus';\n      FocusInsideModes['OnEnterOrSpaceMode'] = 'onEnterOrSpace';\n      FocusInsideModes['OnApiMode'] = 'onApi';\n    }(FocusInsideModes || (FocusInsideModes = {})));\n\n    var typical = function (infoSchema, stateInit, getKeydownRules, getKeyupRules, optFocusIn) {\n      var schema = function () {\n        return infoSchema.concat([\n          defaulted$1('focusManager', dom()),\n          defaultedOf('focusInside', 'onFocus', valueOf(function (val) {\n            return contains([\n              'onFocus',\n              'onEnterOrSpace',\n              'onApi'\n            ], val) ? Result.value(val) : Result.error('Invalid value for focusInside');\n          })),\n          output('handler', me),\n          output('state', stateInit),\n          output('sendFocusIn', optFocusIn)\n        ]);\n      };\n      var processKey = function (component, simulatedEvent, getRules, keyingConfig, keyingState) {\n        var rules = getRules(component, simulatedEvent, keyingConfig, keyingState);\n        return choose$2(rules, simulatedEvent.event).bind(function (rule) {\n          return rule(component, simulatedEvent, keyingConfig, keyingState);\n        });\n      };\n      var toEvents = function (keyingConfig, keyingState) {\n        var onFocusHandler = keyingConfig.focusInside !== FocusInsideModes.OnFocusMode ? Optional.none() : optFocusIn(keyingConfig).map(function (focusIn) {\n          return run(focus(), function (component, simulatedEvent) {\n            focusIn(component, keyingConfig, keyingState);\n            simulatedEvent.stop();\n          });\n        });\n        var tryGoInsideComponent = function (component, simulatedEvent) {\n          var isEnterOrSpace = inSet(SPACE.concat(ENTER))(simulatedEvent.event);\n          if (keyingConfig.focusInside === FocusInsideModes.OnEnterOrSpaceMode && isEnterOrSpace && isSource(component, simulatedEvent)) {\n            optFocusIn(keyingConfig).each(function (focusIn) {\n              focusIn(component, keyingConfig, keyingState);\n              simulatedEvent.stop();\n            });\n          }\n        };\n        var keyboardEvents = [\n          run(keydown(), function (component, simulatedEvent) {\n            processKey(component, simulatedEvent, getKeydownRules, keyingConfig, keyingState).fold(function () {\n              tryGoInsideComponent(component, simulatedEvent);\n            }, function (_) {\n              simulatedEvent.stop();\n            });\n          }),\n          run(keyup(), function (component, simulatedEvent) {\n            processKey(component, simulatedEvent, getKeyupRules, keyingConfig, keyingState).each(function (_) {\n              simulatedEvent.stop();\n            });\n          })\n        ];\n        return derive(onFocusHandler.toArray().concat(keyboardEvents));\n      };\n      var me = {\n        schema: schema,\n        processKey: processKey,\n        toEvents: toEvents\n      };\n      return me;\n    };\n\n    var create$3 = function (cyclicField) {\n      var schema = [\n        option('onEscape'),\n        option('onEnter'),\n        defaulted$1('selector', '[data-alloy-tabstop=\"true\"]:not(:disabled)'),\n        defaulted$1('firstTabstop', 0),\n        defaulted$1('useTabstopAt', always),\n        option('visibilitySelector')\n      ].concat([cyclicField]);\n      var isVisible = function (tabbingConfig, element) {\n        var target = tabbingConfig.visibilitySelector.bind(function (sel) {\n          return closest$3(element, sel);\n        }).getOr(element);\n        return get$7(target) > 0;\n      };\n      var findInitial = function (component, tabbingConfig) {\n        var tabstops = descendants(component.element, tabbingConfig.selector);\n        var visibles = filter(tabstops, function (elem) {\n          return isVisible(tabbingConfig, elem);\n        });\n        return Optional.from(visibles[tabbingConfig.firstTabstop]);\n      };\n      var findCurrent = function (component, tabbingConfig) {\n        return tabbingConfig.focusManager.get(component).bind(function (elem) {\n          return closest$3(elem, tabbingConfig.selector);\n        });\n      };\n      var isTabstop = function (tabbingConfig, element) {\n        return isVisible(tabbingConfig, element) && tabbingConfig.useTabstopAt(element);\n      };\n      var focusIn = function (component, tabbingConfig, _tabbingState) {\n        findInitial(component, tabbingConfig).each(function (target) {\n          tabbingConfig.focusManager.set(component, target);\n        });\n      };\n      var goFromTabstop = function (component, tabstops, stopIndex, tabbingConfig, cycle) {\n        return cycle(tabstops, stopIndex, function (elem) {\n          return isTabstop(tabbingConfig, elem);\n        }).fold(function () {\n          return tabbingConfig.cyclic ? Optional.some(true) : Optional.none();\n        }, function (target) {\n          tabbingConfig.focusManager.set(component, target);\n          return Optional.some(true);\n        });\n      };\n      var go = function (component, _simulatedEvent, tabbingConfig, cycle) {\n        var tabstops = descendants(component.element, tabbingConfig.selector);\n        return findCurrent(component, tabbingConfig).bind(function (tabstop) {\n          var optStopIndex = findIndex(tabstops, curry(eq$1, tabstop));\n          return optStopIndex.bind(function (stopIndex) {\n            return goFromTabstop(component, tabstops, stopIndex, tabbingConfig, cycle);\n          });\n        });\n      };\n      var goBackwards = function (component, simulatedEvent, tabbingConfig) {\n        var navigate = tabbingConfig.cyclic ? cyclePrev : tryPrev;\n        return go(component, simulatedEvent, tabbingConfig, navigate);\n      };\n      var goForwards = function (component, simulatedEvent, tabbingConfig) {\n        var navigate = tabbingConfig.cyclic ? cycleNext : tryNext;\n        return go(component, simulatedEvent, tabbingConfig, navigate);\n      };\n      var execute = function (component, simulatedEvent, tabbingConfig) {\n        return tabbingConfig.onEnter.bind(function (f) {\n          return f(component, simulatedEvent);\n        });\n      };\n      var exit = function (component, simulatedEvent, tabbingConfig) {\n        return tabbingConfig.onEscape.bind(function (f) {\n          return f(component, simulatedEvent);\n        });\n      };\n      var getKeydownRules = constant([\n        rule(and([\n          isShift,\n          inSet(TAB)\n        ]), goBackwards),\n        rule(inSet(TAB), goForwards),\n        rule(inSet(ESCAPE), exit),\n        rule(and([\n          isNotShift,\n          inSet(ENTER)\n        ]), execute)\n      ]);\n      var getKeyupRules = constant([]);\n      return typical(schema, NoState.init, getKeydownRules, getKeyupRules, function () {\n        return Optional.some(focusIn);\n      });\n    };\n\n    var AcyclicType = create$3(state$1('cyclic', never));\n\n    var CyclicType = create$3(state$1('cyclic', always));\n\n    var doDefaultExecute = function (component, _simulatedEvent, focused) {\n      dispatch(component, focused, execute());\n      return Optional.some(true);\n    };\n    var defaultExecute = function (component, simulatedEvent, focused) {\n      var isComplex = inside(focused) && inSet(SPACE)(simulatedEvent.event);\n      return isComplex ? Optional.none() : doDefaultExecute(component, simulatedEvent, focused);\n    };\n    var stopEventForFirefox = function (_component, _simulatedEvent) {\n      return Optional.some(true);\n    };\n\n    var schema$4 = [\n      defaulted$1('execute', defaultExecute),\n      defaulted$1('useSpace', false),\n      defaulted$1('useEnter', true),\n      defaulted$1('useControlEnter', false),\n      defaulted$1('useDown', false)\n    ];\n    var execute$1 = function (component, simulatedEvent, executeConfig) {\n      return executeConfig.execute(component, simulatedEvent, component.element);\n    };\n    var getKeydownRules = function (component, _simulatedEvent, executeConfig, _executeState) {\n      var spaceExec = executeConfig.useSpace && !inside(component.element) ? SPACE : [];\n      var enterExec = executeConfig.useEnter ? ENTER : [];\n      var downExec = executeConfig.useDown ? DOWN : [];\n      var execKeys = spaceExec.concat(enterExec).concat(downExec);\n      return [rule(inSet(execKeys), execute$1)].concat(executeConfig.useControlEnter ? [rule(and([\n          isControl,\n          inSet(ENTER)\n        ]), execute$1)] : []);\n    };\n    var getKeyupRules = function (component, _simulatedEvent, executeConfig, _executeState) {\n      return executeConfig.useSpace && !inside(component.element) ? [rule(inSet(SPACE), stopEventForFirefox)] : [];\n    };\n    var ExecutionType = typical(schema$4, NoState.init, getKeydownRules, getKeyupRules, function () {\n      return Optional.none();\n    });\n\n    var flatgrid = function () {\n      var dimensions = Cell(Optional.none());\n      var setGridSize = function (numRows, numColumns) {\n        dimensions.set(Optional.some({\n          numRows: numRows,\n          numColumns: numColumns\n        }));\n      };\n      var getNumRows = function () {\n        return dimensions.get().map(function (d) {\n          return d.numRows;\n        });\n      };\n      var getNumColumns = function () {\n        return dimensions.get().map(function (d) {\n          return d.numColumns;\n        });\n      };\n      return nu$5({\n        readState: function () {\n          return dimensions.get().map(function (d) {\n            return {\n              numRows: String(d.numRows),\n              numColumns: String(d.numColumns)\n            };\n          }).getOr({\n            numRows: '?',\n            numColumns: '?'\n          });\n        },\n        setGridSize: setGridSize,\n        getNumRows: getNumRows,\n        getNumColumns: getNumColumns\n      });\n    };\n    var init$2 = function (spec) {\n      return spec.state(spec);\n    };\n\n    var KeyingState = /*#__PURE__*/Object.freeze({\n        __proto__: null,\n        flatgrid: flatgrid,\n        init: init$2\n    });\n\n    var useH = function (movement) {\n      return function (component, simulatedEvent, config, state) {\n        var move = movement(component.element);\n        return use(move, component, simulatedEvent, config, state);\n      };\n    };\n    var west$2 = function (moveLeft, moveRight) {\n      var movement = onDirection(moveLeft, moveRight);\n      return useH(movement);\n    };\n    var east$2 = function (moveLeft, moveRight) {\n      var movement = onDirection(moveRight, moveLeft);\n      return useH(movement);\n    };\n    var useV = function (move) {\n      return function (component, simulatedEvent, config, state) {\n        return use(move, component, simulatedEvent, config, state);\n      };\n    };\n    var use = function (move, component, simulatedEvent, config, state) {\n      var outcome = config.focusManager.get(component).bind(function (focused) {\n        return move(component.element, focused, config, state);\n      });\n      return outcome.map(function (newFocus) {\n        config.focusManager.set(component, newFocus);\n        return true;\n      });\n    };\n    var north$2 = useV;\n    var south$2 = useV;\n    var move = useV;\n\n    var isHidden = function (dom) {\n      return dom.offsetWidth <= 0 && dom.offsetHeight <= 0;\n    };\n    var isVisible = function (element) {\n      return !isHidden(element.dom);\n    };\n\n    var locate = function (candidates, predicate) {\n      return findIndex(candidates, predicate).map(function (index) {\n        return {\n          index: index,\n          candidates: candidates\n        };\n      });\n    };\n\n    var locateVisible = function (container, current, selector) {\n      var predicate = function (x) {\n        return eq$1(x, current);\n      };\n      var candidates = descendants(container, selector);\n      var visible = filter(candidates, isVisible);\n      return locate(visible, predicate);\n    };\n    var findIndex$1 = function (elements, target) {\n      return findIndex(elements, function (elem) {\n        return eq$1(target, elem);\n      });\n    };\n\n    var withGrid = function (values, index, numCols, f) {\n      var oldRow = Math.floor(index / numCols);\n      var oldColumn = index % numCols;\n      return f(oldRow, oldColumn).bind(function (address) {\n        var newIndex = address.row * numCols + address.column;\n        return newIndex >= 0 && newIndex < values.length ? Optional.some(values[newIndex]) : Optional.none();\n      });\n    };\n    var cycleHorizontal = function (values, index, numRows, numCols, delta) {\n      return withGrid(values, index, numCols, function (oldRow, oldColumn) {\n        var onLastRow = oldRow === numRows - 1;\n        var colsInRow = onLastRow ? values.length - oldRow * numCols : numCols;\n        var newColumn = cycleBy(oldColumn, delta, 0, colsInRow - 1);\n        return Optional.some({\n          row: oldRow,\n          column: newColumn\n        });\n      });\n    };\n    var cycleVertical = function (values, index, numRows, numCols, delta) {\n      return withGrid(values, index, numCols, function (oldRow, oldColumn) {\n        var newRow = cycleBy(oldRow, delta, 0, numRows - 1);\n        var onLastRow = newRow === numRows - 1;\n        var colsInRow = onLastRow ? values.length - newRow * numCols : numCols;\n        var newCol = clamp(oldColumn, 0, colsInRow - 1);\n        return Optional.some({\n          row: newRow,\n          column: newCol\n        });\n      });\n    };\n    var cycleRight = function (values, index, numRows, numCols) {\n      return cycleHorizontal(values, index, numRows, numCols, +1);\n    };\n    var cycleLeft = function (values, index, numRows, numCols) {\n      return cycleHorizontal(values, index, numRows, numCols, -1);\n    };\n    var cycleUp = function (values, index, numRows, numCols) {\n      return cycleVertical(values, index, numRows, numCols, -1);\n    };\n    var cycleDown = function (values, index, numRows, numCols) {\n      return cycleVertical(values, index, numRows, numCols, +1);\n    };\n\n    var schema$5 = [\n      strict$1('selector'),\n      defaulted$1('execute', defaultExecute),\n      onKeyboardHandler('onEscape'),\n      defaulted$1('captureTab', false),\n      initSize()\n    ];\n    var focusIn = function (component, gridConfig, _gridState) {\n      descendant$1(component.element, gridConfig.selector).each(function (first) {\n        gridConfig.focusManager.set(component, first);\n      });\n    };\n    var findCurrent = function (component, gridConfig) {\n      return gridConfig.focusManager.get(component).bind(function (elem) {\n        return closest$3(elem, gridConfig.selector);\n      });\n    };\n    var execute$2 = function (component, simulatedEvent, gridConfig, _gridState) {\n      return findCurrent(component, gridConfig).bind(function (focused) {\n        return gridConfig.execute(component, simulatedEvent, focused);\n      });\n    };\n    var doMove = function (cycle) {\n      return function (element, focused, gridConfig, gridState) {\n        return locateVisible(element, focused, gridConfig.selector).bind(function (identified) {\n          return cycle(identified.candidates, identified.index, gridState.getNumRows().getOr(gridConfig.initSize.numRows), gridState.getNumColumns().getOr(gridConfig.initSize.numColumns));\n        });\n      };\n    };\n    var handleTab = function (_component, _simulatedEvent, gridConfig) {\n      return gridConfig.captureTab ? Optional.some(true) : Optional.none();\n    };\n    var doEscape = function (component, simulatedEvent, gridConfig) {\n      return gridConfig.onEscape(component, simulatedEvent);\n    };\n    var moveLeft = doMove(cycleLeft);\n    var moveRight = doMove(cycleRight);\n    var moveNorth = doMove(cycleUp);\n    var moveSouth = doMove(cycleDown);\n    var getKeydownRules$1 = constant([\n      rule(inSet(LEFT), west$2(moveLeft, moveRight)),\n      rule(inSet(RIGHT), east$2(moveLeft, moveRight)),\n      rule(inSet(UP), north$2(moveNorth)),\n      rule(inSet(DOWN), south$2(moveSouth)),\n      rule(and([\n        isShift,\n        inSet(TAB)\n      ]), handleTab),\n      rule(and([\n        isNotShift,\n        inSet(TAB)\n      ]), handleTab),\n      rule(inSet(ESCAPE), doEscape),\n      rule(inSet(SPACE.concat(ENTER)), execute$2)\n    ]);\n    var getKeyupRules$1 = constant([rule(inSet(SPACE), stopEventForFirefox)]);\n    var FlatgridType = typical(schema$5, flatgrid, getKeydownRules$1, getKeyupRules$1, function () {\n      return Optional.some(focusIn);\n    });\n\n    var horizontal = function (container, selector, current, delta) {\n      var isDisabledButton = function (candidate) {\n        return name(candidate) === 'button' && get$3(candidate, 'disabled') === 'disabled';\n      };\n      var tryCycle = function (initial, index, candidates) {\n        var newIndex = cycleBy(index, delta, 0, candidates.length - 1);\n        if (newIndex === initial) {\n          return Optional.none();\n        } else {\n          return isDisabledButton(candidates[newIndex]) ? tryCycle(initial, newIndex, candidates) : Optional.from(candidates[newIndex]);\n        }\n      };\n      return locateVisible(container, current, selector).bind(function (identified) {\n        var index = identified.index;\n        var candidates = identified.candidates;\n        return tryCycle(index, index, candidates);\n      });\n    };\n\n    var schema$6 = [\n      strict$1('selector'),\n      defaulted$1('getInitial', Optional.none),\n      defaulted$1('execute', defaultExecute),\n      onKeyboardHandler('onEscape'),\n      defaulted$1('executeOnMove', false),\n      defaulted$1('allowVertical', true)\n    ];\n    var findCurrent$1 = function (component, flowConfig) {\n      return flowConfig.focusManager.get(component).bind(function (elem) {\n        return closest$3(elem, flowConfig.selector);\n      });\n    };\n    var execute$3 = function (component, simulatedEvent, flowConfig) {\n      return findCurrent$1(component, flowConfig).bind(function (focused) {\n        return flowConfig.execute(component, simulatedEvent, focused);\n      });\n    };\n    var focusIn$1 = function (component, flowConfig, _state) {\n      flowConfig.getInitial(component).orThunk(function () {\n        return descendant$1(component.element, flowConfig.selector);\n      }).each(function (first) {\n        flowConfig.focusManager.set(component, first);\n      });\n    };\n    var moveLeft$1 = function (element, focused, info) {\n      return horizontal(element, info.selector, focused, -1);\n    };\n    var moveRight$1 = function (element, focused, info) {\n      return horizontal(element, info.selector, focused, +1);\n    };\n    var doMove$1 = function (movement) {\n      return function (component, simulatedEvent, flowConfig, flowState) {\n        return movement(component, simulatedEvent, flowConfig, flowState).bind(function () {\n          return flowConfig.executeOnMove ? execute$3(component, simulatedEvent, flowConfig) : Optional.some(true);\n        });\n      };\n    };\n    var doEscape$1 = function (component, simulatedEvent, flowConfig) {\n      return flowConfig.onEscape(component, simulatedEvent);\n    };\n    var getKeydownRules$2 = function (_component, _se, flowConfig, _flowState) {\n      var westMovers = LEFT.concat(flowConfig.allowVertical ? UP : []);\n      var eastMovers = RIGHT.concat(flowConfig.allowVertical ? DOWN : []);\n      return [\n        rule(inSet(westMovers), doMove$1(west$2(moveLeft$1, moveRight$1))),\n        rule(inSet(eastMovers), doMove$1(east$2(moveLeft$1, moveRight$1))),\n        rule(inSet(ENTER), execute$3),\n        rule(inSet(SPACE), execute$3),\n        rule(inSet(ESCAPE), doEscape$1)\n      ];\n    };\n    var getKeyupRules$2 = constant([rule(inSet(SPACE), stopEventForFirefox)]);\n    var FlowType = typical(schema$6, NoState.init, getKeydownRules$2, getKeyupRules$2, function () {\n      return Optional.some(focusIn$1);\n    });\n\n    var toCell = function (matrix, rowIndex, columnIndex) {\n      return Optional.from(matrix[rowIndex]).bind(function (row) {\n        return Optional.from(row[columnIndex]).map(function (cell) {\n          return {\n            rowIndex: rowIndex,\n            columnIndex: columnIndex,\n            cell: cell\n          };\n        });\n      });\n    };\n    var cycleHorizontal$1 = function (matrix, rowIndex, startCol, deltaCol) {\n      var row = matrix[rowIndex];\n      var colsInRow = row.length;\n      var newColIndex = cycleBy(startCol, deltaCol, 0, colsInRow - 1);\n      return toCell(matrix, rowIndex, newColIndex);\n    };\n    var cycleVertical$1 = function (matrix, colIndex, startRow, deltaRow) {\n      var nextRowIndex = cycleBy(startRow, deltaRow, 0, matrix.length - 1);\n      var colsInNextRow = matrix[nextRowIndex].length;\n      var nextColIndex = clamp(colIndex, 0, colsInNextRow - 1);\n      return toCell(matrix, nextRowIndex, nextColIndex);\n    };\n    var moveHorizontal = function (matrix, rowIndex, startCol, deltaCol) {\n      var row = matrix[rowIndex];\n      var colsInRow = row.length;\n      var newColIndex = clamp(startCol + deltaCol, 0, colsInRow - 1);\n      return toCell(matrix, rowIndex, newColIndex);\n    };\n    var moveVertical = function (matrix, colIndex, startRow, deltaRow) {\n      var nextRowIndex = clamp(startRow + deltaRow, 0, matrix.length - 1);\n      var colsInNextRow = matrix[nextRowIndex].length;\n      var nextColIndex = clamp(colIndex, 0, colsInNextRow - 1);\n      return toCell(matrix, nextRowIndex, nextColIndex);\n    };\n    var cycleRight$1 = function (matrix, startRow, startCol) {\n      return cycleHorizontal$1(matrix, startRow, startCol, +1);\n    };\n    var cycleLeft$1 = function (matrix, startRow, startCol) {\n      return cycleHorizontal$1(matrix, startRow, startCol, -1);\n    };\n    var cycleUp$1 = function (matrix, startRow, startCol) {\n      return cycleVertical$1(matrix, startCol, startRow, -1);\n    };\n    var cycleDown$1 = function (matrix, startRow, startCol) {\n      return cycleVertical$1(matrix, startCol, startRow, +1);\n    };\n    var moveLeft$2 = function (matrix, startRow, startCol) {\n      return moveHorizontal(matrix, startRow, startCol, -1);\n    };\n    var moveRight$2 = function (matrix, startRow, startCol) {\n      return moveHorizontal(matrix, startRow, startCol, +1);\n    };\n    var moveUp = function (matrix, startRow, startCol) {\n      return moveVertical(matrix, startCol, startRow, -1);\n    };\n    var moveDown = function (matrix, startRow, startCol) {\n      return moveVertical(matrix, startCol, startRow, +1);\n    };\n\n    var schema$7 = [\n      strictObjOf('selectors', [\n        strict$1('row'),\n        strict$1('cell')\n      ]),\n      defaulted$1('cycles', true),\n      defaulted$1('previousSelector', Optional.none),\n      defaulted$1('execute', defaultExecute)\n    ];\n    var focusIn$2 = function (component, matrixConfig, _state) {\n      var focused = matrixConfig.previousSelector(component).orThunk(function () {\n        var selectors = matrixConfig.selectors;\n        return descendant$1(component.element, selectors.cell);\n      });\n      focused.each(function (cell) {\n        matrixConfig.focusManager.set(component, cell);\n      });\n    };\n    var execute$4 = function (component, simulatedEvent, matrixConfig) {\n      return search(component.element).bind(function (focused) {\n        return matrixConfig.execute(component, simulatedEvent, focused);\n      });\n    };\n    var toMatrix = function (rows, matrixConfig) {\n      return map(rows, function (row) {\n        return descendants(row, matrixConfig.selectors.cell);\n      });\n    };\n    var doMove$2 = function (ifCycle, ifMove) {\n      return function (element, focused, matrixConfig) {\n        var move = matrixConfig.cycles ? ifCycle : ifMove;\n        return closest$3(focused, matrixConfig.selectors.row).bind(function (inRow) {\n          var cellsInRow = descendants(inRow, matrixConfig.selectors.cell);\n          return findIndex$1(cellsInRow, focused).bind(function (colIndex) {\n            var allRows = descendants(element, matrixConfig.selectors.row);\n            return findIndex$1(allRows, inRow).bind(function (rowIndex) {\n              var matrix = toMatrix(allRows, matrixConfig);\n              return move(matrix, rowIndex, colIndex).map(function (next) {\n                return next.cell;\n              });\n            });\n          });\n        });\n      };\n    };\n    var moveLeft$3 = doMove$2(cycleLeft$1, moveLeft$2);\n    var moveRight$3 = doMove$2(cycleRight$1, moveRight$2);\n    var moveNorth$1 = doMove$2(cycleUp$1, moveUp);\n    var moveSouth$1 = doMove$2(cycleDown$1, moveDown);\n    var getKeydownRules$3 = constant([\n      rule(inSet(LEFT), west$2(moveLeft$3, moveRight$3)),\n      rule(inSet(RIGHT), east$2(moveLeft$3, moveRight$3)),\n      rule(inSet(UP), north$2(moveNorth$1)),\n      rule(inSet(DOWN), south$2(moveSouth$1)),\n      rule(inSet(SPACE.concat(ENTER)), execute$4)\n    ]);\n    var getKeyupRules$3 = constant([rule(inSet(SPACE), stopEventForFirefox)]);\n    var MatrixType = typical(schema$7, NoState.init, getKeydownRules$3, getKeyupRules$3, function () {\n      return Optional.some(focusIn$2);\n    });\n\n    var schema$8 = [\n      strict$1('selector'),\n      defaulted$1('execute', defaultExecute),\n      defaulted$1('moveOnTab', false)\n    ];\n    var execute$5 = function (component, simulatedEvent, menuConfig) {\n      return menuConfig.focusManager.get(component).bind(function (focused) {\n        return menuConfig.execute(component, simulatedEvent, focused);\n      });\n    };\n    var focusIn$3 = function (component, menuConfig, _state) {\n      descendant$1(component.element, menuConfig.selector).each(function (first) {\n        menuConfig.focusManager.set(component, first);\n      });\n    };\n    var moveUp$1 = function (element, focused, info) {\n      return horizontal(element, info.selector, focused, -1);\n    };\n    var moveDown$1 = function (element, focused, info) {\n      return horizontal(element, info.selector, focused, +1);\n    };\n    var fireShiftTab = function (component, simulatedEvent, menuConfig, menuState) {\n      return menuConfig.moveOnTab ? move(moveUp$1)(component, simulatedEvent, menuConfig, menuState) : Optional.none();\n    };\n    var fireTab = function (component, simulatedEvent, menuConfig, menuState) {\n      return menuConfig.moveOnTab ? move(moveDown$1)(component, simulatedEvent, menuConfig, menuState) : Optional.none();\n    };\n    var getKeydownRules$4 = constant([\n      rule(inSet(UP), move(moveUp$1)),\n      rule(inSet(DOWN), move(moveDown$1)),\n      rule(and([\n        isShift,\n        inSet(TAB)\n      ]), fireShiftTab),\n      rule(and([\n        isNotShift,\n        inSet(TAB)\n      ]), fireTab),\n      rule(inSet(ENTER), execute$5),\n      rule(inSet(SPACE), execute$5)\n    ]);\n    var getKeyupRules$4 = constant([rule(inSet(SPACE), stopEventForFirefox)]);\n    var MenuType = typical(schema$8, NoState.init, getKeydownRules$4, getKeyupRules$4, function () {\n      return Optional.some(focusIn$3);\n    });\n\n    var schema$9 = [\n      onKeyboardHandler('onSpace'),\n      onKeyboardHandler('onEnter'),\n      onKeyboardHandler('onShiftEnter'),\n      onKeyboardHandler('onLeft'),\n      onKeyboardHandler('onRight'),\n      onKeyboardHandler('onTab'),\n      onKeyboardHandler('onShiftTab'),\n      onKeyboardHandler('onUp'),\n      onKeyboardHandler('onDown'),\n      onKeyboardHandler('onEscape'),\n      defaulted$1('stopSpaceKeyup', false),\n      option('focusIn')\n    ];\n    var getKeydownRules$5 = function (component, simulatedEvent, specialInfo) {\n      return [\n        rule(inSet(SPACE), specialInfo.onSpace),\n        rule(and([\n          isNotShift,\n          inSet(ENTER)\n        ]), specialInfo.onEnter),\n        rule(and([\n          isShift,\n          inSet(ENTER)\n        ]), specialInfo.onShiftEnter),\n        rule(and([\n          isShift,\n          inSet(TAB)\n        ]), specialInfo.onShiftTab),\n        rule(and([\n          isNotShift,\n          inSet(TAB)\n        ]), specialInfo.onTab),\n        rule(inSet(UP), specialInfo.onUp),\n        rule(inSet(DOWN), specialInfo.onDown),\n        rule(inSet(LEFT), specialInfo.onLeft),\n        rule(inSet(RIGHT), specialInfo.onRight),\n        rule(inSet(SPACE), specialInfo.onSpace),\n        rule(inSet(ESCAPE), specialInfo.onEscape)\n      ];\n    };\n    var getKeyupRules$5 = function (component, simulatedEvent, specialInfo) {\n      return specialInfo.stopSpaceKeyup ? [rule(inSet(SPACE), stopEventForFirefox)] : [];\n    };\n    var SpecialType = typical(schema$9, NoState.init, getKeydownRules$5, getKeyupRules$5, function (specialInfo) {\n      return specialInfo.focusIn;\n    });\n\n    var acyclic = AcyclicType.schema();\n    var cyclic = CyclicType.schema();\n    var flow = FlowType.schema();\n    var flatgrid$1 = FlatgridType.schema();\n    var matrix = MatrixType.schema();\n    var execution = ExecutionType.schema();\n    var menu = MenuType.schema();\n    var special = SpecialType.schema();\n\n    var KeyboardBranches = /*#__PURE__*/Object.freeze({\n        __proto__: null,\n        acyclic: acyclic,\n        cyclic: cyclic,\n        flow: flow,\n        flatgrid: flatgrid$1,\n        matrix: matrix,\n        execution: execution,\n        menu: menu,\n        special: special\n    });\n\n    var isFlatgridState = function (keyState) {\n      return hasNonNullableKey(keyState, 'setGridSize');\n    };\n    var Keying = createModes$1({\n      branchKey: 'mode',\n      branches: KeyboardBranches,\n      name: 'keying',\n      active: {\n        events: function (keyingConfig, keyingState) {\n          var handler = keyingConfig.handler;\n          return handler.toEvents(keyingConfig, keyingState);\n        }\n      },\n      apis: {\n        focusIn: function (component, keyConfig, keyState) {\n          keyConfig.sendFocusIn(keyConfig).fold(function () {\n            component.getSystem().triggerFocus(component.element, component.element);\n          }, function (sendFocusIn) {\n            sendFocusIn(component, keyConfig, keyState);\n          });\n        },\n        setGridSize: function (component, keyConfig, keyState, numRows, numColumns) {\n          if (!isFlatgridState(keyState)) {\n            console.error('Layout does not support setGridSize');\n          } else {\n            keyState.setGridSize(numRows, numColumns);\n          }\n        }\n      },\n      state: KeyingState\n    });\n\n    var set$5 = function (component, replaceConfig, replaceState, data) {\n      preserve(function () {\n        var newChildren = map(data, component.getSystem().build);\n        replaceChildren(component, newChildren);\n      }, component.element);\n    };\n    var insert = function (component, replaceConfig, insertion, childSpec) {\n      var child = component.getSystem().build(childSpec);\n      attachWith(component, child, insertion);\n    };\n    var append$2 = function (component, replaceConfig, replaceState, appendee) {\n      insert(component, replaceConfig, append, appendee);\n    };\n    var prepend$1 = function (component, replaceConfig, replaceState, prependee) {\n      insert(component, replaceConfig, prepend, prependee);\n    };\n    var remove$7 = function (component, replaceConfig, replaceState, removee) {\n      var children = contents(component);\n      var foundChild = find(children, function (child) {\n        return eq$1(removee.element, child.element);\n      });\n      foundChild.each(detach);\n    };\n    var contents = function (component, _replaceConfig) {\n      return component.components();\n    };\n    var replaceAt = function (component, replaceConfig, replaceState, replaceeIndex, replacer) {\n      var children = contents(component);\n      return Optional.from(children[replaceeIndex]).map(function (replacee) {\n        remove$7(component, replaceConfig, replaceState, replacee);\n        replacer.each(function (r) {\n          insert(component, replaceConfig, function (p, c) {\n            appendAt(p, c, replaceeIndex);\n          }, r);\n        });\n        return replacee;\n      });\n    };\n    var replaceBy = function (component, replaceConfig, replaceState, replaceePred, replacer) {\n      var children = contents(component);\n      return findIndex(children, replaceePred).bind(function (replaceeIndex) {\n        return replaceAt(component, replaceConfig, replaceState, replaceeIndex, replacer);\n      });\n    };\n\n    var ReplaceApis = /*#__PURE__*/Object.freeze({\n        __proto__: null,\n        append: append$2,\n        prepend: prepend$1,\n        remove: remove$7,\n        replaceAt: replaceAt,\n        replaceBy: replaceBy,\n        set: set$5,\n        contents: contents\n    });\n\n    var Replacing = create$1({\n      fields: [],\n      name: 'replacing',\n      apis: ReplaceApis\n    });\n\n    var events$4 = function (name, eventHandlers) {\n      var events = derive(eventHandlers);\n      return create$1({\n        fields: [strict$1('enabled')],\n        name: name,\n        active: { events: constant(events) }\n      });\n    };\n    var config = function (name, eventHandlers) {\n      var me = events$4(name, eventHandlers);\n      return {\n        key: name,\n        value: {\n          config: {},\n          me: me,\n          configAsRaw: constant({}),\n          initialConfig: {},\n          state: NoState\n        }\n      };\n    };\n\n    var focus$2 = function (component, focusConfig) {\n      if (!focusConfig.ignore) {\n        focus$1(component.element);\n        focusConfig.onFocus(component);\n      }\n    };\n    var blur$1 = function (component, focusConfig) {\n      if (!focusConfig.ignore) {\n        blur(component.element);\n      }\n    };\n    var isFocused = function (component) {\n      return hasFocus(component.element);\n    };\n\n    var FocusApis = /*#__PURE__*/Object.freeze({\n        __proto__: null,\n        focus: focus$2,\n        blur: blur$1,\n        isFocused: isFocused\n    });\n\n    var exhibit$1 = function (base, focusConfig) {\n      var mod = focusConfig.ignore ? {} : { attributes: { tabindex: '-1' } };\n      return nu$6(mod);\n    };\n    var events$5 = function (focusConfig) {\n      return derive([run(focus(), function (component, simulatedEvent) {\n          focus$2(component, focusConfig);\n          simulatedEvent.stop();\n        })].concat(focusConfig.stopMousedown ? [run(mousedown(), function (_, simulatedEvent) {\n          simulatedEvent.event.prevent();\n        })] : []));\n    };\n\n    var ActiveFocus = /*#__PURE__*/Object.freeze({\n        __proto__: null,\n        exhibit: exhibit$1,\n        events: events$5\n    });\n\n    var FocusSchema = [\n      onHandler('onFocus'),\n      defaulted$1('stopMousedown', false),\n      defaulted$1('ignore', false)\n    ];\n\n    var Focusing = create$1({\n      fields: FocusSchema,\n      name: 'focusing',\n      active: ActiveFocus,\n      apis: FocusApis\n    });\n\n    var SetupBehaviourCellState = function (initialState) {\n      var init = function () {\n        var cell = Cell(initialState);\n        var get = function () {\n          return cell.get();\n        };\n        var set = function (newState) {\n          return cell.set(newState);\n        };\n        var clear = function () {\n          return cell.set(initialState);\n        };\n        var readState = function () {\n          return cell.get();\n        };\n        return {\n          get: get,\n          set: set,\n          clear: clear,\n          readState: readState\n        };\n      };\n      return { init: init };\n    };\n\n    var updateAriaState = function (component, toggleConfig, toggleState) {\n      var ariaInfo = toggleConfig.aria;\n      ariaInfo.update(component, ariaInfo, toggleState.get());\n    };\n    var updateClass = function (component, toggleConfig, toggleState) {\n      toggleConfig.toggleClass.each(function (toggleClass) {\n        if (toggleState.get()) {\n          add$2(component.element, toggleClass);\n        } else {\n          remove$4(component.element, toggleClass);\n        }\n      });\n    };\n    var toggle = function (component, toggleConfig, toggleState) {\n      set$6(component, toggleConfig, toggleState, !toggleState.get());\n    };\n    var on$1 = function (component, toggleConfig, toggleState) {\n      toggleState.set(true);\n      updateClass(component, toggleConfig, toggleState);\n      updateAriaState(component, toggleConfig, toggleState);\n    };\n    var off = function (component, toggleConfig, toggleState) {\n      toggleState.set(false);\n      updateClass(component, toggleConfig, toggleState);\n      updateAriaState(component, toggleConfig, toggleState);\n    };\n    var set$6 = function (component, toggleConfig, toggleState, state) {\n      var action = state ? on$1 : off;\n      action(component, toggleConfig, toggleState);\n    };\n    var isOn = function (component, toggleConfig, toggleState) {\n      return toggleState.get();\n    };\n    var onLoad$4 = function (component, toggleConfig, toggleState) {\n      set$6(component, toggleConfig, toggleState, toggleConfig.selected);\n    };\n\n    var ToggleApis = /*#__PURE__*/Object.freeze({\n        __proto__: null,\n        onLoad: onLoad$4,\n        toggle: toggle,\n        isOn: isOn,\n        on: on$1,\n        off: off,\n        set: set$6\n    });\n\n    var exhibit$2 = function () {\n      return nu$6({});\n    };\n    var events$6 = function (toggleConfig, toggleState) {\n      var execute = executeEvent(toggleConfig, toggleState, toggle);\n      var load = loadEvent(toggleConfig, toggleState, onLoad$4);\n      return derive(flatten([\n        toggleConfig.toggleOnExecute ? [execute] : [],\n        [load]\n      ]));\n    };\n\n    var ActiveToggle = /*#__PURE__*/Object.freeze({\n        __proto__: null,\n        exhibit: exhibit$2,\n        events: events$6\n    });\n\n    var updatePressed = function (component, ariaInfo, status) {\n      set$1(component.element, 'aria-pressed', status);\n      if (ariaInfo.syncWithExpanded) {\n        updateExpanded(component, ariaInfo, status);\n      }\n    };\n    var updateSelected = function (component, ariaInfo, status) {\n      set$1(component.element, 'aria-selected', status);\n    };\n    var updateChecked = function (component, ariaInfo, status) {\n      set$1(component.element, 'aria-checked', status);\n    };\n    var updateExpanded = function (component, ariaInfo, status) {\n      set$1(component.element, 'aria-expanded', status);\n    };\n\n    var ToggleSchema = [\n      defaulted$1('selected', false),\n      option('toggleClass'),\n      defaulted$1('toggleOnExecute', true),\n      defaultedOf('aria', { mode: 'none' }, choose$1('mode', {\n        pressed: [\n          defaulted$1('syncWithExpanded', false),\n          output('update', updatePressed)\n        ],\n        checked: [output('update', updateChecked)],\n        expanded: [output('update', updateExpanded)],\n        selected: [output('update', updateSelected)],\n        none: [output('update', noop)]\n      }))\n    ];\n\n    var Toggling = create$1({\n      fields: ToggleSchema,\n      name: 'toggling',\n      active: ActiveToggle,\n      apis: ToggleApis,\n      state: SetupBehaviourCellState(false)\n    });\n\n    var pointerEvents = function () {\n      var onClick = function (component, simulatedEvent) {\n        simulatedEvent.stop();\n        emitExecute(component);\n      };\n      return [\n        run(click(), onClick),\n        run(tap(), onClick),\n        cutter(touchstart()),\n        cutter(mousedown())\n      ];\n    };\n    var events$7 = function (optAction) {\n      var executeHandler = function (action) {\n        return runOnExecute(function (component, simulatedEvent) {\n          action(component);\n          simulatedEvent.stop();\n        });\n      };\n      return derive(flatten([\n        optAction.map(executeHandler).toArray(),\n        pointerEvents()\n      ]));\n    };\n\n    var hoverEvent = 'alloy.item-hover';\n    var focusEvent = 'alloy.item-focus';\n    var onHover = function (item) {\n      if (search(item.element).isNone() || Focusing.isFocused(item)) {\n        if (!Focusing.isFocused(item)) {\n          Focusing.focus(item);\n        }\n        emitWith(item, hoverEvent, { item: item });\n      }\n    };\n    var onFocus = function (item) {\n      emitWith(item, focusEvent, { item: item });\n    };\n    var hover = constant(hoverEvent);\n    var focus$3 = constant(focusEvent);\n\n    var builder = function (detail) {\n      return {\n        dom: detail.dom,\n        domModification: __assign(__assign({}, detail.domModification), { attributes: __assign(__assign(__assign({ 'role': detail.toggling.isSome() ? 'menuitemcheckbox' : 'menuitem' }, detail.domModification.attributes), { 'aria-haspopup': detail.hasSubmenu }), detail.hasSubmenu ? { 'aria-expanded': false } : {}) }),\n        behaviours: SketchBehaviours.augment(detail.itemBehaviours, [\n          detail.toggling.fold(Toggling.revoke, function (tConfig) {\n            return Toggling.config(__assign({ aria: { mode: 'checked' } }, tConfig));\n          }),\n          Focusing.config({\n            ignore: detail.ignoreFocus,\n            stopMousedown: detail.ignoreFocus,\n            onFocus: function (component) {\n              onFocus(component);\n            }\n          }),\n          Keying.config({ mode: 'execution' }),\n          Representing.config({\n            store: {\n              mode: 'memory',\n              initialValue: detail.data\n            }\n          }),\n          config('item-type-events', __spreadArrays(pointerEvents(), [\n            run(mouseover(), onHover),\n            run(focusItem(), Focusing.focus)\n          ]))\n        ]),\n        components: detail.components,\n        eventOrder: detail.eventOrder\n      };\n    };\n    var schema$a = [\n      strict$1('data'),\n      strict$1('components'),\n      strict$1('dom'),\n      defaulted$1('hasSubmenu', false),\n      option('toggling'),\n      SketchBehaviours.field('itemBehaviours', [\n        Toggling,\n        Focusing,\n        Keying,\n        Representing\n      ]),\n      defaulted$1('ignoreFocus', false),\n      defaulted$1('domModification', {}),\n      output('builder', builder),\n      defaulted$1('eventOrder', {})\n    ];\n\n    var builder$1 = function (detail) {\n      return {\n        dom: detail.dom,\n        components: detail.components,\n        events: derive([stopper(focusItem())])\n      };\n    };\n    var schema$b = [\n      strict$1('dom'),\n      strict$1('components'),\n      output('builder', builder$1)\n    ];\n\n    var owner$2 = constant('item-widget');\n    var parts = constant([required({\n        name: 'widget',\n        overrides: function (detail) {\n          return {\n            behaviours: derive$1([Representing.config({\n                store: {\n                  mode: 'manual',\n                  getValue: function (_component) {\n                    return detail.data;\n                  },\n                  setValue: noop\n                }\n              })])\n          };\n        }\n      })]);\n\n    var builder$2 = function (detail) {\n      var subs = substitutes(owner$2(), detail, parts());\n      var components$1 = components(owner$2(), detail, subs.internals());\n      var focusWidget = function (component) {\n        return getPart(component, detail, 'widget').map(function (widget) {\n          Keying.focusIn(widget);\n          return widget;\n        });\n      };\n      var onHorizontalArrow = function (component, simulatedEvent) {\n        return inside(simulatedEvent.event.target) ? Optional.none() : function () {\n          if (detail.autofocus) {\n            simulatedEvent.setSource(component.element);\n            return Optional.none();\n          } else {\n            return Optional.none();\n          }\n        }();\n      };\n      return {\n        dom: detail.dom,\n        components: components$1,\n        domModification: detail.domModification,\n        events: derive([\n          runOnExecute(function (component, simulatedEvent) {\n            focusWidget(component).each(function (_widget) {\n              simulatedEvent.stop();\n            });\n          }),\n          run(mouseover(), onHover),\n          run(focusItem(), function (component, _simulatedEvent) {\n            if (detail.autofocus) {\n              focusWidget(component);\n            } else {\n              Focusing.focus(component);\n            }\n          })\n        ]),\n        behaviours: SketchBehaviours.augment(detail.widgetBehaviours, [\n          Representing.config({\n            store: {\n              mode: 'memory',\n              initialValue: detail.data\n            }\n          }),\n          Focusing.config({\n            ignore: detail.ignoreFocus,\n            onFocus: function (component) {\n              onFocus(component);\n            }\n          }),\n          Keying.config({\n            mode: 'special',\n            focusIn: detail.autofocus ? function (component) {\n              focusWidget(component);\n            } : revoke(),\n            onLeft: onHorizontalArrow,\n            onRight: onHorizontalArrow,\n            onEscape: function (component, simulatedEvent) {\n              if (!Focusing.isFocused(component) && !detail.autofocus) {\n                Focusing.focus(component);\n                return Optional.some(true);\n              } else if (detail.autofocus) {\n                simulatedEvent.setSource(component.element);\n                return Optional.none();\n              } else {\n                return Optional.none();\n              }\n            }\n          })\n        ])\n      };\n    };\n    var schema$c = [\n      strict$1('uid'),\n      strict$1('data'),\n      strict$1('components'),\n      strict$1('dom'),\n      defaulted$1('autofocus', false),\n      defaulted$1('ignoreFocus', false),\n      SketchBehaviours.field('widgetBehaviours', [\n        Representing,\n        Focusing,\n        Keying\n      ]),\n      defaulted$1('domModification', {}),\n      defaultUidsSchema(parts()),\n      output('builder', builder$2)\n    ];\n\n    var itemSchema$1 = choose$1('type', {\n      widget: schema$c,\n      item: schema$a,\n      separator: schema$b\n    });\n    var configureGrid = function (detail, movementInfo) {\n      return {\n        mode: 'flatgrid',\n        selector: '.' + detail.markers.item,\n        initSize: {\n          numColumns: movementInfo.initSize.numColumns,\n          numRows: movementInfo.initSize.numRows\n        },\n        focusManager: detail.focusManager\n      };\n    };\n    var configureMatrix = function (detail, movementInfo) {\n      return {\n        mode: 'matrix',\n        selectors: {\n          row: movementInfo.rowSelector,\n          cell: '.' + detail.markers.item\n        },\n        focusManager: detail.focusManager\n      };\n    };\n    var configureMenu = function (detail, movementInfo) {\n      return {\n        mode: 'menu',\n        selector: '.' + detail.markers.item,\n        moveOnTab: movementInfo.moveOnTab,\n        focusManager: detail.focusManager\n      };\n    };\n    var parts$1 = constant([group({\n        factory: {\n          sketch: function (spec) {\n            var itemInfo = asRawOrDie('menu.spec item', itemSchema$1, spec);\n            return itemInfo.builder(itemInfo);\n          }\n        },\n        name: 'items',\n        unit: 'item',\n        defaults: function (detail, u) {\n          return u.hasOwnProperty('uid') ? u : __assign(__assign({}, u), { uid: generate$2('item') });\n        },\n        overrides: function (detail, u) {\n          return {\n            type: u.type,\n            ignoreFocus: detail.fakeFocus,\n            domModification: { classes: [detail.markers.item] }\n          };\n        }\n      })]);\n    var schema$d = constant([\n      strict$1('value'),\n      strict$1('items'),\n      strict$1('dom'),\n      strict$1('components'),\n      defaulted$1('eventOrder', {}),\n      field$1('menuBehaviours', [\n        Highlighting,\n        Representing,\n        Composing,\n        Keying\n      ]),\n      defaultedOf('movement', {\n        mode: 'menu',\n        moveOnTab: true\n      }, choose$1('mode', {\n        grid: [\n          initSize(),\n          output('config', configureGrid)\n        ],\n        matrix: [\n          output('config', configureMatrix),\n          strict$1('rowSelector')\n        ],\n        menu: [\n          defaulted$1('moveOnTab', true),\n          output('config', configureMenu)\n        ]\n      })),\n      itemMarkers(),\n      defaulted$1('fakeFocus', false),\n      defaulted$1('focusManager', dom()),\n      onHandler('onHighlight')\n    ]);\n\n    var focus$4 = constant('alloy.menu-focus');\n\n    var make$1 = function (detail, components, _spec, _externals) {\n      return {\n        uid: detail.uid,\n        dom: detail.dom,\n        markers: detail.markers,\n        behaviours: augment(detail.menuBehaviours, [\n          Highlighting.config({\n            highlightClass: detail.markers.selectedItem,\n            itemClass: detail.markers.item,\n            onHighlight: detail.onHighlight\n          }),\n          Representing.config({\n            store: {\n              mode: 'memory',\n              initialValue: detail.value\n            }\n          }),\n          Composing.config({ find: Optional.some }),\n          Keying.config(detail.movement.config(detail, detail.movement))\n        ]),\n        events: derive([\n          run(focus$3(), function (menu, simulatedEvent) {\n            var event = simulatedEvent.event;\n            menu.getSystem().getByDom(event.target).each(function (item) {\n              Highlighting.highlight(menu, item);\n              simulatedEvent.stop();\n              emitWith(menu, focus$4(), {\n                menu: menu,\n                item: item\n              });\n            });\n          }),\n          run(hover(), function (menu, simulatedEvent) {\n            var item = simulatedEvent.event.item;\n            Highlighting.highlight(menu, item);\n          })\n        ]),\n        components: components,\n        eventOrder: detail.eventOrder,\n        domModification: { attributes: { role: 'menu' } }\n      };\n    };\n\n    var Menu = composite$1({\n      name: 'Menu',\n      configFields: schema$d(),\n      partFields: parts$1(),\n      factory: make$1\n    });\n\n    var transpose = function (obj) {\n      return tupleMap(obj, function (v, k) {\n        return {\n          k: v,\n          v: k\n        };\n      });\n    };\n    var trace = function (items, byItem, byMenu, finish) {\n      return get$1(byMenu, finish).bind(function (triggerItem) {\n        return get$1(items, triggerItem).bind(function (triggerMenu) {\n          var rest = trace(items, byItem, byMenu, triggerMenu);\n          return Optional.some([triggerMenu].concat(rest));\n        });\n      }).getOr([]);\n    };\n    var generate$5 = function (menus, expansions) {\n      var items = {};\n      each$1(menus, function (menuItems, menu) {\n        each(menuItems, function (item) {\n          items[item] = menu;\n        });\n      });\n      var byItem = expansions;\n      var byMenu = transpose(expansions);\n      var menuPaths = map$2(byMenu, function (_triggerItem, submenu) {\n        return [submenu].concat(trace(items, byItem, byMenu, submenu));\n      });\n      return map$2(items, function (menu) {\n        return get$1(menuPaths, menu).getOr([menu]);\n      });\n    };\n\n    var init$3 = function () {\n      var expansions = Cell({});\n      var menus = Cell({});\n      var paths = Cell({});\n      var primary = Cell(Optional.none());\n      var directory = Cell({});\n      var clear = function () {\n        expansions.set({});\n        menus.set({});\n        paths.set({});\n        primary.set(Optional.none());\n      };\n      var isClear = function () {\n        return primary.get().isNone();\n      };\n      var setMenuBuilt = function (menuName, built) {\n        var _a;\n        menus.set(__assign(__assign({}, menus.get()), (_a = {}, _a[menuName] = {\n          type: 'prepared',\n          menu: built\n        }, _a)));\n      };\n      var setContents = function (sPrimary, sMenus, sExpansions, dir) {\n        primary.set(Optional.some(sPrimary));\n        expansions.set(sExpansions);\n        menus.set(sMenus);\n        directory.set(dir);\n        var sPaths = generate$5(dir, sExpansions);\n        paths.set(sPaths);\n      };\n      var getTriggeringItem = function (menuValue) {\n        return find$1(expansions.get(), function (v, _k) {\n          return v === menuValue;\n        });\n      };\n      var getTriggerData = function (menuValue, getItemByValue, path) {\n        return getPreparedMenu(menuValue).bind(function (menu) {\n          return getTriggeringItem(menuValue).bind(function (triggeringItemValue) {\n            return getItemByValue(triggeringItemValue).map(function (triggeredItem) {\n              return {\n                triggeredMenu: menu,\n                triggeringItem: triggeredItem,\n                triggeringPath: path\n              };\n            });\n          });\n        });\n      };\n      var getTriggeringPath = function (itemValue, getItemByValue) {\n        var extraPath = filter(lookupItem(itemValue).toArray(), function (menuValue) {\n          return getPreparedMenu(menuValue).isSome();\n        });\n        return get$1(paths.get(), itemValue).bind(function (path) {\n          var revPath = reverse(extraPath.concat(path));\n          var triggers = bind(revPath, function (menuValue, menuIndex) {\n            return getTriggerData(menuValue, getItemByValue, revPath.slice(0, menuIndex + 1)).fold(function () {\n              return primary.get().is(menuValue) ? [] : [Optional.none()];\n            }, function (data) {\n              return [Optional.some(data)];\n            });\n          });\n          return sequence(triggers);\n        });\n      };\n      var expand = function (itemValue) {\n        return get$1(expansions.get(), itemValue).map(function (menu) {\n          var current = get$1(paths.get(), itemValue).getOr([]);\n          return [menu].concat(current);\n        });\n      };\n      var collapse = function (itemValue) {\n        return get$1(paths.get(), itemValue).bind(function (path) {\n          return path.length > 1 ? Optional.some(path.slice(1)) : Optional.none();\n        });\n      };\n      var refresh = function (itemValue) {\n        return get$1(paths.get(), itemValue);\n      };\n      var getPreparedMenu = function (menuValue) {\n        return lookupMenu(menuValue).bind(extractPreparedMenu);\n      };\n      var lookupMenu = function (menuValue) {\n        return get$1(menus.get(), menuValue);\n      };\n      var lookupItem = function (itemValue) {\n        return get$1(expansions.get(), itemValue);\n      };\n      var otherMenus = function (path) {\n        var menuValues = directory.get();\n        return difference(keys(menuValues), path);\n      };\n      var getPrimary = function () {\n        return primary.get().bind(getPreparedMenu);\n      };\n      var getMenus = function () {\n        return menus.get();\n      };\n      return {\n        setMenuBuilt: setMenuBuilt,\n        setContents: setContents,\n        expand: expand,\n        refresh: refresh,\n        collapse: collapse,\n        lookupMenu: lookupMenu,\n        lookupItem: lookupItem,\n        otherMenus: otherMenus,\n        getPrimary: getPrimary,\n        getMenus: getMenus,\n        clear: clear,\n        isClear: isClear,\n        getTriggeringPath: getTriggeringPath\n      };\n    };\n    var extractPreparedMenu = function (prep) {\n      return prep.type === 'prepared' ? Optional.some(prep.menu) : Optional.none();\n    };\n    var LayeredState = {\n      init: init$3,\n      extractPreparedMenu: extractPreparedMenu\n    };\n\n    var make$2 = function (detail, _rawUiSpec) {\n      var submenuParentItems = Cell(Optional.none());\n      var buildMenus = function (container, primaryName, menus) {\n        return map$2(menus, function (spec, name) {\n          var makeSketch = function () {\n            return Menu.sketch(__assign(__assign({}, spec), {\n              value: name,\n              markers: detail.markers,\n              fakeFocus: detail.fakeFocus,\n              onHighlight: detail.onHighlight,\n              focusManager: detail.fakeFocus ? highlights() : dom()\n            }));\n          };\n          return name === primaryName ? {\n            type: 'prepared',\n            menu: container.getSystem().build(makeSketch())\n          } : {\n            type: 'notbuilt',\n            nbMenu: makeSketch\n          };\n        });\n      };\n      var layeredState = LayeredState.init();\n      var setup = function (container) {\n        var componentMap = buildMenus(container, detail.data.primary, detail.data.menus);\n        var directory = toDirectory();\n        layeredState.setContents(detail.data.primary, componentMap, detail.data.expansions, directory);\n        return layeredState.getPrimary();\n      };\n      var getItemValue = function (item) {\n        return Representing.getValue(item).value;\n      };\n      var getItemByValue = function (_container, menus, itemValue) {\n        return findMap(menus, function (menu) {\n          if (!menu.getSystem().isConnected()) {\n            return Optional.none();\n          }\n          var candidates = Highlighting.getCandidates(menu);\n          return find(candidates, function (c) {\n            return getItemValue(c) === itemValue;\n          });\n        });\n      };\n      var toDirectory = function (_container) {\n        return map$2(detail.data.menus, function (data, _menuName) {\n          return bind(data.items, function (item) {\n            return item.type === 'separator' ? [] : [item.data.value];\n          });\n        });\n      };\n      var setActiveMenu = function (container, menu) {\n        Highlighting.highlight(container, menu);\n        Highlighting.getHighlighted(menu).orThunk(function () {\n          return Highlighting.getFirst(menu);\n        }).each(function (item) {\n          dispatch(container, item.element, focusItem());\n        });\n      };\n      var getMenus = function (state, menuValues) {\n        return cat(map(menuValues, function (mv) {\n          return state.lookupMenu(mv).bind(function (prep) {\n            return prep.type === 'prepared' ? Optional.some(prep.menu) : Optional.none();\n          });\n        }));\n      };\n      var closeOthers = function (container, state, path) {\n        var others = getMenus(state, state.otherMenus(path));\n        each(others, function (o) {\n          remove$5(o.element, [detail.markers.backgroundMenu]);\n          if (!detail.stayInDom) {\n            Replacing.remove(container, o);\n          }\n        });\n      };\n      var getSubmenuParents = function (container) {\n        return submenuParentItems.get().getOrThunk(function () {\n          var r = {};\n          var items = descendants(container.element, '.' + detail.markers.item);\n          var parentItems = filter(items, function (i) {\n            return get$3(i, 'aria-haspopup') === 'true';\n          });\n          each(parentItems, function (i) {\n            container.getSystem().getByDom(i).each(function (itemComp) {\n              var key = getItemValue(itemComp);\n              r[key] = itemComp;\n            });\n          });\n          submenuParentItems.set(Optional.some(r));\n          return r;\n        });\n      };\n      var updateAriaExpansions = function (container, path) {\n        var parentItems = getSubmenuParents(container);\n        each$1(parentItems, function (v, k) {\n          var expanded = contains(path, k);\n          set$1(v.element, 'aria-expanded', expanded);\n        });\n      };\n      var updateMenuPath = function (container, state, path) {\n        return Optional.from(path[0]).bind(function (latestMenuName) {\n          return state.lookupMenu(latestMenuName).bind(function (menuPrep) {\n            if (menuPrep.type === 'notbuilt') {\n              return Optional.none();\n            } else {\n              var activeMenu = menuPrep.menu;\n              var rest = getMenus(state, path.slice(1));\n              each(rest, function (r) {\n                add$2(r.element, detail.markers.backgroundMenu);\n              });\n              if (!inBody(activeMenu.element)) {\n                Replacing.append(container, premade$1(activeMenu));\n              }\n              remove$5(activeMenu.element, [detail.markers.backgroundMenu]);\n              setActiveMenu(container, activeMenu);\n              closeOthers(container, state, path);\n              return Optional.some(activeMenu);\n            }\n          });\n        });\n      };\n      var ExpandHighlightDecision;\n      (function (ExpandHighlightDecision) {\n        ExpandHighlightDecision[ExpandHighlightDecision['HighlightSubmenu'] = 0] = 'HighlightSubmenu';\n        ExpandHighlightDecision[ExpandHighlightDecision['HighlightParent'] = 1] = 'HighlightParent';\n      }(ExpandHighlightDecision || (ExpandHighlightDecision = {})));\n      var buildIfRequired = function (container, menuName, menuPrep) {\n        if (menuPrep.type === 'notbuilt') {\n          var menu = container.getSystem().build(menuPrep.nbMenu());\n          layeredState.setMenuBuilt(menuName, menu);\n          return menu;\n        } else {\n          return menuPrep.menu;\n        }\n      };\n      var expandRight = function (container, item, decision) {\n        if (decision === void 0) {\n          decision = ExpandHighlightDecision.HighlightSubmenu;\n        }\n        var value = getItemValue(item);\n        return layeredState.expand(value).bind(function (path) {\n          updateAriaExpansions(container, path);\n          return Optional.from(path[0]).bind(function (menuName) {\n            return layeredState.lookupMenu(menuName).bind(function (activeMenuPrep) {\n              var activeMenu = buildIfRequired(container, menuName, activeMenuPrep);\n              if (!inBody(activeMenu.element)) {\n                Replacing.append(container, premade$1(activeMenu));\n              }\n              detail.onOpenSubmenu(container, item, activeMenu, reverse(path));\n              if (decision === ExpandHighlightDecision.HighlightSubmenu) {\n                Highlighting.highlightFirst(activeMenu);\n                return updateMenuPath(container, layeredState, path);\n              } else {\n                Highlighting.dehighlightAll(activeMenu);\n                return Optional.some(item);\n              }\n            });\n          });\n        });\n      };\n      var collapseLeft = function (container, item) {\n        var value = getItemValue(item);\n        return layeredState.collapse(value).bind(function (path) {\n          updateAriaExpansions(container, path);\n          return updateMenuPath(container, layeredState, path).map(function (activeMenu) {\n            detail.onCollapseMenu(container, item, activeMenu);\n            return activeMenu;\n          });\n        });\n      };\n      var updateView = function (container, item) {\n        var value = getItemValue(item);\n        return layeredState.refresh(value).bind(function (path) {\n          updateAriaExpansions(container, path);\n          return updateMenuPath(container, layeredState, path);\n        });\n      };\n      var onRight = function (container, item) {\n        return inside(item.element) ? Optional.none() : expandRight(container, item, ExpandHighlightDecision.HighlightSubmenu);\n      };\n      var onLeft = function (container, item) {\n        return inside(item.element) ? Optional.none() : collapseLeft(container, item);\n      };\n      var onEscape = function (container, item) {\n        return collapseLeft(container, item).orThunk(function () {\n          return detail.onEscape(container, item).map(function () {\n            return container;\n          });\n        });\n      };\n      var keyOnItem = function (f) {\n        return function (container, simulatedEvent) {\n          return closest$3(simulatedEvent.getSource(), '.' + detail.markers.item).bind(function (target) {\n            return container.getSystem().getByDom(target).toOptional().bind(function (item) {\n              return f(container, item).map(always);\n            });\n          });\n        };\n      };\n      var events = derive([\n        run(focus$4(), function (sandbox, simulatedEvent) {\n          var item = simulatedEvent.event.item;\n          layeredState.lookupItem(getItemValue(item)).each(function () {\n            var menu = simulatedEvent.event.menu;\n            Highlighting.highlight(sandbox, menu);\n            var value = getItemValue(simulatedEvent.event.item);\n            layeredState.refresh(value).each(function (path) {\n              return closeOthers(sandbox, layeredState, path);\n            });\n          });\n        }),\n        runOnExecute(function (component, simulatedEvent) {\n          var target = simulatedEvent.event.target;\n          component.getSystem().getByDom(target).each(function (item) {\n            var itemValue = getItemValue(item);\n            if (itemValue.indexOf('collapse-item') === 0) {\n              collapseLeft(component, item);\n            }\n            expandRight(component, item, ExpandHighlightDecision.HighlightSubmenu).fold(function () {\n              detail.onExecute(component, item);\n            }, noop);\n          });\n        }),\n        runOnAttached(function (container, _simulatedEvent) {\n          setup(container).each(function (primary) {\n            Replacing.append(container, premade$1(primary));\n            detail.onOpenMenu(container, primary);\n            if (detail.highlightImmediately) {\n              setActiveMenu(container, primary);\n            }\n          });\n        })\n      ].concat(detail.navigateOnHover ? [run(hover(), function (sandbox, simulatedEvent) {\n          var item = simulatedEvent.event.item;\n          updateView(sandbox, item);\n          expandRight(sandbox, item, ExpandHighlightDecision.HighlightParent);\n          detail.onHover(sandbox, item);\n        })] : []));\n      var getActiveItem = function (container) {\n        return Highlighting.getHighlighted(container).bind(Highlighting.getHighlighted);\n      };\n      var collapseMenuApi = function (container) {\n        getActiveItem(container).each(function (currentItem) {\n          collapseLeft(container, currentItem);\n        });\n      };\n      var highlightPrimary = function (container) {\n        layeredState.getPrimary().each(function (primary) {\n          setActiveMenu(container, primary);\n        });\n      };\n      var extractMenuFromContainer = function (container) {\n        return Optional.from(container.components()[0]).filter(function (comp) {\n          return get$3(comp.element, 'role') === 'menu';\n        });\n      };\n      var repositionMenus = function (container) {\n        var maybeActivePrimary = layeredState.getPrimary().bind(function (primary) {\n          return getActiveItem(container).bind(function (currentItem) {\n            var itemValue = getItemValue(currentItem);\n            var allMenus = values(layeredState.getMenus());\n            var preparedMenus = cat(map(allMenus, LayeredState.extractPreparedMenu));\n            return layeredState.getTriggeringPath(itemValue, function (v) {\n              return getItemByValue(container, preparedMenus, v);\n            });\n          }).map(function (triggeringPath) {\n            return {\n              primary: primary,\n              triggeringPath: triggeringPath\n            };\n          });\n        });\n        maybeActivePrimary.fold(function () {\n          extractMenuFromContainer(container).each(function (primaryMenu) {\n            detail.onRepositionMenu(container, primaryMenu, []);\n          });\n        }, function (_a) {\n          var primary = _a.primary, triggeringPath = _a.triggeringPath;\n          detail.onRepositionMenu(container, primary, triggeringPath);\n        });\n      };\n      var apis = {\n        collapseMenu: collapseMenuApi,\n        highlightPrimary: highlightPrimary,\n        repositionMenus: repositionMenus\n      };\n      return {\n        uid: detail.uid,\n        dom: detail.dom,\n        markers: detail.markers,\n        behaviours: augment(detail.tmenuBehaviours, [\n          Keying.config({\n            mode: 'special',\n            onRight: keyOnItem(onRight),\n            onLeft: keyOnItem(onLeft),\n            onEscape: keyOnItem(onEscape),\n            focusIn: function (container, _keyInfo) {\n              layeredState.getPrimary().each(function (primary) {\n                dispatch(container, primary.element, focusItem());\n              });\n            }\n          }),\n          Highlighting.config({\n            highlightClass: detail.markers.selectedMenu,\n            itemClass: detail.markers.menu\n          }),\n          Composing.config({\n            find: function (container) {\n              return Highlighting.getHighlighted(container);\n            }\n          }),\n          Replacing.config({})\n        ]),\n        eventOrder: detail.eventOrder,\n        apis: apis,\n        events: events\n      };\n    };\n    var collapseItem = constant('collapse-item');\n\n    var tieredData = function (primary, menus, expansions) {\n      return {\n        primary: primary,\n        menus: menus,\n        expansions: expansions\n      };\n    };\n    var singleData = function (name, menu) {\n      return {\n        primary: name,\n        menus: wrap$1(name, menu),\n        expansions: {}\n      };\n    };\n    var collapseItem$1 = function (text) {\n      return {\n        value: generate$1(collapseItem()),\n        meta: { text: text }\n      };\n    };\n    var tieredMenu = single$2({\n      name: 'TieredMenu',\n      configFields: [\n        onStrictKeyboardHandler('onExecute'),\n        onStrictKeyboardHandler('onEscape'),\n        onStrictHandler('onOpenMenu'),\n        onStrictHandler('onOpenSubmenu'),\n        onHandler('onRepositionMenu'),\n        onHandler('onCollapseMenu'),\n        defaulted$1('highlightImmediately', true),\n        strictObjOf('data', [\n          strict$1('primary'),\n          strict$1('menus'),\n          strict$1('expansions')\n        ]),\n        defaulted$1('fakeFocus', false),\n        onHandler('onHighlight'),\n        onHandler('onHover'),\n        tieredMenuMarkers(),\n        strict$1('dom'),\n        defaulted$1('navigateOnHover', true),\n        defaulted$1('stayInDom', false),\n        field$1('tmenuBehaviours', [\n          Keying,\n          Highlighting,\n          Composing,\n          Replacing\n        ]),\n        defaulted$1('eventOrder', {})\n      ],\n      apis: {\n        collapseMenu: function (apis, tmenu) {\n          apis.collapseMenu(tmenu);\n        },\n        highlightPrimary: function (apis, tmenu) {\n          apis.highlightPrimary(tmenu);\n        },\n        repositionMenus: function (apis, tmenu) {\n          apis.repositionMenus(tmenu);\n        }\n      },\n      factory: make$2,\n      extraApis: {\n        tieredData: tieredData,\n        singleData: singleData,\n        collapseItem: collapseItem$1\n      }\n    });\n\n    var makeMenu = function (detail, menuSandbox, anchor, menuSpec, getBounds) {\n      var lazySink = function () {\n        return detail.lazySink(menuSandbox);\n      };\n      var layouts = menuSpec.type === 'horizontal' ? {\n        layouts: {\n          onLtr: function () {\n            return belowOrAbove();\n          },\n          onRtl: function () {\n            return belowOrAboveRtl();\n          }\n        }\n      } : {};\n      var isFirstTierSubmenu = function (triggeringPaths) {\n        return triggeringPaths.length === 2;\n      };\n      var getSubmenuLayouts = function (triggeringPaths) {\n        return isFirstTierSubmenu(triggeringPaths) ? layouts : {};\n      };\n      return tieredMenu.sketch({\n        dom: { tag: 'div' },\n        data: menuSpec.data,\n        markers: menuSpec.menu.markers,\n        highlightImmediately: menuSpec.menu.highlightImmediately,\n        onEscape: function () {\n          Sandboxing.close(menuSandbox);\n          detail.onEscape.map(function (handler) {\n            return handler(menuSandbox);\n          });\n          return Optional.some(true);\n        },\n        onExecute: function () {\n          return Optional.some(true);\n        },\n        onOpenMenu: function (tmenu, menu) {\n          Positioning.positionWithinBounds(lazySink().getOrDie(), anchor, menu, getBounds());\n        },\n        onOpenSubmenu: function (tmenu, item, submenu, triggeringPaths) {\n          var sink = lazySink().getOrDie();\n          Positioning.position(sink, __assign({\n            anchor: 'submenu',\n            item: item\n          }, getSubmenuLayouts(triggeringPaths)), submenu);\n        },\n        onRepositionMenu: function (tmenu, primaryMenu, submenuTriggers) {\n          var sink = lazySink().getOrDie();\n          Positioning.positionWithinBounds(sink, anchor, primaryMenu, getBounds());\n          each(submenuTriggers, function (st) {\n            var submenuLayouts = getSubmenuLayouts(st.triggeringPath);\n            Positioning.position(sink, __assign({\n              anchor: 'submenu',\n              item: st.triggeringItem\n            }, submenuLayouts), st.triggeredMenu);\n          });\n        }\n      });\n    };\n    var factory = function (detail, spec) {\n      var isPartOfRelated = function (sandbox, queryElem) {\n        var related = detail.getRelated(sandbox);\n        return related.exists(function (rel) {\n          return isPartOf(rel, queryElem);\n        });\n      };\n      var setContent = function (sandbox, thing) {\n        Sandboxing.setContent(sandbox, thing);\n      };\n      var showAt = function (sandbox, anchor, thing) {\n        showWithin(sandbox, anchor, thing, Optional.none());\n      };\n      var showWithin = function (sandbox, anchor, thing, boxElement) {\n        showWithinBounds(sandbox, anchor, thing, function () {\n          return boxElement.map(function (elem) {\n            return box(elem);\n          });\n        });\n      };\n      var showWithinBounds = function (sandbox, anchor, thing, getBounds) {\n        var sink = detail.lazySink(sandbox).getOrDie();\n        Sandboxing.openWhileCloaked(sandbox, thing, function () {\n          return Positioning.positionWithinBounds(sink, anchor, sandbox, getBounds());\n        });\n        Representing.setValue(sandbox, Optional.some({\n          mode: 'position',\n          anchor: anchor,\n          getBounds: getBounds\n        }));\n      };\n      var showMenuAt = function (sandbox, anchor, menuSpec) {\n        showMenuWithinBounds(sandbox, anchor, menuSpec, function () {\n          return Optional.none();\n        });\n      };\n      var showMenuWithinBounds = function (sandbox, anchor, menuSpec, getBounds) {\n        var menu = makeMenu(detail, sandbox, anchor, menuSpec, getBounds);\n        Sandboxing.open(sandbox, menu);\n        Representing.setValue(sandbox, Optional.some({\n          mode: 'menu',\n          menu: menu\n        }));\n      };\n      var hide = function (sandbox) {\n        if (Sandboxing.isOpen(sandbox)) {\n          Representing.setValue(sandbox, Optional.none());\n          Sandboxing.close(sandbox);\n        }\n      };\n      var getContent = function (sandbox) {\n        return Sandboxing.getState(sandbox);\n      };\n      var reposition = function (sandbox) {\n        if (Sandboxing.isOpen(sandbox)) {\n          Representing.getValue(sandbox).each(function (state) {\n            switch (state.mode) {\n            case 'menu':\n              Sandboxing.getState(sandbox).each(function (tmenu) {\n                tieredMenu.repositionMenus(tmenu);\n              });\n              break;\n            case 'position':\n              var sink = detail.lazySink(sandbox).getOrDie();\n              Positioning.positionWithinBounds(sink, state.anchor, sandbox, state.getBounds());\n              break;\n            }\n          });\n        }\n      };\n      var apis = {\n        setContent: setContent,\n        showAt: showAt,\n        showWithin: showWithin,\n        showWithinBounds: showWithinBounds,\n        showMenuAt: showMenuAt,\n        showMenuWithinBounds: showMenuWithinBounds,\n        hide: hide,\n        getContent: getContent,\n        reposition: reposition,\n        isOpen: Sandboxing.isOpen\n      };\n      return {\n        uid: detail.uid,\n        dom: detail.dom,\n        behaviours: augment(detail.inlineBehaviours, [\n          Sandboxing.config({\n            isPartOf: function (sandbox, data, queryElem) {\n              return isPartOf(data, queryElem) || isPartOfRelated(sandbox, queryElem);\n            },\n            getAttachPoint: function (sandbox) {\n              return detail.lazySink(sandbox).getOrDie();\n            },\n            onOpen: function (sandbox) {\n              detail.onShow(sandbox);\n            },\n            onClose: function (sandbox) {\n              detail.onHide(sandbox);\n            }\n          }),\n          Representing.config({\n            store: {\n              mode: 'memory',\n              initialValue: Optional.none()\n            }\n          }),\n          Receiving.config({\n            channels: __assign(__assign({}, receivingChannel(__assign({ isExtraPart: spec.isExtraPart }, detail.fireDismissalEventInstead.map(function (fe) {\n              return { fireEventInstead: { event: fe.event } };\n            }).getOr({})))), receivingChannel$1(__assign(__assign({}, detail.fireRepositionEventInstead.map(function (fe) {\n              return { fireEventInstead: { event: fe.event } };\n            }).getOr({})), { doReposition: reposition })))\n          })\n        ]),\n        eventOrder: detail.eventOrder,\n        apis: apis\n      };\n    };\n    var InlineView = single$2({\n      name: 'InlineView',\n      configFields: [\n        strict$1('lazySink'),\n        onHandler('onShow'),\n        onHandler('onHide'),\n        optionFunction('onEscape'),\n        field$1('inlineBehaviours', [\n          Sandboxing,\n          Representing,\n          Receiving\n        ]),\n        optionObjOf('fireDismissalEventInstead', [defaulted$1('event', dismissRequested())]),\n        optionObjOf('fireRepositionEventInstead', [defaulted$1('event', repositionRequested())]),\n        defaulted$1('getRelated', Optional.none),\n        defaulted$1('isExtraPart', never),\n        defaulted$1('eventOrder', Optional.none)\n      ],\n      factory: factory,\n      apis: {\n        showAt: function (apis, component, anchor, thing) {\n          apis.showAt(component, anchor, thing);\n        },\n        showWithin: function (apis, component, anchor, thing, boxElement) {\n          apis.showWithin(component, anchor, thing, boxElement);\n        },\n        showWithinBounds: function (apis, component, anchor, thing, bounds) {\n          apis.showWithinBounds(component, anchor, thing, bounds);\n        },\n        showMenuAt: function (apis, component, anchor, menuSpec) {\n          apis.showMenuAt(component, anchor, menuSpec);\n        },\n        showMenuWithinBounds: function (apis, component, anchor, menuSpec, bounds) {\n          apis.showMenuWithinBounds(component, anchor, menuSpec, bounds);\n        },\n        hide: function (apis, component) {\n          apis.hide(component);\n        },\n        isOpen: function (apis, component) {\n          return apis.isOpen(component);\n        },\n        getContent: function (apis, component) {\n          return apis.getContent(component);\n        },\n        setContent: function (apis, component, thing) {\n          apis.setContent(component, thing);\n        },\n        reposition: function (apis, component) {\n          apis.reposition(component);\n        }\n      }\n    });\n\n    var westEdgeX$1 = function (anchor) {\n      return anchor.x;\n    };\n    var middleX$1 = function (anchor, element) {\n      return anchor.x + anchor.width / 2 - element.width / 2;\n    };\n    var eastEdgeX$1 = function (anchor, element) {\n      return anchor.x + anchor.width - element.width;\n    };\n    var northY$2 = function (anchor) {\n      return anchor.y;\n    };\n    var southY$2 = function (anchor, element) {\n      return anchor.y + anchor.height - element.height;\n    };\n    var southeast$3 = function (anchor, element, bubbles) {\n      return nu$7(eastEdgeX$1(anchor, element), southY$2(anchor, element), bubbles.innerSoutheast(), northwest(), boundsRestriction(anchor, {\n        right: 0,\n        bottom: 3\n      }), 'layout-inner-se');\n    };\n    var southwest$3 = function (anchor, element, bubbles) {\n      return nu$7(westEdgeX$1(anchor), southY$2(anchor, element), bubbles.innerSouthwest(), northeast(), boundsRestriction(anchor, {\n        left: 1,\n        bottom: 3\n      }), 'layout-inner-sw');\n    };\n    var northeast$3 = function (anchor, element, bubbles) {\n      return nu$7(eastEdgeX$1(anchor, element), northY$2(anchor), bubbles.innerNortheast(), southwest(), boundsRestriction(anchor, {\n        right: 0,\n        top: 2\n      }), 'layout-inner-ne');\n    };\n    var northwest$3 = function (anchor, element, bubbles) {\n      return nu$7(westEdgeX$1(anchor), northY$2(anchor), bubbles.innerNorthwest(), southeast(), boundsRestriction(anchor, {\n        left: 1,\n        top: 2\n      }), 'layout-inner-nw');\n    };\n    var north$3 = function (anchor, element, bubbles) {\n      return nu$7(middleX$1(anchor, element), northY$2(anchor), bubbles.innerNorth(), south(), boundsRestriction(anchor, { top: 2 }), 'layout-inner-n');\n    };\n    var south$3 = function (anchor, element, bubbles) {\n      return nu$7(middleX$1(anchor, element), southY$2(anchor, element), bubbles.innerSouth(), north(), boundsRestriction(anchor, { bottom: 3 }), 'layout-inner-s');\n    };\n\n    var global$2 = tinymce.util.Tools.resolve('tinymce.util.Delay');\n\n    var factory$1 = function (detail) {\n      var events = events$7(detail.action);\n      var tag = detail.dom.tag;\n      var lookupAttr = function (attr) {\n        return get$1(detail.dom, 'attributes').bind(function (attrs) {\n          return get$1(attrs, attr);\n        });\n      };\n      var getModAttributes = function () {\n        if (tag === 'button') {\n          var type = lookupAttr('type').getOr('button');\n          var roleAttrs = lookupAttr('role').map(function (role) {\n            return { role: role };\n          }).getOr({});\n          return __assign({ type: type }, roleAttrs);\n        } else {\n          var role = lookupAttr('role').getOr('button');\n          return { role: role };\n        }\n      };\n      return {\n        uid: detail.uid,\n        dom: detail.dom,\n        components: detail.components,\n        events: events,\n        behaviours: SketchBehaviours.augment(detail.buttonBehaviours, [\n          Focusing.config({}),\n          Keying.config({\n            mode: 'execution',\n            useSpace: true,\n            useEnter: true\n          })\n        ]),\n        domModification: { attributes: getModAttributes() },\n        eventOrder: detail.eventOrder\n      };\n    };\n    var Button = single$2({\n      name: 'Button',\n      factory: factory$1,\n      configFields: [\n        defaulted$1('uid', undefined),\n        strict$1('dom'),\n        defaulted$1('components', []),\n        SketchBehaviours.field('buttonBehaviours', [\n          Focusing,\n          Keying\n        ]),\n        option('action'),\n        option('role'),\n        defaulted$1('eventOrder', {})\n      ]\n    });\n\n    var record = function (spec) {\n      var uid = isSketchSpec(spec) && hasNonNullableKey(spec, 'uid') ? spec.uid : generate$2('memento');\n      var get = function (anyInSystem) {\n        return anyInSystem.getSystem().getByUid(uid).getOrDie();\n      };\n      var getOpt = function (anyInSystem) {\n        return anyInSystem.getSystem().getByUid(uid).toOptional();\n      };\n      var asSpec = function () {\n        return __assign(__assign({}, spec), { uid: uid });\n      };\n      return {\n        get: get,\n        getOpt: getOpt,\n        asSpec: asSpec\n      };\n    };\n\n    var defaultIcon = function (icons) {\n      return Optional.from(icons()['temporary-placeholder']).getOr('!not found!');\n    };\n    var get$e = function (name, icons) {\n      return Optional.from(icons()[name.toLowerCase()]).getOrThunk(function () {\n        return defaultIcon(icons);\n      });\n    };\n    var getOr = function (name, icons, fallback) {\n      return Optional.from(icons()[name.toLowerCase()]).or(fallback).getOrThunk(function () {\n        return defaultIcon(icons);\n      });\n    };\n    var getFirst$1 = function (names, icons) {\n      return findMap(names, function (name) {\n        return Optional.from(icons()[name.toLowerCase()]);\n      }).getOrThunk(function () {\n        return defaultIcon(icons);\n      });\n    };\n\n    var notificationIconMap = {\n      success: 'checkmark',\n      error: 'warning',\n      err: 'error',\n      warning: 'warning',\n      warn: 'warning',\n      info: 'info'\n    };\n    var factory$2 = function (detail) {\n      var memBannerText = record({\n        dom: {\n          tag: 'p',\n          innerHtml: detail.translationProvider(detail.text)\n        },\n        behaviours: derive$1([Replacing.config({})])\n      });\n      var renderPercentBar = function (percent) {\n        return {\n          dom: {\n            tag: 'div',\n            classes: ['tox-bar'],\n            attributes: { style: 'width: ' + percent + '%' }\n          }\n        };\n      };\n      var renderPercentText = function (percent) {\n        return {\n          dom: {\n            tag: 'div',\n            classes: ['tox-text'],\n            innerHtml: percent + '%'\n          }\n        };\n      };\n      var memBannerProgress = record({\n        dom: {\n          tag: 'div',\n          classes: detail.progress ? [\n            'tox-progress-bar',\n            'tox-progress-indicator'\n          ] : ['tox-progress-bar']\n        },\n        components: [\n          {\n            dom: {\n              tag: 'div',\n              classes: ['tox-bar-container']\n            },\n            components: [renderPercentBar(0)]\n          },\n          renderPercentText(0)\n        ],\n        behaviours: derive$1([Replacing.config({})])\n      });\n      var updateProgress = function (comp, percent) {\n        if (comp.getSystem().isConnected()) {\n          memBannerProgress.getOpt(comp).each(function (progress) {\n            Replacing.set(progress, [\n              {\n                dom: {\n                  tag: 'div',\n                  classes: ['tox-bar-container']\n                },\n                components: [renderPercentBar(percent)]\n              },\n              renderPercentText(percent)\n            ]);\n          });\n        }\n      };\n      var updateText = function (comp, text$1) {\n        if (comp.getSystem().isConnected()) {\n          var banner = memBannerText.get(comp);\n          Replacing.set(banner, [text(text$1)]);\n        }\n      };\n      var apis = {\n        updateProgress: updateProgress,\n        updateText: updateText\n      };\n      var iconChoices = flatten([\n        detail.icon.toArray(),\n        detail.level.toArray(),\n        detail.level.bind(function (level) {\n          return Optional.from(notificationIconMap[level]);\n        }).toArray()\n      ]);\n      var memButton = record(Button.sketch({\n        dom: {\n          tag: 'button',\n          classes: [\n            'tox-notification__dismiss',\n            'tox-button',\n            'tox-button--naked',\n            'tox-button--icon'\n          ]\n        },\n        components: [{\n            dom: {\n              tag: 'div',\n              classes: ['tox-icon'],\n              innerHtml: get$e('close', detail.iconProvider),\n              attributes: { 'aria-label': detail.translationProvider('Close') }\n            }\n          }],\n        action: function (comp) {\n          detail.onAction(comp);\n        }\n      }));\n      var components = [\n        {\n          dom: {\n            tag: 'div',\n            classes: ['tox-notification__icon'],\n            innerHtml: getFirst$1(iconChoices, detail.iconProvider)\n          }\n        },\n        {\n          dom: {\n            tag: 'div',\n            classes: ['tox-notification__body']\n          },\n          components: [memBannerText.asSpec()],\n          behaviours: derive$1([Replacing.config({})])\n        }\n      ];\n      return {\n        uid: detail.uid,\n        dom: {\n          tag: 'div',\n          attributes: { role: 'alert' },\n          classes: detail.level.map(function (level) {\n            return [\n              'tox-notification',\n              'tox-notification--in',\n              'tox-notification--' + level\n            ];\n          }).getOr([\n            'tox-notification',\n            'tox-notification--in'\n          ])\n        },\n        behaviours: derive$1([\n          Focusing.config({}),\n          config('notification-events', [run(focusin(), function (comp) {\n              memButton.getOpt(comp).each(Focusing.focus);\n            })])\n        ]),\n        components: components.concat(detail.progress ? [memBannerProgress.asSpec()] : []).concat(!detail.closeButton ? [] : [memButton.asSpec()]),\n        apis: apis\n      };\n    };\n    var Notification = single$2({\n      name: 'Notification',\n      factory: factory$2,\n      configFields: [\n        option('level'),\n        strict$1('progress'),\n        strict$1('icon'),\n        strict$1('onAction'),\n        strict$1('text'),\n        strict$1('iconProvider'),\n        strict$1('translationProvider'),\n        defaultedBoolean('closeButton', true)\n      ],\n      apis: {\n        updateProgress: function (apis, comp, percent) {\n          apis.updateProgress(comp, percent);\n        },\n        updateText: function (apis, comp, text) {\n          apis.updateText(comp, text);\n        }\n      }\n    });\n\n    function NotificationManagerImpl (editor, extras, uiMothership) {\n      var backstage = extras.backstage;\n      var getLayoutDirection = function (rel) {\n        switch (rel) {\n        case 'bc-bc':\n          return south$3;\n        case 'tc-tc':\n          return north$3;\n        case 'tc-bc':\n          return north$1;\n        case 'bc-tc':\n        default:\n          return south$1;\n        }\n      };\n      var prePositionNotifications = function (notifications) {\n        each(notifications, function (notification) {\n          return notification.moveTo(0, 0);\n        });\n      };\n      var positionNotifications = function (notifications) {\n        if (notifications.length > 0) {\n          head(notifications).each(function (firstItem) {\n            return firstItem.moveRel(null, 'banner');\n          });\n          each(notifications, function (notification, index) {\n            if (index > 0) {\n              notification.moveRel(notifications[index - 1].getEl(), 'bc-tc');\n            }\n          });\n        }\n      };\n      var reposition = function (notifications) {\n        prePositionNotifications(notifications);\n        positionNotifications(notifications);\n      };\n      var open = function (settings, closeCallback) {\n        var hideCloseButton = !settings.closeButton && settings.timeout && (settings.timeout > 0 || settings.timeout < 0);\n        var close = function () {\n          closeCallback();\n          InlineView.hide(notificationWrapper);\n        };\n        var notification = build$1(Notification.sketch({\n          text: settings.text,\n          level: contains([\n            'success',\n            'error',\n            'warning',\n            'warn',\n            'info'\n          ], settings.type) ? settings.type : undefined,\n          progress: settings.progressBar === true,\n          icon: Optional.from(settings.icon),\n          closeButton: !hideCloseButton,\n          onAction: close,\n          iconProvider: backstage.shared.providers.icons,\n          translationProvider: backstage.shared.providers.translate\n        }));\n        var notificationWrapper = build$1(InlineView.sketch(__assign({\n          dom: {\n            tag: 'div',\n            classes: ['tox-notifications-container']\n          },\n          lazySink: extras.backstage.shared.getSink,\n          fireDismissalEventInstead: {}\n        }, backstage.shared.header.isPositionedAtTop() ? {} : { fireRepositionEventInstead: {} })));\n        uiMothership.add(notificationWrapper);\n        if (settings.timeout > 0) {\n          global$2.setTimeout(function () {\n            close();\n          }, settings.timeout);\n        }\n        return {\n          close: close,\n          moveTo: function (x, y) {\n            InlineView.showAt(notificationWrapper, {\n              anchor: 'makeshift',\n              x: x,\n              y: y\n            }, premade$1(notification));\n          },\n          moveRel: function (element, rel) {\n            if (rel !== 'banner') {\n              var layoutDirection_1 = getLayoutDirection(rel);\n              var nodeAnchor = {\n                anchor: 'node',\n                root: body(),\n                node: Optional.some(SugarElement.fromDom(element)),\n                layouts: {\n                  onRtl: function () {\n                    return [layoutDirection_1];\n                  },\n                  onLtr: function () {\n                    return [layoutDirection_1];\n                  }\n                }\n              };\n              InlineView.showAt(notificationWrapper, nodeAnchor, premade$1(notification));\n            } else {\n              InlineView.showAt(notificationWrapper, extras.backstage.shared.anchors.banner(), premade$1(notification));\n            }\n          },\n          text: function (nuText) {\n            Notification.updateText(notification, nuText);\n          },\n          settings: settings,\n          getEl: function () {\n            return notification.element.dom;\n          },\n          progressBar: {\n            value: function (percent) {\n              Notification.updateProgress(notification, percent);\n            }\n          }\n        };\n      };\n      var close = function (notification) {\n        notification.close();\n      };\n      var getArgs = function (notification) {\n        return notification.settings;\n      };\n      return {\n        open: open,\n        close: close,\n        reposition: reposition,\n        getArgs: getArgs\n      };\n    }\n\n    var first = function (fn, rate) {\n      var timer = null;\n      var cancel = function () {\n        if (timer !== null) {\n          clearTimeout(timer);\n          timer = null;\n        }\n      };\n      var throttle = function () {\n        var args = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n          args[_i] = arguments[_i];\n        }\n        if (timer === null) {\n          timer = setTimeout(function () {\n            fn.apply(null, args);\n            timer = null;\n          }, rate);\n        }\n      };\n      return {\n        cancel: cancel,\n        throttle: throttle\n      };\n    };\n    var last$2 = function (fn, rate) {\n      var timer = null;\n      var cancel = function () {\n        if (timer !== null) {\n          clearTimeout(timer);\n          timer = null;\n        }\n      };\n      var throttle = function () {\n        var args = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n          args[_i] = arguments[_i];\n        }\n        if (timer !== null) {\n          clearTimeout(timer);\n        }\n        timer = setTimeout(function () {\n          fn.apply(null, args);\n          timer = null;\n        }, rate);\n      };\n      return {\n        cancel: cancel,\n        throttle: throttle\n      };\n    };\n\n    var global$3 = tinymce.util.Tools.resolve('tinymce.dom.TextSeeker');\n\n    var isBoundary = function (dom, node) {\n      return dom.isBlock(node) || contains([\n        'BR',\n        'IMG',\n        'HR',\n        'INPUT'\n      ], node.nodeName) || dom.getContentEditable(node) === 'false';\n    };\n    var repeatLeft = function (dom, node, offset, process, rootNode) {\n      var search = global$3(dom, function (node) {\n        return isBoundary(dom, node);\n      });\n      return Optional.from(search.backwards(node, offset, process, rootNode));\n    };\n\n    var autocompleteSelector = '[data-mce-autocompleter]';\n    var create$4 = function (editor, range) {\n      return detect$4(SugarElement.fromDom(editor.selection.getNode())).getOrThunk(function () {\n        var wrapper = SugarElement.fromHtml('<span data-mce-autocompleter=\"1\" data-mce-bogus=\"1\"></span>', editor.getDoc());\n        append(wrapper, SugarElement.fromDom(range.extractContents()));\n        range.insertNode(wrapper.dom);\n        parent(wrapper).each(function (elm) {\n          return elm.dom.normalize();\n        });\n        last$1(wrapper).map(function (last) {\n          editor.selection.setCursorLocation(last.dom, getEnd(last));\n        });\n        return wrapper;\n      });\n    };\n    var detect$4 = function (elm) {\n      return closest$3(elm, autocompleteSelector);\n    };\n\n    var isValidTextRange = function (rng) {\n      return rng.collapsed && rng.startContainer.nodeType === 3;\n    };\n    var getText = function (rng) {\n      return rng.toString().replace(/\\u00A0/g, ' ').replace(/\\uFEFF/g, '');\n    };\n    var isWhitespace = function (chr) {\n      return chr !== '' && ' \\xA0\\f\\n\\r\\t\\x0B'.indexOf(chr) !== -1;\n    };\n\n    var stripTriggerChar = function (text, triggerCh) {\n      return text.substring(triggerCh.length);\n    };\n    var findChar = function (text, index, ch) {\n      var i;\n      for (i = index - 1; i >= 0; i--) {\n        var char = text.charAt(i);\n        if (isWhitespace(char)) {\n          return Optional.none();\n        }\n        if (char === ch) {\n          break;\n        }\n      }\n      return Optional.some(i);\n    };\n    var findStart = function (dom, initRange, ch, minChars) {\n      if (minChars === void 0) {\n        minChars = 0;\n      }\n      if (!isValidTextRange(initRange)) {\n        return Optional.none();\n      }\n      var findTriggerChIndex = function (element, offset, text) {\n        return findChar(text, offset, ch).getOr(offset);\n      };\n      var root = dom.getParent(initRange.startContainer, dom.isBlock) || dom.getRoot();\n      return repeatLeft(dom, initRange.startContainer, initRange.startOffset, findTriggerChIndex, root).bind(function (spot) {\n        var range = initRange.cloneRange();\n        range.setStart(spot.container, spot.offset);\n        range.setEnd(initRange.endContainer, initRange.endOffset);\n        if (range.collapsed) {\n          return Optional.none();\n        }\n        var text = getText(range);\n        var triggerCharIndex = text.lastIndexOf(ch);\n        if (triggerCharIndex !== 0 || stripTriggerChar(text, ch).length < minChars) {\n          return Optional.none();\n        } else {\n          return Optional.some({\n            text: stripTriggerChar(text, ch),\n            range: range,\n            triggerChar: ch\n          });\n        }\n      });\n    };\n    var getContext = function (dom, initRange, ch, minChars) {\n      if (minChars === void 0) {\n        minChars = 0;\n      }\n      return detect$4(SugarElement.fromDom(initRange.startContainer)).fold(function () {\n        return findStart(dom, initRange, ch, minChars);\n      }, function (elm) {\n        var range = dom.createRng();\n        range.selectNode(elm.dom);\n        var text = getText(range);\n        return Optional.some({\n          range: range,\n          text: stripTriggerChar(text, ch),\n          triggerChar: ch\n        });\n      });\n    };\n\n    var setup = function (api, editor) {\n      editor.on('keypress compositionend', api.onKeypress.throttle);\n      editor.on('remove', api.onKeypress.cancel);\n      var redirectKeyToItem = function (item, e) {\n        emitWith(item, keydown(), { raw: e });\n      };\n      editor.on('keydown', function (e) {\n        var getItem = function () {\n          return api.getView().bind(Highlighting.getHighlighted);\n        };\n        if (e.which === 8) {\n          api.onKeypress.throttle(e);\n        }\n        if (api.isActive()) {\n          if (e.which === 27) {\n            api.cancelIfNecessary();\n          }\n          if (api.isMenuOpen()) {\n            if (e.which === 13) {\n              getItem().each(emitExecute);\n              e.preventDefault();\n            } else if (e.which === 40) {\n              getItem().fold(function () {\n                api.getView().each(Highlighting.highlightFirst);\n              }, function (item) {\n                redirectKeyToItem(item, e);\n              });\n              e.preventDefault();\n              e.stopImmediatePropagation();\n            } else if (e.which === 37 || e.which === 38 || e.which === 39) {\n              getItem().each(function (item) {\n                redirectKeyToItem(item, e);\n                e.preventDefault();\n                e.stopImmediatePropagation();\n              });\n            }\n          } else {\n            if (e.which === 13 || e.which === 38 || e.which === 40) {\n              api.cancelIfNecessary();\n            }\n          }\n        }\n      });\n      editor.on('NodeChange', function (e) {\n        if (api.isActive() && !api.isProcessingAction() && detect$4(SugarElement.fromDom(e.element)).isNone()) {\n          api.cancelIfNecessary();\n        }\n      });\n    };\n    var AutocompleterEditorEvents = { setup: setup };\n\n    var global$4 = tinymce.util.Tools.resolve('tinymce.util.Promise');\n\n    var point$1 = function (container, offset) {\n      return {\n        container: container,\n        offset: offset\n      };\n    };\n\n    var isText$1 = function (node) {\n      return node.nodeType === TEXT;\n    };\n    var isElement$1 = function (node) {\n      return node.nodeType === ELEMENT;\n    };\n    var toLast = function (node) {\n      if (isText$1(node)) {\n        return point$1(node, node.data.length);\n      } else {\n        var children = node.childNodes;\n        return children.length > 0 ? toLast(children[children.length - 1]) : point$1(node, children.length);\n      }\n    };\n    var toLeaf = function (node, offset) {\n      var children = node.childNodes;\n      if (children.length > 0 && offset < children.length) {\n        return toLeaf(children[offset], 0);\n      } else if (children.length > 0 && isElement$1(node) && children.length === offset) {\n        return toLast(children[children.length - 1]);\n      } else {\n        return point$1(node, offset);\n      }\n    };\n\n    var isPreviousCharContent = function (dom, leaf) {\n      return repeatLeft(dom, leaf.container, leaf.offset, function (element, offset) {\n        return offset === 0 ? -1 : offset;\n      }, dom.getRoot()).filter(function (spot) {\n        var char = spot.container.data.charAt(spot.offset - 1);\n        return !isWhitespace(char);\n      }).isSome();\n    };\n    var isStartOfWord = function (dom) {\n      return function (rng) {\n        var leaf = toLeaf(rng.startContainer, rng.startOffset);\n        return !isPreviousCharContent(dom, leaf);\n      };\n    };\n    var getTriggerContext = function (dom, initRange, database) {\n      return findMap(database.triggerChars, function (ch) {\n        return getContext(dom, initRange, ch);\n      });\n    };\n    var lookup = function (editor, getDatabase) {\n      var database = getDatabase();\n      var rng = editor.selection.getRng();\n      return getTriggerContext(editor.dom, rng, database).bind(function (context) {\n        return lookupWithContext(editor, getDatabase, context);\n      });\n    };\n    var lookupWithContext = function (editor, getDatabase, context, fetchOptions) {\n      if (fetchOptions === void 0) {\n        fetchOptions = {};\n      }\n      var database = getDatabase();\n      var rng = editor.selection.getRng();\n      var startText = rng.startContainer.nodeValue;\n      var autocompleters = filter(database.lookupByChar(context.triggerChar), function (autocompleter) {\n        return context.text.length >= autocompleter.minChars && autocompleter.matches.getOrThunk(function () {\n          return isStartOfWord(editor.dom);\n        })(context.range, startText, context.text);\n      });\n      if (autocompleters.length === 0) {\n        return Optional.none();\n      }\n      var lookupData = global$4.all(map(autocompleters, function (ac) {\n        var fetchResult = ac.fetch(context.text, ac.maxResults, fetchOptions);\n        return fetchResult.then(function (results) {\n          return {\n            matchText: context.text,\n            items: results,\n            columns: ac.columns,\n            onAction: ac.onAction,\n            highlightOn: ac.highlightOn\n          };\n        });\n      }));\n      return Optional.some({\n        lookupData: lookupData,\n        context: context\n      });\n    };\n\n    var separatorMenuItemSchema = objOf([\n      strictString('type'),\n      optionString('text')\n    ]);\n    var createSeparatorMenuItem = function (spec) {\n      return asRaw('separatormenuitem', separatorMenuItemSchema, spec);\n    };\n\n    var autocompleterItemSchema = objOf([\n      defaulted$1('type', 'autocompleteitem'),\n      defaulted$1('active', false),\n      defaulted$1('disabled', false),\n      defaulted$1('meta', {}),\n      strictString('value'),\n      optionString('text'),\n      optionString('icon')\n    ]);\n    var autocompleterSchema = objOf([\n      strictString('type'),\n      strictString('ch'),\n      defaultedNumber('minChars', 1),\n      defaulted$1('columns', 1),\n      defaultedNumber('maxResults', 10),\n      optionFunction('matches'),\n      strictFunction('fetch'),\n      strictFunction('onAction'),\n      defaultedArrayOf('highlightOn', [], string)\n    ]);\n    var createSeparatorItem = function (spec) {\n      return asRaw('Autocompleter.Separator', separatorMenuItemSchema, spec);\n    };\n    var createAutocompleterItem = function (spec) {\n      return asRaw('Autocompleter.Item', autocompleterItemSchema, spec);\n    };\n    var createAutocompleter = function (spec) {\n      return asRaw('Autocompleter', autocompleterSchema, spec);\n    };\n\n    var baseToolbarButtonFields = [\n      defaultedBoolean('disabled', false),\n      optionString('tooltip'),\n      optionString('icon'),\n      optionString('text'),\n      defaultedFunction('onSetup', function () {\n        return noop;\n      })\n    ];\n    var toolbarButtonSchema = objOf([\n      strictString('type'),\n      strictFunction('onAction')\n    ].concat(baseToolbarButtonFields));\n    var createToolbarButton = function (spec) {\n      return asRaw('toolbarbutton', toolbarButtonSchema, spec);\n    };\n\n    var baseToolbarToggleButtonFields = [defaultedBoolean('active', false)].concat(baseToolbarButtonFields);\n    var toggleButtonSchema = objOf(baseToolbarToggleButtonFields.concat([\n      strictString('type'),\n      strictFunction('onAction')\n    ]));\n    var createToggleButton = function (spec) {\n      return asRaw('ToggleButton', toggleButtonSchema, spec);\n    };\n\n    var contextBarFields = [\n      defaultedFunction('predicate', never),\n      defaultedStringEnum('scope', 'node', [\n        'node',\n        'editor'\n      ]),\n      defaultedStringEnum('position', 'selection', [\n        'node',\n        'selection',\n        'line'\n      ])\n    ];\n\n    var contextButtonFields = baseToolbarButtonFields.concat([\n      defaulted$1('type', 'contextformbutton'),\n      defaulted$1('primary', false),\n      strictFunction('onAction'),\n      state$1('original', identity)\n    ]);\n    var contextToggleButtonFields = baseToolbarToggleButtonFields.concat([\n      defaulted$1('type', 'contextformbutton'),\n      defaulted$1('primary', false),\n      strictFunction('onAction'),\n      state$1('original', identity)\n    ]);\n    var launchButtonFields = baseToolbarButtonFields.concat([defaulted$1('type', 'contextformbutton')]);\n    var launchToggleButtonFields = baseToolbarToggleButtonFields.concat([defaulted$1('type', 'contextformtogglebutton')]);\n    var toggleOrNormal = choose$1('type', {\n      contextformbutton: contextButtonFields,\n      contextformtogglebutton: contextToggleButtonFields\n    });\n    var contextFormSchema = objOf([\n      defaulted$1('type', 'contextform'),\n      defaultedFunction('initValue', function () {\n        return '';\n      }),\n      optionString('label'),\n      strictArrayOf('commands', toggleOrNormal),\n      optionOf('launch', choose$1('type', {\n        contextformbutton: launchButtonFields,\n        contextformtogglebutton: launchToggleButtonFields\n      }))\n    ].concat(contextBarFields));\n    var createContextForm = function (spec) {\n      return asRaw('ContextForm', contextFormSchema, spec);\n    };\n\n    var contextToolbarSchema = objOf([\n      defaulted$1('type', 'contexttoolbar'),\n      strictString('items')\n    ].concat(contextBarFields));\n    var createContextToolbar = function (spec) {\n      return asRaw('ContextToolbar', contextToolbarSchema, spec);\n    };\n\n    var stringArray = function (a) {\n      var all = {};\n      each(a, function (key) {\n        all[key] = {};\n      });\n      return keys(all);\n    };\n\n    var register = function (editor) {\n      var popups = editor.ui.registry.getAll().popups;\n      var dataset = map$2(popups, function (popup) {\n        return createAutocompleter(popup).fold(function (err) {\n          throw new Error(formatError(err));\n        }, function (x) {\n          return x;\n        });\n      });\n      var triggerChars = stringArray(mapToArray(dataset, function (v) {\n        return v.ch;\n      }));\n      var datasetValues = values(dataset);\n      var lookupByChar = function (ch) {\n        return filter(datasetValues, function (dv) {\n          return dv.ch === ch;\n        });\n      };\n      return {\n        dataset: dataset,\n        triggerChars: triggerChars,\n        lookupByChar: lookupByChar\n      };\n    };\n\n    var ItemResponse;\n    (function (ItemResponse) {\n      ItemResponse[ItemResponse['CLOSE_ON_EXECUTE'] = 0] = 'CLOSE_ON_EXECUTE';\n      ItemResponse[ItemResponse['BUBBLE_TO_SANDBOX'] = 1] = 'BUBBLE_TO_SANDBOX';\n    }(ItemResponse || (ItemResponse = {})));\n    var ItemResponse$1 = ItemResponse;\n\n    var navClass = 'tox-menu-nav__js';\n    var selectableClass = 'tox-collection__item';\n    var colorClass = 'tox-swatch';\n    var presetClasses = {\n      normal: navClass,\n      color: colorClass\n    };\n    var tickedClass = 'tox-collection__item--enabled';\n    var groupHeadingClass = 'tox-collection__group-heading';\n    var iconClass = 'tox-collection__item-icon';\n    var textClass = 'tox-collection__item-label';\n    var accessoryClass = 'tox-collection__item-accessory';\n    var caretClass = 'tox-collection__item-caret';\n    var checkmarkClass = 'tox-collection__item-checkmark';\n    var activeClass = 'tox-collection__item--active';\n    var iconClassRtl = 'tox-collection__item-icon-rtl';\n    var containerClass = 'tox-collection__item-container';\n    var containerColumnClass = 'tox-collection__item-container--column';\n    var containerRowClass = 'tox-collection__item-container--row';\n    var containerAlignRightClass = 'tox-collection__item-container--align-right';\n    var containerAlignLeftClass = 'tox-collection__item-container--align-left';\n    var containerValignTopClass = 'tox-collection__item-container--valign-top';\n    var containerValignMiddleClass = 'tox-collection__item-container--valign-middle';\n    var containerValignBottomClass = 'tox-collection__item-container--valign-bottom';\n    var classForPreset = function (presets) {\n      return get$1(presetClasses, presets).getOr(navClass);\n    };\n\n    var forMenu = function (presets) {\n      if (presets === 'color') {\n        return 'tox-swatches';\n      } else {\n        return 'tox-menu';\n      }\n    };\n    var classes = function (presets) {\n      return {\n        backgroundMenu: 'tox-background-menu',\n        selectedMenu: 'tox-selected-menu',\n        selectedItem: 'tox-collection__item--active',\n        hasIcons: 'tox-menu--has-icons',\n        menu: forMenu(presets),\n        tieredMenu: 'tox-tiered-menu'\n      };\n    };\n\n    var markers$1 = function (presets) {\n      var menuClasses = classes(presets);\n      return {\n        backgroundMenu: menuClasses.backgroundMenu,\n        selectedMenu: menuClasses.selectedMenu,\n        menu: menuClasses.menu,\n        selectedItem: menuClasses.selectedItem,\n        item: classForPreset(presets)\n      };\n    };\n    var dom$1 = function (hasIcons, columns, presets) {\n      var menuClasses = classes(presets);\n      return {\n        tag: 'div',\n        classes: flatten([\n          [\n            menuClasses.menu,\n            'tox-menu-' + columns + '-column'\n          ],\n          hasIcons ? [menuClasses.hasIcons] : []\n        ])\n      };\n    };\n    var components$1 = [Menu.parts.items({})];\n    var part = function (hasIcons, columns, presets) {\n      var menuClasses = classes(presets);\n      var d = {\n        tag: 'div',\n        classes: flatten([[menuClasses.tieredMenu]])\n      };\n      return {\n        dom: d,\n        markers: markers$1(presets)\n      };\n    };\n\n    var chunk$1 = function (rowDom, numColumns) {\n      return function (items) {\n        var chunks = chunk(items, numColumns);\n        return map(chunks, function (c) {\n          return {\n            dom: rowDom,\n            components: c\n          };\n        });\n      };\n    };\n    var forSwatch = function (columns) {\n      return {\n        dom: {\n          tag: 'div',\n          classes: [\n            'tox-menu',\n            'tox-swatches-menu'\n          ]\n        },\n        components: [{\n            dom: {\n              tag: 'div',\n              classes: ['tox-swatches']\n            },\n            components: [Menu.parts.items({\n                preprocess: columns !== 'auto' ? chunk$1({\n                  tag: 'div',\n                  classes: ['tox-swatches__row']\n                }, columns) : identity\n              })]\n          }]\n      };\n    };\n    var forToolbar = function (columns) {\n      return {\n        dom: {\n          tag: 'div',\n          classes: [\n            'tox-menu',\n            'tox-collection',\n            'tox-collection--toolbar',\n            'tox-collection--toolbar-lg'\n          ]\n        },\n        components: [Menu.parts.items({\n            preprocess: chunk$1({\n              tag: 'div',\n              classes: ['tox-collection__group']\n            }, columns)\n          })]\n      };\n    };\n    var preprocessCollection = function (items, isSeparator) {\n      var allSplits = [];\n      var currentSplit = [];\n      each(items, function (item, i) {\n        if (isSeparator(item, i)) {\n          if (currentSplit.length > 0) {\n            allSplits.push(currentSplit);\n          }\n          currentSplit = [];\n          if (has(item.dom, 'innerHtml')) {\n            currentSplit.push(item);\n          }\n        } else {\n          currentSplit.push(item);\n        }\n      });\n      if (currentSplit.length > 0) {\n        allSplits.push(currentSplit);\n      }\n      return map(allSplits, function (s) {\n        return {\n          dom: {\n            tag: 'div',\n            classes: ['tox-collection__group']\n          },\n          components: s\n        };\n      });\n    };\n    var forCollection = function (columns, initItems, _hasIcons) {\n      return {\n        dom: {\n          tag: 'div',\n          classes: [\n            'tox-menu',\n            'tox-collection'\n          ].concat(columns === 1 ? ['tox-collection--list'] : ['tox-collection--grid'])\n        },\n        components: [Menu.parts.items({\n            preprocess: function (items) {\n              if (columns !== 'auto' && columns > 1) {\n                return chunk$1({\n                  tag: 'div',\n                  classes: ['tox-collection__group']\n                }, columns)(items);\n              } else {\n                return preprocessCollection(items, function (_item, i) {\n                  return initItems[i].type === 'separator';\n                });\n              }\n            }\n          })]\n      };\n    };\n    var forHorizontalCollection = function (initItems, _hasIcons) {\n      return {\n        dom: {\n          tag: 'div',\n          classes: [\n            'tox-collection',\n            'tox-collection--horizontal'\n          ]\n        },\n        components: [Menu.parts.items({\n            preprocess: function (items) {\n              return preprocessCollection(items, function (_item, i) {\n                return initItems[i].type === 'separator';\n              });\n            }\n          })]\n      };\n    };\n\n    var menuHasIcons = function (xs) {\n      return exists(xs, function (item) {\n        return 'icon' in item && item.icon !== undefined;\n      });\n    };\n    var handleError = function (error) {\n      console.error(formatError(error));\n      console.log(error);\n      return Optional.none();\n    };\n    var createHorizontalPartialMenuWithAlloyItems = function (value, _hasIcons, items, _columns, _presets) {\n      var structure = forHorizontalCollection(items);\n      return {\n        value: value,\n        dom: structure.dom,\n        components: structure.components,\n        items: items\n      };\n    };\n    var createPartialMenuWithAlloyItems = function (value, hasIcons, items, columns, presets) {\n      if (presets === 'color') {\n        var structure = forSwatch(columns);\n        return {\n          value: value,\n          dom: structure.dom,\n          components: structure.components,\n          items: items\n        };\n      }\n      if (presets === 'normal' && columns === 'auto') {\n        var structure = forCollection(columns, items);\n        return {\n          value: value,\n          dom: structure.dom,\n          components: structure.components,\n          items: items\n        };\n      }\n      if (presets === 'normal' && columns === 1) {\n        var structure = forCollection(1, items);\n        return {\n          value: value,\n          dom: structure.dom,\n          components: structure.components,\n          items: items\n        };\n      }\n      if (presets === 'normal') {\n        var structure = forCollection(columns, items);\n        return {\n          value: value,\n          dom: structure.dom,\n          components: structure.components,\n          items: items\n        };\n      }\n      if (presets === 'listpreview' && columns !== 'auto') {\n        var structure = forToolbar(columns);\n        return {\n          value: value,\n          dom: structure.dom,\n          components: structure.components,\n          items: items\n        };\n      }\n      return {\n        value: value,\n        dom: dom$1(hasIcons, columns, presets),\n        components: components$1,\n        items: items\n      };\n    };\n\n    var cardImageFields = [\n      strictString('type'),\n      strictString('src'),\n      optionString('alt'),\n      defaultedArrayOf('classes', [], string)\n    ];\n    var cardImageSchema = objOf(cardImageFields);\n\n    var cardTextFields = [\n      strictString('type'),\n      strictString('text'),\n      optionString('name'),\n      defaultedArrayOf('classes', ['tox-collection__item-label'], string)\n    ];\n    var cardTextSchema = objOf(cardTextFields);\n\n    var itemSchema$2 = valueThunkOf(function () {\n      return chooseProcessor('type', {\n        cardimage: cardImageSchema,\n        cardtext: cardTextSchema,\n        cardcontainer: cardContainerSchema\n      });\n    });\n    var cardContainerSchema = objOf([\n      strictString('type'),\n      defaultedString('direction', 'horizontal'),\n      defaultedString('align', 'left'),\n      defaultedString('valign', 'middle'),\n      strictArrayOf('items', itemSchema$2)\n    ]);\n\n    var commonMenuItemFields = [\n      defaultedBoolean('disabled', false),\n      optionString('text'),\n      optionString('shortcut'),\n      field('value', 'value', defaultedThunk(function () {\n        return generate$1('menuitem-value');\n      }), anyValue$1()),\n      defaulted$1('meta', {})\n    ];\n\n    var cardMenuItemSchema = objOf([\n      strictString('type'),\n      optionString('label'),\n      strictArrayOf('items', itemSchema$2),\n      defaultedFunction('onSetup', function () {\n        return noop;\n      }),\n      defaultedFunction('onAction', noop)\n    ].concat(commonMenuItemFields));\n    var createCardMenuItem = function (spec) {\n      return asRaw('cardmenuitem', cardMenuItemSchema, spec);\n    };\n\n    var choiceMenuItemSchema = objOf([\n      strictString('type'),\n      defaultedBoolean('active', false),\n      optionString('icon')\n    ].concat(commonMenuItemFields));\n    var createChoiceMenuItem = function (spec) {\n      return asRaw('choicemenuitem', choiceMenuItemSchema, spec);\n    };\n\n    var fancyTypes = [\n      'inserttable',\n      'colorswatch'\n    ];\n    var fancyMenuItemSchema = objOf([\n      strictString('type'),\n      strictStringEnum('fancytype', fancyTypes),\n      defaultedFunction('onAction', noop)\n    ]);\n    var createFancyMenuItem = function (spec) {\n      return asRaw('fancymenuitem', fancyMenuItemSchema, spec);\n    };\n\n    var menuItemSchema = objOf([\n      strictString('type'),\n      defaultedFunction('onSetup', function () {\n        return noop;\n      }),\n      defaultedFunction('onAction', noop),\n      optionString('icon')\n    ].concat(commonMenuItemFields));\n    var createMenuItem = function (spec) {\n      return asRaw('menuitem', menuItemSchema, spec);\n    };\n\n    var nestedMenuItemSchema = objOf([\n      strictString('type'),\n      strictFunction('getSubmenuItems'),\n      defaultedFunction('onSetup', function () {\n        return noop;\n      }),\n      optionString('icon')\n    ].concat(commonMenuItemFields));\n    var createNestedMenuItem = function (spec) {\n      return asRaw('nestedmenuitem', nestedMenuItemSchema, spec);\n    };\n\n    var toggleMenuItemSchema = objOf([\n      strictString('type'),\n      optionString('icon'),\n      defaultedBoolean('active', false),\n      defaultedFunction('onSetup', function () {\n        return noop;\n      }),\n      strictFunction('onAction')\n    ].concat(commonMenuItemFields));\n    var createToggleMenuItem = function (spec) {\n      return asRaw('togglemenuitem', toggleMenuItemSchema, spec);\n    };\n\n    var detectSize = function (comp, margin, selectorClass) {\n      var descendants$1 = descendants(comp.element, '.' + selectorClass);\n      if (descendants$1.length > 0) {\n        var columnLength = findIndex(descendants$1, function (c) {\n          var thisTop = c.dom.getBoundingClientRect().top;\n          var cTop = descendants$1[0].dom.getBoundingClientRect().top;\n          return Math.abs(thisTop - cTop) > margin;\n        }).getOr(descendants$1.length);\n        return Optional.some({\n          numColumns: columnLength,\n          numRows: Math.ceil(descendants$1.length / columnLength)\n        });\n      } else {\n        return Optional.none();\n      }\n    };\n\n    var namedEvents = function (name, handlers) {\n      return derive$1([config(name, handlers)]);\n    };\n    var unnamedEvents = function (handlers) {\n      return namedEvents(generate$1('unnamed-events'), handlers);\n    };\n    var SimpleBehaviours = {\n      namedEvents: namedEvents,\n      unnamedEvents: unnamedEvents\n    };\n\n    var ExclusivityChannel = generate$1('tooltip.exclusive');\n    var ShowTooltipEvent = generate$1('tooltip.show');\n    var HideTooltipEvent = generate$1('tooltip.hide');\n\n    var hideAllExclusive = function (component, _tConfig, _tState) {\n      component.getSystem().broadcastOn([ExclusivityChannel], {});\n    };\n    var setComponents = function (component, tConfig, tState, specs) {\n      tState.getTooltip().each(function (tooltip) {\n        if (tooltip.getSystem().isConnected()) {\n          Replacing.set(tooltip, specs);\n        }\n      });\n    };\n\n    var TooltippingApis = /*#__PURE__*/Object.freeze({\n        __proto__: null,\n        hideAllExclusive: hideAllExclusive,\n        setComponents: setComponents\n    });\n\n    var events$8 = function (tooltipConfig, state) {\n      var hide = function (comp) {\n        state.getTooltip().each(function (p) {\n          detach(p);\n          tooltipConfig.onHide(comp, p);\n          state.clearTooltip();\n        });\n        state.clearTimer();\n      };\n      var show = function (comp) {\n        if (!state.isShowing()) {\n          hideAllExclusive(comp);\n          var sink = tooltipConfig.lazySink(comp).getOrDie();\n          var popup = comp.getSystem().build({\n            dom: tooltipConfig.tooltipDom,\n            components: tooltipConfig.tooltipComponents,\n            events: derive(tooltipConfig.mode === 'normal' ? [\n              run(mouseover(), function (_) {\n                emit(comp, ShowTooltipEvent);\n              }),\n              run(mouseout(), function (_) {\n                emit(comp, HideTooltipEvent);\n              })\n            ] : []),\n            behaviours: derive$1([Replacing.config({})])\n          });\n          state.setTooltip(popup);\n          attach$1(sink, popup);\n          tooltipConfig.onShow(comp, popup);\n          Positioning.position(sink, tooltipConfig.anchor(comp), popup);\n        }\n      };\n      return derive(flatten([\n        [\n          run(ShowTooltipEvent, function (comp) {\n            state.resetTimer(function () {\n              show(comp);\n            }, tooltipConfig.delay);\n          }),\n          run(HideTooltipEvent, function (comp) {\n            state.resetTimer(function () {\n              hide(comp);\n            }, tooltipConfig.delay);\n          }),\n          run(receive(), function (comp, message) {\n            var receivingData = message;\n            if (!receivingData.universal) {\n              if (contains(receivingData.channels, ExclusivityChannel)) {\n                hide(comp);\n              }\n            }\n          }),\n          runOnDetached(function (comp) {\n            hide(comp);\n          })\n        ],\n        tooltipConfig.mode === 'normal' ? [\n          run(focusin(), function (comp) {\n            emit(comp, ShowTooltipEvent);\n          }),\n          run(postBlur(), function (comp) {\n            emit(comp, HideTooltipEvent);\n          }),\n          run(mouseover(), function (comp) {\n            emit(comp, ShowTooltipEvent);\n          }),\n          run(mouseout(), function (comp) {\n            emit(comp, HideTooltipEvent);\n          })\n        ] : [\n          run(highlight(), function (comp, _se) {\n            emit(comp, ShowTooltipEvent);\n          }),\n          run(dehighlight(), function (comp) {\n            emit(comp, HideTooltipEvent);\n          })\n        ]\n      ]));\n    };\n\n    var ActiveTooltipping = /*#__PURE__*/Object.freeze({\n        __proto__: null,\n        events: events$8\n    });\n\n    var TooltippingSchema = [\n      strict$1('lazySink'),\n      strict$1('tooltipDom'),\n      defaulted$1('exclusive', true),\n      defaulted$1('tooltipComponents', []),\n      defaulted$1('delay', 300),\n      defaultedStringEnum('mode', 'normal', [\n        'normal',\n        'follow-highlight'\n      ]),\n      defaulted$1('anchor', function (comp) {\n        return {\n          anchor: 'hotspot',\n          hotspot: comp,\n          layouts: {\n            onLtr: constant([\n              south$1,\n              north$1,\n              southeast$1,\n              northeast$1,\n              southwest$1,\n              northwest$1\n            ]),\n            onRtl: constant([\n              south$1,\n              north$1,\n              southeast$1,\n              northeast$1,\n              southwest$1,\n              northwest$1\n            ])\n          }\n        };\n      }),\n      onHandler('onHide'),\n      onHandler('onShow')\n    ];\n\n    var init$4 = function () {\n      var timer = Cell(Optional.none());\n      var popup = Cell(Optional.none());\n      var getTooltip = function () {\n        return popup.get();\n      };\n      var setTooltip = function (comp) {\n        popup.set(Optional.some(comp));\n      };\n      var clearTooltip = function () {\n        popup.set(Optional.none());\n      };\n      var clearTimer = function () {\n        timer.get().each(function (t) {\n          clearTimeout(t);\n        });\n      };\n      var resetTimer = function (f, delay) {\n        clearTimer();\n        timer.set(Optional.some(setTimeout(function () {\n          f();\n        }, delay)));\n      };\n      var isShowing = function () {\n        return popup.get().isSome();\n      };\n      var readState = constant('not-implemented');\n      return nu$5({\n        getTooltip: getTooltip,\n        isShowing: isShowing,\n        setTooltip: setTooltip,\n        clearTooltip: clearTooltip,\n        clearTimer: clearTimer,\n        resetTimer: resetTimer,\n        readState: readState\n      });\n    };\n\n    var TooltippingState = /*#__PURE__*/Object.freeze({\n        __proto__: null,\n        init: init$4\n    });\n\n    var Tooltipping = create$1({\n      fields: TooltippingSchema,\n      name: 'tooltipping',\n      active: ActiveTooltipping,\n      state: TooltippingState,\n      apis: TooltippingApis\n    });\n\n    var escape = function (text) {\n      return text.replace(/[.*+?^${}()|[\\]\\\\]/g, '\\\\$&');\n    };\n\n    var global$5 = tinymce.util.Tools.resolve('tinymce.dom.DOMUtils');\n\n    var global$6 = tinymce.util.Tools.resolve('tinymce.util.I18n');\n\n    var nativeDisabled = [\n      'input',\n      'button',\n      'textarea',\n      'select'\n    ];\n    var onLoad$5 = function (component, disableConfig, disableState) {\n      var f = disableConfig.disabled() ? disable : enable;\n      f(component, disableConfig);\n    };\n    var hasNative = function (component, config) {\n      return config.useNative === true && contains(nativeDisabled, name(component.element));\n    };\n    var nativeIsDisabled = function (component) {\n      return has$1(component.element, 'disabled');\n    };\n    var nativeDisable = function (component) {\n      set$1(component.element, 'disabled', 'disabled');\n    };\n    var nativeEnable = function (component) {\n      remove$1(component.element, 'disabled');\n    };\n    var ariaIsDisabled = function (component) {\n      return get$3(component.element, 'aria-disabled') === 'true';\n    };\n    var ariaDisable = function (component) {\n      set$1(component.element, 'aria-disabled', 'true');\n    };\n    var ariaEnable = function (component) {\n      set$1(component.element, 'aria-disabled', 'false');\n    };\n    var disable = function (component, disableConfig, _disableState) {\n      disableConfig.disableClass.each(function (disableClass) {\n        add$2(component.element, disableClass);\n      });\n      var f = hasNative(component, disableConfig) ? nativeDisable : ariaDisable;\n      f(component);\n      disableConfig.onDisabled(component);\n    };\n    var enable = function (component, disableConfig, _disableState) {\n      disableConfig.disableClass.each(function (disableClass) {\n        remove$4(component.element, disableClass);\n      });\n      var f = hasNative(component, disableConfig) ? nativeEnable : ariaEnable;\n      f(component);\n      disableConfig.onEnabled(component);\n    };\n    var isDisabled = function (component, disableConfig) {\n      return hasNative(component, disableConfig) ? nativeIsDisabled(component) : ariaIsDisabled(component);\n    };\n    var set$7 = function (component, disableConfig, disableState, disabled) {\n      var f = disabled ? disable : enable;\n      f(component, disableConfig);\n    };\n\n    var DisableApis = /*#__PURE__*/Object.freeze({\n        __proto__: null,\n        enable: enable,\n        disable: disable,\n        isDisabled: isDisabled,\n        onLoad: onLoad$5,\n        set: set$7\n    });\n\n    var exhibit$3 = function (base, disableConfig) {\n      return nu$6({ classes: disableConfig.disabled() ? disableConfig.disableClass.toArray() : [] });\n    };\n    var events$9 = function (disableConfig, disableState) {\n      return derive([\n        abort(execute(), function (component, _simulatedEvent) {\n          return isDisabled(component, disableConfig);\n        }),\n        loadEvent(disableConfig, disableState, onLoad$5)\n      ]);\n    };\n\n    var ActiveDisable = /*#__PURE__*/Object.freeze({\n        __proto__: null,\n        exhibit: exhibit$3,\n        events: events$9\n    });\n\n    var DisableSchema = [\n      defaultedFunction('disabled', never),\n      defaulted$1('useNative', true),\n      option('disableClass'),\n      onHandler('onDisabled'),\n      onHandler('onEnabled')\n    ];\n\n    var Disabling = create$1({\n      fields: DisableSchema,\n      name: 'disabling',\n      active: ActiveDisable,\n      apis: DisableApis\n    });\n\n    var global$7 = tinymce.util.Tools.resolve('tinymce.EditorManager');\n\n    var getSkinUrl = function (editor) {\n      var skin = editor.getParam('skin');\n      var skinUrl = editor.getParam('skin_url');\n      if (skin !== false) {\n        var skinName = skin ? skin : 'oxide';\n        if (skinUrl) {\n          skinUrl = editor.documentBaseURI.toAbsolute(skinUrl);\n        } else {\n          skinUrl = global$7.baseURL + '/skins/ui/' + skinName;\n        }\n      }\n      return skinUrl;\n    };\n    var isReadOnly = function (editor) {\n      return editor.getParam('readonly', false, 'boolean');\n    };\n    var isSkinDisabled = function (editor) {\n      return editor.getParam('skin') === false;\n    };\n    var getHeightSetting = function (editor) {\n      return editor.getParam('height', Math.max(editor.getElement().offsetHeight, 200));\n    };\n    var getWidthSetting = function (editor) {\n      return editor.getParam('width', global$5.DOM.getStyle(editor.getElement(), 'width'));\n    };\n    var getMinWidthSetting = function (editor) {\n      return Optional.from(editor.getParam('min_width')).filter(isNumber);\n    };\n    var getMinHeightSetting = function (editor) {\n      return Optional.from(editor.getParam('min_height')).filter(isNumber);\n    };\n    var getMaxWidthSetting = function (editor) {\n      return Optional.from(editor.getParam('max_width')).filter(isNumber);\n    };\n    var getMaxHeightSetting = function (editor) {\n      return Optional.from(editor.getParam('max_height')).filter(isNumber);\n    };\n    var getUserStyleFormats = function (editor) {\n      return Optional.from(editor.getParam('style_formats')).filter(isArray);\n    };\n    var isMergeStyleFormats = function (editor) {\n      return editor.getParam('style_formats_merge', false, 'boolean');\n    };\n    var getLineHeightFormats = function (editor) {\n      return editor.getParam('lineheight_formats', '1 1.1 1.2 1.3 1.4 1.5 2', 'string').split(' ');\n    };\n    var getRemovedMenuItems = function (editor) {\n      return editor.getParam('removed_menuitems', '');\n    };\n    var isMenubarEnabled = function (editor) {\n      return editor.getParam('menubar', true, 'boolean') !== false;\n    };\n    var isToolbarEnabled = function (editor) {\n      var toolbar = editor.getParam('toolbar', true);\n      var isToolbarTrue = toolbar === true;\n      var isToolbarString = isString(toolbar);\n      var isToolbarObjectArray = isArray(toolbar) && toolbar.length > 0;\n      return !isMultipleToolbars(editor) && (isToolbarObjectArray || isToolbarString || isToolbarTrue);\n    };\n    var getMultipleToolbarsSetting = function (editor) {\n      var toolbars = range(9, function (num) {\n        return editor.getParam('toolbar' + (num + 1), false, 'string');\n      });\n      var toolbarArray = filter(toolbars, function (toolbar) {\n        return typeof toolbar === 'string';\n      });\n      return toolbarArray.length > 0 ? Optional.some(toolbarArray) : Optional.none();\n    };\n    var isMultipleToolbars = function (editor) {\n      return getMultipleToolbarsSetting(editor).fold(function () {\n        var toolbar = editor.getParam('toolbar', [], 'string[]');\n        return toolbar.length > 0;\n      }, always);\n    };\n    var ToolbarMode;\n    (function (ToolbarMode) {\n      ToolbarMode['default'] = 'wrap';\n      ToolbarMode['floating'] = 'floating';\n      ToolbarMode['sliding'] = 'sliding';\n      ToolbarMode['scrolling'] = 'scrolling';\n    }(ToolbarMode || (ToolbarMode = {})));\n    var getToolbarMode = function (editor) {\n      return editor.getParam('toolbar_mode', '', 'string');\n    };\n    var ToolbarLocation;\n    (function (ToolbarLocation) {\n      ToolbarLocation['auto'] = 'auto';\n      ToolbarLocation['top'] = 'top';\n      ToolbarLocation['bottom'] = 'bottom';\n    }(ToolbarLocation || (ToolbarLocation = {})));\n    var getToolbarGroups = function (editor) {\n      return editor.getParam('toolbar_groups', {}, 'object');\n    };\n    var getToolbarLocation = function (editor) {\n      return editor.getParam('toolbar_location', ToolbarLocation.auto, 'string');\n    };\n    var isToolbarLocationBottom = function (editor) {\n      return getToolbarLocation(editor) === ToolbarLocation.bottom;\n    };\n    var fixedContainerSelector = function (editor) {\n      return editor.getParam('fixed_toolbar_container', '', 'string');\n    };\n    var fixedToolbarContainerTarget = function (editor) {\n      return editor.getParam('fixed_toolbar_container_target');\n    };\n    var isToolbarPersist = function (editor) {\n      return editor.getParam('toolbar_persist', false, 'boolean');\n    };\n    var fixedContainerTarget = function (editor) {\n      if (!editor.inline) {\n        return Optional.none();\n      }\n      var selector = fixedContainerSelector(editor);\n      if (selector.length > 0) {\n        return descendant$1(body(), selector);\n      }\n      var element = fixedToolbarContainerTarget(editor);\n      if (isNonNullable(element)) {\n        return Optional.some(SugarElement.fromDom(element));\n      }\n      return Optional.none();\n    };\n    var useFixedContainer = function (editor) {\n      return editor.inline && fixedContainerTarget(editor).isSome();\n    };\n    var getUiContainer = function (editor) {\n      var fixedContainer = fixedContainerTarget(editor);\n      return fixedContainer.getOrThunk(function () {\n        return getContentContainer(getRootNode(SugarElement.fromDom(editor.getElement())));\n      });\n    };\n    var isDistractionFree = function (editor) {\n      return editor.inline && !isMenubarEnabled(editor) && !isToolbarEnabled(editor) && !isMultipleToolbars(editor);\n    };\n    var isStickyToolbar = function (editor) {\n      var isStickyToolbar = editor.getParam('toolbar_sticky', false, 'boolean');\n      return (isStickyToolbar || editor.inline) && !useFixedContainer(editor) && !isDistractionFree(editor);\n    };\n    var isDraggableModal = function (editor) {\n      return editor.getParam('draggable_modal', false, 'boolean');\n    };\n    var getMenus = function (editor) {\n      var menu = editor.getParam('menu');\n      if (menu) {\n        return map$2(menu, function (menu) {\n          return __assign(__assign({}, menu), { items: menu.items });\n        });\n      } else {\n        return {};\n      }\n    };\n    var getMenubar = function (editor) {\n      return editor.getParam('menubar');\n    };\n    var getToolbar = function (editor) {\n      return editor.getParam('toolbar', true);\n    };\n    var getFilePickerCallback = function (editor) {\n      return editor.getParam('file_picker_callback');\n    };\n    var getFilePickerTypes = function (editor) {\n      return editor.getParam('file_picker_types');\n    };\n    var getFileBrowserCallbackTypes = function (editor) {\n      return editor.getParam('file_browser_callback_types');\n    };\n    var noTypeaheadUrls = function (editor) {\n      return editor.getParam('typeahead_urls') === false;\n    };\n    var getAnchorTop = function (editor) {\n      return editor.getParam('anchor_top', '#top');\n    };\n    var getAnchorBottom = function (editor) {\n      return editor.getParam('anchor_bottom', '#bottom');\n    };\n    var getFilePickerValidatorHandler = function (editor) {\n      var handler = editor.getParam('file_picker_validator_handler', undefined, 'function');\n      if (handler === undefined) {\n        return editor.getParam('filepicker_validator_handler', undefined, 'function');\n      } else {\n        return handler;\n      }\n    };\n\n    var ReadOnlyChannel = 'silver.readonly';\n    var ReadOnlyDataSchema = objOf([strictBoolean('readonly')]);\n    var broadcastReadonly = function (uiComponents, readonly) {\n      var outerContainer = uiComponents.outerContainer;\n      var target = outerContainer.element;\n      if (readonly) {\n        uiComponents.mothership.broadcastOn([dismissPopups()], { target: target });\n        uiComponents.uiMothership.broadcastOn([dismissPopups()], { target: target });\n      }\n      uiComponents.mothership.broadcastOn([ReadOnlyChannel], { readonly: readonly });\n      uiComponents.uiMothership.broadcastOn([ReadOnlyChannel], { readonly: readonly });\n    };\n    var setupReadonlyModeSwitch = function (editor, uiComponents) {\n      editor.on('init', function () {\n        if (editor.mode.isReadOnly()) {\n          broadcastReadonly(uiComponents, true);\n        }\n      });\n      editor.on('SwitchMode', function () {\n        return broadcastReadonly(uiComponents, editor.mode.isReadOnly());\n      });\n      if (isReadOnly(editor)) {\n        editor.setMode('readonly');\n      }\n    };\n    var receivingConfig = function () {\n      var _a;\n      return Receiving.config({\n        channels: (_a = {}, _a[ReadOnlyChannel] = {\n          schema: ReadOnlyDataSchema,\n          onReceive: function (comp, data) {\n            Disabling.set(comp, data.readonly);\n          }\n        }, _a)\n      });\n    };\n\n    var item = function (disabled) {\n      return Disabling.config({\n        disabled: disabled,\n        disableClass: 'tox-collection__item--state-disabled'\n      });\n    };\n    var button = function (disabled) {\n      return Disabling.config({ disabled: disabled });\n    };\n    var splitButton = function (disabled) {\n      return Disabling.config({\n        disabled: disabled,\n        disableClass: 'tox-tbtn--disabled'\n      });\n    };\n    var toolbarButton = function (disabled) {\n      return Disabling.config({\n        disabled: disabled,\n        disableClass: 'tox-tbtn--disabled',\n        useNative: false\n      });\n    };\n    var DisablingConfigs = {\n      item: item,\n      button: button,\n      splitButton: splitButton,\n      toolbarButton: toolbarButton\n    };\n\n    var runWithApi = function (info, comp) {\n      var api = info.getApi(comp);\n      return function (f) {\n        f(api);\n      };\n    };\n    var onControlAttached = function (info, editorOffCell) {\n      return runOnAttached(function (comp) {\n        var run = runWithApi(info, comp);\n        run(function (api) {\n          var onDestroy = info.onSetup(api);\n          if (isFunction(onDestroy)) {\n            editorOffCell.set(onDestroy);\n          }\n        });\n      });\n    };\n    var onControlDetached = function (getApi, editorOffCell) {\n      return runOnDetached(function (comp) {\n        return runWithApi(getApi, comp)(editorOffCell.get());\n      });\n    };\n\n    var _a;\n    var onMenuItemExecute = function (info, itemResponse) {\n      return runOnExecute(function (comp, simulatedEvent) {\n        runWithApi(info, comp)(info.onAction);\n        if (!info.triggersSubmenu && itemResponse === ItemResponse$1.CLOSE_ON_EXECUTE) {\n          if (comp.getSystem().isConnected()) {\n            emit(comp, sandboxClose());\n          }\n          simulatedEvent.stop();\n        }\n      });\n    };\n    var menuItemEventOrder = (_a = {}, _a[execute()] = [\n      'disabling',\n      'alloy.base.behaviour',\n      'toggling',\n      'item-events'\n    ], _a);\n\n    var componentRenderPipeline = function (xs) {\n      return bind(xs, function (o) {\n        return o.toArray();\n      });\n    };\n    var renderCommonItem = function (spec, structure, itemResponse, providersbackstage) {\n      var editorOffCell = Cell(noop);\n      return {\n        type: 'item',\n        dom: structure.dom,\n        components: componentRenderPipeline(structure.optComponents),\n        data: spec.data,\n        eventOrder: menuItemEventOrder,\n        hasSubmenu: spec.triggersSubmenu,\n        itemBehaviours: derive$1([\n          config('item-events', [\n            onMenuItemExecute(spec, itemResponse),\n            onControlAttached(spec, editorOffCell),\n            onControlDetached(spec, editorOffCell)\n          ]),\n          DisablingConfigs.item(function () {\n            return spec.disabled || providersbackstage.isDisabled();\n          }),\n          receivingConfig(),\n          Replacing.config({})\n        ].concat(spec.itemBehaviours))\n      };\n    };\n    var buildData = function (source) {\n      return {\n        value: source.value,\n        meta: __assign({ text: source.text.getOr('') }, source.meta)\n      };\n    };\n\n    var global$8 = tinymce.util.Tools.resolve('tinymce.Env');\n\n    var convertText = function (source) {\n      var mac = {\n        alt: '&#x2325;',\n        ctrl: '&#x2303;',\n        shift: '&#x21E7;',\n        meta: '&#x2318;',\n        access: '&#x2303;&#x2325;'\n      };\n      var other = {\n        meta: 'Ctrl',\n        access: 'Shift+Alt'\n      };\n      var replace = global$8.mac ? mac : other;\n      var shortcut = source.split('+');\n      var updated = map(shortcut, function (segment) {\n        var search = segment.toLowerCase().trim();\n        return has(replace, search) ? replace[search] : segment;\n      });\n      return global$8.mac ? updated.join('') : updated.join('+');\n    };\n\n    var renderIcon = function (iconHtml) {\n      return {\n        dom: {\n          tag: 'div',\n          classes: [iconClass],\n          innerHtml: iconHtml\n        }\n      };\n    };\n    var renderText = function (text$1) {\n      return {\n        dom: {\n          tag: 'div',\n          classes: [textClass]\n        },\n        components: [text(global$6.translate(text$1))]\n      };\n    };\n    var renderHtml = function (html, classes) {\n      return {\n        dom: {\n          tag: 'div',\n          classes: classes,\n          innerHtml: html\n        }\n      };\n    };\n    var renderStyledText = function (style, text$1) {\n      return {\n        dom: {\n          tag: 'div',\n          classes: [textClass]\n        },\n        components: [{\n            dom: {\n              tag: style.tag,\n              styles: style.styles\n            },\n            components: [text(global$6.translate(text$1))]\n          }]\n      };\n    };\n    var renderShortcut = function (shortcut) {\n      return {\n        dom: {\n          tag: 'div',\n          classes: [accessoryClass],\n          innerHtml: convertText(shortcut)\n        }\n      };\n    };\n    var renderCheckmark = function (icons) {\n      return {\n        dom: {\n          tag: 'div',\n          classes: [checkmarkClass],\n          innerHtml: get$e('checkmark', icons)\n        }\n      };\n    };\n    var renderSubmenuCaret = function (icons) {\n      return {\n        dom: {\n          tag: 'div',\n          classes: [caretClass],\n          innerHtml: get$e('chevron-right', icons)\n        }\n      };\n    };\n    var renderDownwardsCaret = function (icons) {\n      return {\n        dom: {\n          tag: 'div',\n          classes: [caretClass],\n          innerHtml: get$e('chevron-down', icons)\n        }\n      };\n    };\n    var renderContainer = function (container, components) {\n      var directionClass = container.direction === 'vertical' ? containerColumnClass : containerRowClass;\n      var alignClass = container.align === 'left' ? containerAlignLeftClass : containerAlignRightClass;\n      var getValignClass = function () {\n        switch (container.valign) {\n        case 'top':\n          return containerValignTopClass;\n        case 'middle':\n          return containerValignMiddleClass;\n        case 'bottom':\n          return containerValignBottomClass;\n        }\n      };\n      return {\n        dom: {\n          tag: 'div',\n          classes: [\n            containerClass,\n            directionClass,\n            alignClass,\n            getValignClass()\n          ]\n        },\n        components: components\n      };\n    };\n    var renderImage = function (src, classes, alt) {\n      return {\n        dom: {\n          tag: 'img',\n          classes: classes,\n          attributes: {\n            src: src,\n            alt: alt.getOr('')\n          }\n        }\n      };\n    };\n\n    var renderColorStructure = function (itemText, itemValue, iconSvg, providerBackstage) {\n      var colorPickerCommand = 'custom';\n      var removeColorCommand = 'remove';\n      var getDom = function () {\n        var common = colorClass;\n        var icon = iconSvg.getOr('');\n        var attributes = itemText.map(function (text) {\n          return { title: providerBackstage.translate(text) };\n        }).getOr({});\n        var baseDom = {\n          tag: 'div',\n          attributes: attributes,\n          classes: [common]\n        };\n        if (itemValue === colorPickerCommand) {\n          return __assign(__assign({}, baseDom), {\n            tag: 'button',\n            classes: __spreadArrays(baseDom.classes, ['tox-swatches__picker-btn']),\n            innerHtml: icon\n          });\n        } else if (itemValue === removeColorCommand) {\n          return __assign(__assign({}, baseDom), {\n            classes: __spreadArrays(baseDom.classes, ['tox-swatch--remove']),\n            innerHtml: icon\n          });\n        } else {\n          return __assign(__assign({}, baseDom), {\n            attributes: __assign(__assign({}, baseDom.attributes), { 'data-mce-color': itemValue }),\n            styles: { 'background-color': itemValue }\n          });\n        }\n      };\n      return {\n        dom: getDom(),\n        optComponents: []\n      };\n    };\n    var renderItemDomStructure = function (rtlClass, ariaLabel) {\n      var domTitle = ariaLabel.map(function (label) {\n        return { attributes: { title: global$6.translate(label) } };\n      }).getOr({});\n      return __assign({\n        tag: 'div',\n        classes: [\n          navClass,\n          selectableClass\n        ].concat(rtlClass ? [iconClassRtl] : [])\n      }, domTitle);\n    };\n    var renderNormalItemStructure = function (info, icon, renderIcons, textRender, rtlClass) {\n      var leftIcon = renderIcons ? icon.or(Optional.some('')).map(renderIcon) : Optional.none();\n      var checkmark = info.checkMark;\n      var content = info.htmlContent.fold(function () {\n        return info.textContent.map(textRender);\n      }, function (html) {\n        return Optional.some(renderHtml(html, [textClass]));\n      });\n      var menuItem = {\n        dom: renderItemDomStructure(rtlClass, info.ariaLabel),\n        optComponents: [\n          leftIcon,\n          content,\n          info.shortcutContent.map(renderShortcut),\n          checkmark,\n          info.caret\n        ]\n      };\n      return menuItem;\n    };\n    var rtlIcon = [\n      'list-num-default',\n      'list-num-lower-alpha',\n      'list-num-lower-greek',\n      'list-num-lower-roman',\n      'list-num-upper-alpha',\n      'list-num-upper-roman'\n    ];\n    var rtlTransform = [\n      'list-bull-circle',\n      'list-bull-default',\n      'list-bull-square'\n    ];\n    var renderItemStructure = function (info, providersBackstage, renderIcons, fallbackIcon) {\n      if (fallbackIcon === void 0) {\n        fallbackIcon = Optional.none();\n      }\n      var getIconName = function (iconName) {\n        return iconName.map(function (name) {\n          return global$6.isRtl() && contains(rtlIcon, name) ? name + '-rtl' : name;\n        });\n      };\n      var needRtlClass = global$6.isRtl() && info.iconContent.exists(function (name) {\n        return contains(rtlTransform, name);\n      });\n      var icon = getIconName(info.iconContent).map(function (iconName) {\n        return getOr(iconName, providersBackstage.icons, fallbackIcon);\n      });\n      var textRender = Optional.from(info.meta).fold(function () {\n        return renderText;\n      }, function (meta) {\n        return has(meta, 'style') ? curry(renderStyledText, meta.style) : renderText;\n      });\n      if (info.presets === 'color') {\n        return renderColorStructure(info.ariaLabel, info.value, icon, providersBackstage);\n      } else {\n        return renderNormalItemStructure(info, icon, renderIcons, textRender, needRtlClass);\n      }\n    };\n\n    var tooltipBehaviour = function (meta, sharedBackstage) {\n      return get$1(meta, 'tooltipWorker').map(function (tooltipWorker) {\n        return [Tooltipping.config({\n            lazySink: sharedBackstage.getSink,\n            tooltipDom: {\n              tag: 'div',\n              classes: ['tox-tooltip-worker-container']\n            },\n            tooltipComponents: [],\n            anchor: function (comp) {\n              return {\n                anchor: 'submenu',\n                item: comp,\n                overrides: { maxHeightFunction: expandable }\n              };\n            },\n            mode: 'follow-highlight',\n            onShow: function (component, _tooltip) {\n              tooltipWorker(function (elm) {\n                Tooltipping.setComponents(component, [external({ element: SugarElement.fromDom(elm) })]);\n              });\n            }\n          })];\n      }).getOr([]);\n    };\n    var encodeText = function (text) {\n      return global$5.DOM.encode(text);\n    };\n    var replaceText = function (text, matchText) {\n      var translated = global$6.translate(text);\n      var encoded = encodeText(translated);\n      if (matchText.length > 0) {\n        var escapedMatchRegex = new RegExp(escape(matchText), 'gi');\n        return encoded.replace(escapedMatchRegex, function (match) {\n          return '<span class=\"tox-autocompleter-highlight\">' + match + '</span>';\n        });\n      } else {\n        return encoded;\n      }\n    };\n    var renderAutocompleteItem = function (spec, matchText, useText, presets, onItemValueHandler, itemResponse, sharedBackstage, renderIcons) {\n      if (renderIcons === void 0) {\n        renderIcons = true;\n      }\n      var structure = renderItemStructure({\n        presets: presets,\n        textContent: Optional.none(),\n        htmlContent: useText ? spec.text.map(function (text) {\n          return replaceText(text, matchText);\n        }) : Optional.none(),\n        ariaLabel: spec.text,\n        iconContent: spec.icon,\n        shortcutContent: Optional.none(),\n        checkMark: Optional.none(),\n        caret: Optional.none(),\n        value: spec.value\n      }, sharedBackstage.providers, renderIcons, spec.icon);\n      return renderCommonItem({\n        data: buildData(spec),\n        disabled: spec.disabled,\n        getApi: constant({}),\n        onAction: function (_api) {\n          return onItemValueHandler(spec.value, spec.meta);\n        },\n        onSetup: constant(noop),\n        triggersSubmenu: false,\n        itemBehaviours: tooltipBehaviour(spec.meta, sharedBackstage)\n      }, structure, itemResponse, sharedBackstage.providers);\n    };\n\n    var render = function (items, extras) {\n      return map(items, function (item) {\n        switch (item.type) {\n        case 'cardcontainer':\n          return renderContainer(item, render(item.items, extras));\n        case 'cardimage':\n          return renderImage(item.src, item.classes, item.alt);\n        case 'cardtext':\n          var shouldHighlight = item.name.exists(function (name) {\n            return contains(extras.cardText.highlightOn, name);\n          });\n          var matchText = shouldHighlight ? Optional.from(extras.cardText.matchText).getOr('') : '';\n          return renderHtml(replaceText(item.text, matchText), item.classes);\n        }\n      });\n    };\n    var renderCardMenuItem = function (spec, itemResponse, sharedBackstage, extras) {\n      var getApi = function (component) {\n        return {\n          isDisabled: function () {\n            return Disabling.isDisabled(component);\n          },\n          setDisabled: function (state) {\n            Disabling.set(component, state);\n            each(descendants(component.element, '*'), function (elm) {\n              component.getSystem().getByDom(elm).each(function (comp) {\n                if (comp.hasConfigured(Disabling)) {\n                  Disabling.set(comp, state);\n                }\n              });\n            });\n          }\n        };\n      };\n      var structure = {\n        dom: renderItemDomStructure(false, spec.label),\n        optComponents: [Optional.some({\n            dom: {\n              tag: 'div',\n              classes: [\n                containerClass,\n                containerRowClass\n              ]\n            },\n            components: render(spec.items, extras)\n          })]\n      };\n      return renderCommonItem({\n        data: buildData(__assign({ text: Optional.none() }, spec)),\n        disabled: spec.disabled,\n        getApi: getApi,\n        onAction: spec.onAction,\n        onSetup: spec.onSetup,\n        triggersSubmenu: false,\n        itemBehaviours: Optional.from(extras.itemBehaviours).getOr([])\n      }, structure, itemResponse, sharedBackstage.providers);\n    };\n\n    var renderChoiceItem = function (spec, useText, presets, onItemValueHandler, isSelected, itemResponse, providersBackstage, renderIcons) {\n      if (renderIcons === void 0) {\n        renderIcons = true;\n      }\n      var getApi = function (component) {\n        return {\n          setActive: function (state) {\n            Toggling.set(component, state);\n          },\n          isActive: function () {\n            return Toggling.isOn(component);\n          },\n          isDisabled: function () {\n            return Disabling.isDisabled(component);\n          },\n          setDisabled: function (state) {\n            return Disabling.set(component, state);\n          }\n        };\n      };\n      var structure = renderItemStructure({\n        presets: presets,\n        textContent: useText ? spec.text : Optional.none(),\n        htmlContent: Optional.none(),\n        ariaLabel: spec.text,\n        iconContent: spec.icon,\n        shortcutContent: useText ? spec.shortcut : Optional.none(),\n        checkMark: useText ? Optional.some(renderCheckmark(providersBackstage.icons)) : Optional.none(),\n        caret: Optional.none(),\n        value: spec.value\n      }, providersBackstage, renderIcons);\n      return deepMerge(renderCommonItem({\n        data: buildData(spec),\n        disabled: spec.disabled,\n        getApi: getApi,\n        onAction: function (_api) {\n          return onItemValueHandler(spec.value);\n        },\n        onSetup: function (api) {\n          api.setActive(isSelected);\n          return noop;\n        },\n        triggersSubmenu: false,\n        itemBehaviours: []\n      }, structure, itemResponse, providersBackstage), {\n        toggling: {\n          toggleClass: tickedClass,\n          toggleOnExecute: false,\n          selected: spec.active\n        }\n      });\n    };\n\n    var parts$2 = generate$4(owner$2(), parts());\n\n    var hexColour = function (value) {\n      return { value: value };\n    };\n    var shorthandRegex = /^#?([a-f\\d])([a-f\\d])([a-f\\d])$/i;\n    var longformRegex = /^#?([a-f\\d]{2})([a-f\\d]{2})([a-f\\d]{2})$/i;\n    var isHexString = function (hex) {\n      return shorthandRegex.test(hex) || longformRegex.test(hex);\n    };\n    var getLongForm = function (hex) {\n      var hexString = hex.value.replace(shorthandRegex, function (m, r, g, b) {\n        return r + r + g + g + b + b;\n      });\n      return { value: hexString };\n    };\n    var extractValues = function (hex) {\n      var longForm = getLongForm(hex);\n      var splitForm = longformRegex.exec(longForm.value);\n      return splitForm === null ? [\n        'FFFFFF',\n        'FF',\n        'FF',\n        'FF'\n      ] : splitForm;\n    };\n    var toHex = function (component) {\n      var hex = component.toString(16);\n      return (hex.length === 1 ? '0' + hex : hex).toUpperCase();\n    };\n    var fromRgba = function (rgbaColour) {\n      var value = toHex(rgbaColour.red) + toHex(rgbaColour.green) + toHex(rgbaColour.blue);\n      return hexColour(value);\n    };\n\n    var min = Math.min;\n    var max = Math.max;\n    var round = Math.round;\n    var rgbRegex = /^rgb\\((\\d+),\\s*(\\d+),\\s*(\\d+)\\)/;\n    var rgbaRegex = /^rgba\\((\\d+),\\s*(\\d+),\\s*(\\d+),\\s*(\\d?(?:\\.\\d+)?)\\)/;\n    var rgbaColour = function (red, green, blue, alpha) {\n      return {\n        red: red,\n        green: green,\n        blue: blue,\n        alpha: alpha\n      };\n    };\n    var isRgbaComponent = function (value) {\n      var num = parseInt(value, 10);\n      return num.toString() === value && num >= 0 && num <= 255;\n    };\n    var fromHsv = function (hsv) {\n      var r;\n      var g;\n      var b;\n      var hue = (hsv.hue || 0) % 360;\n      var saturation = hsv.saturation / 100;\n      var brightness = hsv.value / 100;\n      saturation = max(0, min(saturation, 1));\n      brightness = max(0, min(brightness, 1));\n      if (saturation === 0) {\n        r = g = b = round(255 * brightness);\n        return rgbaColour(r, g, b, 1);\n      }\n      var side = hue / 60;\n      var chroma = brightness * saturation;\n      var x = chroma * (1 - Math.abs(side % 2 - 1));\n      var match = brightness - chroma;\n      switch (Math.floor(side)) {\n      case 0:\n        r = chroma;\n        g = x;\n        b = 0;\n        break;\n      case 1:\n        r = x;\n        g = chroma;\n        b = 0;\n        break;\n      case 2:\n        r = 0;\n        g = chroma;\n        b = x;\n        break;\n      case 3:\n        r = 0;\n        g = x;\n        b = chroma;\n        break;\n      case 4:\n        r = x;\n        g = 0;\n        b = chroma;\n        break;\n      case 5:\n        r = chroma;\n        g = 0;\n        b = x;\n        break;\n      default:\n        r = g = b = 0;\n      }\n      r = round(255 * (r + match));\n      g = round(255 * (g + match));\n      b = round(255 * (b + match));\n      return rgbaColour(r, g, b, 1);\n    };\n    var fromHex = function (hexColour) {\n      var result = extractValues(hexColour);\n      var red = parseInt(result[1], 16);\n      var green = parseInt(result[2], 16);\n      var blue = parseInt(result[3], 16);\n      return rgbaColour(red, green, blue, 1);\n    };\n    var fromStringValues = function (red, green, blue, alpha) {\n      var r = parseInt(red, 10);\n      var g = parseInt(green, 10);\n      var b = parseInt(blue, 10);\n      var a = parseFloat(alpha);\n      return rgbaColour(r, g, b, a);\n    };\n    var fromString = function (rgbaString) {\n      if (rgbaString === 'transparent') {\n        return Optional.some(rgbaColour(0, 0, 0, 0));\n      }\n      var rgbMatch = rgbRegex.exec(rgbaString);\n      if (rgbMatch !== null) {\n        return Optional.some(fromStringValues(rgbMatch[1], rgbMatch[2], rgbMatch[3], '1'));\n      }\n      var rgbaMatch = rgbaRegex.exec(rgbaString);\n      if (rgbaMatch !== null) {\n        return Optional.some(fromStringValues(rgbaMatch[1], rgbaMatch[2], rgbaMatch[3], rgbaMatch[4]));\n      }\n      return Optional.none();\n    };\n    var toString = function (rgba) {\n      return 'rgba(' + rgba.red + ',' + rgba.green + ',' + rgba.blue + ',' + rgba.alpha + ')';\n    };\n    var red = rgbaColour(255, 0, 0, 1);\n\n    var fireSkinLoaded = function (editor) {\n      return editor.fire('SkinLoaded');\n    };\n    var fireSkinLoadError = function (editor, error) {\n      return editor.fire('SkinLoadError', error);\n    };\n    var fireResizeEditor = function (editor) {\n      return editor.fire('ResizeEditor');\n    };\n    var fireResizeContent = function (editor, e) {\n      return editor.fire('ResizeContent', e);\n    };\n    var fireScrollContent = function (editor, e) {\n      return editor.fire('ScrollContent', e);\n    };\n    var fireTextColorChange = function (editor, data) {\n      return editor.fire('TextColorChange', data);\n    };\n\n    var global$9 = tinymce.util.Tools.resolve('tinymce.util.LocalStorage');\n\n    var storageName = 'tinymce-custom-colors';\n    function ColorCache (max) {\n      if (max === void 0) {\n        max = 10;\n      }\n      var storageString = global$9.getItem(storageName);\n      var localstorage = isString(storageString) ? JSON.parse(storageString) : [];\n      var prune = function (list) {\n        var diff = max - list.length;\n        return diff < 0 ? list.slice(0, max) : list;\n      };\n      var cache = prune(localstorage);\n      var add = function (key) {\n        indexOf(cache, key).each(remove);\n        cache.unshift(key);\n        if (cache.length > max) {\n          cache.pop();\n        }\n        global$9.setItem(storageName, JSON.stringify(cache));\n      };\n      var remove = function (idx) {\n        cache.splice(idx, 1);\n      };\n      var state = function () {\n        return cache.slice(0);\n      };\n      return {\n        add: add,\n        state: state\n      };\n    }\n\n    var choiceItem = 'choiceitem';\n    var defaultColors = [\n      {\n        type: choiceItem,\n        text: 'Light Green',\n        value: '#BFEDD2'\n      },\n      {\n        type: choiceItem,\n        text: 'Light Yellow',\n        value: '#FBEEB8'\n      },\n      {\n        type: choiceItem,\n        text: 'Light Red',\n        value: '#F8CAC6'\n      },\n      {\n        type: choiceItem,\n        text: 'Light Purple',\n        value: '#ECCAFA'\n      },\n      {\n        type: choiceItem,\n        text: 'Light Blue',\n        value: '#C2E0F4'\n      },\n      {\n        type: choiceItem,\n        text: 'Green',\n        value: '#2DC26B'\n      },\n      {\n        type: choiceItem,\n        text: 'Yellow',\n        value: '#F1C40F'\n      },\n      {\n        type: choiceItem,\n        text: 'Red',\n        value: '#E03E2D'\n      },\n      {\n        type: choiceItem,\n        text: 'Purple',\n        value: '#B96AD9'\n      },\n      {\n        type: choiceItem,\n        text: 'Blue',\n        value: '#3598DB'\n      },\n      {\n        type: choiceItem,\n        text: 'Dark Turquoise',\n        value: '#169179'\n      },\n      {\n        type: choiceItem,\n        text: 'Orange',\n        value: '#E67E23'\n      },\n      {\n        type: choiceItem,\n        text: 'Dark Red',\n        value: '#BA372A'\n      },\n      {\n        type: choiceItem,\n        text: 'Dark Purple',\n        value: '#843FA1'\n      },\n      {\n        type: choiceItem,\n        text: 'Dark Blue',\n        value: '#236FA1'\n      },\n      {\n        type: choiceItem,\n        text: 'Light Gray',\n        value: '#ECF0F1'\n      },\n      {\n        type: choiceItem,\n        text: 'Medium Gray',\n        value: '#CED4D9'\n      },\n      {\n        type: choiceItem,\n        text: 'Gray',\n        value: '#95A5A6'\n      },\n      {\n        type: choiceItem,\n        text: 'Dark Gray',\n        value: '#7E8C8D'\n      },\n      {\n        type: choiceItem,\n        text: 'Navy Blue',\n        value: '#34495E'\n      },\n      {\n        type: choiceItem,\n        text: 'Black',\n        value: '#000000'\n      },\n      {\n        type: choiceItem,\n        text: 'White',\n        value: '#ffffff'\n      }\n    ];\n    var colorCache = ColorCache(10);\n    var mapColors = function (colorMap) {\n      var colors = [];\n      var canvas = document.createElement('canvas');\n      canvas.height = 1;\n      canvas.width = 1;\n      var ctx = canvas.getContext('2d');\n      var byteAsHex = function (colorByte, alphaByte) {\n        var bg = 255;\n        var alpha = alphaByte / 255;\n        var colorByteWithWhiteBg = Math.round(colorByte * alpha + bg * (1 - alpha));\n        return ('0' + colorByteWithWhiteBg.toString(16)).slice(-2).toUpperCase();\n      };\n      var asHexColor = function (color) {\n        if (/^[0-9A-Fa-f]{6}$/.test(color)) {\n          return '#' + color.toUpperCase();\n        }\n        ctx.clearRect(0, 0, canvas.width, canvas.height);\n        ctx.fillStyle = '#FFFFFF';\n        ctx.fillStyle = color;\n        ctx.fillRect(0, 0, 1, 1);\n        var rgba = ctx.getImageData(0, 0, 1, 1).data;\n        var r = rgba[0], g = rgba[1], b = rgba[2], a = rgba[3];\n        return '#' + byteAsHex(r, a) + byteAsHex(g, a) + byteAsHex(b, a);\n      };\n      for (var i = 0; i < colorMap.length; i += 2) {\n        colors.push({\n          text: colorMap[i + 1],\n          value: asHexColor(colorMap[i]),\n          type: 'choiceitem'\n        });\n      }\n      return colors;\n    };\n    var getColorCols = function (editor, defaultCols) {\n      return editor.getParam('color_cols', defaultCols, 'number');\n    };\n    var hasCustomColors = function (editor) {\n      return editor.getParam('custom_colors') !== false;\n    };\n    var getColorMap = function (editor) {\n      return editor.getParam('color_map');\n    };\n    var getColors = function (editor) {\n      var unmapped = getColorMap(editor);\n      return unmapped !== undefined ? mapColors(unmapped) : defaultColors;\n    };\n    var getCurrentColors = function () {\n      return map(colorCache.state(), function (color) {\n        return {\n          type: choiceItem,\n          text: color,\n          value: color\n        };\n      });\n    };\n    var addColor = function (color) {\n      colorCache.add(color);\n    };\n\n    var getCurrentColor = function (editor, format) {\n      var color;\n      editor.dom.getParents(editor.selection.getStart(), function (elm) {\n        var value;\n        if (value = elm.style[format === 'forecolor' ? 'color' : 'background-color']) {\n          color = color ? color : value;\n        }\n      });\n      return color;\n    };\n    var applyFormat = function (editor, format, value) {\n      editor.undoManager.transact(function () {\n        editor.focus();\n        editor.formatter.apply(format, { value: value });\n        editor.nodeChanged();\n      });\n    };\n    var removeFormat = function (editor, format) {\n      editor.undoManager.transact(function () {\n        editor.focus();\n        editor.formatter.remove(format, { value: null }, null, true);\n        editor.nodeChanged();\n      });\n    };\n    var registerCommands = function (editor) {\n      editor.addCommand('mceApplyTextcolor', function (format, value) {\n        applyFormat(editor, format, value);\n      });\n      editor.addCommand('mceRemoveTextcolor', function (format) {\n        removeFormat(editor, format);\n      });\n    };\n    var calcCols = function (colors) {\n      return Math.max(5, Math.ceil(Math.sqrt(colors)));\n    };\n    var getColorCols$1 = function (editor) {\n      var colors = getColors(editor);\n      var defaultCols = calcCols(colors.length);\n      return getColorCols(editor, defaultCols);\n    };\n    var getAdditionalColors = function (hasCustom) {\n      var type = 'choiceitem';\n      var remove = {\n        type: type,\n        text: 'Remove color',\n        icon: 'color-swatch-remove-color',\n        value: 'remove'\n      };\n      var custom = {\n        type: type,\n        text: 'Custom color',\n        icon: 'color-picker',\n        value: 'custom'\n      };\n      return hasCustom ? [\n        remove,\n        custom\n      ] : [remove];\n    };\n    var applyColor = function (editor, format, value, onChoice) {\n      if (value === 'custom') {\n        var dialog = colorPickerDialog(editor);\n        dialog(function (colorOpt) {\n          colorOpt.each(function (color) {\n            addColor(color);\n            editor.execCommand('mceApplyTextcolor', format, color);\n            onChoice(color);\n          });\n        }, '#000000');\n      } else if (value === 'remove') {\n        onChoice('');\n        editor.execCommand('mceRemoveTextcolor', format);\n      } else {\n        onChoice(value);\n        editor.execCommand('mceApplyTextcolor', format, value);\n      }\n    };\n    var getColors$1 = function (colors, hasCustom) {\n      return colors.concat(getCurrentColors().concat(getAdditionalColors(hasCustom)));\n    };\n    var getFetch = function (colors, hasCustom) {\n      return function (callback) {\n        callback(getColors$1(colors, hasCustom));\n      };\n    };\n    var setIconColor = function (splitButtonApi, name, newColor) {\n      var id = name === 'forecolor' ? 'tox-icon-text-color__color' : 'tox-icon-highlight-bg-color__color';\n      splitButtonApi.setIconFill(id, newColor);\n    };\n    var registerTextColorButton = function (editor, name, format, tooltip, lastColor) {\n      editor.ui.registry.addSplitButton(name, {\n        tooltip: tooltip,\n        presets: 'color',\n        icon: name === 'forecolor' ? 'text-color' : 'highlight-bg-color',\n        select: function (value) {\n          var optCurrentRgb = Optional.from(getCurrentColor(editor, format));\n          return optCurrentRgb.bind(function (currentRgb) {\n            return fromString(currentRgb).map(function (rgba) {\n              var currentHex = fromRgba(rgba).value;\n              return contains$1(value.toLowerCase(), currentHex);\n            });\n          }).getOr(false);\n        },\n        columns: getColorCols$1(editor),\n        fetch: getFetch(getColors(editor), hasCustomColors(editor)),\n        onAction: function (_splitButtonApi) {\n          if (lastColor.get() !== null) {\n            applyColor(editor, format, lastColor.get(), noop);\n          }\n        },\n        onItemAction: function (_splitButtonApi, value) {\n          applyColor(editor, format, value, function (newColor) {\n            lastColor.set(newColor);\n            fireTextColorChange(editor, {\n              name: name,\n              color: newColor\n            });\n          });\n        },\n        onSetup: function (splitButtonApi) {\n          if (lastColor.get() !== null) {\n            setIconColor(splitButtonApi, name, lastColor.get());\n          }\n          var handler = function (e) {\n            if (e.name === name) {\n              setIconColor(splitButtonApi, e.name, e.color);\n            }\n          };\n          editor.on('TextColorChange', handler);\n          return function () {\n            editor.off('TextColorChange', handler);\n          };\n        }\n      });\n    };\n    var registerTextColorMenuItem = function (editor, name, format, text) {\n      editor.ui.registry.addNestedMenuItem(name, {\n        text: text,\n        icon: name === 'forecolor' ? 'text-color' : 'highlight-bg-color',\n        getSubmenuItems: function () {\n          return [{\n              type: 'fancymenuitem',\n              fancytype: 'colorswatch',\n              onAction: function (data) {\n                applyColor(editor, format, data.value, noop);\n              }\n            }];\n        }\n      });\n    };\n    var colorPickerDialog = function (editor) {\n      return function (callback, value) {\n        var isValid = false;\n        var onSubmit = function (api) {\n          var data = api.getData();\n          var hex = data.colorpicker;\n          if (isValid) {\n            callback(Optional.from(hex));\n            api.close();\n          } else {\n            editor.windowManager.alert(editor.translate([\n              'Invalid hex color code: {0}',\n              hex\n            ]));\n          }\n        };\n        var onAction = function (_api, details) {\n          if (details.name === 'hex-valid') {\n            isValid = details.value;\n          }\n        };\n        var initialData = { colorpicker: value };\n        editor.windowManager.open({\n          title: 'Color Picker',\n          size: 'normal',\n          body: {\n            type: 'panel',\n            items: [{\n                type: 'colorpicker',\n                name: 'colorpicker',\n                label: 'Color'\n              }]\n          },\n          buttons: [\n            {\n              type: 'cancel',\n              name: 'cancel',\n              text: 'Cancel'\n            },\n            {\n              type: 'submit',\n              name: 'save',\n              text: 'Save',\n              primary: true\n            }\n          ],\n          initialData: initialData,\n          onAction: onAction,\n          onSubmit: onSubmit,\n          onClose: noop,\n          onCancel: function () {\n            callback(Optional.none());\n          }\n        });\n      };\n    };\n    var register$1 = function (editor) {\n      registerCommands(editor);\n      var lastForeColor = Cell(null);\n      var lastBackColor = Cell(null);\n      registerTextColorButton(editor, 'forecolor', 'forecolor', 'Text color', lastForeColor);\n      registerTextColorButton(editor, 'backcolor', 'hilitecolor', 'Background color', lastBackColor);\n      registerTextColorMenuItem(editor, 'forecolor', 'forecolor', 'Text color');\n      registerTextColorMenuItem(editor, 'backcolor', 'hilitecolor', 'Background color');\n    };\n\n    var createPartialChoiceMenu = function (value, items, onItemValueHandler, columns, presets, itemResponse, select, providersBackstage) {\n      var hasIcons = menuHasIcons(items);\n      var presetItemTypes = presets !== 'color' ? 'normal' : 'color';\n      var alloyItems = createChoiceItems(items, onItemValueHandler, columns, presetItemTypes, itemResponse, select, providersBackstage);\n      return createPartialMenuWithAlloyItems(value, hasIcons, alloyItems, columns, presets);\n    };\n    var createChoiceItems = function (items, onItemValueHandler, columns, itemPresets, itemResponse, select, providersBackstage) {\n      return cat(map(items, function (item) {\n        if (item.type === 'choiceitem') {\n          return createChoiceMenuItem(item).fold(handleError, function (d) {\n            return Optional.some(renderChoiceItem(d, columns === 1, itemPresets, onItemValueHandler, select(item.value), itemResponse, providersBackstage, menuHasIcons(items)));\n          });\n        } else {\n          return Optional.none();\n        }\n      }));\n    };\n\n    var deriveMenuMovement = function (columns, presets) {\n      var menuMarkers = markers$1(presets);\n      if (columns === 1) {\n        return {\n          mode: 'menu',\n          moveOnTab: true\n        };\n      } else if (columns === 'auto') {\n        return {\n          mode: 'grid',\n          selector: '.' + menuMarkers.item,\n          initSize: {\n            numColumns: 1,\n            numRows: 1\n          }\n        };\n      } else {\n        var rowClass = presets === 'color' ? 'tox-swatches__row' : 'tox-collection__group';\n        return {\n          mode: 'matrix',\n          rowSelector: '.' + rowClass\n        };\n      }\n    };\n    var deriveCollectionMovement = function (columns, presets) {\n      if (columns === 1) {\n        return {\n          mode: 'menu',\n          moveOnTab: false,\n          selector: '.tox-collection__item'\n        };\n      } else if (columns === 'auto') {\n        return {\n          mode: 'flatgrid',\n          selector: '.' + 'tox-collection__item',\n          initSize: {\n            numColumns: 1,\n            numRows: 1\n          }\n        };\n      } else {\n        return {\n          mode: 'matrix',\n          selectors: {\n            row: presets === 'color' ? '.tox-swatches__row' : '.tox-collection__group',\n            cell: presets === 'color' ? '.' + colorClass : '.' + selectableClass\n          }\n        };\n      }\n    };\n\n    var renderColorSwatchItem = function (spec, backstage) {\n      var items = getColors$1(backstage.colorinput.getColors(), backstage.colorinput.hasCustomColors());\n      var columns = backstage.colorinput.getColorCols();\n      var presets = 'color';\n      var menuSpec = createPartialChoiceMenu(generate$1('menu-value'), items, function (value) {\n        spec.onAction({ value: value });\n      }, columns, presets, ItemResponse$1.CLOSE_ON_EXECUTE, never, backstage.shared.providers);\n      var widgetSpec = __assign(__assign({}, menuSpec), {\n        markers: markers$1(presets),\n        movement: deriveMenuMovement(columns, presets)\n      });\n      return {\n        type: 'widget',\n        data: { value: generate$1('widget-id') },\n        dom: {\n          tag: 'div',\n          classes: ['tox-fancymenuitem']\n        },\n        autofocus: true,\n        components: [parts$2.widget(Menu.sketch(widgetSpec))]\n      };\n    };\n\n    var cellOverEvent = generate$1('cell-over');\n    var cellExecuteEvent = generate$1('cell-execute');\n    var makeCell = function (row, col, labelId) {\n      var _a;\n      var emitCellOver = function (c) {\n        return emitWith(c, cellOverEvent, {\n          row: row,\n          col: col\n        });\n      };\n      var emitExecute = function (c) {\n        return emitWith(c, cellExecuteEvent, {\n          row: row,\n          col: col\n        });\n      };\n      var onClick = function (c, se) {\n        se.stop();\n        emitExecute(c);\n      };\n      return build$1({\n        dom: {\n          tag: 'div',\n          attributes: (_a = { role: 'button' }, _a['aria-labelledby'] = labelId, _a)\n        },\n        behaviours: derive$1([\n          config('insert-table-picker-cell', [\n            run(mouseover(), Focusing.focus),\n            run(execute(), emitExecute),\n            run(click(), onClick),\n            run(tap(), onClick)\n          ]),\n          Toggling.config({\n            toggleClass: 'tox-insert-table-picker__selected',\n            toggleOnExecute: false\n          }),\n          Focusing.config({ onFocus: emitCellOver })\n        ])\n      });\n    };\n    var makeCells = function (labelId, numRows, numCols) {\n      var cells = [];\n      for (var i = 0; i < numRows; i++) {\n        var row = [];\n        for (var j = 0; j < numCols; j++) {\n          row.push(makeCell(i, j, labelId));\n        }\n        cells.push(row);\n      }\n      return cells;\n    };\n    var selectCells = function (cells, selectedRow, selectedColumn, numRows, numColumns) {\n      for (var i = 0; i < numRows; i++) {\n        for (var j = 0; j < numColumns; j++) {\n          Toggling.set(cells[i][j], i <= selectedRow && j <= selectedColumn);\n        }\n      }\n    };\n    var makeComponents = function (cells) {\n      return bind(cells, function (cellRow) {\n        return map(cellRow, premade$1);\n      });\n    };\n    var makeLabelText = function (row, col) {\n      return text(col + 1 + 'x' + (row + 1));\n    };\n    var renderInsertTableMenuItem = function (spec) {\n      var numRows = 10;\n      var numColumns = 10;\n      var sizeLabelId = generate$1('size-label');\n      var cells = makeCells(sizeLabelId, numRows, numColumns);\n      var memLabel = record({\n        dom: {\n          tag: 'span',\n          classes: ['tox-insert-table-picker__label'],\n          attributes: { id: sizeLabelId }\n        },\n        components: [text('0x0')],\n        behaviours: derive$1([Replacing.config({})])\n      });\n      return {\n        type: 'widget',\n        data: { value: generate$1('widget-id') },\n        dom: {\n          tag: 'div',\n          classes: ['tox-fancymenuitem']\n        },\n        autofocus: true,\n        components: [parts$2.widget({\n            dom: {\n              tag: 'div',\n              classes: ['tox-insert-table-picker']\n            },\n            components: makeComponents(cells).concat(memLabel.asSpec()),\n            behaviours: derive$1([\n              config('insert-table-picker', [\n                runWithTarget(cellOverEvent, function (c, t, e) {\n                  var row = e.event.row;\n                  var col = e.event.col;\n                  selectCells(cells, row, col, numRows, numColumns);\n                  Replacing.set(memLabel.get(c), [makeLabelText(row, col)]);\n                }),\n                runWithTarget(cellExecuteEvent, function (c, _, e) {\n                  spec.onAction({\n                    numRows: e.event.row + 1,\n                    numColumns: e.event.col + 1\n                  });\n                  emit(c, sandboxClose());\n                })\n              ]),\n              Keying.config({\n                initSize: {\n                  numRows: numRows,\n                  numColumns: numColumns\n                },\n                mode: 'flatgrid',\n                selector: '[role=\"button\"]'\n              })\n            ])\n          })]\n      };\n    };\n\n    var fancyMenuItems = {\n      inserttable: renderInsertTableMenuItem,\n      colorswatch: renderColorSwatchItem\n    };\n    var valueOpt = function (obj, key) {\n      return Object.prototype.hasOwnProperty.call(obj, key) ? Optional.some(obj[key]) : Optional.none();\n    };\n    var renderFancyMenuItem = function (spec, backstage) {\n      return valueOpt(fancyMenuItems, spec.fancytype).map(function (render) {\n        return render(spec, backstage);\n      });\n    };\n\n    var renderNestedItem = function (spec, itemResponse, providersBackstage, renderIcons, downwardsCaret) {\n      if (renderIcons === void 0) {\n        renderIcons = true;\n      }\n      if (downwardsCaret === void 0) {\n        downwardsCaret = false;\n      }\n      var caret = downwardsCaret ? renderDownwardsCaret(providersBackstage.icons) : renderSubmenuCaret(providersBackstage.icons);\n      var getApi = function (component) {\n        return {\n          isDisabled: function () {\n            return Disabling.isDisabled(component);\n          },\n          setDisabled: function (state) {\n            return Disabling.set(component, state);\n          }\n        };\n      };\n      var structure = renderItemStructure({\n        presets: 'normal',\n        iconContent: spec.icon,\n        textContent: spec.text,\n        htmlContent: Optional.none(),\n        ariaLabel: spec.text,\n        caret: Optional.some(caret),\n        checkMark: Optional.none(),\n        shortcutContent: spec.shortcut\n      }, providersBackstage, renderIcons);\n      return renderCommonItem({\n        data: buildData(spec),\n        getApi: getApi,\n        disabled: spec.disabled,\n        onAction: noop,\n        onSetup: spec.onSetup,\n        triggersSubmenu: true,\n        itemBehaviours: []\n      }, structure, itemResponse, providersBackstage);\n    };\n\n    var renderNormalItem = function (spec, itemResponse, providersBackstage, renderIcons) {\n      if (renderIcons === void 0) {\n        renderIcons = true;\n      }\n      var getApi = function (component) {\n        return {\n          isDisabled: function () {\n            return Disabling.isDisabled(component);\n          },\n          setDisabled: function (state) {\n            return Disabling.set(component, state);\n          }\n        };\n      };\n      var structure = renderItemStructure({\n        presets: 'normal',\n        iconContent: spec.icon,\n        textContent: spec.text,\n        htmlContent: Optional.none(),\n        ariaLabel: spec.text,\n        caret: Optional.none(),\n        checkMark: Optional.none(),\n        shortcutContent: spec.shortcut\n      }, providersBackstage, renderIcons);\n      return renderCommonItem({\n        data: buildData(spec),\n        getApi: getApi,\n        disabled: spec.disabled,\n        onAction: spec.onAction,\n        onSetup: spec.onSetup,\n        triggersSubmenu: false,\n        itemBehaviours: []\n      }, structure, itemResponse, providersBackstage);\n    };\n\n    var renderSeparatorItem = function (spec) {\n      var innerHtml = spec.text.fold(function () {\n        return {};\n      }, function (text) {\n        return { innerHtml: text };\n      });\n      return {\n        type: 'separator',\n        dom: __assign({\n          tag: 'div',\n          classes: [\n            selectableClass,\n            groupHeadingClass\n          ]\n        }, innerHtml),\n        components: []\n      };\n    };\n\n    var renderToggleMenuItem = function (spec, itemResponse, providersBackstage, renderIcons) {\n      if (renderIcons === void 0) {\n        renderIcons = true;\n      }\n      var getApi = function (component) {\n        return {\n          setActive: function (state) {\n            Toggling.set(component, state);\n          },\n          isActive: function () {\n            return Toggling.isOn(component);\n          },\n          isDisabled: function () {\n            return Disabling.isDisabled(component);\n          },\n          setDisabled: function (state) {\n            return Disabling.set(component, state);\n          }\n        };\n      };\n      var structure = renderItemStructure({\n        iconContent: spec.icon,\n        textContent: spec.text,\n        htmlContent: Optional.none(),\n        ariaLabel: spec.text,\n        checkMark: Optional.some(renderCheckmark(providersBackstage.icons)),\n        caret: Optional.none(),\n        shortcutContent: spec.shortcut,\n        presets: 'normal',\n        meta: spec.meta\n      }, providersBackstage, renderIcons);\n      return deepMerge(renderCommonItem({\n        data: buildData(spec),\n        disabled: spec.disabled,\n        getApi: getApi,\n        onAction: spec.onAction,\n        onSetup: spec.onSetup,\n        triggersSubmenu: false,\n        itemBehaviours: []\n      }, structure, itemResponse, providersBackstage), {\n        toggling: {\n          toggleClass: tickedClass,\n          toggleOnExecute: false,\n          selected: spec.active\n        }\n      });\n    };\n\n    var autocomplete = renderAutocompleteItem;\n    var separator = renderSeparatorItem;\n    var normal = renderNormalItem;\n    var nested = renderNestedItem;\n    var toggle$1 = renderToggleMenuItem;\n    var fancy = renderFancyMenuItem;\n    var card = renderCardMenuItem;\n\n    var FocusMode;\n    (function (FocusMode) {\n      FocusMode[FocusMode['ContentFocus'] = 0] = 'ContentFocus';\n      FocusMode[FocusMode['UiFocus'] = 1] = 'UiFocus';\n    }(FocusMode || (FocusMode = {})));\n    var createMenuItemFromBridge = function (item, itemResponse, backstage, menuHasIcons, isHorizontalMenu) {\n      var providersBackstage = backstage.shared.providers;\n      var parseForHorizontalMenu = function (menuitem) {\n        return !isHorizontalMenu ? menuitem : __assign(__assign({}, menuitem), {\n          shortcut: Optional.none(),\n          icon: menuitem.text.isSome() ? Optional.none() : menuitem.icon\n        });\n      };\n      switch (item.type) {\n      case 'menuitem':\n        return createMenuItem(item).fold(handleError, function (d) {\n          return Optional.some(normal(parseForHorizontalMenu(d), itemResponse, providersBackstage, menuHasIcons));\n        });\n      case 'nestedmenuitem':\n        return createNestedMenuItem(item).fold(handleError, function (d) {\n          return Optional.some(nested(parseForHorizontalMenu(d), itemResponse, providersBackstage, menuHasIcons, isHorizontalMenu));\n        });\n      case 'togglemenuitem':\n        return createToggleMenuItem(item).fold(handleError, function (d) {\n          return Optional.some(toggle$1(parseForHorizontalMenu(d), itemResponse, providersBackstage, menuHasIcons));\n        });\n      case 'separator':\n        return createSeparatorMenuItem(item).fold(handleError, function (d) {\n          return Optional.some(separator(d));\n        });\n      case 'fancymenuitem':\n        return createFancyMenuItem(item).fold(handleError, function (d) {\n          return fancy(parseForHorizontalMenu(d), backstage);\n        });\n      default: {\n          console.error('Unknown item in general menu', item);\n          return Optional.none();\n        }\n      }\n    };\n    var createAutocompleteItems = function (items, matchText, onItemValueHandler, columns, itemResponse, sharedBackstage, highlightOn) {\n      var renderText = columns === 1;\n      var renderIcons = !renderText || menuHasIcons(items);\n      return cat(map(items, function (item) {\n        switch (item.type) {\n        case 'separator':\n          return createSeparatorItem(item).fold(handleError, function (d) {\n            return Optional.some(separator(d));\n          });\n        case 'cardmenuitem':\n          return createCardMenuItem(item).fold(handleError, function (d) {\n            return Optional.some(card(__assign(__assign({}, d), {\n              onAction: function (api) {\n                d.onAction(api);\n                onItemValueHandler(d.value, d.meta);\n              }\n            }), itemResponse, sharedBackstage, {\n              itemBehaviours: tooltipBehaviour(d.meta, sharedBackstage),\n              cardText: {\n                matchText: matchText,\n                highlightOn: highlightOn\n              }\n            }));\n          });\n        case 'autocompleteitem':\n        default:\n          return createAutocompleterItem(item).fold(handleError, function (d) {\n            return Optional.some(autocomplete(d, matchText, renderText, 'normal', onItemValueHandler, itemResponse, sharedBackstage, renderIcons));\n          });\n        }\n      }));\n    };\n    var createPartialMenu = function (value, items, itemResponse, backstage, isHorizontalMenu) {\n      var hasIcons = menuHasIcons(items);\n      var alloyItems = cat(map(items, function (item) {\n        var itemHasIcon = function (i) {\n          return isHorizontalMenu ? !i.hasOwnProperty('text') : hasIcons;\n        };\n        var createItem = function (i) {\n          return createMenuItemFromBridge(i, itemResponse, backstage, itemHasIcon(i), isHorizontalMenu);\n        };\n        if (item.type === 'nestedmenuitem' && item.getSubmenuItems().length <= 0) {\n          return createItem(__assign(__assign({}, item), { disabled: true }));\n        } else {\n          return createItem(item);\n        }\n      }));\n      var createPartial = isHorizontalMenu ? createHorizontalPartialMenuWithAlloyItems : createPartialMenuWithAlloyItems;\n      return createPartial(value, hasIcons, alloyItems, 1, 'normal');\n    };\n    var createTieredDataFrom = function (partialMenu) {\n      return tieredMenu.singleData(partialMenu.value, partialMenu);\n    };\n    var createMenuFrom = function (partialMenu, columns, focusMode, presets) {\n      var focusManager = focusMode === FocusMode.ContentFocus ? highlights() : dom();\n      var movement = deriveMenuMovement(columns, presets);\n      var menuMarkers = markers$1(presets);\n      return {\n        dom: partialMenu.dom,\n        components: partialMenu.components,\n        items: partialMenu.items,\n        value: partialMenu.value,\n        markers: {\n          selectedItem: menuMarkers.selectedItem,\n          item: menuMarkers.item\n        },\n        movement: movement,\n        fakeFocus: focusMode === FocusMode.ContentFocus,\n        focusManager: focusManager,\n        menuBehaviours: SimpleBehaviours.unnamedEvents(columns !== 'auto' ? [] : [runOnAttached(function (comp, _se) {\n            detectSize(comp, 4, menuMarkers.item).each(function (_a) {\n              var numColumns = _a.numColumns, numRows = _a.numRows;\n              Keying.setGridSize(comp, numRows, numColumns);\n            });\n          })])\n      };\n    };\n\n    var register$2 = function (editor, sharedBackstage) {\n      var activeAutocompleter = Cell(Optional.none());\n      var processingAction = Cell(false);\n      var autocompleter = build$1(InlineView.sketch({\n        dom: {\n          tag: 'div',\n          classes: ['tox-autocompleter']\n        },\n        components: [],\n        fireDismissalEventInstead: {},\n        inlineBehaviours: derive$1([config('dismissAutocompleter', [run(dismissRequested(), function () {\n              return cancelIfNecessary();\n            })])]),\n        lazySink: sharedBackstage.getSink\n      }));\n      var isMenuOpen = function () {\n        return InlineView.isOpen(autocompleter);\n      };\n      var isActive = function () {\n        return activeAutocompleter.get().isSome();\n      };\n      var hideIfNecessary = function () {\n        if (isActive()) {\n          InlineView.hide(autocompleter);\n        }\n      };\n      var cancelIfNecessary = function () {\n        if (isActive()) {\n          var lastElement = activeAutocompleter.get().map(function (ac) {\n            return ac.element;\n          });\n          detect$4(lastElement.getOr(SugarElement.fromDom(editor.selection.getNode()))).each(unwrap);\n          hideIfNecessary();\n          activeAutocompleter.set(Optional.none());\n          processingAction.set(false);\n        }\n      };\n      var getAutocompleters = cached(function () {\n        return register(editor);\n      });\n      var getCombinedItems = function (triggerChar, matches) {\n        var columns = findMap(matches, function (m) {\n          return Optional.from(m.columns);\n        }).getOr(1);\n        return bind(matches, function (match) {\n          var choices = match.items;\n          return createAutocompleteItems(choices, match.matchText, function (itemValue, itemMeta) {\n            var nr = editor.selection.getRng();\n            getContext(editor.dom, nr, triggerChar).fold(function () {\n              return console.error('Lost context. Cursor probably moved');\n            }, function (_a) {\n              var range = _a.range;\n              var autocompleterApi = {\n                hide: function () {\n                  cancelIfNecessary();\n                },\n                reload: function (fetchOptions) {\n                  hideIfNecessary();\n                  load(fetchOptions);\n                }\n              };\n              processingAction.set(true);\n              match.onAction(autocompleterApi, range, itemValue, itemMeta);\n              processingAction.set(false);\n            });\n          }, columns, ItemResponse$1.BUBBLE_TO_SANDBOX, sharedBackstage, match.highlightOn);\n        });\n      };\n      var commenceIfNecessary = function (context) {\n        if (!isActive()) {\n          var wrapper = create$4(editor, context.range);\n          activeAutocompleter.set(Optional.some({\n            triggerChar: context.triggerChar,\n            element: wrapper,\n            matchLength: context.text.length\n          }));\n          processingAction.set(false);\n        }\n      };\n      var display = function (ac, context, lookupData, items) {\n        ac.matchLength = context.text.length;\n        var columns = findMap(lookupData, function (ld) {\n          return Optional.from(ld.columns);\n        }).getOr(1);\n        InlineView.showAt(autocompleter, {\n          anchor: 'node',\n          root: SugarElement.fromDom(editor.getBody()),\n          node: Optional.from(ac.element)\n        }, Menu.sketch(createMenuFrom(createPartialMenuWithAlloyItems('autocompleter-value', true, items, columns, 'normal'), columns, FocusMode.ContentFocus, 'normal')));\n        InlineView.getContent(autocompleter).each(Highlighting.highlightFirst);\n      };\n      var doLookup = function (fetchOptions) {\n        return activeAutocompleter.get().map(function (ac) {\n          return getContext(editor.dom, editor.selection.getRng(), ac.triggerChar).bind(function (newContext) {\n            return lookupWithContext(editor, getAutocompleters, newContext, fetchOptions);\n          });\n        }).getOrThunk(function () {\n          return lookup(editor, getAutocompleters);\n        });\n      };\n      var load = function (fetchOptions) {\n        doLookup(fetchOptions).fold(cancelIfNecessary, function (lookupInfo) {\n          commenceIfNecessary(lookupInfo.context);\n          lookupInfo.lookupData.then(function (lookupData) {\n            activeAutocompleter.get().map(function (ac) {\n              var context = lookupInfo.context;\n              if (ac.triggerChar === context.triggerChar) {\n                var combinedItems = getCombinedItems(context.triggerChar, lookupData);\n                if (combinedItems.length > 0) {\n                  display(ac, context, lookupData, combinedItems);\n                } else if (context.text.length - ac.matchLength >= 10) {\n                  cancelIfNecessary();\n                } else {\n                  hideIfNecessary();\n                }\n              }\n            });\n          });\n        });\n      };\n      var onKeypress = last$2(function (e) {\n        if (e.which === 27) {\n          return;\n        }\n        load();\n      }, 50);\n      var autocompleterUiApi = {\n        onKeypress: onKeypress,\n        cancelIfNecessary: cancelIfNecessary,\n        isMenuOpen: isMenuOpen,\n        isActive: isActive,\n        isProcessingAction: processingAction.get,\n        getView: function () {\n          return InlineView.getContent(autocompleter);\n        }\n      };\n      if (editor.hasPlugin('rtc') === false) {\n        AutocompleterEditorEvents.setup(autocompleterUiApi, editor);\n      }\n    };\n    var Autocompleter = { register: register$2 };\n\n    var filter$2 = always;\n    var bind$3 = function (element, event, handler) {\n      return bind$2(element, event, filter$2, handler);\n    };\n    var capture$1 = function (element, event, handler) {\n      return capture(element, event, filter$2, handler);\n    };\n    var fromRawEvent$1 = fromRawEvent;\n\n    var closest$4 = function (scope, selector, isRoot) {\n      return closest$3(scope, selector, isRoot).isSome();\n    };\n\n    var DelayedFunction = function (fun, delay) {\n      var ref = null;\n      var schedule = function () {\n        var args = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n          args[_i] = arguments[_i];\n        }\n        ref = setTimeout(function () {\n          fun.apply(null, args);\n          ref = null;\n        }, delay);\n      };\n      var cancel = function () {\n        if (ref !== null) {\n          clearTimeout(ref);\n          ref = null;\n        }\n      };\n      return {\n        cancel: cancel,\n        schedule: schedule\n      };\n    };\n\n    var SIGNIFICANT_MOVE = 5;\n    var LONGPRESS_DELAY = 400;\n    var getTouch = function (event) {\n      var raw = event.raw;\n      if (raw.touches === undefined || raw.touches.length !== 1) {\n        return Optional.none();\n      }\n      return Optional.some(raw.touches[0]);\n    };\n    var isFarEnough = function (touch, data) {\n      var distX = Math.abs(touch.clientX - data.x);\n      var distY = Math.abs(touch.clientY - data.y);\n      return distX > SIGNIFICANT_MOVE || distY > SIGNIFICANT_MOVE;\n    };\n    var monitor = function (settings) {\n      var startData = Cell(Optional.none());\n      var longpressFired = Cell(false);\n      var longpress$1 = DelayedFunction(function (event) {\n        settings.triggerEvent(longpress(), event);\n        longpressFired.set(true);\n      }, LONGPRESS_DELAY);\n      var handleTouchstart = function (event) {\n        getTouch(event).each(function (touch) {\n          longpress$1.cancel();\n          var data = {\n            x: touch.clientX,\n            y: touch.clientY,\n            target: event.target\n          };\n          longpress$1.schedule(event);\n          longpressFired.set(false);\n          startData.set(Optional.some(data));\n        });\n        return Optional.none();\n      };\n      var handleTouchmove = function (event) {\n        longpress$1.cancel();\n        getTouch(event).each(function (touch) {\n          startData.get().each(function (data) {\n            if (isFarEnough(touch, data)) {\n              startData.set(Optional.none());\n            }\n          });\n        });\n        return Optional.none();\n      };\n      var handleTouchend = function (event) {\n        longpress$1.cancel();\n        var isSame = function (data) {\n          return eq$1(data.target, event.target);\n        };\n        return startData.get().filter(isSame).map(function (_data) {\n          if (longpressFired.get()) {\n            event.prevent();\n            return false;\n          } else {\n            return settings.triggerEvent(tap(), event);\n          }\n        });\n      };\n      var handlers = wrapAll$1([\n        {\n          key: touchstart(),\n          value: handleTouchstart\n        },\n        {\n          key: touchmove(),\n          value: handleTouchmove\n        },\n        {\n          key: touchend(),\n          value: handleTouchend\n        }\n      ]);\n      var fireIfReady = function (event, type) {\n        return get$1(handlers, type).bind(function (handler) {\n          return handler(event);\n        });\n      };\n      return { fireIfReady: fireIfReady };\n    };\n\n    var isDangerous = function (event) {\n      var keyEv = event.raw;\n      return keyEv.which === BACKSPACE[0] && !contains([\n        'input',\n        'textarea'\n      ], name(event.target)) && !closest$4(event.target, '[contenteditable=\"true\"]');\n    };\n    var isFirefox = function () {\n      return detect$3().browser.isFirefox();\n    };\n    var settingsSchema = objOfOnly([\n      strictFunction('triggerEvent'),\n      defaulted$1('stopBackspace', true)\n    ]);\n    var bindFocus = function (container, handler) {\n      if (isFirefox()) {\n        return capture$1(container, 'focus', handler);\n      } else {\n        return bind$3(container, 'focusin', handler);\n      }\n    };\n    var bindBlur = function (container, handler) {\n      if (isFirefox()) {\n        return capture$1(container, 'blur', handler);\n      } else {\n        return bind$3(container, 'focusout', handler);\n      }\n    };\n    var setup$1 = function (container, rawSettings) {\n      var settings = asRawOrDie('Getting GUI events settings', settingsSchema, rawSettings);\n      var pointerEvents = [\n        'touchstart',\n        'touchmove',\n        'touchend',\n        'touchcancel',\n        'gesturestart',\n        'mousedown',\n        'mouseup',\n        'mouseover',\n        'mousemove',\n        'mouseout',\n        'click'\n      ];\n      var tapEvent = monitor(settings);\n      var simpleEvents = map(pointerEvents.concat([\n        'selectstart',\n        'input',\n        'contextmenu',\n        'change',\n        'transitionend',\n        'drag',\n        'dragstart',\n        'dragend',\n        'dragenter',\n        'dragleave',\n        'dragover',\n        'drop',\n        'keyup'\n      ]), function (type) {\n        return bind$3(container, type, function (event) {\n          tapEvent.fireIfReady(event, type).each(function (tapStopped) {\n            if (tapStopped) {\n              event.kill();\n            }\n          });\n          var stopped = settings.triggerEvent(type, event);\n          if (stopped) {\n            event.kill();\n          }\n        });\n      });\n      var pasteTimeout = Cell(Optional.none());\n      var onPaste = bind$3(container, 'paste', function (event) {\n        tapEvent.fireIfReady(event, 'paste').each(function (tapStopped) {\n          if (tapStopped) {\n            event.kill();\n          }\n        });\n        var stopped = settings.triggerEvent('paste', event);\n        if (stopped) {\n          event.kill();\n        }\n        pasteTimeout.set(Optional.some(setTimeout(function () {\n          settings.triggerEvent(postPaste(), event);\n        }, 0)));\n      });\n      var onKeydown = bind$3(container, 'keydown', function (event) {\n        var stopped = settings.triggerEvent('keydown', event);\n        if (stopped) {\n          event.kill();\n        } else if (settings.stopBackspace === true && isDangerous(event)) {\n          event.prevent();\n        }\n      });\n      var onFocusIn = bindFocus(container, function (event) {\n        var stopped = settings.triggerEvent('focusin', event);\n        if (stopped) {\n          event.kill();\n        }\n      });\n      var focusoutTimeout = Cell(Optional.none());\n      var onFocusOut = bindBlur(container, function (event) {\n        var stopped = settings.triggerEvent('focusout', event);\n        if (stopped) {\n          event.kill();\n        }\n        focusoutTimeout.set(Optional.some(setTimeout(function () {\n          settings.triggerEvent(postBlur(), event);\n        }, 0)));\n      });\n      var unbind = function () {\n        each(simpleEvents, function (e) {\n          e.unbind();\n        });\n        onKeydown.unbind();\n        onFocusIn.unbind();\n        onFocusOut.unbind();\n        onPaste.unbind();\n        pasteTimeout.get().each(clearTimeout);\n        focusoutTimeout.get().each(clearTimeout);\n      };\n      return { unbind: unbind };\n    };\n\n    var derive$2 = function (rawEvent, rawTarget) {\n      var source = get$1(rawEvent, 'target').getOr(rawTarget);\n      return Cell(source);\n    };\n\n    var fromSource = function (event, source) {\n      var stopper = Cell(false);\n      var cutter = Cell(false);\n      var stop = function () {\n        stopper.set(true);\n      };\n      var cut = function () {\n        cutter.set(true);\n      };\n      return {\n        stop: stop,\n        cut: cut,\n        isStopped: stopper.get,\n        isCut: cutter.get,\n        event: event,\n        setSource: source.set,\n        getSource: source.get\n      };\n    };\n    var fromExternal = function (event) {\n      var stopper = Cell(false);\n      var stop = function () {\n        stopper.set(true);\n      };\n      return {\n        stop: stop,\n        cut: noop,\n        isStopped: stopper.get,\n        isCut: never,\n        event: event,\n        setSource: die('Cannot set source of a broadcasted event'),\n        getSource: die('Cannot get source of a broadcasted event')\n      };\n    };\n\n    var adt$b = Adt.generate([\n      { stopped: [] },\n      { resume: ['element'] },\n      { complete: [] }\n    ]);\n    var doTriggerHandler = function (lookup, eventType, rawEvent, target, source, logger) {\n      var handler = lookup(eventType, target);\n      var simulatedEvent = fromSource(rawEvent, source);\n      return handler.fold(function () {\n        logger.logEventNoHandlers(eventType, target);\n        return adt$b.complete();\n      }, function (handlerInfo) {\n        var descHandler = handlerInfo.descHandler;\n        var eventHandler = getCurried(descHandler);\n        eventHandler(simulatedEvent);\n        if (simulatedEvent.isStopped()) {\n          logger.logEventStopped(eventType, handlerInfo.element, descHandler.purpose);\n          return adt$b.stopped();\n        } else if (simulatedEvent.isCut()) {\n          logger.logEventCut(eventType, handlerInfo.element, descHandler.purpose);\n          return adt$b.complete();\n        } else {\n          return parent(handlerInfo.element).fold(function () {\n            logger.logNoParent(eventType, handlerInfo.element, descHandler.purpose);\n            return adt$b.complete();\n          }, function (parent) {\n            logger.logEventResponse(eventType, handlerInfo.element, descHandler.purpose);\n            return adt$b.resume(parent);\n          });\n        }\n      });\n    };\n    var doTriggerOnUntilStopped = function (lookup, eventType, rawEvent, rawTarget, source, logger) {\n      return doTriggerHandler(lookup, eventType, rawEvent, rawTarget, source, logger).fold(always, function (parent) {\n        return doTriggerOnUntilStopped(lookup, eventType, rawEvent, parent, source, logger);\n      }, never);\n    };\n    var triggerHandler = function (lookup, eventType, rawEvent, target, logger) {\n      var source = derive$2(rawEvent, target);\n      return doTriggerHandler(lookup, eventType, rawEvent, target, source, logger);\n    };\n    var broadcast = function (listeners, rawEvent, _logger) {\n      var simulatedEvent = fromExternal(rawEvent);\n      each(listeners, function (listener) {\n        var descHandler = listener.descHandler;\n        var handler = getCurried(descHandler);\n        handler(simulatedEvent);\n      });\n      return simulatedEvent.isStopped();\n    };\n    var triggerUntilStopped = function (lookup, eventType, rawEvent, logger) {\n      return triggerOnUntilStopped(lookup, eventType, rawEvent, rawEvent.target, logger);\n    };\n    var triggerOnUntilStopped = function (lookup, eventType, rawEvent, rawTarget, logger) {\n      var source = derive$2(rawEvent, rawTarget);\n      return doTriggerOnUntilStopped(lookup, eventType, rawEvent, rawTarget, source, logger);\n    };\n\n    var eventHandler = function (element, descHandler) {\n      return {\n        element: element,\n        descHandler: descHandler\n      };\n    };\n    var broadcastHandler = function (id, handler) {\n      return {\n        id: id,\n        descHandler: handler\n      };\n    };\n    var EventRegistry = function () {\n      var registry = {};\n      var registerId = function (extraArgs, id, events) {\n        each$1(events, function (v, k) {\n          var handlers = registry[k] !== undefined ? registry[k] : {};\n          handlers[id] = curryArgs(v, extraArgs);\n          registry[k] = handlers;\n        });\n      };\n      var findHandler = function (handlers, elem) {\n        return read$1(elem).fold(function () {\n          return Optional.none();\n        }, function (id) {\n          return handlers.bind(function (h) {\n            return get$1(h, id);\n          }).map(function (descHandler) {\n            return eventHandler(elem, descHandler);\n          });\n        });\n      };\n      var filterByType = function (type) {\n        return get$1(registry, type).map(function (handlers) {\n          return mapToArray(handlers, function (f, id) {\n            return broadcastHandler(id, f);\n          });\n        }).getOr([]);\n      };\n      var find = function (isAboveRoot, type, target) {\n        var handlers = get$1(registry, type);\n        return closest(target, function (elem) {\n          return findHandler(handlers, elem);\n        }, isAboveRoot);\n      };\n      var unregisterId = function (id) {\n        each$1(registry, function (handlersById, _eventName) {\n          if (handlersById.hasOwnProperty(id)) {\n            delete handlersById[id];\n          }\n        });\n      };\n      return {\n        registerId: registerId,\n        unregisterId: unregisterId,\n        filterByType: filterByType,\n        find: find\n      };\n    };\n\n    var Registry = function () {\n      var events = EventRegistry();\n      var components = {};\n      var readOrTag = function (component) {\n        var elem = component.element;\n        return read$1(elem).fold(function () {\n          return write('uid-', component.element);\n        }, function (uid) {\n          return uid;\n        });\n      };\n      var failOnDuplicate = function (component, tagId) {\n        var conflict = components[tagId];\n        if (conflict === component) {\n          unregister(component);\n        } else {\n          throw new Error('The tagId \"' + tagId + '\" is already used by: ' + element(conflict.element) + '\\nCannot use it for: ' + element(component.element) + '\\n' + 'The conflicting element is' + (inBody(conflict.element) ? ' ' : ' not ') + 'already in the DOM');\n        }\n      };\n      var register = function (component) {\n        var tagId = readOrTag(component);\n        if (hasNonNullableKey(components, tagId)) {\n          failOnDuplicate(component, tagId);\n        }\n        var extraArgs = [component];\n        events.registerId(extraArgs, tagId, component.events);\n        components[tagId] = component;\n      };\n      var unregister = function (component) {\n        read$1(component.element).each(function (tagId) {\n          delete components[tagId];\n          events.unregisterId(tagId);\n        });\n      };\n      var filter = function (type) {\n        return events.filterByType(type);\n      };\n      var find = function (isAboveRoot, type, target) {\n        return events.find(isAboveRoot, type, target);\n      };\n      var getById = function (id) {\n        return get$1(components, id);\n      };\n      return {\n        find: find,\n        filter: filter,\n        register: register,\n        unregister: unregister,\n        getById: getById\n      };\n    };\n\n    var factory$3 = function (detail) {\n      var _a = detail.dom, attributes = _a.attributes, domWithoutAttributes = __rest(_a, ['attributes']);\n      return {\n        uid: detail.uid,\n        dom: __assign({\n          tag: 'div',\n          attributes: __assign({ role: 'presentation' }, attributes)\n        }, domWithoutAttributes),\n        components: detail.components,\n        behaviours: get$d(detail.containerBehaviours),\n        events: detail.events,\n        domModification: detail.domModification,\n        eventOrder: detail.eventOrder\n      };\n    };\n    var Container = single$2({\n      name: 'Container',\n      factory: factory$3,\n      configFields: [\n        defaulted$1('components', []),\n        field$1('containerBehaviours', []),\n        defaulted$1('events', {}),\n        defaulted$1('domModification', {}),\n        defaulted$1('eventOrder', {})\n      ]\n    });\n\n    var takeover = function (root) {\n      var isAboveRoot = function (el) {\n        return parent(root.element).fold(always, function (parent) {\n          return eq$1(el, parent);\n        });\n      };\n      var registry = Registry();\n      var lookup = function (eventName, target) {\n        return registry.find(isAboveRoot, eventName, target);\n      };\n      var domEvents = setup$1(root.element, {\n        triggerEvent: function (eventName, event) {\n          return monitorEvent(eventName, event.target, function (logger) {\n            return triggerUntilStopped(lookup, eventName, event, logger);\n          });\n        }\n      });\n      var systemApi = {\n        debugInfo: constant('real'),\n        triggerEvent: function (eventName, target, data) {\n          monitorEvent(eventName, target, function (logger) {\n            return triggerOnUntilStopped(lookup, eventName, data, target, logger);\n          });\n        },\n        triggerFocus: function (target, originator) {\n          read$1(target).fold(function () {\n            focus$1(target);\n          }, function (_alloyId) {\n            monitorEvent(focus(), target, function (logger) {\n              triggerHandler(lookup, focus(), {\n                originator: originator,\n                kill: noop,\n                prevent: noop,\n                target: target\n              }, target, logger);\n              return false;\n            });\n          });\n        },\n        triggerEscape: function (comp, simulatedEvent) {\n          systemApi.triggerEvent('keydown', comp.element, simulatedEvent.event);\n        },\n        getByUid: function (uid) {\n          return getByUid(uid);\n        },\n        getByDom: function (elem) {\n          return getByDom(elem);\n        },\n        build: build$1,\n        addToGui: function (c) {\n          add(c);\n        },\n        removeFromGui: function (c) {\n          remove$1(c);\n        },\n        addToWorld: function (c) {\n          addToWorld(c);\n        },\n        removeFromWorld: function (c) {\n          removeFromWorld(c);\n        },\n        broadcast: function (message) {\n          broadcast$1(message);\n        },\n        broadcastOn: function (channels, message) {\n          broadcastOn(channels, message);\n        },\n        broadcastEvent: function (eventName, event) {\n          broadcastEvent(eventName, event);\n        },\n        isConnected: always\n      };\n      var addToWorld = function (component) {\n        component.connect(systemApi);\n        if (!isText(component.element)) {\n          registry.register(component);\n          each(component.components(), addToWorld);\n          systemApi.triggerEvent(systemInit(), component.element, { target: component.element });\n        }\n      };\n      var removeFromWorld = function (component) {\n        if (!isText(component.element)) {\n          each(component.components(), removeFromWorld);\n          registry.unregister(component);\n        }\n        component.disconnect();\n      };\n      var add = function (component) {\n        attach$1(root, component);\n      };\n      var remove$1 = function (component) {\n        detach(component);\n      };\n      var destroy = function () {\n        domEvents.unbind();\n        remove(root.element);\n      };\n      var broadcastData = function (data) {\n        var receivers = registry.filter(receive());\n        each(receivers, function (receiver) {\n          var descHandler = receiver.descHandler;\n          var handler = getCurried(descHandler);\n          handler(data);\n        });\n      };\n      var broadcast$1 = function (message) {\n        broadcastData({\n          universal: true,\n          data: message\n        });\n      };\n      var broadcastOn = function (channels, message) {\n        broadcastData({\n          universal: false,\n          channels: channels,\n          data: message\n        });\n      };\n      var broadcastEvent = function (eventName, event) {\n        var listeners = registry.filter(eventName);\n        return broadcast(listeners, event);\n      };\n      var getByUid = function (uid) {\n        return registry.getById(uid).fold(function () {\n          return Result.error(new Error('Could not find component with uid: \"' + uid + '\" in system.'));\n        }, Result.value);\n      };\n      var getByDom = function (elem) {\n        var uid = read$1(elem).getOr('not found');\n        return getByUid(uid);\n      };\n      addToWorld(root);\n      return {\n        root: root,\n        element: root.element,\n        destroy: destroy,\n        add: add,\n        remove: remove$1,\n        getByUid: getByUid,\n        getByDom: getByDom,\n        addToWorld: addToWorld,\n        removeFromWorld: removeFromWorld,\n        broadcast: broadcast$1,\n        broadcastOn: broadcastOn,\n        broadcastEvent: broadcastEvent\n      };\n    };\n\n    var renderBar = function (spec, backstage) {\n      return {\n        dom: {\n          tag: 'div',\n          classes: [\n            'tox-bar',\n            'tox-form__controls-h-stack'\n          ]\n        },\n        components: map(spec.items, backstage.interpreter)\n      };\n    };\n\n    var schema$e = constant([\n      defaulted$1('prefix', 'form-field'),\n      field$1('fieldBehaviours', [\n        Composing,\n        Representing\n      ])\n    ]);\n    var parts$3 = constant([\n      optional({\n        schema: [strict$1('dom')],\n        name: 'label'\n      }),\n      optional({\n        factory: {\n          sketch: function (spec) {\n            return {\n              uid: spec.uid,\n              dom: {\n                tag: 'span',\n                styles: { display: 'none' },\n                attributes: { 'aria-hidden': 'true' },\n                innerHtml: spec.text\n              }\n            };\n          }\n        },\n        schema: [strict$1('text')],\n        name: 'aria-descriptor'\n      }),\n      required({\n        factory: {\n          sketch: function (spec) {\n            var excludeFactory = exclude$1(spec, ['factory']);\n            return spec.factory.sketch(excludeFactory);\n          }\n        },\n        schema: [strict$1('factory')],\n        name: 'field'\n      })\n    ]);\n\n    var factory$4 = function (detail, components, _spec, _externals) {\n      var behaviours = augment(detail.fieldBehaviours, [\n        Composing.config({\n          find: function (container) {\n            return getPart(container, detail, 'field');\n          }\n        }),\n        Representing.config({\n          store: {\n            mode: 'manual',\n            getValue: function (field) {\n              return Composing.getCurrent(field).bind(Representing.getValue);\n            },\n            setValue: function (field, value) {\n              Composing.getCurrent(field).each(function (current) {\n                Representing.setValue(current, value);\n              });\n            }\n          }\n        })\n      ]);\n      var events = derive([runOnAttached(function (component, _simulatedEvent) {\n          var ps = getParts(component, detail, [\n            'label',\n            'field',\n            'aria-descriptor'\n          ]);\n          ps.field().each(function (field) {\n            var id = generate$1(detail.prefix);\n            ps.label().each(function (label) {\n              set$1(label.element, 'for', id);\n              set$1(field.element, 'id', id);\n            });\n            ps['aria-descriptor']().each(function (descriptor) {\n              var descriptorId = generate$1(detail.prefix);\n              set$1(descriptor.element, 'id', descriptorId);\n              set$1(field.element, 'aria-describedby', descriptorId);\n            });\n          });\n        })]);\n      var apis = {\n        getField: function (container) {\n          return getPart(container, detail, 'field');\n        },\n        getLabel: function (container) {\n          return getPart(container, detail, 'label');\n        }\n      };\n      return {\n        uid: detail.uid,\n        dom: detail.dom,\n        components: components,\n        behaviours: behaviours,\n        events: events,\n        apis: apis\n      };\n    };\n    var FormField = composite$1({\n      name: 'FormField',\n      configFields: schema$e(),\n      partFields: parts$3(),\n      factory: factory$4,\n      apis: {\n        getField: function (apis, comp) {\n          return apis.getField(comp);\n        },\n        getLabel: function (apis, comp) {\n          return apis.getLabel(comp);\n        }\n      }\n    });\n\n    var exhibit$4 = function (base, tabConfig) {\n      return nu$6({\n        attributes: wrapAll$1([{\n            key: tabConfig.tabAttr,\n            value: 'true'\n          }])\n      });\n    };\n\n    var ActiveTabstopping = /*#__PURE__*/Object.freeze({\n        __proto__: null,\n        exhibit: exhibit$4\n    });\n\n    var TabstopSchema = [defaulted$1('tabAttr', 'data-alloy-tabstop')];\n\n    var Tabstopping = create$1({\n      fields: TabstopSchema,\n      name: 'tabstopping',\n      active: ActiveTabstopping\n    });\n\n    var global$a = tinymce.util.Tools.resolve('tinymce.html.Entities');\n\n    var renderFormFieldWith = function (pLabel, pField, extraClasses, extraBehaviours) {\n      var spec = renderFormFieldSpecWith(pLabel, pField, extraClasses, extraBehaviours);\n      return FormField.sketch(spec);\n    };\n    var renderFormField = function (pLabel, pField) {\n      return renderFormFieldWith(pLabel, pField, [], []);\n    };\n    var renderFormFieldSpecWith = function (pLabel, pField, extraClasses, extraBehaviours) {\n      return {\n        dom: renderFormFieldDomWith(extraClasses),\n        components: pLabel.toArray().concat([pField]),\n        fieldBehaviours: derive$1(extraBehaviours)\n      };\n    };\n    var renderFormFieldDom = function () {\n      return renderFormFieldDomWith([]);\n    };\n    var renderFormFieldDomWith = function (extraClasses) {\n      return {\n        tag: 'div',\n        classes: ['tox-form__group'].concat(extraClasses)\n      };\n    };\n    var renderLabel = function (label, providersBackstage) {\n      return FormField.parts.label({\n        dom: {\n          tag: 'label',\n          classes: ['tox-label'],\n          innerHtml: providersBackstage.translate(label)\n        }\n      });\n    };\n\n    var formChangeEvent = generate$1('form-component-change');\n    var formCloseEvent = generate$1('form-close');\n    var formCancelEvent = generate$1('form-cancel');\n    var formActionEvent = generate$1('form-action');\n    var formSubmitEvent = generate$1('form-submit');\n    var formBlockEvent = generate$1('form-block');\n    var formUnblockEvent = generate$1('form-unblock');\n    var formTabChangeEvent = generate$1('form-tabchange');\n    var formResizeEvent = generate$1('form-resize');\n\n    var renderCollection = function (spec, providersBackstage) {\n      var _a;\n      var pLabel = spec.label.map(function (label) {\n        return renderLabel(label, providersBackstage);\n      });\n      var runOnItem = function (f) {\n        return function (comp, se) {\n          closest$3(se.event.target, '[data-collection-item-value]').each(function (target) {\n            f(comp, se, target, get$3(target, 'data-collection-item-value'));\n          });\n        };\n      };\n      var setContents = function (comp, items) {\n        var htmlLines = map(items, function (item) {\n          var itemText = global$6.translate(item.text);\n          var textContent = spec.columns === 1 ? '<div class=\"tox-collection__item-label\">' + itemText + '</div>' : '';\n          var iconContent = '<div class=\"tox-collection__item-icon\">' + item.icon + '</div>';\n          var mapItemName = {\n            '_': ' ',\n            ' - ': ' ',\n            '-': ' '\n          };\n          var ariaLabel = itemText.replace(/\\_| \\- |\\-/g, function (match) {\n            return mapItemName[match];\n          });\n          var disabledClass = providersBackstage.isDisabled() ? ' tox-collection__item--state-disabled' : '';\n          return '<div class=\"tox-collection__item' + disabledClass + '\" tabindex=\"-1\" data-collection-item-value=\"' + global$a.encodeAllRaw(item.value) + '\" title=\"' + ariaLabel + '\" aria-label=\"' + ariaLabel + '\">' + iconContent + textContent + '</div>';\n        });\n        var chunks = spec.columns !== 'auto' && spec.columns > 1 ? chunk(htmlLines, spec.columns) : [htmlLines];\n        var html = map(chunks, function (ch) {\n          return '<div class=\"tox-collection__group\">' + ch.join('') + '</div>';\n        });\n        set(comp.element, html.join(''));\n      };\n      var onClick = runOnItem(function (comp, se, tgt, itemValue) {\n        se.stop();\n        if (!providersBackstage.isDisabled()) {\n          emitWith(comp, formActionEvent, {\n            name: spec.name,\n            value: itemValue\n          });\n        }\n      });\n      var collectionEvents = [\n        run(mouseover(), runOnItem(function (comp, se, tgt) {\n          focus$1(tgt);\n        })),\n        run(click(), onClick),\n        run(tap(), onClick),\n        run(focusin(), runOnItem(function (comp, se, tgt) {\n          descendant$1(comp.element, '.' + activeClass).each(function (currentActive) {\n            remove$4(currentActive, activeClass);\n          });\n          add$2(tgt, activeClass);\n        })),\n        run(focusout(), runOnItem(function (comp) {\n          descendant$1(comp.element, '.' + activeClass).each(function (currentActive) {\n            remove$4(currentActive, activeClass);\n          });\n        })),\n        runOnExecute(runOnItem(function (comp, se, tgt, itemValue) {\n          emitWith(comp, formActionEvent, {\n            name: spec.name,\n            value: itemValue\n          });\n        }))\n      ];\n      var iterCollectionItems = function (comp, applyAttributes) {\n        return map(descendants(comp.element, '.tox-collection__item'), applyAttributes);\n      };\n      var pField = FormField.parts.field({\n        dom: {\n          tag: 'div',\n          classes: ['tox-collection'].concat(spec.columns !== 1 ? ['tox-collection--grid'] : ['tox-collection--list'])\n        },\n        components: [],\n        factory: { sketch: identity },\n        behaviours: derive$1([\n          Disabling.config({\n            disabled: providersBackstage.isDisabled,\n            onDisabled: function (comp) {\n              iterCollectionItems(comp, function (childElm) {\n                add$2(childElm, 'tox-collection__item--state-disabled');\n                set$1(childElm, 'aria-disabled', true);\n              });\n            },\n            onEnabled: function (comp) {\n              iterCollectionItems(comp, function (childElm) {\n                remove$4(childElm, 'tox-collection__item--state-disabled');\n                remove$1(childElm, 'aria-disabled');\n              });\n            }\n          }),\n          receivingConfig(),\n          Replacing.config({}),\n          Representing.config({\n            store: {\n              mode: 'memory',\n              initialValue: []\n            },\n            onSetValue: function (comp, items) {\n              setContents(comp, items);\n              if (spec.columns === 'auto') {\n                detectSize(comp, 5, 'tox-collection__item').each(function (_a) {\n                  var numRows = _a.numRows, numColumns = _a.numColumns;\n                  Keying.setGridSize(comp, numRows, numColumns);\n                });\n              }\n              emit(comp, formResizeEvent);\n            }\n          }),\n          Tabstopping.config({}),\n          Keying.config(deriveCollectionMovement(spec.columns, 'normal')),\n          config('collection-events', collectionEvents)\n        ]),\n        eventOrder: (_a = {}, _a[execute()] = [\n          'disabling',\n          'alloy.base.behaviour',\n          'collection-events'\n        ], _a)\n      });\n      var extraClasses = ['tox-form__group--collection'];\n      return renderFormFieldWith(pLabel, pField, extraClasses, []);\n    };\n\n    var schema$f = constant([\n      option('data'),\n      defaulted$1('inputAttributes', {}),\n      defaulted$1('inputStyles', {}),\n      defaulted$1('tag', 'input'),\n      defaulted$1('inputClasses', []),\n      onHandler('onSetValue'),\n      defaulted$1('styles', {}),\n      defaulted$1('eventOrder', {}),\n      field$1('inputBehaviours', [\n        Representing,\n        Focusing\n      ]),\n      defaulted$1('selectOnFocus', true)\n    ]);\n    var focusBehaviours = function (detail) {\n      return derive$1([Focusing.config({\n          onFocus: !detail.selectOnFocus ? noop : function (component) {\n            var input = component.element;\n            var value = get$6(input);\n            input.dom.setSelectionRange(0, value.length);\n          }\n        })]);\n    };\n    var behaviours = function (detail) {\n      return __assign(__assign({}, focusBehaviours(detail)), augment(detail.inputBehaviours, [Representing.config({\n          store: __assign(__assign({ mode: 'manual' }, detail.data.map(function (data) {\n            return { initialValue: data };\n          }).getOr({})), {\n            getValue: function (input) {\n              return get$6(input.element);\n            },\n            setValue: function (input, data) {\n              var current = get$6(input.element);\n              if (current !== data) {\n                set$3(input.element, data);\n              }\n            }\n          }),\n          onSetValue: detail.onSetValue\n        })]));\n    };\n    var dom$2 = function (detail) {\n      return {\n        tag: detail.tag,\n        attributes: __assign({ type: 'text' }, detail.inputAttributes),\n        styles: detail.inputStyles,\n        classes: detail.inputClasses\n      };\n    };\n\n    var factory$5 = function (detail, _spec) {\n      return {\n        uid: detail.uid,\n        dom: dom$2(detail),\n        components: [],\n        behaviours: behaviours(detail),\n        eventOrder: detail.eventOrder\n      };\n    };\n    var Input = single$2({\n      name: 'Input',\n      configFields: schema$f(),\n      factory: factory$5\n    });\n\n    var exports$1 = {}, module = { exports: exports$1 };\n    (function (define, exports, module, require) {\n      (function (f) {\n        if (typeof exports === 'object' && typeof module !== 'undefined') {\n          module.exports = f();\n        } else if (typeof define === 'function' && define.amd) {\n          define([], f);\n        } else {\n          var g;\n          if (typeof window !== 'undefined') {\n            g = window;\n          } else if (typeof global !== 'undefined') {\n            g = global;\n          } else if (typeof self !== 'undefined') {\n            g = self;\n          } else {\n            g = this;\n          }\n          g.EphoxContactWrapper = f();\n        }\n      }(function () {\n        return function () {\n          function r(e, n, t) {\n            function o(i, f) {\n              if (!n[i]) {\n                if (!e[i]) {\n                  var c = 'function' == typeof require && require;\n                  if (!f && c)\n                    return c(i, !0);\n                  if (u)\n                    return u(i, !0);\n                  var a = new Error('Cannot find module \\'' + i + '\\'');\n                  throw a.code = 'MODULE_NOT_FOUND', a;\n                }\n                var p = n[i] = { exports: {} };\n                e[i][0].call(p.exports, function (r) {\n                  var n = e[i][1][r];\n                  return o(n || r);\n                }, p, p.exports, r, e, n, t);\n              }\n              return n[i].exports;\n            }\n            for (var u = 'function' == typeof require && require, i = 0; i < t.length; i++)\n              o(t[i]);\n            return o;\n          }\n          return r;\n        }()({\n          1: [\n            function (require, module, exports) {\n              var process = module.exports = {};\n              var cachedSetTimeout;\n              var cachedClearTimeout;\n              function defaultSetTimout() {\n                throw new Error('setTimeout has not been defined');\n              }\n              function defaultClearTimeout() {\n                throw new Error('clearTimeout has not been defined');\n              }\n              (function () {\n                try {\n                  if (typeof setTimeout === 'function') {\n                    cachedSetTimeout = setTimeout;\n                  } else {\n                    cachedSetTimeout = defaultSetTimout;\n                  }\n                } catch (e) {\n                  cachedSetTimeout = defaultSetTimout;\n                }\n                try {\n                  if (typeof clearTimeout === 'function') {\n                    cachedClearTimeout = clearTimeout;\n                  } else {\n                    cachedClearTimeout = defaultClearTimeout;\n                  }\n                } catch (e) {\n                  cachedClearTimeout = defaultClearTimeout;\n                }\n              }());\n              function runTimeout(fun) {\n                if (cachedSetTimeout === setTimeout) {\n                  return setTimeout(fun, 0);\n                }\n                if ((cachedSetTimeout === defaultSetTimout || !cachedSetTimeout) && setTimeout) {\n                  cachedSetTimeout = setTimeout;\n                  return setTimeout(fun, 0);\n                }\n                try {\n                  return cachedSetTimeout(fun, 0);\n                } catch (e) {\n                  try {\n                    return cachedSetTimeout.call(null, fun, 0);\n                  } catch (e) {\n                    return cachedSetTimeout.call(this, fun, 0);\n                  }\n                }\n              }\n              function runClearTimeout(marker) {\n                if (cachedClearTimeout === clearTimeout) {\n                  return clearTimeout(marker);\n                }\n                if ((cachedClearTimeout === defaultClearTimeout || !cachedClearTimeout) && clearTimeout) {\n                  cachedClearTimeout = clearTimeout;\n                  return clearTimeout(marker);\n                }\n                try {\n                  return cachedClearTimeout(marker);\n                } catch (e) {\n                  try {\n                    return cachedClearTimeout.call(null, marker);\n                  } catch (e) {\n                    return cachedClearTimeout.call(this, marker);\n                  }\n                }\n              }\n              var queue = [];\n              var draining = false;\n              var currentQueue;\n              var queueIndex = -1;\n              function cleanUpNextTick() {\n                if (!draining || !currentQueue) {\n                  return;\n                }\n                draining = false;\n                if (currentQueue.length) {\n                  queue = currentQueue.concat(queue);\n                } else {\n                  queueIndex = -1;\n                }\n                if (queue.length) {\n                  drainQueue();\n                }\n              }\n              function drainQueue() {\n                if (draining) {\n                  return;\n                }\n                var timeout = runTimeout(cleanUpNextTick);\n                draining = true;\n                var len = queue.length;\n                while (len) {\n                  currentQueue = queue;\n                  queue = [];\n                  while (++queueIndex < len) {\n                    if (currentQueue) {\n                      currentQueue[queueIndex].run();\n                    }\n                  }\n                  queueIndex = -1;\n                  len = queue.length;\n                }\n                currentQueue = null;\n                draining = false;\n                runClearTimeout(timeout);\n              }\n              process.nextTick = function (fun) {\n                var args = new Array(arguments.length - 1);\n                if (arguments.length > 1) {\n                  for (var i = 1; i < arguments.length; i++) {\n                    args[i - 1] = arguments[i];\n                  }\n                }\n                queue.push(new Item(fun, args));\n                if (queue.length === 1 && !draining) {\n                  runTimeout(drainQueue);\n                }\n              };\n              function Item(fun, array) {\n                this.fun = fun;\n                this.array = array;\n              }\n              Item.prototype.run = function () {\n                this.fun.apply(null, this.array);\n              };\n              process.title = 'browser';\n              process.browser = true;\n              process.env = {};\n              process.argv = [];\n              process.version = '';\n              process.versions = {};\n              function noop() {\n              }\n              process.on = noop;\n              process.addListener = noop;\n              process.once = noop;\n              process.off = noop;\n              process.removeListener = noop;\n              process.removeAllListeners = noop;\n              process.emit = noop;\n              process.prependListener = noop;\n              process.prependOnceListener = noop;\n              process.listeners = function (name) {\n                return [];\n              };\n              process.binding = function (name) {\n                throw new Error('process.binding is not supported');\n              };\n              process.cwd = function () {\n                return '/';\n              };\n              process.chdir = function (dir) {\n                throw new Error('process.chdir is not supported');\n              };\n              process.umask = function () {\n                return 0;\n              };\n            },\n            {}\n          ],\n          2: [\n            function (require, module, exports) {\n              (function (setImmediate) {\n                (function (root) {\n                  var setTimeoutFunc = setTimeout;\n                  function noop() {\n                  }\n                  function bind(fn, thisArg) {\n                    return function () {\n                      fn.apply(thisArg, arguments);\n                    };\n                  }\n                  function Promise(fn) {\n                    if (typeof this !== 'object')\n                      throw new TypeError('Promises must be constructed via new');\n                    if (typeof fn !== 'function')\n                      throw new TypeError('not a function');\n                    this._state = 0;\n                    this._handled = false;\n                    this._value = undefined;\n                    this._deferreds = [];\n                    doResolve(fn, this);\n                  }\n                  function handle(self, deferred) {\n                    while (self._state === 3) {\n                      self = self._value;\n                    }\n                    if (self._state === 0) {\n                      self._deferreds.push(deferred);\n                      return;\n                    }\n                    self._handled = true;\n                    Promise._immediateFn(function () {\n                      var cb = self._state === 1 ? deferred.onFulfilled : deferred.onRejected;\n                      if (cb === null) {\n                        (self._state === 1 ? resolve : reject)(deferred.promise, self._value);\n                        return;\n                      }\n                      var ret;\n                      try {\n                        ret = cb(self._value);\n                      } catch (e) {\n                        reject(deferred.promise, e);\n                        return;\n                      }\n                      resolve(deferred.promise, ret);\n                    });\n                  }\n                  function resolve(self, newValue) {\n                    try {\n                      if (newValue === self)\n                        throw new TypeError('A promise cannot be resolved with itself.');\n                      if (newValue && (typeof newValue === 'object' || typeof newValue === 'function')) {\n                        var then = newValue.then;\n                        if (newValue instanceof Promise) {\n                          self._state = 3;\n                          self._value = newValue;\n                          finale(self);\n                          return;\n                        } else if (typeof then === 'function') {\n                          doResolve(bind(then, newValue), self);\n                          return;\n                        }\n                      }\n                      self._state = 1;\n                      self._value = newValue;\n                      finale(self);\n                    } catch (e) {\n                      reject(self, e);\n                    }\n                  }\n                  function reject(self, newValue) {\n                    self._state = 2;\n                    self._value = newValue;\n                    finale(self);\n                  }\n                  function finale(self) {\n                    if (self._state === 2 && self._deferreds.length === 0) {\n                      Promise._immediateFn(function () {\n                        if (!self._handled) {\n                          Promise._unhandledRejectionFn(self._value);\n                        }\n                      });\n                    }\n                    for (var i = 0, len = self._deferreds.length; i < len; i++) {\n                      handle(self, self._deferreds[i]);\n                    }\n                    self._deferreds = null;\n                  }\n                  function Handler(onFulfilled, onRejected, promise) {\n                    this.onFulfilled = typeof onFulfilled === 'function' ? onFulfilled : null;\n                    this.onRejected = typeof onRejected === 'function' ? onRejected : null;\n                    this.promise = promise;\n                  }\n                  function doResolve(fn, self) {\n                    var done = false;\n                    try {\n                      fn(function (value) {\n                        if (done)\n                          return;\n                        done = true;\n                        resolve(self, value);\n                      }, function (reason) {\n                        if (done)\n                          return;\n                        done = true;\n                        reject(self, reason);\n                      });\n                    } catch (ex) {\n                      if (done)\n                        return;\n                      done = true;\n                      reject(self, ex);\n                    }\n                  }\n                  Promise.prototype['catch'] = function (onRejected) {\n                    return this.then(null, onRejected);\n                  };\n                  Promise.prototype.then = function (onFulfilled, onRejected) {\n                    var prom = new this.constructor(noop);\n                    handle(this, new Handler(onFulfilled, onRejected, prom));\n                    return prom;\n                  };\n                  Promise.all = function (arr) {\n                    var args = Array.prototype.slice.call(arr);\n                    return new Promise(function (resolve, reject) {\n                      if (args.length === 0)\n                        return resolve([]);\n                      var remaining = args.length;\n                      function res(i, val) {\n                        try {\n                          if (val && (typeof val === 'object' || typeof val === 'function')) {\n                            var then = val.then;\n                            if (typeof then === 'function') {\n                              then.call(val, function (val) {\n                                res(i, val);\n                              }, reject);\n                              return;\n                            }\n                          }\n                          args[i] = val;\n                          if (--remaining === 0) {\n                            resolve(args);\n                          }\n                        } catch (ex) {\n                          reject(ex);\n                        }\n                      }\n                      for (var i = 0; i < args.length; i++) {\n                        res(i, args[i]);\n                      }\n                    });\n                  };\n                  Promise.resolve = function (value) {\n                    if (value && typeof value === 'object' && value.constructor === Promise) {\n                      return value;\n                    }\n                    return new Promise(function (resolve) {\n                      resolve(value);\n                    });\n                  };\n                  Promise.reject = function (value) {\n                    return new Promise(function (resolve, reject) {\n                      reject(value);\n                    });\n                  };\n                  Promise.race = function (values) {\n                    return new Promise(function (resolve, reject) {\n                      for (var i = 0, len = values.length; i < len; i++) {\n                        values[i].then(resolve, reject);\n                      }\n                    });\n                  };\n                  Promise._immediateFn = typeof setImmediate === 'function' ? function (fn) {\n                    setImmediate(fn);\n                  } : function (fn) {\n                    setTimeoutFunc(fn, 0);\n                  };\n                  Promise._unhandledRejectionFn = function _unhandledRejectionFn(err) {\n                    if (typeof console !== 'undefined' && console) {\n                      console.warn('Possible Unhandled Promise Rejection:', err);\n                    }\n                  };\n                  Promise._setImmediateFn = function _setImmediateFn(fn) {\n                    Promise._immediateFn = fn;\n                  };\n                  Promise._setUnhandledRejectionFn = function _setUnhandledRejectionFn(fn) {\n                    Promise._unhandledRejectionFn = fn;\n                  };\n                  if (typeof module !== 'undefined' && module.exports) {\n                    module.exports = Promise;\n                  } else if (!root.Promise) {\n                    root.Promise = Promise;\n                  }\n                }(this));\n              }.call(this, require('timers').setImmediate));\n            },\n            { 'timers': 3 }\n          ],\n          3: [\n            function (require, module, exports) {\n              (function (setImmediate, clearImmediate) {\n                var nextTick = require('process/browser.js').nextTick;\n                var apply = Function.prototype.apply;\n                var slice = Array.prototype.slice;\n                var immediateIds = {};\n                var nextImmediateId = 0;\n                exports.setTimeout = function () {\n                  return new Timeout(apply.call(setTimeout, window, arguments), clearTimeout);\n                };\n                exports.setInterval = function () {\n                  return new Timeout(apply.call(setInterval, window, arguments), clearInterval);\n                };\n                exports.clearTimeout = exports.clearInterval = function (timeout) {\n                  timeout.close();\n                };\n                function Timeout(id, clearFn) {\n                  this._id = id;\n                  this._clearFn = clearFn;\n                }\n                Timeout.prototype.unref = Timeout.prototype.ref = function () {\n                };\n                Timeout.prototype.close = function () {\n                  this._clearFn.call(window, this._id);\n                };\n                exports.enroll = function (item, msecs) {\n                  clearTimeout(item._idleTimeoutId);\n                  item._idleTimeout = msecs;\n                };\n                exports.unenroll = function (item) {\n                  clearTimeout(item._idleTimeoutId);\n                  item._idleTimeout = -1;\n                };\n                exports._unrefActive = exports.active = function (item) {\n                  clearTimeout(item._idleTimeoutId);\n                  var msecs = item._idleTimeout;\n                  if (msecs >= 0) {\n                    item._idleTimeoutId = setTimeout(function onTimeout() {\n                      if (item._onTimeout)\n                        item._onTimeout();\n                    }, msecs);\n                  }\n                };\n                exports.setImmediate = typeof setImmediate === 'function' ? setImmediate : function (fn) {\n                  var id = nextImmediateId++;\n                  var args = arguments.length < 2 ? false : slice.call(arguments, 1);\n                  immediateIds[id] = true;\n                  nextTick(function onNextTick() {\n                    if (immediateIds[id]) {\n                      if (args) {\n                        fn.apply(null, args);\n                      } else {\n                        fn.call(null);\n                      }\n                      exports.clearImmediate(id);\n                    }\n                  });\n                  return id;\n                };\n                exports.clearImmediate = typeof clearImmediate === 'function' ? clearImmediate : function (id) {\n                  delete immediateIds[id];\n                };\n              }.call(this, require('timers').setImmediate, require('timers').clearImmediate));\n            },\n            {\n              'process/browser.js': 1,\n              'timers': 3\n            }\n          ],\n          4: [\n            function (require, module, exports) {\n              var promisePolyfill = require('promise-polyfill');\n              var Global = function () {\n                if (typeof window !== 'undefined') {\n                  return window;\n                } else {\n                  return Function('return this;')();\n                }\n              }();\n              module.exports = { boltExport: Global.Promise || promisePolyfill };\n            },\n            { 'promise-polyfill': 2 }\n          ]\n        }, {}, [4])(4);\n      }));\n    }(undefined, exports$1, module, undefined));\n    var Promise = module.exports.boltExport;\n\n    var nu$a = function (baseFn) {\n      var data = Optional.none();\n      var callbacks = [];\n      var map = function (f) {\n        return nu$a(function (nCallback) {\n          get(function (data) {\n            nCallback(f(data));\n          });\n        });\n      };\n      var get = function (nCallback) {\n        if (isReady()) {\n          call(nCallback);\n        } else {\n          callbacks.push(nCallback);\n        }\n      };\n      var set = function (x) {\n        if (!isReady()) {\n          data = Optional.some(x);\n          run(callbacks);\n          callbacks = [];\n        }\n      };\n      var isReady = function () {\n        return data.isSome();\n      };\n      var run = function (cbs) {\n        each(cbs, call);\n      };\n      var call = function (cb) {\n        data.each(function (x) {\n          setTimeout(function () {\n            cb(x);\n          }, 0);\n        });\n      };\n      baseFn(set);\n      return {\n        get: get,\n        map: map,\n        isReady: isReady\n      };\n    };\n    var pure = function (a) {\n      return nu$a(function (callback) {\n        callback(a);\n      });\n    };\n    var LazyValue = {\n      nu: nu$a,\n      pure: pure\n    };\n\n    var errorReporter = function (err) {\n      setTimeout(function () {\n        throw err;\n      }, 0);\n    };\n    var make$3 = function (run) {\n      var get = function (callback) {\n        run().then(callback, errorReporter);\n      };\n      var map = function (fab) {\n        return make$3(function () {\n          return run().then(fab);\n        });\n      };\n      var bind = function (aFutureB) {\n        return make$3(function () {\n          return run().then(function (v) {\n            return aFutureB(v).toPromise();\n          });\n        });\n      };\n      var anonBind = function (futureB) {\n        return make$3(function () {\n          return run().then(function () {\n            return futureB.toPromise();\n          });\n        });\n      };\n      var toLazy = function () {\n        return LazyValue.nu(get);\n      };\n      var toCached = function () {\n        var cache = null;\n        return make$3(function () {\n          if (cache === null) {\n            cache = run();\n          }\n          return cache;\n        });\n      };\n      var toPromise = run;\n      return {\n        map: map,\n        bind: bind,\n        anonBind: anonBind,\n        toLazy: toLazy,\n        toCached: toCached,\n        toPromise: toPromise,\n        get: get\n      };\n    };\n    var nu$b = function (baseFn) {\n      return make$3(function () {\n        return new Promise(baseFn);\n      });\n    };\n    var pure$1 = function (a) {\n      return make$3(function () {\n        return Promise.resolve(a);\n      });\n    };\n    var Future = {\n      nu: nu$b,\n      pure: pure$1\n    };\n\n    var ariaElements = [\n      'input',\n      'textarea'\n    ];\n    var isAriaElement = function (elem) {\n      var name$1 = name(elem);\n      return contains(ariaElements, name$1);\n    };\n    var markValid = function (component, invalidConfig) {\n      var elem = invalidConfig.getRoot(component).getOr(component.element);\n      remove$4(elem, invalidConfig.invalidClass);\n      invalidConfig.notify.each(function (notifyInfo) {\n        if (isAriaElement(component.element)) {\n          set$1(component.element, 'aria-invalid', false);\n        }\n        notifyInfo.getContainer(component).each(function (container) {\n          set(container, notifyInfo.validHtml);\n        });\n        notifyInfo.onValid(component);\n      });\n    };\n    var markInvalid = function (component, invalidConfig, invalidState, text) {\n      var elem = invalidConfig.getRoot(component).getOr(component.element);\n      add$2(elem, invalidConfig.invalidClass);\n      invalidConfig.notify.each(function (notifyInfo) {\n        if (isAriaElement(component.element)) {\n          set$1(component.element, 'aria-invalid', true);\n        }\n        notifyInfo.getContainer(component).each(function (container) {\n          set(container, text);\n        });\n        notifyInfo.onInvalid(component, text);\n      });\n    };\n    var query = function (component, invalidConfig, _invalidState) {\n      return invalidConfig.validator.fold(function () {\n        return Future.pure(Result.value(true));\n      }, function (validatorInfo) {\n        return validatorInfo.validate(component);\n      });\n    };\n    var run$1 = function (component, invalidConfig, invalidState) {\n      invalidConfig.notify.each(function (notifyInfo) {\n        notifyInfo.onValidate(component);\n      });\n      return query(component, invalidConfig).map(function (valid) {\n        if (component.getSystem().isConnected()) {\n          return valid.fold(function (err) {\n            markInvalid(component, invalidConfig, invalidState, err);\n            return Result.error(err);\n          }, function (v) {\n            markValid(component, invalidConfig);\n            return Result.value(v);\n          });\n        } else {\n          return Result.error('No longer in system');\n        }\n      });\n    };\n    var isInvalid = function (component, invalidConfig) {\n      var elem = invalidConfig.getRoot(component).getOr(component.element);\n      return has$2(elem, invalidConfig.invalidClass);\n    };\n\n    var InvalidateApis = /*#__PURE__*/Object.freeze({\n        __proto__: null,\n        markValid: markValid,\n        markInvalid: markInvalid,\n        query: query,\n        run: run$1,\n        isInvalid: isInvalid\n    });\n\n    var events$a = function (invalidConfig, invalidState) {\n      return invalidConfig.validator.map(function (validatorInfo) {\n        return derive([run(validatorInfo.onEvent, function (component) {\n            run$1(component, invalidConfig, invalidState).get(identity);\n          })].concat(validatorInfo.validateOnLoad ? [runOnAttached(function (component) {\n            run$1(component, invalidConfig, invalidState).get(noop);\n          })] : []));\n      }).getOr({});\n    };\n\n    var ActiveInvalidate = /*#__PURE__*/Object.freeze({\n        __proto__: null,\n        events: events$a\n    });\n\n    var InvalidateSchema = [\n      strict$1('invalidClass'),\n      defaulted$1('getRoot', Optional.none),\n      optionObjOf('notify', [\n        defaulted$1('aria', 'alert'),\n        defaulted$1('getContainer', Optional.none),\n        defaulted$1('validHtml', ''),\n        onHandler('onValid'),\n        onHandler('onInvalid'),\n        onHandler('onValidate')\n      ]),\n      optionObjOf('validator', [\n        strict$1('validate'),\n        defaulted$1('onEvent', 'input'),\n        defaulted$1('validateOnLoad', true)\n      ])\n    ];\n\n    var Invalidating = create$1({\n      fields: InvalidateSchema,\n      name: 'invalidating',\n      active: ActiveInvalidate,\n      apis: InvalidateApis,\n      extra: {\n        validation: function (validator) {\n          return function (component) {\n            var v = Representing.getValue(component);\n            return Future.pure(validator(v));\n          };\n        }\n      }\n    });\n\n    var getCoupled = function (component, coupleConfig, coupleState, name) {\n      return coupleState.getOrCreate(component, coupleConfig, name);\n    };\n\n    var CouplingApis = /*#__PURE__*/Object.freeze({\n        __proto__: null,\n        getCoupled: getCoupled\n    });\n\n    var CouplingSchema = [strictOf('others', setOf$1(Result.value, anyValue$1()))];\n\n    var init$5 = function () {\n      var coupled = {};\n      var getOrCreate = function (component, coupleConfig, name) {\n        var available = keys(coupleConfig.others);\n        if (!available) {\n          throw new Error('Cannot find coupled component: ' + name + '. Known coupled components: ' + JSON.stringify(available, null, 2));\n        } else {\n          return get$1(coupled, name).getOrThunk(function () {\n            var builder = get$1(coupleConfig.others, name).getOrDie('No information found for coupled component: ' + name);\n            var spec = builder(component);\n            var built = component.getSystem().build(spec);\n            coupled[name] = built;\n            return built;\n          });\n        }\n      };\n      var readState = constant({});\n      return nu$5({\n        readState: readState,\n        getOrCreate: getOrCreate\n      });\n    };\n\n    var CouplingState = /*#__PURE__*/Object.freeze({\n        __proto__: null,\n        init: init$5\n    });\n\n    var Coupling = create$1({\n      fields: CouplingSchema,\n      name: 'coupling',\n      apis: CouplingApis,\n      state: CouplingState\n    });\n\n    var suffix = constant('sink');\n    var partType = constant(optional({\n      name: suffix(),\n      overrides: constant({\n        dom: { tag: 'div' },\n        behaviours: derive$1([Positioning.config({ useFixed: always })]),\n        events: derive([\n          cutter(keydown()),\n          cutter(mousedown()),\n          cutter(click())\n        ])\n      })\n    }));\n\n    var HighlightOnOpen;\n    (function (HighlightOnOpen) {\n      HighlightOnOpen[HighlightOnOpen['HighlightFirst'] = 0] = 'HighlightFirst';\n      HighlightOnOpen[HighlightOnOpen['HighlightNone'] = 1] = 'HighlightNone';\n    }(HighlightOnOpen || (HighlightOnOpen = {})));\n    var getAnchor = function (detail, component) {\n      var hotspot = detail.getHotspot(component).getOr(component);\n      var anchor = 'hotspot';\n      var overrides = detail.getAnchorOverrides();\n      return detail.layouts.fold(function () {\n        return {\n          anchor: anchor,\n          hotspot: hotspot,\n          overrides: overrides\n        };\n      }, function (layouts) {\n        return {\n          anchor: anchor,\n          hotspot: hotspot,\n          overrides: overrides,\n          layouts: layouts\n        };\n      });\n    };\n    var fetch = function (detail, mapFetch, component) {\n      var fetcher = detail.fetch;\n      return fetcher(component).map(mapFetch);\n    };\n    var openF = function (detail, mapFetch, anchor, component, sandbox, externals, highlightOnOpen) {\n      var futureData = fetch(detail, mapFetch, component);\n      var getLazySink = getSink(component, detail);\n      return futureData.map(function (tdata) {\n        return tdata.bind(function (data) {\n          return Optional.from(tieredMenu.sketch(__assign(__assign({}, externals.menu()), {\n            uid: generate$2(''),\n            data: data,\n            highlightImmediately: highlightOnOpen === HighlightOnOpen.HighlightFirst,\n            onOpenMenu: function (tmenu, menu) {\n              var sink = getLazySink().getOrDie();\n              Positioning.position(sink, anchor, menu);\n              Sandboxing.decloak(sandbox);\n            },\n            onOpenSubmenu: function (tmenu, item, submenu) {\n              var sink = getLazySink().getOrDie();\n              Positioning.position(sink, {\n                anchor: 'submenu',\n                item: item\n              }, submenu);\n              Sandboxing.decloak(sandbox);\n            },\n            onRepositionMenu: function (tmenu, primaryMenu, submenuTriggers) {\n              var sink = getLazySink().getOrDie();\n              Positioning.position(sink, anchor, primaryMenu);\n              each(submenuTriggers, function (st) {\n                Positioning.position(sink, {\n                  anchor: 'submenu',\n                  item: st.triggeringItem\n                }, st.triggeredMenu);\n              });\n            },\n            onEscape: function () {\n              Focusing.focus(component);\n              Sandboxing.close(sandbox);\n              return Optional.some(true);\n            }\n          })));\n        });\n      });\n    };\n    var open$1 = function (detail, mapFetch, hotspot, sandbox, externals, onOpenSync, highlightOnOpen) {\n      var anchor = getAnchor(detail, hotspot);\n      var processed = openF(detail, mapFetch, anchor, hotspot, sandbox, externals, highlightOnOpen);\n      return processed.map(function (tdata) {\n        tdata.fold(function () {\n          if (Sandboxing.isOpen(sandbox)) {\n            Sandboxing.close(sandbox);\n          }\n        }, function (data) {\n          Sandboxing.cloak(sandbox);\n          Sandboxing.open(sandbox, data);\n          onOpenSync(sandbox);\n        });\n        return sandbox;\n      });\n    };\n    var close$1 = function (detail, mapFetch, component, sandbox, _externals, _onOpenSync, _highlightOnOpen) {\n      Sandboxing.close(sandbox);\n      return Future.pure(sandbox);\n    };\n    var togglePopup = function (detail, mapFetch, hotspot, externals, onOpenSync, highlightOnOpen) {\n      var sandbox = Coupling.getCoupled(hotspot, 'sandbox');\n      var showing = Sandboxing.isOpen(sandbox);\n      var action = showing ? close$1 : open$1;\n      return action(detail, mapFetch, hotspot, sandbox, externals, onOpenSync, highlightOnOpen);\n    };\n    var matchWidth = function (hotspot, container, useMinWidth) {\n      var menu = Composing.getCurrent(container).getOr(container);\n      var buttonWidth = get$8(hotspot.element);\n      if (useMinWidth) {\n        set$2(menu.element, 'min-width', buttonWidth + 'px');\n      } else {\n        set$4(menu.element, buttonWidth);\n      }\n    };\n    var getSink = function (anyInSystem, sinkDetail) {\n      return anyInSystem.getSystem().getByUid(sinkDetail.uid + '-' + suffix()).map(function (internalSink) {\n        return function () {\n          return Result.value(internalSink);\n        };\n      }).getOrThunk(function () {\n        return sinkDetail.lazySink.fold(function () {\n          return function () {\n            return Result.error(new Error('No internal sink is specified, nor could an external sink be found'));\n          };\n        }, function (lazySinkFn) {\n          return function () {\n            return lazySinkFn(anyInSystem);\n          };\n        });\n      });\n    };\n    var doRepositionMenus = function (sandbox) {\n      Sandboxing.getState(sandbox).each(function (tmenu) {\n        tieredMenu.repositionMenus(tmenu);\n      });\n    };\n    var makeSandbox = function (detail, hotspot, extras) {\n      var ariaOwner = manager();\n      var onOpen = function (component, menu) {\n        var anchor = getAnchor(detail, hotspot);\n        ariaOwner.link(hotspot.element);\n        if (detail.matchWidth) {\n          matchWidth(anchor.hotspot, menu, detail.useMinWidth);\n        }\n        detail.onOpen(anchor, component, menu);\n        if (extras !== undefined && extras.onOpen !== undefined) {\n          extras.onOpen(component, menu);\n        }\n      };\n      var onClose = function (component, menu) {\n        ariaOwner.unlink(hotspot.element);\n        if (extras !== undefined && extras.onClose !== undefined) {\n          extras.onClose(component, menu);\n        }\n      };\n      var lazySink = getSink(hotspot, detail);\n      return {\n        dom: {\n          tag: 'div',\n          classes: detail.sandboxClasses,\n          attributes: {\n            id: ariaOwner.id,\n            role: 'listbox'\n          }\n        },\n        behaviours: SketchBehaviours.augment(detail.sandboxBehaviours, [\n          Representing.config({\n            store: {\n              mode: 'memory',\n              initialValue: hotspot\n            }\n          }),\n          Sandboxing.config({\n            onOpen: onOpen,\n            onClose: onClose,\n            isPartOf: function (container, data, queryElem) {\n              return isPartOf(data, queryElem) || isPartOf(hotspot, queryElem);\n            },\n            getAttachPoint: function () {\n              return lazySink().getOrDie();\n            }\n          }),\n          Composing.config({\n            find: function (sandbox) {\n              return Sandboxing.getState(sandbox).bind(function (menu) {\n                return Composing.getCurrent(menu);\n              });\n            }\n          }),\n          Receiving.config({ channels: __assign(__assign({}, receivingChannel({ isExtraPart: never })), receivingChannel$1({ doReposition: doRepositionMenus })) })\n        ])\n      };\n    };\n    var repositionMenus = function (comp) {\n      var sandbox = Coupling.getCoupled(comp, 'sandbox');\n      doRepositionMenus(sandbox);\n    };\n\n    var sandboxFields = function () {\n      return [\n        defaulted$1('sandboxClasses', []),\n        SketchBehaviours.field('sandboxBehaviours', [\n          Composing,\n          Receiving,\n          Sandboxing,\n          Representing\n        ])\n      ];\n    };\n\n    var schema$g = constant([\n      strict$1('dom'),\n      strict$1('fetch'),\n      onHandler('onOpen'),\n      onKeyboardHandler('onExecute'),\n      defaulted$1('getHotspot', Optional.some),\n      defaulted$1('getAnchorOverrides', constant({})),\n      schema$1(),\n      field$1('dropdownBehaviours', [\n        Toggling,\n        Coupling,\n        Keying,\n        Focusing\n      ]),\n      strict$1('toggleClass'),\n      defaulted$1('eventOrder', {}),\n      option('lazySink'),\n      defaulted$1('matchWidth', false),\n      defaulted$1('useMinWidth', false),\n      option('role')\n    ].concat(sandboxFields()));\n    var parts$4 = constant([\n      external$1({\n        schema: [tieredMenuMarkers()],\n        name: 'menu',\n        defaults: function (detail) {\n          return { onExecute: detail.onExecute };\n        }\n      }),\n      partType()\n    ]);\n\n    var factory$6 = function (detail, components, _spec, externals) {\n      var _a;\n      var lookupAttr = function (attr) {\n        return get$1(detail.dom, 'attributes').bind(function (attrs) {\n          return get$1(attrs, attr);\n        });\n      };\n      var switchToMenu = function (sandbox) {\n        Sandboxing.getState(sandbox).each(function (tmenu) {\n          tieredMenu.highlightPrimary(tmenu);\n        });\n      };\n      var action = function (component) {\n        var onOpenSync = switchToMenu;\n        togglePopup(detail, function (x) {\n          return x;\n        }, component, externals, onOpenSync, HighlightOnOpen.HighlightFirst).get(noop);\n      };\n      var apis = {\n        expand: function (comp) {\n          if (!Toggling.isOn(comp)) {\n            togglePopup(detail, function (x) {\n              return x;\n            }, comp, externals, noop, HighlightOnOpen.HighlightNone).get(noop);\n          }\n        },\n        open: function (comp) {\n          if (!Toggling.isOn(comp)) {\n            togglePopup(detail, function (x) {\n              return x;\n            }, comp, externals, noop, HighlightOnOpen.HighlightFirst).get(noop);\n          }\n        },\n        isOpen: Toggling.isOn,\n        close: function (comp) {\n          if (Toggling.isOn(comp)) {\n            togglePopup(detail, function (x) {\n              return x;\n            }, comp, externals, noop, HighlightOnOpen.HighlightFirst).get(noop);\n          }\n        },\n        repositionMenus: function (comp) {\n          if (Toggling.isOn(comp)) {\n            repositionMenus(comp);\n          }\n        }\n      };\n      var triggerExecute = function (comp, _se) {\n        emitExecute(comp);\n        return Optional.some(true);\n      };\n      return {\n        uid: detail.uid,\n        dom: detail.dom,\n        components: components,\n        behaviours: augment(detail.dropdownBehaviours, [\n          Toggling.config({\n            toggleClass: detail.toggleClass,\n            aria: { mode: 'expanded' }\n          }),\n          Coupling.config({\n            others: {\n              sandbox: function (hotspot) {\n                return makeSandbox(detail, hotspot, {\n                  onOpen: function () {\n                    return Toggling.on(hotspot);\n                  },\n                  onClose: function () {\n                    return Toggling.off(hotspot);\n                  }\n                });\n              }\n            }\n          }),\n          Keying.config({\n            mode: 'special',\n            onSpace: triggerExecute,\n            onEnter: triggerExecute,\n            onDown: function (comp, _se) {\n              if (Dropdown.isOpen(comp)) {\n                var sandbox = Coupling.getCoupled(comp, 'sandbox');\n                switchToMenu(sandbox);\n              } else {\n                Dropdown.open(comp);\n              }\n              return Optional.some(true);\n            },\n            onEscape: function (comp, _se) {\n              if (Dropdown.isOpen(comp)) {\n                Dropdown.close(comp);\n                return Optional.some(true);\n              } else {\n                return Optional.none();\n              }\n            }\n          }),\n          Focusing.config({})\n        ]),\n        events: events$7(Optional.some(action)),\n        eventOrder: __assign(__assign({}, detail.eventOrder), (_a = {}, _a[execute()] = [\n          'disabling',\n          'toggling',\n          'alloy.base.behaviour'\n        ], _a)),\n        apis: apis,\n        domModification: {\n          attributes: __assign(__assign({ 'aria-haspopup': 'true' }, detail.role.fold(function () {\n            return {};\n          }, function (role) {\n            return { role: role };\n          })), detail.dom.tag === 'button' ? { type: lookupAttr('type').getOr('button') } : {})\n        }\n      };\n    };\n    var Dropdown = composite$1({\n      name: 'Dropdown',\n      configFields: schema$g(),\n      partFields: parts$4(),\n      factory: factory$6,\n      apis: {\n        open: function (apis, comp) {\n          return apis.open(comp);\n        },\n        expand: function (apis, comp) {\n          return apis.expand(comp);\n        },\n        close: function (apis, comp) {\n          return apis.close(comp);\n        },\n        isOpen: function (apis, comp) {\n          return apis.isOpen(comp);\n        },\n        repositionMenus: function (apis, comp) {\n          return apis.repositionMenus(comp);\n        }\n      }\n    });\n\n    var exhibit$5 = function () {\n      return nu$6({\n        styles: {\n          '-webkit-user-select': 'none',\n          'user-select': 'none',\n          '-ms-user-select': 'none',\n          '-moz-user-select': '-moz-none'\n        },\n        attributes: { unselectable: 'on' }\n      });\n    };\n    var events$b = function () {\n      return derive([abort(selectstart(), always)]);\n    };\n\n    var ActiveUnselecting = /*#__PURE__*/Object.freeze({\n        __proto__: null,\n        events: events$b,\n        exhibit: exhibit$5\n    });\n\n    var Unselecting = create$1({\n      fields: [],\n      name: 'unselecting',\n      active: ActiveUnselecting\n    });\n\n    var renderPanelButton = function (spec, sharedBackstage) {\n      return Dropdown.sketch({\n        dom: spec.dom,\n        components: spec.components,\n        toggleClass: 'mce-active',\n        dropdownBehaviours: derive$1([\n          DisablingConfigs.button(sharedBackstage.providers.isDisabled),\n          receivingConfig(),\n          Unselecting.config({}),\n          Tabstopping.config({})\n        ]),\n        layouts: spec.layouts,\n        sandboxClasses: ['tox-dialog__popups'],\n        lazySink: sharedBackstage.getSink,\n        fetch: function (comp) {\n          return Future.nu(function (callback) {\n            return spec.fetch(callback);\n          }).map(function (items) {\n            return Optional.from(createTieredDataFrom(deepMerge(createPartialChoiceMenu(generate$1('menu-value'), items, function (value) {\n              spec.onItemAction(comp, value);\n            }, spec.columns, spec.presets, ItemResponse$1.CLOSE_ON_EXECUTE, never, sharedBackstage.providers), { movement: deriveMenuMovement(spec.columns, spec.presets) })));\n          });\n        },\n        parts: { menu: part(false, 1, spec.presets) }\n      });\n    };\n\n    var colorInputChangeEvent = generate$1('color-input-change');\n    var colorSwatchChangeEvent = generate$1('color-swatch-change');\n    var colorPickerCancelEvent = generate$1('color-picker-cancel');\n    var renderColorInput = function (spec, sharedBackstage, colorInputBackstage) {\n      var pField = FormField.parts.field({\n        factory: Input,\n        inputClasses: ['tox-textfield'],\n        onSetValue: function (c) {\n          return Invalidating.run(c).get(noop);\n        },\n        inputBehaviours: derive$1([\n          Disabling.config({ disabled: sharedBackstage.providers.isDisabled }),\n          receivingConfig(),\n          Tabstopping.config({}),\n          Invalidating.config({\n            invalidClass: 'tox-textbox-field-invalid',\n            getRoot: function (comp) {\n              return parent(comp.element);\n            },\n            notify: {\n              onValid: function (comp) {\n                var val = Representing.getValue(comp);\n                emitWith(comp, colorInputChangeEvent, { color: val });\n              }\n            },\n            validator: {\n              validateOnLoad: false,\n              validate: function (input) {\n                var inputValue = Representing.getValue(input);\n                if (inputValue.length === 0) {\n                  return Future.pure(Result.value(true));\n                } else {\n                  var span = SugarElement.fromTag('span');\n                  set$2(span, 'background-color', inputValue);\n                  var res = getRaw(span, 'background-color').fold(function () {\n                    return Result.error('blah');\n                  }, function (_) {\n                    return Result.value(inputValue);\n                  });\n                  return Future.pure(res);\n                }\n              }\n            }\n          })\n        ]),\n        selectOnFocus: false\n      });\n      var pLabel = spec.label.map(function (label) {\n        return renderLabel(label, sharedBackstage.providers);\n      });\n      var emitSwatchChange = function (colorBit, value) {\n        emitWith(colorBit, colorSwatchChangeEvent, { value: value });\n      };\n      var onItemAction = function (comp, value) {\n        memColorButton.getOpt(comp).each(function (colorBit) {\n          if (value === 'custom') {\n            colorInputBackstage.colorPicker(function (valueOpt) {\n              valueOpt.fold(function () {\n                return emit(colorBit, colorPickerCancelEvent);\n              }, function (value) {\n                emitSwatchChange(colorBit, value);\n                addColor(value);\n              });\n            }, '#ffffff');\n          } else if (value === 'remove') {\n            emitSwatchChange(colorBit, '');\n          } else {\n            emitSwatchChange(colorBit, value);\n          }\n        });\n      };\n      var memColorButton = record(renderPanelButton({\n        dom: {\n          tag: 'span',\n          attributes: { 'aria-label': sharedBackstage.providers.translate('Color swatch') }\n        },\n        layouts: {\n          onRtl: function () {\n            return [\n              southwest$1,\n              southeast$1,\n              south$1\n            ];\n          },\n          onLtr: function () {\n            return [\n              southeast$1,\n              southwest$1,\n              south$1\n            ];\n          }\n        },\n        components: [],\n        fetch: getFetch(colorInputBackstage.getColors(), colorInputBackstage.hasCustomColors()),\n        columns: colorInputBackstage.getColorCols(),\n        presets: 'color',\n        onItemAction: onItemAction\n      }, sharedBackstage));\n      return FormField.sketch({\n        dom: {\n          tag: 'div',\n          classes: ['tox-form__group']\n        },\n        components: pLabel.toArray().concat([{\n            dom: {\n              tag: 'div',\n              classes: ['tox-color-input']\n            },\n            components: [\n              pField,\n              memColorButton.asSpec()\n            ]\n          }]),\n        fieldBehaviours: derive$1([config('form-field-events', [\n            run(colorInputChangeEvent, function (comp, se) {\n              memColorButton.getOpt(comp).each(function (colorButton) {\n                set$2(colorButton.element, 'background-color', se.event.color);\n              });\n              emitWith(comp, formChangeEvent, { name: spec.name });\n            }),\n            run(colorSwatchChangeEvent, function (comp, se) {\n              FormField.getField(comp).each(function (field) {\n                Representing.setValue(field, se.event.value);\n                Composing.getCurrent(comp).each(Focusing.focus);\n              });\n            }),\n            run(colorPickerCancelEvent, function (comp, _se) {\n              FormField.getField(comp).each(function (_field) {\n                Composing.getCurrent(comp).each(Focusing.focus);\n              });\n            })\n          ])])\n      });\n    };\n\n    var labelPart = optional({\n      schema: [strict$1('dom')],\n      name: 'label'\n    });\n    var edgePart = function (name) {\n      return optional({\n        name: '' + name + '-edge',\n        overrides: function (detail) {\n          var action = detail.model.manager.edgeActions[name];\n          return action.fold(function () {\n            return {};\n          }, function (a) {\n            return {\n              events: derive([\n                runActionExtra(touchstart(), function (comp, se, d) {\n                  return a(comp, d);\n                }, [detail]),\n                runActionExtra(mousedown(), function (comp, se, d) {\n                  return a(comp, d);\n                }, [detail]),\n                runActionExtra(mousemove(), function (comp, se, det) {\n                  if (det.mouseIsDown.get()) {\n                    a(comp, det);\n                  }\n                }, [detail])\n              ])\n            };\n          });\n        }\n      });\n    };\n    var tlEdgePart = edgePart('top-left');\n    var tedgePart = edgePart('top');\n    var trEdgePart = edgePart('top-right');\n    var redgePart = edgePart('right');\n    var brEdgePart = edgePart('bottom-right');\n    var bedgePart = edgePart('bottom');\n    var blEdgePart = edgePart('bottom-left');\n    var ledgePart = edgePart('left');\n    var thumbPart = required({\n      name: 'thumb',\n      defaults: constant({ dom: { styles: { position: 'absolute' } } }),\n      overrides: function (detail) {\n        return {\n          events: derive([\n            redirectToPart(touchstart(), detail, 'spectrum'),\n            redirectToPart(touchmove(), detail, 'spectrum'),\n            redirectToPart(touchend(), detail, 'spectrum'),\n            redirectToPart(mousedown(), detail, 'spectrum'),\n            redirectToPart(mousemove(), detail, 'spectrum'),\n            redirectToPart(mouseup(), detail, 'spectrum')\n          ])\n        };\n      }\n    });\n    var spectrumPart = required({\n      schema: [state$1('mouseIsDown', function () {\n          return Cell(false);\n        })],\n      name: 'spectrum',\n      overrides: function (detail) {\n        var modelDetail = detail.model;\n        var model = modelDetail.manager;\n        var setValueFrom = function (component, simulatedEvent) {\n          return model.getValueFromEvent(simulatedEvent).map(function (value) {\n            return model.setValueFrom(component, detail, value);\n          });\n        };\n        return {\n          behaviours: derive$1([\n            Keying.config({\n              mode: 'special',\n              onLeft: function (spectrum) {\n                return model.onLeft(spectrum, detail);\n              },\n              onRight: function (spectrum) {\n                return model.onRight(spectrum, detail);\n              },\n              onUp: function (spectrum) {\n                return model.onUp(spectrum, detail);\n              },\n              onDown: function (spectrum) {\n                return model.onDown(spectrum, detail);\n              }\n            }),\n            Focusing.config({})\n          ]),\n          events: derive([\n            run(touchstart(), setValueFrom),\n            run(touchmove(), setValueFrom),\n            run(mousedown(), setValueFrom),\n            run(mousemove(), function (spectrum, se) {\n              if (detail.mouseIsDown.get()) {\n                setValueFrom(spectrum, se);\n              }\n            })\n          ])\n        };\n      }\n    });\n    var SliderParts = [\n      labelPart,\n      ledgePart,\n      redgePart,\n      tedgePart,\n      bedgePart,\n      tlEdgePart,\n      trEdgePart,\n      blEdgePart,\n      brEdgePart,\n      thumbPart,\n      spectrumPart\n    ];\n\n    var _sliderChangeEvent = 'slider.change.value';\n    var sliderChangeEvent = constant(_sliderChangeEvent);\n    var isTouchEvent = function (evt) {\n      return evt.type.indexOf('touch') !== -1;\n    };\n    var getEventSource = function (simulatedEvent) {\n      var evt = simulatedEvent.event.raw;\n      if (isTouchEvent(evt)) {\n        var touchEvent = evt;\n        return touchEvent.touches !== undefined && touchEvent.touches.length === 1 ? Optional.some(touchEvent.touches[0]).map(function (t) {\n          return SugarPosition(t.clientX, t.clientY);\n        }) : Optional.none();\n      } else {\n        var mouseEvent = evt;\n        return mouseEvent.clientX !== undefined ? Optional.some(mouseEvent).map(function (me) {\n          return SugarPosition(me.clientX, me.clientY);\n        }) : Optional.none();\n      }\n    };\n\n    var t = 'top', r$1 = 'right', b = 'bottom', l = 'left';\n    var minX = function (detail) {\n      return detail.model.minX;\n    };\n    var minY = function (detail) {\n      return detail.model.minY;\n    };\n    var min1X = function (detail) {\n      return detail.model.minX - 1;\n    };\n    var min1Y = function (detail) {\n      return detail.model.minY - 1;\n    };\n    var maxX = function (detail) {\n      return detail.model.maxX;\n    };\n    var maxY = function (detail) {\n      return detail.model.maxY;\n    };\n    var max1X = function (detail) {\n      return detail.model.maxX + 1;\n    };\n    var max1Y = function (detail) {\n      return detail.model.maxY + 1;\n    };\n    var range$2 = function (detail, max, min) {\n      return max(detail) - min(detail);\n    };\n    var xRange = function (detail) {\n      return range$2(detail, maxX, minX);\n    };\n    var yRange = function (detail) {\n      return range$2(detail, maxY, minY);\n    };\n    var halfX = function (detail) {\n      return xRange(detail) / 2;\n    };\n    var halfY = function (detail) {\n      return yRange(detail) / 2;\n    };\n    var step = function (detail) {\n      return detail.stepSize;\n    };\n    var snap = function (detail) {\n      return detail.snapToGrid;\n    };\n    var snapStart = function (detail) {\n      return detail.snapStart;\n    };\n    var rounded = function (detail) {\n      return detail.rounded;\n    };\n    var hasEdge = function (detail, edgeName) {\n      return detail[edgeName + '-edge'] !== undefined;\n    };\n    var hasLEdge = function (detail) {\n      return hasEdge(detail, l);\n    };\n    var hasREdge = function (detail) {\n      return hasEdge(detail, r$1);\n    };\n    var hasTEdge = function (detail) {\n      return hasEdge(detail, t);\n    };\n    var hasBEdge = function (detail) {\n      return hasEdge(detail, b);\n    };\n    var currentValue = function (detail) {\n      return detail.model.value.get();\n    };\n\n    var xValue = function (x) {\n      return { x: x };\n    };\n    var yValue = function (y) {\n      return { y: y };\n    };\n    var xyValue = function (x, y) {\n      return {\n        x: x,\n        y: y\n      };\n    };\n    var fireSliderChange = function (component, value) {\n      emitWith(component, sliderChangeEvent(), { value: value });\n    };\n    var setToTLEdgeXY = function (edge, detail) {\n      fireSliderChange(edge, xyValue(min1X(detail), min1Y(detail)));\n    };\n    var setToTEdge = function (edge, detail) {\n      fireSliderChange(edge, yValue(min1Y(detail)));\n    };\n    var setToTEdgeXY = function (edge, detail) {\n      fireSliderChange(edge, xyValue(halfX(detail), min1Y(detail)));\n    };\n    var setToTREdgeXY = function (edge, detail) {\n      fireSliderChange(edge, xyValue(max1X(detail), min1Y(detail)));\n    };\n    var setToREdge = function (edge, detail) {\n      fireSliderChange(edge, xValue(max1X(detail)));\n    };\n    var setToREdgeXY = function (edge, detail) {\n      fireSliderChange(edge, xyValue(max1X(detail), halfY(detail)));\n    };\n    var setToBREdgeXY = function (edge, detail) {\n      fireSliderChange(edge, xyValue(max1X(detail), max1Y(detail)));\n    };\n    var setToBEdge = function (edge, detail) {\n      fireSliderChange(edge, yValue(max1Y(detail)));\n    };\n    var setToBEdgeXY = function (edge, detail) {\n      fireSliderChange(edge, xyValue(halfX(detail), max1Y(detail)));\n    };\n    var setToBLEdgeXY = function (edge, detail) {\n      fireSliderChange(edge, xyValue(min1X(detail), max1Y(detail)));\n    };\n    var setToLEdge = function (edge, detail) {\n      fireSliderChange(edge, xValue(min1X(detail)));\n    };\n    var setToLEdgeXY = function (edge, detail) {\n      fireSliderChange(edge, xyValue(min1X(detail), halfY(detail)));\n    };\n\n    var reduceBy = function (value, min, max, step) {\n      if (value < min) {\n        return value;\n      } else if (value > max) {\n        return max;\n      } else if (value === min) {\n        return min - 1;\n      } else {\n        return Math.max(min, value - step);\n      }\n    };\n    var increaseBy = function (value, min, max, step) {\n      if (value > max) {\n        return value;\n      } else if (value < min) {\n        return min;\n      } else if (value === max) {\n        return max + 1;\n      } else {\n        return Math.min(max, value + step);\n      }\n    };\n    var capValue = function (value, min, max) {\n      return Math.max(min, Math.min(max, value));\n    };\n    var snapValueOf = function (value, min, max, step, snapStart) {\n      return snapStart.fold(function () {\n        var initValue = value - min;\n        var extraValue = Math.round(initValue / step) * step;\n        return capValue(min + extraValue, min - 1, max + 1);\n      }, function (start) {\n        var remainder = (value - start) % step;\n        var adjustment = Math.round(remainder / step);\n        var rawSteps = Math.floor((value - start) / step);\n        var maxSteps = Math.floor((max - start) / step);\n        var numSteps = Math.min(maxSteps, rawSteps + adjustment);\n        var r = start + numSteps * step;\n        return Math.max(start, r);\n      });\n    };\n    var findOffsetOf = function (value, min, max) {\n      return Math.min(max, Math.max(value, min)) - min;\n    };\n    var findValueOf = function (args) {\n      var min = args.min, max = args.max, range = args.range, value = args.value, step = args.step, snap = args.snap, snapStart = args.snapStart, rounded = args.rounded, hasMinEdge = args.hasMinEdge, hasMaxEdge = args.hasMaxEdge, minBound = args.minBound, maxBound = args.maxBound, screenRange = args.screenRange;\n      var capMin = hasMinEdge ? min - 1 : min;\n      var capMax = hasMaxEdge ? max + 1 : max;\n      if (value < minBound) {\n        return capMin;\n      } else if (value > maxBound) {\n        return capMax;\n      } else {\n        var offset = findOffsetOf(value, minBound, maxBound);\n        var newValue = capValue(offset / screenRange * range + min, capMin, capMax);\n        if (snap && newValue >= min && newValue <= max) {\n          return snapValueOf(newValue, min, max, step, snapStart);\n        } else if (rounded) {\n          return Math.round(newValue);\n        } else {\n          return newValue;\n        }\n      }\n    };\n    var findOffsetOfValue = function (args) {\n      var min = args.min, max = args.max, range = args.range, value = args.value, hasMinEdge = args.hasMinEdge, hasMaxEdge = args.hasMaxEdge, maxBound = args.maxBound, maxOffset = args.maxOffset, centerMinEdge = args.centerMinEdge, centerMaxEdge = args.centerMaxEdge;\n      if (value < min) {\n        return hasMinEdge ? 0 : centerMinEdge;\n      } else if (value > max) {\n        return hasMaxEdge ? maxBound : centerMaxEdge;\n      } else {\n        return (value - min) / range * maxOffset;\n      }\n    };\n\n    var top = 'top', right = 'right', bottom = 'bottom', left = 'left', width = 'width', height = 'height';\n    var getBounds$1 = function (component) {\n      return component.element.dom.getBoundingClientRect();\n    };\n    var getBoundsProperty = function (bounds, property) {\n      return bounds[property];\n    };\n    var getMinXBounds = function (component) {\n      var bounds = getBounds$1(component);\n      return getBoundsProperty(bounds, left);\n    };\n    var getMaxXBounds = function (component) {\n      var bounds = getBounds$1(component);\n      return getBoundsProperty(bounds, right);\n    };\n    var getMinYBounds = function (component) {\n      var bounds = getBounds$1(component);\n      return getBoundsProperty(bounds, top);\n    };\n    var getMaxYBounds = function (component) {\n      var bounds = getBounds$1(component);\n      return getBoundsProperty(bounds, bottom);\n    };\n    var getXScreenRange = function (component) {\n      var bounds = getBounds$1(component);\n      return getBoundsProperty(bounds, width);\n    };\n    var getYScreenRange = function (component) {\n      var bounds = getBounds$1(component);\n      return getBoundsProperty(bounds, height);\n    };\n    var getCenterOffsetOf = function (componentMinEdge, componentMaxEdge, spectrumMinEdge) {\n      return (componentMinEdge + componentMaxEdge) / 2 - spectrumMinEdge;\n    };\n    var getXCenterOffSetOf = function (component, spectrum) {\n      var componentBounds = getBounds$1(component);\n      var spectrumBounds = getBounds$1(spectrum);\n      var componentMinEdge = getBoundsProperty(componentBounds, left);\n      var componentMaxEdge = getBoundsProperty(componentBounds, right);\n      var spectrumMinEdge = getBoundsProperty(spectrumBounds, left);\n      return getCenterOffsetOf(componentMinEdge, componentMaxEdge, spectrumMinEdge);\n    };\n    var getYCenterOffSetOf = function (component, spectrum) {\n      var componentBounds = getBounds$1(component);\n      var spectrumBounds = getBounds$1(spectrum);\n      var componentMinEdge = getBoundsProperty(componentBounds, top);\n      var componentMaxEdge = getBoundsProperty(componentBounds, bottom);\n      var spectrumMinEdge = getBoundsProperty(spectrumBounds, top);\n      return getCenterOffsetOf(componentMinEdge, componentMaxEdge, spectrumMinEdge);\n    };\n\n    var fireSliderChange$1 = function (spectrum, value) {\n      emitWith(spectrum, sliderChangeEvent(), { value: value });\n    };\n    var sliderValue = function (x) {\n      return { x: x };\n    };\n    var findValueOfOffset = function (spectrum, detail, left) {\n      var args = {\n        min: minX(detail),\n        max: maxX(detail),\n        range: xRange(detail),\n        value: left,\n        step: step(detail),\n        snap: snap(detail),\n        snapStart: snapStart(detail),\n        rounded: rounded(detail),\n        hasMinEdge: hasLEdge(detail),\n        hasMaxEdge: hasREdge(detail),\n        minBound: getMinXBounds(spectrum),\n        maxBound: getMaxXBounds(spectrum),\n        screenRange: getXScreenRange(spectrum)\n      };\n      return findValueOf(args);\n    };\n    var setValueFrom = function (spectrum, detail, value) {\n      var xValue = findValueOfOffset(spectrum, detail, value);\n      var sliderVal = sliderValue(xValue);\n      fireSliderChange$1(spectrum, sliderVal);\n      return xValue;\n    };\n    var setToMin = function (spectrum, detail) {\n      var min = minX(detail);\n      fireSliderChange$1(spectrum, sliderValue(min));\n    };\n    var setToMax = function (spectrum, detail) {\n      var max = maxX(detail);\n      fireSliderChange$1(spectrum, sliderValue(max));\n    };\n    var moveBy = function (direction, spectrum, detail) {\n      var f = direction > 0 ? increaseBy : reduceBy;\n      var xValue = f(currentValue(detail).x, minX(detail), maxX(detail), step(detail));\n      fireSliderChange$1(spectrum, sliderValue(xValue));\n      return Optional.some(xValue);\n    };\n    var handleMovement = function (direction) {\n      return function (spectrum, detail) {\n        return moveBy(direction, spectrum, detail).map(always);\n      };\n    };\n    var getValueFromEvent = function (simulatedEvent) {\n      var pos = getEventSource(simulatedEvent);\n      return pos.map(function (p) {\n        return p.left;\n      });\n    };\n    var findOffsetOfValue$1 = function (spectrum, detail, value, minEdge, maxEdge) {\n      var minOffset = 0;\n      var maxOffset = getXScreenRange(spectrum);\n      var centerMinEdge = minEdge.bind(function (edge) {\n        return Optional.some(getXCenterOffSetOf(edge, spectrum));\n      }).getOr(minOffset);\n      var centerMaxEdge = maxEdge.bind(function (edge) {\n        return Optional.some(getXCenterOffSetOf(edge, spectrum));\n      }).getOr(maxOffset);\n      var args = {\n        min: minX(detail),\n        max: maxX(detail),\n        range: xRange(detail),\n        value: value,\n        hasMinEdge: hasLEdge(detail),\n        hasMaxEdge: hasREdge(detail),\n        minBound: getMinXBounds(spectrum),\n        minOffset: minOffset,\n        maxBound: getMaxXBounds(spectrum),\n        maxOffset: maxOffset,\n        centerMinEdge: centerMinEdge,\n        centerMaxEdge: centerMaxEdge\n      };\n      return findOffsetOfValue(args);\n    };\n    var findPositionOfValue = function (slider, spectrum, value, minEdge, maxEdge, detail) {\n      var offset = findOffsetOfValue$1(spectrum, detail, value, minEdge, maxEdge);\n      return getMinXBounds(spectrum) - getMinXBounds(slider) + offset;\n    };\n    var setPositionFromValue = function (slider, thumb, detail, edges) {\n      var value = currentValue(detail);\n      var pos = findPositionOfValue(slider, edges.getSpectrum(slider), value.x, edges.getLeftEdge(slider), edges.getRightEdge(slider), detail);\n      var thumbRadius = get$8(thumb.element) / 2;\n      set$2(thumb.element, 'left', pos - thumbRadius + 'px');\n    };\n    var onLeft = handleMovement(-1);\n    var onRight = handleMovement(1);\n    var onUp = Optional.none;\n    var onDown = Optional.none;\n    var edgeActions = {\n      'top-left': Optional.none(),\n      'top': Optional.none(),\n      'top-right': Optional.none(),\n      'right': Optional.some(setToREdge),\n      'bottom-right': Optional.none(),\n      'bottom': Optional.none(),\n      'bottom-left': Optional.none(),\n      'left': Optional.some(setToLEdge)\n    };\n\n    var HorizontalModel = /*#__PURE__*/Object.freeze({\n        __proto__: null,\n        setValueFrom: setValueFrom,\n        setToMin: setToMin,\n        setToMax: setToMax,\n        findValueOfOffset: findValueOfOffset,\n        getValueFromEvent: getValueFromEvent,\n        findPositionOfValue: findPositionOfValue,\n        setPositionFromValue: setPositionFromValue,\n        onLeft: onLeft,\n        onRight: onRight,\n        onUp: onUp,\n        onDown: onDown,\n        edgeActions: edgeActions\n    });\n\n    var fireSliderChange$2 = function (spectrum, value) {\n      emitWith(spectrum, sliderChangeEvent(), { value: value });\n    };\n    var sliderValue$1 = function (y) {\n      return { y: y };\n    };\n    var findValueOfOffset$1 = function (spectrum, detail, top) {\n      var args = {\n        min: minY(detail),\n        max: maxY(detail),\n        range: yRange(detail),\n        value: top,\n        step: step(detail),\n        snap: snap(detail),\n        snapStart: snapStart(detail),\n        rounded: rounded(detail),\n        hasMinEdge: hasTEdge(detail),\n        hasMaxEdge: hasBEdge(detail),\n        minBound: getMinYBounds(spectrum),\n        maxBound: getMaxYBounds(spectrum),\n        screenRange: getYScreenRange(spectrum)\n      };\n      return findValueOf(args);\n    };\n    var setValueFrom$1 = function (spectrum, detail, value) {\n      var yValue = findValueOfOffset$1(spectrum, detail, value);\n      var sliderVal = sliderValue$1(yValue);\n      fireSliderChange$2(spectrum, sliderVal);\n      return yValue;\n    };\n    var setToMin$1 = function (spectrum, detail) {\n      var min = minY(detail);\n      fireSliderChange$2(spectrum, sliderValue$1(min));\n    };\n    var setToMax$1 = function (spectrum, detail) {\n      var max = maxY(detail);\n      fireSliderChange$2(spectrum, sliderValue$1(max));\n    };\n    var moveBy$1 = function (direction, spectrum, detail) {\n      var f = direction > 0 ? increaseBy : reduceBy;\n      var yValue = f(currentValue(detail).y, minY(detail), maxY(detail), step(detail));\n      fireSliderChange$2(spectrum, sliderValue$1(yValue));\n      return Optional.some(yValue);\n    };\n    var handleMovement$1 = function (direction) {\n      return function (spectrum, detail) {\n        return moveBy$1(direction, spectrum, detail).map(always);\n      };\n    };\n    var getValueFromEvent$1 = function (simulatedEvent) {\n      var pos = getEventSource(simulatedEvent);\n      return pos.map(function (p) {\n        return p.top;\n      });\n    };\n    var findOffsetOfValue$2 = function (spectrum, detail, value, minEdge, maxEdge) {\n      var minOffset = 0;\n      var maxOffset = getYScreenRange(spectrum);\n      var centerMinEdge = minEdge.bind(function (edge) {\n        return Optional.some(getYCenterOffSetOf(edge, spectrum));\n      }).getOr(minOffset);\n      var centerMaxEdge = maxEdge.bind(function (edge) {\n        return Optional.some(getYCenterOffSetOf(edge, spectrum));\n      }).getOr(maxOffset);\n      var args = {\n        min: minY(detail),\n        max: maxY(detail),\n        range: yRange(detail),\n        value: value,\n        hasMinEdge: hasTEdge(detail),\n        hasMaxEdge: hasBEdge(detail),\n        minBound: getMinYBounds(spectrum),\n        minOffset: minOffset,\n        maxBound: getMaxYBounds(spectrum),\n        maxOffset: maxOffset,\n        centerMinEdge: centerMinEdge,\n        centerMaxEdge: centerMaxEdge\n      };\n      return findOffsetOfValue(args);\n    };\n    var findPositionOfValue$1 = function (slider, spectrum, value, minEdge, maxEdge, detail) {\n      var offset = findOffsetOfValue$2(spectrum, detail, value, minEdge, maxEdge);\n      return getMinYBounds(spectrum) - getMinYBounds(slider) + offset;\n    };\n    var setPositionFromValue$1 = function (slider, thumb, detail, edges) {\n      var value = currentValue(detail);\n      var pos = findPositionOfValue$1(slider, edges.getSpectrum(slider), value.y, edges.getTopEdge(slider), edges.getBottomEdge(slider), detail);\n      var thumbRadius = get$7(thumb.element) / 2;\n      set$2(thumb.element, 'top', pos - thumbRadius + 'px');\n    };\n    var onLeft$1 = Optional.none;\n    var onRight$1 = Optional.none;\n    var onUp$1 = handleMovement$1(-1);\n    var onDown$1 = handleMovement$1(1);\n    var edgeActions$1 = {\n      'top-left': Optional.none(),\n      'top': Optional.some(setToTEdge),\n      'top-right': Optional.none(),\n      'right': Optional.none(),\n      'bottom-right': Optional.none(),\n      'bottom': Optional.some(setToBEdge),\n      'bottom-left': Optional.none(),\n      'left': Optional.none()\n    };\n\n    var VerticalModel = /*#__PURE__*/Object.freeze({\n        __proto__: null,\n        setValueFrom: setValueFrom$1,\n        setToMin: setToMin$1,\n        setToMax: setToMax$1,\n        findValueOfOffset: findValueOfOffset$1,\n        getValueFromEvent: getValueFromEvent$1,\n        findPositionOfValue: findPositionOfValue$1,\n        setPositionFromValue: setPositionFromValue$1,\n        onLeft: onLeft$1,\n        onRight: onRight$1,\n        onUp: onUp$1,\n        onDown: onDown$1,\n        edgeActions: edgeActions$1\n    });\n\n    var fireSliderChange$3 = function (spectrum, value) {\n      emitWith(spectrum, sliderChangeEvent(), { value: value });\n    };\n    var sliderValue$2 = function (x, y) {\n      return {\n        x: x,\n        y: y\n      };\n    };\n    var setValueFrom$2 = function (spectrum, detail, value) {\n      var xValue = findValueOfOffset(spectrum, detail, value.left);\n      var yValue = findValueOfOffset$1(spectrum, detail, value.top);\n      var val = sliderValue$2(xValue, yValue);\n      fireSliderChange$3(spectrum, val);\n      return val;\n    };\n    var moveBy$2 = function (direction, isVerticalMovement, spectrum, detail) {\n      var f = direction > 0 ? increaseBy : reduceBy;\n      var xValue = isVerticalMovement ? currentValue(detail).x : f(currentValue(detail).x, minX(detail), maxX(detail), step(detail));\n      var yValue = !isVerticalMovement ? currentValue(detail).y : f(currentValue(detail).y, minY(detail), maxY(detail), step(detail));\n      fireSliderChange$3(spectrum, sliderValue$2(xValue, yValue));\n      return Optional.some(xValue);\n    };\n    var handleMovement$2 = function (direction, isVerticalMovement) {\n      return function (spectrum, detail) {\n        return moveBy$2(direction, isVerticalMovement, spectrum, detail).map(always);\n      };\n    };\n    var setToMin$2 = function (spectrum, detail) {\n      var mX = minX(detail);\n      var mY = minY(detail);\n      fireSliderChange$3(spectrum, sliderValue$2(mX, mY));\n    };\n    var setToMax$2 = function (spectrum, detail) {\n      var mX = maxX(detail);\n      var mY = maxY(detail);\n      fireSliderChange$3(spectrum, sliderValue$2(mX, mY));\n    };\n    var getValueFromEvent$2 = function (simulatedEvent) {\n      return getEventSource(simulatedEvent);\n    };\n    var setPositionFromValue$2 = function (slider, thumb, detail, edges) {\n      var value = currentValue(detail);\n      var xPos = findPositionOfValue(slider, edges.getSpectrum(slider), value.x, edges.getLeftEdge(slider), edges.getRightEdge(slider), detail);\n      var yPos = findPositionOfValue$1(slider, edges.getSpectrum(slider), value.y, edges.getTopEdge(slider), edges.getBottomEdge(slider), detail);\n      var thumbXRadius = get$8(thumb.element) / 2;\n      var thumbYRadius = get$7(thumb.element) / 2;\n      set$2(thumb.element, 'left', xPos - thumbXRadius + 'px');\n      set$2(thumb.element, 'top', yPos - thumbYRadius + 'px');\n    };\n    var onLeft$2 = handleMovement$2(-1, false);\n    var onRight$2 = handleMovement$2(1, false);\n    var onUp$2 = handleMovement$2(-1, true);\n    var onDown$2 = handleMovement$2(1, true);\n    var edgeActions$2 = {\n      'top-left': Optional.some(setToTLEdgeXY),\n      'top': Optional.some(setToTEdgeXY),\n      'top-right': Optional.some(setToTREdgeXY),\n      'right': Optional.some(setToREdgeXY),\n      'bottom-right': Optional.some(setToBREdgeXY),\n      'bottom': Optional.some(setToBEdgeXY),\n      'bottom-left': Optional.some(setToBLEdgeXY),\n      'left': Optional.some(setToLEdgeXY)\n    };\n\n    var TwoDModel = /*#__PURE__*/Object.freeze({\n        __proto__: null,\n        setValueFrom: setValueFrom$2,\n        setToMin: setToMin$2,\n        setToMax: setToMax$2,\n        getValueFromEvent: getValueFromEvent$2,\n        setPositionFromValue: setPositionFromValue$2,\n        onLeft: onLeft$2,\n        onRight: onRight$2,\n        onUp: onUp$2,\n        onDown: onDown$2,\n        edgeActions: edgeActions$2\n    });\n\n    var SliderSchema = [\n      defaulted$1('stepSize', 1),\n      defaulted$1('onChange', noop),\n      defaulted$1('onChoose', noop),\n      defaulted$1('onInit', noop),\n      defaulted$1('onDragStart', noop),\n      defaulted$1('onDragEnd', noop),\n      defaulted$1('snapToGrid', false),\n      defaulted$1('rounded', true),\n      option('snapStart'),\n      strictOf('model', choose$1('mode', {\n        x: [\n          defaulted$1('minX', 0),\n          defaulted$1('maxX', 100),\n          state$1('value', function (spec) {\n            return Cell(spec.mode.minX);\n          }),\n          strict$1('getInitialValue'),\n          output('manager', HorizontalModel)\n        ],\n        y: [\n          defaulted$1('minY', 0),\n          defaulted$1('maxY', 100),\n          state$1('value', function (spec) {\n            return Cell(spec.mode.minY);\n          }),\n          strict$1('getInitialValue'),\n          output('manager', VerticalModel)\n        ],\n        xy: [\n          defaulted$1('minX', 0),\n          defaulted$1('maxX', 100),\n          defaulted$1('minY', 0),\n          defaulted$1('maxY', 100),\n          state$1('value', function (spec) {\n            return Cell({\n              x: spec.mode.minX,\n              y: spec.mode.minY\n            });\n          }),\n          strict$1('getInitialValue'),\n          output('manager', TwoDModel)\n        ]\n      })),\n      field$1('sliderBehaviours', [\n        Keying,\n        Representing\n      ]),\n      state$1('mouseIsDown', function () {\n        return Cell(false);\n      })\n    ];\n\n    var sketch = function (detail, components, _spec, _externals) {\n      var _a;\n      var getThumb = function (component) {\n        return getPartOrDie(component, detail, 'thumb');\n      };\n      var getSpectrum = function (component) {\n        return getPartOrDie(component, detail, 'spectrum');\n      };\n      var getLeftEdge = function (component) {\n        return getPart(component, detail, 'left-edge');\n      };\n      var getRightEdge = function (component) {\n        return getPart(component, detail, 'right-edge');\n      };\n      var getTopEdge = function (component) {\n        return getPart(component, detail, 'top-edge');\n      };\n      var getBottomEdge = function (component) {\n        return getPart(component, detail, 'bottom-edge');\n      };\n      var modelDetail = detail.model;\n      var model = modelDetail.manager;\n      var refresh = function (slider, thumb) {\n        model.setPositionFromValue(slider, thumb, detail, {\n          getLeftEdge: getLeftEdge,\n          getRightEdge: getRightEdge,\n          getTopEdge: getTopEdge,\n          getBottomEdge: getBottomEdge,\n          getSpectrum: getSpectrum\n        });\n      };\n      var setValue = function (slider, newValue) {\n        modelDetail.value.set(newValue);\n        var thumb = getThumb(slider);\n        refresh(slider, thumb);\n      };\n      var changeValue = function (slider, newValue) {\n        setValue(slider, newValue);\n        var thumb = getThumb(slider);\n        detail.onChange(slider, thumb, newValue);\n        return Optional.some(true);\n      };\n      var resetToMin = function (slider) {\n        model.setToMin(slider, detail);\n      };\n      var resetToMax = function (slider) {\n        model.setToMax(slider, detail);\n      };\n      var choose = function (slider) {\n        var fireOnChoose = function () {\n          getPart(slider, detail, 'thumb').each(function (thumb) {\n            var value = modelDetail.value.get();\n            detail.onChoose(slider, thumb, value);\n          });\n        };\n        var wasDown = detail.mouseIsDown.get();\n        detail.mouseIsDown.set(false);\n        if (wasDown) {\n          fireOnChoose();\n        }\n      };\n      var onDragStart = function (slider, simulatedEvent) {\n        simulatedEvent.stop();\n        detail.mouseIsDown.set(true);\n        detail.onDragStart(slider, getThumb(slider));\n      };\n      var onDragEnd = function (slider, simulatedEvent) {\n        simulatedEvent.stop();\n        detail.onDragEnd(slider, getThumb(slider));\n        choose(slider);\n      };\n      return {\n        uid: detail.uid,\n        dom: detail.dom,\n        components: components,\n        behaviours: augment(detail.sliderBehaviours, [\n          Keying.config({\n            mode: 'special',\n            focusIn: function (slider) {\n              return getPart(slider, detail, 'spectrum').map(Keying.focusIn).map(always);\n            }\n          }),\n          Representing.config({\n            store: {\n              mode: 'manual',\n              getValue: function (_) {\n                return modelDetail.value.get();\n              }\n            }\n          }),\n          Receiving.config({ channels: (_a = {}, _a[mouseReleased()] = { onReceive: choose }, _a) })\n        ]),\n        events: derive([\n          run(sliderChangeEvent(), function (slider, simulatedEvent) {\n            changeValue(slider, simulatedEvent.event.value);\n          }),\n          runOnAttached(function (slider, _simulatedEvent) {\n            var getInitial = modelDetail.getInitialValue();\n            modelDetail.value.set(getInitial);\n            var thumb = getThumb(slider);\n            refresh(slider, thumb);\n            var spectrum = getSpectrum(slider);\n            detail.onInit(slider, thumb, spectrum, modelDetail.value.get());\n          }),\n          run(touchstart(), onDragStart),\n          run(touchend(), onDragEnd),\n          run(mousedown(), onDragStart),\n          run(mouseup(), onDragEnd)\n        ]),\n        apis: {\n          resetToMin: resetToMin,\n          resetToMax: resetToMax,\n          setValue: setValue,\n          refresh: refresh\n        },\n        domModification: { styles: { position: 'relative' } }\n      };\n    };\n\n    var Slider = composite$1({\n      name: 'Slider',\n      configFields: SliderSchema,\n      partFields: SliderParts,\n      factory: sketch,\n      apis: {\n        setValue: function (apis, slider, value) {\n          apis.setValue(slider, value);\n        },\n        resetToMin: function (apis, slider) {\n          apis.resetToMin(slider);\n        },\n        resetToMax: function (apis, slider) {\n          apis.resetToMax(slider);\n        },\n        refresh: function (apis, slider) {\n          apis.refresh(slider);\n        }\n      }\n    });\n\n    var hsvColour = function (hue, saturation, value) {\n      return {\n        hue: hue,\n        saturation: saturation,\n        value: value\n      };\n    };\n    var fromRgb = function (rgbaColour) {\n      var h = 0;\n      var s = 0;\n      var v = 0;\n      var r = rgbaColour.red / 255;\n      var g = rgbaColour.green / 255;\n      var b = rgbaColour.blue / 255;\n      var minRGB = Math.min(r, Math.min(g, b));\n      var maxRGB = Math.max(r, Math.max(g, b));\n      if (minRGB === maxRGB) {\n        v = minRGB;\n        return hsvColour(0, 0, v * 100);\n      }\n      var d = r === minRGB ? g - b : b === minRGB ? r - g : b - r;\n      h = r === minRGB ? 3 : b === minRGB ? 1 : 5;\n      h = 60 * (h - d / (maxRGB - minRGB));\n      s = (maxRGB - minRGB) / maxRGB;\n      v = maxRGB;\n      return hsvColour(Math.round(h), Math.round(s * 100), Math.round(v * 100));\n    };\n\n    var hexToHsv = function (hex) {\n      return fromRgb(fromHex(hex));\n    };\n    var hsvToHex = function (hsv) {\n      return fromRgba(fromHsv(hsv));\n    };\n\n    var fieldsUpdate = generate$1('rgb-hex-update');\n    var sliderUpdate = generate$1('slider-update');\n    var paletteUpdate = generate$1('palette-update');\n\n    var sliderFactory = function (translate, getClass) {\n      var spectrum = Slider.parts.spectrum({\n        dom: {\n          tag: 'div',\n          classes: [getClass('hue-slider-spectrum')],\n          attributes: { role: 'presentation' }\n        }\n      });\n      var thumb = Slider.parts.thumb({\n        dom: {\n          tag: 'div',\n          classes: [getClass('hue-slider-thumb')],\n          attributes: { role: 'presentation' }\n        }\n      });\n      return Slider.sketch({\n        dom: {\n          tag: 'div',\n          classes: [getClass('hue-slider')],\n          attributes: { role: 'presentation' }\n        },\n        rounded: false,\n        model: {\n          mode: 'y',\n          getInitialValue: constant({ y: 0 })\n        },\n        components: [\n          spectrum,\n          thumb\n        ],\n        sliderBehaviours: derive$1([Focusing.config({})]),\n        onChange: function (slider, _thumb, value) {\n          emitWith(slider, sliderUpdate, { value: value });\n        }\n      });\n    };\n\n    var owner$3 = 'form';\n    var schema$h = [field$1('formBehaviours', [Representing])];\n    var getPartName = function (name) {\n      return '<alloy.field.' + name + '>';\n    };\n    var sketch$1 = function (fSpec) {\n      var parts = function () {\n        var record = [];\n        var field = function (name, config) {\n          record.push(name);\n          return generateOne(owner$3, getPartName(name), config);\n        };\n        return {\n          field: field,\n          record: function () {\n            return record;\n          }\n        };\n      }();\n      var spec = fSpec(parts);\n      var partNames = parts.record();\n      var fieldParts = map(partNames, function (n) {\n        return required({\n          name: n,\n          pname: getPartName(n)\n        });\n      });\n      return composite(owner$3, schema$h, fieldParts, make$4, spec);\n    };\n    var toResult$1 = function (o, e) {\n      return o.fold(function () {\n        return Result.error(e);\n      }, Result.value);\n    };\n    var make$4 = function (detail, components) {\n      return {\n        uid: detail.uid,\n        dom: detail.dom,\n        components: components,\n        behaviours: augment(detail.formBehaviours, [Representing.config({\n            store: {\n              mode: 'manual',\n              getValue: function (form) {\n                var resPs = getAllParts(form, detail);\n                return map$2(resPs, function (resPThunk, pName) {\n                  return resPThunk().bind(function (v) {\n                    var opt = Composing.getCurrent(v);\n                    return toResult$1(opt, new Error('Cannot find a current component to extract the value from for form part \\'' + pName + '\\': ' + element(v.element)));\n                  }).map(Representing.getValue);\n                });\n              },\n              setValue: function (form, values) {\n                each$1(values, function (newValue, key) {\n                  getPart(form, detail, key).each(function (wrapper) {\n                    Composing.getCurrent(wrapper).each(function (field) {\n                      Representing.setValue(field, newValue);\n                    });\n                  });\n                });\n              }\n            }\n          })]),\n        apis: {\n          getField: function (form, key) {\n            return getPart(form, detail, key).bind(Composing.getCurrent);\n          }\n        }\n      };\n    };\n    var Form = {\n      getField: makeApi(function (apis, component, key) {\n        return apis.getField(component, key);\n      }),\n      sketch: sketch$1\n    };\n\n    var validInput = generate$1('valid-input');\n    var invalidInput = generate$1('invalid-input');\n    var validatingInput = generate$1('validating-input');\n    var translatePrefix = 'colorcustom.rgb.';\n    var rgbFormFactory = function (translate, getClass, onValidHexx, onInvalidHexx) {\n      var invalidation = function (label, isValid) {\n        return Invalidating.config({\n          invalidClass: getClass('invalid'),\n          notify: {\n            onValidate: function (comp) {\n              emitWith(comp, validatingInput, { type: label });\n            },\n            onValid: function (comp) {\n              emitWith(comp, validInput, {\n                type: label,\n                value: Representing.getValue(comp)\n              });\n            },\n            onInvalid: function (comp) {\n              emitWith(comp, invalidInput, {\n                type: label,\n                value: Representing.getValue(comp)\n              });\n            }\n          },\n          validator: {\n            validate: function (comp) {\n              var value = Representing.getValue(comp);\n              var res = isValid(value) ? Result.value(true) : Result.error(translate('aria.input.invalid'));\n              return Future.pure(res);\n            },\n            validateOnLoad: false\n          }\n        });\n      };\n      var renderTextField = function (isValid, name, label, description, data) {\n        var helptext = translate(translatePrefix + 'range');\n        var pLabel = FormField.parts.label({\n          dom: {\n            tag: 'label',\n            innerHtml: label,\n            attributes: { 'aria-label': description }\n          }\n        });\n        var pField = FormField.parts.field({\n          data: data,\n          factory: Input,\n          inputAttributes: __assign({ type: 'text' }, name === 'hex' ? { 'aria-live': 'polite' } : {}),\n          inputClasses: [getClass('textfield')],\n          inputBehaviours: derive$1([\n            invalidation(name, isValid),\n            Tabstopping.config({})\n          ]),\n          onSetValue: function (input) {\n            if (Invalidating.isInvalid(input)) {\n              var run = Invalidating.run(input);\n              run.get(noop);\n            }\n          }\n        });\n        var comps = [\n          pLabel,\n          pField\n        ];\n        var concats = name !== 'hex' ? [FormField.parts['aria-descriptor']({ text: helptext })] : [];\n        var components = comps.concat(concats);\n        return {\n          dom: {\n            tag: 'div',\n            attributes: { role: 'presentation' }\n          },\n          components: components\n        };\n      };\n      var copyRgbToHex = function (form, rgba) {\n        var hex = fromRgba(rgba);\n        Form.getField(form, 'hex').each(function (hexField) {\n          if (!Focusing.isFocused(hexField)) {\n            Representing.setValue(form, { hex: hex.value });\n          }\n        });\n        return hex;\n      };\n      var copyRgbToForm = function (form, rgb) {\n        var red = rgb.red;\n        var green = rgb.green;\n        var blue = rgb.blue;\n        Representing.setValue(form, {\n          red: red,\n          green: green,\n          blue: blue\n        });\n      };\n      var memPreview = record({\n        dom: {\n          tag: 'div',\n          classes: [getClass('rgba-preview')],\n          styles: { 'background-color': 'white' },\n          attributes: { role: 'presentation' }\n        }\n      });\n      var updatePreview = function (anyInSystem, hex) {\n        memPreview.getOpt(anyInSystem).each(function (preview) {\n          set$2(preview.element, 'background-color', '#' + hex.value);\n        });\n      };\n      var factory = function () {\n        var state = {\n          red: Cell(Optional.some(255)),\n          green: Cell(Optional.some(255)),\n          blue: Cell(Optional.some(255)),\n          hex: Cell(Optional.some('ffffff'))\n        };\n        var copyHexToRgb = function (form, hex) {\n          var rgb = fromHex(hex);\n          copyRgbToForm(form, rgb);\n          setValueRgb(rgb);\n        };\n        var get = function (prop) {\n          return state[prop].get();\n        };\n        var set = function (prop, value) {\n          state[prop].set(value);\n        };\n        var getValueRgb = function () {\n          return get('red').bind(function (red) {\n            return get('green').bind(function (green) {\n              return get('blue').map(function (blue) {\n                return rgbaColour(red, green, blue, 1);\n              });\n            });\n          });\n        };\n        var setValueRgb = function (rgb) {\n          var red = rgb.red;\n          var green = rgb.green;\n          var blue = rgb.blue;\n          set('red', Optional.some(red));\n          set('green', Optional.some(green));\n          set('blue', Optional.some(blue));\n        };\n        var onInvalidInput = function (form, simulatedEvent) {\n          var data = simulatedEvent.event;\n          if (data.type !== 'hex') {\n            set(data.type, Optional.none());\n          } else {\n            onInvalidHexx(form);\n          }\n        };\n        var onValidHex = function (form, value) {\n          onValidHexx(form);\n          var hex = hexColour(value);\n          set('hex', Optional.some(value));\n          var rgb = fromHex(hex);\n          copyRgbToForm(form, rgb);\n          setValueRgb(rgb);\n          emitWith(form, fieldsUpdate, { hex: hex });\n          updatePreview(form, hex);\n        };\n        var onValidRgb = function (form, prop, value) {\n          var val = parseInt(value, 10);\n          set(prop, Optional.some(val));\n          getValueRgb().each(function (rgb) {\n            var hex = copyRgbToHex(form, rgb);\n            emitWith(form, fieldsUpdate, { hex: hex });\n            updatePreview(form, hex);\n          });\n        };\n        var isHexInputEvent = function (data) {\n          return data.type === 'hex';\n        };\n        var onValidInput = function (form, simulatedEvent) {\n          var data = simulatedEvent.event;\n          if (isHexInputEvent(data)) {\n            onValidHex(form, data.value);\n          } else {\n            onValidRgb(form, data.type, data.value);\n          }\n        };\n        var formPartStrings = function (key) {\n          return {\n            label: translate(translatePrefix + key + '.label'),\n            description: translate(translatePrefix + key + '.description')\n          };\n        };\n        var redStrings = formPartStrings('red');\n        var greenStrings = formPartStrings('green');\n        var blueStrings = formPartStrings('blue');\n        var hexStrings = formPartStrings('hex');\n        return deepMerge(Form.sketch(function (parts) {\n          return {\n            dom: {\n              tag: 'form',\n              classes: [getClass('rgb-form')],\n              attributes: { 'aria-label': translate('aria.color.picker') }\n            },\n            components: [\n              parts.field('red', FormField.sketch(renderTextField(isRgbaComponent, 'red', redStrings.label, redStrings.description, 255))),\n              parts.field('green', FormField.sketch(renderTextField(isRgbaComponent, 'green', greenStrings.label, greenStrings.description, 255))),\n              parts.field('blue', FormField.sketch(renderTextField(isRgbaComponent, 'blue', blueStrings.label, blueStrings.description, 255))),\n              parts.field('hex', FormField.sketch(renderTextField(isHexString, 'hex', hexStrings.label, hexStrings.description, 'ffffff'))),\n              memPreview.asSpec()\n            ],\n            formBehaviours: derive$1([\n              Invalidating.config({ invalidClass: getClass('form-invalid') }),\n              config('rgb-form-events', [\n                run(validInput, onValidInput),\n                run(invalidInput, onInvalidInput),\n                run(validatingInput, onInvalidInput)\n              ])\n            ])\n          };\n        }), {\n          apis: {\n            updateHex: function (form, hex) {\n              Representing.setValue(form, { hex: hex.value });\n              copyHexToRgb(form, hex);\n              updatePreview(form, hex);\n            }\n          }\n        });\n      };\n      var rgbFormSketcher = single$2({\n        factory: factory,\n        name: 'RgbForm',\n        configFields: [],\n        apis: {\n          updateHex: function (apis, form, hex) {\n            apis.updateHex(form, hex);\n          }\n        },\n        extraApis: {}\n      });\n      return rgbFormSketcher;\n    };\n\n    var paletteFactory = function (_translate, getClass) {\n      var spectrumPart = Slider.parts.spectrum({\n        dom: {\n          tag: 'canvas',\n          attributes: { role: 'presentation' },\n          classes: [getClass('sv-palette-spectrum')]\n        }\n      });\n      var thumbPart = Slider.parts.thumb({\n        dom: {\n          tag: 'div',\n          attributes: { role: 'presentation' },\n          classes: [getClass('sv-palette-thumb')],\n          innerHtml: '<div class=' + getClass('sv-palette-inner-thumb') + ' role=\"presentation\"></div>'\n        }\n      });\n      var setColour = function (canvas, rgba) {\n        var width = canvas.width, height = canvas.height;\n        var ctx = canvas.getContext('2d');\n        if (ctx === null) {\n          return;\n        }\n        ctx.fillStyle = rgba;\n        ctx.fillRect(0, 0, width, height);\n        var grdWhite = ctx.createLinearGradient(0, 0, width, 0);\n        grdWhite.addColorStop(0, 'rgba(255,255,255,1)');\n        grdWhite.addColorStop(1, 'rgba(255,255,255,0)');\n        ctx.fillStyle = grdWhite;\n        ctx.fillRect(0, 0, width, height);\n        var grdBlack = ctx.createLinearGradient(0, 0, 0, height);\n        grdBlack.addColorStop(0, 'rgba(0,0,0,0)');\n        grdBlack.addColorStop(1, 'rgba(0,0,0,1)');\n        ctx.fillStyle = grdBlack;\n        ctx.fillRect(0, 0, width, height);\n      };\n      var setPaletteHue = function (slider, hue) {\n        var canvas = slider.components()[0].element.dom;\n        var hsv = hsvColour(hue, 100, 100);\n        var rgba = fromHsv(hsv);\n        setColour(canvas, toString(rgba));\n      };\n      var setPaletteThumb = function (slider, hex) {\n        var hsv = fromRgb(fromHex(hex));\n        Slider.setValue(slider, {\n          x: hsv.saturation,\n          y: 100 - hsv.value\n        });\n      };\n      var factory = function (_detail) {\n        var getInitialValue = constant({\n          x: 0,\n          y: 0\n        });\n        var onChange = function (slider, _thumb, value) {\n          emitWith(slider, paletteUpdate, { value: value });\n        };\n        var onInit = function (_slider, _thumb, spectrum, _value) {\n          setColour(spectrum.element.dom, toString(red));\n        };\n        var sliderBehaviours = derive$1([\n          Composing.config({ find: Optional.some }),\n          Focusing.config({})\n        ]);\n        return Slider.sketch({\n          dom: {\n            tag: 'div',\n            attributes: { role: 'presentation' },\n            classes: [getClass('sv-palette')]\n          },\n          model: {\n            mode: 'xy',\n            getInitialValue: getInitialValue\n          },\n          rounded: false,\n          components: [\n            spectrumPart,\n            thumbPart\n          ],\n          onChange: onChange,\n          onInit: onInit,\n          sliderBehaviours: sliderBehaviours\n        });\n      };\n      var saturationBrightnessPaletteSketcher = single$2({\n        factory: factory,\n        name: 'SaturationBrightnessPalette',\n        configFields: [],\n        apis: {\n          setHue: function (_apis, slider, hue) {\n            setPaletteHue(slider, hue);\n          },\n          setThumb: function (_apis, slider, hex) {\n            setPaletteThumb(slider, hex);\n          }\n        },\n        extraApis: {}\n      });\n      return saturationBrightnessPaletteSketcher;\n    };\n\n    var makeFactory = function (translate, getClass) {\n      var factory = function (detail) {\n        var rgbForm = rgbFormFactory(translate, getClass, detail.onValidHex, detail.onInvalidHex);\n        var sbPalette = paletteFactory(translate, getClass);\n        var hueSliderToDegrees = function (hue) {\n          return (100 - hue) / 100 * 360;\n        };\n        var hueDegreesToSlider = function (hue) {\n          return 100 - hue / 360 * 100;\n        };\n        var state = {\n          paletteRgba: Cell(red),\n          paletteHue: Cell(0)\n        };\n        var memSlider = record(sliderFactory(translate, getClass));\n        var memPalette = record(sbPalette.sketch({}));\n        var memRgb = record(rgbForm.sketch({}));\n        var updatePalette = function (anyInSystem, _hex, hue) {\n          memPalette.getOpt(anyInSystem).each(function (palette) {\n            sbPalette.setHue(palette, hue);\n          });\n        };\n        var updateFields = function (anyInSystem, hex) {\n          memRgb.getOpt(anyInSystem).each(function (form) {\n            rgbForm.updateHex(form, hex);\n          });\n        };\n        var updateSlider = function (anyInSystem, _hex, hue) {\n          memSlider.getOpt(anyInSystem).each(function (slider) {\n            Slider.setValue(slider, { y: hueDegreesToSlider(hue) });\n          });\n        };\n        var updatePaletteThumb = function (anyInSystem, hex) {\n          memPalette.getOpt(anyInSystem).each(function (palette) {\n            sbPalette.setThumb(palette, hex);\n          });\n        };\n        var updateState = function (hex, hue) {\n          var rgba = fromHex(hex);\n          state.paletteRgba.set(rgba);\n          state.paletteHue.set(hue);\n        };\n        var runUpdates = function (anyInSystem, hex, hue, updates) {\n          updateState(hex, hue);\n          each(updates, function (update) {\n            update(anyInSystem, hex, hue);\n          });\n        };\n        var onPaletteUpdate = function () {\n          var updates = [updateFields];\n          return function (form, simulatedEvent) {\n            var value = simulatedEvent.event.value;\n            var oldHue = state.paletteHue.get();\n            var newHsv = hsvColour(oldHue, value.x, 100 - value.y);\n            var newHex = hsvToHex(newHsv);\n            runUpdates(form, newHex, oldHue, updates);\n          };\n        };\n        var onSliderUpdate = function () {\n          var updates = [\n            updatePalette,\n            updateFields\n          ];\n          return function (form, simulatedEvent) {\n            var hue = hueSliderToDegrees(simulatedEvent.event.value.y);\n            var oldRgb = state.paletteRgba.get();\n            var oldHsv = fromRgb(oldRgb);\n            var newHsv = hsvColour(hue, oldHsv.saturation, oldHsv.value);\n            var newHex = hsvToHex(newHsv);\n            runUpdates(form, newHex, hue, updates);\n          };\n        };\n        var onFieldsUpdate = function () {\n          var updates = [\n            updatePalette,\n            updateSlider,\n            updatePaletteThumb\n          ];\n          return function (form, simulatedEvent) {\n            var hex = simulatedEvent.event.hex;\n            var hsv = hexToHsv(hex);\n            runUpdates(form, hex, hsv.hue, updates);\n          };\n        };\n        return {\n          uid: detail.uid,\n          dom: detail.dom,\n          components: [\n            memPalette.asSpec(),\n            memSlider.asSpec(),\n            memRgb.asSpec()\n          ],\n          behaviours: derive$1([\n            config('colour-picker-events', [\n              run(fieldsUpdate, onFieldsUpdate()),\n              run(paletteUpdate, onPaletteUpdate()),\n              run(sliderUpdate, onSliderUpdate())\n            ]),\n            Composing.config({\n              find: function (comp) {\n                return memRgb.getOpt(comp);\n              }\n            }),\n            Keying.config({ mode: 'acyclic' })\n          ])\n        };\n      };\n      var colourPickerSketcher = single$2({\n        name: 'ColourPicker',\n        configFields: [\n          strict$1('dom'),\n          defaulted$1('onValidHex', noop),\n          defaulted$1('onInvalidHex', noop)\n        ],\n        factory: factory\n      });\n      return colourPickerSketcher;\n    };\n\n    var self$1 = function () {\n      return Composing.config({ find: Optional.some });\n    };\n    var memento = function (mem) {\n      return Composing.config({ find: mem.getOpt });\n    };\n    var childAt = function (index) {\n      return Composing.config({\n        find: function (comp) {\n          return child(comp.element, index).bind(function (element) {\n            return comp.getSystem().getByDom(element).toOptional();\n          });\n        }\n      });\n    };\n    var ComposingConfigs = {\n      self: self$1,\n      memento: memento,\n      childAt: childAt\n    };\n\n    var english = {\n      'colorcustom.rgb.red.label': 'R',\n      'colorcustom.rgb.red.description': 'Red component',\n      'colorcustom.rgb.green.label': 'G',\n      'colorcustom.rgb.green.description': 'Green component',\n      'colorcustom.rgb.blue.label': 'B',\n      'colorcustom.rgb.blue.description': 'Blue component',\n      'colorcustom.rgb.hex.label': '#',\n      'colorcustom.rgb.hex.description': 'Hex color code',\n      'colorcustom.rgb.range': 'Range 0 to 255',\n      'colorcustom.sb.saturation': 'Saturation',\n      'colorcustom.sb.brightness': 'Brightness',\n      'colorcustom.sb.picker': 'Saturation and Brightness Picker',\n      'colorcustom.sb.palette': 'Saturation and Brightness Palette',\n      'colorcustom.sb.instructions': 'Use arrow keys to select saturation and brightness, on x and y axes',\n      'colorcustom.hue.hue': 'Hue',\n      'colorcustom.hue.slider': 'Hue Slider',\n      'colorcustom.hue.palette': 'Hue Palette',\n      'colorcustom.hue.instructions': 'Use arrow keys to select a hue',\n      'aria.color.picker': 'Color Picker',\n      'aria.input.invalid': 'Invalid input'\n    };\n    var getEnglishText = function (key) {\n      return english[key];\n    };\n    var translate$1 = function (key) {\n      return getEnglishText(key);\n    };\n    var renderColorPicker = function (_spec) {\n      var getClass = function (key) {\n        return 'tox-' + key;\n      };\n      var colourPickerFactory = makeFactory(translate$1, getClass);\n      var onValidHex = function (form) {\n        emitWith(form, formActionEvent, {\n          name: 'hex-valid',\n          value: true\n        });\n      };\n      var onInvalidHex = function (form) {\n        emitWith(form, formActionEvent, {\n          name: 'hex-valid',\n          value: false\n        });\n      };\n      var memPicker = record(colourPickerFactory.sketch({\n        dom: {\n          tag: 'div',\n          classes: [getClass('color-picker-container')],\n          attributes: { role: 'presentation' }\n        },\n        onValidHex: onValidHex,\n        onInvalidHex: onInvalidHex\n      }));\n      return {\n        dom: { tag: 'div' },\n        components: [memPicker.asSpec()],\n        behaviours: derive$1([\n          Representing.config({\n            store: {\n              mode: 'manual',\n              getValue: function (comp) {\n                var picker = memPicker.get(comp);\n                var optRgbForm = Composing.getCurrent(picker);\n                var optHex = optRgbForm.bind(function (rgbForm) {\n                  var formValues = Representing.getValue(rgbForm);\n                  return formValues.hex;\n                });\n                return optHex.map(function (hex) {\n                  return '#' + hex;\n                }).getOr('');\n              },\n              setValue: function (comp, newValue) {\n                var pattern = /^#([a-fA-F0-9]{3}(?:[a-fA-F0-9]{3})?)/;\n                var m = pattern.exec(newValue);\n                var picker = memPicker.get(comp);\n                var optRgbForm = Composing.getCurrent(picker);\n                optRgbForm.fold(function () {\n                  console.log('Can not find form');\n                }, function (rgbForm) {\n                  Representing.setValue(rgbForm, { hex: Optional.from(m[1]).getOr('') });\n                  Form.getField(rgbForm, 'hex').each(function (hexField) {\n                    emit(hexField, input());\n                  });\n                });\n              }\n            }\n          }),\n          ComposingConfigs.self()\n        ])\n      };\n    };\n\n    var global$b = tinymce.util.Tools.resolve('tinymce.Resource');\n\n    var isOldCustomEditor = function (spec) {\n      return Object.prototype.hasOwnProperty.call(spec, 'init');\n    };\n    var renderCustomEditor = function (spec) {\n      var editorApi = Cell(Optional.none());\n      var memReplaced = record({ dom: { tag: spec.tag } });\n      var initialValue = Cell(Optional.none());\n      return {\n        dom: {\n          tag: 'div',\n          classes: ['tox-custom-editor']\n        },\n        behaviours: derive$1([\n          config('custom-editor-events', [runOnAttached(function (component) {\n              memReplaced.getOpt(component).each(function (ta) {\n                (isOldCustomEditor(spec) ? spec.init(ta.element.dom) : global$b.load(spec.scriptId, spec.scriptUrl).then(function (init) {\n                  return init(ta.element.dom, spec.settings);\n                })).then(function (ea) {\n                  initialValue.get().each(function (cvalue) {\n                    ea.setValue(cvalue);\n                  });\n                  initialValue.set(Optional.none());\n                  editorApi.set(Optional.some(ea));\n                });\n              });\n            })]),\n          Representing.config({\n            store: {\n              mode: 'manual',\n              getValue: function () {\n                return editorApi.get().fold(function () {\n                  return initialValue.get().getOr('');\n                }, function (ed) {\n                  return ed.getValue();\n                });\n              },\n              setValue: function (component, value) {\n                editorApi.get().fold(function () {\n                  initialValue.set(Optional.some(value));\n                }, function (ed) {\n                  return ed.setValue(value);\n                });\n              }\n            }\n          }),\n          ComposingConfigs.self()\n        ]),\n        components: [memReplaced.asSpec()]\n      };\n    };\n\n    var global$c = tinymce.util.Tools.resolve('tinymce.util.Tools');\n\n    var processors = objOf([\n      defaulted$1('preprocess', identity),\n      defaulted$1('postprocess', identity)\n    ]);\n    var memento$1 = function (mem, rawProcessors) {\n      var ps = asRawOrDie('RepresentingConfigs.memento processors', processors, rawProcessors);\n      return Representing.config({\n        store: {\n          mode: 'manual',\n          getValue: function (comp) {\n            var other = mem.get(comp);\n            var rawValue = Representing.getValue(other);\n            return ps.postprocess(rawValue);\n          },\n          setValue: function (comp, rawValue) {\n            var newValue = ps.preprocess(rawValue);\n            var other = mem.get(comp);\n            Representing.setValue(other, newValue);\n          }\n        }\n      });\n    };\n    var withComp = function (optInitialValue, getter, setter) {\n      return Representing.config(deepMerge({\n        store: {\n          mode: 'manual',\n          getValue: getter,\n          setValue: setter\n        }\n      }, optInitialValue.map(function (initialValue) {\n        return { store: { initialValue: initialValue } };\n      }).getOr({})));\n    };\n    var withElement = function (initialValue, getter, setter) {\n      return withComp(initialValue, function (c) {\n        return getter(c.element);\n      }, function (c, v) {\n        return setter(c.element, v);\n      });\n    };\n    var domValue = function (optInitialValue) {\n      return withElement(optInitialValue, get$6, set$3);\n    };\n    var domHtml = function (optInitialValue) {\n      return withElement(optInitialValue, get$2, set);\n    };\n    var memory$1 = function (initialValue) {\n      return Representing.config({\n        store: {\n          mode: 'memory',\n          initialValue: initialValue\n        }\n      });\n    };\n    var RepresentingConfigs = {\n      memento: memento$1,\n      withElement: withElement,\n      withComp: withComp,\n      domValue: domValue,\n      domHtml: domHtml,\n      memory: memory$1\n    };\n\n    var defaultImageFileTypes = 'jpeg,jpg,jpe,jfi,jif,jfif,png,gif,bmp,webp';\n    var filterByExtension = function (files, providersBackstage) {\n      var allowedImageFileTypes = global$c.explode(providersBackstage.getSetting('images_file_types', defaultImageFileTypes, 'string'));\n      var isFileInAllowedTypes = function (file) {\n        return exists(allowedImageFileTypes, function (type) {\n          return endsWith(file.name.toLowerCase(), '.' + type.toLowerCase());\n        });\n      };\n      return filter(from$1(files), isFileInAllowedTypes);\n    };\n    var renderDropZone = function (spec, providersBackstage) {\n      var stopper = function (_, se) {\n        se.stop();\n      };\n      var sequence = function (actions) {\n        return function (comp, se) {\n          each(actions, function (a) {\n            a(comp, se);\n          });\n        };\n      };\n      var onDrop = function (comp, se) {\n        if (!Disabling.isDisabled(comp)) {\n          var transferEvent = se.event.raw;\n          handleFiles(comp, transferEvent.dataTransfer.files);\n        }\n      };\n      var onSelect = function (component, simulatedEvent) {\n        var input = simulatedEvent.event.raw.target;\n        handleFiles(component, input.files);\n      };\n      var handleFiles = function (component, files) {\n        Representing.setValue(component, filterByExtension(files, providersBackstage));\n        emitWith(component, formChangeEvent, { name: spec.name });\n      };\n      var memInput = record({\n        dom: {\n          tag: 'input',\n          attributes: {\n            type: 'file',\n            accept: 'image/*'\n          },\n          styles: { display: 'none' }\n        },\n        behaviours: derive$1([config('input-file-events', [\n            cutter(click()),\n            cutter(tap())\n          ])])\n      });\n      var renderField = function (s) {\n        return {\n          uid: s.uid,\n          dom: {\n            tag: 'div',\n            classes: ['tox-dropzone-container']\n          },\n          behaviours: derive$1([\n            RepresentingConfigs.memory([]),\n            ComposingConfigs.self(),\n            Disabling.config({}),\n            Toggling.config({\n              toggleClass: 'dragenter',\n              toggleOnExecute: false\n            }),\n            config('dropzone-events', [\n              run('dragenter', sequence([\n                stopper,\n                Toggling.toggle\n              ])),\n              run('dragleave', sequence([\n                stopper,\n                Toggling.toggle\n              ])),\n              run('dragover', stopper),\n              run('drop', sequence([\n                stopper,\n                onDrop\n              ])),\n              run(change(), onSelect)\n            ])\n          ]),\n          components: [{\n              dom: {\n                tag: 'div',\n                classes: ['tox-dropzone'],\n                styles: {}\n              },\n              components: [\n                {\n                  dom: {\n                    tag: 'p',\n                    innerHtml: providersBackstage.translate('Drop an image here')\n                  }\n                },\n                Button.sketch({\n                  dom: {\n                    tag: 'button',\n                    innerHtml: providersBackstage.translate('Browse for an image'),\n                    styles: { position: 'relative' },\n                    classes: [\n                      'tox-button',\n                      'tox-button--secondary'\n                    ]\n                  },\n                  components: [memInput.asSpec()],\n                  action: function (comp) {\n                    var inputComp = memInput.get(comp);\n                    inputComp.element.dom.click();\n                  },\n                  buttonBehaviours: derive$1([\n                    Tabstopping.config({}),\n                    DisablingConfigs.button(providersBackstage.isDisabled),\n                    receivingConfig()\n                  ])\n                })\n              ]\n            }]\n        };\n      };\n      var pLabel = spec.label.map(function (label) {\n        return renderLabel(label, providersBackstage);\n      });\n      var pField = FormField.parts.field({ factory: { sketch: renderField } });\n      return renderFormFieldWith(pLabel, pField, ['tox-form__group--stretched'], []);\n    };\n\n    var renderGrid = function (spec, backstage) {\n      return {\n        dom: {\n          tag: 'div',\n          classes: [\n            'tox-form__grid',\n            'tox-form__grid--' + spec.columns + 'col'\n          ]\n        },\n        components: map(spec.items, backstage.interpreter)\n      };\n    };\n\n    var beforeObject = generate$1('alloy-fake-before-tabstop');\n    var afterObject = generate$1('alloy-fake-after-tabstop');\n    var craftWithClasses = function (classes) {\n      return {\n        dom: {\n          tag: 'div',\n          styles: {\n            width: '1px',\n            height: '1px',\n            outline: 'none'\n          },\n          attributes: { tabindex: '0' },\n          classes: classes\n        },\n        behaviours: derive$1([\n          Focusing.config({ ignore: true }),\n          Tabstopping.config({})\n        ])\n      };\n    };\n    var craft = function (spec) {\n      return {\n        dom: {\n          tag: 'div',\n          classes: ['tox-navobj']\n        },\n        components: [\n          craftWithClasses([beforeObject]),\n          spec,\n          craftWithClasses([afterObject])\n        ],\n        behaviours: derive$1([ComposingConfigs.childAt(1)])\n      };\n    };\n    var triggerTab = function (placeholder, shiftKey) {\n      emitWith(placeholder, keydown(), {\n        raw: {\n          which: 9,\n          shiftKey: shiftKey\n        }\n      });\n    };\n    var onFocus$1 = function (container, targetComp) {\n      var target = targetComp.element;\n      if (has$2(target, beforeObject)) {\n        triggerTab(container, true);\n      } else if (has$2(target, afterObject)) {\n        triggerTab(container, false);\n      }\n    };\n    var isPseudoStop = function (element) {\n      return closest$4(element, [\n        '.' + beforeObject,\n        '.' + afterObject\n      ].join(','), never);\n    };\n\n    var platformNeedsSandboxing = !(detect$3().browser.isIE() || detect$3().browser.isEdge());\n    var getDynamicSource = function (isSandbox) {\n      var cachedValue = Cell('');\n      return {\n        getValue: function (_frameComponent) {\n          return cachedValue.get();\n        },\n        setValue: function (frameComponent, html) {\n          if (!isSandbox) {\n            set$1(frameComponent.element, 'src', 'javascript:\\'\\'');\n            var doc = frameComponent.element.dom.contentWindow.document;\n            doc.open();\n            doc.write(html);\n            doc.close();\n          } else {\n            set$1(frameComponent.element, 'srcdoc', html);\n          }\n          cachedValue.set(html);\n        }\n      };\n    };\n    var renderIFrame = function (spec, providersBackstage) {\n      var isSandbox = platformNeedsSandboxing && spec.sandboxed;\n      var attributes = __assign(__assign({}, spec.label.map(function (title) {\n        return { title: title };\n      }).getOr({})), isSandbox ? { sandbox: 'allow-scripts allow-same-origin' } : {});\n      var sourcing = getDynamicSource(isSandbox);\n      var pLabel = spec.label.map(function (label) {\n        return renderLabel(label, providersBackstage);\n      });\n      var factory = function (newSpec) {\n        return craft({\n          uid: newSpec.uid,\n          dom: {\n            tag: 'iframe',\n            attributes: attributes\n          },\n          behaviours: derive$1([\n            Tabstopping.config({}),\n            Focusing.config({}),\n            RepresentingConfigs.withComp(Optional.none(), sourcing.getValue, sourcing.setValue)\n          ])\n        });\n      };\n      var pField = FormField.parts.field({ factory: { sketch: factory } });\n      return renderFormFieldWith(pLabel, pField, ['tox-form__group--stretched'], []);\n    };\n\n    var create$5 = function (width, height) {\n      return resize(document.createElement('canvas'), width, height);\n    };\n    var clone$1 = function (canvas) {\n      var tCanvas = create$5(canvas.width, canvas.height);\n      var ctx = get2dContext(tCanvas);\n      ctx.drawImage(canvas, 0, 0);\n      return tCanvas;\n    };\n    var get2dContext = function (canvas) {\n      return canvas.getContext('2d');\n    };\n    var resize = function (canvas, width, height) {\n      canvas.width = width;\n      canvas.height = height;\n      return canvas;\n    };\n\n    var getWidth = function (image) {\n      return image.naturalWidth || image.width;\n    };\n    var getHeight = function (image) {\n      return image.naturalHeight || image.height;\n    };\n\n    var promise = function () {\n      var Promise = function (fn) {\n        if (typeof this !== 'object') {\n          throw new TypeError('Promises must be constructed via new');\n        }\n        if (typeof fn !== 'function') {\n          throw new TypeError('not a function');\n        }\n        this._state = null;\n        this._value = null;\n        this._deferreds = [];\n        doResolve(fn, bind(resolve, this), bind(reject, this));\n      };\n      var anyWindow = window;\n      var asap = Promise.immediateFn || typeof anyWindow.setImmediate === 'function' && anyWindow.setImmediate || function (fn) {\n        return setTimeout(fn, 1);\n      };\n      var bind = function (fn, thisArg) {\n        return function () {\n          var args = [];\n          for (var _i = 0; _i < arguments.length; _i++) {\n            args[_i] = arguments[_i];\n          }\n          return fn.apply(thisArg, args);\n        };\n      };\n      var isArray = Array.isArray || function (value) {\n        return Object.prototype.toString.call(value) === '[object Array]';\n      };\n      function handle(deferred) {\n        var me = this;\n        if (this._state === null) {\n          this._deferreds.push(deferred);\n          return;\n        }\n        asap(function () {\n          var cb = me._state ? deferred.onFulfilled : deferred.onRejected;\n          if (cb === null) {\n            (me._state ? deferred.resolve : deferred.reject)(me._value);\n            return;\n          }\n          var ret;\n          try {\n            ret = cb(me._value);\n          } catch (e) {\n            deferred.reject(e);\n            return;\n          }\n          deferred.resolve(ret);\n        });\n      }\n      function resolve(newValue) {\n        try {\n          if (newValue === this) {\n            throw new TypeError('A promise cannot be resolved with itself.');\n          }\n          if (newValue && (typeof newValue === 'object' || typeof newValue === 'function')) {\n            var then = newValue.then;\n            if (typeof then === 'function') {\n              doResolve(bind(then, newValue), bind(resolve, this), bind(reject, this));\n              return;\n            }\n          }\n          this._state = true;\n          this._value = newValue;\n          finale.call(this);\n        } catch (e) {\n          reject.call(this, e);\n        }\n      }\n      function reject(newValue) {\n        this._state = false;\n        this._value = newValue;\n        finale.call(this);\n      }\n      function finale() {\n        for (var _i = 0, _a = this._deferreds; _i < _a.length; _i++) {\n          var deferred = _a[_i];\n          handle.call(this, deferred);\n        }\n        this._deferreds = [];\n      }\n      function Handler(onFulfilled, onRejected, resolve, reject) {\n        this.onFulfilled = typeof onFulfilled === 'function' ? onFulfilled : null;\n        this.onRejected = typeof onRejected === 'function' ? onRejected : null;\n        this.resolve = resolve;\n        this.reject = reject;\n      }\n      var doResolve = function (fn, onFulfilled, onRejected) {\n        var done = false;\n        try {\n          fn(function (value) {\n            if (done) {\n              return;\n            }\n            done = true;\n            onFulfilled(value);\n          }, function (reason) {\n            if (done) {\n              return;\n            }\n            done = true;\n            onRejected(reason);\n          });\n        } catch (ex) {\n          if (done) {\n            return;\n          }\n          done = true;\n          onRejected(ex);\n        }\n      };\n      Promise.prototype.catch = function (onRejected) {\n        return this.then(null, onRejected);\n      };\n      Promise.prototype.then = function (onFulfilled, onRejected) {\n        var me = this;\n        return new Promise(function (resolve, reject) {\n          handle.call(me, new Handler(onFulfilled, onRejected, resolve, reject));\n        });\n      };\n      Promise.all = function () {\n        var values = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n          values[_i] = arguments[_i];\n        }\n        var args = Array.prototype.slice.call(values.length === 1 && isArray(values[0]) ? values[0] : values);\n        return new Promise(function (resolve, reject) {\n          if (args.length === 0) {\n            return resolve([]);\n          }\n          var remaining = args.length;\n          var res = function (i, val) {\n            try {\n              if (val && (typeof val === 'object' || typeof val === 'function')) {\n                var then = val.then;\n                if (typeof then === 'function') {\n                  then.call(val, function (val) {\n                    res(i, val);\n                  }, reject);\n                  return;\n                }\n              }\n              args[i] = val;\n              if (--remaining === 0) {\n                resolve(args);\n              }\n            } catch (ex) {\n              reject(ex);\n            }\n          };\n          for (var i = 0; i < args.length; i++) {\n            res(i, args[i]);\n          }\n        });\n      };\n      Promise.resolve = function (value) {\n        if (value && typeof value === 'object' && value.constructor === Promise) {\n          return value;\n        }\n        return new Promise(function (resolve) {\n          resolve(value);\n        });\n      };\n      Promise.reject = function (reason) {\n        return new Promise(function (resolve, reject) {\n          reject(reason);\n        });\n      };\n      Promise.race = function (values) {\n        return new Promise(function (resolve, reject) {\n          for (var _i = 0, values_1 = values; _i < values_1.length; _i++) {\n            var value = values_1[_i];\n            value.then(resolve, reject);\n          }\n        });\n      };\n      return Promise;\n    };\n    var Promise$1 = window.Promise ? window.Promise : promise();\n\n    var blobToImage = function (blob) {\n      return new Promise$1(function (resolve, reject) {\n        var blobUrl = URL.createObjectURL(blob);\n        var image = new Image();\n        var removeListeners = function () {\n          image.removeEventListener('load', loaded);\n          image.removeEventListener('error', error);\n        };\n        var loaded = function () {\n          removeListeners();\n          resolve(image);\n        };\n        var error = function () {\n          removeListeners();\n          reject('Unable to load data of type ' + blob.type + ': ' + blobUrl);\n        };\n        image.addEventListener('load', loaded);\n        image.addEventListener('error', error);\n        image.src = blobUrl;\n        if (image.complete) {\n          setTimeout(loaded, 0);\n        }\n      });\n    };\n    var dataUriToBlobSync = function (uri) {\n      var data = uri.split(',');\n      var matches = /data:([^;]+)/.exec(data[0]);\n      if (!matches) {\n        return Optional.none();\n      }\n      var mimetype = matches[1];\n      var base64 = data[1];\n      var sliceSize = 1024;\n      var byteCharacters = atob(base64);\n      var bytesLength = byteCharacters.length;\n      var slicesCount = Math.ceil(bytesLength / sliceSize);\n      var byteArrays = new Array(slicesCount);\n      for (var sliceIndex = 0; sliceIndex < slicesCount; ++sliceIndex) {\n        var begin = sliceIndex * sliceSize;\n        var end = Math.min(begin + sliceSize, bytesLength);\n        var bytes = new Array(end - begin);\n        for (var offset = begin, i = 0; offset < end; ++i, ++offset) {\n          bytes[i] = byteCharacters[offset].charCodeAt(0);\n        }\n        byteArrays[sliceIndex] = new Uint8Array(bytes);\n      }\n      return Optional.some(new Blob(byteArrays, { type: mimetype }));\n    };\n    var dataUriToBlob = function (uri) {\n      return new Promise$1(function (resolve, reject) {\n        dataUriToBlobSync(uri).fold(function () {\n          reject('uri is not base64: ' + uri);\n        }, resolve);\n      });\n    };\n    var canvasToBlob = function (canvas, type, quality) {\n      type = type || 'image/png';\n      if (isFunction(HTMLCanvasElement.prototype.toBlob)) {\n        return new Promise$1(function (resolve, reject) {\n          canvas.toBlob(function (blob) {\n            if (blob) {\n              resolve(blob);\n            } else {\n              reject();\n            }\n          }, type, quality);\n        });\n      } else {\n        return dataUriToBlob(canvas.toDataURL(type, quality));\n      }\n    };\n    var canvasToDataURL = function (canvas, type, quality) {\n      type = type || 'image/png';\n      return canvas.toDataURL(type, quality);\n    };\n    var blobToCanvas = function (blob) {\n      return blobToImage(blob).then(function (image) {\n        revokeImageUrl(image);\n        var canvas = create$5(getWidth(image), getHeight(image));\n        var context = get2dContext(canvas);\n        context.drawImage(image, 0, 0);\n        return canvas;\n      });\n    };\n    var blobToDataUri = function (blob) {\n      return new Promise$1(function (resolve) {\n        var reader = new FileReader();\n        reader.onloadend = function () {\n          resolve(reader.result);\n        };\n        reader.readAsDataURL(blob);\n      });\n    };\n    var revokeImageUrl = function (image) {\n      URL.revokeObjectURL(image.src);\n    };\n\n    var create$6 = function (getCanvas, blob, uri) {\n      var initialType = blob.type;\n      var getType = constant(initialType);\n      var toBlob = function () {\n        return Promise$1.resolve(blob);\n      };\n      var toDataURL = constant(uri);\n      var toBase64 = function () {\n        return uri.split(',')[1];\n      };\n      var toAdjustedBlob = function (type, quality) {\n        return getCanvas.then(function (canvas) {\n          return canvasToBlob(canvas, type, quality);\n        });\n      };\n      var toAdjustedDataURL = function (type, quality) {\n        return getCanvas.then(function (canvas) {\n          return canvasToDataURL(canvas, type, quality);\n        });\n      };\n      var toAdjustedBase64 = function (type, quality) {\n        return toAdjustedDataURL(type, quality).then(function (dataurl) {\n          return dataurl.split(',')[1];\n        });\n      };\n      var toCanvas = function () {\n        return getCanvas.then(clone$1);\n      };\n      return {\n        getType: getType,\n        toBlob: toBlob,\n        toDataURL: toDataURL,\n        toBase64: toBase64,\n        toAdjustedBlob: toAdjustedBlob,\n        toAdjustedDataURL: toAdjustedDataURL,\n        toAdjustedBase64: toAdjustedBase64,\n        toCanvas: toCanvas\n      };\n    };\n    var fromBlob = function (blob) {\n      return blobToDataUri(blob).then(function (uri) {\n        return create$6(blobToCanvas(blob), blob, uri);\n      });\n    };\n    var fromCanvas = function (canvas, type) {\n      return canvasToBlob(canvas, type).then(function (blob) {\n        return create$6(Promise$1.resolve(canvas), blob, canvas.toDataURL());\n      });\n    };\n\n    var blobToImageResult = function (blob) {\n      return fromBlob(blob);\n    };\n\n    var clamp$1 = function (value, min, max) {\n      var parsedValue = typeof value === 'string' ? parseFloat(value) : value;\n      if (parsedValue > max) {\n        parsedValue = max;\n      } else if (parsedValue < min) {\n        parsedValue = min;\n      }\n      return parsedValue;\n    };\n    var identity$1 = function () {\n      return [\n        1,\n        0,\n        0,\n        0,\n        0,\n        0,\n        1,\n        0,\n        0,\n        0,\n        0,\n        0,\n        1,\n        0,\n        0,\n        0,\n        0,\n        0,\n        1,\n        0,\n        0,\n        0,\n        0,\n        0,\n        1\n      ];\n    };\n    var DELTA_INDEX = [\n      0,\n      0.01,\n      0.02,\n      0.04,\n      0.05,\n      0.06,\n      0.07,\n      0.08,\n      0.1,\n      0.11,\n      0.12,\n      0.14,\n      0.15,\n      0.16,\n      0.17,\n      0.18,\n      0.2,\n      0.21,\n      0.22,\n      0.24,\n      0.25,\n      0.27,\n      0.28,\n      0.3,\n      0.32,\n      0.34,\n      0.36,\n      0.38,\n      0.4,\n      0.42,\n      0.44,\n      0.46,\n      0.48,\n      0.5,\n      0.53,\n      0.56,\n      0.59,\n      0.62,\n      0.65,\n      0.68,\n      0.71,\n      0.74,\n      0.77,\n      0.8,\n      0.83,\n      0.86,\n      0.89,\n      0.92,\n      0.95,\n      0.98,\n      1,\n      1.06,\n      1.12,\n      1.18,\n      1.24,\n      1.3,\n      1.36,\n      1.42,\n      1.48,\n      1.54,\n      1.6,\n      1.66,\n      1.72,\n      1.78,\n      1.84,\n      1.9,\n      1.96,\n      2,\n      2.12,\n      2.25,\n      2.37,\n      2.5,\n      2.62,\n      2.75,\n      2.87,\n      3,\n      3.2,\n      3.4,\n      3.6,\n      3.8,\n      4,\n      4.3,\n      4.7,\n      4.9,\n      5,\n      5.5,\n      6,\n      6.5,\n      6.8,\n      7,\n      7.3,\n      7.5,\n      7.8,\n      8,\n      8.4,\n      8.7,\n      9,\n      9.4,\n      9.6,\n      9.8,\n      10\n    ];\n    var multiply = function (matrix1, matrix2) {\n      var col = [];\n      var out = new Array(25);\n      var val;\n      for (var i = 0; i < 5; i++) {\n        for (var j = 0; j < 5; j++) {\n          col[j] = matrix2[j + i * 5];\n        }\n        for (var j = 0; j < 5; j++) {\n          val = 0;\n          for (var k = 0; k < 5; k++) {\n            val += matrix1[j + k * 5] * col[k];\n          }\n          out[j + i * 5] = val;\n        }\n      }\n      return out;\n    };\n    var adjustContrast = function (matrix, value) {\n      var x;\n      value = clamp$1(value, -1, 1);\n      value *= 100;\n      if (value < 0) {\n        x = 127 + value / 100 * 127;\n      } else {\n        x = value % 1;\n        if (x === 0) {\n          x = DELTA_INDEX[value];\n        } else {\n          x = DELTA_INDEX[Math.floor(value)] * (1 - x) + DELTA_INDEX[Math.floor(value) + 1] * x;\n        }\n        x = x * 127 + 127;\n      }\n      return multiply(matrix, [\n        x / 127,\n        0,\n        0,\n        0,\n        0.5 * (127 - x),\n        0,\n        x / 127,\n        0,\n        0,\n        0.5 * (127 - x),\n        0,\n        0,\n        x / 127,\n        0,\n        0.5 * (127 - x),\n        0,\n        0,\n        0,\n        1,\n        0,\n        0,\n        0,\n        0,\n        0,\n        1\n      ]);\n    };\n    var adjustBrightness = function (matrix, value) {\n      value = clamp$1(255 * value, -255, 255);\n      return multiply(matrix, [\n        1,\n        0,\n        0,\n        0,\n        value,\n        0,\n        1,\n        0,\n        0,\n        value,\n        0,\n        0,\n        1,\n        0,\n        value,\n        0,\n        0,\n        0,\n        1,\n        0,\n        0,\n        0,\n        0,\n        0,\n        1\n      ]);\n    };\n    var adjustColors = function (matrix, adjustR, adjustG, adjustB) {\n      adjustR = clamp$1(adjustR, 0, 2);\n      adjustG = clamp$1(adjustG, 0, 2);\n      adjustB = clamp$1(adjustB, 0, 2);\n      return multiply(matrix, [\n        adjustR,\n        0,\n        0,\n        0,\n        0,\n        0,\n        adjustG,\n        0,\n        0,\n        0,\n        0,\n        0,\n        adjustB,\n        0,\n        0,\n        0,\n        0,\n        0,\n        1,\n        0,\n        0,\n        0,\n        0,\n        0,\n        1\n      ]);\n    };\n\n    var colorFilter = function (ir, matrix) {\n      return ir.toCanvas().then(function (canvas) {\n        return applyColorFilter(canvas, ir.getType(), matrix);\n      });\n    };\n    var applyColorFilter = function (canvas, type, matrix) {\n      var context = get2dContext(canvas);\n      var applyMatrix = function (pixelsData, m) {\n        var r, g, b, a;\n        var data = pixelsData.data, m0 = m[0], m1 = m[1], m2 = m[2], m3 = m[3], m4 = m[4], m5 = m[5], m6 = m[6], m7 = m[7], m8 = m[8], m9 = m[9], m10 = m[10], m11 = m[11], m12 = m[12], m13 = m[13], m14 = m[14], m15 = m[15], m16 = m[16], m17 = m[17], m18 = m[18], m19 = m[19];\n        for (var i = 0; i < data.length; i += 4) {\n          r = data[i];\n          g = data[i + 1];\n          b = data[i + 2];\n          a = data[i + 3];\n          data[i] = r * m0 + g * m1 + b * m2 + a * m3 + m4;\n          data[i + 1] = r * m5 + g * m6 + b * m7 + a * m8 + m9;\n          data[i + 2] = r * m10 + g * m11 + b * m12 + a * m13 + m14;\n          data[i + 3] = r * m15 + g * m16 + b * m17 + a * m18 + m19;\n        }\n        return pixelsData;\n      };\n      var pixels = applyMatrix(context.getImageData(0, 0, canvas.width, canvas.height), matrix);\n      context.putImageData(pixels, 0, 0);\n      return fromCanvas(canvas, type);\n    };\n    var convoluteFilter = function (ir, matrix) {\n      return ir.toCanvas().then(function (canvas) {\n        return applyConvoluteFilter(canvas, ir.getType(), matrix);\n      });\n    };\n    var applyConvoluteFilter = function (canvas, type, matrix) {\n      var context = get2dContext(canvas);\n      var applyMatrix = function (pIn, pOut, aMatrix) {\n        var clamp = function (value, min, max) {\n          if (value > max) {\n            value = max;\n          } else if (value < min) {\n            value = min;\n          }\n          return value;\n        };\n        var side = Math.round(Math.sqrt(aMatrix.length));\n        var halfSide = Math.floor(side / 2);\n        var rgba = pIn.data;\n        var drgba = pOut.data;\n        var w = pIn.width;\n        var h = pIn.height;\n        for (var y = 0; y < h; y++) {\n          for (var x = 0; x < w; x++) {\n            var r = 0;\n            var g = 0;\n            var b = 0;\n            for (var cy = 0; cy < side; cy++) {\n              for (var cx = 0; cx < side; cx++) {\n                var scx = clamp(x + cx - halfSide, 0, w - 1);\n                var scy = clamp(y + cy - halfSide, 0, h - 1);\n                var innerOffset = (scy * w + scx) * 4;\n                var wt = aMatrix[cy * side + cx];\n                r += rgba[innerOffset] * wt;\n                g += rgba[innerOffset + 1] * wt;\n                b += rgba[innerOffset + 2] * wt;\n              }\n            }\n            var offset = (y * w + x) * 4;\n            drgba[offset] = clamp(r, 0, 255);\n            drgba[offset + 1] = clamp(g, 0, 255);\n            drgba[offset + 2] = clamp(b, 0, 255);\n          }\n        }\n        return pOut;\n      };\n      var pixelsIn = context.getImageData(0, 0, canvas.width, canvas.height);\n      var pixelsOut = context.getImageData(0, 0, canvas.width, canvas.height);\n      pixelsOut = applyMatrix(pixelsIn, pixelsOut, matrix);\n      context.putImageData(pixelsOut, 0, 0);\n      return fromCanvas(canvas, type);\n    };\n    var functionColorFilter = function (colorFn) {\n      var filterImpl = function (canvas, type, value) {\n        var context = get2dContext(canvas);\n        var lookup = new Array(256);\n        var applyLookup = function (pixelsData, lookupData) {\n          var data = pixelsData.data;\n          for (var i = 0; i < data.length; i += 4) {\n            data[i] = lookupData[data[i]];\n            data[i + 1] = lookupData[data[i + 1]];\n            data[i + 2] = lookupData[data[i + 2]];\n          }\n          return pixelsData;\n        };\n        for (var i = 0; i < lookup.length; i++) {\n          lookup[i] = colorFn(i, value);\n        }\n        var pixels = applyLookup(context.getImageData(0, 0, canvas.width, canvas.height), lookup);\n        context.putImageData(pixels, 0, 0);\n        return fromCanvas(canvas, type);\n      };\n      return function (ir, value) {\n        return ir.toCanvas().then(function (canvas) {\n          return filterImpl(canvas, ir.getType(), value);\n        });\n      };\n    };\n    var complexAdjustableColorFilter = function (matrixAdjustFn) {\n      return function (ir, adjust) {\n        return colorFilter(ir, matrixAdjustFn(identity$1(), adjust));\n      };\n    };\n    var basicColorFilter = function (matrix) {\n      return function (ir) {\n        return colorFilter(ir, matrix);\n      };\n    };\n    var basicConvolutionFilter = function (kernel) {\n      return function (ir) {\n        return convoluteFilter(ir, kernel);\n      };\n    };\n    var invert = basicColorFilter([\n      -1,\n      0,\n      0,\n      0,\n      255,\n      0,\n      -1,\n      0,\n      0,\n      255,\n      0,\n      0,\n      -1,\n      0,\n      255,\n      0,\n      0,\n      0,\n      1,\n      0,\n      0,\n      0,\n      0,\n      0,\n      1\n    ]);\n    var brightness = complexAdjustableColorFilter(adjustBrightness);\n    var contrast = complexAdjustableColorFilter(adjustContrast);\n    var colorize = function (ir, adjustR, adjustG, adjustB) {\n      return colorFilter(ir, adjustColors(identity$1(), adjustR, adjustG, adjustB));\n    };\n    var sharpen = basicConvolutionFilter([\n      0,\n      -1,\n      0,\n      -1,\n      5,\n      -1,\n      0,\n      -1,\n      0\n    ]);\n    var gamma = functionColorFilter(function (color, value) {\n      return Math.pow(color / 255, 1 - value) * 255;\n    });\n\n    var scale = function (image, dW, dH) {\n      var sW = getWidth(image);\n      var sH = getHeight(image);\n      var wRatio = dW / sW;\n      var hRatio = dH / sH;\n      var scaleCapped = false;\n      if (wRatio < 0.5 || wRatio > 2) {\n        wRatio = wRatio < 0.5 ? 0.5 : 2;\n        scaleCapped = true;\n      }\n      if (hRatio < 0.5 || hRatio > 2) {\n        hRatio = hRatio < 0.5 ? 0.5 : 2;\n        scaleCapped = true;\n      }\n      var scaled = _scale(image, wRatio, hRatio);\n      return !scaleCapped ? scaled : scaled.then(function (tCanvas) {\n        return scale(tCanvas, dW, dH);\n      });\n    };\n    var _scale = function (image, wRatio, hRatio) {\n      return new Promise$1(function (resolve) {\n        var sW = getWidth(image);\n        var sH = getHeight(image);\n        var dW = Math.floor(sW * wRatio);\n        var dH = Math.floor(sH * hRatio);\n        var canvas = create$5(dW, dH);\n        var context = get2dContext(canvas);\n        context.drawImage(image, 0, 0, sW, sH, 0, 0, dW, dH);\n        resolve(canvas);\n      });\n    };\n\n    var ceilWithPrecision = function (num, precision) {\n      if (precision === void 0) {\n        precision = 2;\n      }\n      var mul = Math.pow(10, precision);\n      var upper = Math.round(num * mul);\n      return Math.ceil(upper / mul);\n    };\n    var rotate = function (ir, angle) {\n      return ir.toCanvas().then(function (canvas) {\n        return applyRotate(canvas, ir.getType(), angle);\n      });\n    };\n    var applyRotate = function (image, type, angle) {\n      var degrees = angle < 0 ? 360 + angle : angle;\n      var rad = degrees * Math.PI / 180;\n      var width = image.width;\n      var height = image.height;\n      var sin = Math.sin(rad);\n      var cos = Math.cos(rad);\n      var newWidth = ceilWithPrecision(Math.abs(width * cos) + Math.abs(height * sin));\n      var newHeight = ceilWithPrecision(Math.abs(width * sin) + Math.abs(height * cos));\n      var canvas = create$5(newWidth, newHeight);\n      var context = get2dContext(canvas);\n      context.translate(newWidth / 2, newHeight / 2);\n      context.rotate(rad);\n      context.drawImage(image, -width / 2, -height / 2);\n      return fromCanvas(canvas, type);\n    };\n    var flip = function (ir, axis) {\n      return ir.toCanvas().then(function (canvas) {\n        return applyFlip(canvas, ir.getType(), axis);\n      });\n    };\n    var applyFlip = function (image, type, axis) {\n      var canvas = create$5(image.width, image.height);\n      var context = get2dContext(canvas);\n      if (axis === 'v') {\n        context.scale(1, -1);\n        context.drawImage(image, 0, -canvas.height);\n      } else {\n        context.scale(-1, 1);\n        context.drawImage(image, -canvas.width, 0);\n      }\n      return fromCanvas(canvas, type);\n    };\n    var crop = function (ir, x, y, w, h) {\n      return ir.toCanvas().then(function (canvas) {\n        return applyCrop(canvas, ir.getType(), x, y, w, h);\n      });\n    };\n    var applyCrop = function (image, type, x, y, w, h) {\n      var canvas = create$5(w, h);\n      var context = get2dContext(canvas);\n      context.drawImage(image, -x, -y);\n      return fromCanvas(canvas, type);\n    };\n    var resize$1 = function (ir, w, h) {\n      return ir.toCanvas().then(function (canvas) {\n        return scale(canvas, w, h).then(function (newCanvas) {\n          return fromCanvas(newCanvas, ir.getType());\n        });\n      });\n    };\n\n    var invert$1 = function (ir) {\n      return invert(ir);\n    };\n    var sharpen$1 = function (ir) {\n      return sharpen(ir);\n    };\n    var gamma$1 = function (ir, value) {\n      return gamma(ir, value);\n    };\n    var colorize$1 = function (ir, adjustR, adjustG, adjustB) {\n      return colorize(ir, adjustR, adjustG, adjustB);\n    };\n    var brightness$1 = function (ir, adjust) {\n      return brightness(ir, adjust);\n    };\n    var contrast$1 = function (ir, adjust) {\n      return contrast(ir, adjust);\n    };\n    var flip$1 = function (ir, axis) {\n      return flip(ir, axis);\n    };\n    var crop$1 = function (ir, x, y, w, h) {\n      return crop(ir, x, y, w, h);\n    };\n    var resize$2 = function (ir, w, h) {\n      return resize$1(ir, w, h);\n    };\n    var rotate$1 = function (ir, angle) {\n      return rotate(ir, angle);\n    };\n\n    var renderIcon$1 = function (iconHtml, behaviours) {\n      return __assign({\n        dom: {\n          tag: 'span',\n          innerHtml: iconHtml,\n          classes: [\n            'tox-icon',\n            'tox-tbtn__icon-wrap'\n          ]\n        }\n      }, behaviours);\n    };\n    var renderIconFromPack = function (iconName, iconsProvider) {\n      return renderIcon$1(get$e(iconName, iconsProvider), {});\n    };\n    var renderReplacableIconFromPack = function (iconName, iconsProvider) {\n      return renderIcon$1(get$e(iconName, iconsProvider), { behaviours: derive$1([Replacing.config({})]) });\n    };\n    var renderLabel$1 = function (text, prefix, providersBackstage) {\n      return {\n        dom: {\n          tag: 'span',\n          innerHtml: providersBackstage.translate(text),\n          classes: [prefix + '__select-label']\n        },\n        behaviours: derive$1([Replacing.config({})])\n      };\n    };\n\n    var _a$1;\n    var internalToolbarButtonExecute = generate$1('toolbar.button.execute');\n    var onToolbarButtonExecute = function (info) {\n      return runOnExecute(function (comp, _simulatedEvent) {\n        runWithApi(info, comp)(function (itemApi) {\n          emitWith(comp, internalToolbarButtonExecute, { buttonApi: itemApi });\n          info.onAction(itemApi);\n        });\n      });\n    };\n    var toolbarButtonEventOrder = (_a$1 = {}, _a$1[execute()] = [\n      'disabling',\n      'alloy.base.behaviour',\n      'toggling',\n      'toolbar-button-events'\n    ], _a$1);\n\n    var updateMenuText = generate$1('update-menu-text');\n    var updateMenuIcon = generate$1('update-menu-icon');\n    var renderCommonDropdown = function (spec, prefix, sharedBackstage) {\n      var editorOffCell = Cell(noop);\n      var optMemDisplayText = spec.text.map(function (text) {\n        return record(renderLabel$1(text, prefix, sharedBackstage.providers));\n      });\n      var optMemDisplayIcon = spec.icon.map(function (iconName) {\n        return record(renderReplacableIconFromPack(iconName, sharedBackstage.providers.icons));\n      });\n      var onLeftOrRightInMenu = function (comp, se) {\n        var dropdown = Representing.getValue(comp);\n        Focusing.focus(dropdown);\n        emitWith(dropdown, 'keydown', { raw: se.event.raw });\n        Dropdown.close(dropdown);\n        return Optional.some(true);\n      };\n      var role = spec.role.fold(function () {\n        return {};\n      }, function (role) {\n        return { role: role };\n      });\n      var tooltipAttributes = spec.tooltip.fold(function () {\n        return {};\n      }, function (tooltip) {\n        var translatedTooltip = sharedBackstage.providers.translate(tooltip);\n        return {\n          'title': translatedTooltip,\n          'aria-label': translatedTooltip\n        };\n      });\n      var memDropdown = record(Dropdown.sketch(__assign(__assign(__assign({}, spec.uid ? { uid: spec.uid } : {}), role), {\n        dom: {\n          tag: 'button',\n          classes: [\n            prefix,\n            prefix + '--select'\n          ].concat(map(spec.classes, function (c) {\n            return prefix + '--' + c;\n          })),\n          attributes: __assign({}, tooltipAttributes)\n        },\n        components: componentRenderPipeline([\n          optMemDisplayIcon.map(function (mem) {\n            return mem.asSpec();\n          }),\n          optMemDisplayText.map(function (mem) {\n            return mem.asSpec();\n          }),\n          Optional.some({\n            dom: {\n              tag: 'div',\n              classes: [prefix + '__select-chevron'],\n              innerHtml: get$e('chevron-down', sharedBackstage.providers.icons)\n            }\n          })\n        ]),\n        matchWidth: true,\n        useMinWidth: true,\n        dropdownBehaviours: derive$1(__spreadArrays(spec.dropdownBehaviours, [\n          DisablingConfigs.button(function () {\n            return spec.disabled || sharedBackstage.providers.isDisabled();\n          }),\n          receivingConfig(),\n          Unselecting.config({}),\n          Replacing.config({}),\n          config('dropdown-events', [\n            onControlAttached(spec, editorOffCell),\n            onControlDetached(spec, editorOffCell)\n          ]),\n          config('menubutton-update-display-text', [\n            run(updateMenuText, function (comp, se) {\n              optMemDisplayText.bind(function (mem) {\n                return mem.getOpt(comp);\n              }).each(function (displayText) {\n                Replacing.set(displayText, [text(sharedBackstage.providers.translate(se.event.text))]);\n              });\n            }),\n            run(updateMenuIcon, function (comp, se) {\n              optMemDisplayIcon.bind(function (mem) {\n                return mem.getOpt(comp);\n              }).each(function (displayIcon) {\n                Replacing.set(displayIcon, [renderReplacableIconFromPack(se.event.icon, sharedBackstage.providers.icons)]);\n              });\n            })\n          ])\n        ])),\n        eventOrder: deepMerge(toolbarButtonEventOrder, {\n          mousedown: [\n            'focusing',\n            'alloy.base.behaviour',\n            'item-type-events',\n            'normal-dropdown-events'\n          ]\n        }),\n        sandboxBehaviours: derive$1([Keying.config({\n            mode: 'special',\n            onLeft: onLeftOrRightInMenu,\n            onRight: onLeftOrRightInMenu\n          })]),\n        lazySink: sharedBackstage.getSink,\n        toggleClass: prefix + '--active',\n        parts: { menu: part(false, spec.columns, spec.presets) },\n        fetch: function (comp) {\n          return Future.nu(curry(spec.fetch, comp));\n        }\n      })));\n      return memDropdown.asSpec();\n    };\n\n    var isMenuItemReference = function (item) {\n      return isString(item);\n    };\n    var isSeparator = function (item) {\n      return item.type === 'separator';\n    };\n    var isExpandingMenuItem = function (item) {\n      return has(item, 'getSubmenuItems');\n    };\n    var separator$1 = { type: 'separator' };\n    var unwrapReferences = function (items, menuItems) {\n      var realItems = foldl(items, function (acc, item) {\n        if (isMenuItemReference(item)) {\n          if (item === '') {\n            return acc;\n          } else if (item === '|') {\n            return acc.length > 0 && !isSeparator(acc[acc.length - 1]) ? acc.concat([separator$1]) : acc;\n          } else if (has(menuItems, item.toLowerCase())) {\n            return acc.concat([menuItems[item.toLowerCase()]]);\n          } else {\n            return acc;\n          }\n        } else {\n          return acc.concat([item]);\n        }\n      }, []);\n      if (realItems.length > 0 && isSeparator(realItems[realItems.length - 1])) {\n        realItems.pop();\n      }\n      return realItems;\n    };\n    var getFromExpandingItem = function (item, menuItems) {\n      var submenuItems = item.getSubmenuItems();\n      var rest = expand(submenuItems, menuItems);\n      var newMenus = deepMerge(rest.menus, wrap$1(item.value, rest.items));\n      var newExpansions = deepMerge(rest.expansions, wrap$1(item.value, item.value));\n      return {\n        item: item,\n        menus: newMenus,\n        expansions: newExpansions\n      };\n    };\n    var getFromItem = function (item, menuItems) {\n      return isExpandingMenuItem(item) ? getFromExpandingItem(item, menuItems) : {\n        item: item,\n        menus: {},\n        expansions: {}\n      };\n    };\n    var generateValueIfRequired = function (item) {\n      if (isSeparator(item)) {\n        return item;\n      } else {\n        var itemValue = get$1(item, 'value').getOrThunk(function () {\n          return generate$1('generated-menu-item');\n        });\n        return deepMerge({ value: itemValue }, item);\n      }\n    };\n    var expand = function (items, menuItems) {\n      var realItems = unwrapReferences(isString(items) ? items.split(' ') : items, menuItems);\n      return foldr(realItems, function (acc, item) {\n        var itemWithValue = generateValueIfRequired(item);\n        var newData = getFromItem(itemWithValue, menuItems);\n        return {\n          menus: deepMerge(acc.menus, newData.menus),\n          items: [newData.item].concat(acc.items),\n          expansions: deepMerge(acc.expansions, newData.expansions)\n        };\n      }, {\n        menus: {},\n        expansions: {},\n        items: []\n      });\n    };\n\n    var build$2 = function (items, itemResponse, backstage, isHorizontalMenu) {\n      var primary = generate$1('primary-menu');\n      var data = expand(items, backstage.shared.providers.menuItems());\n      if (data.items.length === 0) {\n        return Optional.none();\n      }\n      var mainMenu = createPartialMenu(primary, data.items, itemResponse, backstage, isHorizontalMenu);\n      var submenus = map$2(data.menus, function (menuItems, menuName) {\n        return createPartialMenu(menuName, menuItems, itemResponse, backstage, false);\n      });\n      var menus = deepMerge(submenus, wrap$1(primary, mainMenu));\n      return Optional.from(tieredMenu.tieredData(primary, menus, data.expansions));\n    };\n\n    var getMenuButtonApi = function (component) {\n      return {\n        isDisabled: function () {\n          return Disabling.isDisabled(component);\n        },\n        setDisabled: function (state) {\n          return Disabling.set(component, state);\n        },\n        setActive: function (state) {\n          var elm = component.element;\n          if (state) {\n            add$2(elm, 'tox-tbtn--enabled');\n            set$1(elm, 'aria-pressed', true);\n          } else {\n            remove$4(elm, 'tox-tbtn--enabled');\n            remove$1(elm, 'aria-pressed');\n          }\n        },\n        isActive: function () {\n          return has$2(component.element, 'tox-tbtn--enabled');\n        }\n      };\n    };\n    var renderMenuButton = function (spec, prefix, backstage, role) {\n      return renderCommonDropdown({\n        text: spec.text,\n        icon: spec.icon,\n        tooltip: spec.tooltip,\n        role: role,\n        fetch: function (_comp, callback) {\n          spec.fetch(function (items) {\n            callback(build$2(items, ItemResponse$1.CLOSE_ON_EXECUTE, backstage, false));\n          });\n        },\n        onSetup: spec.onSetup,\n        getApi: getMenuButtonApi,\n        columns: 1,\n        presets: 'normal',\n        classes: [],\n        dropdownBehaviours: [Tabstopping.config({})]\n      }, prefix, backstage.shared);\n    };\n    var getFetch$1 = function (items, getButton, backstage) {\n      var getMenuItemAction = function (item) {\n        return function (api) {\n          var newValue = !api.isActive();\n          api.setActive(newValue);\n          item.storage.set(newValue);\n          backstage.shared.getSink().each(function (sink) {\n            getButton().getOpt(sink).each(function (orig) {\n              focus$1(orig.element);\n              emitWith(orig, formActionEvent, {\n                name: item.name,\n                value: item.storage.get()\n              });\n            });\n          });\n        };\n      };\n      var getMenuItemSetup = function (item) {\n        return function (api) {\n          api.setActive(item.storage.get());\n        };\n      };\n      return function (success) {\n        success(map(items, function (item) {\n          var text = item.text.fold(function () {\n            return {};\n          }, function (text) {\n            return { text: text };\n          });\n          return __assign(__assign({\n            type: item.type,\n            active: false\n          }, text), {\n            onAction: getMenuItemAction(item),\n            onSetup: getMenuItemSetup(item)\n          });\n        }));\n      };\n    };\n\n    var renderCommonSpec = function (spec, actionOpt, extraBehaviours, dom, components, providersBackstage) {\n      if (extraBehaviours === void 0) {\n        extraBehaviours = [];\n      }\n      var action = actionOpt.fold(function () {\n        return {};\n      }, function (action) {\n        return { action: action };\n      });\n      var common = __assign({\n        buttonBehaviours: derive$1([\n          DisablingConfigs.button(function () {\n            return spec.disabled || providersBackstage.isDisabled();\n          }),\n          receivingConfig(),\n          Tabstopping.config({}),\n          config('button press', [\n            preventDefault('click'),\n            preventDefault('mousedown')\n          ])\n        ].concat(extraBehaviours)),\n        eventOrder: {\n          click: [\n            'button press',\n            'alloy.base.behaviour'\n          ],\n          mousedown: [\n            'button press',\n            'alloy.base.behaviour'\n          ]\n        }\n      }, action);\n      var domFinal = deepMerge(common, { dom: dom });\n      return deepMerge(domFinal, { components: components });\n    };\n    var renderIconButtonSpec = function (spec, action, providersBackstage, extraBehaviours) {\n      if (extraBehaviours === void 0) {\n        extraBehaviours = [];\n      }\n      var tooltipAttributes = spec.tooltip.map(function (tooltip) {\n        return {\n          'aria-label': providersBackstage.translate(tooltip),\n          'title': providersBackstage.translate(tooltip)\n        };\n      }).getOr({});\n      var dom = {\n        tag: 'button',\n        classes: ['tox-tbtn'],\n        attributes: tooltipAttributes\n      };\n      var icon = spec.icon.map(function (iconName) {\n        return renderIconFromPack(iconName, providersBackstage.icons);\n      });\n      var components = componentRenderPipeline([icon]);\n      return renderCommonSpec(spec, action, extraBehaviours, dom, components, providersBackstage);\n    };\n    var renderIconButton = function (spec, action, providersBackstage, extraBehaviours) {\n      if (extraBehaviours === void 0) {\n        extraBehaviours = [];\n      }\n      var iconButtonSpec = renderIconButtonSpec(spec, Optional.some(action), providersBackstage, extraBehaviours);\n      return Button.sketch(iconButtonSpec);\n    };\n    var renderButtonSpec = function (spec, action, providersBackstage, extraBehaviours, extraClasses) {\n      if (extraBehaviours === void 0) {\n        extraBehaviours = [];\n      }\n      if (extraClasses === void 0) {\n        extraClasses = [];\n      }\n      var translatedText = providersBackstage.translate(spec.text);\n      var icon = spec.icon ? spec.icon.map(function (iconName) {\n        return renderIconFromPack(iconName, providersBackstage.icons);\n      }) : Optional.none();\n      var components = icon.isSome() ? componentRenderPipeline([icon]) : [];\n      var innerHtml = icon.isSome() ? {} : { innerHtml: translatedText };\n      var classes = __spreadArrays(!spec.primary && !spec.borderless ? [\n        'tox-button',\n        'tox-button--secondary'\n      ] : ['tox-button'], icon.isSome() ? ['tox-button--icon'] : [], spec.borderless ? ['tox-button--naked'] : [], extraClasses);\n      var dom = __assign(__assign({\n        tag: 'button',\n        classes: classes\n      }, innerHtml), { attributes: { title: translatedText } });\n      return renderCommonSpec(spec, action, extraBehaviours, dom, components, providersBackstage);\n    };\n    var renderButton = function (spec, action, providersBackstage, extraBehaviours, extraClasses) {\n      if (extraBehaviours === void 0) {\n        extraBehaviours = [];\n      }\n      if (extraClasses === void 0) {\n        extraClasses = [];\n      }\n      var buttonSpec = renderButtonSpec(spec, Optional.some(action), providersBackstage, extraBehaviours, extraClasses);\n      return Button.sketch(buttonSpec);\n    };\n    var getAction = function (name, buttonType) {\n      return function (comp) {\n        if (buttonType === 'custom') {\n          emitWith(comp, formActionEvent, {\n            name: name,\n            value: {}\n          });\n        } else if (buttonType === 'submit') {\n          emit(comp, formSubmitEvent);\n        } else if (buttonType === 'cancel') {\n          emit(comp, formCancelEvent);\n        } else {\n          console.error('Unknown button type: ', buttonType);\n        }\n      };\n    };\n    var isMenuFooterButtonSpec = function (spec, buttonType) {\n      return buttonType === 'menu';\n    };\n    var isNormalFooterButtonSpec = function (spec, buttonType) {\n      return buttonType === 'custom' || buttonType === 'cancel' || buttonType === 'submit';\n    };\n    var renderFooterButton = function (spec, buttonType, backstage) {\n      if (isMenuFooterButtonSpec(spec, buttonType)) {\n        var getButton = function () {\n          return memButton_1;\n        };\n        var menuButtonSpec = spec;\n        var fixedSpec = __assign(__assign({}, spec), {\n          onSetup: function (api) {\n            api.setDisabled(spec.disabled);\n            return noop;\n          },\n          fetch: getFetch$1(menuButtonSpec.items, getButton, backstage)\n        });\n        var memButton_1 = record(renderMenuButton(fixedSpec, 'tox-tbtn', backstage, Optional.none()));\n        return memButton_1.asSpec();\n      } else if (isNormalFooterButtonSpec(spec, buttonType)) {\n        var action = getAction(spec.name, buttonType);\n        var buttonSpec = __assign(__assign({}, spec), { borderless: false });\n        return renderButton(buttonSpec, action, backstage.shared.providers, []);\n      } else {\n        console.error('Unknown footer button type: ', buttonType);\n      }\n    };\n    var renderDialogButton = function (spec, providersBackstage) {\n      var action = getAction(spec.name, 'custom');\n      return renderFormField(Optional.none(), FormField.parts.field(__assign({ factory: Button }, renderButtonSpec(spec, Optional.some(action), providersBackstage, [\n        RepresentingConfigs.memory(''),\n        ComposingConfigs.self()\n      ]))));\n    };\n\n    var schema$i = constant([\n      defaulted$1('field1Name', 'field1'),\n      defaulted$1('field2Name', 'field2'),\n      onStrictHandler('onLockedChange'),\n      markers(['lockClass']),\n      defaulted$1('locked', false),\n      SketchBehaviours.field('coupledFieldBehaviours', [\n        Composing,\n        Representing\n      ])\n    ]);\n    var getField = function (comp, detail, partName) {\n      return getPart(comp, detail, partName).bind(Composing.getCurrent);\n    };\n    var coupledPart = function (selfName, otherName) {\n      return required({\n        factory: FormField,\n        name: selfName,\n        overrides: function (detail) {\n          return {\n            fieldBehaviours: derive$1([config('coupled-input-behaviour', [run(input(), function (me) {\n                  getField(me, detail, otherName).each(function (other) {\n                    getPart(me, detail, 'lock').each(function (lock) {\n                      if (Toggling.isOn(lock)) {\n                        detail.onLockedChange(me, other, lock);\n                      }\n                    });\n                  });\n                })])])\n          };\n        }\n      });\n    };\n    var parts$5 = constant([\n      coupledPart('field1', 'field2'),\n      coupledPart('field2', 'field1'),\n      required({\n        factory: Button,\n        schema: [strict$1('dom')],\n        name: 'lock',\n        overrides: function (detail) {\n          return {\n            buttonBehaviours: derive$1([Toggling.config({\n                selected: detail.locked,\n                toggleClass: detail.markers.lockClass,\n                aria: { mode: 'pressed' }\n              })])\n          };\n        }\n      })\n    ]);\n\n    var factory$7 = function (detail, components, _spec, _externals) {\n      return {\n        uid: detail.uid,\n        dom: detail.dom,\n        components: components,\n        behaviours: SketchBehaviours.augment(detail.coupledFieldBehaviours, [\n          Composing.config({ find: Optional.some }),\n          Representing.config({\n            store: {\n              mode: 'manual',\n              getValue: function (comp) {\n                var _a;\n                var parts = getPartsOrDie(comp, detail, [\n                  'field1',\n                  'field2'\n                ]);\n                return _a = {}, _a[detail.field1Name] = Representing.getValue(parts.field1()), _a[detail.field2Name] = Representing.getValue(parts.field2()), _a;\n              },\n              setValue: function (comp, value) {\n                var parts = getPartsOrDie(comp, detail, [\n                  'field1',\n                  'field2'\n                ]);\n                if (hasNonNullableKey(value, detail.field1Name)) {\n                  Representing.setValue(parts.field1(), value[detail.field1Name]);\n                }\n                if (hasNonNullableKey(value, detail.field2Name)) {\n                  Representing.setValue(parts.field2(), value[detail.field2Name]);\n                }\n              }\n            }\n          })\n        ]),\n        apis: {\n          getField1: function (component) {\n            return getPart(component, detail, 'field1');\n          },\n          getField2: function (component) {\n            return getPart(component, detail, 'field2');\n          },\n          getLock: function (component) {\n            return getPart(component, detail, 'lock');\n          }\n        }\n      };\n    };\n    var FormCoupledInputs = composite$1({\n      name: 'FormCoupledInputs',\n      configFields: schema$i(),\n      partFields: parts$5(),\n      factory: factory$7,\n      apis: {\n        getField1: function (apis, component) {\n          return apis.getField1(component);\n        },\n        getField2: function (apis, component) {\n          return apis.getField2(component);\n        },\n        getLock: function (apis, component) {\n          return apis.getLock(component);\n        }\n      }\n    });\n\n    var formatSize = function (size) {\n      var unitDec = {\n        '': 0,\n        'px': 0,\n        'pt': 1,\n        'mm': 1,\n        'pc': 2,\n        'ex': 2,\n        'em': 2,\n        'ch': 2,\n        'rem': 2,\n        'cm': 3,\n        'in': 4,\n        '%': 4\n      };\n      var maxDecimal = function (unit) {\n        return unit in unitDec ? unitDec[unit] : 1;\n      };\n      var numText = size.value.toFixed(maxDecimal(size.unit));\n      if (numText.indexOf('.') !== -1) {\n        numText = numText.replace(/\\.?0*$/, '');\n      }\n      return numText + size.unit;\n    };\n    var parseSize = function (sizeText) {\n      var numPattern = /^\\s*(\\d+(?:\\.\\d+)?)\\s*(|cm|mm|in|px|pt|pc|em|ex|ch|rem|vw|vh|vmin|vmax|%)\\s*$/;\n      var match = numPattern.exec(sizeText);\n      if (match !== null) {\n        var value = parseFloat(match[1]);\n        var unit = match[2];\n        return Result.value({\n          value: value,\n          unit: unit\n        });\n      } else {\n        return Result.error(sizeText);\n      }\n    };\n    var convertUnit = function (size, unit) {\n      var inInch = {\n        '': 96,\n        'px': 96,\n        'pt': 72,\n        'cm': 2.54,\n        'pc': 12,\n        'mm': 25.4,\n        'in': 1\n      };\n      var supported = function (u) {\n        return Object.prototype.hasOwnProperty.call(inInch, u);\n      };\n      if (size.unit === unit) {\n        return Optional.some(size.value);\n      } else if (supported(size.unit) && supported(unit)) {\n        if (inInch[size.unit] === inInch[unit]) {\n          return Optional.some(size.value);\n        } else {\n          return Optional.some(size.value / inInch[size.unit] * inInch[unit]);\n        }\n      } else {\n        return Optional.none();\n      }\n    };\n    var noSizeConversion = function (_input) {\n      return Optional.none();\n    };\n    var ratioSizeConversion = function (scale, unit) {\n      return function (size) {\n        return convertUnit(size, unit).map(function (value) {\n          return {\n            value: value * scale,\n            unit: unit\n          };\n        });\n      };\n    };\n    var makeRatioConverter = function (currentFieldText, otherFieldText) {\n      var cValue = parseSize(currentFieldText).toOptional();\n      var oValue = parseSize(otherFieldText).toOptional();\n      return lift2(cValue, oValue, function (cSize, oSize) {\n        return convertUnit(cSize, oSize.unit).map(function (val) {\n          return oSize.value / val;\n        }).map(function (r) {\n          return ratioSizeConversion(r, oSize.unit);\n        }).getOr(noSizeConversion);\n      }).getOr(noSizeConversion);\n    };\n\n    var renderSizeInput = function (spec, providersBackstage) {\n      var converter = noSizeConversion;\n      var ratioEvent = generate$1('ratio-event');\n      var pLock = FormCoupledInputs.parts.lock({\n        dom: {\n          tag: 'button',\n          classes: [\n            'tox-lock',\n            'tox-button',\n            'tox-button--naked',\n            'tox-button--icon'\n          ],\n          attributes: { title: providersBackstage.translate(spec.label.getOr('Constrain proportions')) }\n        },\n        components: [\n          {\n            dom: {\n              tag: 'span',\n              classes: [\n                'tox-icon',\n                'tox-lock-icon__lock'\n              ],\n              innerHtml: get$e('lock', providersBackstage.icons)\n            }\n          },\n          {\n            dom: {\n              tag: 'span',\n              classes: [\n                'tox-icon',\n                'tox-lock-icon__unlock'\n              ],\n              innerHtml: get$e('unlock', providersBackstage.icons)\n            }\n          }\n        ],\n        buttonBehaviours: derive$1([\n          Disabling.config({\n            disabled: function () {\n              return spec.disabled || providersBackstage.isDisabled();\n            }\n          }),\n          receivingConfig(),\n          Tabstopping.config({})\n        ])\n      });\n      var formGroup = function (components) {\n        return {\n          dom: {\n            tag: 'div',\n            classes: ['tox-form__group']\n          },\n          components: components\n        };\n      };\n      var getFieldPart = function (isField1) {\n        return FormField.parts.field({\n          factory: Input,\n          inputClasses: ['tox-textfield'],\n          inputBehaviours: derive$1([\n            Disabling.config({\n              disabled: function () {\n                return spec.disabled || providersBackstage.isDisabled();\n              }\n            }),\n            receivingConfig(),\n            Tabstopping.config({}),\n            config('size-input-events', [\n              run(focusin(), function (component, _simulatedEvent) {\n                emitWith(component, ratioEvent, { isField1: isField1 });\n              }),\n              run(change(), function (component, _simulatedEvent) {\n                emitWith(component, formChangeEvent, { name: spec.name });\n              })\n            ])\n          ]),\n          selectOnFocus: false\n        });\n      };\n      var getLabel = function (label) {\n        return {\n          dom: {\n            tag: 'label',\n            classes: ['tox-label'],\n            innerHtml: providersBackstage.translate(label)\n          }\n        };\n      };\n      var widthField = FormCoupledInputs.parts.field1(formGroup([\n        FormField.parts.label(getLabel('Width')),\n        getFieldPart(true)\n      ]));\n      var heightField = FormCoupledInputs.parts.field2(formGroup([\n        FormField.parts.label(getLabel('Height')),\n        getFieldPart(false)\n      ]));\n      return FormCoupledInputs.sketch({\n        dom: {\n          tag: 'div',\n          classes: ['tox-form__group']\n        },\n        components: [{\n            dom: {\n              tag: 'div',\n              classes: ['tox-form__controls-h-stack']\n            },\n            components: [\n              widthField,\n              heightField,\n              formGroup([\n                getLabel('&nbsp;'),\n                pLock\n              ])\n            ]\n          }],\n        field1Name: 'width',\n        field2Name: 'height',\n        locked: true,\n        markers: { lockClass: 'tox-locked' },\n        onLockedChange: function (current, other, _lock) {\n          parseSize(Representing.getValue(current)).each(function (size) {\n            converter(size).each(function (newSize) {\n              Representing.setValue(other, formatSize(newSize));\n            });\n          });\n        },\n        coupledFieldBehaviours: derive$1([\n          Disabling.config({\n            disabled: function () {\n              return spec.disabled || providersBackstage.isDisabled();\n            },\n            onDisabled: function (comp) {\n              FormCoupledInputs.getField1(comp).bind(FormField.getField).each(Disabling.disable);\n              FormCoupledInputs.getField2(comp).bind(FormField.getField).each(Disabling.disable);\n              FormCoupledInputs.getLock(comp).each(Disabling.disable);\n            },\n            onEnabled: function (comp) {\n              FormCoupledInputs.getField1(comp).bind(FormField.getField).each(Disabling.enable);\n              FormCoupledInputs.getField2(comp).bind(FormField.getField).each(Disabling.enable);\n              FormCoupledInputs.getLock(comp).each(Disabling.enable);\n            }\n          }),\n          receivingConfig(),\n          config('size-input-events2', [run(ratioEvent, function (component, simulatedEvent) {\n              var isField1 = simulatedEvent.event.isField1;\n              var optCurrent = isField1 ? FormCoupledInputs.getField1(component) : FormCoupledInputs.getField2(component);\n              var optOther = isField1 ? FormCoupledInputs.getField2(component) : FormCoupledInputs.getField1(component);\n              var value1 = optCurrent.map(Representing.getValue).getOr('');\n              var value2 = optOther.map(Representing.getValue).getOr('');\n              converter = makeRatioConverter(value1, value2);\n            })])\n        ])\n      });\n    };\n\n    var undo = constant(generate$1('undo'));\n    var redo = constant(generate$1('redo'));\n    var zoom = constant(generate$1('zoom'));\n    var back = constant(generate$1('back'));\n    var apply = constant(generate$1('apply'));\n    var swap = constant(generate$1('swap'));\n    var transform = constant(generate$1('transform'));\n    var tempTransform = constant(generate$1('temp-transform'));\n    var transformApply = constant(generate$1('transform-apply'));\n    var internal = {\n      undo: undo,\n      redo: redo,\n      zoom: zoom,\n      back: back,\n      apply: apply,\n      swap: swap,\n      transform: transform,\n      tempTransform: tempTransform,\n      transformApply: transformApply\n    };\n    var saveState = constant('save-state');\n    var disable$1 = constant('disable');\n    var enable$1 = constant('enable');\n    var external$2 = {\n      formActionEvent: formActionEvent,\n      saveState: saveState,\n      disable: disable$1,\n      enable: enable$1\n    };\n\n    var renderEditPanel = function (imagePanel, providersBackstage) {\n      var createButton = function (text, action, disabled, primary) {\n        return record(renderButton({\n          name: text,\n          text: text,\n          disabled: disabled,\n          primary: primary,\n          icon: Optional.none(),\n          borderless: false\n        }, action, providersBackstage));\n      };\n      var createIconButton = function (icon, tooltip, action, disabled) {\n        return record(renderIconButton({\n          name: icon,\n          icon: Optional.some(icon),\n          tooltip: Optional.some(tooltip),\n          disabled: disabled,\n          primary: false,\n          borderless: false\n        }, action, providersBackstage));\n      };\n      var disableAllComponents = function (comps, eventcomp) {\n        comps.map(function (mem) {\n          var component = mem.get(eventcomp);\n          if (component.hasConfigured(Disabling)) {\n            Disabling.disable(component);\n          }\n        });\n      };\n      var enableAllComponents = function (comps, eventcomp) {\n        comps.map(function (mem) {\n          var component = mem.get(eventcomp);\n          if (component.hasConfigured(Disabling)) {\n            Disabling.enable(component);\n          }\n        });\n      };\n      var panelDom = {\n        tag: 'div',\n        classes: [\n          'tox-image-tools__toolbar',\n          'tox-image-tools-edit-panel'\n        ]\n      };\n      var noop$1 = noop;\n      var emit$1 = function (comp, event, data) {\n        emitWith(comp, event, data);\n      };\n      var emitDisable = function (component) {\n        return emit(component, external$2.disable());\n      };\n      var emitEnable = function (component) {\n        return emit(component, external$2.enable());\n      };\n      var emitTransform = function (comp, transform) {\n        emitDisable(comp);\n        emit$1(comp, internal.transform(), { transform: transform });\n        emitEnable(comp);\n      };\n      var emitTempTransform = function (comp, transform) {\n        emitDisable(comp);\n        emit$1(comp, internal.tempTransform(), { transform: transform });\n        emitEnable(comp);\n      };\n      var getBackSwap = function (anyInSystem) {\n        return function () {\n          memContainer.getOpt(anyInSystem).each(function (container) {\n            Replacing.set(container, [ButtonPanel]);\n          });\n        };\n      };\n      var emitTransformApply = function (comp, transform) {\n        emitDisable(comp);\n        emit$1(comp, internal.transformApply(), {\n          transform: transform,\n          swap: getBackSwap(comp)\n        });\n        emitEnable(comp);\n      };\n      var createBackButton = function () {\n        return createButton('Back', function (button) {\n          return emit$1(button, internal.back(), { swap: getBackSwap(button) });\n        }, false, false);\n      };\n      var createSpacer = function () {\n        return record({\n          dom: {\n            tag: 'div',\n            classes: ['tox-spacer']\n          },\n          behaviours: derive$1([Disabling.config({})])\n        });\n      };\n      var createApplyButton = function () {\n        return createButton('Apply', function (button) {\n          return emit$1(button, internal.apply(), { swap: getBackSwap(button) });\n        }, true, true);\n      };\n      var makeCropTransform = function () {\n        return function (ir) {\n          var rect = imagePanel.getRect();\n          return crop$1(ir, rect.x, rect.y, rect.w, rect.h);\n        };\n      };\n      var cropPanelComponents = [\n        createBackButton(),\n        createSpacer(),\n        createButton('Apply', function (button) {\n          var transform = makeCropTransform();\n          emitTransformApply(button, transform);\n          imagePanel.hideCrop();\n        }, false, true)\n      ];\n      var CropPanel = Container.sketch({\n        dom: panelDom,\n        components: cropPanelComponents.map(function (mem) {\n          return mem.asSpec();\n        }),\n        containerBehaviours: derive$1([config('image-tools-crop-buttons-events', [\n            run(external$2.disable(), function (comp, _se) {\n              disableAllComponents(cropPanelComponents, comp);\n            }),\n            run(external$2.enable(), function (comp, _se) {\n              enableAllComponents(cropPanelComponents, comp);\n            })\n          ])])\n      });\n      var memSize = record(renderSizeInput({\n        name: 'size',\n        label: Optional.none(),\n        constrain: true,\n        disabled: false\n      }, providersBackstage));\n      var makeResizeTransform = function (width, height) {\n        return function (ir) {\n          return resize$2(ir, width, height);\n        };\n      };\n      var resizePanelComponents = [\n        createBackButton(),\n        createSpacer(),\n        memSize,\n        createSpacer(),\n        createButton('Apply', function (button) {\n          memSize.getOpt(button).each(function (sizeInput) {\n            var value = Representing.getValue(sizeInput);\n            var width = parseInt(value.width, 10);\n            var height = parseInt(value.height, 10);\n            var transform = makeResizeTransform(width, height);\n            emitTransformApply(button, transform);\n          });\n        }, false, true)\n      ];\n      var ResizePanel = Container.sketch({\n        dom: panelDom,\n        components: resizePanelComponents.map(function (mem) {\n          return mem.asSpec();\n        }),\n        containerBehaviours: derive$1([config('image-tools-resize-buttons-events', [\n            run(external$2.disable(), function (comp, _se) {\n              disableAllComponents(resizePanelComponents, comp);\n            }),\n            run(external$2.enable(), function (comp, _se) {\n              enableAllComponents(resizePanelComponents, comp);\n            })\n          ])])\n      });\n      var makeValueTransform = function (transform, value) {\n        return function (ir) {\n          return transform(ir, value);\n        };\n      };\n      var horizontalFlip = makeValueTransform(flip$1, 'h');\n      var verticalFlip = makeValueTransform(flip$1, 'v');\n      var counterclockwiseRotate = makeValueTransform(rotate$1, -90);\n      var clockwiseRotate = makeValueTransform(rotate$1, 90);\n      var flipRotateOnAction = function (comp, operation) {\n        emitTempTransform(comp, operation);\n      };\n      var flipRotateComponents = [\n        createBackButton(),\n        createSpacer(),\n        createIconButton('flip-horizontally', 'Flip horizontally', function (button) {\n          flipRotateOnAction(button, horizontalFlip);\n        }, false),\n        createIconButton('flip-vertically', 'Flip vertically', function (button) {\n          flipRotateOnAction(button, verticalFlip);\n        }, false),\n        createIconButton('rotate-left', 'Rotate counterclockwise', function (button) {\n          flipRotateOnAction(button, counterclockwiseRotate);\n        }, false),\n        createIconButton('rotate-right', 'Rotate clockwise', function (button) {\n          flipRotateOnAction(button, clockwiseRotate);\n        }, false),\n        createSpacer(),\n        createApplyButton()\n      ];\n      var FlipRotatePanel = Container.sketch({\n        dom: panelDom,\n        components: flipRotateComponents.map(function (mem) {\n          return mem.asSpec();\n        }),\n        containerBehaviours: derive$1([config('image-tools-fliprotate-buttons-events', [\n            run(external$2.disable(), function (comp, _se) {\n              disableAllComponents(flipRotateComponents, comp);\n            }),\n            run(external$2.enable(), function (comp, _se) {\n              enableAllComponents(flipRotateComponents, comp);\n            })\n          ])])\n      });\n      var makeSlider = function (label, onChoose, min, value, max) {\n        var labelPart = Slider.parts.label({\n          dom: {\n            tag: 'label',\n            classes: ['tox-label'],\n            innerHtml: providersBackstage.translate(label)\n          }\n        });\n        var spectrum = Slider.parts.spectrum({\n          dom: {\n            tag: 'div',\n            classes: ['tox-slider__rail'],\n            attributes: { role: 'presentation' }\n          }\n        });\n        var thumb = Slider.parts.thumb({\n          dom: {\n            tag: 'div',\n            classes: ['tox-slider__handle'],\n            attributes: { role: 'presentation' }\n          }\n        });\n        return record(Slider.sketch({\n          dom: {\n            tag: 'div',\n            classes: ['tox-slider'],\n            attributes: { role: 'presentation' }\n          },\n          model: {\n            mode: 'x',\n            minX: min,\n            maxX: max,\n            getInitialValue: constant({ x: value })\n          },\n          components: [\n            labelPart,\n            spectrum,\n            thumb\n          ],\n          sliderBehaviours: derive$1([Focusing.config({})]),\n          onChoose: onChoose\n        }));\n      };\n      var makeVariableSlider = function (label, transform, min, value, max) {\n        var onChoose = function (slider, _thumb, value) {\n          var valTransform = makeValueTransform(transform, value.x / 100);\n          emitTransform(slider, valTransform);\n        };\n        return makeSlider(label, onChoose, min, value, max);\n      };\n      var variableFilterPanelComponents = function (label, transform, min, value, max) {\n        return [\n          createBackButton(),\n          makeVariableSlider(label, transform, min, value, max),\n          createApplyButton()\n        ];\n      };\n      var createVariableFilterPanel = function (label, transform, min, value, max) {\n        var filterPanelComponents = variableFilterPanelComponents(label, transform, min, value, max);\n        return Container.sketch({\n          dom: panelDom,\n          components: filterPanelComponents.map(function (mem) {\n            return mem.asSpec();\n          }),\n          containerBehaviours: derive$1([config('image-tools-filter-panel-buttons-events', [\n              run(external$2.disable(), function (comp, _se) {\n                disableAllComponents(filterPanelComponents, comp);\n              }),\n              run(external$2.enable(), function (comp, _se) {\n                enableAllComponents(filterPanelComponents, comp);\n              })\n            ])])\n        });\n      };\n      var filterPanelComponents = [\n        createBackButton(),\n        createSpacer(),\n        createApplyButton()\n      ];\n      var FilterPanel = Container.sketch({\n        dom: panelDom,\n        components: filterPanelComponents.map(function (mem) {\n          return mem.asSpec();\n        })\n      });\n      var BrightnessPanel = createVariableFilterPanel('Brightness', brightness$1, -100, 0, 100);\n      var ContrastPanel = createVariableFilterPanel('Contrast', contrast$1, -100, 0, 100);\n      var GammaPanel = createVariableFilterPanel('Gamma', gamma$1, -100, 0, 100);\n      var makeColorTransform = function (red, green, blue) {\n        return function (ir) {\n          return colorize$1(ir, red, green, blue);\n        };\n      };\n      var makeColorSlider = function (label) {\n        var onChoose = function (slider, _thumb, _value) {\n          var redOpt = memRed.getOpt(slider);\n          var blueOpt = memBlue.getOpt(slider);\n          var greenOpt = memGreen.getOpt(slider);\n          redOpt.each(function (red) {\n            blueOpt.each(function (blue) {\n              greenOpt.each(function (green) {\n                var r = Representing.getValue(red).x / 100;\n                var g = Representing.getValue(green).x / 100;\n                var b = Representing.getValue(blue).x / 100;\n                var transform = makeColorTransform(r, g, b);\n                emitTransform(slider, transform);\n              });\n            });\n          });\n        };\n        return makeSlider(label, onChoose, 0, 100, 200);\n      };\n      var memRed = makeColorSlider('R');\n      var memGreen = makeColorSlider('G');\n      var memBlue = makeColorSlider('B');\n      var colorizePanelComponents = [\n        createBackButton(),\n        memRed,\n        memGreen,\n        memBlue,\n        createApplyButton()\n      ];\n      var ColorizePanel = Container.sketch({\n        dom: panelDom,\n        components: colorizePanelComponents.map(function (mem) {\n          return mem.asSpec();\n        })\n      });\n      var getTransformPanelEvent = function (panel, transform, update) {\n        return function (button) {\n          var swap = function () {\n            memContainer.getOpt(button).each(function (container) {\n              Replacing.set(container, [panel]);\n              update(container);\n            });\n          };\n          emit$1(button, internal.swap(), {\n            transform: transform,\n            swap: swap\n          });\n        };\n      };\n      var cropPanelUpdate = function (_anyInSystem) {\n        imagePanel.showCrop();\n      };\n      var resizePanelUpdate = function (anyInSystem) {\n        memSize.getOpt(anyInSystem).each(function (sizeInput) {\n          var measurements = imagePanel.getMeasurements();\n          var width = measurements.width;\n          var height = measurements.height;\n          Representing.setValue(sizeInput, {\n            width: width,\n            height: height\n          });\n        });\n      };\n      var sharpenTransform = Optional.some(sharpen$1);\n      var invertTransform = Optional.some(invert$1);\n      var buttonPanelComponents = [\n        createIconButton('crop', 'Crop', getTransformPanelEvent(CropPanel, Optional.none(), cropPanelUpdate), false),\n        createIconButton('resize', 'Resize', getTransformPanelEvent(ResizePanel, Optional.none(), resizePanelUpdate), false),\n        createIconButton('orientation', 'Orientation', getTransformPanelEvent(FlipRotatePanel, Optional.none(), noop$1), false),\n        createIconButton('brightness', 'Brightness', getTransformPanelEvent(BrightnessPanel, Optional.none(), noop$1), false),\n        createIconButton('sharpen', 'Sharpen', getTransformPanelEvent(FilterPanel, sharpenTransform, noop$1), false),\n        createIconButton('contrast', 'Contrast', getTransformPanelEvent(ContrastPanel, Optional.none(), noop$1), false),\n        createIconButton('color-levels', 'Color levels', getTransformPanelEvent(ColorizePanel, Optional.none(), noop$1), false),\n        createIconButton('gamma', 'Gamma', getTransformPanelEvent(GammaPanel, Optional.none(), noop$1), false),\n        createIconButton('invert', 'Invert', getTransformPanelEvent(FilterPanel, invertTransform, noop$1), false)\n      ];\n      var ButtonPanel = Container.sketch({\n        dom: panelDom,\n        components: buttonPanelComponents.map(function (mem) {\n          return mem.asSpec();\n        })\n      });\n      var container = Container.sketch({\n        dom: { tag: 'div' },\n        components: [ButtonPanel],\n        containerBehaviours: derive$1([Replacing.config({})])\n      });\n      var memContainer = record(container);\n      var getApplyButton = function (anyInSystem) {\n        return memContainer.getOpt(anyInSystem).map(function (container) {\n          var panel = container.components()[0];\n          return panel.components()[panel.components().length - 1];\n        });\n      };\n      return {\n        memContainer: memContainer,\n        getApplyButton: getApplyButton\n      };\n    };\n\n    var global$d = tinymce.util.Tools.resolve('tinymce.geom.Rect');\n\n    var global$e = tinymce.util.Tools.resolve('tinymce.dom.DomQuery');\n\n    var global$f = tinymce.util.Tools.resolve('tinymce.util.Observable');\n\n    var global$g = tinymce.util.Tools.resolve('tinymce.util.VK');\n\n    var getDocumentSize = function (doc) {\n      var max = Math.max;\n      var documentElement = doc.documentElement;\n      var body = doc.body;\n      var scrollWidth = max(documentElement.scrollWidth, body.scrollWidth);\n      var clientWidth = max(documentElement.clientWidth, body.clientWidth);\n      var offsetWidth = max(documentElement.offsetWidth, body.offsetWidth);\n      var scrollHeight = max(documentElement.scrollHeight, body.scrollHeight);\n      var clientHeight = max(documentElement.clientHeight, body.clientHeight);\n      var offsetHeight = max(documentElement.offsetHeight, body.offsetHeight);\n      return {\n        width: scrollWidth < offsetWidth ? clientWidth : scrollWidth,\n        height: scrollHeight < offsetHeight ? clientHeight : scrollHeight\n      };\n    };\n    var updateWithTouchData = function (e) {\n      var keys, i;\n      if (e.changedTouches) {\n        keys = 'screenX screenY pageX pageY clientX clientY'.split(' ');\n        for (i = 0; i < keys.length; i++) {\n          e[keys[i]] = e.changedTouches[0][keys[i]];\n        }\n      }\n    };\n    function DragHelper (id, settings) {\n      var $eventOverlay;\n      var doc = settings.document || document;\n      var downButton;\n      var startX, startY;\n      var handleElement = doc.getElementById(settings.handle || id);\n      var start = function (e) {\n        var docSize = getDocumentSize(doc);\n        var cursor;\n        updateWithTouchData(e);\n        e.preventDefault();\n        downButton = e.button;\n        var handleElm = handleElement;\n        startX = e.screenX;\n        startY = e.screenY;\n        if (window.getComputedStyle) {\n          cursor = window.getComputedStyle(handleElm, null).getPropertyValue('cursor');\n        } else {\n          cursor = handleElm.runtimeStyle.cursor;\n        }\n        $eventOverlay = global$e('<div></div>').css({\n          position: 'absolute',\n          top: 0,\n          left: 0,\n          width: docSize.width,\n          height: docSize.height,\n          zIndex: 2147483647,\n          opacity: 0.0001,\n          cursor: cursor\n        }).appendTo(doc.body);\n        global$e(doc).on('mousemove touchmove', drag).on('mouseup touchend', stop);\n        settings.start(e);\n      };\n      var drag = function (e) {\n        updateWithTouchData(e);\n        if (e.button !== downButton) {\n          return stop(e);\n        }\n        e.deltaX = e.screenX - startX;\n        e.deltaY = e.screenY - startY;\n        e.preventDefault();\n        settings.drag(e);\n      };\n      var stop = function (e) {\n        updateWithTouchData(e);\n        global$e(doc).off('mousemove touchmove', drag).off('mouseup touchend', stop);\n        $eventOverlay.remove();\n        if (settings.stop) {\n          settings.stop(e);\n        }\n      };\n      var destroy = function () {\n        global$e(handleElement).off();\n      };\n      global$e(handleElement).on('mousedown touchstart', start);\n      return { destroy: destroy };\n    }\n\n    var count = 0;\n    var create$7 = function (currentRect, viewPortRect, clampRect, containerElm, action) {\n      var dragHelpers;\n      var prefix = 'tox-';\n      var id = prefix + 'crid-' + count++;\n      var handles = [\n        {\n          name: 'move',\n          xMul: 0,\n          yMul: 0,\n          deltaX: 1,\n          deltaY: 1,\n          deltaW: 0,\n          deltaH: 0,\n          label: 'Crop Mask'\n        },\n        {\n          name: 'nw',\n          xMul: 0,\n          yMul: 0,\n          deltaX: 1,\n          deltaY: 1,\n          deltaW: -1,\n          deltaH: -1,\n          label: 'Top Left Crop Handle'\n        },\n        {\n          name: 'ne',\n          xMul: 1,\n          yMul: 0,\n          deltaX: 0,\n          deltaY: 1,\n          deltaW: 1,\n          deltaH: -1,\n          label: 'Top Right Crop Handle'\n        },\n        {\n          name: 'sw',\n          xMul: 0,\n          yMul: 1,\n          deltaX: 1,\n          deltaY: 0,\n          deltaW: -1,\n          deltaH: 1,\n          label: 'Bottom Left Crop Handle'\n        },\n        {\n          name: 'se',\n          xMul: 1,\n          yMul: 1,\n          deltaX: 0,\n          deltaY: 0,\n          deltaW: 1,\n          deltaH: 1,\n          label: 'Bottom Right Crop Handle'\n        }\n      ];\n      var blockers = [\n        'top',\n        'right',\n        'bottom',\n        'left'\n      ];\n      var getAbsoluteRect = function (outerRect, relativeRect) {\n        return {\n          x: relativeRect.x + outerRect.x,\n          y: relativeRect.y + outerRect.y,\n          w: relativeRect.w,\n          h: relativeRect.h\n        };\n      };\n      var getRelativeRect = function (outerRect, innerRect) {\n        return {\n          x: innerRect.x - outerRect.x,\n          y: innerRect.y - outerRect.y,\n          w: innerRect.w,\n          h: innerRect.h\n        };\n      };\n      var getInnerRect = function () {\n        return getRelativeRect(clampRect, currentRect);\n      };\n      var moveRect = function (handle, startRect, deltaX, deltaY) {\n        var x, y, w, h, rect;\n        x = startRect.x;\n        y = startRect.y;\n        w = startRect.w;\n        h = startRect.h;\n        x += deltaX * handle.deltaX;\n        y += deltaY * handle.deltaY;\n        w += deltaX * handle.deltaW;\n        h += deltaY * handle.deltaH;\n        if (w < 20) {\n          w = 20;\n        }\n        if (h < 20) {\n          h = 20;\n        }\n        rect = currentRect = global$d.clamp({\n          x: x,\n          y: y,\n          w: w,\n          h: h\n        }, clampRect, handle.name === 'move');\n        rect = getRelativeRect(clampRect, rect);\n        instance.fire('updateRect', { rect: rect });\n        setInnerRect(rect);\n      };\n      var render = function () {\n        var createDragHelper = function (handle) {\n          var startRect;\n          return DragHelper(id, {\n            document: containerElm.ownerDocument,\n            handle: id + '-' + handle.name,\n            start: function () {\n              startRect = currentRect;\n            },\n            drag: function (e) {\n              moveRect(handle, startRect, e.deltaX, e.deltaY);\n            }\n          });\n        };\n        global$e('<div id=\"' + id + '\" class=\"' + prefix + 'croprect-container\"' + ' role=\"grid\" aria-dropeffect=\"execute\">').appendTo(containerElm);\n        global$c.each(blockers, function (blocker) {\n          global$e('#' + id, containerElm).append('<div id=\"' + id + '-' + blocker + '\"class=\"' + prefix + 'croprect-block\" style=\"display: none\" data-mce-bogus=\"all\">');\n        });\n        global$c.each(handles, function (handle) {\n          global$e('#' + id, containerElm).append('<div id=\"' + id + '-' + handle.name + '\" class=\"' + prefix + 'croprect-handle ' + prefix + 'croprect-handle-' + handle.name + '\"' + 'style=\"display: none\" data-mce-bogus=\"all\" role=\"gridcell\" tabindex=\"-1\"' + ' aria-label=\"' + handle.label + '\" aria-grabbed=\"false\" title=\"' + handle.label + '\">');\n        });\n        dragHelpers = global$c.map(handles, createDragHelper);\n        repaint(currentRect);\n        global$e(containerElm).on('focusin focusout', function (e) {\n          global$e(e.target).attr('aria-grabbed', e.type === 'focus' ? 'true' : 'false');\n        });\n        global$e(containerElm).on('keydown', function (e) {\n          var activeHandle;\n          global$c.each(handles, function (handle) {\n            if (e.target.id === id + '-' + handle.name) {\n              activeHandle = handle;\n              return false;\n            }\n          });\n          var moveAndBlock = function (evt, handle, startRect, deltaX, deltaY) {\n            evt.stopPropagation();\n            evt.preventDefault();\n            moveRect(activeHandle, startRect, deltaX, deltaY);\n          };\n          switch (e.keyCode) {\n          case global$g.LEFT:\n            moveAndBlock(e, activeHandle, currentRect, -10, 0);\n            break;\n          case global$g.RIGHT:\n            moveAndBlock(e, activeHandle, currentRect, 10, 0);\n            break;\n          case global$g.UP:\n            moveAndBlock(e, activeHandle, currentRect, 0, -10);\n            break;\n          case global$g.DOWN:\n            moveAndBlock(e, activeHandle, currentRect, 0, 10);\n            break;\n          case global$g.ENTER:\n          case global$g.SPACEBAR:\n            e.preventDefault();\n            action();\n            break;\n          }\n        });\n      };\n      var toggleVisibility = function (state) {\n        var selectors = global$c.map(handles, function (handle) {\n          return '#' + id + '-' + handle.name;\n        }).concat(global$c.map(blockers, function (blocker) {\n          return '#' + id + '-' + blocker;\n        })).join(',');\n        if (state) {\n          global$e(selectors, containerElm).show();\n        } else {\n          global$e(selectors, containerElm).hide();\n        }\n      };\n      var repaint = function (rect) {\n        var updateElementRect = function (name, rect) {\n          if (rect.h < 0) {\n            rect.h = 0;\n          }\n          if (rect.w < 0) {\n            rect.w = 0;\n          }\n          global$e('#' + id + '-' + name, containerElm).css({\n            left: rect.x,\n            top: rect.y,\n            width: rect.w,\n            height: rect.h\n          });\n        };\n        global$c.each(handles, function (handle) {\n          global$e('#' + id + '-' + handle.name, containerElm).css({\n            left: rect.w * handle.xMul + rect.x,\n            top: rect.h * handle.yMul + rect.y\n          });\n        });\n        updateElementRect('top', {\n          x: viewPortRect.x,\n          y: viewPortRect.y,\n          w: viewPortRect.w,\n          h: rect.y - viewPortRect.y\n        });\n        updateElementRect('right', {\n          x: rect.x + rect.w,\n          y: rect.y,\n          w: viewPortRect.w - rect.x - rect.w + viewPortRect.x,\n          h: rect.h\n        });\n        updateElementRect('bottom', {\n          x: viewPortRect.x,\n          y: rect.y + rect.h,\n          w: viewPortRect.w,\n          h: viewPortRect.h - rect.y - rect.h + viewPortRect.y\n        });\n        updateElementRect('left', {\n          x: viewPortRect.x,\n          y: rect.y,\n          w: rect.x - viewPortRect.x,\n          h: rect.h\n        });\n        updateElementRect('move', rect);\n      };\n      var setRect = function (rect) {\n        currentRect = rect;\n        repaint(currentRect);\n      };\n      var setViewPortRect = function (rect) {\n        viewPortRect = rect;\n        repaint(currentRect);\n      };\n      var setInnerRect = function (rect) {\n        setRect(getAbsoluteRect(clampRect, rect));\n      };\n      var setClampRect = function (rect) {\n        clampRect = rect;\n        repaint(currentRect);\n      };\n      var destroy = function () {\n        global$c.each(dragHelpers, function (helper) {\n          helper.destroy();\n        });\n        dragHelpers = [];\n      };\n      render();\n      var instance = global$c.extend({\n        toggleVisibility: toggleVisibility,\n        setClampRect: setClampRect,\n        setRect: setRect,\n        getInnerRect: getInnerRect,\n        setInnerRect: setInnerRect,\n        setViewPortRect: setViewPortRect,\n        destroy: destroy\n      }, global$f);\n      return instance;\n    };\n    var CropRect = { create: create$7 };\n\n    var loadImage = function (image) {\n      return new global$4(function (resolve) {\n        var loaded = function () {\n          image.removeEventListener('load', loaded);\n          resolve(image);\n        };\n        if (image.complete) {\n          resolve(image);\n        } else {\n          image.addEventListener('load', loaded);\n        }\n      });\n    };\n    var renderImagePanel = function (initialUrl) {\n      var memBg = record({\n        dom: {\n          tag: 'div',\n          classes: ['tox-image-tools__image-bg'],\n          attributes: { role: 'presentation' }\n        }\n      });\n      var zoomState = Cell(1);\n      var cropRect = Cell(Optional.none());\n      var rectState = Cell({\n        x: 0,\n        y: 0,\n        w: 1,\n        h: 1\n      });\n      var viewRectState = Cell({\n        x: 0,\n        y: 0,\n        w: 1,\n        h: 1\n      });\n      var repaintImg = function (anyInSystem, img) {\n        memContainer.getOpt(anyInSystem).each(function (panel) {\n          var zoom = zoomState.get();\n          var panelW = get$8(panel.element);\n          var panelH = get$7(panel.element);\n          var width = img.dom.naturalWidth * zoom;\n          var height = img.dom.naturalHeight * zoom;\n          var left = Math.max(0, panelW / 2 - width / 2);\n          var top = Math.max(0, panelH / 2 - height / 2);\n          var css = {\n            left: left.toString() + 'px',\n            top: top.toString() + 'px',\n            width: width.toString() + 'px',\n            height: height.toString() + 'px',\n            position: 'absolute'\n          };\n          setAll$1(img, css);\n          memBg.getOpt(panel).each(function (bg) {\n            setAll$1(bg.element, css);\n          });\n          cropRect.get().each(function (cRect) {\n            var rect = rectState.get();\n            cRect.setRect({\n              x: rect.x * zoom + left,\n              y: rect.y * zoom + top,\n              w: rect.w * zoom,\n              h: rect.h * zoom\n            });\n            cRect.setClampRect({\n              x: left,\n              y: top,\n              w: width,\n              h: height\n            });\n            cRect.setViewPortRect({\n              x: 0,\n              y: 0,\n              w: panelW,\n              h: panelH\n            });\n          });\n        });\n      };\n      var zoomFit = function (anyInSystem, img) {\n        memContainer.getOpt(anyInSystem).each(function (panel) {\n          var panelW = get$8(panel.element);\n          var panelH = get$7(panel.element);\n          var width = img.dom.naturalWidth;\n          var height = img.dom.naturalHeight;\n          var zoom = Math.min(panelW / width, panelH / height);\n          if (zoom >= 1) {\n            zoomState.set(1);\n          } else {\n            zoomState.set(zoom);\n          }\n        });\n      };\n      var updateSrc = function (anyInSystem, url) {\n        var img = SugarElement.fromTag('img');\n        set$1(img, 'src', url);\n        return loadImage(img.dom).then(function () {\n          return memContainer.getOpt(anyInSystem).map(function (panel) {\n            var aImg = external({ element: img });\n            Replacing.replaceAt(panel, 1, Optional.some(aImg));\n            var lastViewRect = viewRectState.get();\n            var viewRect = {\n              x: 0,\n              y: 0,\n              w: img.dom.naturalWidth,\n              h: img.dom.naturalHeight\n            };\n            viewRectState.set(viewRect);\n            var rect = global$d.inflate(viewRect, -20, -20);\n            rectState.set(rect);\n            if (lastViewRect.w !== viewRect.w || lastViewRect.h !== viewRect.h) {\n              zoomFit(panel, img);\n            }\n            repaintImg(panel, img);\n            return img;\n          });\n        });\n      };\n      var zoom = function (anyInSystem, direction) {\n        var currentZoom = zoomState.get();\n        var newZoom = direction > 0 ? Math.min(2, currentZoom + 0.1) : Math.max(0.1, currentZoom - 0.1);\n        zoomState.set(newZoom);\n        memContainer.getOpt(anyInSystem).each(function (panel) {\n          var img = panel.components()[1].element;\n          repaintImg(panel, img);\n        });\n      };\n      var showCrop = function () {\n        cropRect.get().each(function (cRect) {\n          cRect.toggleVisibility(true);\n        });\n      };\n      var hideCrop = function () {\n        cropRect.get().each(function (cRect) {\n          cRect.toggleVisibility(false);\n        });\n      };\n      var getRect = function () {\n        return rectState.get();\n      };\n      var container = Container.sketch({\n        dom: {\n          tag: 'div',\n          classes: ['tox-image-tools__image']\n        },\n        components: [\n          memBg.asSpec(),\n          {\n            dom: {\n              tag: 'img',\n              attributes: { src: initialUrl }\n            }\n          },\n          {\n            dom: { tag: 'div' },\n            behaviours: derive$1([config('image-panel-crop-events', [runOnAttached(function (comp) {\n                  memContainer.getOpt(comp).each(function (container) {\n                    var el = container.element.dom;\n                    var cRect = CropRect.create({\n                      x: 10,\n                      y: 10,\n                      w: 100,\n                      h: 100\n                    }, {\n                      x: 0,\n                      y: 0,\n                      w: 200,\n                      h: 200\n                    }, {\n                      x: 0,\n                      y: 0,\n                      w: 200,\n                      h: 200\n                    }, el, noop);\n                    cRect.toggleVisibility(false);\n                    cRect.on('updateRect', function (e) {\n                      var rect = e.rect;\n                      var zoom = zoomState.get();\n                      var newRect = {\n                        x: Math.round(rect.x / zoom),\n                        y: Math.round(rect.y / zoom),\n                        w: Math.round(rect.w / zoom),\n                        h: Math.round(rect.h / zoom)\n                      };\n                      rectState.set(newRect);\n                    });\n                    cropRect.set(Optional.some(cRect));\n                  });\n                })])])\n          }\n        ],\n        containerBehaviours: derive$1([\n          Replacing.config({}),\n          config('image-panel-events', [runOnAttached(function (comp) {\n              updateSrc(comp, initialUrl);\n            })])\n        ])\n      });\n      var memContainer = record(container);\n      var getMeasurements = function () {\n        var viewRect = viewRectState.get();\n        return {\n          width: viewRect.w,\n          height: viewRect.h\n        };\n      };\n      return {\n        memContainer: memContainer,\n        updateSrc: updateSrc,\n        zoom: zoom,\n        showCrop: showCrop,\n        hideCrop: hideCrop,\n        getRect: getRect,\n        getMeasurements: getMeasurements\n      };\n    };\n\n    var createButton = function (innerHtml, icon, disabled, action, providersBackstage) {\n      return renderIconButton({\n        name: innerHtml,\n        icon: Optional.some(icon),\n        disabled: disabled,\n        tooltip: Optional.some(innerHtml),\n        primary: false,\n        borderless: false\n      }, action, providersBackstage);\n    };\n    var setButtonEnabled = function (button, enabled) {\n      if (enabled) {\n        Disabling.enable(button);\n      } else {\n        Disabling.disable(button);\n      }\n    };\n    var renderSideBar = function (providersBackstage) {\n      var updateButtonUndoStates = function (anyInSystem, undoEnabled, redoEnabled) {\n        memUndo.getOpt(anyInSystem).each(function (undo) {\n          setButtonEnabled(undo, undoEnabled);\n        });\n        memRedo.getOpt(anyInSystem).each(function (redo) {\n          setButtonEnabled(redo, redoEnabled);\n        });\n      };\n      var memUndo = record(createButton('Undo', 'undo', true, function (button) {\n        emitWith(button, internal.undo(), { direction: 1 });\n      }, providersBackstage));\n      var memRedo = record(createButton('Redo', 'redo', true, function (button) {\n        emitWith(button, internal.redo(), { direction: 1 });\n      }, providersBackstage));\n      var container = Container.sketch({\n        dom: {\n          tag: 'div',\n          classes: [\n            'tox-image-tools__toolbar',\n            'tox-image-tools__sidebar'\n          ]\n        },\n        components: [\n          memUndo.asSpec(),\n          memRedo.asSpec(),\n          createButton('Zoom in', 'zoom-in', false, function (button) {\n            emitWith(button, internal.zoom(), { direction: 1 });\n          }, providersBackstage),\n          createButton('Zoom out', 'zoom-out', false, function (button) {\n            emitWith(button, internal.zoom(), { direction: -1 });\n          }, providersBackstage)\n        ]\n      });\n      return {\n        container: container,\n        updateButtonUndoStates: updateButtonUndoStates\n      };\n    };\n\n    function UndoStack () {\n      var data = [];\n      var index = -1;\n      var add = function (state) {\n        var removed = data.splice(++index);\n        data.push(state);\n        return {\n          state: state,\n          removed: removed\n        };\n      };\n      var undo = function () {\n        if (canUndo()) {\n          return data[--index];\n        }\n      };\n      var redo = function () {\n        if (canRedo()) {\n          return data[++index];\n        }\n      };\n      var canUndo = function () {\n        return index > 0;\n      };\n      var canRedo = function () {\n        return index !== -1 && index < data.length - 1;\n      };\n      return {\n        data: data,\n        add: add,\n        undo: undo,\n        redo: redo,\n        canUndo: canUndo,\n        canRedo: canRedo\n      };\n    }\n\n    var makeState = function (initialState) {\n      var blobState = Cell(initialState);\n      var tempState = Cell(Optional.none());\n      var undoStack = UndoStack();\n      undoStack.add(initialState);\n      var getBlobState = function () {\n        return blobState.get();\n      };\n      var setBlobState = function (state) {\n        blobState.set(state);\n      };\n      var getTempState = function () {\n        return tempState.get().fold(function () {\n          return blobState.get();\n        }, function (temp) {\n          return temp;\n        });\n      };\n      var updateTempState = function (blob) {\n        var newTempState = createState(blob);\n        destroyTempState();\n        tempState.set(Optional.some(newTempState));\n        return newTempState.url;\n      };\n      var createState = function (blob) {\n        return {\n          blob: blob,\n          url: URL.createObjectURL(blob)\n        };\n      };\n      var destroyState = function (state) {\n        URL.revokeObjectURL(state.url);\n      };\n      var destroyStates = function (states) {\n        global$c.each(states, destroyState);\n      };\n      var destroyTempState = function () {\n        tempState.get().each(destroyState);\n        tempState.set(Optional.none());\n      };\n      var addBlobState = function (blob) {\n        var newState = createState(blob);\n        setBlobState(newState);\n        var removed = undoStack.add(newState).removed;\n        destroyStates(removed);\n        return newState.url;\n      };\n      var addTempState = function (blob) {\n        var newState = createState(blob);\n        tempState.set(Optional.some(newState));\n        return newState.url;\n      };\n      var applyTempState = function (postApply) {\n        return tempState.get().fold(noop, function (temp) {\n          addBlobState(temp.blob);\n          postApply();\n        });\n      };\n      var undo = function () {\n        var currentState = undoStack.undo();\n        setBlobState(currentState);\n        return currentState.url;\n      };\n      var redo = function () {\n        var currentState = undoStack.redo();\n        setBlobState(currentState);\n        return currentState.url;\n      };\n      var getHistoryStates = function () {\n        var undoEnabled = undoStack.canUndo();\n        var redoEnabled = undoStack.canRedo();\n        return {\n          undoEnabled: undoEnabled,\n          redoEnabled: redoEnabled\n        };\n      };\n      return {\n        getBlobState: getBlobState,\n        setBlobState: setBlobState,\n        addBlobState: addBlobState,\n        getTempState: getTempState,\n        updateTempState: updateTempState,\n        addTempState: addTempState,\n        applyTempState: applyTempState,\n        destroyTempState: destroyTempState,\n        undo: undo,\n        redo: redo,\n        getHistoryStates: getHistoryStates\n      };\n    };\n\n    var renderImageTools = function (detail, providersBackstage) {\n      var state = makeState(detail.currentState);\n      var zoom = function (anyInSystem, simulatedEvent) {\n        var direction = simulatedEvent.event.direction;\n        imagePanel.zoom(anyInSystem, direction);\n      };\n      var updateButtonUndoStates = function (anyInSystem) {\n        var historyStates = state.getHistoryStates();\n        sideBar.updateButtonUndoStates(anyInSystem, historyStates.undoEnabled, historyStates.redoEnabled);\n        emitWith(anyInSystem, external$2.formActionEvent, {\n          name: external$2.saveState(),\n          value: historyStates.undoEnabled\n        });\n      };\n      var disableUndoRedo = function (anyInSystem) {\n        sideBar.updateButtonUndoStates(anyInSystem, false, false);\n      };\n      var undo = function (anyInSystem, _simulatedEvent) {\n        var url = state.undo();\n        updateSrc(anyInSystem, url).then(function (_oImg) {\n          unblock(anyInSystem);\n          updateButtonUndoStates(anyInSystem);\n        });\n      };\n      var redo = function (anyInSystem, _simulatedEvent) {\n        var url = state.redo();\n        updateSrc(anyInSystem, url).then(function (_oImg) {\n          unblock(anyInSystem);\n          updateButtonUndoStates(anyInSystem);\n        });\n      };\n      var imageResultToBlob = function (ir) {\n        return ir.toBlob();\n      };\n      var block = function (anyInSystem) {\n        emitWith(anyInSystem, external$2.formActionEvent, {\n          name: external$2.disable(),\n          value: {}\n        });\n      };\n      var unblock = function (anyInSystem) {\n        editPanel.getApplyButton(anyInSystem).each(function (applyButton) {\n          Disabling.enable(applyButton);\n        });\n        emitWith(anyInSystem, external$2.formActionEvent, {\n          name: external$2.enable(),\n          value: {}\n        });\n      };\n      var updateSrc = function (anyInSystem, src) {\n        block(anyInSystem);\n        return imagePanel.updateSrc(anyInSystem, src);\n      };\n      var blobManipulate = function (anyInSystem, blob, filter, action, swap) {\n        block(anyInSystem);\n        return blobToImageResult(blob).then(filter).then(imageResultToBlob).then(action).then(function (url) {\n          return updateSrc(anyInSystem, url).then(function (oImg) {\n            updateButtonUndoStates(anyInSystem);\n            swap();\n            unblock(anyInSystem);\n            return oImg;\n          });\n        }).catch(function (err) {\n          console.log(err);\n          unblock(anyInSystem);\n          return err;\n        });\n      };\n      var manipulate = function (anyInSystem, filter, swap) {\n        var blob = state.getBlobState().blob;\n        var action = function (blob) {\n          return state.updateTempState(blob);\n        };\n        blobManipulate(anyInSystem, blob, filter, action, swap);\n      };\n      var tempManipulate = function (anyInSystem, filter) {\n        var blob = state.getTempState().blob;\n        var action = function (blob) {\n          return state.addTempState(blob);\n        };\n        blobManipulate(anyInSystem, blob, filter, action, noop);\n      };\n      var manipulateApply = function (anyInSystem, filter, swap) {\n        var blob = state.getBlobState().blob;\n        var action = function (blob) {\n          var url = state.addBlobState(blob);\n          destroyTempState(anyInSystem);\n          return url;\n        };\n        blobManipulate(anyInSystem, blob, filter, action, swap);\n      };\n      var apply = function (anyInSystem, simulatedEvent) {\n        var postApply = function () {\n          destroyTempState(anyInSystem);\n          var swap = simulatedEvent.event.swap;\n          swap();\n        };\n        state.applyTempState(postApply);\n      };\n      var destroyTempState = function (anyInSystem) {\n        var currentUrl = state.getBlobState().url;\n        state.destroyTempState();\n        updateButtonUndoStates(anyInSystem);\n        return currentUrl;\n      };\n      var cancel = function (anyInSystem) {\n        var currentUrl = destroyTempState(anyInSystem);\n        updateSrc(anyInSystem, currentUrl).then(function (_oImg) {\n          unblock(anyInSystem);\n        });\n      };\n      var back = function (anyInSystem, simulatedEvent) {\n        cancel(anyInSystem);\n        var swap = simulatedEvent.event.swap;\n        swap();\n        imagePanel.hideCrop();\n      };\n      var transform = function (anyInSystem, simulatedEvent) {\n        return manipulate(anyInSystem, simulatedEvent.event.transform, noop);\n      };\n      var tempTransform = function (anyInSystem, simulatedEvent) {\n        return tempManipulate(anyInSystem, simulatedEvent.event.transform);\n      };\n      var transformApply = function (anyInSystem, simulatedEvent) {\n        return manipulateApply(anyInSystem, simulatedEvent.event.transform, simulatedEvent.event.swap);\n      };\n      var imagePanel = renderImagePanel(detail.currentState.url);\n      var sideBar = renderSideBar(providersBackstage);\n      var editPanel = renderEditPanel(imagePanel, providersBackstage);\n      var swap = function (anyInSystem, simulatedEvent) {\n        disableUndoRedo(anyInSystem);\n        var transform = simulatedEvent.event.transform;\n        var swap = simulatedEvent.event.swap;\n        transform.fold(function () {\n          swap();\n        }, function (transform) {\n          manipulate(anyInSystem, transform, swap);\n        });\n      };\n      return {\n        dom: {\n          tag: 'div',\n          attributes: { role: 'presentation' }\n        },\n        components: [\n          editPanel.memContainer.asSpec(),\n          imagePanel.memContainer.asSpec(),\n          sideBar.container\n        ],\n        behaviours: derive$1([\n          Representing.config({\n            store: {\n              mode: 'manual',\n              getValue: function () {\n                return state.getBlobState();\n              }\n            }\n          }),\n          config('image-tools-events', [\n            run(internal.undo(), undo),\n            run(internal.redo(), redo),\n            run(internal.zoom(), zoom),\n            run(internal.back(), back),\n            run(internal.apply(), apply),\n            run(internal.transform(), transform),\n            run(internal.tempTransform(), tempTransform),\n            run(internal.transformApply(), transformApply),\n            run(internal.swap(), swap)\n          ]),\n          ComposingConfigs.self()\n        ])\n      };\n    };\n\n    var renderLabel$2 = function (spec, backstageShared) {\n      var label = {\n        dom: {\n          tag: 'label',\n          innerHtml: backstageShared.providers.translate(spec.label),\n          classes: ['tox-label']\n        }\n      };\n      var comps = map(spec.items, backstageShared.interpreter);\n      return {\n        dom: {\n          tag: 'div',\n          classes: ['tox-form__group']\n        },\n        components: [label].concat(comps),\n        behaviours: derive$1([\n          ComposingConfigs.self(),\n          Replacing.config({}),\n          RepresentingConfigs.domHtml(Optional.none()),\n          Keying.config({ mode: 'acyclic' })\n        ])\n      };\n    };\n\n    var isSingleListItem = function (item) {\n      return !has(item, 'items');\n    };\n    var dataAttribute = 'data-value';\n    var fetchItems = function (dropdownComp, name, items, selectedValue) {\n      return map(items, function (item) {\n        if (!isSingleListItem(item)) {\n          return {\n            type: 'nestedmenuitem',\n            text: item.text,\n            getSubmenuItems: function () {\n              return fetchItems(dropdownComp, name, item.items, selectedValue);\n            }\n          };\n        } else {\n          return {\n            type: 'togglemenuitem',\n            text: item.text,\n            value: item.value,\n            active: item.value === selectedValue,\n            onAction: function () {\n              Representing.setValue(dropdownComp, item.value);\n              emitWith(dropdownComp, formChangeEvent, { name: name });\n              Focusing.focus(dropdownComp);\n            }\n          };\n        }\n      });\n    };\n    var findItemByValue = function (items, value) {\n      return findMap(items, function (item) {\n        if (!isSingleListItem(item)) {\n          return findItemByValue(item.items, value);\n        } else {\n          return someIf(item.value === value, item);\n        }\n      });\n    };\n    var renderListBox = function (spec, backstage) {\n      var providersBackstage = backstage.shared.providers;\n      var initialItem = head(spec.items).filter(isSingleListItem);\n      var pLabel = spec.label.map(function (label) {\n        return renderLabel(label, providersBackstage);\n      });\n      var pField = FormField.parts.field({\n        dom: {},\n        factory: {\n          sketch: function (sketchSpec) {\n            return renderCommonDropdown({\n              uid: sketchSpec.uid,\n              text: initialItem.map(function (item) {\n                return item.text;\n              }),\n              icon: Optional.none(),\n              tooltip: spec.label,\n              role: Optional.none(),\n              fetch: function (comp, callback) {\n                var items = fetchItems(comp, spec.name, spec.items, Representing.getValue(comp));\n                callback(build$2(items, ItemResponse$1.CLOSE_ON_EXECUTE, backstage, false));\n              },\n              onSetup: constant(noop),\n              getApi: constant({}),\n              columns: 1,\n              presets: 'normal',\n              classes: [],\n              dropdownBehaviours: [\n                Tabstopping.config({}),\n                Representing.config({\n                  store: {\n                    mode: 'manual',\n                    initialValue: initialItem.map(function (item) {\n                      return item.value;\n                    }).getOr(''),\n                    getValue: function (comp) {\n                      return get$3(comp.element, dataAttribute);\n                    },\n                    setValue: function (comp, data) {\n                      findItemByValue(spec.items, data).each(function (item) {\n                        set$1(comp.element, dataAttribute, item.value);\n                        emitWith(comp, updateMenuText, { text: item.text });\n                      });\n                    }\n                  }\n                })\n              ]\n            }, 'tox-listbox', backstage.shared);\n          }\n        }\n      });\n      var listBoxWrap = {\n        dom: {\n          tag: 'div',\n          classes: ['tox-listboxfield']\n        },\n        components: [pField]\n      };\n      return FormField.sketch({\n        dom: {\n          tag: 'div',\n          classes: ['tox-form__group']\n        },\n        components: flatten([\n          pLabel.toArray(),\n          [listBoxWrap]\n        ]),\n        fieldBehaviours: derive$1([Disabling.config({\n            disabled: constant(spec.disabled),\n            onDisabled: function (comp) {\n              FormField.getField(comp).each(Disabling.disable);\n            },\n            onEnabled: function (comp) {\n              FormField.getField(comp).each(Disabling.enable);\n            }\n          })])\n      });\n    };\n\n    var renderPanel = function (spec, backstage) {\n      return {\n        dom: {\n          tag: 'div',\n          classes: spec.classes\n        },\n        components: map(spec.items, backstage.shared.interpreter)\n      };\n    };\n\n    var factory$8 = function (detail, _spec) {\n      var options = map(detail.options, function (option) {\n        return {\n          dom: {\n            tag: 'option',\n            value: option.value,\n            innerHtml: option.text\n          }\n        };\n      });\n      var initialValues = detail.data.map(function (v) {\n        return wrap$1('initialValue', v);\n      }).getOr({});\n      return {\n        uid: detail.uid,\n        dom: {\n          tag: 'select',\n          classes: detail.selectClasses,\n          attributes: detail.selectAttributes\n        },\n        components: options,\n        behaviours: augment(detail.selectBehaviours, [\n          Focusing.config({}),\n          Representing.config({\n            store: __assign({\n              mode: 'manual',\n              getValue: function (select) {\n                return get$6(select.element);\n              },\n              setValue: function (select, newValue) {\n                var found = find(detail.options, function (opt) {\n                  return opt.value === newValue;\n                });\n                if (found.isSome()) {\n                  set$3(select.element, newValue);\n                }\n              }\n            }, initialValues)\n          })\n        ])\n      };\n    };\n    var HtmlSelect = single$2({\n      name: 'HtmlSelect',\n      configFields: [\n        strict$1('options'),\n        field$1('selectBehaviours', [\n          Focusing,\n          Representing\n        ]),\n        defaulted$1('selectClasses', []),\n        defaulted$1('selectAttributes', {}),\n        option('data')\n      ],\n      factory: factory$8\n    });\n\n    var renderSelectBox = function (spec, providersBackstage) {\n      var translatedOptions = map(spec.items, function (item) {\n        return {\n          text: providersBackstage.translate(item.text),\n          value: item.value\n        };\n      });\n      var pLabel = spec.label.map(function (label) {\n        return renderLabel(label, providersBackstage);\n      });\n      var pField = FormField.parts.field({\n        dom: {},\n        selectAttributes: { size: spec.size },\n        options: translatedOptions,\n        factory: HtmlSelect,\n        selectBehaviours: derive$1([\n          Disabling.config({\n            disabled: function () {\n              return spec.disabled || providersBackstage.isDisabled();\n            }\n          }),\n          Tabstopping.config({}),\n          config('selectbox-change', [run(change(), function (component, _) {\n              emitWith(component, formChangeEvent, { name: spec.name });\n            })])\n        ])\n      });\n      var chevron = spec.size > 1 ? Optional.none() : Optional.some({\n        dom: {\n          tag: 'div',\n          classes: ['tox-selectfield__icon-js'],\n          innerHtml: get$e('chevron-down', providersBackstage.icons)\n        }\n      });\n      var selectWrap = {\n        dom: {\n          tag: 'div',\n          classes: ['tox-selectfield']\n        },\n        components: flatten([\n          [pField],\n          chevron.toArray()\n        ])\n      };\n      return FormField.sketch({\n        dom: {\n          tag: 'div',\n          classes: ['tox-form__group']\n        },\n        components: flatten([\n          pLabel.toArray(),\n          [selectWrap]\n        ]),\n        fieldBehaviours: derive$1([\n          Disabling.config({\n            disabled: function () {\n              return spec.disabled || providersBackstage.isDisabled();\n            },\n            onDisabled: function (comp) {\n              FormField.getField(comp).each(Disabling.disable);\n            },\n            onEnabled: function (comp) {\n              FormField.getField(comp).each(Disabling.enable);\n            }\n          }),\n          receivingConfig()\n        ])\n      });\n    };\n\n    var renderTable = function (spec, providersBackstage) {\n      var renderTh = function (text) {\n        return {\n          dom: {\n            tag: 'th',\n            innerHtml: providersBackstage.translate(text)\n          }\n        };\n      };\n      var renderHeader = function (header) {\n        return {\n          dom: { tag: 'thead' },\n          components: [{\n              dom: { tag: 'tr' },\n              components: map(header, renderTh)\n            }]\n        };\n      };\n      var renderTd = function (text) {\n        return {\n          dom: {\n            tag: 'td',\n            innerHtml: providersBackstage.translate(text)\n          }\n        };\n      };\n      var renderTr = function (row) {\n        return {\n          dom: { tag: 'tr' },\n          components: map(row, renderTd)\n        };\n      };\n      var renderRows = function (rows) {\n        return {\n          dom: { tag: 'tbody' },\n          components: map(rows, renderTr)\n        };\n      };\n      return {\n        dom: {\n          tag: 'table',\n          classes: ['tox-dialog__table']\n        },\n        components: [\n          renderHeader(spec.header),\n          renderRows(spec.cells)\n        ],\n        behaviours: derive$1([\n          Tabstopping.config({}),\n          Focusing.config({})\n        ])\n      };\n    };\n\n    var renderTextField = function (spec, providersBackstage) {\n      var pLabel = spec.label.map(function (label) {\n        return renderLabel(label, providersBackstage);\n      });\n      var baseInputBehaviours = [\n        Disabling.config({\n          disabled: function () {\n            return spec.disabled || providersBackstage.isDisabled();\n          }\n        }),\n        receivingConfig(),\n        Keying.config({\n          mode: 'execution',\n          useEnter: spec.multiline !== true,\n          useControlEnter: spec.multiline === true,\n          execute: function (comp) {\n            emit(comp, formSubmitEvent);\n            return Optional.some(true);\n          }\n        }),\n        config('textfield-change', [\n          run(input(), function (component, _) {\n            emitWith(component, formChangeEvent, { name: spec.name });\n          }),\n          run(postPaste(), function (component, _) {\n            emitWith(component, formChangeEvent, { name: spec.name });\n          })\n        ]),\n        Tabstopping.config({})\n      ];\n      var validatingBehaviours = spec.validation.map(function (vl) {\n        return Invalidating.config({\n          getRoot: function (input) {\n            return parent(input.element);\n          },\n          invalidClass: 'tox-invalid',\n          validator: {\n            validate: function (input) {\n              var v = Representing.getValue(input);\n              var result = vl.validator(v);\n              return Future.pure(result === true ? Result.value(v) : Result.error(result));\n            },\n            validateOnLoad: vl.validateOnLoad\n          }\n        });\n      }).toArray();\n      var placeholder = spec.placeholder.fold(constant({}), function (p) {\n        return { placeholder: providersBackstage.translate(p) };\n      });\n      var inputMode = spec.inputMode.fold(constant({}), function (mode) {\n        return { inputmode: mode };\n      });\n      var inputAttributes = __assign(__assign({}, placeholder), inputMode);\n      var pField = FormField.parts.field({\n        tag: spec.multiline === true ? 'textarea' : 'input',\n        inputAttributes: inputAttributes,\n        inputClasses: [spec.classname],\n        inputBehaviours: derive$1(flatten([\n          baseInputBehaviours,\n          validatingBehaviours\n        ])),\n        selectOnFocus: false,\n        factory: Input\n      });\n      var extraClasses = spec.flex ? ['tox-form__group--stretched'] : [];\n      var extraClasses2 = extraClasses.concat(spec.maximized ? ['tox-form-group--maximize'] : []);\n      var extraBehaviours = [\n        Disabling.config({\n          disabled: function () {\n            return spec.disabled || providersBackstage.isDisabled();\n          },\n          onDisabled: function (comp) {\n            FormField.getField(comp).each(Disabling.disable);\n          },\n          onEnabled: function (comp) {\n            FormField.getField(comp).each(Disabling.enable);\n          }\n        }),\n        receivingConfig()\n      ];\n      return renderFormFieldWith(pLabel, pField, extraClasses2, extraBehaviours);\n    };\n    var renderInput = function (spec, providersBackstage) {\n      return renderTextField({\n        name: spec.name,\n        multiline: false,\n        label: spec.label,\n        inputMode: spec.inputMode,\n        placeholder: spec.placeholder,\n        flex: false,\n        disabled: spec.disabled,\n        classname: 'tox-textfield',\n        validation: Optional.none(),\n        maximized: spec.maximized\n      }, providersBackstage);\n    };\n    var renderTextarea = function (spec, providersBackstage) {\n      return renderTextField({\n        name: spec.name,\n        multiline: true,\n        label: spec.label,\n        inputMode: Optional.none(),\n        placeholder: spec.placeholder,\n        flex: true,\n        disabled: spec.disabled,\n        classname: 'tox-textarea',\n        validation: Optional.none(),\n        maximized: spec.maximized\n      }, providersBackstage);\n    };\n\n    var events$c = function (streamConfig, streamState) {\n      var streams = streamConfig.stream.streams;\n      var processor = streams.setup(streamConfig, streamState);\n      return derive([\n        run(streamConfig.event, processor),\n        runOnDetached(function () {\n          return streamState.cancel();\n        })\n      ].concat(streamConfig.cancelEvent.map(function (e) {\n        return [run(e, function () {\n            return streamState.cancel();\n          })];\n      }).getOr([])));\n    };\n\n    var ActiveStreaming = /*#__PURE__*/Object.freeze({\n        __proto__: null,\n        events: events$c\n    });\n\n    var throttle = function (_config) {\n      var state = Cell(null);\n      var readState = function () {\n        return { timer: state.get() !== null ? 'set' : 'unset' };\n      };\n      var setTimer = function (t) {\n        state.set(t);\n      };\n      var cancel = function () {\n        var t = state.get();\n        if (t !== null) {\n          t.cancel();\n        }\n      };\n      return nu$5({\n        readState: readState,\n        setTimer: setTimer,\n        cancel: cancel\n      });\n    };\n    var init$6 = function (spec) {\n      return spec.stream.streams.state(spec);\n    };\n\n    var StreamingState = /*#__PURE__*/Object.freeze({\n        __proto__: null,\n        throttle: throttle,\n        init: init$6\n    });\n\n    var setup$2 = function (streamInfo, streamState) {\n      var sInfo = streamInfo.stream;\n      var throttler = last$2(streamInfo.onStream, sInfo.delay);\n      streamState.setTimer(throttler);\n      return function (component, simulatedEvent) {\n        throttler.throttle(component, simulatedEvent);\n        if (sInfo.stopEvent) {\n          simulatedEvent.stop();\n        }\n      };\n    };\n    var StreamingSchema = [\n      strictOf('stream', choose$1('mode', {\n        throttle: [\n          strict$1('delay'),\n          defaulted$1('stopEvent', true),\n          output('streams', {\n            setup: setup$2,\n            state: throttle\n          })\n        ]\n      })),\n      defaulted$1('event', 'input'),\n      option('cancelEvent'),\n      onStrictHandler('onStream')\n    ];\n\n    var Streaming = create$1({\n      fields: StreamingSchema,\n      name: 'streaming',\n      active: ActiveStreaming,\n      state: StreamingState\n    });\n\n    var setValueFromItem = function (model, input, item) {\n      var itemData = Representing.getValue(item);\n      Representing.setValue(input, itemData);\n      setCursorAtEnd(input);\n    };\n    var setSelectionOn = function (input, f) {\n      var el = input.element;\n      var value = get$6(el);\n      var node = el.dom;\n      if (get$3(el, 'type') !== 'number') {\n        f(node, value);\n      }\n    };\n    var setCursorAtEnd = function (input) {\n      setSelectionOn(input, function (node, value) {\n        return node.setSelectionRange(value.length, value.length);\n      });\n    };\n    var setSelectionToEnd = function (input, startOffset) {\n      setSelectionOn(input, function (node, value) {\n        return node.setSelectionRange(startOffset, value.length);\n      });\n    };\n    var attemptSelectOver = function (model, input, item) {\n      if (!model.selectsOver) {\n        return Optional.none();\n      } else {\n        var currentValue = Representing.getValue(input);\n        var inputDisplay_1 = model.getDisplayText(currentValue);\n        var itemValue = Representing.getValue(item);\n        var itemDisplay = model.getDisplayText(itemValue);\n        return itemDisplay.indexOf(inputDisplay_1) === 0 ? Optional.some(function () {\n          setValueFromItem(model, input, item);\n          setSelectionToEnd(input, inputDisplay_1.length);\n        }) : Optional.none();\n      }\n    };\n\n    var itemExecute = constant('alloy.typeahead.itemexecute');\n\n    var make$5 = function (detail, components, spec, externals) {\n      var navigateList = function (comp, simulatedEvent, highlighter) {\n        detail.previewing.set(false);\n        var sandbox = Coupling.getCoupled(comp, 'sandbox');\n        if (Sandboxing.isOpen(sandbox)) {\n          Composing.getCurrent(sandbox).each(function (menu) {\n            Highlighting.getHighlighted(menu).fold(function () {\n              highlighter(menu);\n            }, function () {\n              dispatchEvent(sandbox, menu.element, 'keydown', simulatedEvent);\n            });\n          });\n        } else {\n          var onOpenSync = function (sandbox) {\n            Composing.getCurrent(sandbox).each(highlighter);\n          };\n          open$1(detail, mapFetch(comp), comp, sandbox, externals, onOpenSync, HighlightOnOpen.HighlightFirst).get(noop);\n        }\n      };\n      var focusBehaviours$1 = focusBehaviours(detail);\n      var mapFetch = function (comp) {\n        return function (tdata) {\n          return tdata.map(function (data) {\n            var menus = values(data.menus);\n            var items = bind(menus, function (menu) {\n              return filter(menu.items, function (item) {\n                return item.type === 'item';\n              });\n            });\n            var repState = Representing.getState(comp);\n            repState.update(map(items, function (item) {\n              return item.data;\n            }));\n            return data;\n          });\n        };\n      };\n      var behaviours = [\n        Focusing.config({}),\n        Representing.config({\n          onSetValue: detail.onSetValue,\n          store: __assign({\n            mode: 'dataset',\n            getDataKey: function (comp) {\n              return get$6(comp.element);\n            },\n            getFallbackEntry: function (itemString) {\n              return {\n                value: itemString,\n                meta: {}\n              };\n            },\n            setValue: function (comp, data) {\n              set$3(comp.element, detail.model.getDisplayText(data));\n            }\n          }, detail.initialData.map(function (d) {\n            return wrap$1('initialValue', d);\n          }).getOr({}))\n        }),\n        Streaming.config({\n          stream: {\n            mode: 'throttle',\n            delay: detail.responseTime,\n            stopEvent: false\n          },\n          onStream: function (component, _simulatedEvent) {\n            var sandbox = Coupling.getCoupled(component, 'sandbox');\n            var focusInInput = Focusing.isFocused(component);\n            if (focusInInput) {\n              if (get$6(component.element).length >= detail.minChars) {\n                var previousValue_1 = Composing.getCurrent(sandbox).bind(function (menu) {\n                  return Highlighting.getHighlighted(menu).map(Representing.getValue);\n                });\n                detail.previewing.set(true);\n                var onOpenSync = function (_sandbox) {\n                  Composing.getCurrent(sandbox).each(function (menu) {\n                    previousValue_1.fold(function () {\n                      if (detail.model.selectsOver) {\n                        Highlighting.highlightFirst(menu);\n                      }\n                    }, function (pv) {\n                      Highlighting.highlightBy(menu, function (item) {\n                        var itemData = Representing.getValue(item);\n                        return itemData.value === pv.value;\n                      });\n                      Highlighting.getHighlighted(menu).orThunk(function () {\n                        Highlighting.highlightFirst(menu);\n                        return Optional.none();\n                      });\n                    });\n                  });\n                };\n                open$1(detail, mapFetch(component), component, sandbox, externals, onOpenSync, HighlightOnOpen.HighlightFirst).get(noop);\n              }\n            }\n          },\n          cancelEvent: typeaheadCancel()\n        }),\n        Keying.config({\n          mode: 'special',\n          onDown: function (comp, simulatedEvent) {\n            navigateList(comp, simulatedEvent, Highlighting.highlightFirst);\n            return Optional.some(true);\n          },\n          onEscape: function (comp) {\n            var sandbox = Coupling.getCoupled(comp, 'sandbox');\n            if (Sandboxing.isOpen(sandbox)) {\n              Sandboxing.close(sandbox);\n              return Optional.some(true);\n            }\n            return Optional.none();\n          },\n          onUp: function (comp, simulatedEvent) {\n            navigateList(comp, simulatedEvent, Highlighting.highlightLast);\n            return Optional.some(true);\n          },\n          onEnter: function (comp) {\n            var sandbox = Coupling.getCoupled(comp, 'sandbox');\n            var sandboxIsOpen = Sandboxing.isOpen(sandbox);\n            if (sandboxIsOpen && !detail.previewing.get()) {\n              return Composing.getCurrent(sandbox).bind(function (menu) {\n                return Highlighting.getHighlighted(menu);\n              }).map(function (item) {\n                emitWith(comp, itemExecute(), { item: item });\n                return true;\n              });\n            } else {\n              var currentValue = Representing.getValue(comp);\n              emit(comp, typeaheadCancel());\n              detail.onExecute(sandbox, comp, currentValue);\n              if (sandboxIsOpen) {\n                Sandboxing.close(sandbox);\n              }\n              return Optional.some(true);\n            }\n          }\n        }),\n        Toggling.config({\n          toggleClass: detail.markers.openClass,\n          aria: { mode: 'expanded' }\n        }),\n        Coupling.config({\n          others: {\n            sandbox: function (hotspot) {\n              return makeSandbox(detail, hotspot, {\n                onOpen: function () {\n                  return Toggling.on(hotspot);\n                },\n                onClose: function () {\n                  return Toggling.off(hotspot);\n                }\n              });\n            }\n          }\n        }),\n        config('typeaheadevents', [\n          runOnExecute(function (comp) {\n            var onOpenSync = noop;\n            togglePopup(detail, mapFetch(comp), comp, externals, onOpenSync, HighlightOnOpen.HighlightFirst).get(noop);\n          }),\n          run(itemExecute(), function (comp, se) {\n            var sandbox = Coupling.getCoupled(comp, 'sandbox');\n            setValueFromItem(detail.model, comp, se.event.item);\n            emit(comp, typeaheadCancel());\n            detail.onItemExecute(comp, sandbox, se.event.item, Representing.getValue(comp));\n            Sandboxing.close(sandbox);\n            setCursorAtEnd(comp);\n          })\n        ].concat(detail.dismissOnBlur ? [run(postBlur(), function (typeahead) {\n            var sandbox = Coupling.getCoupled(typeahead, 'sandbox');\n            if (search(sandbox.element).isNone()) {\n              Sandboxing.close(sandbox);\n            }\n          })] : []))\n      ];\n      return {\n        uid: detail.uid,\n        dom: dom$2(deepMerge(detail, {\n          inputAttributes: {\n            'role': 'combobox',\n            'aria-autocomplete': 'list',\n            'aria-haspopup': 'true'\n          }\n        })),\n        behaviours: __assign(__assign({}, focusBehaviours$1), augment(detail.typeaheadBehaviours, behaviours)),\n        eventOrder: detail.eventOrder\n      };\n    };\n\n    var schema$j = constant([\n      option('lazySink'),\n      strict$1('fetch'),\n      defaulted$1('minChars', 5),\n      defaulted$1('responseTime', 1000),\n      onHandler('onOpen'),\n      defaulted$1('getHotspot', Optional.some),\n      defaulted$1('getAnchorOverrides', constant({})),\n      defaulted$1('layouts', Optional.none()),\n      defaulted$1('eventOrder', {}),\n      defaultedObjOf('model', {}, [\n        defaulted$1('getDisplayText', function (itemData) {\n          return itemData.meta !== undefined && itemData.meta.text !== undefined ? itemData.meta.text : itemData.value;\n        }),\n        defaulted$1('selectsOver', true),\n        defaulted$1('populateFromBrowse', true)\n      ]),\n      onHandler('onSetValue'),\n      onKeyboardHandler('onExecute'),\n      onHandler('onItemExecute'),\n      defaulted$1('inputClasses', []),\n      defaulted$1('inputAttributes', {}),\n      defaulted$1('inputStyles', {}),\n      defaulted$1('matchWidth', true),\n      defaulted$1('useMinWidth', false),\n      defaulted$1('dismissOnBlur', true),\n      markers(['openClass']),\n      option('initialData'),\n      field$1('typeaheadBehaviours', [\n        Focusing,\n        Representing,\n        Streaming,\n        Keying,\n        Toggling,\n        Coupling\n      ]),\n      state$1('previewing', function () {\n        return Cell(true);\n      })\n    ].concat(schema$f()).concat(sandboxFields()));\n    var parts$6 = constant([external$1({\n        schema: [tieredMenuMarkers()],\n        name: 'menu',\n        overrides: function (detail) {\n          return {\n            fakeFocus: true,\n            onHighlight: function (menu, item) {\n              if (!detail.previewing.get()) {\n                menu.getSystem().getByUid(detail.uid).each(function (input) {\n                  if (detail.model.populateFromBrowse) {\n                    setValueFromItem(detail.model, input, item);\n                  }\n                });\n              } else {\n                menu.getSystem().getByUid(detail.uid).each(function (input) {\n                  attemptSelectOver(detail.model, input, item).fold(function () {\n                    return Highlighting.dehighlight(menu, item);\n                  }, function (fn) {\n                    return fn();\n                  });\n                });\n              }\n              detail.previewing.set(false);\n            },\n            onExecute: function (menu, item) {\n              return menu.getSystem().getByUid(detail.uid).toOptional().map(function (typeahead) {\n                emitWith(typeahead, itemExecute(), { item: item });\n                return true;\n              });\n            },\n            onHover: function (menu, item) {\n              detail.previewing.set(false);\n              menu.getSystem().getByUid(detail.uid).each(function (input) {\n                if (detail.model.populateFromBrowse) {\n                  setValueFromItem(detail.model, input, item);\n                }\n              });\n            }\n          };\n        }\n      })]);\n\n    var Typeahead = composite$1({\n      name: 'Typeahead',\n      configFields: schema$j(),\n      partFields: parts$6(),\n      factory: make$5\n    });\n\n    var wrap$2 = function (delegate) {\n      var toCached = function () {\n        return wrap$2(delegate.toCached());\n      };\n      var bindFuture = function (f) {\n        return wrap$2(delegate.bind(function (resA) {\n          return resA.fold(function (err) {\n            return Future.pure(Result.error(err));\n          }, function (a) {\n            return f(a);\n          });\n        }));\n      };\n      var bindResult = function (f) {\n        return wrap$2(delegate.map(function (resA) {\n          return resA.bind(f);\n        }));\n      };\n      var mapResult = function (f) {\n        return wrap$2(delegate.map(function (resA) {\n          return resA.map(f);\n        }));\n      };\n      var mapError = function (f) {\n        return wrap$2(delegate.map(function (resA) {\n          return resA.mapError(f);\n        }));\n      };\n      var foldResult = function (whenError, whenValue) {\n        return delegate.map(function (res) {\n          return res.fold(whenError, whenValue);\n        });\n      };\n      var withTimeout = function (timeout, errorThunk) {\n        return wrap$2(Future.nu(function (callback) {\n          var timedOut = false;\n          var timer = setTimeout(function () {\n            timedOut = true;\n            callback(Result.error(errorThunk()));\n          }, timeout);\n          delegate.get(function (result) {\n            if (!timedOut) {\n              clearTimeout(timer);\n              callback(result);\n            }\n          });\n        }));\n      };\n      return __assign(__assign({}, delegate), {\n        toCached: toCached,\n        bindFuture: bindFuture,\n        bindResult: bindResult,\n        mapResult: mapResult,\n        mapError: mapError,\n        foldResult: foldResult,\n        withTimeout: withTimeout\n      });\n    };\n    var nu$c = function (worker) {\n      return wrap$2(Future.nu(worker));\n    };\n    var value$2 = function (value) {\n      return wrap$2(Future.pure(Result.value(value)));\n    };\n    var error$1 = function (error) {\n      return wrap$2(Future.pure(Result.error(error)));\n    };\n    var fromResult$1 = function (result) {\n      return wrap$2(Future.pure(result));\n    };\n    var fromFuture = function (future) {\n      return wrap$2(future.map(Result.value));\n    };\n    var fromPromise = function (promise) {\n      return nu$c(function (completer) {\n        promise.then(function (value) {\n          completer(Result.value(value));\n        }, function (error) {\n          completer(Result.error(error));\n        });\n      });\n    };\n    var FutureResult = {\n      nu: nu$c,\n      wrap: wrap$2,\n      pure: value$2,\n      value: value$2,\n      error: error$1,\n      fromResult: fromResult$1,\n      fromFuture: fromFuture,\n      fromPromise: fromPromise\n    };\n\n    var separator$2 = { type: 'separator' };\n    var toMenuItem = function (target) {\n      return {\n        type: 'menuitem',\n        value: target.url,\n        text: target.title,\n        meta: { attach: target.attach },\n        onAction: noop\n      };\n    };\n    var staticMenuItem = function (title, url) {\n      return {\n        type: 'menuitem',\n        value: url,\n        text: title,\n        meta: { attach: undefined },\n        onAction: noop\n      };\n    };\n    var toMenuItems = function (targets) {\n      return map(targets, toMenuItem);\n    };\n    var filterLinkTargets = function (type, targets) {\n      return filter(targets, function (target) {\n        return target.type === type;\n      });\n    };\n    var filteredTargets = function (type, targets) {\n      return toMenuItems(filterLinkTargets(type, targets));\n    };\n    var headerTargets = function (linkInfo) {\n      return filteredTargets('header', linkInfo.targets);\n    };\n    var anchorTargets = function (linkInfo) {\n      return filteredTargets('anchor', linkInfo.targets);\n    };\n    var anchorTargetTop = function (linkInfo) {\n      return Optional.from(linkInfo.anchorTop).map(function (url) {\n        return staticMenuItem('<top>', url);\n      }).toArray();\n    };\n    var anchorTargetBottom = function (linkInfo) {\n      return Optional.from(linkInfo.anchorBottom).map(function (url) {\n        return staticMenuItem('<bottom>', url);\n      }).toArray();\n    };\n    var historyTargets = function (history) {\n      return map(history, function (url) {\n        return staticMenuItem(url, url);\n      });\n    };\n    var joinMenuLists = function (items) {\n      return foldl(items, function (a, b) {\n        var bothEmpty = a.length === 0 || b.length === 0;\n        return bothEmpty ? a.concat(b) : a.concat(separator$2, b);\n      }, []);\n    };\n    var filterByQuery = function (term, menuItems) {\n      var lowerCaseTerm = term.toLowerCase();\n      return filter(menuItems, function (item) {\n        var text = item.meta !== undefined && item.meta.text !== undefined ? item.meta.text : item.text;\n        return contains$1(text.toLowerCase(), lowerCaseTerm) || contains$1(item.value.toLowerCase(), lowerCaseTerm);\n      });\n    };\n\n    var getItems = function (fileType, input, urlBackstage) {\n      var urlInputValue = Representing.getValue(input);\n      var term = urlInputValue.meta.text !== undefined ? urlInputValue.meta.text : urlInputValue.value;\n      var info = urlBackstage.getLinkInformation();\n      return info.fold(function () {\n        return [];\n      }, function (linkInfo) {\n        var history = filterByQuery(term, historyTargets(urlBackstage.getHistory(fileType)));\n        return fileType === 'file' ? joinMenuLists([\n          history,\n          filterByQuery(term, headerTargets(linkInfo)),\n          filterByQuery(term, flatten([\n            anchorTargetTop(linkInfo),\n            anchorTargets(linkInfo),\n            anchorTargetBottom(linkInfo)\n          ]))\n        ]) : history;\n      });\n    };\n    var errorId = generate$1('aria-invalid');\n    var renderUrlInput = function (spec, backstage, urlBackstage) {\n      var _a;\n      var providersBackstage = backstage.shared.providers;\n      var updateHistory = function (component) {\n        var urlEntry = Representing.getValue(component);\n        urlBackstage.addToHistory(urlEntry.value, spec.filetype);\n      };\n      var pField = FormField.parts.field({\n        factory: Typeahead,\n        dismissOnBlur: true,\n        inputClasses: ['tox-textfield'],\n        sandboxClasses: ['tox-dialog__popups'],\n        inputAttributes: {\n          'aria-errormessage': errorId,\n          'type': 'url'\n        },\n        minChars: 0,\n        responseTime: 0,\n        fetch: function (input) {\n          var items = getItems(spec.filetype, input, urlBackstage);\n          var tdata = build$2(items, ItemResponse$1.BUBBLE_TO_SANDBOX, backstage, false);\n          return Future.pure(tdata);\n        },\n        getHotspot: function (comp) {\n          return memUrlBox.getOpt(comp);\n        },\n        onSetValue: function (comp, _newValue) {\n          if (comp.hasConfigured(Invalidating)) {\n            Invalidating.run(comp).get(noop);\n          }\n        },\n        typeaheadBehaviours: derive$1(flatten([\n          urlBackstage.getValidationHandler().map(function (handler) {\n            return Invalidating.config({\n              getRoot: function (comp) {\n                return parent(comp.element);\n              },\n              invalidClass: 'tox-control-wrap--status-invalid',\n              notify: {\n                onInvalid: function (comp, err) {\n                  memInvalidIcon.getOpt(comp).each(function (invalidComp) {\n                    set$1(invalidComp.element, 'title', providersBackstage.translate(err));\n                  });\n                }\n              },\n              validator: {\n                validate: function (input) {\n                  var urlEntry = Representing.getValue(input);\n                  return FutureResult.nu(function (completer) {\n                    handler({\n                      type: spec.filetype,\n                      url: urlEntry.value\n                    }, function (validation) {\n                      if (validation.status === 'invalid') {\n                        var err = Result.error(validation.message);\n                        completer(err);\n                      } else {\n                        var val = Result.value(validation.message);\n                        completer(val);\n                      }\n                    });\n                  });\n                },\n                validateOnLoad: false\n              }\n            });\n          }).toArray(),\n          [\n            Disabling.config({\n              disabled: function () {\n                return spec.disabled || providersBackstage.isDisabled();\n              }\n            }),\n            Tabstopping.config({}),\n            config('urlinput-events', flatten([\n              spec.filetype === 'file' ? [run(input(), function (comp) {\n                  emitWith(comp, formChangeEvent, { name: spec.name });\n                })] : [],\n              [\n                run(change(), function (comp) {\n                  emitWith(comp, formChangeEvent, { name: spec.name });\n                  updateHistory(comp);\n                }),\n                run(postPaste(), function (comp) {\n                  emitWith(comp, formChangeEvent, { name: spec.name });\n                  updateHistory(comp);\n                })\n              ]\n            ]))\n          ]\n        ])),\n        eventOrder: (_a = {}, _a[input()] = [\n          'streaming',\n          'urlinput-events',\n          'invalidating'\n        ], _a),\n        model: {\n          getDisplayText: function (itemData) {\n            return itemData.value;\n          },\n          selectsOver: false,\n          populateFromBrowse: false\n        },\n        markers: { openClass: 'tox-textfield--popup-open' },\n        lazySink: backstage.shared.getSink,\n        parts: { menu: part(false, 1, 'normal') },\n        onExecute: function (_menu, component, _entry) {\n          emitWith(component, formSubmitEvent, {});\n        },\n        onItemExecute: function (typeahead, _sandbox, _item, _value) {\n          updateHistory(typeahead);\n          emitWith(typeahead, formChangeEvent, { name: spec.name });\n        }\n      });\n      var pLabel = spec.label.map(function (label) {\n        return renderLabel(label, providersBackstage);\n      });\n      var makeIcon = function (name, errId, icon, label) {\n        if (icon === void 0) {\n          icon = name;\n        }\n        if (label === void 0) {\n          label = name;\n        }\n        return {\n          dom: {\n            tag: 'div',\n            classes: [\n              'tox-icon',\n              'tox-control-wrap__status-icon-' + name\n            ],\n            innerHtml: get$e(icon, providersBackstage.icons),\n            attributes: __assign({\n              'title': providersBackstage.translate(label),\n              'aria-live': 'polite'\n            }, errId.fold(function () {\n              return {};\n            }, function (id) {\n              return { id: id };\n            }))\n          }\n        };\n      };\n      var memInvalidIcon = record(makeIcon('invalid', Optional.some(errorId), 'warning'));\n      var memStatus = record({\n        dom: {\n          tag: 'div',\n          classes: ['tox-control-wrap__status-icon-wrap']\n        },\n        components: [memInvalidIcon.asSpec()]\n      });\n      var optUrlPicker = urlBackstage.getUrlPicker(spec.filetype);\n      var browseUrlEvent = generate$1('browser.url.event');\n      var memUrlBox = record({\n        dom: {\n          tag: 'div',\n          classes: ['tox-control-wrap']\n        },\n        components: [\n          pField,\n          memStatus.asSpec()\n        ],\n        behaviours: derive$1([Disabling.config({\n            disabled: function () {\n              return spec.disabled || providersBackstage.isDisabled();\n            }\n          })])\n      });\n      var memUrlPickerButton = record(renderButton({\n        name: spec.name,\n        icon: Optional.some('browse'),\n        text: spec.label.getOr(''),\n        disabled: spec.disabled,\n        primary: false,\n        borderless: true\n      }, function (component) {\n        return emit(component, browseUrlEvent);\n      }, providersBackstage, [], ['tox-browse-url']));\n      var controlHWrapper = function () {\n        return {\n          dom: {\n            tag: 'div',\n            classes: ['tox-form__controls-h-stack']\n          },\n          components: flatten([\n            [memUrlBox.asSpec()],\n            optUrlPicker.map(function () {\n              return memUrlPickerButton.asSpec();\n            }).toArray()\n          ])\n        };\n      };\n      var openUrlPicker = function (comp) {\n        Composing.getCurrent(comp).each(function (field) {\n          var componentData = Representing.getValue(field);\n          var urlData = __assign({ fieldname: spec.name }, componentData);\n          optUrlPicker.each(function (picker) {\n            picker(urlData).get(function (chosenData) {\n              Representing.setValue(field, chosenData);\n              emitWith(comp, formChangeEvent, { name: spec.name });\n            });\n          });\n        });\n      };\n      return FormField.sketch({\n        dom: renderFormFieldDom(),\n        components: pLabel.toArray().concat([controlHWrapper()]),\n        fieldBehaviours: derive$1([\n          Disabling.config({\n            disabled: function () {\n              return spec.disabled || providersBackstage.isDisabled();\n            },\n            onDisabled: function (comp) {\n              FormField.getField(comp).each(Disabling.disable);\n              memUrlPickerButton.getOpt(comp).each(Disabling.disable);\n            },\n            onEnabled: function (comp) {\n              FormField.getField(comp).each(Disabling.enable);\n              memUrlPickerButton.getOpt(comp).each(Disabling.enable);\n            }\n          }),\n          receivingConfig(),\n          config('url-input-events', [run(browseUrlEvent, openUrlPicker)])\n        ])\n      });\n    };\n\n    var renderAlertBanner = function (spec, providersBackstage) {\n      return Container.sketch({\n        dom: {\n          tag: 'div',\n          attributes: { role: 'alert' },\n          classes: [\n            'tox-notification',\n            'tox-notification--in',\n            'tox-notification--' + spec.level\n          ]\n        },\n        components: [\n          {\n            dom: {\n              tag: 'div',\n              classes: ['tox-notification__icon']\n            },\n            components: [Button.sketch({\n                dom: {\n                  tag: 'button',\n                  classes: [\n                    'tox-button',\n                    'tox-button--naked',\n                    'tox-button--icon'\n                  ],\n                  innerHtml: get$e(spec.icon, providersBackstage.icons),\n                  attributes: { title: providersBackstage.translate(spec.iconTooltip) }\n                },\n                action: function (comp) {\n                  emitWith(comp, formActionEvent, {\n                    name: 'alert-banner',\n                    value: spec.url\n                  });\n                }\n              })]\n          },\n          {\n            dom: {\n              tag: 'div',\n              classes: ['tox-notification__body'],\n              innerHtml: providersBackstage.translate(spec.text)\n            }\n          }\n        ]\n      });\n    };\n\n    var renderCheckbox = function (spec, providerBackstage) {\n      var repBehaviour = Representing.config({\n        store: {\n          mode: 'manual',\n          getValue: function (comp) {\n            var el = comp.element.dom;\n            return el.checked;\n          },\n          setValue: function (comp, value) {\n            var el = comp.element.dom;\n            el.checked = value;\n          }\n        }\n      });\n      var toggleCheckboxHandler = function (comp) {\n        comp.element.dom.click();\n        return Optional.some(true);\n      };\n      var pField = FormField.parts.field({\n        factory: { sketch: identity },\n        dom: {\n          tag: 'input',\n          classes: ['tox-checkbox__input'],\n          attributes: { type: 'checkbox' }\n        },\n        behaviours: derive$1([\n          ComposingConfigs.self(),\n          Disabling.config({\n            disabled: function () {\n              return spec.disabled || providerBackstage.isDisabled();\n            }\n          }),\n          Tabstopping.config({}),\n          Focusing.config({}),\n          repBehaviour,\n          Keying.config({\n            mode: 'special',\n            onEnter: toggleCheckboxHandler,\n            onSpace: toggleCheckboxHandler,\n            stopSpaceKeyup: true\n          }),\n          config('checkbox-events', [run(change(), function (component, _) {\n              emitWith(component, formChangeEvent, { name: spec.name });\n            })])\n        ])\n      });\n      var pLabel = FormField.parts.label({\n        dom: {\n          tag: 'span',\n          classes: ['tox-checkbox__label'],\n          innerHtml: providerBackstage.translate(spec.label)\n        },\n        behaviours: derive$1([Unselecting.config({})])\n      });\n      var makeIcon = function (className) {\n        var iconName = className === 'checked' ? 'selected' : 'unselected';\n        return {\n          dom: {\n            tag: 'span',\n            classes: [\n              'tox-icon',\n              'tox-checkbox-icon__' + className\n            ],\n            innerHtml: get$e(iconName, providerBackstage.icons)\n          }\n        };\n      };\n      var memIcons = record({\n        dom: {\n          tag: 'div',\n          classes: ['tox-checkbox__icons']\n        },\n        components: [\n          makeIcon('checked'),\n          makeIcon('unchecked')\n        ]\n      });\n      return FormField.sketch({\n        dom: {\n          tag: 'label',\n          classes: ['tox-checkbox']\n        },\n        components: [\n          pField,\n          memIcons.asSpec(),\n          pLabel\n        ],\n        fieldBehaviours: derive$1([\n          Disabling.config({\n            disabled: function () {\n              return spec.disabled || providerBackstage.isDisabled();\n            },\n            disableClass: 'tox-checkbox--disabled',\n            onDisabled: function (comp) {\n              FormField.getField(comp).each(Disabling.disable);\n            },\n            onEnabled: function (comp) {\n              FormField.getField(comp).each(Disabling.enable);\n            }\n          }),\n          receivingConfig()\n        ])\n      });\n    };\n\n    var renderHtmlPanel = function (spec) {\n      if (spec.presets === 'presentation') {\n        return Container.sketch({\n          dom: {\n            tag: 'div',\n            classes: ['tox-form__group'],\n            innerHtml: spec.html\n          }\n        });\n      } else {\n        return Container.sketch({\n          dom: {\n            tag: 'div',\n            classes: ['tox-form__group'],\n            innerHtml: spec.html,\n            attributes: { role: 'document' }\n          },\n          containerBehaviours: derive$1([\n            Tabstopping.config({}),\n            Focusing.config({})\n          ])\n        });\n      }\n    };\n\n    var make$6 = function (render) {\n      return function (parts, spec, backstage) {\n        return get$1(spec, 'name').fold(function () {\n          return render(spec, backstage);\n        }, function (fieldName) {\n          return parts.field(fieldName, render(spec, backstage));\n        });\n      };\n    };\n    var makeIframe = function (render) {\n      return function (parts, spec, backstage) {\n        var iframeSpec = deepMerge(spec, { source: 'dynamic' });\n        return make$6(render)(parts, iframeSpec, backstage);\n      };\n    };\n    var factories = {\n      bar: make$6(function (spec, backstage) {\n        return renderBar(spec, backstage.shared);\n      }),\n      collection: make$6(function (spec, backstage) {\n        return renderCollection(spec, backstage.shared.providers);\n      }),\n      alertbanner: make$6(function (spec, backstage) {\n        return renderAlertBanner(spec, backstage.shared.providers);\n      }),\n      input: make$6(function (spec, backstage) {\n        return renderInput(spec, backstage.shared.providers);\n      }),\n      textarea: make$6(function (spec, backstage) {\n        return renderTextarea(spec, backstage.shared.providers);\n      }),\n      label: make$6(function (spec, backstage) {\n        return renderLabel$2(spec, backstage.shared);\n      }),\n      iframe: makeIframe(function (spec, backstage) {\n        return renderIFrame(spec, backstage.shared.providers);\n      }),\n      button: make$6(function (spec, backstage) {\n        return renderDialogButton(spec, backstage.shared.providers);\n      }),\n      checkbox: make$6(function (spec, backstage) {\n        return renderCheckbox(spec, backstage.shared.providers);\n      }),\n      colorinput: make$6(function (spec, backstage) {\n        return renderColorInput(spec, backstage.shared, backstage.colorinput);\n      }),\n      colorpicker: make$6(renderColorPicker),\n      dropzone: make$6(function (spec, backstage) {\n        return renderDropZone(spec, backstage.shared.providers);\n      }),\n      grid: make$6(function (spec, backstage) {\n        return renderGrid(spec, backstage.shared);\n      }),\n      listbox: make$6(function (spec, backstage) {\n        return renderListBox(spec, backstage);\n      }),\n      selectbox: make$6(function (spec, backstage) {\n        return renderSelectBox(spec, backstage.shared.providers);\n      }),\n      sizeinput: make$6(function (spec, backstage) {\n        return renderSizeInput(spec, backstage.shared.providers);\n      }),\n      urlinput: make$6(function (spec, backstage) {\n        return renderUrlInput(spec, backstage, backstage.urlinput);\n      }),\n      customeditor: make$6(renderCustomEditor),\n      htmlpanel: make$6(renderHtmlPanel),\n      imagetools: make$6(function (spec, backstage) {\n        return renderImageTools(spec, backstage.shared.providers);\n      }),\n      table: make$6(function (spec, backstage) {\n        return renderTable(spec, backstage.shared.providers);\n      }),\n      panel: make$6(function (spec, backstage) {\n        return renderPanel(spec, backstage);\n      })\n    };\n    var noFormParts = {\n      field: function (_name, spec) {\n        return spec;\n      }\n    };\n    var interpretInForm = function (parts, spec, oldBackstage) {\n      var newBackstage = deepMerge(oldBackstage, {\n        shared: {\n          interpreter: function (childSpec) {\n            return interpretParts(parts, childSpec, newBackstage);\n          }\n        }\n      });\n      return interpretParts(parts, spec, newBackstage);\n    };\n    var interpretParts = function (parts, spec, backstage) {\n      return get$1(factories, spec.type).fold(function () {\n        console.error('Unknown factory type \"' + spec.type + '\", defaulting to container: ', spec);\n        return spec;\n      }, function (factory) {\n        return factory(parts, spec, backstage);\n      });\n    };\n    var interpretWithoutForm = function (spec, backstage) {\n      var parts = noFormParts;\n      return interpretParts(parts, spec, backstage);\n    };\n\n    var bubbleAlignments = {\n      valignCentre: [],\n      alignCentre: [],\n      alignLeft: [],\n      alignRight: [],\n      right: [],\n      left: [],\n      bottom: [],\n      top: []\n    };\n    var getInlineDialogAnchor = function (contentAreaElement, lazyAnchorbar, lazyUseEditableAreaAnchor) {\n      var bubble = nu$8(-12, 12, bubbleAlignments);\n      var overrides = { maxHeightFunction: expandable() };\n      var editableAreaAnchor = function () {\n        return {\n          anchor: 'node',\n          root: getContentContainer(contentAreaElement()),\n          node: Optional.from(contentAreaElement()),\n          bubble: bubble,\n          layouts: {\n            onRtl: function () {\n              return [northwest$3];\n            },\n            onLtr: function () {\n              return [northeast$3];\n            }\n          },\n          overrides: overrides\n        };\n      };\n      var standardAnchor = function () {\n        return {\n          anchor: 'hotspot',\n          hotspot: lazyAnchorbar(),\n          bubble: bubble,\n          layouts: {\n            onRtl: function () {\n              return [southeast$1];\n            },\n            onLtr: function () {\n              return [southwest$1];\n            }\n          },\n          overrides: overrides\n        };\n      };\n      return function () {\n        return lazyUseEditableAreaAnchor() ? editableAreaAnchor() : standardAnchor();\n      };\n    };\n    var getBannerAnchor = function (contentAreaElement, lazyAnchorbar, lazyUseEditableAreaAnchor) {\n      var editableAreaAnchor = function () {\n        return {\n          anchor: 'node',\n          root: getContentContainer(contentAreaElement()),\n          node: Optional.from(contentAreaElement()),\n          layouts: {\n            onRtl: function () {\n              return [north$3];\n            },\n            onLtr: function () {\n              return [north$3];\n            }\n          }\n        };\n      };\n      var standardAnchor = function () {\n        return {\n          anchor: 'hotspot',\n          hotspot: lazyAnchorbar(),\n          layouts: {\n            onRtl: function () {\n              return [south$1];\n            },\n            onLtr: function () {\n              return [south$1];\n            }\n          }\n        };\n      };\n      return function () {\n        return lazyUseEditableAreaAnchor() ? editableAreaAnchor() : standardAnchor();\n      };\n    };\n    var getCursorAnchor = function (editor, bodyElement) {\n      return function () {\n        return {\n          anchor: 'selection',\n          root: bodyElement(),\n          getSelection: function () {\n            var rng = editor.selection.getRng();\n            return Optional.some(SimSelection.range(SugarElement.fromDom(rng.startContainer), rng.startOffset, SugarElement.fromDom(rng.endContainer), rng.endOffset));\n          }\n        };\n      };\n    };\n    var getNodeAnchor = function (bodyElement) {\n      return function (element) {\n        return {\n          anchor: 'node',\n          root: bodyElement(),\n          node: element\n        };\n      };\n    };\n    var getAnchors = function (editor, lazyAnchorbar, isToolbarTop) {\n      var useFixedToolbarContainer = useFixedContainer(editor);\n      var bodyElement = function () {\n        return SugarElement.fromDom(editor.getBody());\n      };\n      var contentAreaElement = function () {\n        return SugarElement.fromDom(editor.getContentAreaContainer());\n      };\n      var lazyUseEditableAreaAnchor = function () {\n        return useFixedToolbarContainer || !isToolbarTop();\n      };\n      return {\n        inlineDialog: getInlineDialogAnchor(contentAreaElement, lazyAnchorbar, lazyUseEditableAreaAnchor),\n        banner: getBannerAnchor(contentAreaElement, lazyAnchorbar, lazyUseEditableAreaAnchor),\n        cursor: getCursorAnchor(editor, bodyElement),\n        node: getNodeAnchor(bodyElement)\n      };\n    };\n\n    var colorPicker = function (editor) {\n      return function (callback, value) {\n        var dialog = colorPickerDialog(editor);\n        dialog(callback, value);\n      };\n    };\n    var hasCustomColors$1 = function (editor) {\n      return function () {\n        return hasCustomColors(editor);\n      };\n    };\n    var getColors$2 = function (editor) {\n      return function () {\n        return getColors(editor);\n      };\n    };\n    var getColorCols$2 = function (editor) {\n      return function () {\n        return getColorCols$1(editor);\n      };\n    };\n    var ColorInputBackstage = function (editor) {\n      return {\n        colorPicker: colorPicker(editor),\n        hasCustomColors: hasCustomColors$1(editor),\n        getColors: getColors$2(editor),\n        getColorCols: getColorCols$2(editor)\n      };\n    };\n\n    var isDraggableModal$1 = function (editor) {\n      return function () {\n        return isDraggableModal(editor);\n      };\n    };\n    var DialogBackstage = function (editor) {\n      return { isDraggableModal: isDraggableModal$1(editor) };\n    };\n\n    var HeaderBackstage = function (editor) {\n      var mode = Cell(isToolbarLocationBottom(editor) ? 'bottom' : 'top');\n      return {\n        isPositionedAtTop: function () {\n          return mode.get() === 'top';\n        },\n        getDockingMode: mode.get,\n        setDockingMode: mode.set\n      };\n    };\n\n    var defaultStyleFormats = [\n      {\n        title: 'Headings',\n        items: [\n          {\n            title: 'Heading 1',\n            format: 'h1'\n          },\n          {\n            title: 'Heading 2',\n            format: 'h2'\n          },\n          {\n            title: 'Heading 3',\n            format: 'h3'\n          },\n          {\n            title: 'Heading 4',\n            format: 'h4'\n          },\n          {\n            title: 'Heading 5',\n            format: 'h5'\n          },\n          {\n            title: 'Heading 6',\n            format: 'h6'\n          }\n        ]\n      },\n      {\n        title: 'Inline',\n        items: [\n          {\n            title: 'Bold',\n            format: 'bold'\n          },\n          {\n            title: 'Italic',\n            format: 'italic'\n          },\n          {\n            title: 'Underline',\n            format: 'underline'\n          },\n          {\n            title: 'Strikethrough',\n            format: 'strikethrough'\n          },\n          {\n            title: 'Superscript',\n            format: 'superscript'\n          },\n          {\n            title: 'Subscript',\n            format: 'subscript'\n          },\n          {\n            title: 'Code',\n            format: 'code'\n          }\n        ]\n      },\n      {\n        title: 'Blocks',\n        items: [\n          {\n            title: 'Paragraph',\n            format: 'p'\n          },\n          {\n            title: 'Blockquote',\n            format: 'blockquote'\n          },\n          {\n            title: 'Div',\n            format: 'div'\n          },\n          {\n            title: 'Pre',\n            format: 'pre'\n          }\n        ]\n      },\n      {\n        title: 'Align',\n        items: [\n          {\n            title: 'Left',\n            format: 'alignleft'\n          },\n          {\n            title: 'Center',\n            format: 'aligncenter'\n          },\n          {\n            title: 'Right',\n            format: 'alignright'\n          },\n          {\n            title: 'Justify',\n            format: 'alignjustify'\n          }\n        ]\n      }\n    ];\n    var isNestedFormat = function (format) {\n      return has(format, 'items');\n    };\n    var isBlockFormat = function (format) {\n      return has(format, 'block');\n    };\n    var isInlineFormat = function (format) {\n      return has(format, 'inline');\n    };\n    var isSelectorFormat = function (format) {\n      return has(format, 'selector');\n    };\n    var mapFormats = function (userFormats) {\n      return foldl(userFormats, function (acc, fmt) {\n        if (isNestedFormat(fmt)) {\n          var result = mapFormats(fmt.items);\n          return {\n            customFormats: acc.customFormats.concat(result.customFormats),\n            formats: acc.formats.concat([{\n                title: fmt.title,\n                items: result.formats\n              }])\n          };\n        } else if (isInlineFormat(fmt) || isBlockFormat(fmt) || isSelectorFormat(fmt)) {\n          var formatName = isString(fmt.name) ? fmt.name : fmt.title.toLowerCase();\n          var formatNameWithPrefix = 'custom-' + formatName;\n          return {\n            customFormats: acc.customFormats.concat([{\n                name: formatNameWithPrefix,\n                format: fmt\n              }]),\n            formats: acc.formats.concat([{\n                title: fmt.title,\n                format: formatNameWithPrefix,\n                icon: fmt.icon\n              }])\n          };\n        } else {\n          return __assign(__assign({}, acc), { formats: acc.formats.concat(fmt) });\n        }\n      }, {\n        customFormats: [],\n        formats: []\n      });\n    };\n    var registerCustomFormats = function (editor, userFormats) {\n      var result = mapFormats(userFormats);\n      var registerFormats = function (customFormats) {\n        each(customFormats, function (fmt) {\n          if (!editor.formatter.has(fmt.name)) {\n            editor.formatter.register(fmt.name, fmt.format);\n          }\n        });\n      };\n      if (editor.formatter) {\n        registerFormats(result.customFormats);\n      } else {\n        editor.on('init', function () {\n          registerFormats(result.customFormats);\n        });\n      }\n      return result.formats;\n    };\n    var getStyleFormats = function (editor) {\n      return getUserStyleFormats(editor).map(function (userFormats) {\n        var registeredUserFormats = registerCustomFormats(editor, userFormats);\n        return isMergeStyleFormats(editor) ? defaultStyleFormats.concat(registeredUserFormats) : registeredUserFormats;\n      }).getOr(defaultStyleFormats);\n    };\n\n    var processBasic = function (item, isSelectedFor, getPreviewFor) {\n      var formatterSpec = {\n        type: 'formatter',\n        isSelected: isSelectedFor(item.format),\n        getStylePreview: getPreviewFor(item.format)\n      };\n      return deepMerge(item, formatterSpec);\n    };\n    var register$3 = function (editor, formats, isSelectedFor, getPreviewFor) {\n      var enrichSupported = function (item) {\n        return processBasic(item, isSelectedFor, getPreviewFor);\n      };\n      var enrichMenu = function (item) {\n        var submenuSpec = { type: 'submenu' };\n        return deepMerge(item, submenuSpec);\n      };\n      var enrichCustom = function (item) {\n        var formatName = isString(item.name) ? item.name : generate$1(item.title);\n        var formatNameWithPrefix = 'custom-' + formatName;\n        var customSpec = {\n          type: 'formatter',\n          format: formatNameWithPrefix,\n          isSelected: isSelectedFor(formatNameWithPrefix),\n          getStylePreview: getPreviewFor(formatNameWithPrefix)\n        };\n        var newItem = deepMerge(item, customSpec);\n        editor.formatter.register(formatName, newItem);\n        return newItem;\n      };\n      var doEnrich = function (items) {\n        return map(items, function (item) {\n          var keys$1 = keys(item);\n          if (hasNonNullableKey(item, 'items')) {\n            var newItems_1 = doEnrich(item.items);\n            return deepMerge(enrichMenu(item), {\n              getStyleItems: function () {\n                return newItems_1;\n              }\n            });\n          } else if (hasNonNullableKey(item, 'format')) {\n            return enrichSupported(item);\n          } else if (keys$1.length === 1 && contains(keys$1, 'title')) {\n            return deepMerge(item, { type: 'separator' });\n          } else {\n            return enrichCustom(item);\n          }\n        });\n      };\n      return doEnrich(formats);\n    };\n\n    var init$7 = function (editor) {\n      var isSelectedFor = function (format) {\n        return function () {\n          return editor.formatter.match(format);\n        };\n      };\n      var getPreviewFor = function (format) {\n        return function () {\n          var fmt = editor.formatter.get(format);\n          return fmt !== undefined ? Optional.some({\n            tag: fmt.length > 0 ? fmt[0].inline || fmt[0].block || 'div' : 'div',\n            styles: editor.dom.parseStyle(editor.formatter.getCssText(format))\n          }) : Optional.none();\n        };\n      };\n      var flatten = function (fmt) {\n        var subs = fmt.items;\n        return subs !== undefined && subs.length > 0 ? bind(subs, flatten) : [fmt.format];\n      };\n      var settingsFormats = Cell([]);\n      var settingsFlattenedFormats = Cell([]);\n      var eventsFormats = Cell([]);\n      var eventsFlattenedFormats = Cell([]);\n      var replaceSettings = Cell(false);\n      editor.on('PreInit', function (_e) {\n        var formats = getStyleFormats(editor);\n        var enriched = register$3(editor, formats, isSelectedFor, getPreviewFor);\n        settingsFormats.set(enriched);\n        settingsFlattenedFormats.set(bind(enriched, flatten));\n      });\n      editor.on('addStyleModifications', function (e) {\n        var modifications = register$3(editor, e.items, isSelectedFor, getPreviewFor);\n        eventsFormats.set(modifications);\n        replaceSettings.set(e.replace);\n        eventsFlattenedFormats.set(bind(modifications, flatten));\n      });\n      var getData = function () {\n        var fromSettings = replaceSettings.get() ? [] : settingsFormats.get();\n        var fromEvents = eventsFormats.get();\n        return fromSettings.concat(fromEvents);\n      };\n      var getFlattenedKeys = function () {\n        var fromSettings = replaceSettings.get() ? [] : settingsFlattenedFormats.get();\n        var fromEvents = eventsFlattenedFormats.get();\n        return fromSettings.concat(fromEvents);\n      };\n      return {\n        getData: getData,\n        getFlattenedKeys: getFlattenedKeys\n      };\n    };\n\n    var isElement$2 = function (node) {\n      return isNonNullable(node) && node.nodeType === 1;\n    };\n    var trim$1 = global$c.trim;\n    var hasContentEditableState = function (value) {\n      return function (node) {\n        if (isElement$2(node)) {\n          if (node.contentEditable === value) {\n            return true;\n          }\n          if (node.getAttribute('data-mce-contenteditable') === value) {\n            return true;\n          }\n        }\n        return false;\n      };\n    };\n    var isContentEditableTrue = hasContentEditableState('true');\n    var isContentEditableFalse = hasContentEditableState('false');\n    var create$8 = function (type, title, url, level, attach) {\n      return {\n        type: type,\n        title: title,\n        url: url,\n        level: level,\n        attach: attach\n      };\n    };\n    var isChildOfContentEditableTrue = function (node) {\n      while (node = node.parentNode) {\n        var value = node.contentEditable;\n        if (value && value !== 'inherit') {\n          return isContentEditableTrue(node);\n        }\n      }\n      return false;\n    };\n    var select = function (selector, root) {\n      return map(descendants(SugarElement.fromDom(root), selector), function (element) {\n        return element.dom;\n      });\n    };\n    var getElementText = function (elm) {\n      return elm.innerText || elm.textContent;\n    };\n    var getOrGenerateId = function (elm) {\n      return elm.id ? elm.id : generate$1('h');\n    };\n    var isAnchor = function (elm) {\n      return elm && elm.nodeName === 'A' && (elm.id || elm.name) !== undefined;\n    };\n    var isValidAnchor = function (elm) {\n      return isAnchor(elm) && isEditable(elm);\n    };\n    var isHeader = function (elm) {\n      return elm && /^(H[1-6])$/.test(elm.nodeName);\n    };\n    var isEditable = function (elm) {\n      return isChildOfContentEditableTrue(elm) && !isContentEditableFalse(elm);\n    };\n    var isValidHeader = function (elm) {\n      return isHeader(elm) && isEditable(elm);\n    };\n    var getLevel = function (elm) {\n      return isHeader(elm) ? parseInt(elm.nodeName.substr(1), 10) : 0;\n    };\n    var headerTarget = function (elm) {\n      var headerId = getOrGenerateId(elm);\n      var attach = function () {\n        elm.id = headerId;\n      };\n      return create$8('header', getElementText(elm), '#' + headerId, getLevel(elm), attach);\n    };\n    var anchorTarget = function (elm) {\n      var anchorId = elm.id || elm.name;\n      var anchorText = getElementText(elm);\n      return create$8('anchor', anchorText ? anchorText : '#' + anchorId, '#' + anchorId, 0, noop);\n    };\n    var getHeaderTargets = function (elms) {\n      return map(filter(elms, isValidHeader), headerTarget);\n    };\n    var getAnchorTargets = function (elms) {\n      return map(filter(elms, isValidAnchor), anchorTarget);\n    };\n    var getTargetElements = function (elm) {\n      var elms = select('h1,h2,h3,h4,h5,h6,a:not([href])', elm);\n      return elms;\n    };\n    var hasTitle = function (target) {\n      return trim$1(target.title).length > 0;\n    };\n    var find$5 = function (elm) {\n      var elms = getTargetElements(elm);\n      return filter(getHeaderTargets(elms).concat(getAnchorTargets(elms)), hasTitle);\n    };\n    var LinkTargets = { find: find$5 };\n\n    var STORAGE_KEY = 'tinymce-url-history';\n    var HISTORY_LENGTH = 5;\n    var isHttpUrl = function (url) {\n      return isString(url) && /^https?/.test(url);\n    };\n    var isArrayOfUrl = function (a) {\n      return isArray(a) && a.length <= HISTORY_LENGTH && forall(a, isHttpUrl);\n    };\n    var isRecordOfUrlArray = function (r) {\n      return isObject(r) && find$1(r, function (value) {\n        return !isArrayOfUrl(value);\n      }).isNone();\n    };\n    var getAllHistory = function () {\n      var unparsedHistory = global$9.getItem(STORAGE_KEY);\n      if (unparsedHistory === null) {\n        return {};\n      }\n      var history;\n      try {\n        history = JSON.parse(unparsedHistory);\n      } catch (e) {\n        if (e instanceof SyntaxError) {\n          console.log('Local storage ' + STORAGE_KEY + ' was not valid JSON', e);\n          return {};\n        }\n        throw e;\n      }\n      if (!isRecordOfUrlArray(history)) {\n        console.log('Local storage ' + STORAGE_KEY + ' was not valid format', history);\n        return {};\n      }\n      return history;\n    };\n    var setAllHistory = function (history) {\n      if (!isRecordOfUrlArray(history)) {\n        throw new Error('Bad format for history:\\n' + JSON.stringify(history));\n      }\n      global$9.setItem(STORAGE_KEY, JSON.stringify(history));\n    };\n    var getHistory = function (fileType) {\n      var history = getAllHistory();\n      return Object.prototype.hasOwnProperty.call(history, fileType) ? history[fileType] : [];\n    };\n    var addToHistory = function (url, fileType) {\n      if (!isHttpUrl(url)) {\n        return;\n      }\n      var history = getAllHistory();\n      var items = Object.prototype.hasOwnProperty.call(history, fileType) ? history[fileType] : [];\n      var itemsWithoutUrl = filter(items, function (item) {\n        return item !== url;\n      });\n      history[fileType] = [url].concat(itemsWithoutUrl).slice(0, HISTORY_LENGTH);\n      setAllHistory(history);\n    };\n\n    var isTruthy = function (value) {\n      return !!value;\n    };\n    var makeMap = function (value) {\n      return map$2(global$c.makeMap(value, /[, ]/), isTruthy);\n    };\n    var getPicker = function (editor) {\n      return Optional.from(getFilePickerCallback(editor)).filter(isFunction);\n    };\n    var getPickerTypes = function (editor) {\n      var optFileTypes = Optional.some(getFilePickerTypes(editor)).filter(isTruthy);\n      var optLegacyTypes = Optional.some(getFileBrowserCallbackTypes(editor)).filter(isTruthy);\n      var optTypes = optFileTypes.or(optLegacyTypes).map(makeMap);\n      return getPicker(editor).fold(never, function (_picker) {\n        return optTypes.fold(always, function (types) {\n          return keys(types).length > 0 ? types : false;\n        });\n      });\n    };\n    var getPickerSetting = function (editor, filetype) {\n      var pickerTypes = getPickerTypes(editor);\n      if (isBoolean(pickerTypes)) {\n        return pickerTypes ? getPicker(editor) : Optional.none();\n      } else {\n        return pickerTypes[filetype] ? getPicker(editor) : Optional.none();\n      }\n    };\n    var getUrlPicker = function (editor, filetype) {\n      return getPickerSetting(editor, filetype).map(function (picker) {\n        return function (entry) {\n          return Future.nu(function (completer) {\n            var handler = function (value, meta) {\n              if (!isString(value)) {\n                throw new Error('Expected value to be string');\n              }\n              if (meta !== undefined && !isObject(meta)) {\n                throw new Error('Expected meta to be a object');\n              }\n              var r = {\n                value: value,\n                meta: meta\n              };\n              completer(r);\n            };\n            var meta = __assign({\n              filetype: filetype,\n              fieldname: entry.fieldname\n            }, Optional.from(entry.meta).getOr({}));\n            picker.call(editor, handler, entry.value, meta);\n          });\n        };\n      });\n    };\n    var getTextSetting = function (value) {\n      return Optional.from(value).filter(isString).getOrUndefined();\n    };\n    var getLinkInformation = function (editor) {\n      if (noTypeaheadUrls(editor)) {\n        return Optional.none();\n      }\n      return Optional.some({\n        targets: LinkTargets.find(editor.getBody()),\n        anchorTop: getTextSetting(getAnchorTop(editor)),\n        anchorBottom: getTextSetting(getAnchorBottom(editor))\n      });\n    };\n    var getValidationHandler = function (editor) {\n      return Optional.from(getFilePickerValidatorHandler(editor));\n    };\n    var UrlInputBackstage = function (editor) {\n      return {\n        getHistory: getHistory,\n        addToHistory: addToHistory,\n        getLinkInformation: function () {\n          return getLinkInformation(editor);\n        },\n        getValidationHandler: function () {\n          return getValidationHandler(editor);\n        },\n        getUrlPicker: function (filetype) {\n          return getUrlPicker(editor, filetype);\n        }\n      };\n    };\n\n    var init$8 = function (sink, editor, lazyAnchorbar) {\n      var contextMenuState = Cell(false);\n      var toolbar = HeaderBackstage(editor);\n      var backstage = {\n        shared: {\n          providers: {\n            icons: function () {\n              return editor.ui.registry.getAll().icons;\n            },\n            menuItems: function () {\n              return editor.ui.registry.getAll().menuItems;\n            },\n            translate: global$6.translate,\n            isDisabled: function () {\n              return editor.mode.isReadOnly() || editor.ui.isDisabled();\n            },\n            getSetting: editor.getParam.bind(editor)\n          },\n          interpreter: function (s) {\n            return interpretWithoutForm(s, backstage);\n          },\n          anchors: getAnchors(editor, lazyAnchorbar, toolbar.isPositionedAtTop),\n          header: toolbar,\n          getSink: function () {\n            return Result.value(sink);\n          }\n        },\n        urlinput: UrlInputBackstage(editor),\n        styleselect: init$7(editor),\n        colorinput: ColorInputBackstage(editor),\n        dialog: DialogBackstage(editor),\n        isContextMenuOpen: function () {\n          return contextMenuState.get();\n        },\n        setContextMenuState: function (state) {\n          return contextMenuState.set(state);\n        }\n      };\n      return backstage;\n    };\n\n    var expandable$1 = constant(function (element, available) {\n      setMax$1(element, Math.floor(available));\n    });\n\n    var showContextToolbarEvent = 'contexttoolbar-show';\n    var hideContextToolbarEvent = 'contexttoolbar-hide';\n\n    var schema$k = constant([\n      strict$1('dom'),\n      defaulted$1('shell', true),\n      field$1('toolbarBehaviours', [Replacing])\n    ]);\n    var enhanceGroups = function () {\n      return { behaviours: derive$1([Replacing.config({})]) };\n    };\n    var parts$7 = constant([optional({\n        name: 'groups',\n        overrides: enhanceGroups\n      })]);\n\n    var factory$9 = function (detail, components, _spec, _externals) {\n      var setGroups = function (toolbar, groups) {\n        getGroupContainer(toolbar).fold(function () {\n          console.error('Toolbar was defined to not be a shell, but no groups container was specified in components');\n          throw new Error('Toolbar was defined to not be a shell, but no groups container was specified in components');\n        }, function (container) {\n          Replacing.set(container, groups);\n        });\n      };\n      var getGroupContainer = function (component) {\n        return detail.shell ? Optional.some(component) : getPart(component, detail, 'groups');\n      };\n      var extra = detail.shell ? {\n        behaviours: [Replacing.config({})],\n        components: []\n      } : {\n        behaviours: [],\n        components: components\n      };\n      return {\n        uid: detail.uid,\n        dom: detail.dom,\n        components: extra.components,\n        behaviours: augment(detail.toolbarBehaviours, extra.behaviours),\n        apis: { setGroups: setGroups },\n        domModification: { attributes: { role: 'group' } }\n      };\n    };\n    var Toolbar = composite$1({\n      name: 'Toolbar',\n      configFields: schema$k(),\n      partFields: parts$7(),\n      factory: factory$9,\n      apis: {\n        setGroups: function (apis, toolbar, groups) {\n          apis.setGroups(toolbar, groups);\n        }\n      }\n    });\n\n    var generate$6 = function (xs, f) {\n      var init = {\n        len: 0,\n        list: []\n      };\n      var r = foldl(xs, function (b, a) {\n        var value = f(a, b.len);\n        return value.fold(constant(b), function (v) {\n          return {\n            len: v.finish,\n            list: b.list.concat([v])\n          };\n        });\n      }, init);\n      return r.list;\n    };\n\n    var output$1 = function (within, extra, withinWidth) {\n      return {\n        within: within,\n        extra: extra,\n        withinWidth: withinWidth\n      };\n    };\n    var apportion = function (units, total, len) {\n      var parray = generate$6(units, function (unit, current) {\n        var width = len(unit);\n        return Optional.some({\n          element: unit,\n          start: current,\n          finish: current + width,\n          width: width\n        });\n      });\n      var within = filter(parray, function (unit) {\n        return unit.finish <= total;\n      });\n      var withinWidth = foldr(within, function (acc, el) {\n        return acc + el.width;\n      }, 0);\n      var extra = parray.slice(within.length);\n      return {\n        within: within,\n        extra: extra,\n        withinWidth: withinWidth\n      };\n    };\n    var toUnit = function (parray) {\n      return map(parray, function (unit) {\n        return unit.element;\n      });\n    };\n    var fitLast = function (within, extra, withinWidth) {\n      var fits = toUnit(within.concat(extra));\n      return output$1(fits, [], withinWidth);\n    };\n    var overflow = function (within, extra, overflower, withinWidth) {\n      var fits = toUnit(within).concat([overflower]);\n      return output$1(fits, toUnit(extra), withinWidth);\n    };\n    var fitAll = function (within, extra, withinWidth) {\n      return output$1(toUnit(within), [], withinWidth);\n    };\n    var tryFit = function (total, units, len) {\n      var divide = apportion(units, total, len);\n      return divide.extra.length === 0 ? Optional.some(divide) : Optional.none();\n    };\n    var partition$3 = function (total, units, len, overflower) {\n      var divide = tryFit(total, units, len).getOrThunk(function () {\n        return apportion(units, total - len(overflower), len);\n      });\n      var within = divide.within;\n      var extra = divide.extra;\n      var withinWidth = divide.withinWidth;\n      if (extra.length === 1 && extra[0].width <= len(overflower)) {\n        return fitLast(within, extra, withinWidth);\n      } else if (extra.length >= 1) {\n        return overflow(within, extra, overflower, withinWidth);\n      } else {\n        return fitAll(within, extra, withinWidth);\n      }\n    };\n\n    var setGroups = function (toolbar, storedGroups) {\n      var bGroups = map(storedGroups, function (g) {\n        return premade$1(g);\n      });\n      Toolbar.setGroups(toolbar, bGroups);\n    };\n    var findFocusedComp = function (comps) {\n      return findMap(comps, function (comp) {\n        return search(comp.element).bind(function (focusedElm) {\n          return comp.getSystem().getByDom(focusedElm).toOptional();\n        });\n      });\n    };\n    var refresh = function (toolbar, detail, setOverflow) {\n      var primary = getPartOrDie(toolbar, detail, 'primary');\n      var overflowGroup = Coupling.getCoupled(toolbar, 'overflowGroup');\n      set$2(primary.element, 'visibility', 'hidden');\n      var groups = detail.builtGroups.get().concat([overflowGroup]);\n      var focusedComp = findFocusedComp(groups);\n      setOverflow([]);\n      setGroups(primary, groups);\n      var availableWidth = get$8(primary.element);\n      var overflows = partition$3(availableWidth, detail.builtGroups.get(), function (comp) {\n        return get$8(comp.element);\n      }, overflowGroup);\n      if (overflows.extra.length === 0) {\n        Replacing.remove(primary, overflowGroup);\n        setOverflow([]);\n      } else {\n        setGroups(primary, overflows.within);\n        setOverflow(overflows.extra);\n      }\n      remove$6(primary.element, 'visibility');\n      reflow(primary.element);\n      focusedComp.each(Focusing.focus);\n    };\n\n    var schema$l = constant([\n      field$1('splitToolbarBehaviours', [Coupling]),\n      state$1('builtGroups', function () {\n        return Cell([]);\n      })\n    ]);\n\n    var schema$m = constant([\n      markers(['overflowToggledClass']),\n      optionFunction('getOverflowBounds'),\n      strict$1('lazySink'),\n      state$1('overflowGroups', function () {\n        return Cell([]);\n      })\n    ].concat(schema$l()));\n    var parts$8 = constant([\n      required({\n        factory: Toolbar,\n        schema: schema$k(),\n        name: 'primary'\n      }),\n      external$1({\n        schema: schema$k(),\n        name: 'overflow'\n      }),\n      external$1({ name: 'overflow-button' }),\n      external$1({ name: 'overflow-group' })\n    ]);\n\n    var schema$n = constant([\n      markers(['toggledClass']),\n      strict$1('lazySink'),\n      strictFunction('fetch'),\n      optionFunction('getBounds'),\n      optionObjOf('fireDismissalEventInstead', [defaulted$1('event', dismissRequested())]),\n      schema$1()\n    ]);\n    var parts$9 = constant([\n      external$1({\n        name: 'button',\n        overrides: function (detail) {\n          return {\n            dom: { attributes: { 'aria-haspopup': 'true' } },\n            buttonBehaviours: derive$1([Toggling.config({\n                toggleClass: detail.markers.toggledClass,\n                aria: { mode: 'expanded' },\n                toggleOnExecute: false\n              })])\n          };\n        }\n      }),\n      external$1({\n        factory: Toolbar,\n        schema: schema$k(),\n        name: 'toolbar',\n        overrides: function (detail) {\n          return {\n            toolbarBehaviours: derive$1([Keying.config({\n                mode: 'cyclic',\n                onEscape: function (comp) {\n                  getPart(comp, detail, 'button').each(Focusing.focus);\n                  return Optional.none();\n                }\n              })])\n          };\n        }\n      })\n    ]);\n\n    var toggle$2 = function (button, externals) {\n      var toolbarSandbox = Coupling.getCoupled(button, 'toolbarSandbox');\n      if (Sandboxing.isOpen(toolbarSandbox)) {\n        Sandboxing.close(toolbarSandbox);\n      } else {\n        Sandboxing.open(toolbarSandbox, externals.toolbar());\n      }\n    };\n    var position$2 = function (button, toolbar, detail, layouts) {\n      var bounds = detail.getBounds.map(function (bounder) {\n        return bounder();\n      });\n      var sink = detail.lazySink(button).getOrDie();\n      Positioning.positionWithinBounds(sink, {\n        anchor: 'hotspot',\n        hotspot: button,\n        layouts: layouts,\n        overrides: { maxWidthFunction: expandable$1() }\n      }, toolbar, bounds);\n    };\n    var setGroups$1 = function (button, toolbar, detail, layouts, groups) {\n      Toolbar.setGroups(toolbar, groups);\n      position$2(button, toolbar, detail, layouts);\n      Toggling.on(button);\n    };\n    var makeSandbox$1 = function (button, spec, detail) {\n      var ariaOwner = manager();\n      var onOpen = function (sandbox, toolbar) {\n        detail.fetch().get(function (groups) {\n          setGroups$1(button, toolbar, detail, spec.layouts, groups);\n          ariaOwner.link(button.element);\n          Keying.focusIn(toolbar);\n        });\n      };\n      var onClose = function () {\n        Toggling.off(button);\n        Focusing.focus(button);\n        ariaOwner.unlink(button.element);\n      };\n      return {\n        dom: {\n          tag: 'div',\n          attributes: { id: ariaOwner.id }\n        },\n        behaviours: derive$1([\n          Keying.config({\n            mode: 'special',\n            onEscape: function (comp) {\n              Sandboxing.close(comp);\n              return Optional.some(true);\n            }\n          }),\n          Sandboxing.config({\n            onOpen: onOpen,\n            onClose: onClose,\n            isPartOf: function (container, data, queryElem) {\n              return isPartOf(data, queryElem) || isPartOf(button, queryElem);\n            },\n            getAttachPoint: function () {\n              return detail.lazySink(button).getOrDie();\n            }\n          }),\n          Receiving.config({\n            channels: __assign(__assign({}, receivingChannel(__assign({ isExtraPart: never }, detail.fireDismissalEventInstead.map(function (fe) {\n              return { fireEventInstead: { event: fe.event } };\n            }).getOr({})))), receivingChannel$1({\n              doReposition: function () {\n                Sandboxing.getState(Coupling.getCoupled(button, 'toolbarSandbox')).each(function (toolbar) {\n                  position$2(button, toolbar, detail, spec.layouts);\n                });\n              }\n            }))\n          })\n        ])\n      };\n    };\n    var factory$a = function (detail, components, spec, externals) {\n      return __assign(__assign({}, Button.sketch(__assign(__assign({}, externals.button()), {\n        action: function (button) {\n          toggle$2(button, externals);\n        },\n        buttonBehaviours: SketchBehaviours.augment({ dump: externals.button().buttonBehaviours }, [Coupling.config({\n            others: {\n              toolbarSandbox: function (button) {\n                return makeSandbox$1(button, spec, detail);\n              }\n            }\n          })])\n      }))), {\n        apis: {\n          setGroups: function (button, groups) {\n            Sandboxing.getState(Coupling.getCoupled(button, 'toolbarSandbox')).each(function (toolbar) {\n              setGroups$1(button, toolbar, detail, spec.layouts, groups);\n            });\n          },\n          reposition: function (button) {\n            Sandboxing.getState(Coupling.getCoupled(button, 'toolbarSandbox')).each(function (toolbar) {\n              position$2(button, toolbar, detail, spec.layouts);\n            });\n          },\n          toggle: function (button) {\n            toggle$2(button, externals);\n          },\n          getToolbar: function (button) {\n            return Sandboxing.getState(Coupling.getCoupled(button, 'toolbarSandbox'));\n          },\n          isOpen: function (button) {\n            return Sandboxing.isOpen(Coupling.getCoupled(button, 'toolbarSandbox'));\n          }\n        }\n      });\n    };\n    var FloatingToolbarButton = composite$1({\n      name: 'FloatingToolbarButton',\n      factory: factory$a,\n      configFields: schema$n(),\n      partFields: parts$9(),\n      apis: {\n        setGroups: function (apis, button, groups) {\n          apis.setGroups(button, groups);\n        },\n        reposition: function (apis, button) {\n          apis.reposition(button);\n        },\n        toggle: function (apis, button) {\n          apis.toggle(button);\n        },\n        getToolbar: function (apis, button) {\n          return apis.getToolbar(button);\n        },\n        isOpen: function (apis, button) {\n          return apis.isOpen(button);\n        }\n      }\n    });\n\n    var schema$o = constant([\n      strict$1('items'),\n      markers(['itemSelector']),\n      field$1('tgroupBehaviours', [Keying])\n    ]);\n    var parts$a = constant([group({\n        name: 'items',\n        unit: 'item'\n      })]);\n\n    var factory$b = function (detail, components, _spec, _externals) {\n      return {\n        uid: detail.uid,\n        dom: detail.dom,\n        components: components,\n        behaviours: augment(detail.tgroupBehaviours, [Keying.config({\n            mode: 'flow',\n            selector: detail.markers.itemSelector\n          })]),\n        domModification: { attributes: { role: 'toolbar' } }\n      };\n    };\n    var ToolbarGroup = composite$1({\n      name: 'ToolbarGroup',\n      configFields: schema$o(),\n      partFields: parts$a(),\n      factory: factory$b\n    });\n\n    var buildGroups = function (comps) {\n      return map(comps, function (g) {\n        return premade$1(g);\n      });\n    };\n    var refresh$1 = function (toolbar, memFloatingToolbarButton, detail) {\n      refresh(toolbar, detail, function (overflowGroups) {\n        detail.overflowGroups.set(overflowGroups);\n        memFloatingToolbarButton.getOpt(toolbar).each(function (floatingToolbarButton) {\n          FloatingToolbarButton.setGroups(floatingToolbarButton, buildGroups(overflowGroups));\n        });\n      });\n    };\n    var factory$c = function (detail, components, spec, externals) {\n      var memFloatingToolbarButton = record(FloatingToolbarButton.sketch({\n        fetch: function () {\n          return Future.nu(function (resolve) {\n            resolve(buildGroups(detail.overflowGroups.get()));\n          });\n        },\n        layouts: {\n          onLtr: function () {\n            return [\n              southwest$1,\n              southeast$1\n            ];\n          },\n          onRtl: function () {\n            return [\n              southeast$1,\n              southwest$1\n            ];\n          },\n          onBottomLtr: function () {\n            return [\n              northwest$1,\n              northeast$1\n            ];\n          },\n          onBottomRtl: function () {\n            return [\n              northeast$1,\n              northwest$1\n            ];\n          }\n        },\n        getBounds: spec.getOverflowBounds,\n        lazySink: detail.lazySink,\n        fireDismissalEventInstead: {},\n        markers: { toggledClass: detail.markers.overflowToggledClass },\n        parts: {\n          button: externals['overflow-button'](),\n          toolbar: externals.overflow()\n        }\n      }));\n      return {\n        uid: detail.uid,\n        dom: detail.dom,\n        components: components,\n        behaviours: augment(detail.splitToolbarBehaviours, [Coupling.config({\n            others: {\n              overflowGroup: function () {\n                return ToolbarGroup.sketch(__assign(__assign({}, externals['overflow-group']()), { items: [memFloatingToolbarButton.asSpec()] }));\n              }\n            }\n          })]),\n        apis: {\n          setGroups: function (toolbar, groups) {\n            detail.builtGroups.set(map(groups, toolbar.getSystem().build));\n            refresh$1(toolbar, memFloatingToolbarButton, detail);\n          },\n          refresh: function (toolbar) {\n            return refresh$1(toolbar, memFloatingToolbarButton, detail);\n          },\n          toggle: function (toolbar) {\n            memFloatingToolbarButton.getOpt(toolbar).each(function (floatingToolbarButton) {\n              FloatingToolbarButton.toggle(floatingToolbarButton);\n            });\n          },\n          isOpen: function (toolbar) {\n            return memFloatingToolbarButton.getOpt(toolbar).map(FloatingToolbarButton.isOpen).getOr(false);\n          },\n          reposition: function (toolbar) {\n            memFloatingToolbarButton.getOpt(toolbar).each(function (floatingToolbarButton) {\n              FloatingToolbarButton.reposition(floatingToolbarButton);\n            });\n          },\n          getOverflow: function (toolbar) {\n            return memFloatingToolbarButton.getOpt(toolbar).bind(FloatingToolbarButton.getToolbar);\n          }\n        },\n        domModification: { attributes: { role: 'group' } }\n      };\n    };\n    var SplitFloatingToolbar = composite$1({\n      name: 'SplitFloatingToolbar',\n      configFields: schema$m(),\n      partFields: parts$8(),\n      factory: factory$c,\n      apis: {\n        setGroups: function (apis, toolbar, groups) {\n          apis.setGroups(toolbar, groups);\n        },\n        refresh: function (apis, toolbar) {\n          apis.refresh(toolbar);\n        },\n        reposition: function (apis, toolbar) {\n          apis.reposition(toolbar);\n        },\n        toggle: function (apis, toolbar) {\n          apis.toggle(toolbar);\n        },\n        isOpen: function (apis, toolbar) {\n          return apis.isOpen(toolbar);\n        },\n        getOverflow: function (apis, toolbar) {\n          return apis.getOverflow(toolbar);\n        }\n      }\n    });\n\n    var getAnimationRoot = function (component, slideConfig) {\n      return slideConfig.getAnimationRoot.fold(function () {\n        return component.element;\n      }, function (get) {\n        return get(component);\n      });\n    };\n\n    var getDimensionProperty = function (slideConfig) {\n      return slideConfig.dimension.property;\n    };\n    var getDimension = function (slideConfig, elem) {\n      return slideConfig.dimension.getDimension(elem);\n    };\n    var disableTransitions = function (component, slideConfig) {\n      var root = getAnimationRoot(component, slideConfig);\n      remove$5(root, [\n        slideConfig.shrinkingClass,\n        slideConfig.growingClass\n      ]);\n    };\n    var setShrunk = function (component, slideConfig) {\n      remove$4(component.element, slideConfig.openClass);\n      add$2(component.element, slideConfig.closedClass);\n      set$2(component.element, getDimensionProperty(slideConfig), '0px');\n      reflow(component.element);\n    };\n    var setGrown = function (component, slideConfig) {\n      remove$4(component.element, slideConfig.closedClass);\n      add$2(component.element, slideConfig.openClass);\n      remove$6(component.element, getDimensionProperty(slideConfig));\n    };\n    var doImmediateShrink = function (component, slideConfig, slideState, _calculatedSize) {\n      slideState.setCollapsed();\n      set$2(component.element, getDimensionProperty(slideConfig), getDimension(slideConfig, component.element));\n      reflow(component.element);\n      disableTransitions(component, slideConfig);\n      setShrunk(component, slideConfig);\n      slideConfig.onStartShrink(component);\n      slideConfig.onShrunk(component);\n    };\n    var doStartShrink = function (component, slideConfig, slideState, calculatedSize) {\n      var size = calculatedSize.getOrThunk(function () {\n        return getDimension(slideConfig, component.element);\n      });\n      slideState.setCollapsed();\n      set$2(component.element, getDimensionProperty(slideConfig), size);\n      reflow(component.element);\n      var root = getAnimationRoot(component, slideConfig);\n      remove$4(root, slideConfig.growingClass);\n      add$2(root, slideConfig.shrinkingClass);\n      setShrunk(component, slideConfig);\n      slideConfig.onStartShrink(component);\n    };\n    var doStartSmartShrink = function (component, slideConfig, slideState) {\n      var size = getDimension(slideConfig, component.element);\n      var shrinker = size === '0px' ? doImmediateShrink : doStartShrink;\n      shrinker(component, slideConfig, slideState, Optional.some(size));\n    };\n    var doStartGrow = function (component, slideConfig, slideState) {\n      var root = getAnimationRoot(component, slideConfig);\n      var wasShrinking = has$2(root, slideConfig.shrinkingClass);\n      var beforeSize = getDimension(slideConfig, component.element);\n      setGrown(component, slideConfig);\n      var fullSize = getDimension(slideConfig, component.element);\n      var startPartialGrow = function () {\n        set$2(component.element, getDimensionProperty(slideConfig), beforeSize);\n        reflow(component.element);\n      };\n      var startCompleteGrow = function () {\n        setShrunk(component, slideConfig);\n      };\n      var setStartSize = wasShrinking ? startPartialGrow : startCompleteGrow;\n      setStartSize();\n      remove$4(root, slideConfig.shrinkingClass);\n      add$2(root, slideConfig.growingClass);\n      setGrown(component, slideConfig);\n      set$2(component.element, getDimensionProperty(slideConfig), fullSize);\n      slideState.setExpanded();\n      slideConfig.onStartGrow(component);\n    };\n    var refresh$2 = function (component, slideConfig, slideState) {\n      if (slideState.isExpanded()) {\n        remove$6(component.element, getDimensionProperty(slideConfig));\n        var fullSize = getDimension(slideConfig, component.element);\n        set$2(component.element, getDimensionProperty(slideConfig), fullSize);\n      }\n    };\n    var grow = function (component, slideConfig, slideState) {\n      if (!slideState.isExpanded()) {\n        doStartGrow(component, slideConfig, slideState);\n      }\n    };\n    var shrink = function (component, slideConfig, slideState) {\n      if (slideState.isExpanded()) {\n        doStartSmartShrink(component, slideConfig, slideState);\n      }\n    };\n    var immediateShrink = function (component, slideConfig, slideState) {\n      if (slideState.isExpanded()) {\n        doImmediateShrink(component, slideConfig, slideState, Optional.none());\n      }\n    };\n    var hasGrown = function (component, slideConfig, slideState) {\n      return slideState.isExpanded();\n    };\n    var hasShrunk = function (component, slideConfig, slideState) {\n      return slideState.isCollapsed();\n    };\n    var isGrowing = function (component, slideConfig, _slideState) {\n      var root = getAnimationRoot(component, slideConfig);\n      return has$2(root, slideConfig.growingClass) === true;\n    };\n    var isShrinking = function (component, slideConfig, _slideState) {\n      var root = getAnimationRoot(component, slideConfig);\n      return has$2(root, slideConfig.shrinkingClass) === true;\n    };\n    var isTransitioning = function (component, slideConfig, slideState) {\n      return isGrowing(component, slideConfig) || isShrinking(component, slideConfig);\n    };\n    var toggleGrow = function (component, slideConfig, slideState) {\n      var f = slideState.isExpanded() ? doStartSmartShrink : doStartGrow;\n      f(component, slideConfig, slideState);\n    };\n\n    var SlidingApis = /*#__PURE__*/Object.freeze({\n        __proto__: null,\n        refresh: refresh$2,\n        grow: grow,\n        shrink: shrink,\n        immediateShrink: immediateShrink,\n        hasGrown: hasGrown,\n        hasShrunk: hasShrunk,\n        isGrowing: isGrowing,\n        isShrinking: isShrinking,\n        isTransitioning: isTransitioning,\n        toggleGrow: toggleGrow,\n        disableTransitions: disableTransitions\n    });\n\n    var exhibit$6 = function (base, slideConfig, _slideState) {\n      var expanded = slideConfig.expanded;\n      return expanded ? nu$6({\n        classes: [slideConfig.openClass],\n        styles: {}\n      }) : nu$6({\n        classes: [slideConfig.closedClass],\n        styles: wrap$1(slideConfig.dimension.property, '0px')\n      });\n    };\n    var events$d = function (slideConfig, slideState) {\n      return derive([runOnSource(transitionend(), function (component, simulatedEvent) {\n          var raw = simulatedEvent.event.raw;\n          if (raw.propertyName === slideConfig.dimension.property) {\n            disableTransitions(component, slideConfig);\n            if (slideState.isExpanded()) {\n              remove$6(component.element, slideConfig.dimension.property);\n            }\n            var notify = slideState.isExpanded() ? slideConfig.onGrown : slideConfig.onShrunk;\n            notify(component);\n          }\n        })]);\n    };\n\n    var ActiveSliding = /*#__PURE__*/Object.freeze({\n        __proto__: null,\n        exhibit: exhibit$6,\n        events: events$d\n    });\n\n    var SlidingSchema = [\n      strict$1('closedClass'),\n      strict$1('openClass'),\n      strict$1('shrinkingClass'),\n      strict$1('growingClass'),\n      option('getAnimationRoot'),\n      onHandler('onShrunk'),\n      onHandler('onStartShrink'),\n      onHandler('onGrown'),\n      onHandler('onStartGrow'),\n      defaulted$1('expanded', false),\n      strictOf('dimension', choose$1('property', {\n        width: [\n          output('property', 'width'),\n          output('getDimension', function (elem) {\n            return get$8(elem) + 'px';\n          })\n        ],\n        height: [\n          output('property', 'height'),\n          output('getDimension', function (elem) {\n            return get$7(elem) + 'px';\n          })\n        ]\n      }))\n    ];\n\n    var init$9 = function (spec) {\n      var state = Cell(spec.expanded);\n      var readState = function () {\n        return 'expanded: ' + state.get();\n      };\n      return nu$5({\n        isExpanded: function () {\n          return state.get() === true;\n        },\n        isCollapsed: function () {\n          return state.get() === false;\n        },\n        setCollapsed: curry(state.set, false),\n        setExpanded: curry(state.set, true),\n        readState: readState\n      });\n    };\n\n    var SlidingState = /*#__PURE__*/Object.freeze({\n        __proto__: null,\n        init: init$9\n    });\n\n    var Sliding = create$1({\n      fields: SlidingSchema,\n      name: 'sliding',\n      active: ActiveSliding,\n      apis: SlidingApis,\n      state: SlidingState\n    });\n\n    var schema$p = constant([\n      markers([\n        'closedClass',\n        'openClass',\n        'shrinkingClass',\n        'growingClass',\n        'overflowToggledClass'\n      ]),\n      onHandler('onOpened'),\n      onHandler('onClosed')\n    ].concat(schema$l()));\n    var parts$b = constant([\n      required({\n        factory: Toolbar,\n        schema: schema$k(),\n        name: 'primary'\n      }),\n      required({\n        factory: Toolbar,\n        schema: schema$k(),\n        name: 'overflow',\n        overrides: function (detail) {\n          return {\n            toolbarBehaviours: derive$1([\n              Sliding.config({\n                dimension: { property: 'height' },\n                closedClass: detail.markers.closedClass,\n                openClass: detail.markers.openClass,\n                shrinkingClass: detail.markers.shrinkingClass,\n                growingClass: detail.markers.growingClass,\n                onShrunk: function (comp) {\n                  getPart(comp, detail, 'overflow-button').each(function (button) {\n                    Toggling.off(button);\n                    Focusing.focus(button);\n                  });\n                  detail.onClosed(comp);\n                },\n                onGrown: function (comp) {\n                  Keying.focusIn(comp);\n                  detail.onOpened(comp);\n                },\n                onStartGrow: function (comp) {\n                  getPart(comp, detail, 'overflow-button').each(Toggling.on);\n                }\n              }),\n              Keying.config({\n                mode: 'acyclic',\n                onEscape: function (comp) {\n                  getPart(comp, detail, 'overflow-button').each(Focusing.focus);\n                  return Optional.some(true);\n                }\n              })\n            ])\n          };\n        }\n      }),\n      external$1({\n        name: 'overflow-button',\n        overrides: function (detail) {\n          return {\n            buttonBehaviours: derive$1([Toggling.config({\n                toggleClass: detail.markers.overflowToggledClass,\n                aria: { mode: 'pressed' },\n                toggleOnExecute: false\n              })])\n          };\n        }\n      }),\n      external$1({ name: 'overflow-group' })\n    ]);\n\n    var isOpen$1 = function (toolbar, detail) {\n      return getPart(toolbar, detail, 'overflow').map(Sliding.hasGrown).getOr(false);\n    };\n    var toggleToolbar = function (toolbar, detail) {\n      getPart(toolbar, detail, 'overflow-button').bind(function () {\n        return getPart(toolbar, detail, 'overflow');\n      }).each(function (overf) {\n        refresh$3(toolbar, detail);\n        Sliding.toggleGrow(overf);\n      });\n    };\n    var refresh$3 = function (toolbar, detail) {\n      getPart(toolbar, detail, 'overflow').each(function (overflow) {\n        refresh(toolbar, detail, function (groups) {\n          var builtGroups = map(groups, function (g) {\n            return premade$1(g);\n          });\n          Toolbar.setGroups(overflow, builtGroups);\n        });\n        getPart(toolbar, detail, 'overflow-button').each(function (button) {\n          if (Sliding.hasGrown(overflow)) {\n            Toggling.on(button);\n          }\n        });\n        Sliding.refresh(overflow);\n      });\n    };\n    var factory$d = function (detail, components, spec, externals) {\n      var toolbarToggleEvent = 'alloy.toolbar.toggle';\n      var doSetGroups = function (toolbar, groups) {\n        var built = map(groups, toolbar.getSystem().build);\n        detail.builtGroups.set(built);\n      };\n      return {\n        uid: detail.uid,\n        dom: detail.dom,\n        components: components,\n        behaviours: augment(detail.splitToolbarBehaviours, [\n          Coupling.config({\n            others: {\n              overflowGroup: function (toolbar) {\n                return ToolbarGroup.sketch(__assign(__assign({}, externals['overflow-group']()), {\n                  items: [Button.sketch(__assign(__assign({}, externals['overflow-button']()), {\n                      action: function (_button) {\n                        emit(toolbar, toolbarToggleEvent);\n                      }\n                    }))]\n                }));\n              }\n            }\n          }),\n          config('toolbar-toggle-events', [run(toolbarToggleEvent, function (toolbar) {\n              toggleToolbar(toolbar, detail);\n            })])\n        ]),\n        apis: {\n          setGroups: function (toolbar, groups) {\n            doSetGroups(toolbar, groups);\n            refresh$3(toolbar, detail);\n          },\n          refresh: function (toolbar) {\n            return refresh$3(toolbar, detail);\n          },\n          toggle: function (toolbar) {\n            return toggleToolbar(toolbar, detail);\n          },\n          isOpen: function (toolbar) {\n            return isOpen$1(toolbar, detail);\n          }\n        },\n        domModification: { attributes: { role: 'group' } }\n      };\n    };\n    var SplitSlidingToolbar = composite$1({\n      name: 'SplitSlidingToolbar',\n      configFields: schema$p(),\n      partFields: parts$b(),\n      factory: factory$d,\n      apis: {\n        setGroups: function (apis, toolbar, groups) {\n          apis.setGroups(toolbar, groups);\n        },\n        refresh: function (apis, toolbar) {\n          apis.refresh(toolbar);\n        },\n        toggle: function (apis, toolbar) {\n          apis.toggle(toolbar);\n        },\n        isOpen: function (apis, toolbar) {\n          return apis.isOpen(toolbar);\n        }\n      }\n    });\n\n    var toolbarHeightChange = constant(generate$1('toolbar-height-change'));\n\n    var renderToolbarGroupCommon = function (toolbarGroup) {\n      var attributes = toolbarGroup.title.fold(function () {\n        return {};\n      }, function (title) {\n        return { attributes: { title: title } };\n      });\n      return {\n        dom: __assign({\n          tag: 'div',\n          classes: ['tox-toolbar__group']\n        }, attributes),\n        components: [ToolbarGroup.parts.items({})],\n        items: toolbarGroup.items,\n        markers: { itemSelector: '*:not(.tox-split-button) > .tox-tbtn:not([disabled]), ' + '.tox-split-button:not([disabled]), ' + '.tox-toolbar-nav-js:not([disabled])' },\n        tgroupBehaviours: derive$1([\n          Tabstopping.config({}),\n          Focusing.config({})\n        ])\n      };\n    };\n    var renderToolbarGroup = function (toolbarGroup) {\n      return ToolbarGroup.sketch(renderToolbarGroupCommon(toolbarGroup));\n    };\n    var getToolbarbehaviours = function (toolbarSpec, modeName) {\n      var onAttached = runOnAttached(function (component) {\n        var groups = map(toolbarSpec.initGroups, renderToolbarGroup);\n        Toolbar.setGroups(component, groups);\n      });\n      return derive$1([\n        DisablingConfigs.toolbarButton(toolbarSpec.providers.isDisabled),\n        receivingConfig(),\n        Keying.config({\n          mode: modeName,\n          onEscape: toolbarSpec.onEscape,\n          selector: '.tox-toolbar__group'\n        }),\n        config('toolbar-events', [onAttached])\n      ]);\n    };\n    var renderMoreToolbarCommon = function (toolbarSpec) {\n      var modeName = toolbarSpec.cyclicKeying ? 'cyclic' : 'acyclic';\n      return {\n        uid: toolbarSpec.uid,\n        dom: {\n          tag: 'div',\n          classes: ['tox-toolbar-overlord']\n        },\n        parts: {\n          'overflow-group': renderToolbarGroupCommon({\n            title: Optional.none(),\n            items: []\n          }),\n          'overflow-button': renderIconButtonSpec({\n            name: 'more',\n            icon: Optional.some('more-drawer'),\n            disabled: false,\n            tooltip: Optional.some('More...'),\n            primary: false,\n            borderless: false\n          }, Optional.none(), toolbarSpec.providers)\n        },\n        splitToolbarBehaviours: getToolbarbehaviours(toolbarSpec, modeName)\n      };\n    };\n    var renderFloatingMoreToolbar = function (toolbarSpec) {\n      var baseSpec = renderMoreToolbarCommon(toolbarSpec);\n      var overflowXOffset = 4;\n      var primary = SplitFloatingToolbar.parts.primary({\n        dom: {\n          tag: 'div',\n          classes: ['tox-toolbar__primary']\n        }\n      });\n      return SplitFloatingToolbar.sketch(__assign(__assign({}, baseSpec), {\n        lazySink: toolbarSpec.getSink,\n        getOverflowBounds: function () {\n          var headerElem = toolbarSpec.moreDrawerData.lazyHeader().element;\n          var headerBounds = absolute$1(headerElem);\n          var docElem = documentElement(headerElem);\n          var docBounds = absolute$1(docElem);\n          var height = Math.max(docElem.dom.scrollHeight, docBounds.height);\n          return bounds$1(headerBounds.x + overflowXOffset, docBounds.y, headerBounds.width - overflowXOffset * 2, height);\n        },\n        parts: __assign(__assign({}, baseSpec.parts), {\n          overflow: {\n            dom: {\n              tag: 'div',\n              classes: ['tox-toolbar__overflow'],\n              attributes: toolbarSpec.attributes\n            }\n          }\n        }),\n        components: [primary],\n        markers: { overflowToggledClass: 'tox-tbtn--enabled' }\n      }));\n    };\n    var renderSlidingMoreToolbar = function (toolbarSpec) {\n      var primary = SplitSlidingToolbar.parts.primary({\n        dom: {\n          tag: 'div',\n          classes: ['tox-toolbar__primary']\n        }\n      });\n      var overflow = SplitSlidingToolbar.parts.overflow({\n        dom: {\n          tag: 'div',\n          classes: ['tox-toolbar__overflow']\n        }\n      });\n      var baseSpec = renderMoreToolbarCommon(toolbarSpec);\n      return SplitSlidingToolbar.sketch(__assign(__assign({}, baseSpec), {\n        components: [\n          primary,\n          overflow\n        ],\n        markers: {\n          openClass: 'tox-toolbar__overflow--open',\n          closedClass: 'tox-toolbar__overflow--closed',\n          growingClass: 'tox-toolbar__overflow--growing',\n          shrinkingClass: 'tox-toolbar__overflow--shrinking',\n          overflowToggledClass: 'tox-tbtn--enabled'\n        },\n        onOpened: function (comp) {\n          comp.getSystem().broadcastOn([toolbarHeightChange()], { type: 'opened' });\n        },\n        onClosed: function (comp) {\n          comp.getSystem().broadcastOn([toolbarHeightChange()], { type: 'closed' });\n        }\n      }));\n    };\n    var renderToolbar = function (toolbarSpec) {\n      var modeName = toolbarSpec.cyclicKeying ? 'cyclic' : 'acyclic';\n      return Toolbar.sketch({\n        uid: toolbarSpec.uid,\n        dom: {\n          tag: 'div',\n          classes: ['tox-toolbar'].concat(toolbarSpec.type === ToolbarMode.scrolling ? ['tox-toolbar--scrolling'] : [])\n        },\n        components: [Toolbar.parts.groups({})],\n        toolbarBehaviours: getToolbarbehaviours(toolbarSpec, modeName)\n      });\n    };\n\n    var groupToolbarButtonSchema = objOf([\n      strictString('type'),\n      strictOf('items', oneOf([\n        arrOfObj$1([\n          strictString('name'),\n          strictArrayOf('items', string)\n        ]),\n        string\n      ]))\n    ].concat(baseToolbarButtonFields));\n    var createGroupToolbarButton = function (spec) {\n      return asRaw('GroupToolbarButton', groupToolbarButtonSchema, spec);\n    };\n\n    var baseMenuButtonFields = [\n      optionString('text'),\n      optionString('tooltip'),\n      optionString('icon'),\n      strictFunction('fetch'),\n      defaultedFunction('onSetup', function () {\n        return noop;\n      })\n    ];\n\n    var MenuButtonSchema = objOf(__spreadArrays([strictString('type')], baseMenuButtonFields));\n    var createMenuButton = function (spec) {\n      return asRaw('menubutton', MenuButtonSchema, spec);\n    };\n\n    var splitButtonSchema = objOf([\n      strictString('type'),\n      optionString('tooltip'),\n      optionString('icon'),\n      optionString('text'),\n      optionFunction('select'),\n      strictFunction('fetch'),\n      defaultedFunction('onSetup', function () {\n        return noop;\n      }),\n      defaultedStringEnum('presets', 'normal', [\n        'normal',\n        'color',\n        'listpreview'\n      ]),\n      defaulted$1('columns', 1),\n      strictFunction('onAction'),\n      strictFunction('onItemAction')\n    ]);\n    var createSplitButton = function (spec) {\n      return asRaw('SplitButton', splitButtonSchema, spec);\n    };\n\n    var events$e = function (reflectingConfig, reflectingState) {\n      var update = function (component, data) {\n        reflectingConfig.updateState.each(function (updateState) {\n          var newState = updateState(component, data);\n          reflectingState.set(newState);\n        });\n        reflectingConfig.renderComponents.each(function (renderComponents) {\n          var newComponents = renderComponents(data, reflectingState.get());\n          var newChildren = map(newComponents, component.getSystem().build);\n          replaceChildren(component, newChildren);\n        });\n      };\n      return derive([\n        run(receive(), function (component, message) {\n          var receivingData = message;\n          if (!receivingData.universal) {\n            var channel = reflectingConfig.channel;\n            if (contains(receivingData.channels, channel)) {\n              update(component, receivingData.data);\n            }\n          }\n        }),\n        runOnAttached(function (comp, _se) {\n          reflectingConfig.initialData.each(function (rawData) {\n            update(comp, rawData);\n          });\n        })\n      ]);\n    };\n\n    var ActiveReflecting = /*#__PURE__*/Object.freeze({\n        __proto__: null,\n        events: events$e\n    });\n\n    var getState$2 = function (component, replaceConfig, reflectState) {\n      return reflectState;\n    };\n\n    var ReflectingApis = /*#__PURE__*/Object.freeze({\n        __proto__: null,\n        getState: getState$2\n    });\n\n    var ReflectingSchema = [\n      strict$1('channel'),\n      option('renderComponents'),\n      option('updateState'),\n      option('initialData')\n    ];\n\n    var init$a = function () {\n      var cell = Cell(Optional.none());\n      var set = function (optS) {\n        return cell.set(optS);\n      };\n      var clear = function () {\n        return cell.set(Optional.none());\n      };\n      var get = function () {\n        return cell.get();\n      };\n      var readState = function () {\n        return cell.get().fold(function () {\n          return 'none';\n        }, function (x) {\n          return x;\n        });\n      };\n      return {\n        readState: readState,\n        get: get,\n        set: set,\n        clear: clear\n      };\n    };\n\n    var ReflectingState = /*#__PURE__*/Object.freeze({\n        __proto__: null,\n        init: init$a\n    });\n\n    var Reflecting = create$1({\n      fields: ReflectingSchema,\n      name: 'reflecting',\n      active: ActiveReflecting,\n      apis: ReflectingApis,\n      state: ReflectingState\n    });\n\n    var schema$q = constant([\n      strict$1('toggleClass'),\n      strict$1('fetch'),\n      onStrictHandler('onExecute'),\n      defaulted$1('getHotspot', Optional.some),\n      defaulted$1('getAnchorOverrides', constant({})),\n      schema$1(),\n      onStrictHandler('onItemExecute'),\n      option('lazySink'),\n      strict$1('dom'),\n      onHandler('onOpen'),\n      field$1('splitDropdownBehaviours', [\n        Coupling,\n        Keying,\n        Focusing\n      ]),\n      defaulted$1('matchWidth', false),\n      defaulted$1('useMinWidth', false),\n      defaulted$1('eventOrder', {}),\n      option('role')\n    ].concat(sandboxFields()));\n    var arrowPart = required({\n      factory: Button,\n      schema: [strict$1('dom')],\n      name: 'arrow',\n      defaults: function () {\n        return { buttonBehaviours: derive$1([Focusing.revoke()]) };\n      },\n      overrides: function (detail) {\n        return {\n          dom: {\n            tag: 'span',\n            attributes: { role: 'presentation' }\n          },\n          action: function (arrow) {\n            arrow.getSystem().getByUid(detail.uid).each(emitExecute);\n          },\n          buttonBehaviours: derive$1([Toggling.config({\n              toggleOnExecute: false,\n              toggleClass: detail.toggleClass\n            })])\n        };\n      }\n    });\n    var buttonPart = required({\n      factory: Button,\n      schema: [strict$1('dom')],\n      name: 'button',\n      defaults: function () {\n        return { buttonBehaviours: derive$1([Focusing.revoke()]) };\n      },\n      overrides: function (detail) {\n        return {\n          dom: {\n            tag: 'span',\n            attributes: { role: 'presentation' }\n          },\n          action: function (btn) {\n            btn.getSystem().getByUid(detail.uid).each(function (splitDropdown) {\n              detail.onExecute(splitDropdown, btn);\n            });\n          }\n        };\n      }\n    });\n    var parts$c = constant([\n      arrowPart,\n      buttonPart,\n      optional({\n        factory: {\n          sketch: function (spec) {\n            return {\n              uid: spec.uid,\n              dom: {\n                tag: 'span',\n                styles: { display: 'none' },\n                attributes: { 'aria-hidden': 'true' },\n                innerHtml: spec.text\n              }\n            };\n          }\n        },\n        schema: [strict$1('text')],\n        name: 'aria-descriptor'\n      }),\n      external$1({\n        schema: [tieredMenuMarkers()],\n        name: 'menu',\n        defaults: function (detail) {\n          return {\n            onExecute: function (tmenu, item) {\n              tmenu.getSystem().getByUid(detail.uid).each(function (splitDropdown) {\n                detail.onItemExecute(splitDropdown, tmenu, item);\n              });\n            }\n          };\n        }\n      }),\n      partType()\n    ]);\n\n    var factory$e = function (detail, components, spec, externals) {\n      var _a;\n      var switchToMenu = function (sandbox) {\n        Composing.getCurrent(sandbox).each(function (current) {\n          Highlighting.highlightFirst(current);\n          Keying.focusIn(current);\n        });\n      };\n      var action = function (component) {\n        var onOpenSync = switchToMenu;\n        togglePopup(detail, function (x) {\n          return x;\n        }, component, externals, onOpenSync, HighlightOnOpen.HighlightFirst).get(noop);\n      };\n      var openMenu = function (comp) {\n        action(comp);\n        return Optional.some(true);\n      };\n      var executeOnButton = function (comp) {\n        var button = getPartOrDie(comp, detail, 'button');\n        emitExecute(button);\n        return Optional.some(true);\n      };\n      var buttonEvents = __assign(__assign({}, derive([runOnAttached(function (component, _simulatedEvent) {\n          var ariaDescriptor = getPart(component, detail, 'aria-descriptor');\n          ariaDescriptor.each(function (descriptor) {\n            var descriptorId = generate$1('aria');\n            set$1(descriptor.element, 'id', descriptorId);\n            set$1(component.element, 'aria-describedby', descriptorId);\n          });\n        })])), events$7(Optional.some(action)));\n      var apis = {\n        repositionMenus: function (comp) {\n          if (Toggling.isOn(comp)) {\n            repositionMenus(comp);\n          }\n        }\n      };\n      return {\n        uid: detail.uid,\n        dom: detail.dom,\n        components: components,\n        apis: apis,\n        eventOrder: __assign(__assign({}, detail.eventOrder), (_a = {}, _a[execute()] = [\n          'disabling',\n          'toggling',\n          'alloy.base.behaviour'\n        ], _a)),\n        events: buttonEvents,\n        behaviours: augment(detail.splitDropdownBehaviours, [\n          Coupling.config({\n            others: {\n              sandbox: function (hotspot) {\n                var arrow = getPartOrDie(hotspot, detail, 'arrow');\n                var extras = {\n                  onOpen: function () {\n                    Toggling.on(arrow);\n                    Toggling.on(hotspot);\n                  },\n                  onClose: function () {\n                    Toggling.off(arrow);\n                    Toggling.off(hotspot);\n                  }\n                };\n                return makeSandbox(detail, hotspot, extras);\n              }\n            }\n          }),\n          Keying.config({\n            mode: 'special',\n            onSpace: executeOnButton,\n            onEnter: executeOnButton,\n            onDown: openMenu\n          }),\n          Focusing.config({}),\n          Toggling.config({\n            toggleOnExecute: false,\n            aria: { mode: 'expanded' }\n          })\n        ]),\n        domModification: {\n          attributes: {\n            'role': detail.role.getOr('button'),\n            'aria-haspopup': true\n          }\n        }\n      };\n    };\n    var SplitDropdown = composite$1({\n      name: 'SplitDropdown',\n      configFields: schema$q(),\n      partFields: parts$c(),\n      factory: factory$e,\n      apis: {\n        repositionMenus: function (apis, comp) {\n          return apis.repositionMenus(comp);\n        }\n      }\n    });\n\n    var getButtonApi = function (component) {\n      return {\n        isDisabled: function () {\n          return Disabling.isDisabled(component);\n        },\n        setDisabled: function (state) {\n          return Disabling.set(component, state);\n        }\n      };\n    };\n    var getToggleApi = function (component) {\n      return {\n        setActive: function (state) {\n          Toggling.set(component, state);\n        },\n        isActive: function () {\n          return Toggling.isOn(component);\n        },\n        isDisabled: function () {\n          return Disabling.isDisabled(component);\n        },\n        setDisabled: function (state) {\n          return Disabling.set(component, state);\n        }\n      };\n    };\n    var getTooltipAttributes = function (tooltip, providersBackstage) {\n      return tooltip.map(function (tooltip) {\n        return {\n          'aria-label': providersBackstage.translate(tooltip),\n          'title': providersBackstage.translate(tooltip)\n        };\n      }).getOr({});\n    };\n    var focusButtonEvent = generate$1('focus-button');\n    var rtlIcon$1 = [\n      'checklist',\n      'ordered-list'\n    ];\n    var rtlTransform$1 = [\n      'indent',\n      'outdent',\n      'table-insert-column-after',\n      'table-insert-column-before',\n      'unordered-list'\n    ];\n    var renderCommonStructure = function (icon, text, tooltip, receiver, behaviours, providersBackstage) {\n      var _d;\n      var getIconName = function (iconName) {\n        return global$6.isRtl() && contains(rtlIcon$1, iconName) ? iconName + '-rtl' : iconName;\n      };\n      var needsRtlClass = global$6.isRtl() && icon.exists(function (name) {\n        return contains(rtlTransform$1, name);\n      });\n      return {\n        dom: {\n          tag: 'button',\n          classes: ['tox-tbtn'].concat(text.isSome() ? ['tox-tbtn--select'] : []).concat(needsRtlClass ? ['tox-tbtn__icon-rtl'] : []),\n          attributes: getTooltipAttributes(tooltip, providersBackstage)\n        },\n        components: componentRenderPipeline([\n          icon.map(function (iconName) {\n            return renderIconFromPack(getIconName(iconName), providersBackstage.icons);\n          }),\n          text.map(function (text) {\n            return renderLabel$1(text, 'tox-tbtn', providersBackstage);\n          })\n        ]),\n        eventOrder: (_d = {}, _d[mousedown()] = [\n          'focusing',\n          'alloy.base.behaviour',\n          'common-button-display-events'\n        ], _d),\n        buttonBehaviours: derive$1([\n          DisablingConfigs.toolbarButton(providersBackstage.isDisabled),\n          receivingConfig(),\n          config('common-button-display-events', [run(mousedown(), function (button, se) {\n              se.event.prevent();\n              emit(button, focusButtonEvent);\n            })])\n        ].concat(receiver.map(function (r) {\n          return Reflecting.config({\n            channel: r,\n            initialData: {\n              icon: icon,\n              text: text\n            },\n            renderComponents: function (data, _state) {\n              return componentRenderPipeline([\n                data.icon.map(function (iconName) {\n                  return renderIconFromPack(getIconName(iconName), providersBackstage.icons);\n                }),\n                data.text.map(function (text) {\n                  return renderLabel$1(text, 'tox-tbtn', providersBackstage);\n                })\n              ]);\n            }\n          });\n        }).toArray()).concat(behaviours.getOr([])))\n      };\n    };\n    var renderFloatingToolbarButton = function (spec, backstage, identifyButtons, attributes) {\n      var sharedBackstage = backstage.shared;\n      return FloatingToolbarButton.sketch({\n        lazySink: sharedBackstage.getSink,\n        fetch: function () {\n          return Future.nu(function (resolve) {\n            resolve(map(identifyButtons(spec.items), renderToolbarGroup));\n          });\n        },\n        markers: { toggledClass: 'tox-tbtn--enabled' },\n        parts: {\n          button: renderCommonStructure(spec.icon, spec.text, spec.tooltip, Optional.none(), Optional.none(), sharedBackstage.providers),\n          toolbar: {\n            dom: {\n              tag: 'div',\n              classes: ['tox-toolbar__overflow'],\n              attributes: attributes\n            }\n          }\n        }\n      });\n    };\n    var renderCommonToolbarButton = function (spec, specialisation, providersBackstage) {\n      var editorOffCell = Cell(noop);\n      var structure = renderCommonStructure(spec.icon, spec.text, spec.tooltip, Optional.none(), Optional.none(), providersBackstage);\n      return Button.sketch({\n        dom: structure.dom,\n        components: structure.components,\n        eventOrder: toolbarButtonEventOrder,\n        buttonBehaviours: derive$1([\n          config('toolbar-button-events', [\n            onToolbarButtonExecute({\n              onAction: spec.onAction,\n              getApi: specialisation.getApi\n            }),\n            onControlAttached(specialisation, editorOffCell),\n            onControlDetached(specialisation, editorOffCell)\n          ]),\n          DisablingConfigs.toolbarButton(function () {\n            return spec.disabled || providersBackstage.isDisabled();\n          }),\n          receivingConfig()\n        ].concat(specialisation.toolbarButtonBehaviours))\n      });\n    };\n    var renderToolbarButton = function (spec, providersBackstage) {\n      return renderToolbarButtonWith(spec, providersBackstage, []);\n    };\n    var renderToolbarButtonWith = function (spec, providersBackstage, bonusEvents) {\n      return renderCommonToolbarButton(spec, {\n        toolbarButtonBehaviours: [].concat(bonusEvents.length > 0 ? [config('toolbarButtonWith', bonusEvents)] : []),\n        getApi: getButtonApi,\n        onSetup: spec.onSetup\n      }, providersBackstage);\n    };\n    var renderToolbarToggleButton = function (spec, providersBackstage) {\n      return renderToolbarToggleButtonWith(spec, providersBackstage, []);\n    };\n    var renderToolbarToggleButtonWith = function (spec, providersBackstage, bonusEvents) {\n      return deepMerge(renderCommonToolbarButton(spec, {\n        toolbarButtonBehaviours: [\n          Replacing.config({}),\n          Toggling.config({\n            toggleClass: 'tox-tbtn--enabled',\n            aria: { mode: 'pressed' },\n            toggleOnExecute: false\n          })\n        ].concat(bonusEvents.length > 0 ? [config('toolbarToggleButtonWith', bonusEvents)] : []),\n        getApi: getToggleApi,\n        onSetup: spec.onSetup\n      }, providersBackstage));\n    };\n    var fetchChoices = function (getApi, spec, providersBackstage) {\n      return function (comp) {\n        return Future.nu(function (callback) {\n          return spec.fetch(callback);\n        }).map(function (items) {\n          return Optional.from(createTieredDataFrom(deepMerge(createPartialChoiceMenu(generate$1('menu-value'), items, function (value) {\n            spec.onItemAction(getApi(comp), value);\n          }, spec.columns, spec.presets, ItemResponse$1.CLOSE_ON_EXECUTE, spec.select.getOr(never), providersBackstage), {\n            movement: deriveMenuMovement(spec.columns, spec.presets),\n            menuBehaviours: SimpleBehaviours.unnamedEvents(spec.columns !== 'auto' ? [] : [runOnAttached(function (comp, _se) {\n                detectSize(comp, 4, classForPreset(spec.presets)).each(function (_d) {\n                  var numRows = _d.numRows, numColumns = _d.numColumns;\n                  Keying.setGridSize(comp, numRows, numColumns);\n                });\n              })])\n          })));\n        });\n      };\n    };\n    var renderSplitButton = function (spec, sharedBackstage) {\n      var _d;\n      var displayChannel = generate$1('channel-update-split-dropdown-display');\n      var getApi = function (comp) {\n        return {\n          isDisabled: function () {\n            return Disabling.isDisabled(comp);\n          },\n          setDisabled: function (state) {\n            return Disabling.set(comp, state);\n          },\n          setIconFill: function (id, value) {\n            descendant$1(comp.element, 'svg path[id=\"' + id + '\"], rect[id=\"' + id + '\"]').each(function (underlinePath) {\n              set$1(underlinePath, 'fill', value);\n            });\n          },\n          setIconStroke: function (id, value) {\n            descendant$1(comp.element, 'svg path[id=\"' + id + '\"], rect[id=\"' + id + '\"]').each(function (underlinePath) {\n              set$1(underlinePath, 'stroke', value);\n            });\n          },\n          setActive: function (state) {\n            if (comp.getSystem().isConnected()) {\n              set$1(comp.element, 'aria-pressed', state);\n              descendant$1(comp.element, 'span').each(function (button) {\n                comp.getSystem().getByDom(button).each(function (buttonComp) {\n                  return Toggling.set(buttonComp, state);\n                });\n              });\n            }\n          },\n          isActive: function () {\n            return descendant$1(comp.element, 'span').exists(function (button) {\n              if (comp.getSystem().isConnected()) {\n                return comp.getSystem().getByDom(button).exists(Toggling.isOn);\n              } else {\n                return false;\n              }\n            });\n          }\n        };\n      };\n      var editorOffCell = Cell(noop);\n      var specialisation = {\n        getApi: getApi,\n        onSetup: spec.onSetup\n      };\n      return SplitDropdown.sketch({\n        dom: {\n          tag: 'div',\n          classes: ['tox-split-button'],\n          attributes: __assign({ 'aria-pressed': false }, getTooltipAttributes(spec.tooltip, sharedBackstage.providers))\n        },\n        onExecute: function (button) {\n          spec.onAction(getApi(button));\n        },\n        onItemExecute: function (_a, _b, _c) {\n        },\n        splitDropdownBehaviours: derive$1([\n          DisablingConfigs.splitButton(sharedBackstage.providers.isDisabled),\n          receivingConfig(),\n          config('split-dropdown-events', [\n            run(focusButtonEvent, Focusing.focus),\n            onControlAttached(specialisation, editorOffCell),\n            onControlDetached(specialisation, editorOffCell)\n          ]),\n          Unselecting.config({})\n        ]),\n        eventOrder: (_d = {}, _d[attachedToDom()] = [\n          'alloy.base.behaviour',\n          'split-dropdown-events'\n        ], _d),\n        toggleClass: 'tox-tbtn--enabled',\n        lazySink: sharedBackstage.getSink,\n        fetch: fetchChoices(getApi, spec, sharedBackstage.providers),\n        parts: { menu: part(false, spec.columns, spec.presets) },\n        components: [\n          SplitDropdown.parts.button(renderCommonStructure(spec.icon, spec.text, Optional.none(), Optional.some(displayChannel), Optional.some([Toggling.config({\n              toggleClass: 'tox-tbtn--enabled',\n              toggleOnExecute: false\n            })]), sharedBackstage.providers)),\n          SplitDropdown.parts.arrow({\n            dom: {\n              tag: 'button',\n              classes: [\n                'tox-tbtn',\n                'tox-split-button__chevron'\n              ],\n              innerHtml: get$e('chevron-down', sharedBackstage.providers.icons)\n            },\n            buttonBehaviours: derive$1([\n              DisablingConfigs.splitButton(sharedBackstage.providers.isDisabled),\n              receivingConfig()\n            ])\n          }),\n          SplitDropdown.parts['aria-descriptor']({ text: sharedBackstage.providers.translate('To open the popup, press Shift+Enter') })\n        ]\n      });\n    };\n\n    var getFormApi = function (input) {\n      return {\n        hide: function () {\n          return emit(input, sandboxClose());\n        },\n        getValue: function () {\n          return Representing.getValue(input);\n        }\n      };\n    };\n    var runOnExecute$1 = function (memInput, original) {\n      return run(internalToolbarButtonExecute, function (comp, se) {\n        var input = memInput.get(comp);\n        var formApi = getFormApi(input);\n        original.onAction(formApi, se.event.buttonApi);\n      });\n    };\n    var renderContextButton = function (memInput, button, extras) {\n      var _a = button.original, primary = _a.primary, rest = __rest(_a, ['primary']);\n      var bridged = getOrDie(createToolbarButton(__assign(__assign({}, rest), {\n        type: 'button',\n        onAction: noop\n      })));\n      return renderToolbarButtonWith(bridged, extras.backstage.shared.providers, [runOnExecute$1(memInput, button)]);\n    };\n    var renderContextToggleButton = function (memInput, button, extras) {\n      var _a = button.original, primary = _a.primary, rest = __rest(_a, ['primary']);\n      var bridged = getOrDie(createToggleButton(__assign(__assign({}, rest), {\n        type: 'togglebutton',\n        onAction: noop\n      })));\n      return renderToolbarToggleButtonWith(bridged, extras.backstage.shared.providers, [runOnExecute$1(memInput, button)]);\n    };\n    var generateOne$1 = function (memInput, button, providersBackstage) {\n      var extras = { backstage: { shared: { providers: providersBackstage } } };\n      if (button.type === 'contextformtogglebutton') {\n        return renderContextToggleButton(memInput, button, extras);\n      } else {\n        return renderContextButton(memInput, button, extras);\n      }\n    };\n    var generate$7 = function (memInput, buttons, providersBackstage) {\n      var mementos = map(buttons, function (button) {\n        return record(generateOne$1(memInput, button, providersBackstage));\n      });\n      var asSpecs = function () {\n        return map(mementos, function (mem) {\n          return mem.asSpec();\n        });\n      };\n      var findPrimary = function (compInSystem) {\n        return findMap(buttons, function (button, i) {\n          if (button.primary) {\n            return Optional.from(mementos[i]).bind(function (mem) {\n              return mem.getOpt(compInSystem);\n            }).filter(not(Disabling.isDisabled));\n          } else {\n            return Optional.none();\n          }\n        });\n      };\n      return {\n        asSpecs: asSpecs,\n        findPrimary: findPrimary\n      };\n    };\n\n    var buildInitGroups = function (ctx, providers) {\n      var inputAttributes = ctx.label.fold(function () {\n        return {};\n      }, function (label) {\n        return { 'aria-label': label };\n      });\n      var memInput = record(Input.sketch({\n        inputClasses: [\n          'tox-toolbar-textfield',\n          'tox-toolbar-nav-js'\n        ],\n        data: ctx.initValue(),\n        inputAttributes: inputAttributes,\n        selectOnFocus: true,\n        inputBehaviours: derive$1([Keying.config({\n            mode: 'special',\n            onEnter: function (input) {\n              return commands.findPrimary(input).map(function (primary) {\n                emitExecute(primary);\n                return true;\n              });\n            },\n            onLeft: function (comp, se) {\n              se.cut();\n              return Optional.none();\n            },\n            onRight: function (comp, se) {\n              se.cut();\n              return Optional.none();\n            }\n          })])\n      }));\n      var commands = generate$7(memInput, ctx.commands, providers);\n      return [\n        {\n          title: Optional.none(),\n          items: [memInput.asSpec()]\n        },\n        {\n          title: Optional.none(),\n          items: commands.asSpecs()\n        }\n      ];\n    };\n    var renderContextForm = function (toolbarType, ctx, providers) {\n      return renderToolbar({\n        type: toolbarType,\n        uid: generate$1('context-toolbar'),\n        initGroups: buildInitGroups(ctx, providers),\n        onEscape: Optional.none,\n        cyclicKeying: true,\n        providers: providers\n      });\n    };\n    var ContextForm = {\n      renderContextForm: renderContextForm,\n      buildInitGroups: buildInitGroups\n    };\n\n    var getHorizontalBounds = function (contentAreaBox, viewportBounds) {\n      var x = Math.max(viewportBounds.x, contentAreaBox.x);\n      var contentBoxWidth = contentAreaBox.right - x;\n      var maxViewportWidth = viewportBounds.width - (x - viewportBounds.x);\n      var width = Math.min(contentBoxWidth, maxViewportWidth);\n      return {\n        x: x,\n        width: width\n      };\n    };\n    var getVerticalBounds = function (editor, contentAreaBox, viewportBounds, isToolbarLocationTop) {\n      var container = SugarElement.fromDom(editor.getContainer());\n      var header = descendant$1(container, '.tox-editor-header').getOr(container);\n      var headerBox = box(header);\n      var isToolbarBelowContentArea = headerBox.y >= contentAreaBox.bottom;\n      var isToolbarAbove = isToolbarLocationTop && !isToolbarBelowContentArea;\n      if (editor.inline && isToolbarAbove) {\n        return {\n          y: Math.max(headerBox.bottom, viewportBounds.y),\n          bottom: viewportBounds.bottom\n        };\n      }\n      if (editor.inline && !isToolbarAbove) {\n        return {\n          y: viewportBounds.y,\n          bottom: Math.min(headerBox.y, viewportBounds.bottom)\n        };\n      }\n      var containerBounds = box(container);\n      if (isToolbarAbove) {\n        return {\n          y: Math.max(headerBox.bottom, viewportBounds.y),\n          bottom: Math.min(containerBounds.bottom, viewportBounds.bottom)\n        };\n      }\n      return {\n        y: Math.max(containerBounds.y, viewportBounds.y),\n        bottom: Math.min(headerBox.y, viewportBounds.bottom)\n      };\n    };\n    var getContextToolbarBounds = function (editor, sharedBackstage) {\n      var viewportBounds = getBounds(window);\n      var contentAreaBox = box(SugarElement.fromDom(editor.getContentAreaContainer()));\n      var toolbarOrMenubarEnabled = isMenubarEnabled(editor) || isToolbarEnabled(editor) || isMultipleToolbars(editor);\n      var _a = getHorizontalBounds(contentAreaBox, viewportBounds), x = _a.x, width = _a.width;\n      if (editor.inline && !toolbarOrMenubarEnabled) {\n        return bounds$1(x, viewportBounds.y, width, viewportBounds.height);\n      } else {\n        var isToolbarTop = sharedBackstage.header.isPositionedAtTop();\n        var _b = getVerticalBounds(editor, contentAreaBox, viewportBounds, isToolbarTop), y = _b.y, bottom = _b.bottom;\n        return bounds$1(x, y, width, bottom - y);\n      }\n    };\n\n    var matchTargetWith = function (elem, candidates) {\n      var ctxs = filter(candidates, function (toolbarApi) {\n        return toolbarApi.predicate(elem.dom);\n      });\n      var _a = partition(ctxs, function (t) {\n          return t.type === 'contexttoolbar';\n        }), pass = _a.pass, fail = _a.fail;\n      return {\n        contextToolbars: pass,\n        contextForms: fail\n      };\n    };\n    var filterByPositionForStartNode = function (toolbars) {\n      if (toolbars.length <= 1) {\n        return toolbars;\n      } else {\n        var doesPositionExist = function (value) {\n          return exists(toolbars, function (t) {\n            return t.position === value;\n          });\n        };\n        var filterToolbarsByPosition = function (value) {\n          return filter(toolbars, function (t) {\n            return t.position === value;\n          });\n        };\n        var hasSelectionToolbars = doesPositionExist('selection');\n        var hasNodeToolbars = doesPositionExist('node');\n        if (hasSelectionToolbars || hasNodeToolbars) {\n          if (hasNodeToolbars && hasSelectionToolbars) {\n            var nodeToolbars = filterToolbarsByPosition('node');\n            var selectionToolbars = map(filterToolbarsByPosition('selection'), function (t) {\n              return __assign(__assign({}, t), { position: 'node' });\n            });\n            return nodeToolbars.concat(selectionToolbars);\n          } else {\n            return hasSelectionToolbars ? filterToolbarsByPosition('selection') : filterToolbarsByPosition('node');\n          }\n        } else {\n          return filterToolbarsByPosition('line');\n        }\n      }\n    };\n    var filterByPositionForAncestorNode = function (toolbars) {\n      if (toolbars.length <= 1) {\n        return toolbars;\n      } else {\n        var findPosition_1 = function (value) {\n          return find(toolbars, function (t) {\n            return t.position === value;\n          });\n        };\n        var basePosition = findPosition_1('selection').orThunk(function () {\n          return findPosition_1('node');\n        }).orThunk(function () {\n          return findPosition_1('line');\n        }).map(function (t) {\n          return t.position;\n        });\n        return basePosition.fold(function () {\n          return [];\n        }, function (pos) {\n          return filter(toolbars, function (t) {\n            return t.position === pos;\n          });\n        });\n      }\n    };\n    var matchStartNode = function (elem, nodeCandidates, editorCandidates) {\n      var nodeMatches = matchTargetWith(elem, nodeCandidates);\n      if (nodeMatches.contextForms.length > 0) {\n        return Optional.some({\n          elem: elem,\n          toolbars: [nodeMatches.contextForms[0]]\n        });\n      } else {\n        var editorMatches = matchTargetWith(elem, editorCandidates);\n        if (editorMatches.contextForms.length > 0) {\n          return Optional.some({\n            elem: elem,\n            toolbars: [editorMatches.contextForms[0]]\n          });\n        } else if (nodeMatches.contextToolbars.length > 0 || editorMatches.contextToolbars.length > 0) {\n          var toolbars = filterByPositionForStartNode(nodeMatches.contextToolbars.concat(editorMatches.contextToolbars));\n          return Optional.some({\n            elem: elem,\n            toolbars: toolbars\n          });\n        } else {\n          return Optional.none();\n        }\n      }\n    };\n    var matchAncestor = function (isRoot, startNode, scopes) {\n      if (isRoot(startNode)) {\n        return Optional.none();\n      } else {\n        return ancestor(startNode, function (ancestorElem) {\n          var _a = matchTargetWith(ancestorElem, scopes.inNodeScope), contextToolbars = _a.contextToolbars, contextForms = _a.contextForms;\n          var toolbars = contextForms.length > 0 ? contextForms : filterByPositionForAncestorNode(contextToolbars);\n          return toolbars.length > 0 ? Optional.some({\n            elem: ancestorElem,\n            toolbars: toolbars\n          }) : Optional.none();\n        }, isRoot);\n      }\n    };\n    var lookup$1 = function (scopes, editor) {\n      var rootElem = SugarElement.fromDom(editor.getBody());\n      var isRoot = function (elem) {\n        return eq$1(elem, rootElem);\n      };\n      var isOutsideRoot = function (startNode) {\n        return !isRoot(startNode) && !contains$2(rootElem, startNode);\n      };\n      var startNode = SugarElement.fromDom(editor.selection.getNode());\n      if (isOutsideRoot(startNode)) {\n        return Optional.none();\n      }\n      return matchStartNode(startNode, scopes.inNodeScope, scopes.inEditorScope).orThunk(function () {\n        return matchAncestor(isRoot, startNode, scopes);\n      });\n    };\n\n    var categorise = function (contextToolbars, navigate) {\n      var forms = {};\n      var inNodeScope = [];\n      var inEditorScope = [];\n      var formNavigators = {};\n      var lookupTable = {};\n      var registerForm = function (key, toolbarSpec) {\n        var contextForm = getOrDie(createContextForm(toolbarSpec));\n        forms[key] = contextForm;\n        contextForm.launch.map(function (launch) {\n          formNavigators['form:' + key + ''] = __assign(__assign({}, toolbarSpec.launch), {\n            type: launch.type === 'contextformtogglebutton' ? 'togglebutton' : 'button',\n            onAction: function () {\n              navigate(contextForm);\n            }\n          });\n        });\n        if (contextForm.scope === 'editor') {\n          inEditorScope.push(contextForm);\n        } else {\n          inNodeScope.push(contextForm);\n        }\n        lookupTable[key] = contextForm;\n      };\n      var registerToolbar = function (key, toolbarSpec) {\n        createContextToolbar(toolbarSpec).each(function (contextToolbar) {\n          if (toolbarSpec.scope === 'editor') {\n            inEditorScope.push(contextToolbar);\n          } else {\n            inNodeScope.push(contextToolbar);\n          }\n          lookupTable[key] = contextToolbar;\n        });\n      };\n      var keys$1 = keys(contextToolbars);\n      each(keys$1, function (key) {\n        var toolbarApi = contextToolbars[key];\n        if (toolbarApi.type === 'contextform') {\n          registerForm(key, toolbarApi);\n        } else if (toolbarApi.type === 'contexttoolbar') {\n          registerToolbar(key, toolbarApi);\n        }\n      });\n      return {\n        forms: forms,\n        inNodeScope: inNodeScope,\n        inEditorScope: inEditorScope,\n        lookupTable: lookupTable,\n        formNavigators: formNavigators\n      };\n    };\n\n    var forwardSlideEvent = generate$1('forward-slide');\n    var backSlideEvent = generate$1('backward-slide');\n    var changeSlideEvent = generate$1('change-slide-event');\n    var resizingClass = 'tox-pop--resizing';\n    var renderContextToolbar = function (spec) {\n      var stack = Cell([]);\n      return InlineView.sketch({\n        dom: {\n          tag: 'div',\n          classes: ['tox-pop']\n        },\n        fireDismissalEventInstead: { event: 'doNotDismissYet' },\n        onShow: function (comp) {\n          stack.set([]);\n          InlineView.getContent(comp).each(function (c) {\n            remove$6(c.element, 'visibility');\n          });\n          remove$4(comp.element, resizingClass);\n          remove$6(comp.element, 'width');\n        },\n        inlineBehaviours: derive$1([\n          config('context-toolbar-events', [\n            runOnSource(transitionend(), function (comp, _se) {\n              remove$4(comp.element, resizingClass);\n              remove$6(comp.element, 'width');\n            }),\n            run(changeSlideEvent, function (comp, se) {\n              var elem = comp.element;\n              remove$6(elem, 'width');\n              var currentWidth = get$8(elem);\n              InlineView.setContent(comp, se.event.contents);\n              add$2(elem, resizingClass);\n              var newWidth = get$8(elem);\n              set$2(elem, 'width', currentWidth + 'px');\n              InlineView.getContent(comp).each(function (newContents) {\n                se.event.focus.bind(function (f) {\n                  focus$1(f);\n                  return search(elem);\n                }).orThunk(function () {\n                  Keying.focusIn(newContents);\n                  return active(getRootNode(elem));\n                });\n              });\n              global$2.setTimeout(function () {\n                set$2(comp.element, 'width', newWidth + 'px');\n              }, 0);\n            }),\n            run(forwardSlideEvent, function (comp, se) {\n              InlineView.getContent(comp).each(function (oldContents) {\n                stack.set(stack.get().concat([{\n                    bar: oldContents,\n                    focus: active(getRootNode(comp.element))\n                  }]));\n              });\n              emitWith(comp, changeSlideEvent, {\n                contents: se.event.forwardContents,\n                focus: Optional.none()\n              });\n            }),\n            run(backSlideEvent, function (comp, _se) {\n              last(stack.get()).each(function (last) {\n                stack.set(stack.get().slice(0, stack.get().length - 1));\n                emitWith(comp, changeSlideEvent, {\n                  contents: premade$1(last.bar),\n                  focus: last.focus\n                });\n              });\n            })\n          ]),\n          Keying.config({\n            mode: 'special',\n            onEscape: function (comp) {\n              return last(stack.get()).fold(function () {\n                return spec.onEscape();\n              }, function (_) {\n                emit(comp, backSlideEvent);\n                return Optional.some(true);\n              });\n            }\n          })\n        ]),\n        lazySink: function () {\n          return Result.value(spec.sink);\n        }\n      });\n    };\n\n    var generateSelectItems = function (_editor, backstage, spec) {\n      var generateItem = function (rawItem, response, disabled, value) {\n        var translatedText = backstage.shared.providers.translate(rawItem.title);\n        if (rawItem.type === 'separator') {\n          return Optional.some({\n            type: 'separator',\n            text: translatedText\n          });\n        } else if (rawItem.type === 'submenu') {\n          var items = bind(rawItem.getStyleItems(), function (si) {\n            return validate(si, response, value);\n          });\n          if (response === 0 && items.length <= 0) {\n            return Optional.none();\n          } else {\n            return Optional.some({\n              type: 'nestedmenuitem',\n              text: translatedText,\n              disabled: items.length <= 0,\n              getSubmenuItems: function () {\n                return bind(rawItem.getStyleItems(), function (si) {\n                  return validate(si, response, value);\n                });\n              }\n            });\n          }\n        } else {\n          return Optional.some(__assign({\n            type: 'togglemenuitem',\n            text: translatedText,\n            icon: rawItem.icon,\n            active: rawItem.isSelected(value),\n            disabled: disabled,\n            onAction: spec.onAction(rawItem)\n          }, rawItem.getStylePreview().fold(function () {\n            return {};\n          }, function (preview) {\n            return { meta: { style: preview } };\n          })));\n        }\n      };\n      var validate = function (item, response, value) {\n        var invalid = item.type === 'formatter' && spec.isInvalid(item);\n        if (response === 0) {\n          return invalid ? [] : generateItem(item, response, false, value).toArray();\n        } else {\n          return generateItem(item, response, invalid, value).toArray();\n        }\n      };\n      var validateItems = function (preItems) {\n        var value = spec.getCurrentValue();\n        var response = spec.shouldHide ? 0 : 1;\n        return bind(preItems, function (item) {\n          return validate(item, response, value);\n        });\n      };\n      var getFetch = function (backstage, getStyleItems) {\n        return function (comp, callback) {\n          var preItems = getStyleItems();\n          var items = validateItems(preItems);\n          var menu = build$2(items, ItemResponse$1.CLOSE_ON_EXECUTE, backstage, false);\n          callback(menu);\n        };\n      };\n      return {\n        validateItems: validateItems,\n        getFetch: getFetch\n      };\n    };\n    var createMenuItems = function (editor, backstage, spec) {\n      var dataset = spec.dataset;\n      var getStyleItems = dataset.type === 'basic' ? function () {\n        return map(dataset.data, function (d) {\n          return processBasic(d, spec.isSelectedFor, spec.getPreviewFor);\n        });\n      } : dataset.getData;\n      return {\n        items: generateSelectItems(editor, backstage, spec),\n        getStyleItems: getStyleItems\n      };\n    };\n    var createSelectButton = function (editor, backstage, spec) {\n      var _a = createMenuItems(editor, backstage, spec), items = _a.items, getStyleItems = _a.getStyleItems;\n      var getApi = function (comp) {\n        return { getComponent: constant(comp) };\n      };\n      var onSetup = function (api) {\n        var updateText = function () {\n          var comp = api.getComponent();\n          if (comp.getSystem().isConnected()) {\n            spec.updateText(comp);\n          }\n        };\n        updateText();\n        editor.on('NodeChange', updateText);\n        return function () {\n          editor.off('NodeChange', updateText);\n        };\n      };\n      return renderCommonDropdown({\n        text: spec.icon.isSome() ? Optional.none() : Optional.some(''),\n        icon: spec.icon,\n        tooltip: Optional.from(spec.tooltip),\n        role: Optional.none(),\n        fetch: items.getFetch(backstage, getStyleItems),\n        onSetup: onSetup,\n        getApi: getApi,\n        columns: 1,\n        presets: 'normal',\n        classes: spec.icon.isSome() ? [] : ['bespoke'],\n        dropdownBehaviours: []\n      }, 'tox-tbtn', backstage.shared);\n    };\n\n    var process = function (rawFormats) {\n      return map(rawFormats, function (item) {\n        var title = item, format = item;\n        var values = item.split('=');\n        if (values.length > 1) {\n          title = values[0];\n          format = values[1];\n        }\n        return {\n          title: title,\n          format: format\n        };\n      });\n    };\n    var buildBasicStaticDataset = function (data) {\n      return {\n        type: 'basic',\n        data: data\n      };\n    };\n    var Delimiter;\n    (function (Delimiter) {\n      Delimiter[Delimiter['SemiColon'] = 0] = 'SemiColon';\n      Delimiter[Delimiter['Space'] = 1] = 'Space';\n    }(Delimiter || (Delimiter = {})));\n    var split = function (rawFormats, delimiter) {\n      if (delimiter === Delimiter.SemiColon) {\n        return rawFormats.replace(/;$/, '').split(';');\n      } else {\n        return rawFormats.split(' ');\n      }\n    };\n    var buildBasicSettingsDataset = function (editor, settingName, defaults, delimiter) {\n      var rawFormats = editor.getParam(settingName, defaults, 'string');\n      var data = process(split(rawFormats, delimiter));\n      return {\n        type: 'basic',\n        data: data\n      };\n    };\n\n    var alignMenuItems = [\n      {\n        title: 'Left',\n        icon: 'align-left',\n        format: 'alignleft',\n        command: 'JustifyLeft'\n      },\n      {\n        title: 'Center',\n        icon: 'align-center',\n        format: 'aligncenter',\n        command: 'JustifyCenter'\n      },\n      {\n        title: 'Right',\n        icon: 'align-right',\n        format: 'alignright',\n        command: 'JustifyRight'\n      },\n      {\n        title: 'Justify',\n        icon: 'align-justify',\n        format: 'alignjustify',\n        command: 'JustifyFull'\n      }\n    ];\n    var getSpec = function (editor) {\n      var getMatchingValue = function () {\n        return find(alignMenuItems, function (item) {\n          return editor.formatter.match(item.format);\n        });\n      };\n      var isSelectedFor = function (format) {\n        return function () {\n          return editor.formatter.match(format);\n        };\n      };\n      var getPreviewFor = function (_format) {\n        return function () {\n          return Optional.none();\n        };\n      };\n      var updateSelectMenuIcon = function (comp) {\n        var match = getMatchingValue();\n        var alignment = match.fold(function () {\n          return 'left';\n        }, function (item) {\n          return item.title.toLowerCase();\n        });\n        emitWith(comp, updateMenuIcon, { icon: 'align-' + alignment });\n      };\n      var dataset = buildBasicStaticDataset(alignMenuItems);\n      var onAction = function (rawItem) {\n        return function () {\n          return find(alignMenuItems, function (item) {\n            return item.format === rawItem.format;\n          }).each(function (item) {\n            return editor.execCommand(item.command);\n          });\n        };\n      };\n      return {\n        tooltip: 'Align',\n        icon: Optional.some('align-left'),\n        isSelectedFor: isSelectedFor,\n        getCurrentValue: Optional.none,\n        getPreviewFor: getPreviewFor,\n        onAction: onAction,\n        updateText: updateSelectMenuIcon,\n        dataset: dataset,\n        shouldHide: false,\n        isInvalid: function (item) {\n          return !editor.formatter.canApply(item.format);\n        }\n      };\n    };\n    var createAlignSelect = function (editor, backstage) {\n      return createSelectButton(editor, backstage, getSpec(editor));\n    };\n    var alignSelectMenu = function (editor, backstage) {\n      var menuItems = createMenuItems(editor, backstage, getSpec(editor));\n      editor.ui.registry.addNestedMenuItem('align', {\n        text: backstage.shared.providers.translate('Align'),\n        getSubmenuItems: function () {\n          return menuItems.items.validateItems(menuItems.getStyleItems());\n        }\n      });\n    };\n\n    var defaultFontsFormats = 'Andale Mono=andale mono,monospace;' + 'Arial=arial,helvetica,sans-serif;' + 'Arial Black=arial black,sans-serif;' + 'Book Antiqua=book antiqua,palatino,serif;' + 'Comic Sans MS=comic sans ms,sans-serif;' + 'Courier New=courier new,courier,monospace;' + 'Georgia=georgia,palatino,serif;' + 'Helvetica=helvetica,arial,sans-serif;' + 'Impact=impact,sans-serif;' + 'Symbol=symbol;' + 'Tahoma=tahoma,arial,helvetica,sans-serif;' + 'Terminal=terminal,monaco,monospace;' + 'Times New Roman=times new roman,times,serif;' + 'Trebuchet MS=trebuchet ms,geneva,sans-serif;' + 'Verdana=verdana,geneva,sans-serif;' + 'Webdings=webdings;' + 'Wingdings=wingdings,zapf dingbats';\n    var systemStackFonts = [\n      '-apple-system',\n      'Segoe UI',\n      'Roboto',\n      'Helvetica Neue',\n      'sans-serif'\n    ];\n    var splitFonts = function (fontFamily) {\n      var fonts = fontFamily.split(/\\s*,\\s*/);\n      return map(fonts, function (font) {\n        return font.replace(/^['\"]+|['\"]+$/g, '');\n      });\n    };\n    var isSystemFontStack = function (fontFamily) {\n      var matchesSystemStack = function () {\n        var fonts = splitFonts(fontFamily.toLowerCase());\n        return forall(systemStackFonts, function (font) {\n          return fonts.indexOf(font.toLowerCase()) > -1;\n        });\n      };\n      return fontFamily.indexOf('-apple-system') === 0 && matchesSystemStack();\n    };\n    var getSpec$1 = function (editor) {\n      var getMatchingValue = function () {\n        var getFirstFont = function (fontFamily) {\n          return fontFamily ? splitFonts(fontFamily)[0] : '';\n        };\n        var fontFamily = editor.queryCommandValue('FontName');\n        var items = dataset.data;\n        var font = fontFamily ? fontFamily.toLowerCase() : '';\n        var matchOpt = find(items, function (item) {\n          var format = item.format;\n          return format.toLowerCase() === font || getFirstFont(format).toLowerCase() === getFirstFont(font).toLowerCase();\n        }).orThunk(function () {\n          if (isSystemFontStack(font)) {\n            return Optional.from({\n              title: 'System Font',\n              format: font\n            });\n          } else {\n            return Optional.none();\n          }\n        });\n        return {\n          matchOpt: matchOpt,\n          font: fontFamily\n        };\n      };\n      var isSelectedFor = function (item) {\n        return function (valueOpt) {\n          return valueOpt.exists(function (value) {\n            return value.format === item;\n          });\n        };\n      };\n      var getCurrentValue = function () {\n        var matchOpt = getMatchingValue().matchOpt;\n        return matchOpt;\n      };\n      var getPreviewFor = function (item) {\n        return function () {\n          return Optional.some({\n            tag: 'div',\n            styles: item.indexOf('dings') === -1 ? { 'font-family': item } : {}\n          });\n        };\n      };\n      var onAction = function (rawItem) {\n        return function () {\n          editor.undoManager.transact(function () {\n            editor.focus();\n            editor.execCommand('FontName', false, rawItem.format);\n          });\n        };\n      };\n      var updateSelectMenuText = function (comp) {\n        var _a = getMatchingValue(), matchOpt = _a.matchOpt, font = _a.font;\n        var text = matchOpt.fold(function () {\n          return font;\n        }, function (item) {\n          return item.title;\n        });\n        emitWith(comp, updateMenuText, { text: text });\n      };\n      var dataset = buildBasicSettingsDataset(editor, 'font_formats', defaultFontsFormats, Delimiter.SemiColon);\n      return {\n        tooltip: 'Fonts',\n        icon: Optional.none(),\n        isSelectedFor: isSelectedFor,\n        getCurrentValue: getCurrentValue,\n        getPreviewFor: getPreviewFor,\n        onAction: onAction,\n        updateText: updateSelectMenuText,\n        dataset: dataset,\n        shouldHide: false,\n        isInvalid: never\n      };\n    };\n    var createFontSelect = function (editor, backstage) {\n      return createSelectButton(editor, backstage, getSpec$1(editor));\n    };\n    var fontSelectMenu = function (editor, backstage) {\n      var menuItems = createMenuItems(editor, backstage, getSpec$1(editor));\n      editor.ui.registry.addNestedMenuItem('fontformats', {\n        text: backstage.shared.providers.translate('Fonts'),\n        getSubmenuItems: function () {\n          return menuItems.items.validateItems(menuItems.getStyleItems());\n        }\n      });\n    };\n\n    var defaultFontsizeFormats = '8pt 10pt 12pt 14pt 18pt 24pt 36pt';\n    var legacyFontSizes = {\n      '8pt': '1',\n      '10pt': '2',\n      '12pt': '3',\n      '14pt': '4',\n      '18pt': '5',\n      '24pt': '6',\n      '36pt': '7'\n    };\n    var keywordFontSizes = {\n      'xx-small': '7pt',\n      'x-small': '8pt',\n      'small': '10pt',\n      'medium': '12pt',\n      'large': '14pt',\n      'x-large': '18pt',\n      'xx-large': '24pt'\n    };\n    var round$1 = function (number, precision) {\n      var factor = Math.pow(10, precision);\n      return Math.round(number * factor) / factor;\n    };\n    var toPt = function (fontSize, precision) {\n      if (/[0-9.]+px$/.test(fontSize)) {\n        return round$1(parseInt(fontSize, 10) * 72 / 96, precision || 0) + 'pt';\n      } else {\n        return get$1(keywordFontSizes, fontSize).getOr(fontSize);\n      }\n    };\n    var toLegacy = function (fontSize) {\n      return get$1(legacyFontSizes, fontSize).getOr('');\n    };\n    var getSpec$2 = function (editor) {\n      var getMatchingValue = function () {\n        var matchOpt = Optional.none();\n        var items = dataset.data;\n        var fontSize = editor.queryCommandValue('FontSize');\n        if (fontSize) {\n          var _loop_1 = function (precision) {\n            var pt = toPt(fontSize, precision);\n            var legacy = toLegacy(pt);\n            matchOpt = find(items, function (item) {\n              return item.format === fontSize || item.format === pt || item.format === legacy;\n            });\n          };\n          for (var precision = 3; matchOpt.isNone() && precision >= 0; precision--) {\n            _loop_1(precision);\n          }\n        }\n        return {\n          matchOpt: matchOpt,\n          size: fontSize\n        };\n      };\n      var isSelectedFor = function (item) {\n        return function (valueOpt) {\n          return valueOpt.exists(function (value) {\n            return value.format === item;\n          });\n        };\n      };\n      var getCurrentValue = function () {\n        var matchOpt = getMatchingValue().matchOpt;\n        return matchOpt;\n      };\n      var getPreviewFor = constant(Optional.none);\n      var onAction = function (rawItem) {\n        return function () {\n          editor.undoManager.transact(function () {\n            editor.focus();\n            editor.execCommand('FontSize', false, rawItem.format);\n          });\n        };\n      };\n      var updateSelectMenuText = function (comp) {\n        var _a = getMatchingValue(), matchOpt = _a.matchOpt, size = _a.size;\n        var text = matchOpt.fold(function () {\n          return size;\n        }, function (match) {\n          return match.title;\n        });\n        emitWith(comp, updateMenuText, { text: text });\n      };\n      var dataset = buildBasicSettingsDataset(editor, 'fontsize_formats', defaultFontsizeFormats, Delimiter.Space);\n      return {\n        tooltip: 'Font sizes',\n        icon: Optional.none(),\n        isSelectedFor: isSelectedFor,\n        getPreviewFor: getPreviewFor,\n        getCurrentValue: getCurrentValue,\n        onAction: onAction,\n        updateText: updateSelectMenuText,\n        dataset: dataset,\n        shouldHide: false,\n        isInvalid: never\n      };\n    };\n    var createFontsizeSelect = function (editor, backstage) {\n      return createSelectButton(editor, backstage, getSpec$2(editor));\n    };\n    var fontsizeSelectMenu = function (editor, backstage) {\n      var menuItems = createMenuItems(editor, backstage, getSpec$2(editor));\n      editor.ui.registry.addNestedMenuItem('fontsizes', {\n        text: 'Font sizes',\n        getSubmenuItems: function () {\n          return menuItems.items.validateItems(menuItems.getStyleItems());\n        }\n      });\n    };\n\n    var findNearest = function (editor, getStyles) {\n      var styles = getStyles();\n      var formats = map(styles, function (style) {\n        return style.format;\n      });\n      return Optional.from(editor.formatter.closest(formats)).bind(function (fmt) {\n        return find(styles, function (data) {\n          return data.format === fmt;\n        });\n      }).orThunk(function () {\n        return someIf(editor.formatter.match('p'), {\n          title: 'Paragraph',\n          format: 'p'\n        });\n      });\n    };\n\n    var revocable = function (doRevoke) {\n      var subject = Cell(Optional.none());\n      var revoke = function () {\n        return subject.get().each(doRevoke);\n      };\n      var clear = function () {\n        revoke();\n        subject.set(Optional.none());\n      };\n      var isSet = function () {\n        return subject.get().isSome();\n      };\n      var set = function (s) {\n        revoke();\n        subject.set(Optional.some(s));\n      };\n      return {\n        clear: clear,\n        isSet: isSet,\n        set: set\n      };\n    };\n    var destroyable = function () {\n      return revocable(function (s) {\n        return s.destroy();\n      });\n    };\n    var unbindable = function () {\n      return revocable(function (s) {\n        return s.unbind();\n      });\n    };\n    var value$3 = function () {\n      var subject = Cell(Optional.none());\n      var clear = function () {\n        return subject.set(Optional.none());\n      };\n      var set = function (s) {\n        return subject.set(Optional.some(s));\n      };\n      var isSet = function () {\n        return subject.get().isSome();\n      };\n      var on = function (f) {\n        return subject.get().each(f);\n      };\n      return {\n        clear: clear,\n        set: set,\n        isSet: isSet,\n        on: on\n      };\n    };\n\n    var onSetupFormatToggle = function (editor, name) {\n      return function (api) {\n        var boundCallback = unbindable();\n        var init = function () {\n          api.setActive(editor.formatter.match(name));\n          var binding = editor.formatter.formatChanged(name, api.setActive);\n          boundCallback.set(binding);\n        };\n        editor.initialized ? init() : editor.on('init', init);\n        return boundCallback.clear;\n      };\n    };\n    var onActionToggleFormat = function (editor) {\n      return function (rawItem) {\n        return function () {\n          editor.undoManager.transact(function () {\n            editor.focus();\n            editor.execCommand('mceToggleFormat', false, rawItem.format);\n          });\n        };\n      };\n    };\n\n    var defaultBlocks = 'Paragraph=p;' + 'Heading 1=h1;' + 'Heading 2=h2;' + 'Heading 3=h3;' + 'Heading 4=h4;' + 'Heading 5=h5;' + 'Heading 6=h6;' + 'Preformatted=pre';\n    var getSpec$3 = function (editor) {\n      var isSelectedFor = function (format) {\n        return function () {\n          return editor.formatter.match(format);\n        };\n      };\n      var getPreviewFor = function (format) {\n        return function () {\n          var fmt = editor.formatter.get(format);\n          return Optional.some({\n            tag: fmt.length > 0 ? fmt[0].inline || fmt[0].block || 'div' : 'div',\n            styles: editor.dom.parseStyle(editor.formatter.getCssText(format))\n          });\n        };\n      };\n      var updateSelectMenuText = function (comp) {\n        var detectedFormat = findNearest(editor, function () {\n          return dataset.data;\n        });\n        var text = detectedFormat.fold(function () {\n          return 'Paragraph';\n        }, function (fmt) {\n          return fmt.title;\n        });\n        emitWith(comp, updateMenuText, { text: text });\n      };\n      var dataset = buildBasicSettingsDataset(editor, 'block_formats', defaultBlocks, Delimiter.SemiColon);\n      return {\n        tooltip: 'Blocks',\n        icon: Optional.none(),\n        isSelectedFor: isSelectedFor,\n        getCurrentValue: Optional.none,\n        getPreviewFor: getPreviewFor,\n        onAction: onActionToggleFormat(editor),\n        updateText: updateSelectMenuText,\n        dataset: dataset,\n        shouldHide: false,\n        isInvalid: function (item) {\n          return !editor.formatter.canApply(item.format);\n        }\n      };\n    };\n    var createFormatSelect = function (editor, backstage) {\n      return createSelectButton(editor, backstage, getSpec$3(editor));\n    };\n    var formatSelectMenu = function (editor, backstage) {\n      var menuItems = createMenuItems(editor, backstage, getSpec$3(editor));\n      editor.ui.registry.addNestedMenuItem('blockformats', {\n        text: 'Blocks',\n        getSubmenuItems: function () {\n          return menuItems.items.validateItems(menuItems.getStyleItems());\n        }\n      });\n    };\n\n    var getSpec$4 = function (editor, dataset) {\n      var isSelectedFor = function (format) {\n        return function () {\n          return editor.formatter.match(format);\n        };\n      };\n      var getPreviewFor = function (format) {\n        return function () {\n          var fmt = editor.formatter.get(format);\n          return fmt !== undefined ? Optional.some({\n            tag: fmt.length > 0 ? fmt[0].inline || fmt[0].block || 'div' : 'div',\n            styles: editor.dom.parseStyle(editor.formatter.getCssText(format))\n          }) : Optional.none();\n        };\n      };\n      var updateSelectMenuText = function (comp) {\n        var getFormatItems = function (fmt) {\n          var subs = fmt.items;\n          return subs !== undefined && subs.length > 0 ? bind(subs, getFormatItems) : [{\n              title: fmt.title,\n              format: fmt.format\n            }];\n        };\n        var flattenedItems = bind(getStyleFormats(editor), getFormatItems);\n        var detectedFormat = findNearest(editor, function () {\n          return flattenedItems;\n        });\n        var text = detectedFormat.fold(function () {\n          return 'Paragraph';\n        }, function (fmt) {\n          return fmt.title;\n        });\n        emitWith(comp, updateMenuText, { text: text });\n      };\n      return {\n        tooltip: 'Formats',\n        icon: Optional.none(),\n        isSelectedFor: isSelectedFor,\n        getCurrentValue: Optional.none,\n        getPreviewFor: getPreviewFor,\n        onAction: onActionToggleFormat(editor),\n        updateText: updateSelectMenuText,\n        shouldHide: editor.getParam('style_formats_autohide', false, 'boolean'),\n        isInvalid: function (item) {\n          return !editor.formatter.canApply(item.format);\n        },\n        dataset: dataset\n      };\n    };\n    var createStyleSelect = function (editor, backstage) {\n      var dataset = __assign({ type: 'advanced' }, backstage.styleselect);\n      return createSelectButton(editor, backstage, getSpec$4(editor, dataset));\n    };\n    var styleSelectMenu = function (editor, backstage) {\n      var dataset = __assign({ type: 'advanced' }, backstage.styleselect);\n      var menuItems = createMenuItems(editor, backstage, getSpec$4(editor, dataset));\n      editor.ui.registry.addNestedMenuItem('formats', {\n        text: 'Formats',\n        getSubmenuItems: function () {\n          return menuItems.items.validateItems(menuItems.getStyleItems());\n        }\n      });\n    };\n\n    var defaultToolbar = [\n      {\n        name: 'history',\n        items: [\n          'undo',\n          'redo'\n        ]\n      },\n      {\n        name: 'styles',\n        items: ['styleselect']\n      },\n      {\n        name: 'formatting',\n        items: [\n          'bold',\n          'italic'\n        ]\n      },\n      {\n        name: 'alignment',\n        items: [\n          'alignleft',\n          'aligncenter',\n          'alignright',\n          'alignjustify'\n        ]\n      },\n      {\n        name: 'indentation',\n        items: [\n          'outdent',\n          'indent'\n        ]\n      },\n      {\n        name: 'permanent pen',\n        items: ['permanentpen']\n      },\n      {\n        name: 'comments',\n        items: ['addcomment']\n      }\n    ];\n    var renderFromBridge = function (bridgeBuilder, render) {\n      return function (spec, extras, editor) {\n        var internal = bridgeBuilder(spec).mapError(function (errInfo) {\n          return formatError(errInfo);\n        }).getOrDie();\n        return render(internal, extras, editor);\n      };\n    };\n    var types = {\n      button: renderFromBridge(createToolbarButton, function (s, extras) {\n        return renderToolbarButton(s, extras.backstage.shared.providers);\n      }),\n      togglebutton: renderFromBridge(createToggleButton, function (s, extras) {\n        return renderToolbarToggleButton(s, extras.backstage.shared.providers);\n      }),\n      menubutton: renderFromBridge(createMenuButton, function (s, extras) {\n        return renderMenuButton(s, 'tox-tbtn', extras.backstage, Optional.none());\n      }),\n      splitbutton: renderFromBridge(createSplitButton, function (s, extras) {\n        return renderSplitButton(s, extras.backstage.shared);\n      }),\n      grouptoolbarbutton: renderFromBridge(createGroupToolbarButton, function (s, extras, editor) {\n        var _a;\n        var buttons = editor.ui.registry.getAll().buttons;\n        var identify = function (toolbar) {\n          return identifyButtons(editor, {\n            buttons: buttons,\n            toolbar: toolbar,\n            allowToolbarGroups: false\n          }, extras, Optional.none());\n        };\n        var attributes = (_a = {}, _a[Attribute] = extras.backstage.shared.header.isPositionedAtTop() ? AttributeValue.TopToBottom : AttributeValue.BottomToTop, _a);\n        switch (getToolbarMode(editor)) {\n        case ToolbarMode.floating:\n          return renderFloatingToolbarButton(s, extras.backstage, identify, attributes);\n        default:\n          throw new Error('Toolbar groups are only supported when using floating toolbar mode');\n        }\n      }),\n      styleSelectButton: function (editor, extras) {\n        return createStyleSelect(editor, extras.backstage);\n      },\n      fontsizeSelectButton: function (editor, extras) {\n        return createFontsizeSelect(editor, extras.backstage);\n      },\n      fontSelectButton: function (editor, extras) {\n        return createFontSelect(editor, extras.backstage);\n      },\n      formatButton: function (editor, extras) {\n        return createFormatSelect(editor, extras.backstage);\n      },\n      alignMenuButton: function (editor, extras) {\n        return createAlignSelect(editor, extras.backstage);\n      }\n    };\n    var extractFrom = function (spec, extras, editor) {\n      return get$1(types, spec.type).fold(function () {\n        console.error('skipping button defined by', spec);\n        return Optional.none();\n      }, function (render) {\n        return Optional.some(render(spec, extras, editor));\n      });\n    };\n    var bespokeButtons = {\n      styleselect: types.styleSelectButton,\n      fontsizeselect: types.fontsizeSelectButton,\n      fontselect: types.fontSelectButton,\n      formatselect: types.formatButton,\n      align: types.alignMenuButton\n    };\n    var removeUnusedDefaults = function (buttons) {\n      var filteredItemGroups = map(defaultToolbar, function (group) {\n        var items = filter(group.items, function (subItem) {\n          return has(buttons, subItem) || has(bespokeButtons, subItem);\n        });\n        return {\n          name: group.name,\n          items: items\n        };\n      });\n      return filter(filteredItemGroups, function (group) {\n        return group.items.length > 0;\n      });\n    };\n    var convertStringToolbar = function (strToolbar) {\n      var groupsStrings = strToolbar.split('|');\n      return map(groupsStrings, function (g) {\n        return { items: g.trim().split(' ') };\n      });\n    };\n    var isToolbarGroupSettingArray = function (toolbar) {\n      return isArrayOf(toolbar, function (t) {\n        return has(t, 'name') && has(t, 'items');\n      });\n    };\n    var createToolbar = function (toolbarConfig) {\n      var toolbar = toolbarConfig.toolbar;\n      var buttons = toolbarConfig.buttons;\n      if (toolbar === false) {\n        return [];\n      } else if (toolbar === undefined || toolbar === true) {\n        return removeUnusedDefaults(buttons);\n      } else if (isString(toolbar)) {\n        return convertStringToolbar(toolbar);\n      } else if (isToolbarGroupSettingArray(toolbar)) {\n        return toolbar;\n      } else {\n        console.error('Toolbar type should be string, string[], boolean or ToolbarGroup[]');\n        return [];\n      }\n    };\n    var lookupButton = function (editor, buttons, toolbarItem, allowToolbarGroups, extras, prefixes) {\n      return get$1(buttons, toolbarItem.toLowerCase()).orThunk(function () {\n        return prefixes.bind(function (ps) {\n          return findMap(ps, function (prefix) {\n            return get$1(buttons, prefix + toolbarItem.toLowerCase());\n          });\n        });\n      }).fold(function () {\n        return get$1(bespokeButtons, toolbarItem.toLowerCase()).map(function (r) {\n          return r(editor, extras);\n        }).orThunk(function () {\n          return Optional.none();\n        });\n      }, function (spec) {\n        if (spec.type === 'grouptoolbarbutton' && !allowToolbarGroups) {\n          console.warn('Ignoring the \\'' + toolbarItem + '\\' toolbar button. Group toolbar buttons are only supported when using floating toolbar mode and cannot be nested.');\n          return Optional.none();\n        } else {\n          return extractFrom(spec, extras, editor);\n        }\n      });\n    };\n    var identifyButtons = function (editor, toolbarConfig, extras, prefixes) {\n      var toolbarGroups = createToolbar(toolbarConfig);\n      var groups = map(toolbarGroups, function (group) {\n        var items = bind(group.items, function (toolbarItem) {\n          return toolbarItem.trim().length === 0 ? [] : lookupButton(editor, toolbarConfig.buttons, toolbarItem, toolbarConfig.allowToolbarGroups, extras, prefixes).toArray();\n        });\n        return {\n          title: Optional.from(editor.translate(group.name)),\n          items: items\n        };\n      });\n      return filter(groups, function (group) {\n        return group.items.length > 0;\n      });\n    };\n\n    var bubbleSize = 12;\n    var bubbleAlignments$1 = {\n      valignCentre: [],\n      alignCentre: [],\n      alignLeft: ['tox-pop--align-left'],\n      alignRight: ['tox-pop--align-right'],\n      right: ['tox-pop--right'],\n      left: ['tox-pop--left'],\n      bottom: ['tox-pop--bottom'],\n      top: ['tox-pop--top']\n    };\n    var anchorOverrides = {\n      maxHeightFunction: expandable(),\n      maxWidthFunction: expandable$1()\n    };\n    var desktopAnchorSpecLayouts = {\n      onLtr: function () {\n        return [\n          north$1,\n          south$1,\n          northeast$1,\n          southeast$1,\n          northwest$1,\n          southwest$1,\n          north$3,\n          south$3,\n          northeast$3,\n          southeast$3,\n          northwest$3,\n          southwest$3\n        ];\n      },\n      onRtl: function () {\n        return [\n          north$1,\n          south$1,\n          northwest$1,\n          southwest$1,\n          northeast$1,\n          southeast$1,\n          north$3,\n          south$3,\n          northwest$3,\n          southwest$3,\n          northeast$3,\n          southeast$3\n        ];\n      }\n    };\n    var mobileAnchorSpecLayouts = {\n      onLtr: function () {\n        return [\n          south$1,\n          southeast$1,\n          southwest$1,\n          northeast$1,\n          northwest$1,\n          north$1,\n          north$3,\n          south$3,\n          northeast$3,\n          southeast$3,\n          northwest$3,\n          southwest$3\n        ];\n      },\n      onRtl: function () {\n        return [\n          south$1,\n          southwest$1,\n          southeast$1,\n          northwest$1,\n          northeast$1,\n          north$1,\n          north$3,\n          south$3,\n          northwest$3,\n          southwest$3,\n          northeast$3,\n          southeast$3\n        ];\n      }\n    };\n    var getAnchorLayout = function (position, isTouch) {\n      if (position === 'line') {\n        return {\n          bubble: nu$8(bubbleSize, 0, bubbleAlignments$1),\n          layouts: {\n            onLtr: function () {\n              return [east$1];\n            },\n            onRtl: function () {\n              return [west$1];\n            }\n          },\n          overrides: anchorOverrides\n        };\n      } else {\n        return {\n          bubble: nu$8(0, bubbleSize, bubbleAlignments$1),\n          layouts: isTouch ? mobileAnchorSpecLayouts : desktopAnchorSpecLayouts,\n          overrides: anchorOverrides\n        };\n      }\n    };\n    var register$4 = function (editor, registryContextToolbars, sink, extras) {\n      var isTouch = detect$3().deviceType.isTouch;\n      var contextbar = build$1(renderContextToolbar({\n        sink: sink,\n        onEscape: function () {\n          editor.focus();\n          return Optional.some(true);\n        }\n      }));\n      var getBounds = function () {\n        return getContextToolbarBounds(editor, extras.backstage.shared);\n      };\n      var isRangeOverlapping = function (aTop, aBottom, bTop, bBottom) {\n        return Math.max(aTop, bTop) <= Math.min(aBottom, bBottom);\n      };\n      var getLastElementVerticalBound = function () {\n        var nodeBounds = lastElement.get().filter(function (ele) {\n          return inBody(SugarElement.fromDom(ele));\n        }).map(function (ele) {\n          return ele.getBoundingClientRect();\n        }).getOrThunk(function () {\n          return editor.selection.getRng().getBoundingClientRect();\n        });\n        var diffTop = editor.inline ? get$9().top : absolute$1(SugarElement.fromDom(editor.getBody())).y;\n        return {\n          y: nodeBounds.top + diffTop,\n          bottom: nodeBounds.bottom + diffTop\n        };\n      };\n      var shouldContextToolbarHide = function () {\n        if (isTouch() && extras.backstage.isContextMenuOpen()) {\n          return true;\n        }\n        var lastElementBounds = getLastElementVerticalBound();\n        var contextToolbarBounds = getBounds();\n        return !isRangeOverlapping(lastElementBounds.y, lastElementBounds.bottom, contextToolbarBounds.y, contextToolbarBounds.bottom);\n      };\n      var close = function () {\n        lastAnchor.set(Optional.none());\n        InlineView.hide(contextbar);\n      };\n      var forceHide = function () {\n        InlineView.hide(contextbar);\n      };\n      var hideOrRepositionIfNecessary = function () {\n        lastAnchor.get().each(function (anchor) {\n          var contextBarEle = contextbar.element;\n          remove$6(contextBarEle, 'display');\n          if (shouldContextToolbarHide()) {\n            set$2(contextBarEle, 'display', 'none');\n          } else {\n            Positioning.positionWithinBounds(sink, anchor, contextbar, Optional.some(getBounds()));\n          }\n        });\n      };\n      var lastAnchor = Cell(Optional.none());\n      var lastElement = Cell(Optional.none());\n      var timer = Cell(null);\n      var wrapInPopDialog = function (toolbarSpec) {\n        return {\n          dom: {\n            tag: 'div',\n            classes: ['tox-pop__dialog']\n          },\n          components: [toolbarSpec],\n          behaviours: derive$1([\n            Keying.config({ mode: 'acyclic' }),\n            config('pop-dialog-wrap-events', [\n              runOnAttached(function (comp) {\n                editor.shortcuts.add('ctrl+F9', 'focus statusbar', function () {\n                  return Keying.focusIn(comp);\n                });\n              }),\n              runOnDetached(function (_comp) {\n                editor.shortcuts.remove('ctrl+F9');\n              })\n            ])\n          ])\n        };\n      };\n      var getScopes = cached(function () {\n        return categorise(registryContextToolbars, function (toolbarApi) {\n          var alloySpec = buildToolbar([toolbarApi]);\n          emitWith(contextbar, forwardSlideEvent, { forwardContents: wrapInPopDialog(alloySpec) });\n        });\n      });\n      var buildContextToolbarGroups = function (allButtons, ctx) {\n        return identifyButtons(editor, {\n          buttons: allButtons,\n          toolbar: ctx.items,\n          allowToolbarGroups: false\n        }, extras, Optional.some(['form:']));\n      };\n      var buildContextMenuGroups = function (ctx, providers) {\n        return ContextForm.buildInitGroups(ctx, providers);\n      };\n      var buildToolbar = function (toolbars) {\n        var buttons = editor.ui.registry.getAll().buttons;\n        var scopes = getScopes();\n        var allButtons = __assign(__assign({}, buttons), scopes.formNavigators);\n        var toolbarType = getToolbarMode(editor) === ToolbarMode.scrolling ? ToolbarMode.scrolling : ToolbarMode.default;\n        var initGroups = flatten(map(toolbars, function (ctx) {\n          return ctx.type === 'contexttoolbar' ? buildContextToolbarGroups(allButtons, ctx) : buildContextMenuGroups(ctx, extras.backstage.shared.providers);\n        }));\n        return renderToolbar({\n          type: toolbarType,\n          uid: generate$1('context-toolbar'),\n          initGroups: initGroups,\n          onEscape: Optional.none,\n          cyclicKeying: true,\n          providers: extras.backstage.shared.providers\n        });\n      };\n      editor.on(showContextToolbarEvent, function (e) {\n        var scopes = getScopes();\n        get$1(scopes.lookupTable, e.toolbarKey).each(function (ctx) {\n          launchContext([ctx], e.target === editor ? Optional.none() : Optional.some(e));\n          InlineView.getContent(contextbar).each(Keying.focusIn);\n        });\n      });\n      var getAnchor = function (position, element) {\n        var anchorage = position === 'node' ? extras.backstage.shared.anchors.node(element) : extras.backstage.shared.anchors.cursor();\n        return deepMerge(anchorage, getAnchorLayout(position, isTouch()));\n      };\n      var launchContext = function (toolbarApi, elem) {\n        clearTimer();\n        if (isTouch() && extras.backstage.isContextMenuOpen()) {\n          return;\n        }\n        var toolbarSpec = buildToolbar(toolbarApi);\n        var sElem = elem.map(SugarElement.fromDom);\n        var anchor = getAnchor(toolbarApi[0].position, sElem);\n        lastAnchor.set(Optional.some(anchor));\n        lastElement.set(elem);\n        var contextBarEle = contextbar.element;\n        remove$6(contextBarEle, 'display');\n        InlineView.showWithinBounds(contextbar, anchor, wrapInPopDialog(toolbarSpec), function () {\n          return Optional.some(getBounds());\n        });\n        if (shouldContextToolbarHide()) {\n          set$2(contextBarEle, 'display', 'none');\n        }\n      };\n      var launchContextToolbar = function () {\n        if (!editor.hasFocus()) {\n          return;\n        }\n        var scopes = getScopes();\n        lookup$1(scopes, editor).fold(close, function (info) {\n          launchContext(info.toolbars, Optional.some(info.elem.dom));\n        });\n      };\n      var clearTimer = function () {\n        var current = timer.get();\n        if (current !== null) {\n          global$2.clearTimeout(current);\n          timer.set(null);\n        }\n      };\n      var asyncOpen = function () {\n        clearTimer();\n        timer.set(global$2.setEditorTimeout(editor, launchContextToolbar, 0));\n      };\n      editor.on('init', function () {\n        editor.on(hideContextToolbarEvent, forceHide);\n        editor.on('ScrollContent ScrollWindow longpress', hideOrRepositionIfNecessary);\n        editor.on('click keyup focus SetContent ObjectResized ResizeEditor', function () {\n          asyncOpen();\n        });\n        editor.on('focusout', function (_e) {\n          global$2.setEditorTimeout(editor, function () {\n            if (search(sink.element).isNone() && search(contextbar.element).isNone()) {\n              close();\n            }\n          }, 0);\n        });\n        editor.on('SwitchMode', function () {\n          if (editor.mode.isReadOnly()) {\n            close();\n          }\n        });\n        editor.on('AfterProgressState', function (event) {\n          if (event.state) {\n            close();\n          } else if (editor.hasFocus()) {\n            asyncOpen();\n          }\n        });\n        editor.on('NodeChange', function (_e) {\n          search(contextbar.element).fold(asyncOpen, noop);\n        });\n      });\n    };\n\n    var setup$3 = function (editor, mothership, uiMothership) {\n      var broadcastEvent = function (name, evt) {\n        each([\n          mothership,\n          uiMothership\n        ], function (ship) {\n          ship.broadcastEvent(name, evt);\n        });\n      };\n      var broadcastOn = function (channel, message) {\n        each([\n          mothership,\n          uiMothership\n        ], function (ship) {\n          ship.broadcastOn([channel], message);\n        });\n      };\n      var fireDismissPopups = function (evt) {\n        return broadcastOn(dismissPopups(), { target: evt.target });\n      };\n      var onTouchstart = bind$3(SugarElement.fromDom(document), 'touchstart', fireDismissPopups);\n      var onTouchmove = bind$3(SugarElement.fromDom(document), 'touchmove', function (evt) {\n        return broadcastEvent(documentTouchmove(), evt);\n      });\n      var onTouchend = bind$3(SugarElement.fromDom(document), 'touchend', function (evt) {\n        return broadcastEvent(documentTouchend(), evt);\n      });\n      var onMousedown = bind$3(SugarElement.fromDom(document), 'mousedown', fireDismissPopups);\n      var onMouseup = bind$3(SugarElement.fromDom(document), 'mouseup', function (evt) {\n        if (evt.raw.button === 0) {\n          broadcastOn(mouseReleased(), { target: evt.target });\n        }\n      });\n      var onContentClick = function (raw) {\n        return broadcastOn(dismissPopups(), { target: SugarElement.fromDom(raw.target) });\n      };\n      var onContentMouseup = function (raw) {\n        if (raw.button === 0) {\n          broadcastOn(mouseReleased(), { target: SugarElement.fromDom(raw.target) });\n        }\n      };\n      var onWindowScroll = function (evt) {\n        return broadcastEvent(windowScroll(), fromRawEvent$1(evt));\n      };\n      var onWindowResize = function (evt) {\n        broadcastOn(repositionPopups(), {});\n        broadcastEvent(windowResize(), fromRawEvent$1(evt));\n      };\n      var onEditorResize = function () {\n        return broadcastOn(repositionPopups(), {});\n      };\n      var onEditorProgress = function (evt) {\n        if (evt.state) {\n          broadcastOn(dismissPopups(), { target: SugarElement.fromDom(editor.getContainer()) });\n        }\n      };\n      editor.on('PostRender', function () {\n        editor.on('click', onContentClick);\n        editor.on('tap', onContentClick);\n        editor.on('mouseup', onContentMouseup);\n        editor.on('ScrollWindow', onWindowScroll);\n        editor.on('ResizeWindow', onWindowResize);\n        editor.on('ResizeEditor', onEditorResize);\n        editor.on('AfterProgressState', onEditorProgress);\n      });\n      editor.on('remove', function () {\n        editor.off('click', onContentClick);\n        editor.off('tap', onContentClick);\n        editor.off('mouseup', onContentMouseup);\n        editor.off('ScrollWindow', onWindowScroll);\n        editor.off('ResizeWindow', onWindowResize);\n        editor.off('ResizeEditor', onEditorResize);\n        editor.off('AfterProgressState', onEditorProgress);\n        onMousedown.unbind();\n        onTouchstart.unbind();\n        onTouchmove.unbind();\n        onTouchend.unbind();\n        onMouseup.unbind();\n      });\n      editor.on('detach', function () {\n        detachSystem(mothership);\n        detachSystem(uiMothership);\n        mothership.destroy();\n        uiMothership.destroy();\n      });\n    };\n\n    var parts$d = AlloyParts;\n    var partType$1 = PartType;\n\n    var schema$r = constant([\n      defaulted$1('shell', false),\n      strict$1('makeItem'),\n      defaulted$1('setupItem', noop),\n      SketchBehaviours.field('listBehaviours', [Replacing])\n    ]);\n    var customListDetail = function () {\n      return { behaviours: derive$1([Replacing.config({})]) };\n    };\n    var itemsPart = optional({\n      name: 'items',\n      overrides: customListDetail\n    });\n    var parts$e = constant([itemsPart]);\n    var name$2 = constant('CustomList');\n\n    var factory$f = function (detail, components, _spec, _external) {\n      var setItems = function (list, items) {\n        getListContainer(list).fold(function () {\n          console.error('Custom List was defined to not be a shell, but no item container was specified in components');\n          throw new Error('Custom List was defined to not be a shell, but no item container was specified in components');\n        }, function (container) {\n          var itemComps = Replacing.contents(container);\n          var numListsRequired = items.length;\n          var numListsToAdd = numListsRequired - itemComps.length;\n          var itemsToAdd = numListsToAdd > 0 ? range(numListsToAdd, function () {\n            return detail.makeItem();\n          }) : [];\n          var itemsToRemove = itemComps.slice(numListsRequired);\n          each(itemsToRemove, function (item) {\n            return Replacing.remove(container, item);\n          });\n          each(itemsToAdd, function (item) {\n            return Replacing.append(container, item);\n          });\n          var builtLists = Replacing.contents(container);\n          each(builtLists, function (item, i) {\n            detail.setupItem(list, item, items[i], i);\n          });\n        });\n      };\n      var extra = detail.shell ? {\n        behaviours: [Replacing.config({})],\n        components: []\n      } : {\n        behaviours: [],\n        components: components\n      };\n      var getListContainer = function (component) {\n        return detail.shell ? Optional.some(component) : getPart(component, detail, 'items');\n      };\n      return {\n        uid: detail.uid,\n        dom: detail.dom,\n        components: extra.components,\n        behaviours: augment(detail.listBehaviours, extra.behaviours),\n        apis: { setItems: setItems }\n      };\n    };\n    var CustomList = composite$1({\n      name: name$2(),\n      configFields: schema$r(),\n      partFields: parts$e(),\n      factory: factory$f,\n      apis: {\n        setItems: function (apis, list, items) {\n          apis.setItems(list, items);\n        }\n      }\n    });\n\n    var setup$4 = noop;\n    var isDocked = never;\n    var getBehaviours$2 = constant([]);\n\n    var StaticHeader = /*#__PURE__*/Object.freeze({\n        __proto__: null,\n        setup: setup$4,\n        isDocked: isDocked,\n        getBehaviours: getBehaviours$2\n    });\n\n    var getOffsetParent = function (element) {\n      var isFixed = getRaw(element, 'position').is('fixed');\n      var offsetParent$1 = isFixed ? Optional.none() : offsetParent(element);\n      return offsetParent$1.orThunk(function () {\n        var marker = SugarElement.fromTag('span');\n        return parent(element).bind(function (parent) {\n          append(parent, marker);\n          var offsetParent$1 = offsetParent(marker);\n          remove(marker);\n          return offsetParent$1;\n        });\n      });\n    };\n    var getOrigin = function (element) {\n      return getOffsetParent(element).map(absolute).getOrThunk(function () {\n        return SugarPosition(0, 0);\n      });\n    };\n\n    var morphAdt = Adt.generate([\n      { static: [] },\n      { absolute: ['positionCss'] },\n      { fixed: ['positionCss'] }\n    ]);\n    var appear = function (component, contextualInfo) {\n      var elem = component.element;\n      add$2(elem, contextualInfo.transitionClass);\n      remove$4(elem, contextualInfo.fadeOutClass);\n      add$2(elem, contextualInfo.fadeInClass);\n      contextualInfo.onShow(component);\n    };\n    var disappear = function (component, contextualInfo) {\n      var elem = component.element;\n      add$2(elem, contextualInfo.transitionClass);\n      remove$4(elem, contextualInfo.fadeInClass);\n      add$2(elem, contextualInfo.fadeOutClass);\n      contextualInfo.onHide(component);\n    };\n    var isPartiallyVisible = function (box, viewport) {\n      return box.y < viewport.bottom && box.bottom > viewport.y;\n    };\n    var isTopCompletelyVisible = function (box, viewport) {\n      return box.y >= viewport.y;\n    };\n    var isBottomCompletelyVisible = function (box, viewport) {\n      return box.bottom <= viewport.bottom;\n    };\n    var isVisibleForModes = function (modes, box, viewport) {\n      return forall(modes, function (mode) {\n        switch (mode) {\n        case 'bottom':\n          return isBottomCompletelyVisible(box, viewport);\n        case 'top':\n          return isTopCompletelyVisible(box, viewport);\n        }\n      });\n    };\n    var getPrior = function (elem, state) {\n      return state.getInitialPosition().map(function (pos) {\n        return bounds$1(pos.bounds.x, pos.bounds.y, get$8(elem), get$7(elem));\n      });\n    };\n    var storePrior = function (elem, box, state) {\n      state.setInitialPosition(Optional.some({\n        style: getAllRaw(elem),\n        position: get$5(elem, 'position') || 'static',\n        bounds: box\n      }));\n    };\n    var revertToOriginal = function (elem, box$1, state) {\n      return state.getInitialPosition().bind(function (position) {\n        state.setInitialPosition(Optional.none());\n        switch (position.position) {\n        case 'static':\n          return Optional.some(morphAdt.static());\n        case 'absolute':\n          var offsetBox_1 = getOffsetParent(elem).map(box).getOrThunk(function () {\n            return box(body());\n          });\n          return Optional.some(morphAdt.absolute(NuPositionCss('absolute', get$1(position.style, 'left').map(function (_left) {\n            return box$1.x - offsetBox_1.x;\n          }), get$1(position.style, 'top').map(function (_top) {\n            return box$1.y - offsetBox_1.y;\n          }), get$1(position.style, 'right').map(function (_right) {\n            return offsetBox_1.right - box$1.right;\n          }), get$1(position.style, 'bottom').map(function (_bottom) {\n            return offsetBox_1.bottom - box$1.bottom;\n          }))));\n        default:\n          return Optional.none();\n        }\n      });\n    };\n    var morphToOriginal = function (elem, viewport, state) {\n      return getPrior(elem, state).filter(function (box) {\n        return isVisibleForModes(state.getModes(), box, viewport);\n      }).bind(function (box) {\n        return revertToOriginal(elem, box, state);\n      });\n    };\n    var morphToFixed = function (elem, viewport, state) {\n      var box$1 = box(elem);\n      if (!isVisibleForModes(state.getModes(), box$1, viewport)) {\n        storePrior(elem, box$1, state);\n        var winBox = win();\n        var left = box$1.x - winBox.x;\n        var top_1 = viewport.y - winBox.y;\n        var bottom = winBox.bottom - viewport.bottom;\n        var isTop = box$1.y <= viewport.y;\n        return Optional.some(morphAdt.fixed(NuPositionCss('fixed', Optional.some(left), isTop ? Optional.some(top_1) : Optional.none(), Optional.none(), !isTop ? Optional.some(bottom) : Optional.none())));\n      } else {\n        return Optional.none();\n      }\n    };\n    var getMorph = function (component, viewport, state) {\n      var elem = component.element;\n      var isDocked = getRaw(elem, 'position').is('fixed');\n      return isDocked ? morphToOriginal(elem, viewport, state) : morphToFixed(elem, viewport, state);\n    };\n    var getMorphToOriginal = function (component, state) {\n      var elem = component.element;\n      return getPrior(elem, state).bind(function (box) {\n        return revertToOriginal(elem, box, state);\n      });\n    };\n\n    var morphToStatic = function (component, config) {\n      each([\n        'left',\n        'right',\n        'top',\n        'bottom',\n        'position'\n      ], function (prop) {\n        return remove$6(component.element, prop);\n      });\n      config.onUndocked(component);\n    };\n    var morphToCoord = function (component, config, position) {\n      applyPositionCss(component.element, position);\n      var method = position.position === 'fixed' ? config.onDocked : config.onUndocked;\n      method(component);\n    };\n    var updateVisibility = function (component, config, state, viewport, morphToDocked) {\n      if (morphToDocked === void 0) {\n        morphToDocked = false;\n      }\n      config.contextual.each(function (contextInfo) {\n        contextInfo.lazyContext(component).each(function (box) {\n          var isVisible = isPartiallyVisible(box, viewport);\n          if (isVisible !== state.isVisible()) {\n            state.setVisible(isVisible);\n            if (morphToDocked && !isVisible) {\n              add$3(component.element, [contextInfo.fadeOutClass]);\n              contextInfo.onHide(component);\n            } else {\n              var method = isVisible ? appear : disappear;\n              method(component, contextInfo);\n            }\n          }\n        });\n      });\n    };\n    var refreshInternal = function (component, config, state) {\n      var viewport = config.lazyViewport(component);\n      var isDocked = state.isDocked();\n      if (isDocked) {\n        updateVisibility(component, config, state, viewport);\n      }\n      getMorph(component, viewport, state).each(function (morph) {\n        state.setDocked(!isDocked);\n        morph.fold(function () {\n          return morphToStatic(component, config);\n        }, function (position) {\n          return morphToCoord(component, config, position);\n        }, function (position) {\n          updateVisibility(component, config, state, viewport, true);\n          morphToCoord(component, config, position);\n        });\n      });\n    };\n    var resetInternal = function (component, config, state) {\n      var elem = component.element;\n      state.setDocked(false);\n      getMorphToOriginal(component, state).each(function (morph) {\n        morph.fold(function () {\n          return morphToStatic(component, config);\n        }, function (position) {\n          return morphToCoord(component, config, position);\n        }, noop);\n      });\n      state.setVisible(true);\n      config.contextual.each(function (contextInfo) {\n        remove$5(elem, [\n          contextInfo.fadeInClass,\n          contextInfo.fadeOutClass,\n          contextInfo.transitionClass\n        ]);\n        contextInfo.onShow(component);\n      });\n      refresh$4(component, config, state);\n    };\n    var refresh$4 = function (component, config, state) {\n      if (component.getSystem().isConnected()) {\n        refreshInternal(component, config, state);\n      }\n    };\n    var reset = function (component, config, state) {\n      if (state.isDocked()) {\n        resetInternal(component, config, state);\n      }\n    };\n    var isDocked$1 = function (component, config, state) {\n      return state.isDocked();\n    };\n    var setModes = function (component, config, state, modes) {\n      return state.setModes(modes);\n    };\n    var getModes = function (component, config, state) {\n      return state.getModes();\n    };\n\n    var DockingApis = /*#__PURE__*/Object.freeze({\n        __proto__: null,\n        refresh: refresh$4,\n        reset: reset,\n        isDocked: isDocked$1,\n        getModes: getModes,\n        setModes: setModes\n    });\n\n    var events$f = function (dockInfo, dockState) {\n      return derive([\n        runOnSource(transitionend(), function (component, simulatedEvent) {\n          dockInfo.contextual.each(function (contextInfo) {\n            if (has$2(component.element, contextInfo.transitionClass)) {\n              remove$5(component.element, [\n                contextInfo.transitionClass,\n                contextInfo.fadeInClass\n              ]);\n              var notify = dockState.isVisible() ? contextInfo.onShown : contextInfo.onHidden;\n              notify(component);\n            }\n            simulatedEvent.stop();\n          });\n        }),\n        run(windowScroll(), function (component, _) {\n          refresh$4(component, dockInfo, dockState);\n        }),\n        run(windowResize(), function (component, _) {\n          reset(component, dockInfo, dockState);\n        })\n      ]);\n    };\n\n    var ActiveDocking = /*#__PURE__*/Object.freeze({\n        __proto__: null,\n        events: events$f\n    });\n\n    var DockingSchema = [\n      optionObjOf('contextual', [\n        strictString('fadeInClass'),\n        strictString('fadeOutClass'),\n        strictString('transitionClass'),\n        strictFunction('lazyContext'),\n        onHandler('onShow'),\n        onHandler('onShown'),\n        onHandler('onHide'),\n        onHandler('onHidden')\n      ]),\n      defaultedFunction('lazyViewport', win),\n      defaultedArrayOf('modes', [\n        'top',\n        'bottom'\n      ], string),\n      onHandler('onDocked'),\n      onHandler('onUndocked')\n    ];\n\n    var init$b = function (spec) {\n      var docked = Cell(false);\n      var visible = Cell(true);\n      var initialBounds = Cell(Optional.none());\n      var modes = Cell(spec.modes);\n      var readState = function () {\n        return 'docked:  ' + docked.get() + ', visible: ' + visible.get() + ', modes: ' + modes.get().join(',');\n      };\n      return nu$5({\n        isDocked: docked.get,\n        setDocked: docked.set,\n        getInitialPosition: initialBounds.get,\n        setInitialPosition: initialBounds.set,\n        isVisible: visible.get,\n        setVisible: visible.set,\n        getModes: modes.get,\n        setModes: modes.set,\n        readState: readState\n      });\n    };\n\n    var DockingState = /*#__PURE__*/Object.freeze({\n        __proto__: null,\n        init: init$b\n    });\n\n    var Docking = create$1({\n      fields: DockingSchema,\n      name: 'docking',\n      active: ActiveDocking,\n      apis: DockingApis,\n      state: DockingState\n    });\n\n    var visibility = {\n      fadeInClass: 'tox-editor-dock-fadein',\n      fadeOutClass: 'tox-editor-dock-fadeout',\n      transitionClass: 'tox-editor-dock-transition'\n    };\n    var editorStickyOnClass = 'tox-tinymce--toolbar-sticky-on';\n    var editorStickyOffClass = 'tox-tinymce--toolbar-sticky-off';\n    var scrollFromBehindHeader = function (e, containerHeader) {\n      var doc = owner(containerHeader);\n      var viewHeight = doc.dom.defaultView.innerHeight;\n      var scrollPos = get$9(doc);\n      var markerElement = SugarElement.fromDom(e.elm);\n      var markerPos = absolute$1(markerElement);\n      var markerHeight = get$7(markerElement);\n      var markerTop = markerPos.y;\n      var markerBottom = markerTop + markerHeight;\n      var editorHeaderPos = absolute(containerHeader);\n      var editorHeaderHeight = get$7(containerHeader);\n      var editorHeaderTop = editorHeaderPos.top;\n      var editorHeaderBottom = editorHeaderTop + editorHeaderHeight;\n      var editorHeaderDockedAtTop = Math.abs(editorHeaderTop - scrollPos.top) < 2;\n      var editorHeaderDockedAtBottom = Math.abs(editorHeaderBottom - (scrollPos.top + viewHeight)) < 2;\n      if (editorHeaderDockedAtTop && markerTop < editorHeaderBottom) {\n        to(scrollPos.left, markerTop - editorHeaderHeight, doc);\n      } else if (editorHeaderDockedAtBottom && markerBottom > editorHeaderTop) {\n        var y = markerTop - viewHeight + markerHeight + editorHeaderHeight;\n        to(scrollPos.left, y, doc);\n      }\n    };\n    var isDockedMode = function (header, mode) {\n      return contains(Docking.getModes(header), mode);\n    };\n    var updateIframeContentFlow = function (header) {\n      var getOccupiedHeight = function (elm) {\n        return getOuter$1(elm) + (parseInt(get$5(elm, 'margin-top'), 10) || 0) + (parseInt(get$5(elm, 'margin-bottom'), 10) || 0);\n      };\n      var elm = header.element;\n      parent(elm).each(function (parentElem) {\n        var padding = 'padding-' + Docking.getModes(header)[0];\n        if (Docking.isDocked(header)) {\n          var parentWidth = get$8(parentElem);\n          set$2(elm, 'width', parentWidth + 'px');\n          set$2(parentElem, padding, getOccupiedHeight(elm) + 'px');\n        } else {\n          remove$6(elm, 'width');\n          remove$6(parentElem, padding);\n        }\n      });\n    };\n    var updateSinkVisibility = function (sinkElem, visible) {\n      if (visible) {\n        remove$4(sinkElem, visibility.fadeOutClass);\n        add$3(sinkElem, [\n          visibility.transitionClass,\n          visibility.fadeInClass\n        ]);\n      } else {\n        remove$4(sinkElem, visibility.fadeInClass);\n        add$3(sinkElem, [\n          visibility.fadeOutClass,\n          visibility.transitionClass\n        ]);\n      }\n    };\n    var updateEditorClasses = function (editor, docked) {\n      var editorContainer = SugarElement.fromDom(editor.getContainer());\n      if (docked) {\n        add$2(editorContainer, editorStickyOnClass);\n        remove$4(editorContainer, editorStickyOffClass);\n      } else {\n        add$2(editorContainer, editorStickyOffClass);\n        remove$4(editorContainer, editorStickyOnClass);\n      }\n    };\n    var restoreFocus = function (headerElem, focusedElem) {\n      var ownerDoc = owner(focusedElem);\n      active(ownerDoc).filter(function (activeElm) {\n        return !eq$1(focusedElem, activeElm);\n      }).filter(function (activeElm) {\n        return eq$1(activeElm, SugarElement.fromDom(ownerDoc.dom.body)) || contains$2(headerElem, activeElm);\n      }).each(function () {\n        return focus$1(focusedElem);\n      });\n    };\n    var findFocusedElem = function (rootElm, lazySink) {\n      return search(rootElm).orThunk(function () {\n        return lazySink().toOptional().bind(function (sink) {\n          return search(sink.element);\n        });\n      });\n    };\n    var setup$5 = function (editor, sharedBackstage, lazyHeader) {\n      if (!editor.inline) {\n        if (!sharedBackstage.header.isPositionedAtTop()) {\n          editor.on('ResizeEditor', function () {\n            lazyHeader().each(Docking.reset);\n          });\n        }\n        editor.on('ResizeWindow ResizeEditor', function () {\n          lazyHeader().each(updateIframeContentFlow);\n        });\n        editor.on('SkinLoaded', function () {\n          lazyHeader().each(function (comp) {\n            Docking.isDocked(comp) ? Docking.reset(comp) : Docking.refresh(comp);\n          });\n        });\n        editor.on('FullscreenStateChanged', function () {\n          lazyHeader().each(Docking.reset);\n        });\n      }\n      editor.on('AfterScrollIntoView', function (e) {\n        lazyHeader().each(function (header) {\n          Docking.refresh(header);\n          var headerElem = header.element;\n          if (isVisible(headerElem)) {\n            scrollFromBehindHeader(e, headerElem);\n          }\n        });\n      });\n      editor.on('PostRender', function () {\n        updateEditorClasses(editor, false);\n      });\n    };\n    var isDocked$2 = function (lazyHeader) {\n      return lazyHeader().map(Docking.isDocked).getOr(false);\n    };\n    var getIframeBehaviours = function () {\n      var _a;\n      return [Receiving.config({ channels: (_a = {}, _a[toolbarHeightChange()] = { onReceive: updateIframeContentFlow }, _a) })];\n    };\n    var getBehaviours$3 = function (editor, sharedBackstage) {\n      var focusedElm = Cell(Optional.none());\n      var lazySink = sharedBackstage.getSink;\n      var runOnSinkElement = function (f) {\n        lazySink().each(function (sink) {\n          return f(sink.element);\n        });\n      };\n      var onDockingSwitch = function (comp) {\n        if (!editor.inline) {\n          updateIframeContentFlow(comp);\n        }\n        updateEditorClasses(editor, Docking.isDocked(comp));\n        comp.getSystem().broadcastOn([repositionPopups()], {});\n        lazySink().each(function (sink) {\n          return sink.getSystem().broadcastOn([repositionPopups()], {});\n        });\n      };\n      var additionalBehaviours = editor.inline ? [] : getIframeBehaviours();\n      return __spreadArrays([\n        Focusing.config({}),\n        Docking.config({\n          contextual: __assign({\n            lazyContext: function (comp) {\n              var headerHeight = getOuter$1(comp.element);\n              var container = editor.inline ? editor.getContentAreaContainer() : editor.getContainer();\n              var box$1 = box(SugarElement.fromDom(container));\n              var boxHeight = box$1.height - headerHeight;\n              var topBound = box$1.y + (isDockedMode(comp, 'top') ? 0 : headerHeight);\n              return Optional.some(bounds$1(box$1.x, topBound, box$1.width, boxHeight));\n            },\n            onShow: function () {\n              runOnSinkElement(function (elem) {\n                return updateSinkVisibility(elem, true);\n              });\n            },\n            onShown: function (comp) {\n              runOnSinkElement(function (elem) {\n                return remove$5(elem, [\n                  visibility.transitionClass,\n                  visibility.fadeInClass\n                ]);\n              });\n              focusedElm.get().each(function (elem) {\n                restoreFocus(comp.element, elem);\n                focusedElm.set(Optional.none());\n              });\n            },\n            onHide: function (comp) {\n              focusedElm.set(findFocusedElem(comp.element, lazySink));\n              runOnSinkElement(function (elem) {\n                return updateSinkVisibility(elem, false);\n              });\n            },\n            onHidden: function () {\n              runOnSinkElement(function (elem) {\n                return remove$5(elem, [visibility.transitionClass]);\n              });\n            }\n          }, visibility),\n          modes: [sharedBackstage.header.getDockingMode()],\n          onDocked: onDockingSwitch,\n          onUndocked: onDockingSwitch\n        })\n      ], additionalBehaviours);\n    };\n\n    var StickyHeader = /*#__PURE__*/Object.freeze({\n        __proto__: null,\n        setup: setup$5,\n        isDocked: isDocked$2,\n        getBehaviours: getBehaviours$3\n    });\n\n    var renderHeader = function (spec) {\n      var editor = spec.editor;\n      var getBehaviours = spec.sticky ? getBehaviours$3 : getBehaviours$2;\n      return {\n        uid: spec.uid,\n        dom: spec.dom,\n        components: spec.components,\n        behaviours: derive$1(getBehaviours(editor, spec.sharedBackstage))\n      };\n    };\n\n    var factory$g = function (detail, spec) {\n      var setMenus = function (comp, menus) {\n        var newMenus = map(menus, function (m) {\n          var buttonSpec = {\n            type: 'menubutton',\n            text: m.text,\n            fetch: function (callback) {\n              callback(m.getItems());\n            }\n          };\n          var internal = createMenuButton(buttonSpec).mapError(function (errInfo) {\n            return formatError(errInfo);\n          }).getOrDie();\n          return renderMenuButton(internal, 'tox-mbtn', spec.backstage, Optional.some('menuitem'));\n        });\n        Replacing.set(comp, newMenus);\n      };\n      var apis = {\n        focus: Keying.focusIn,\n        setMenus: setMenus\n      };\n      return {\n        uid: detail.uid,\n        dom: detail.dom,\n        components: [],\n        behaviours: derive$1([\n          Replacing.config({}),\n          config('menubar-events', [\n            runOnAttached(function (component) {\n              detail.onSetup(component);\n            }),\n            run(mouseover(), function (comp, se) {\n              descendant$1(comp.element, '.' + 'tox-mbtn--active').each(function (activeButton) {\n                closest$3(se.event.target, '.' + 'tox-mbtn').each(function (hoveredButton) {\n                  if (!eq$1(activeButton, hoveredButton)) {\n                    comp.getSystem().getByDom(activeButton).each(function (activeComp) {\n                      comp.getSystem().getByDom(hoveredButton).each(function (hoveredComp) {\n                        Dropdown.expand(hoveredComp);\n                        Dropdown.close(activeComp);\n                        Focusing.focus(hoveredComp);\n                      });\n                    });\n                  }\n                });\n              });\n            }),\n            run(focusShifted(), function (comp, se) {\n              se.event.prevFocus.bind(function (prev) {\n                return comp.getSystem().getByDom(prev).toOptional();\n              }).each(function (prev) {\n                se.event.newFocus.bind(function (nu) {\n                  return comp.getSystem().getByDom(nu).toOptional();\n                }).each(function (nu) {\n                  if (Dropdown.isOpen(prev)) {\n                    Dropdown.expand(nu);\n                    Dropdown.close(prev);\n                  }\n                });\n              });\n            })\n          ]),\n          Keying.config({\n            mode: 'flow',\n            selector: '.' + 'tox-mbtn',\n            onEscape: function (comp) {\n              detail.onEscape(comp);\n              return Optional.some(true);\n            }\n          }),\n          Tabstopping.config({})\n        ]),\n        apis: apis,\n        domModification: { attributes: { role: 'menubar' } }\n      };\n    };\n    var SilverMenubar = single$2({\n      factory: factory$g,\n      name: 'silver.Menubar',\n      configFields: [\n        strict$1('dom'),\n        strict$1('uid'),\n        strict$1('onEscape'),\n        strict$1('backstage'),\n        defaulted$1('onSetup', noop)\n      ],\n      apis: {\n        focus: function (apis, comp) {\n          apis.focus(comp);\n        },\n        setMenus: function (apis, comp, menus) {\n          apis.setMenus(comp, menus);\n        }\n      }\n    });\n\n    var owner$4 = 'container';\n    var schema$s = [field$1('slotBehaviours', [])];\n    var getPartName$1 = function (name) {\n      return '<alloy.field.' + name + '>';\n    };\n    var sketch$2 = function (sSpec) {\n      var parts = function () {\n        var record = [];\n        var slot = function (name, config) {\n          record.push(name);\n          return generateOne(owner$4, getPartName$1(name), config);\n        };\n        return {\n          slot: slot,\n          record: function () {\n            return record;\n          }\n        };\n      }();\n      var spec = sSpec(parts);\n      var partNames = parts.record();\n      var fieldParts = map(partNames, function (n) {\n        return required({\n          name: n,\n          pname: getPartName$1(n)\n        });\n      });\n      return composite(owner$4, schema$s, fieldParts, make$7, spec);\n    };\n    var make$7 = function (detail, components) {\n      var getSlotNames = function (_) {\n        return getAllPartNames(detail);\n      };\n      var getSlot = function (container, key) {\n        return getPart(container, detail, key);\n      };\n      var onSlot = function (f, def) {\n        return function (container, key) {\n          return getPart(container, detail, key).map(function (slot) {\n            return f(slot, key);\n          }).getOr(def);\n        };\n      };\n      var onSlots = function (f) {\n        return function (container, keys) {\n          each(keys, function (key) {\n            return f(container, key);\n          });\n        };\n      };\n      var doShowing = function (comp, _key) {\n        return get$3(comp.element, 'aria-hidden') !== 'true';\n      };\n      var doShow = function (comp, key) {\n        if (!doShowing(comp)) {\n          var element = comp.element;\n          remove$6(element, 'display');\n          remove$1(element, 'aria-hidden');\n          emitWith(comp, slotVisibility(), {\n            name: key,\n            visible: true\n          });\n        }\n      };\n      var doHide = function (comp, key) {\n        if (doShowing(comp)) {\n          var element = comp.element;\n          set$2(element, 'display', 'none');\n          set$1(element, 'aria-hidden', 'true');\n          emitWith(comp, slotVisibility(), {\n            name: key,\n            visible: false\n          });\n        }\n      };\n      var isShowing = onSlot(doShowing, false);\n      var hideSlot = onSlot(doHide);\n      var hideSlots = onSlots(hideSlot);\n      var hideAllSlots = function (container) {\n        return hideSlots(container, getSlotNames());\n      };\n      var showSlot = onSlot(doShow);\n      var apis = {\n        getSlotNames: getSlotNames,\n        getSlot: getSlot,\n        isShowing: isShowing,\n        hideSlot: hideSlot,\n        hideAllSlots: hideAllSlots,\n        showSlot: showSlot\n      };\n      return {\n        uid: detail.uid,\n        dom: detail.dom,\n        components: components,\n        behaviours: get$d(detail.slotBehaviours),\n        apis: apis\n      };\n    };\n    var slotApis = map$2({\n      getSlotNames: function (apis, c) {\n        return apis.getSlotNames(c);\n      },\n      getSlot: function (apis, c, key) {\n        return apis.getSlot(c, key);\n      },\n      isShowing: function (apis, c, key) {\n        return apis.isShowing(c, key);\n      },\n      hideSlot: function (apis, c, key) {\n        return apis.hideSlot(c, key);\n      },\n      hideAllSlots: function (apis, c) {\n        return apis.hideAllSlots(c);\n      },\n      showSlot: function (apis, c, key) {\n        return apis.showSlot(c, key);\n      }\n    }, function (value) {\n      return makeApi(value);\n    });\n    var SlotContainer = __assign(__assign({}, slotApis), { sketch: sketch$2 });\n\n    var sidebarSchema = objOf([\n      optionString('icon'),\n      optionString('tooltip'),\n      defaultedFunction('onShow', noop),\n      defaultedFunction('onHide', noop),\n      defaultedFunction('onSetup', function () {\n        return noop;\n      })\n    ]);\n    var createSidebar = function (spec) {\n      return asRaw('sidebar', sidebarSchema, spec);\n    };\n\n    var setup$6 = function (editor) {\n      var sidebars = editor.ui.registry.getAll().sidebars;\n      each(keys(sidebars), function (name) {\n        var spec = sidebars[name];\n        var isActive = function () {\n          return Optional.from(editor.queryCommandValue('ToggleSidebar')).is(name);\n        };\n        editor.ui.registry.addToggleButton(name, {\n          icon: spec.icon,\n          tooltip: spec.tooltip,\n          onAction: function (buttonApi) {\n            editor.execCommand('ToggleSidebar', false, name);\n            buttonApi.setActive(isActive());\n          },\n          onSetup: function (buttonApi) {\n            var handleToggle = function () {\n              return buttonApi.setActive(isActive());\n            };\n            editor.on('ToggleSidebar', handleToggle);\n            return function () {\n              editor.off('ToggleSidebar', handleToggle);\n            };\n          }\n        });\n      });\n    };\n    var getApi = function (comp) {\n      return {\n        element: function () {\n          return comp.element.dom;\n        }\n      };\n    };\n    var makePanels = function (parts, panelConfigs) {\n      var specs = map(keys(panelConfigs), function (name) {\n        var spec = panelConfigs[name];\n        var bridged = getOrDie(createSidebar(spec));\n        return {\n          name: name,\n          getApi: getApi,\n          onSetup: bridged.onSetup,\n          onShow: bridged.onShow,\n          onHide: bridged.onHide\n        };\n      });\n      return map(specs, function (spec) {\n        var editorOffCell = Cell(noop);\n        return parts.slot(spec.name, {\n          dom: {\n            tag: 'div',\n            classes: ['tox-sidebar__pane']\n          },\n          behaviours: SimpleBehaviours.unnamedEvents([\n            onControlAttached(spec, editorOffCell),\n            onControlDetached(spec, editorOffCell),\n            run(slotVisibility(), function (sidepanel, se) {\n              var data = se.event;\n              var optSidePanelSpec = find(specs, function (config) {\n                return config.name === data.name;\n              });\n              optSidePanelSpec.each(function (sidePanelSpec) {\n                var handler = data.visible ? sidePanelSpec.onShow : sidePanelSpec.onHide;\n                handler(sidePanelSpec.getApi(sidepanel));\n              });\n            })\n          ])\n        });\n      });\n    };\n    var makeSidebar = function (panelConfigs) {\n      return SlotContainer.sketch(function (parts) {\n        return {\n          dom: {\n            tag: 'div',\n            classes: ['tox-sidebar__pane-container']\n          },\n          components: makePanels(parts, panelConfigs),\n          slotBehaviours: SimpleBehaviours.unnamedEvents([runOnAttached(function (slotContainer) {\n              return SlotContainer.hideAllSlots(slotContainer);\n            })])\n        };\n      });\n    };\n    var setSidebar = function (sidebar, panelConfigs) {\n      var optSlider = Composing.getCurrent(sidebar);\n      optSlider.each(function (slider) {\n        return Replacing.set(slider, [makeSidebar(panelConfigs)]);\n      });\n    };\n    var toggleSidebar = function (sidebar, name) {\n      var optSlider = Composing.getCurrent(sidebar);\n      optSlider.each(function (slider) {\n        var optSlotContainer = Composing.getCurrent(slider);\n        optSlotContainer.each(function (slotContainer) {\n          if (Sliding.hasGrown(slider)) {\n            if (SlotContainer.isShowing(slotContainer, name)) {\n              Sliding.shrink(slider);\n            } else {\n              SlotContainer.hideAllSlots(slotContainer);\n              SlotContainer.showSlot(slotContainer, name);\n            }\n          } else {\n            SlotContainer.hideAllSlots(slotContainer);\n            SlotContainer.showSlot(slotContainer, name);\n            Sliding.grow(slider);\n          }\n        });\n      });\n    };\n    var whichSidebar = function (sidebar) {\n      var optSlider = Composing.getCurrent(sidebar);\n      return optSlider.bind(function (slider) {\n        var sidebarOpen = Sliding.isGrowing(slider) || Sliding.hasGrown(slider);\n        if (sidebarOpen) {\n          var optSlotContainer = Composing.getCurrent(slider);\n          return optSlotContainer.bind(function (slotContainer) {\n            return find(SlotContainer.getSlotNames(slotContainer), function (name) {\n              return SlotContainer.isShowing(slotContainer, name);\n            });\n          });\n        } else {\n          return Optional.none();\n        }\n      });\n    };\n    var fixSize = generate$1('FixSizeEvent');\n    var autoSize = generate$1('AutoSizeEvent');\n    var renderSidebar = function (spec) {\n      return {\n        uid: spec.uid,\n        dom: {\n          tag: 'div',\n          classes: ['tox-sidebar'],\n          attributes: { role: 'complementary' }\n        },\n        components: [{\n            dom: {\n              tag: 'div',\n              classes: ['tox-sidebar__slider']\n            },\n            components: [],\n            behaviours: derive$1([\n              Tabstopping.config({}),\n              Focusing.config({}),\n              Sliding.config({\n                dimension: { property: 'width' },\n                closedClass: 'tox-sidebar--sliding-closed',\n                openClass: 'tox-sidebar--sliding-open',\n                shrinkingClass: 'tox-sidebar--sliding-shrinking',\n                growingClass: 'tox-sidebar--sliding-growing',\n                onShrunk: function (slider) {\n                  var optSlotContainer = Composing.getCurrent(slider);\n                  optSlotContainer.each(SlotContainer.hideAllSlots);\n                  emit(slider, autoSize);\n                },\n                onGrown: function (slider) {\n                  emit(slider, autoSize);\n                },\n                onStartGrow: function (slider) {\n                  emitWith(slider, fixSize, { width: getRaw(slider.element, 'width').getOr('') });\n                },\n                onStartShrink: function (slider) {\n                  emitWith(slider, fixSize, { width: get$8(slider.element) + 'px' });\n                }\n              }),\n              Replacing.config({}),\n              Composing.config({\n                find: function (comp) {\n                  var children = Replacing.contents(comp);\n                  return head(children);\n                }\n              })\n            ])\n          }],\n        behaviours: derive$1([\n          ComposingConfigs.childAt(0),\n          config('sidebar-sliding-events', [\n            run(fixSize, function (comp, se) {\n              set$2(comp.element, 'width', se.event.width);\n            }),\n            run(autoSize, function (comp, _se) {\n              remove$6(comp.element, 'width');\n            })\n          ])\n        ])\n      };\n    };\n\n    var getAttrs = function (elem) {\n      var attributes = elem.dom.attributes !== undefined ? elem.dom.attributes : [];\n      return foldl(attributes, function (b, attr) {\n        var _a;\n        if (attr.name === 'class') {\n          return b;\n        } else {\n          return __assign(__assign({}, b), (_a = {}, _a[attr.name] = attr.value, _a));\n        }\n      }, {});\n    };\n    var getClasses = function (elem) {\n      return Array.prototype.slice.call(elem.dom.classList, 0);\n    };\n    var fromHtml$2 = function (html) {\n      var elem = SugarElement.fromHtml(html);\n      var children$1 = children(elem);\n      var attrs = getAttrs(elem);\n      var classes = getClasses(elem);\n      var contents = children$1.length === 0 ? {} : { innerHtml: get$2(elem) };\n      return __assign({\n        tag: name(elem),\n        classes: classes,\n        attributes: attrs\n      }, contents);\n    };\n\n    var renderSpinner = function (providerBackstage) {\n      return {\n        dom: {\n          tag: 'div',\n          attributes: { 'aria-label': providerBackstage.translate('Loading...') },\n          classes: ['tox-throbber__busy-spinner']\n        },\n        components: [{ dom: fromHtml$2('<div class=\"tox-spinner\"><div></div><div></div><div></div></div>') }],\n        behaviours: derive$1([\n          Keying.config({\n            mode: 'special',\n            onTab: function () {\n              return Optional.some(true);\n            },\n            onShiftTab: function () {\n              return Optional.some(true);\n            }\n          }),\n          Focusing.config({})\n        ])\n      };\n    };\n    var toggleThrobber = function (comp, state, providerBackstage) {\n      var element = comp.element;\n      if (state === true) {\n        Replacing.set(comp, [renderSpinner(providerBackstage)]);\n        remove$6(element, 'display');\n        remove$1(element, 'aria-hidden');\n      } else {\n        Replacing.set(comp, []);\n        set$2(element, 'display', 'none');\n        set$1(element, 'aria-hidden', 'true');\n      }\n    };\n    var renderThrobber = function (spec) {\n      return {\n        uid: spec.uid,\n        dom: {\n          tag: 'div',\n          attributes: { 'aria-hidden': 'true' },\n          classes: ['tox-throbber'],\n          styles: { display: 'none' }\n        },\n        behaviours: derive$1([Replacing.config({})]),\n        components: []\n      };\n    };\n    var setup$7 = function (editor, lazyThrobber, sharedBackstage) {\n      var throbberState = Cell(false);\n      var timer = Cell(Optional.none());\n      var toggle = function (state) {\n        if (state !== throbberState.get()) {\n          toggleThrobber(lazyThrobber(), state, sharedBackstage.providers);\n          throbberState.set(state);\n          editor.fire('AfterProgressState', { state: state });\n        }\n      };\n      editor.on('ProgressState', function (e) {\n        timer.get().each(global$2.clearTimeout);\n        if (isNumber(e.time)) {\n          var timerId = global$2.setEditorTimeout(editor, function () {\n            return toggle(e.state);\n          }, e.time);\n          timer.set(Optional.some(timerId));\n        } else {\n          toggle(e.state);\n          timer.set(Optional.none());\n        }\n      });\n    };\n\n    var factory$h = function (detail, components, _spec) {\n      var apis = {\n        getSocket: function (comp) {\n          return parts$d.getPart(comp, detail, 'socket');\n        },\n        setSidebar: function (comp, panelConfigs) {\n          parts$d.getPart(comp, detail, 'sidebar').each(function (sidebar) {\n            return setSidebar(sidebar, panelConfigs);\n          });\n        },\n        toggleSidebar: function (comp, name) {\n          parts$d.getPart(comp, detail, 'sidebar').each(function (sidebar) {\n            return toggleSidebar(sidebar, name);\n          });\n        },\n        whichSidebar: function (comp) {\n          return parts$d.getPart(comp, detail, 'sidebar').bind(whichSidebar).getOrNull();\n        },\n        getHeader: function (comp) {\n          return parts$d.getPart(comp, detail, 'header');\n        },\n        getToolbar: function (comp) {\n          return parts$d.getPart(comp, detail, 'toolbar');\n        },\n        setToolbar: function (comp, groups) {\n          parts$d.getPart(comp, detail, 'toolbar').each(function (toolbar) {\n            toolbar.getApis().setGroups(toolbar, groups);\n          });\n        },\n        setToolbars: function (comp, toolbars) {\n          parts$d.getPart(comp, detail, 'multiple-toolbar').each(function (mToolbar) {\n            CustomList.setItems(mToolbar, toolbars);\n          });\n        },\n        refreshToolbar: function (comp) {\n          var toolbar = parts$d.getPart(comp, detail, 'toolbar');\n          toolbar.each(function (toolbar) {\n            return toolbar.getApis().refresh(toolbar);\n          });\n        },\n        toggleToolbarDrawer: function (comp) {\n          parts$d.getPart(comp, detail, 'toolbar').each(function (toolbar) {\n            mapFrom(toolbar.getApis().toggle, function (toggle) {\n              return toggle(toolbar);\n            });\n          });\n        },\n        isToolbarDrawerToggled: function (comp) {\n          return parts$d.getPart(comp, detail, 'toolbar').bind(function (toolbar) {\n            return Optional.from(toolbar.getApis().isOpen).map(function (isOpen) {\n              return isOpen(toolbar);\n            });\n          }).getOr(false);\n        },\n        getThrobber: function (comp) {\n          return parts$d.getPart(comp, detail, 'throbber');\n        },\n        focusToolbar: function (comp) {\n          var optToolbar = parts$d.getPart(comp, detail, 'toolbar').orThunk(function () {\n            return parts$d.getPart(comp, detail, 'multiple-toolbar');\n          });\n          optToolbar.each(function (toolbar) {\n            Keying.focusIn(toolbar);\n          });\n        },\n        setMenubar: function (comp, menus) {\n          parts$d.getPart(comp, detail, 'menubar').each(function (menubar) {\n            SilverMenubar.setMenus(menubar, menus);\n          });\n        },\n        focusMenubar: function (comp) {\n          parts$d.getPart(comp, detail, 'menubar').each(function (menubar) {\n            SilverMenubar.focus(menubar);\n          });\n        }\n      };\n      return {\n        uid: detail.uid,\n        dom: detail.dom,\n        components: components,\n        apis: apis,\n        behaviours: detail.behaviours\n      };\n    };\n    var partMenubar = partType$1.optional({\n      factory: SilverMenubar,\n      name: 'menubar',\n      schema: [strict$1('backstage')]\n    });\n    var toolbarFactory = function (spec) {\n      if (spec.type === ToolbarMode.sliding) {\n        return renderSlidingMoreToolbar;\n      } else if (spec.type === ToolbarMode.floating) {\n        return renderFloatingMoreToolbar;\n      } else {\n        return renderToolbar;\n      }\n    };\n    var partMultipleToolbar = partType$1.optional({\n      factory: {\n        sketch: function (spec) {\n          return CustomList.sketch({\n            uid: spec.uid,\n            dom: spec.dom,\n            listBehaviours: derive$1([Keying.config({\n                mode: 'acyclic',\n                selector: '.tox-toolbar'\n              })]),\n            makeItem: function () {\n              return renderToolbar({\n                type: spec.type,\n                uid: generate$1('multiple-toolbar-item'),\n                cyclicKeying: false,\n                initGroups: [],\n                providers: spec.providers,\n                onEscape: function () {\n                  spec.onEscape();\n                  return Optional.some(true);\n                }\n              });\n            },\n            setupItem: function (_mToolbar, tc, data, _index) {\n              Toolbar.setGroups(tc, data);\n            },\n            shell: true\n          });\n        }\n      },\n      name: 'multiple-toolbar',\n      schema: [\n        strict$1('dom'),\n        strict$1('onEscape')\n      ]\n    });\n    var partToolbar = partType$1.optional({\n      factory: {\n        sketch: function (spec) {\n          var renderer = toolbarFactory(spec);\n          var toolbarSpec = {\n            type: spec.type,\n            uid: spec.uid,\n            onEscape: function () {\n              spec.onEscape();\n              return Optional.some(true);\n            },\n            cyclicKeying: false,\n            initGroups: [],\n            getSink: spec.getSink,\n            providers: spec.providers,\n            moreDrawerData: {\n              lazyToolbar: spec.lazyToolbar,\n              lazyMoreButton: spec.lazyMoreButton,\n              lazyHeader: spec.lazyHeader\n            },\n            attributes: spec.attributes\n          };\n          return renderer(toolbarSpec);\n        }\n      },\n      name: 'toolbar',\n      schema: [\n        strict$1('dom'),\n        strict$1('onEscape'),\n        strict$1('getSink')\n      ]\n    });\n    var partHeader = partType$1.optional({\n      factory: { sketch: renderHeader },\n      name: 'header',\n      schema: [strict$1('dom')]\n    });\n    var partSocket = partType$1.optional({\n      name: 'socket',\n      schema: [strict$1('dom')]\n    });\n    var partSidebar = partType$1.optional({\n      factory: { sketch: renderSidebar },\n      name: 'sidebar',\n      schema: [strict$1('dom')]\n    });\n    var partThrobber = partType$1.optional({\n      factory: { sketch: renderThrobber },\n      name: 'throbber',\n      schema: [strict$1('dom')]\n    });\n    var OuterContainer = composite$1({\n      name: 'OuterContainer',\n      factory: factory$h,\n      configFields: [\n        strict$1('dom'),\n        strict$1('behaviours')\n      ],\n      partFields: [\n        partHeader,\n        partMenubar,\n        partToolbar,\n        partMultipleToolbar,\n        partSocket,\n        partSidebar,\n        partThrobber\n      ],\n      apis: {\n        getSocket: function (apis, comp) {\n          return apis.getSocket(comp);\n        },\n        setSidebar: function (apis, comp, panelConfigs) {\n          apis.setSidebar(comp, panelConfigs);\n        },\n        toggleSidebar: function (apis, comp, name) {\n          apis.toggleSidebar(comp, name);\n        },\n        whichSidebar: function (apis, comp) {\n          return apis.whichSidebar(comp);\n        },\n        getHeader: function (apis, comp) {\n          return apis.getHeader(comp);\n        },\n        getToolbar: function (apis, comp) {\n          return apis.getToolbar(comp);\n        },\n        setToolbar: function (apis, comp, grps) {\n          var groups = map(grps, function (grp) {\n            return renderToolbarGroup(grp);\n          });\n          apis.setToolbar(comp, groups);\n        },\n        setToolbars: function (apis, comp, ts) {\n          var renderedToolbars = map(ts, function (g) {\n            return map(g, renderToolbarGroup);\n          });\n          apis.setToolbars(comp, renderedToolbars);\n        },\n        refreshToolbar: function (apis, comp) {\n          return apis.refreshToolbar(comp);\n        },\n        toggleToolbarDrawer: function (apis, comp) {\n          apis.toggleToolbarDrawer(comp);\n        },\n        isToolbarDrawerToggled: function (apis, comp) {\n          return apis.isToolbarDrawerToggled(comp);\n        },\n        getThrobber: function (apis, comp) {\n          return apis.getThrobber(comp);\n        },\n        setMenubar: function (apis, comp, menus) {\n          apis.setMenubar(comp, menus);\n        },\n        focusMenubar: function (apis, comp) {\n          apis.focusMenubar(comp);\n        },\n        focusToolbar: function (apis, comp) {\n          apis.focusToolbar(comp);\n        }\n      }\n    });\n\n    var defaultMenubar = 'file edit view insert format tools table help';\n    var defaultMenus = {\n      file: {\n        title: 'File',\n        items: 'newdocument restoredraft | preview | export print | deleteallconversations'\n      },\n      edit: {\n        title: 'Edit',\n        items: 'undo redo | cut copy paste pastetext | selectall | searchreplace'\n      },\n      view: {\n        title: 'View',\n        items: 'code | visualaid visualchars visualblocks | spellchecker | preview fullscreen | showcomments'\n      },\n      insert: {\n        title: 'Insert',\n        items: 'image link media addcomment pageembed template codesample inserttable | charmap emoticons hr | pagebreak nonbreaking anchor toc | insertdatetime'\n      },\n      format: {\n        title: 'Format',\n        items: 'bold italic underline strikethrough superscript subscript codeformat | formats blockformats fontformats fontsizes align lineheight | forecolor backcolor | removeformat'\n      },\n      tools: {\n        title: 'Tools',\n        items: 'spellchecker spellcheckerlanguage | a11ycheck code wordcount'\n      },\n      table: {\n        title: 'Table',\n        items: 'inserttable | cell row column | advtablesort | tableprops deletetable'\n      },\n      help: {\n        title: 'Help',\n        items: 'help'\n      }\n    };\n    var make$8 = function (menu, registry, editor) {\n      var removedMenuItems = getRemovedMenuItems(editor).split(/[ ,]/);\n      return {\n        text: menu.title,\n        getItems: function () {\n          return bind(menu.items, function (i) {\n            var itemName = i.toLowerCase();\n            if (itemName.trim().length === 0) {\n              return [];\n            } else if (exists(removedMenuItems, function (removedMenuItem) {\n                return removedMenuItem === itemName;\n              })) {\n              return [];\n            } else if (itemName === 'separator' || itemName === '|') {\n              return [{ type: 'separator' }];\n            } else if (registry.menuItems[itemName]) {\n              return [registry.menuItems[itemName]];\n            } else {\n              return [];\n            }\n          });\n        }\n      };\n    };\n    var parseItemsString = function (items) {\n      if (typeof items === 'string') {\n        return items.split(' ');\n      }\n      return items;\n    };\n    var identifyMenus = function (editor, registry) {\n      var rawMenuData = __assign(__assign({}, defaultMenus), registry.menus);\n      var userDefinedMenus = keys(registry.menus).length > 0;\n      var menubar = registry.menubar === undefined || registry.menubar === true ? parseItemsString(defaultMenubar) : parseItemsString(registry.menubar === false ? '' : registry.menubar);\n      var validMenus = filter(menubar, function (menuName) {\n        return userDefinedMenus ? registry.menus.hasOwnProperty(menuName) && registry.menus[menuName].hasOwnProperty('items') || defaultMenus.hasOwnProperty(menuName) : defaultMenus.hasOwnProperty(menuName);\n      });\n      var menus = map(validMenus, function (menuName) {\n        var menuData = rawMenuData[menuName];\n        return make$8({\n          title: menuData.title,\n          items: parseItemsString(menuData.items)\n        }, registry, editor);\n      });\n      return filter(menus, function (menu) {\n        var isNotSeparator = function (item) {\n          return item.type !== 'separator';\n        };\n        return menu.getItems().length > 0 && exists(menu.getItems(), isNotSeparator);\n      });\n    };\n\n    var fireSkinLoaded$1 = function (editor) {\n      var done = function () {\n        editor._skinLoaded = true;\n        fireSkinLoaded(editor);\n      };\n      return function () {\n        if (editor.initialized) {\n          done();\n        } else {\n          editor.on('init', done);\n        }\n      };\n    };\n    var fireSkinLoadError$1 = function (editor, err) {\n      return function () {\n        return fireSkinLoadError(editor, { message: err });\n      };\n    };\n\n    var loadStylesheet = function (editor, stylesheetUrl, styleSheetLoader) {\n      return new global$4(function (resolve, reject) {\n        styleSheetLoader.load(stylesheetUrl, resolve, reject);\n        editor.on('remove', function () {\n          return styleSheetLoader.unload(stylesheetUrl);\n        });\n      });\n    };\n    var loadUiSkins = function (editor, skinUrl) {\n      var skinUiCss = skinUrl + '/skin.min.css';\n      return loadStylesheet(editor, skinUiCss, editor.ui.styleSheetLoader);\n    };\n    var loadShadowDomUiSkins = function (editor, skinUrl) {\n      var isInShadowRoot$1 = isInShadowRoot(SugarElement.fromDom(editor.getElement()));\n      if (isInShadowRoot$1) {\n        var shadowDomSkinCss = skinUrl + '/skin.shadowdom.min.css';\n        return loadStylesheet(editor, shadowDomSkinCss, global$5.DOM.styleSheetLoader);\n      } else {\n        return global$4.resolve();\n      }\n    };\n    var loadSkin = function (isInline, editor) {\n      var skinUrl = getSkinUrl(editor);\n      if (skinUrl) {\n        editor.contentCSS.push(skinUrl + (isInline ? '/content.inline' : '/content') + '.min.css');\n      }\n      if (isSkinDisabled(editor) === false && isString(skinUrl)) {\n        global$4.all([\n          loadUiSkins(editor, skinUrl),\n          loadShadowDomUiSkins(editor, skinUrl)\n        ]).then(fireSkinLoaded$1(editor), fireSkinLoadError$1(editor, 'Skin could not be loaded'));\n      } else {\n        fireSkinLoaded$1(editor)();\n      }\n    };\n    var iframe = curry(loadSkin, false);\n    var inline = curry(loadSkin, true);\n\n    var setToolbar = function (editor, uiComponents, rawUiConfig, backstage) {\n      var comp = uiComponents.outerContainer;\n      var toolbarConfig = rawUiConfig.toolbar;\n      var toolbarButtonsConfig = rawUiConfig.buttons;\n      if (isArrayOf(toolbarConfig, isString)) {\n        var toolbars = toolbarConfig.map(function (t) {\n          var config = {\n            toolbar: t,\n            buttons: toolbarButtonsConfig,\n            allowToolbarGroups: rawUiConfig.allowToolbarGroups\n          };\n          return identifyButtons(editor, config, { backstage: backstage }, Optional.none());\n        });\n        OuterContainer.setToolbars(comp, toolbars);\n      } else {\n        OuterContainer.setToolbar(comp, identifyButtons(editor, rawUiConfig, { backstage: backstage }, Optional.none()));\n      }\n    };\n\n    var detection = detect$3();\n    var isiOS12 = detection.os.isiOS() && detection.os.version.major <= 12;\n    var setupEvents = function (editor, uiComponents) {\n      var dom = editor.dom;\n      var contentWindow = editor.getWin();\n      var initialDocEle = editor.getDoc().documentElement;\n      var lastWindowDimensions = Cell(SugarPosition(contentWindow.innerWidth, contentWindow.innerHeight));\n      var lastDocumentDimensions = Cell(SugarPosition(initialDocEle.offsetWidth, initialDocEle.offsetHeight));\n      var resizeWindow = function () {\n        var outer = lastWindowDimensions.get();\n        if (outer.left !== contentWindow.innerWidth || outer.top !== contentWindow.innerHeight) {\n          lastWindowDimensions.set(SugarPosition(contentWindow.innerWidth, contentWindow.innerHeight));\n          fireResizeContent(editor);\n        }\n      };\n      var resizeDocument = function () {\n        var docEle = editor.getDoc().documentElement;\n        var inner = lastDocumentDimensions.get();\n        if (inner.left !== docEle.offsetWidth || inner.top !== docEle.offsetHeight) {\n          lastDocumentDimensions.set(SugarPosition(docEle.offsetWidth, docEle.offsetHeight));\n          fireResizeContent(editor);\n        }\n      };\n      var scroll = function (e) {\n        return fireScrollContent(editor, e);\n      };\n      dom.bind(contentWindow, 'resize', resizeWindow);\n      dom.bind(contentWindow, 'scroll', scroll);\n      var elementLoad = capture$1(SugarElement.fromDom(editor.getBody()), 'load', resizeDocument);\n      var mothership = uiComponents.uiMothership.element;\n      editor.on('hide', function () {\n        set$2(mothership, 'display', 'none');\n      });\n      editor.on('show', function () {\n        remove$6(mothership, 'display');\n      });\n      editor.on('NodeChange', resizeDocument);\n      editor.on('remove', function () {\n        elementLoad.unbind();\n        dom.unbind(contentWindow, 'resize', resizeWindow);\n        dom.unbind(contentWindow, 'scroll', scroll);\n        contentWindow = null;\n      });\n    };\n    var render$1 = function (editor, uiComponents, rawUiConfig, backstage, args) {\n      var lastToolbarWidth = Cell(0);\n      var outerContainer = uiComponents.outerContainer;\n      iframe(editor);\n      var eTargetNode = SugarElement.fromDom(args.targetNode);\n      var uiRoot = getContentContainer(getRootNode(eTargetNode));\n      attachSystemAfter(eTargetNode, uiComponents.mothership);\n      attachSystem(uiRoot, uiComponents.uiMothership);\n      editor.on('PostRender', function () {\n        setToolbar(editor, uiComponents, rawUiConfig, backstage);\n        lastToolbarWidth.set(editor.getWin().innerWidth);\n        OuterContainer.setMenubar(outerContainer, identifyMenus(editor, rawUiConfig));\n        OuterContainer.setSidebar(outerContainer, rawUiConfig.sidebar);\n        setupEvents(editor, uiComponents);\n      });\n      var socket = OuterContainer.getSocket(outerContainer).getOrDie('Could not find expected socket element');\n      if (isiOS12) {\n        setAll$1(socket.element, {\n          'overflow': 'scroll',\n          '-webkit-overflow-scrolling': 'touch'\n        });\n        var limit = first(function () {\n          editor.fire('ScrollContent');\n        }, 20);\n        var unbinder = bind$3(socket.element, 'scroll', limit.throttle);\n        editor.on('remove', unbinder.unbind);\n      }\n      setupReadonlyModeSwitch(editor, uiComponents);\n      editor.addCommand('ToggleSidebar', function (_ui, value) {\n        OuterContainer.toggleSidebar(outerContainer, value);\n        editor.fire('ToggleSidebar');\n      });\n      editor.addQueryValueHandler('ToggleSidebar', function () {\n        return OuterContainer.whichSidebar(outerContainer);\n      });\n      var toolbarMode = getToolbarMode(editor);\n      var refreshDrawer = function () {\n        OuterContainer.refreshToolbar(uiComponents.outerContainer);\n      };\n      if (toolbarMode === ToolbarMode.sliding || toolbarMode === ToolbarMode.floating) {\n        editor.on('ResizeWindow ResizeEditor ResizeContent', function () {\n          var width = editor.getWin().innerWidth;\n          if (width !== lastToolbarWidth.get()) {\n            refreshDrawer();\n            lastToolbarWidth.set(width);\n          }\n        });\n      }\n      var api = {\n        enable: function () {\n          broadcastReadonly(uiComponents, false);\n        },\n        disable: function () {\n          broadcastReadonly(uiComponents, true);\n        },\n        isDisabled: function () {\n          return Disabling.isDisabled(outerContainer);\n        }\n      };\n      return {\n        iframeContainer: socket.element.dom,\n        editorContainer: outerContainer.element.dom,\n        api: api\n      };\n    };\n\n    var Iframe = /*#__PURE__*/Object.freeze({\n        __proto__: null,\n        render: render$1\n    });\n\n    var parseToInt = function (val) {\n      var re = /^[0-9\\.]+(|px)$/i;\n      if (re.test('' + val)) {\n        return Optional.some(parseInt('' + val, 10));\n      }\n      return Optional.none();\n    };\n    var numToPx = function (val) {\n      return isNumber(val) ? val + 'px' : val;\n    };\n    var calcCappedSize = function (size, minSize, maxSize) {\n      var minOverride = minSize.filter(function (min) {\n        return size < min;\n      });\n      var maxOverride = maxSize.filter(function (max) {\n        return size > max;\n      });\n      return minOverride.or(maxOverride).getOr(size);\n    };\n\n    var getHeight$1 = function (editor) {\n      var baseHeight = getHeightSetting(editor);\n      var minHeight = getMinHeightSetting(editor);\n      var maxHeight = getMaxHeightSetting(editor);\n      return parseToInt(baseHeight).map(function (height) {\n        return calcCappedSize(height, minHeight, maxHeight);\n      });\n    };\n    var getHeightWithFallback = function (editor) {\n      var height = getHeight$1(editor);\n      return height.getOr(getHeightSetting(editor));\n    };\n    var getWidth$1 = function (editor) {\n      var baseWidth = getWidthSetting(editor);\n      var minWidth = getMinWidthSetting(editor);\n      var maxWidth = getMaxWidthSetting(editor);\n      return parseToInt(baseWidth).map(function (width) {\n        return calcCappedSize(width, minWidth, maxWidth);\n      });\n    };\n    var getWidthWithFallback = function (editor) {\n      var width = getWidth$1(editor);\n      return width.getOr(getWidthSetting(editor));\n    };\n\n    var InlineHeader = function (editor, targetElm, uiComponents, backstage, floatContainer) {\n      var uiMothership = uiComponents.uiMothership, outerContainer = uiComponents.outerContainer;\n      var DOM = global$5.DOM;\n      var useFixedToolbarContainer = useFixedContainer(editor);\n      var isSticky = isStickyToolbar(editor);\n      var editorMaxWidthOpt = getMaxWidthSetting(editor).or(getWidth$1(editor));\n      var headerBackstage = backstage.shared.header;\n      var isPositionedAtTop = headerBackstage.isPositionedAtTop;\n      var toolbarMode = getToolbarMode(editor);\n      var isSplitToolbar = toolbarMode === ToolbarMode.sliding || toolbarMode === ToolbarMode.floating;\n      var visible = Cell(false);\n      var isVisible = function () {\n        return visible.get() && !editor.removed;\n      };\n      var calcToolbarOffset = function (toolbar) {\n        return isSplitToolbar ? toolbar.fold(function () {\n          return 0;\n        }, function (tbar) {\n          return tbar.components().length > 1 ? get$7(tbar.components()[1].element) : 0;\n        }) : 0;\n      };\n      var calcMode = function (container) {\n        switch (getToolbarLocation(editor)) {\n        case ToolbarLocation.auto:\n          var toolbar_1 = OuterContainer.getToolbar(outerContainer);\n          var offset = calcToolbarOffset(toolbar_1);\n          var toolbarHeight = get$7(container.element) - offset;\n          var targetBounds = box(targetElm);\n          var roomAtTop = targetBounds.y > toolbarHeight;\n          if (roomAtTop) {\n            return 'top';\n          } else {\n            var doc = documentElement(targetElm);\n            var docHeight = Math.max(doc.dom.scrollHeight, get$7(doc));\n            var roomAtBottom = targetBounds.bottom < docHeight - toolbarHeight;\n            if (roomAtBottom) {\n              return 'bottom';\n            } else {\n              var winBounds = win();\n              var isRoomAtBottomViewport = winBounds.bottom < targetBounds.bottom - toolbarHeight;\n              return isRoomAtBottomViewport ? 'bottom' : 'top';\n            }\n          }\n        case ToolbarLocation.bottom:\n          return 'bottom';\n        case ToolbarLocation.top:\n        default:\n          return 'top';\n        }\n      };\n      var setupMode = function (mode) {\n        var container = floatContainer.get();\n        Docking.setModes(container, [mode]);\n        headerBackstage.setDockingMode(mode);\n        var verticalDir = isPositionedAtTop() ? AttributeValue.TopToBottom : AttributeValue.BottomToTop;\n        set$1(container.element, Attribute, verticalDir);\n      };\n      var updateChromeWidth = function () {\n        var maxWidth = editorMaxWidthOpt.getOrThunk(function () {\n          var bodyMargin = parseToInt(get$5(body(), 'margin-left')).getOr(0);\n          return get$8(body()) - absolute(targetElm).left + bodyMargin;\n        });\n        set$2(floatContainer.get().element, 'max-width', maxWidth + 'px');\n      };\n      var updateChromePosition = function () {\n        var toolbar = OuterContainer.getToolbar(outerContainer);\n        var offset = calcToolbarOffset(toolbar);\n        var targetBounds = box(targetElm);\n        var top = isPositionedAtTop() ? Math.max(targetBounds.y - get$7(floatContainer.get().element) + offset, 0) : targetBounds.bottom;\n        setAll$1(outerContainer.element, {\n          position: 'absolute',\n          top: Math.round(top) + 'px',\n          left: Math.round(targetBounds.x) + 'px'\n        });\n      };\n      var repositionPopups$1 = function () {\n        uiMothership.broadcastOn([repositionPopups()], {});\n      };\n      var updateChromeUi = function (resetDocking) {\n        if (resetDocking === void 0) {\n          resetDocking = false;\n        }\n        if (!isVisible()) {\n          return;\n        }\n        if (!useFixedToolbarContainer) {\n          updateChromeWidth();\n        }\n        if (isSplitToolbar) {\n          OuterContainer.refreshToolbar(outerContainer);\n        }\n        if (!useFixedToolbarContainer) {\n          updateChromePosition();\n        }\n        if (isSticky) {\n          var floatContainerComp = floatContainer.get();\n          resetDocking ? Docking.reset(floatContainerComp) : Docking.refresh(floatContainerComp);\n        }\n        repositionPopups$1();\n      };\n      var updateMode = function (updateUi) {\n        if (updateUi === void 0) {\n          updateUi = true;\n        }\n        if (useFixedToolbarContainer || !isSticky || !isVisible()) {\n          return;\n        }\n        var currentMode = headerBackstage.getDockingMode();\n        var newMode = calcMode(floatContainer.get());\n        if (newMode !== currentMode) {\n          setupMode(newMode);\n          if (updateUi) {\n            updateChromeUi(true);\n          }\n        }\n      };\n      var show = function () {\n        visible.set(true);\n        set$2(outerContainer.element, 'display', 'flex');\n        DOM.addClass(editor.getBody(), 'mce-edit-focus');\n        remove$6(uiMothership.element, 'display');\n        updateMode(false);\n        updateChromeUi();\n      };\n      var hide = function () {\n        visible.set(false);\n        if (uiComponents.outerContainer) {\n          set$2(outerContainer.element, 'display', 'none');\n          DOM.removeClass(editor.getBody(), 'mce-edit-focus');\n        }\n        set$2(uiMothership.element, 'display', 'none');\n      };\n      return {\n        isVisible: isVisible,\n        isPositionedAtTop: isPositionedAtTop,\n        show: show,\n        hide: hide,\n        update: updateChromeUi,\n        updateMode: updateMode,\n        repositionPopups: repositionPopups$1\n      };\n    };\n\n    var getTargetPosAndBounds = function (targetElm, isToolbarTop) {\n      var bounds = box(targetElm);\n      return {\n        pos: isToolbarTop ? bounds.y : bounds.bottom,\n        bounds: bounds\n      };\n    };\n    var setupEvents$1 = function (editor, targetElm, ui, toolbarPersist) {\n      var prevPosAndBounds = Cell(getTargetPosAndBounds(targetElm, ui.isPositionedAtTop()));\n      var resizeContent = function (e) {\n        var _a = getTargetPosAndBounds(targetElm, ui.isPositionedAtTop()), pos = _a.pos, bounds = _a.bounds;\n        var _b = prevPosAndBounds.get(), prevPos = _b.pos, prevBounds = _b.bounds;\n        var hasResized = bounds.height !== prevBounds.height || bounds.width !== prevBounds.width;\n        prevPosAndBounds.set({\n          pos: pos,\n          bounds: bounds\n        });\n        if (hasResized) {\n          fireResizeContent(editor, e);\n        }\n        if (ui.isVisible()) {\n          if (prevPos !== pos) {\n            ui.update(true);\n          } else if (hasResized) {\n            ui.updateMode();\n            ui.repositionPopups();\n          }\n        }\n      };\n      if (!toolbarPersist) {\n        editor.on('activate', ui.show);\n        editor.on('deactivate', ui.hide);\n      }\n      editor.on('SkinLoaded ResizeWindow', function () {\n        return ui.update(true);\n      });\n      editor.on('NodeChange keydown', function (e) {\n        global$2.requestAnimationFrame(function () {\n          return resizeContent(e);\n        });\n      });\n      editor.on('ScrollWindow', function () {\n        return ui.updateMode();\n      });\n      var elementLoad = unbindable();\n      elementLoad.set(capture$1(SugarElement.fromDom(editor.getBody()), 'load', resizeContent));\n      editor.on('remove', function () {\n        elementLoad.clear();\n      });\n    };\n    var render$2 = function (editor, uiComponents, rawUiConfig, backstage, args) {\n      var mothership = uiComponents.mothership, uiMothership = uiComponents.uiMothership, outerContainer = uiComponents.outerContainer;\n      var floatContainer = Cell(null);\n      var targetElm = SugarElement.fromDom(args.targetNode);\n      var ui = InlineHeader(editor, targetElm, uiComponents, backstage, floatContainer);\n      var toolbarPersist = isToolbarPersist(editor);\n      inline(editor);\n      var render = function () {\n        if (floatContainer.get()) {\n          ui.show();\n          return;\n        }\n        floatContainer.set(OuterContainer.getHeader(outerContainer).getOrDie());\n        var uiContainer = getUiContainer(editor);\n        attachSystem(uiContainer, mothership);\n        attachSystem(uiContainer, uiMothership);\n        setToolbar(editor, uiComponents, rawUiConfig, backstage);\n        OuterContainer.setMenubar(outerContainer, identifyMenus(editor, rawUiConfig));\n        ui.show();\n        setupEvents$1(editor, targetElm, ui, toolbarPersist);\n        editor.nodeChanged();\n      };\n      var delayedRender = function () {\n        return global$2.setEditorTimeout(editor, render, 0);\n      };\n      editor.on('show', render);\n      editor.on('hide', ui.hide);\n      if (!toolbarPersist) {\n        editor.on('focus', delayedRender);\n        editor.on('blur', ui.hide);\n      }\n      editor.on('init', function () {\n        if (editor.hasFocus() || toolbarPersist) {\n          delayedRender();\n        }\n      });\n      setupReadonlyModeSwitch(editor, uiComponents);\n      var api = {\n        show: function () {\n          ui.show();\n        },\n        hide: function () {\n          ui.hide();\n        },\n        enable: function () {\n          broadcastReadonly(uiComponents, false);\n        },\n        disable: function () {\n          broadcastReadonly(uiComponents, true);\n        },\n        isDisabled: function () {\n          return Disabling.isDisabled(outerContainer);\n        }\n      };\n      return {\n        editorContainer: outerContainer.element.dom,\n        api: api\n      };\n    };\n\n    var Inline = /*#__PURE__*/Object.freeze({\n        __proto__: null,\n        render: render$2\n    });\n\n    var register$5 = function (editor) {\n      var alignToolbarButtons = [\n        {\n          name: 'alignleft',\n          text: 'Align left',\n          cmd: 'JustifyLeft',\n          icon: 'align-left'\n        },\n        {\n          name: 'aligncenter',\n          text: 'Align center',\n          cmd: 'JustifyCenter',\n          icon: 'align-center'\n        },\n        {\n          name: 'alignright',\n          text: 'Align right',\n          cmd: 'JustifyRight',\n          icon: 'align-right'\n        },\n        {\n          name: 'alignjustify',\n          text: 'Justify',\n          cmd: 'JustifyFull',\n          icon: 'align-justify'\n        }\n      ];\n      global$c.each(alignToolbarButtons, function (item) {\n        editor.ui.registry.addToggleButton(item.name, {\n          tooltip: item.text,\n          onAction: function () {\n            return editor.execCommand(item.cmd);\n          },\n          icon: item.icon,\n          onSetup: onSetupFormatToggle(editor, item.name)\n        });\n      });\n      var alignNoneToolbarButton = {\n        name: 'alignnone',\n        text: 'No alignment',\n        cmd: 'JustifyNone',\n        icon: 'align-none'\n      };\n      editor.ui.registry.addButton(alignNoneToolbarButton.name, {\n        tooltip: alignNoneToolbarButton.text,\n        onAction: function () {\n          return editor.execCommand(alignNoneToolbarButton.cmd);\n        },\n        icon: alignNoneToolbarButton.icon\n      });\n    };\n\n    var register$6 = function (editor, backstage) {\n      alignSelectMenu(editor, backstage);\n      fontSelectMenu(editor, backstage);\n      styleSelectMenu(editor, backstage);\n      formatSelectMenu(editor, backstage);\n      fontsizeSelectMenu(editor, backstage);\n    };\n\n    var toggleOutdentState = function (api, editor) {\n      api.setDisabled(!editor.queryCommandState('outdent'));\n      var onNodeChange = function () {\n        api.setDisabled(!editor.queryCommandState('outdent'));\n      };\n      editor.on('NodeChange', onNodeChange);\n      return function () {\n        return editor.off('NodeChange', onNodeChange);\n      };\n    };\n    var registerButtons = function (editor) {\n      editor.ui.registry.addButton('outdent', {\n        tooltip: 'Decrease indent',\n        icon: 'outdent',\n        onSetup: function (api) {\n          return toggleOutdentState(api, editor);\n        },\n        onAction: function () {\n          return editor.execCommand('outdent');\n        }\n      });\n      editor.ui.registry.addButton('indent', {\n        tooltip: 'Increase indent',\n        icon: 'indent',\n        onAction: function () {\n          return editor.execCommand('indent');\n        }\n      });\n    };\n    var register$7 = function (editor) {\n      registerButtons(editor);\n    };\n\n    var units = {\n      unsupportedLength: [\n        'em',\n        'ex',\n        'cap',\n        'ch',\n        'ic',\n        'rem',\n        'lh',\n        'rlh',\n        'vw',\n        'vh',\n        'vi',\n        'vb',\n        'vmin',\n        'vmax',\n        'cm',\n        'mm',\n        'Q',\n        'in',\n        'pc',\n        'pt',\n        'px'\n      ],\n      fixed: [\n        'px',\n        'pt'\n      ],\n      relative: ['%'],\n      empty: ['']\n    };\n    var pattern = function () {\n      var decimalDigits = '[0-9]+';\n      var signedInteger = '[+-]?' + decimalDigits;\n      var exponentPart = '[eE]' + signedInteger;\n      var dot = '\\\\.';\n      var opt = function (input) {\n        return '(?:' + input + ')?';\n      };\n      var unsignedDecimalLiteral = [\n        'Infinity',\n        decimalDigits + dot + opt(decimalDigits) + opt(exponentPart),\n        dot + decimalDigits + opt(exponentPart),\n        decimalDigits + opt(exponentPart)\n      ].join('|');\n      var float = '[+-]?(?:' + unsignedDecimalLiteral + ')';\n      return new RegExp('^(' + float + ')(.*)$');\n    }();\n    var isUnit = function (unit, accepted) {\n      return exists(accepted, function (acc) {\n        return exists(units[acc], function (check) {\n          return unit === check;\n        });\n      });\n    };\n    var parse = function (input, accepted) {\n      var match = Optional.from(pattern.exec(input));\n      return match.bind(function (array) {\n        var value = Number(array[1]);\n        var unitRaw = array[2];\n        if (isUnit(unitRaw, accepted)) {\n          return Optional.some({\n            value: value,\n            unit: unitRaw\n          });\n        } else {\n          return Optional.none();\n        }\n      });\n    };\n    var normalise = function (input, accepted) {\n      return parse(input, accepted).map(function (_a) {\n        var value = _a.value, unit = _a.unit;\n        return value + unit;\n      });\n    };\n\n    var normaliseLineHeight = function (input) {\n      return normalise(input, [\n        'fixed',\n        'relative',\n        'empty'\n      ]).getOr(input);\n    };\n    var getLineHeights = function (editor) {\n      var options = getLineHeightFormats(editor);\n      var apis = new Map();\n      var lastApi = destroyable();\n      var callback = function () {\n        var current = normaliseLineHeight(editor.queryCommandValue('LineHeight'));\n        Optional.from(apis.get(current)).fold(function () {\n          return lastApi.clear();\n        }, function (api) {\n          lastApi.set({\n            destroy: function () {\n              api.setActive(false);\n            }\n          });\n          api.setActive(true);\n        });\n      };\n      editor.on('nodeChange', callback);\n      return map(options, function (value, i) {\n        return {\n          type: 'togglemenuitem',\n          text: value,\n          onSetup: function (api) {\n            apis.set(normaliseLineHeight(value), api);\n            if (i + 1 === options.length) {\n              callback();\n            }\n            return function () {\n              if (i === 0) {\n                editor.off('nodeChange', callback);\n                lastApi.clear();\n              }\n            };\n          },\n          onAction: function () {\n            return editor.execCommand('LineHeight', false, value);\n          }\n        };\n      });\n    };\n    var registerMenuItems = function (editor) {\n      editor.ui.registry.addNestedMenuItem('lineheight', {\n        type: 'nestedmenuitem',\n        text: 'Line height',\n        getSubmenuItems: function () {\n          return getLineHeights(editor);\n        }\n      });\n    };\n    var registerButtons$1 = function (editor) {\n      editor.ui.registry.addMenuButton('lineheight', {\n        tooltip: 'Line height',\n        icon: 'line-height',\n        fetch: function (callback) {\n          return callback(getLineHeights(editor));\n        }\n      });\n    };\n    var register$8 = function (editor) {\n      registerMenuItems(editor);\n      registerButtons$1(editor);\n    };\n\n    var toggleFormat = function (editor, fmt) {\n      return function () {\n        editor.execCommand('mceToggleFormat', false, fmt);\n      };\n    };\n    var registerFormatButtons = function (editor) {\n      global$c.each([\n        {\n          name: 'bold',\n          text: 'Bold',\n          icon: 'bold'\n        },\n        {\n          name: 'italic',\n          text: 'Italic',\n          icon: 'italic'\n        },\n        {\n          name: 'underline',\n          text: 'Underline',\n          icon: 'underline'\n        },\n        {\n          name: 'strikethrough',\n          text: 'Strikethrough',\n          icon: 'strike-through'\n        },\n        {\n          name: 'subscript',\n          text: 'Subscript',\n          icon: 'subscript'\n        },\n        {\n          name: 'superscript',\n          text: 'Superscript',\n          icon: 'superscript'\n        }\n      ], function (btn, _idx) {\n        editor.ui.registry.addToggleButton(btn.name, {\n          tooltip: btn.text,\n          icon: btn.icon,\n          onSetup: onSetupFormatToggle(editor, btn.name),\n          onAction: toggleFormat(editor, btn.name)\n        });\n      });\n      for (var i = 1; i <= 6; i++) {\n        var name_1 = 'h' + i;\n        editor.ui.registry.addToggleButton(name_1, {\n          text: name_1.toUpperCase(),\n          tooltip: 'Heading ' + i,\n          onSetup: onSetupFormatToggle(editor, name_1),\n          onAction: toggleFormat(editor, name_1)\n        });\n      }\n    };\n    var registerCommandButtons = function (editor) {\n      global$c.each([\n        {\n          name: 'cut',\n          text: 'Cut',\n          action: 'Cut',\n          icon: 'cut'\n        },\n        {\n          name: 'copy',\n          text: 'Copy',\n          action: 'Copy',\n          icon: 'copy'\n        },\n        {\n          name: 'paste',\n          text: 'Paste',\n          action: 'Paste',\n          icon: 'paste'\n        },\n        {\n          name: 'help',\n          text: 'Help',\n          action: 'mceHelp',\n          icon: 'help'\n        },\n        {\n          name: 'selectall',\n          text: 'Select all',\n          action: 'SelectAll',\n          icon: 'select-all'\n        },\n        {\n          name: 'newdocument',\n          text: 'New document',\n          action: 'mceNewDocument',\n          icon: 'new-document'\n        },\n        {\n          name: 'removeformat',\n          text: 'Clear formatting',\n          action: 'RemoveFormat',\n          icon: 'remove-formatting'\n        },\n        {\n          name: 'remove',\n          text: 'Remove',\n          action: 'Delete',\n          icon: 'remove'\n        }\n      ], function (btn) {\n        editor.ui.registry.addButton(btn.name, {\n          tooltip: btn.text,\n          icon: btn.icon,\n          onAction: function () {\n            return editor.execCommand(btn.action);\n          }\n        });\n      });\n    };\n    var registerCommandToggleButtons = function (editor) {\n      global$c.each([{\n          name: 'blockquote',\n          text: 'Blockquote',\n          action: 'mceBlockQuote',\n          icon: 'quote'\n        }], function (btn) {\n        editor.ui.registry.addToggleButton(btn.name, {\n          tooltip: btn.text,\n          icon: btn.icon,\n          onAction: function () {\n            return editor.execCommand(btn.action);\n          },\n          onSetup: onSetupFormatToggle(editor, btn.name)\n        });\n      });\n    };\n    var registerButtons$2 = function (editor) {\n      registerFormatButtons(editor);\n      registerCommandButtons(editor);\n      registerCommandToggleButtons(editor);\n    };\n    var registerMenuItems$1 = function (editor) {\n      global$c.each([\n        {\n          name: 'bold',\n          text: 'Bold',\n          action: 'Bold',\n          icon: 'bold',\n          shortcut: 'Meta+B'\n        },\n        {\n          name: 'italic',\n          text: 'Italic',\n          action: 'Italic',\n          icon: 'italic',\n          shortcut: 'Meta+I'\n        },\n        {\n          name: 'underline',\n          text: 'Underline',\n          action: 'Underline',\n          icon: 'underline',\n          shortcut: 'Meta+U'\n        },\n        {\n          name: 'strikethrough',\n          text: 'Strikethrough',\n          action: 'Strikethrough',\n          icon: 'strike-through',\n          shortcut: ''\n        },\n        {\n          name: 'subscript',\n          text: 'Subscript',\n          action: 'Subscript',\n          icon: 'subscript',\n          shortcut: ''\n        },\n        {\n          name: 'superscript',\n          text: 'Superscript',\n          action: 'Superscript',\n          icon: 'superscript',\n          shortcut: ''\n        },\n        {\n          name: 'removeformat',\n          text: 'Clear formatting',\n          action: 'RemoveFormat',\n          icon: 'remove-formatting',\n          shortcut: ''\n        },\n        {\n          name: 'newdocument',\n          text: 'New document',\n          action: 'mceNewDocument',\n          icon: 'new-document',\n          shortcut: ''\n        },\n        {\n          name: 'cut',\n          text: 'Cut',\n          action: 'Cut',\n          icon: 'cut',\n          shortcut: 'Meta+X'\n        },\n        {\n          name: 'copy',\n          text: 'Copy',\n          action: 'Copy',\n          icon: 'copy',\n          shortcut: 'Meta+C'\n        },\n        {\n          name: 'paste',\n          text: 'Paste',\n          action: 'Paste',\n          icon: 'paste',\n          shortcut: 'Meta+V'\n        },\n        {\n          name: 'selectall',\n          text: 'Select all',\n          action: 'SelectAll',\n          icon: 'select-all',\n          shortcut: 'Meta+A'\n        }\n      ], function (btn) {\n        editor.ui.registry.addMenuItem(btn.name, {\n          text: btn.text,\n          icon: btn.icon,\n          shortcut: btn.shortcut,\n          onAction: function () {\n            return editor.execCommand(btn.action);\n          }\n        });\n      });\n      editor.ui.registry.addMenuItem('codeformat', {\n        text: 'Code',\n        icon: 'sourcecode',\n        onAction: toggleFormat(editor, 'code')\n      });\n    };\n    var register$9 = function (editor) {\n      registerButtons$2(editor);\n      registerMenuItems$1(editor);\n    };\n\n    var toggleUndoRedoState = function (api, editor, type) {\n      var checkState = function () {\n        return editor.undoManager ? editor.undoManager[type]() : false;\n      };\n      var onUndoStateChange = function () {\n        api.setDisabled(editor.mode.isReadOnly() || !checkState());\n      };\n      api.setDisabled(!checkState());\n      editor.on('Undo Redo AddUndo TypingUndo ClearUndos SwitchMode', onUndoStateChange);\n      return function () {\n        return editor.off('Undo Redo AddUndo TypingUndo ClearUndos SwitchMode', onUndoStateChange);\n      };\n    };\n    var registerMenuItems$2 = function (editor) {\n      editor.ui.registry.addMenuItem('undo', {\n        text: 'Undo',\n        icon: 'undo',\n        shortcut: 'Meta+Z',\n        onSetup: function (api) {\n          return toggleUndoRedoState(api, editor, 'hasUndo');\n        },\n        onAction: function () {\n          return editor.execCommand('undo');\n        }\n      });\n      editor.ui.registry.addMenuItem('redo', {\n        text: 'Redo',\n        icon: 'redo',\n        shortcut: 'Meta+Y',\n        onSetup: function (api) {\n          return toggleUndoRedoState(api, editor, 'hasRedo');\n        },\n        onAction: function () {\n          return editor.execCommand('redo');\n        }\n      });\n    };\n    var registerButtons$3 = function (editor) {\n      editor.ui.registry.addButton('undo', {\n        tooltip: 'Undo',\n        icon: 'undo',\n        onSetup: function (api) {\n          return toggleUndoRedoState(api, editor, 'hasUndo');\n        },\n        onAction: function () {\n          return editor.execCommand('undo');\n        }\n      });\n      editor.ui.registry.addButton('redo', {\n        tooltip: 'Redo',\n        icon: 'redo',\n        onSetup: function (api) {\n          return toggleUndoRedoState(api, editor, 'hasRedo');\n        },\n        onAction: function () {\n          return editor.execCommand('redo');\n        }\n      });\n    };\n    var register$a = function (editor) {\n      registerMenuItems$2(editor);\n      registerButtons$3(editor);\n    };\n\n    var toggleVisualAidState = function (api, editor) {\n      api.setActive(editor.hasVisual);\n      var onVisualAid = function (e) {\n        api.setActive(e.hasVisual);\n      };\n      editor.on('VisualAid', onVisualAid);\n      return function () {\n        return editor.off('VisualAid', onVisualAid);\n      };\n    };\n    var registerMenuItems$3 = function (editor) {\n      editor.ui.registry.addToggleMenuItem('visualaid', {\n        text: 'Visual aids',\n        onSetup: function (api) {\n          return toggleVisualAidState(api, editor);\n        },\n        onAction: function () {\n          editor.execCommand('mceToggleVisualAid');\n        }\n      });\n    };\n    var registerToolbarButton = function (editor) {\n      editor.ui.registry.addButton('visualaid', {\n        tooltip: 'Visual aids',\n        text: 'Visual aids',\n        onAction: function () {\n          return editor.execCommand('mceToggleVisualAid');\n        }\n      });\n    };\n    var register$b = function (editor) {\n      registerToolbarButton(editor);\n      registerMenuItems$3(editor);\n    };\n\n    var setup$8 = function (editor, backstage) {\n      register$5(editor);\n      register$9(editor);\n      register$6(editor, backstage);\n      register$a(editor);\n      register$1(editor);\n      register$b(editor);\n      register$7(editor);\n      register$8(editor);\n    };\n\n    var nu$d = function (x, y) {\n      return {\n        anchor: 'makeshift',\n        x: x,\n        y: y\n      };\n    };\n    var transpose$1 = function (pos, dx, dy) {\n      return nu$d(pos.x + dx, pos.y + dy);\n    };\n    var isTouchEvent$1 = function (e) {\n      return e.type === 'longpress' || e.type.indexOf('touch') === 0;\n    };\n    var fromPageXY = function (e) {\n      if (isTouchEvent$1(e)) {\n        var touch = e.touches[0];\n        return nu$d(touch.pageX, touch.pageY);\n      } else {\n        return nu$d(e.pageX, e.pageY);\n      }\n    };\n    var fromClientXY = function (e) {\n      if (isTouchEvent$1(e)) {\n        var touch = e.touches[0];\n        return nu$d(touch.clientX, touch.clientY);\n      } else {\n        return nu$d(e.clientX, e.clientY);\n      }\n    };\n    var transposeContentAreaContainer = function (element, pos) {\n      var containerPos = global$5.DOM.getPos(element);\n      return transpose$1(pos, containerPos.x, containerPos.y);\n    };\n    var getPointAnchor = function (editor, e) {\n      if (e.type === 'contextmenu' || e.type === 'longpress') {\n        if (editor.inline) {\n          return fromPageXY(e);\n        } else {\n          return transposeContentAreaContainer(editor.getContentAreaContainer(), fromClientXY(e));\n        }\n      } else {\n        return getSelectionAnchor(editor);\n      }\n    };\n    var getSelectionAnchor = function (editor) {\n      return {\n        anchor: 'selection',\n        root: SugarElement.fromDom(editor.selection.getNode())\n      };\n    };\n    var getNodeAnchor$1 = function (editor) {\n      return {\n        anchor: 'node',\n        node: Optional.some(SugarElement.fromDom(editor.selection.getNode())),\n        root: SugarElement.fromDom(editor.getBody())\n      };\n    };\n\n    var initAndShow = function (editor, e, buildMenu, backstage, contextmenu, useNodeAnchor) {\n      var items = buildMenu();\n      var anchorSpec = useNodeAnchor ? getNodeAnchor$1(editor) : getPointAnchor(editor, e);\n      build$2(items, ItemResponse$1.CLOSE_ON_EXECUTE, backstage, false).map(function (menuData) {\n        e.preventDefault();\n        InlineView.showMenuAt(contextmenu, anchorSpec, {\n          menu: { markers: markers$1('normal') },\n          data: menuData\n        });\n      });\n    };\n\n    var layouts = {\n      onLtr: function () {\n        return [\n          south$1,\n          southeast$1,\n          southwest$1,\n          northeast$1,\n          northwest$1,\n          north$1,\n          north$3,\n          south$3,\n          northeast$3,\n          southeast$3,\n          northwest$3,\n          southwest$3\n        ];\n      },\n      onRtl: function () {\n        return [\n          south$1,\n          southwest$1,\n          southeast$1,\n          northwest$1,\n          northeast$1,\n          north$1,\n          north$3,\n          south$3,\n          northwest$3,\n          southwest$3,\n          northeast$3,\n          southeast$3\n        ];\n      }\n    };\n    var bubbleSize$1 = 12;\n    var bubbleAlignments$2 = {\n      valignCentre: [],\n      alignCentre: [],\n      alignLeft: ['tox-pop--align-left'],\n      alignRight: ['tox-pop--align-right'],\n      right: ['tox-pop--right'],\n      left: ['tox-pop--left'],\n      bottom: ['tox-pop--bottom'],\n      top: ['tox-pop--top']\n    };\n    var isTouchWithinSelection = function (editor, e) {\n      var selection = editor.selection;\n      if (selection.isCollapsed() || e.touches.length < 1) {\n        return false;\n      } else {\n        var touch_1 = e.touches[0];\n        var rng = selection.getRng();\n        var rngRectOpt = getFirstRect$1(editor.getWin(), SimSelection.domRange(rng));\n        return rngRectOpt.exists(function (rngRect) {\n          return rngRect.left <= touch_1.clientX && rngRect.right >= touch_1.clientX && rngRect.top <= touch_1.clientY && rngRect.bottom >= touch_1.clientY;\n        });\n      }\n    };\n    var getPointAnchorSpec = function (editor, e) {\n      return __assign({\n        bubble: nu$8(0, bubbleSize$1, bubbleAlignments$2),\n        layouts: layouts,\n        overrides: {\n          maxWidthFunction: expandable$1(),\n          maxHeightFunction: expandable()\n        }\n      }, getPointAnchor(editor, e));\n    };\n    var setupiOSOverrides = function (editor) {\n      var originalSelection = editor.selection.getRng();\n      var selectionReset = function () {\n        global$2.setEditorTimeout(editor, function () {\n          editor.selection.setRng(originalSelection);\n        }, 10);\n        unbindEventListeners();\n      };\n      editor.once('touchend', selectionReset);\n      var preventMousedown = function (e) {\n        e.preventDefault();\n        e.stopImmediatePropagation();\n      };\n      editor.on('mousedown', preventMousedown, true);\n      var clearSelectionReset = function () {\n        return unbindEventListeners();\n      };\n      editor.once('longpresscancel', clearSelectionReset);\n      var unbindEventListeners = function () {\n        editor.off('touchend', selectionReset);\n        editor.off('longpresscancel', clearSelectionReset);\n        editor.off('mousedown', preventMousedown);\n      };\n    };\n    var show = function (editor, e, items, backstage, contextmenu, useNodeAnchor, highlightImmediately) {\n      var anchorSpec = useNodeAnchor ? getNodeAnchor$1(editor) : getPointAnchorSpec(editor, e);\n      build$2(items, ItemResponse$1.CLOSE_ON_EXECUTE, backstage, true).map(function (menuData) {\n        e.preventDefault();\n        InlineView.showMenuWithinBounds(contextmenu, anchorSpec, {\n          menu: {\n            markers: markers$1('normal'),\n            highlightImmediately: highlightImmediately\n          },\n          data: menuData,\n          type: 'horizontal'\n        }, function () {\n          return Optional.some(getContextToolbarBounds(editor, backstage.shared));\n        });\n        editor.fire(hideContextToolbarEvent);\n      });\n    };\n    var initAndShow$1 = function (editor, e, buildMenu, backstage, contextmenu, useNodeAnchor) {\n      var detection = detect$3();\n      var isiOS = detection.os.isiOS();\n      var isOSX = detection.os.isOSX();\n      var isAndroid = detection.os.isAndroid();\n      var isTouch = detection.deviceType.isTouch();\n      var shouldHighlightImmediately = function () {\n        return !(isAndroid || isiOS || isOSX && isTouch);\n      };\n      var open = function () {\n        var items = buildMenu();\n        show(editor, e, items, backstage, contextmenu, useNodeAnchor, shouldHighlightImmediately());\n      };\n      if ((isOSX || isiOS) && !useNodeAnchor) {\n        var openiOS_1 = function () {\n          setupiOSOverrides(editor);\n          open();\n        };\n        if (isTouchWithinSelection(editor, e)) {\n          openiOS_1();\n        } else {\n          editor.once('selectionchange', openiOS_1);\n          editor.once('touchend', function () {\n            return editor.off('selectionchange', openiOS_1);\n          });\n        }\n      } else {\n        if (isAndroid && !useNodeAnchor) {\n          editor.selection.setCursorLocation(e.target, 0);\n        }\n        open();\n      }\n    };\n\n    var patchPipeConfig = function (config) {\n      return typeof config === 'string' ? config.split(/[ ,]/) : config;\n    };\n    var shouldNeverUseNative = function (editor) {\n      return editor.getParam('contextmenu_never_use_native', false, 'boolean');\n    };\n    var getMenuItems = function (editor, name, defaultItems) {\n      var contextMenus = editor.ui.registry.getAll().contextMenus;\n      return Optional.from(editor.getParam(name)).map(patchPipeConfig).getOrThunk(function () {\n        return filter(patchPipeConfig(defaultItems), function (item) {\n          return has(contextMenus, item);\n        });\n      });\n    };\n    var isContextMenuDisabled = function (editor) {\n      return editor.getParam('contextmenu') === false;\n    };\n    var getContextMenu = function (editor) {\n      return getMenuItems(editor, 'contextmenu', 'link linkchecker image imagetools table spellchecker configurepermanentpen');\n    };\n    var getAvoidOverlapSelector = function (editor) {\n      return editor.getParam('contextmenu_avoid_overlap', '', 'string');\n    };\n\n    var isSeparator$1 = function (item) {\n      return isString(item) ? item === '|' : item.type === 'separator';\n    };\n    var separator$3 = { type: 'separator' };\n    var makeContextItem = function (item) {\n      var commonMenuItem = function (item) {\n        return {\n          text: item.text,\n          icon: item.icon,\n          disabled: item.disabled,\n          shortcut: item.shortcut\n        };\n      };\n      if (isString(item)) {\n        return item;\n      } else {\n        switch (item.type) {\n        case 'separator':\n          return separator$3;\n        case 'submenu':\n          return __assign(__assign({ type: 'nestedmenuitem' }, commonMenuItem(item)), {\n            getSubmenuItems: function () {\n              var items = item.getSubmenuItems();\n              if (isString(items)) {\n                return items;\n              } else {\n                return map(items, makeContextItem);\n              }\n            }\n          });\n        default:\n          return __assign(__assign({ type: 'menuitem' }, commonMenuItem(item)), { onAction: noarg(item.onAction) });\n        }\n      }\n    };\n    var addContextMenuGroup = function (xs, groupItems) {\n      if (groupItems.length === 0) {\n        return xs;\n      }\n      var lastMenuItem = last(xs).filter(function (item) {\n        return !isSeparator$1(item);\n      });\n      var before = lastMenuItem.fold(function () {\n        return [];\n      }, function (_) {\n        return [separator$3];\n      });\n      return xs.concat(before).concat(groupItems).concat([separator$3]);\n    };\n    var generateContextMenu = function (contextMenus, menuConfig, selectedElement) {\n      var sections = foldl(menuConfig, function (acc, name) {\n        return get$1(contextMenus, name.toLowerCase()).map(function (menu) {\n          var items = menu.update(selectedElement);\n          if (isString(items)) {\n            return addContextMenuGroup(acc, items.split(' '));\n          } else if (items.length > 0) {\n            var allItems = map(items, makeContextItem);\n            return addContextMenuGroup(acc, allItems);\n          } else {\n            return acc;\n          }\n        }).getOrThunk(function () {\n          return acc.concat([name]);\n        });\n      }, []);\n      if (sections.length > 0 && isSeparator$1(sections[sections.length - 1])) {\n        sections.pop();\n      }\n      return sections;\n    };\n    var isNativeOverrideKeyEvent = function (editor, e) {\n      return e.ctrlKey && !shouldNeverUseNative(editor);\n    };\n    var isTriggeredByKeyboard = function (editor, e) {\n      return e.type !== 'longpress' && (e.button !== 2 || e.target === editor.getBody() && e.pointerType === '');\n    };\n    var getSelectedElement = function (editor, e) {\n      return isTriggeredByKeyboard(editor, e) ? editor.selection.getStart(true) : e.target;\n    };\n    var shouldUseNodeAnchor = function (editor, e) {\n      var selector = getAvoidOverlapSelector(editor);\n      if (isTriggeredByKeyboard(editor, e)) {\n        return true;\n      } else if (selector) {\n        var target = getSelectedElement(editor, e);\n        return closest$4(SugarElement.fromDom(target), selector);\n      } else {\n        return false;\n      }\n    };\n    var setup$9 = function (editor, lazySink, backstage) {\n      var detection = detect$3();\n      var isTouch = detection.deviceType.isTouch;\n      var contextmenu = build$1(InlineView.sketch({\n        dom: { tag: 'div' },\n        lazySink: lazySink,\n        onEscape: function () {\n          return editor.focus();\n        },\n        onShow: function () {\n          return backstage.setContextMenuState(true);\n        },\n        onHide: function () {\n          return backstage.setContextMenuState(false);\n        },\n        fireDismissalEventInstead: {},\n        inlineBehaviours: derive$1([config('dismissContextMenu', [run(dismissRequested(), function (comp, _se) {\n              Sandboxing.close(comp);\n              editor.focus();\n            })])])\n      }));\n      var hideContextMenu = function (_e) {\n        return InlineView.hide(contextmenu);\n      };\n      var showContextMenu = function (e) {\n        if (shouldNeverUseNative(editor)) {\n          e.preventDefault();\n        }\n        if (isNativeOverrideKeyEvent(editor, e) || isContextMenuDisabled(editor)) {\n          return;\n        }\n        var useNodeAnchor = shouldUseNodeAnchor(editor, e);\n        var buildMenu = function () {\n          var selectedElement = getSelectedElement(editor, e);\n          var registry = editor.ui.registry.getAll();\n          var menuConfig = getContextMenu(editor);\n          return generateContextMenu(registry.contextMenus, menuConfig, selectedElement);\n        };\n        var initAndShow$2 = isTouch() ? initAndShow$1 : initAndShow;\n        initAndShow$2(editor, e, buildMenu, backstage, contextmenu, useNodeAnchor);\n      };\n      editor.on('init', function () {\n        var hideEvents = 'ResizeEditor ScrollContent ScrollWindow longpresscancel' + (isTouch() ? '' : ' ResizeWindow');\n        editor.on(hideEvents, hideContextMenu);\n        editor.on('longpress contextmenu', showContextMenu);\n      });\n    };\n\n    var adt$c = Adt.generate([\n      {\n        offset: [\n          'x',\n          'y'\n        ]\n      },\n      {\n        absolute: [\n          'x',\n          'y'\n        ]\n      },\n      {\n        fixed: [\n          'x',\n          'y'\n        ]\n      }\n    ]);\n    var subtract = function (change) {\n      return function (point) {\n        return point.translate(-change.left, -change.top);\n      };\n    };\n    var add$4 = function (change) {\n      return function (point) {\n        return point.translate(change.left, change.top);\n      };\n    };\n    var transform$1 = function (changes) {\n      return function (x, y) {\n        return foldl(changes, function (rest, f) {\n          return f(rest);\n        }, SugarPosition(x, y));\n      };\n    };\n    var asFixed = function (coord, scroll, origin) {\n      return coord.fold(transform$1([\n        add$4(origin),\n        subtract(scroll)\n      ]), transform$1([subtract(scroll)]), transform$1([]));\n    };\n    var asAbsolute = function (coord, scroll, origin) {\n      return coord.fold(transform$1([add$4(origin)]), transform$1([]), transform$1([add$4(scroll)]));\n    };\n    var asOffset = function (coord, scroll, origin) {\n      return coord.fold(transform$1([]), transform$1([subtract(origin)]), transform$1([\n        add$4(scroll),\n        subtract(origin)\n      ]));\n    };\n    var withinRange = function (coord1, coord2, xRange, yRange, scroll, origin) {\n      var a1 = asAbsolute(coord1, scroll, origin);\n      var a2 = asAbsolute(coord2, scroll, origin);\n      return Math.abs(a1.left - a2.left) <= xRange && Math.abs(a1.top - a2.top) <= yRange;\n    };\n    var getDeltas = function (coord1, coord2, xRange, yRange, scroll, origin) {\n      var a1 = asAbsolute(coord1, scroll, origin);\n      var a2 = asAbsolute(coord2, scroll, origin);\n      var left = Math.abs(a1.left - a2.left);\n      var top = Math.abs(a1.top - a2.top);\n      return SugarPosition(left, top);\n    };\n    var toStyles = function (coord, scroll, origin) {\n      var stylesOpt = coord.fold(function (x, y) {\n        return {\n          position: Optional.some('absolute'),\n          left: Optional.some(x + 'px'),\n          top: Optional.some(y + 'px')\n        };\n      }, function (x, y) {\n        return {\n          position: Optional.some('absolute'),\n          left: Optional.some(x - origin.left + 'px'),\n          top: Optional.some(y - origin.top + 'px')\n        };\n      }, function (x, y) {\n        return {\n          position: Optional.some('fixed'),\n          left: Optional.some(x + 'px'),\n          top: Optional.some(y + 'px')\n        };\n      });\n      return __assign({\n        right: Optional.none(),\n        bottom: Optional.none()\n      }, stylesOpt);\n    };\n    var translate$2 = function (coord, deltaX, deltaY) {\n      return coord.fold(function (x, y) {\n        return offset(x + deltaX, y + deltaY);\n      }, function (x, y) {\n        return absolute$3(x + deltaX, y + deltaY);\n      }, function (x, y) {\n        return fixed$1(x + deltaX, y + deltaY);\n      });\n    };\n    var absorb = function (partialCoord, originalCoord, scroll, origin) {\n      var absorbOne = function (stencil, nu) {\n        return function (optX, optY) {\n          var original = stencil(originalCoord, scroll, origin);\n          return nu(optX.getOr(original.left), optY.getOr(original.top));\n        };\n      };\n      return partialCoord.fold(absorbOne(asOffset, offset), absorbOne(asAbsolute, absolute$3), absorbOne(asFixed, fixed$1));\n    };\n    var offset = adt$c.offset;\n    var absolute$3 = adt$c.absolute;\n    var fixed$1 = adt$c.fixed;\n\n    var parseAttrToInt = function (element, name) {\n      var value = get$3(element, name);\n      return isUndefined(value) ? NaN : parseInt(value, 10);\n    };\n    var get$f = function (component, snapsInfo) {\n      var element = component.element;\n      var x = parseAttrToInt(element, snapsInfo.leftAttr);\n      var y = parseAttrToInt(element, snapsInfo.topAttr);\n      return isNaN(x) || isNaN(y) ? Optional.none() : Optional.some(SugarPosition(x, y));\n    };\n    var set$8 = function (component, snapsInfo, pt) {\n      var element = component.element;\n      set$1(element, snapsInfo.leftAttr, pt.left + 'px');\n      set$1(element, snapsInfo.topAttr, pt.top + 'px');\n    };\n    var clear = function (component, snapsInfo) {\n      var element = component.element;\n      remove$1(element, snapsInfo.leftAttr);\n      remove$1(element, snapsInfo.topAttr);\n    };\n\n    var getCoords = function (component, snapInfo, coord, delta) {\n      return get$f(component, snapInfo).fold(function () {\n        return coord;\n      }, function (fixed) {\n        return fixed$1(fixed.left + delta.left, fixed.top + delta.top);\n      });\n    };\n    var moveOrSnap = function (component, snapInfo, coord, delta, scroll, origin) {\n      var newCoord = getCoords(component, snapInfo, coord, delta);\n      var snap = snapInfo.mustSnap ? findClosestSnap(component, snapInfo, newCoord, scroll, origin) : findSnap(component, snapInfo, newCoord, scroll, origin);\n      var fixedCoord = asFixed(newCoord, scroll, origin);\n      set$8(component, snapInfo, fixedCoord);\n      return snap.fold(function () {\n        return {\n          coord: fixed$1(fixedCoord.left, fixedCoord.top),\n          extra: Optional.none()\n        };\n      }, function (spanned) {\n        return {\n          coord: spanned.output,\n          extra: spanned.extra\n        };\n      });\n    };\n    var stopDrag = function (component, snapInfo) {\n      clear(component, snapInfo);\n    };\n    var findMatchingSnap = function (snaps, newCoord, scroll, origin) {\n      return findMap(snaps, function (snap) {\n        var sensor = snap.sensor;\n        var inRange = withinRange(newCoord, sensor, snap.range.left, snap.range.top, scroll, origin);\n        return inRange ? Optional.some({\n          output: absorb(snap.output, newCoord, scroll, origin),\n          extra: snap.extra\n        }) : Optional.none();\n      });\n    };\n    var findClosestSnap = function (component, snapInfo, newCoord, scroll, origin) {\n      var snaps = snapInfo.getSnapPoints(component);\n      var matchSnap = findMatchingSnap(snaps, newCoord, scroll, origin);\n      return matchSnap.orThunk(function () {\n        var bestSnap = foldl(snaps, function (acc, snap) {\n          var sensor = snap.sensor;\n          var deltas = getDeltas(newCoord, sensor, snap.range.left, snap.range.top, scroll, origin);\n          return acc.deltas.fold(function () {\n            return {\n              deltas: Optional.some(deltas),\n              snap: Optional.some(snap)\n            };\n          }, function (bestDeltas) {\n            var currAvg = (deltas.left + deltas.top) / 2;\n            var bestAvg = (bestDeltas.left + bestDeltas.top) / 2;\n            if (currAvg <= bestAvg) {\n              return {\n                deltas: Optional.some(deltas),\n                snap: Optional.some(snap)\n              };\n            } else {\n              return acc;\n            }\n          });\n        }, {\n          deltas: Optional.none(),\n          snap: Optional.none()\n        });\n        return bestSnap.snap.map(function (snap) {\n          return {\n            output: absorb(snap.output, newCoord, scroll, origin),\n            extra: snap.extra\n          };\n        });\n      });\n    };\n    var findSnap = function (component, snapInfo, newCoord, scroll, origin) {\n      var snaps = snapInfo.getSnapPoints(component);\n      return findMatchingSnap(snaps, newCoord, scroll, origin);\n    };\n    var snapTo = function (snap, scroll, origin) {\n      return {\n        coord: absorb(snap.output, snap.output, scroll, origin),\n        extra: snap.extra\n      };\n    };\n\n    var snapTo$1 = function (component, dragConfig, _state, snap) {\n      var target = dragConfig.getTarget(component.element);\n      if (dragConfig.repositionTarget) {\n        var doc = owner(component.element);\n        var scroll_1 = get$9(doc);\n        var origin_1 = getOrigin(target);\n        var snapPin = snapTo(snap, scroll_1, origin_1);\n        var styles = toStyles(snapPin.coord, scroll_1, origin_1);\n        setOptions(target, styles);\n      }\n    };\n\n    var DraggingApis = /*#__PURE__*/Object.freeze({\n        __proto__: null,\n        snapTo: snapTo$1\n    });\n\n    var initialAttribute = 'data-initial-z-index';\n    var resetZIndex = function (blocker) {\n      parent(blocker.element).filter(isElement).each(function (root) {\n        getOpt(root, initialAttribute).fold(function () {\n          return remove$6(root, 'z-index');\n        }, function (zIndex) {\n          return set$2(root, 'z-index', zIndex);\n        });\n        remove$1(root, initialAttribute);\n      });\n    };\n    var changeZIndex = function (blocker) {\n      parent(blocker.element).filter(isElement).each(function (root) {\n        getRaw(root, 'z-index').each(function (zindex) {\n          set$1(root, initialAttribute, zindex);\n        });\n        set$2(root, 'z-index', get$5(blocker.element, 'z-index'));\n      });\n    };\n    var instigate = function (anyComponent, blocker) {\n      anyComponent.getSystem().addToGui(blocker);\n      changeZIndex(blocker);\n    };\n    var discard = function (blocker) {\n      resetZIndex(blocker);\n      blocker.getSystem().removeFromGui(blocker);\n    };\n    var createComponent = function (component, blockerClass, blockerEvents) {\n      return component.getSystem().build(Container.sketch({\n        dom: {\n          styles: {\n            'left': '0px',\n            'top': '0px',\n            'width': '100%',\n            'height': '100%',\n            'position': 'fixed',\n            'z-index': '1000000000000000'\n          },\n          classes: [blockerClass]\n        },\n        events: blockerEvents\n      }));\n    };\n\n    var SnapSchema = optionObjOf('snaps', [\n      strict$1('getSnapPoints'),\n      onHandler('onSensor'),\n      strict$1('leftAttr'),\n      strict$1('topAttr'),\n      defaulted$1('lazyViewport', win),\n      defaulted$1('mustSnap', false)\n    ]);\n\n    var schema$t = [\n      defaulted$1('useFixed', never),\n      strict$1('blockerClass'),\n      defaulted$1('getTarget', identity),\n      defaulted$1('onDrag', noop),\n      defaulted$1('repositionTarget', true),\n      defaulted$1('onDrop', noop),\n      defaultedFunction('getBounds', win),\n      SnapSchema\n    ];\n\n    var getCurrentCoord = function (target) {\n      return lift3(getRaw(target, 'left'), getRaw(target, 'top'), getRaw(target, 'position'), function (left, top, position) {\n        var nu = position === 'fixed' ? fixed$1 : offset;\n        return nu(parseInt(left, 10), parseInt(top, 10));\n      }).getOrThunk(function () {\n        var location = absolute(target);\n        return absolute$3(location.left, location.top);\n      });\n    };\n    var clampCoords = function (component, coords, scroll, origin, startData) {\n      var bounds = startData.bounds;\n      var absoluteCoord = asAbsolute(coords, scroll, origin);\n      var newX = clamp(absoluteCoord.left, bounds.x, bounds.x + bounds.width - startData.width);\n      var newY = clamp(absoluteCoord.top, bounds.y, bounds.y + bounds.height - startData.height);\n      var newCoords = absolute$3(newX, newY);\n      return coords.fold(function () {\n        var offset$1 = asOffset(newCoords, scroll, origin);\n        return offset(offset$1.left, offset$1.top);\n      }, function () {\n        return newCoords;\n      }, function () {\n        var fixed = asFixed(newCoords, scroll, origin);\n        return fixed$1(fixed.left, fixed.top);\n      });\n    };\n    var calcNewCoord = function (component, optSnaps, currentCoord, scroll, origin, delta, startData) {\n      var newCoord = optSnaps.fold(function () {\n        var translated = translate$2(currentCoord, delta.left, delta.top);\n        var fixedCoord = asFixed(translated, scroll, origin);\n        return fixed$1(fixedCoord.left, fixedCoord.top);\n      }, function (snapInfo) {\n        var snapping = moveOrSnap(component, snapInfo, currentCoord, delta, scroll, origin);\n        snapping.extra.each(function (extra) {\n          snapInfo.onSensor(component, extra);\n        });\n        return snapping.coord;\n      });\n      return clampCoords(component, newCoord, scroll, origin, startData);\n    };\n    var dragBy = function (component, dragConfig, startData, delta) {\n      var target = dragConfig.getTarget(component.element);\n      if (dragConfig.repositionTarget) {\n        var doc = owner(component.element);\n        var scroll_1 = get$9(doc);\n        var origin_1 = getOrigin(target);\n        var currentCoord = getCurrentCoord(target);\n        var newCoord = calcNewCoord(component, dragConfig.snaps, currentCoord, scroll_1, origin_1, delta, startData);\n        var styles = toStyles(newCoord, scroll_1, origin_1);\n        setOptions(target, styles);\n      }\n      dragConfig.onDrag(component, target, delta);\n    };\n\n    var calcStartData = function (dragConfig, comp) {\n      return {\n        bounds: dragConfig.getBounds(),\n        height: getOuter$1(comp.element),\n        width: getOuter$2(comp.element)\n      };\n    };\n    var move$1 = function (component, dragConfig, dragState, dragMode, event) {\n      var delta = dragState.update(dragMode, event);\n      var dragStartData = dragState.getStartData().getOrThunk(function () {\n        return calcStartData(dragConfig, component);\n      });\n      delta.each(function (dlt) {\n        dragBy(component, dragConfig, dragStartData, dlt);\n      });\n    };\n    var stop = function (component, blocker, dragConfig, dragState) {\n      blocker.each(discard);\n      dragConfig.snaps.each(function (snapInfo) {\n        stopDrag(component, snapInfo);\n      });\n      var target = dragConfig.getTarget(component.element);\n      dragState.reset();\n      dragConfig.onDrop(component, target);\n    };\n    var handlers = function (events) {\n      return function (dragConfig, dragState) {\n        var updateStartState = function (comp) {\n          dragState.setStartData(calcStartData(dragConfig, comp));\n        };\n        return derive(__spreadArrays([run(windowScroll(), function (comp) {\n            dragState.getStartData().each(function () {\n              return updateStartState(comp);\n            });\n          })], events(dragConfig, dragState, updateStartState)));\n      };\n    };\n\n    var init$c = function (dragApi) {\n      return derive([\n        run(mousedown(), dragApi.forceDrop),\n        run(mouseup(), dragApi.drop),\n        run(mousemove(), function (comp, simulatedEvent) {\n          dragApi.move(simulatedEvent.event);\n        }),\n        run(mouseout(), dragApi.delayDrop)\n      ]);\n    };\n\n    var getData$1 = function (event) {\n      return Optional.from(SugarPosition(event.x, event.y));\n    };\n    var getDelta$1 = function (old, nu) {\n      return SugarPosition(nu.left - old.left, nu.top - old.top);\n    };\n\n    var MouseData = /*#__PURE__*/Object.freeze({\n        __proto__: null,\n        getData: getData$1,\n        getDelta: getDelta$1\n    });\n\n    var events$g = function (dragConfig, dragState, updateStartState) {\n      return [run(mousedown(), function (component, simulatedEvent) {\n          var raw = simulatedEvent.event.raw;\n          if (raw.button !== 0) {\n            return;\n          }\n          simulatedEvent.stop();\n          var stop$1 = function () {\n            return stop(component, Optional.some(blocker), dragConfig, dragState);\n          };\n          var delayDrop = DelayedFunction(stop$1, 200);\n          var dragApi = {\n            drop: stop$1,\n            delayDrop: delayDrop.schedule,\n            forceDrop: stop$1,\n            move: function (event) {\n              delayDrop.cancel();\n              move$1(component, dragConfig, dragState, MouseData, event);\n            }\n          };\n          var blocker = createComponent(component, dragConfig.blockerClass, init$c(dragApi));\n          var start = function () {\n            updateStartState(component);\n            instigate(component, blocker);\n          };\n          start();\n        })];\n    };\n    var schema$u = __spreadArrays(schema$t, [output('dragger', { handlers: handlers(events$g) })]);\n\n    var init$d = function (dragApi) {\n      return derive([\n        run(touchstart(), dragApi.forceDrop),\n        run(touchend(), dragApi.drop),\n        run(touchcancel(), dragApi.drop),\n        run(touchmove(), function (comp, simulatedEvent) {\n          dragApi.move(simulatedEvent.event);\n        })\n      ]);\n    };\n\n    var getDataFrom = function (touches) {\n      var touch = touches[0];\n      return Optional.some(SugarPosition(touch.clientX, touch.clientY));\n    };\n    var getData$2 = function (event) {\n      var raw = event.raw;\n      var touches = raw.touches;\n      return touches.length === 1 ? getDataFrom(touches) : Optional.none();\n    };\n    var getDelta$2 = function (old, nu) {\n      return SugarPosition(nu.left - old.left, nu.top - old.top);\n    };\n\n    var TouchData = /*#__PURE__*/Object.freeze({\n        __proto__: null,\n        getData: getData$2,\n        getDelta: getDelta$2\n    });\n\n    var events$h = function (dragConfig, dragState, updateStartState) {\n      var blockerCell = Cell(Optional.none());\n      return [\n        run(touchstart(), function (component, simulatedEvent) {\n          simulatedEvent.stop();\n          var stop$1 = function () {\n            stop(component, blockerCell.get(), dragConfig, dragState);\n            blockerCell.set(Optional.none());\n          };\n          var dragApi = {\n            drop: stop$1,\n            delayDrop: noop,\n            forceDrop: stop$1,\n            move: function (event) {\n              move$1(component, dragConfig, dragState, TouchData, event);\n            }\n          };\n          var blocker = createComponent(component, dragConfig.blockerClass, init$d(dragApi));\n          blockerCell.set(Optional.some(blocker));\n          var start = function () {\n            updateStartState(component);\n            instigate(component, blocker);\n          };\n          start();\n        }),\n        run(touchmove(), function (component, simulatedEvent) {\n          simulatedEvent.stop();\n          move$1(component, dragConfig, dragState, TouchData, simulatedEvent.event);\n        }),\n        run(touchend(), function (component, simulatedEvent) {\n          simulatedEvent.stop();\n          stop(component, blockerCell.get(), dragConfig, dragState);\n          blockerCell.set(Optional.none());\n        }),\n        run(touchcancel(), function (component) {\n          stop(component, blockerCell.get(), dragConfig, dragState);\n          blockerCell.set(Optional.none());\n        })\n      ];\n    };\n    var schema$v = __spreadArrays(schema$t, [output('dragger', { handlers: handlers(events$h) })]);\n\n    var events$i = function (dragConfig, dragState, updateStartState) {\n      return __spreadArrays(events$g(dragConfig, dragState, updateStartState), events$h(dragConfig, dragState, updateStartState));\n    };\n    var schema$w = __spreadArrays(schema$t, [output('dragger', { handlers: handlers(events$i) })]);\n\n    var mouse = schema$u;\n    var touch = schema$v;\n    var mouseOrTouch = schema$w;\n\n    var DraggingBranches = /*#__PURE__*/Object.freeze({\n        __proto__: null,\n        mouse: mouse,\n        touch: touch,\n        mouseOrTouch: mouseOrTouch\n    });\n\n    var init$e = function () {\n      var previous = Optional.none();\n      var startData = Optional.none();\n      var reset = function () {\n        previous = Optional.none();\n        startData = Optional.none();\n      };\n      var calculateDelta = function (mode, nu) {\n        var result = previous.map(function (old) {\n          return mode.getDelta(old, nu);\n        });\n        previous = Optional.some(nu);\n        return result;\n      };\n      var update = function (mode, dragEvent) {\n        return mode.getData(dragEvent).bind(function (nuData) {\n          return calculateDelta(mode, nuData);\n        });\n      };\n      var setStartData = function (data) {\n        startData = Optional.some(data);\n      };\n      var getStartData = function () {\n        return startData;\n      };\n      var readState = constant({});\n      return nu$5({\n        readState: readState,\n        reset: reset,\n        update: update,\n        getStartData: getStartData,\n        setStartData: setStartData\n      });\n    };\n\n    var DragState = /*#__PURE__*/Object.freeze({\n        __proto__: null,\n        init: init$e\n    });\n\n    var Dragging = createModes$1({\n      branchKey: 'mode',\n      branches: DraggingBranches,\n      name: 'dragging',\n      active: {\n        events: function (dragConfig, dragState) {\n          var dragger = dragConfig.dragger;\n          return dragger.handlers(dragConfig, dragState);\n        }\n      },\n      extra: {\n        snap: function (sConfig) {\n          return {\n            sensor: sConfig.sensor,\n            range: sConfig.range,\n            output: sConfig.output,\n            extra: Optional.from(sConfig.extra)\n          };\n        }\n      },\n      state: DragState,\n      apis: DraggingApis\n    });\n\n    var snapWidth = 40;\n    var snapOffset = snapWidth / 2;\n    var calcSnap = function (selectorOpt, td, x, y, width, height) {\n      return selectorOpt.fold(function () {\n        return Dragging.snap({\n          sensor: absolute$3(x - snapOffset, y - snapOffset),\n          range: SugarPosition(width, height),\n          output: absolute$3(Optional.some(x), Optional.some(y)),\n          extra: { td: td }\n        });\n      }, function (selectorHandle) {\n        var sensorLeft = x - snapOffset;\n        var sensorTop = y - snapOffset;\n        var sensorWidth = snapWidth;\n        var sensorHeight = snapWidth;\n        var rect = selectorHandle.element.dom.getBoundingClientRect();\n        return Dragging.snap({\n          sensor: absolute$3(sensorLeft, sensorTop),\n          range: SugarPosition(sensorWidth, sensorHeight),\n          output: absolute$3(Optional.some(x - rect.width / 2), Optional.some(y - rect.height / 2)),\n          extra: { td: td }\n        });\n      });\n    };\n    var getSnapsConfig = function (getSnapPoints, cell, onChange) {\n      var isSameCell = function (cellOpt, td) {\n        return cellOpt.exists(function (currentTd) {\n          return eq$1(currentTd, td);\n        });\n      };\n      return {\n        getSnapPoints: getSnapPoints,\n        leftAttr: 'data-drag-left',\n        topAttr: 'data-drag-top',\n        onSensor: function (component, extra) {\n          var td = extra.td;\n          if (!isSameCell(cell.get(), td)) {\n            cell.set(Optional.some(td));\n            onChange(td);\n          }\n        },\n        mustSnap: true\n      };\n    };\n    var createSelector = function (snaps) {\n      return record(Button.sketch({\n        dom: {\n          tag: 'div',\n          classes: ['tox-selector']\n        },\n        buttonBehaviours: derive$1([\n          Dragging.config({\n            mode: 'mouseOrTouch',\n            blockerClass: 'blocker',\n            snaps: snaps\n          }),\n          Unselecting.config({})\n        ]),\n        eventOrder: {\n          mousedown: [\n            'dragging',\n            'alloy.base.behaviour'\n          ],\n          touchstart: [\n            'dragging',\n            'alloy.base.behaviour'\n          ]\n        }\n      }));\n    };\n    var setup$a = function (editor, sink) {\n      var tlTds = Cell([]);\n      var brTds = Cell([]);\n      var isVisible = Cell(false);\n      var startCell = Cell(Optional.none());\n      var finishCell = Cell(Optional.none());\n      var getTopLeftSnap = function (td) {\n        var box = absolute$1(td);\n        return calcSnap(memTopLeft.getOpt(sink), td, box.x, box.y, box.width, box.height);\n      };\n      var getTopLeftSnaps = function () {\n        return map(tlTds.get(), function (td) {\n          return getTopLeftSnap(td);\n        });\n      };\n      var getBottomRightSnap = function (td) {\n        var box = absolute$1(td);\n        return calcSnap(memBottomRight.getOpt(sink), td, box.right, box.bottom, box.width, box.height);\n      };\n      var getBottomRightSnaps = function () {\n        return map(brTds.get(), function (td) {\n          return getBottomRightSnap(td);\n        });\n      };\n      var topLeftSnaps = getSnapsConfig(getTopLeftSnaps, startCell, function (start) {\n        finishCell.get().each(function (finish) {\n          editor.fire('TableSelectorChange', {\n            start: start,\n            finish: finish\n          });\n        });\n      });\n      var bottomRightSnaps = getSnapsConfig(getBottomRightSnaps, finishCell, function (finish) {\n        startCell.get().each(function (start) {\n          editor.fire('TableSelectorChange', {\n            start: start,\n            finish: finish\n          });\n        });\n      });\n      var memTopLeft = createSelector(topLeftSnaps);\n      var memBottomRight = createSelector(bottomRightSnaps);\n      var topLeft = build$1(memTopLeft.asSpec());\n      var bottomRight = build$1(memBottomRight.asSpec());\n      var showOrHideHandle = function (selector, cell, isAbove, isBelow) {\n        var cellRect = cell.dom.getBoundingClientRect();\n        remove$6(selector.element, 'display');\n        var viewportHeight = defaultView(SugarElement.fromDom(editor.getBody())).dom.innerHeight;\n        var aboveViewport = isAbove(cellRect);\n        var belowViewport = isBelow(cellRect, viewportHeight);\n        if (aboveViewport || belowViewport) {\n          set$2(selector.element, 'display', 'none');\n        }\n      };\n      var snapTo = function (selector, cell, getSnapConfig, pos) {\n        var snap = getSnapConfig(cell);\n        Dragging.snapTo(selector, snap);\n        var isAbove = function (rect) {\n          return rect[pos] < 0;\n        };\n        var isBelow = function (rect, viewportHeight) {\n          return rect[pos] > viewportHeight;\n        };\n        showOrHideHandle(selector, cell, isAbove, isBelow);\n      };\n      var snapTopLeft = function (cell) {\n        return snapTo(topLeft, cell, getTopLeftSnap, 'top');\n      };\n      var snapLastTopLeft = function () {\n        return startCell.get().each(snapTopLeft);\n      };\n      var snapBottomRight = function (cell) {\n        return snapTo(bottomRight, cell, getBottomRightSnap, 'bottom');\n      };\n      var snapLastBottomRight = function () {\n        return finishCell.get().each(snapBottomRight);\n      };\n      if (detect$3().deviceType.isTouch()) {\n        editor.on('TableSelectionChange', function (e) {\n          if (!isVisible.get()) {\n            attach$1(sink, topLeft);\n            attach$1(sink, bottomRight);\n            isVisible.set(true);\n          }\n          startCell.set(Optional.some(e.start));\n          finishCell.set(Optional.some(e.finish));\n          e.otherCells.each(function (otherCells) {\n            tlTds.set(otherCells.upOrLeftCells);\n            brTds.set(otherCells.downOrRightCells);\n            snapTopLeft(e.start);\n            snapBottomRight(e.finish);\n          });\n        });\n        editor.on('ResizeEditor ResizeWindow ScrollContent', function () {\n          snapLastTopLeft();\n          snapLastBottomRight();\n        });\n        editor.on('TableSelectionClear', function () {\n          if (isVisible.get()) {\n            detach(topLeft);\n            detach(bottomRight);\n            isVisible.set(false);\n          }\n          startCell.set(Optional.none());\n          finishCell.set(Optional.none());\n        });\n      }\n    };\n\n    var isHidden$1 = function (elm) {\n      if (elm.nodeType === 1) {\n        if (elm.nodeName === 'BR' || !!elm.getAttribute('data-mce-bogus')) {\n          return true;\n        }\n        if (elm.getAttribute('data-mce-type') === 'bookmark') {\n          return true;\n        }\n      }\n      return false;\n    };\n    var renderElementPath = function (editor, settings, providersBackstage) {\n      if (!settings.delimiter) {\n        settings.delimiter = '\\xBB';\n      }\n      var getDataPath = function (data) {\n        var parts = data || [];\n        var newPathElements = map(parts, function (part, index) {\n          return Button.sketch({\n            dom: {\n              tag: 'div',\n              classes: ['tox-statusbar__path-item'],\n              attributes: {\n                'role': 'button',\n                'data-index': index,\n                'tab-index': -1,\n                'aria-level': index + 1\n              },\n              innerHtml: part.name\n            },\n            action: function (_btn) {\n              editor.focus();\n              editor.selection.select(part.element);\n              editor.nodeChanged();\n            },\n            buttonBehaviours: derive$1([\n              DisablingConfigs.button(providersBackstage.isDisabled),\n              receivingConfig()\n            ])\n          });\n        });\n        var divider = {\n          dom: {\n            tag: 'div',\n            classes: ['tox-statusbar__path-divider'],\n            attributes: { 'aria-hidden': true },\n            innerHtml: ' ' + settings.delimiter + ' '\n          }\n        };\n        return foldl(newPathElements.slice(1), function (acc, element) {\n          var newAcc = acc;\n          newAcc.push(divider);\n          newAcc.push(element);\n          return newAcc;\n        }, [newPathElements[0]]);\n      };\n      var updatePath = function (parents) {\n        var newPath = [];\n        var i = parents.length;\n        while (i-- > 0) {\n          var parent_1 = parents[i];\n          if (parent_1.nodeType === 1 && !isHidden$1(parent_1)) {\n            var args = editor.fire('ResolveName', {\n              name: parent_1.nodeName.toLowerCase(),\n              target: parent_1\n            });\n            if (!args.isDefaultPrevented()) {\n              newPath.push({\n                name: args.name,\n                element: parent_1\n              });\n            }\n            if (args.isPropagationStopped()) {\n              break;\n            }\n          }\n        }\n        return newPath;\n      };\n      return {\n        dom: {\n          tag: 'div',\n          classes: ['tox-statusbar__path'],\n          attributes: { role: 'navigation' }\n        },\n        behaviours: derive$1([\n          Keying.config({\n            mode: 'flow',\n            selector: 'div[role=button]'\n          }),\n          Disabling.config({ disabled: providersBackstage.isDisabled }),\n          receivingConfig(),\n          Tabstopping.config({}),\n          Replacing.config({}),\n          config('elementPathEvents', [runOnAttached(function (comp, _e) {\n              editor.shortcuts.add('alt+F11', 'focus statusbar elementpath', function () {\n                return Keying.focusIn(comp);\n              });\n              editor.on('NodeChange', function (e) {\n                var newPath = updatePath(e.parents);\n                if (newPath.length > 0) {\n                  Replacing.set(comp, getDataPath(newPath));\n                } else {\n                  Replacing.set(comp, []);\n                }\n              });\n            })])\n        ]),\n        components: []\n      };\n    };\n\n    var ResizeTypes;\n    (function (ResizeTypes) {\n      ResizeTypes[ResizeTypes['None'] = 0] = 'None';\n      ResizeTypes[ResizeTypes['Both'] = 1] = 'Both';\n      ResizeTypes[ResizeTypes['Vertical'] = 2] = 'Vertical';\n    }(ResizeTypes || (ResizeTypes = {})));\n    var getDimensions = function (editor, deltas, resizeType, originalHeight, originalWidth) {\n      var dimensions = {};\n      dimensions.height = calcCappedSize(originalHeight + deltas.top, getMinHeightSetting(editor), getMaxHeightSetting(editor));\n      if (resizeType === ResizeTypes.Both) {\n        dimensions.width = calcCappedSize(originalWidth + deltas.left, getMinWidthSetting(editor), getMaxWidthSetting(editor));\n      }\n      return dimensions;\n    };\n    var resize$3 = function (editor, deltas, resizeType) {\n      var container = SugarElement.fromDom(editor.getContainer());\n      var dimensions = getDimensions(editor, deltas, resizeType, get$7(container), get$8(container));\n      each$1(dimensions, function (val, dim) {\n        return set$2(container, dim, numToPx(val));\n      });\n      fireResizeEditor(editor);\n    };\n\n    var getResizeType = function (editor) {\n      var fallback = !editor.hasPlugin('autoresize');\n      var resize = editor.getParam('resize', fallback);\n      if (resize === false) {\n        return ResizeTypes.None;\n      } else if (resize === 'both') {\n        return ResizeTypes.Both;\n      } else {\n        return ResizeTypes.Vertical;\n      }\n    };\n    var keyboardHandler = function (editor, resizeType, x, y) {\n      var scale = 20;\n      var delta = SugarPosition(x * scale, y * scale);\n      resize$3(editor, delta, resizeType);\n      return Optional.some(true);\n    };\n    var renderResizeHandler = function (editor, providersBackstage) {\n      var resizeType = getResizeType(editor);\n      if (resizeType === ResizeTypes.None) {\n        return Optional.none();\n      }\n      return Optional.some({\n        dom: {\n          tag: 'div',\n          classes: ['tox-statusbar__resize-handle'],\n          attributes: { title: providersBackstage.translate('Resize') },\n          innerHtml: get$e('resize-handle', providersBackstage.icons)\n        },\n        behaviours: derive$1([\n          Dragging.config({\n            mode: 'mouse',\n            repositionTarget: false,\n            onDrag: function (_comp, _target, delta) {\n              return resize$3(editor, delta, resizeType);\n            },\n            blockerClass: 'tox-blocker'\n          }),\n          Keying.config({\n            mode: 'special',\n            onLeft: function () {\n              return keyboardHandler(editor, resizeType, -1, 0);\n            },\n            onRight: function () {\n              return keyboardHandler(editor, resizeType, 1, 0);\n            },\n            onUp: function () {\n              return keyboardHandler(editor, resizeType, 0, -1);\n            },\n            onDown: function () {\n              return keyboardHandler(editor, resizeType, 0, 1);\n            }\n          }),\n          Tabstopping.config({}),\n          Focusing.config({})\n        ])\n      });\n    };\n\n    var renderWordCount = function (editor, providersBackstage) {\n      var _a;\n      var replaceCountText = function (comp, count, mode) {\n        return Replacing.set(comp, [text(providersBackstage.translate([\n            '{0} ' + mode,\n            count[mode]\n          ]))]);\n      };\n      return Button.sketch({\n        dom: {\n          tag: 'button',\n          classes: ['tox-statusbar__wordcount']\n        },\n        components: [],\n        buttonBehaviours: derive$1([\n          DisablingConfigs.button(providersBackstage.isDisabled),\n          receivingConfig(),\n          Tabstopping.config({}),\n          Replacing.config({}),\n          Representing.config({\n            store: {\n              mode: 'memory',\n              initialValue: {\n                mode: 'words',\n                count: {\n                  words: 0,\n                  characters: 0\n                }\n              }\n            }\n          }),\n          config('wordcount-events', [\n            runOnExecute(function (comp) {\n              var currentVal = Representing.getValue(comp);\n              var newMode = currentVal.mode === 'words' ? 'characters' : 'words';\n              Representing.setValue(comp, {\n                mode: newMode,\n                count: currentVal.count\n              });\n              replaceCountText(comp, currentVal.count, newMode);\n            }),\n            runOnAttached(function (comp) {\n              editor.on('wordCountUpdate', function (e) {\n                var mode = Representing.getValue(comp).mode;\n                Representing.setValue(comp, {\n                  mode: mode,\n                  count: e.wordCount\n                });\n                replaceCountText(comp, e.wordCount, mode);\n              });\n            })\n          ])\n        ]),\n        eventOrder: (_a = {}, _a[execute()] = [\n          'disabling',\n          'alloy.base.behaviour',\n          'wordcount-events'\n        ], _a)\n      });\n    };\n\n    var renderStatusbar = function (editor, providersBackstage) {\n      var renderBranding = function () {\n        var label = global$6.translate([\n          'Powered by {0}',\n          'Tiny'\n        ]);\n        var linkHtml = '<a href=\"https://www.tiny.cloud/?utm_campaign=editor_referral&amp;utm_medium=poweredby&amp;utm_source=tinymce&amp;utm_content=v5\" rel=\"noopener\" target=\"_blank\" tabindex=\"-1\" aria-label=\"' + label + '\">' + label + '</a>';\n        return {\n          dom: {\n            tag: 'span',\n            classes: ['tox-statusbar__branding'],\n            innerHtml: linkHtml\n          }\n        };\n      };\n      var getTextComponents = function () {\n        var components = [];\n        if (editor.getParam('elementpath', true, 'boolean')) {\n          components.push(renderElementPath(editor, {}, providersBackstage));\n        }\n        if (editor.hasPlugin('wordcount')) {\n          components.push(renderWordCount(editor, providersBackstage));\n        }\n        if (editor.getParam('branding', true, 'boolean')) {\n          components.push(renderBranding());\n        }\n        if (components.length > 0) {\n          return [{\n              dom: {\n                tag: 'div',\n                classes: ['tox-statusbar__text-container']\n              },\n              components: components\n            }];\n        }\n        return [];\n      };\n      var getComponents = function () {\n        var components = getTextComponents();\n        var resizeHandler = renderResizeHandler(editor, providersBackstage);\n        return components.concat(resizeHandler.toArray());\n      };\n      return {\n        dom: {\n          tag: 'div',\n          classes: ['tox-statusbar']\n        },\n        components: getComponents()\n      };\n    };\n\n    var setup$b = function (editor) {\n      var _a;\n      var isInline = editor.inline;\n      var mode = isInline ? Inline : Iframe;\n      var header = isStickyToolbar(editor) ? StickyHeader : StaticHeader;\n      var lazyOuterContainer = Optional.none();\n      var platform = detect$3();\n      var isIE = platform.browser.isIE();\n      var platformClasses = isIE ? ['tox-platform-ie'] : [];\n      var isTouch = platform.deviceType.isTouch();\n      var touchPlatformClass = 'tox-platform-touch';\n      var deviceClasses = isTouch ? [touchPlatformClass] : [];\n      var isToolbarBottom = isToolbarLocationBottom(editor);\n      var uiContainer = getUiContainer(editor);\n      var dirAttributes = global$6.isRtl() ? { attributes: { dir: 'rtl' } } : {};\n      var verticalDirAttributes = { attributes: (_a = {}, _a[Attribute] = isToolbarBottom ? AttributeValue.BottomToTop : AttributeValue.TopToBottom, _a) };\n      var lazyHeader = function () {\n        return lazyOuterContainer.bind(OuterContainer.getHeader);\n      };\n      var isHeaderDocked = function () {\n        return header.isDocked(lazyHeader);\n      };\n      var resizeUiMothership = function () {\n        set$2(uiMothership.element, 'width', document.body.clientWidth + 'px');\n      };\n      var makeSinkDefinition = function () {\n        var isGridUiContainer = eq$1(body(), uiContainer) && get$5(uiContainer, 'display') === 'grid';\n        var sinkSpec = {\n          dom: __assign({\n            tag: 'div',\n            classes: [\n              'tox',\n              'tox-silver-sink',\n              'tox-tinymce-aux'\n            ].concat(platformClasses).concat(deviceClasses)\n          }, dirAttributes),\n          behaviours: derive$1([Positioning.config({\n              useFixed: function () {\n                return isHeaderDocked();\n              }\n            })])\n        };\n        var reactiveWidthSpec = {\n          dom: { styles: { width: document.body.clientWidth + 'px' } },\n          events: derive([run(windowResize(), resizeUiMothership)])\n        };\n        return deepMerge(sinkSpec, isGridUiContainer ? reactiveWidthSpec : {});\n      };\n      var sink = build$1(makeSinkDefinition());\n      var lazySink = function () {\n        return Result.value(sink);\n      };\n      var memAnchorBar = record({\n        dom: {\n          tag: 'div',\n          classes: ['tox-anchorbar']\n        }\n      });\n      var lazyAnchorBar = function () {\n        return lazyOuterContainer.bind(function (container) {\n          return memAnchorBar.getOpt(container);\n        }).getOrDie('Could not find a anchor bar element');\n      };\n      var lazyToolbar = function () {\n        return lazyOuterContainer.bind(function (container) {\n          return OuterContainer.getToolbar(container);\n        }).getOrDie('Could not find more toolbar element');\n      };\n      var lazyThrobber = function () {\n        return lazyOuterContainer.bind(function (container) {\n          return OuterContainer.getThrobber(container);\n        }).getOrDie('Could not find throbber element');\n      };\n      var backstage = init$8(sink, editor, lazyAnchorBar);\n      var partMenubar = OuterContainer.parts.menubar({\n        dom: {\n          tag: 'div',\n          classes: ['tox-menubar']\n        },\n        backstage: backstage,\n        onEscape: function () {\n          editor.focus();\n        }\n      });\n      var toolbarMode = getToolbarMode(editor);\n      var partToolbar = OuterContainer.parts.toolbar(__assign({\n        dom: {\n          tag: 'div',\n          classes: ['tox-toolbar']\n        },\n        getSink: lazySink,\n        providers: backstage.shared.providers,\n        onEscape: function () {\n          editor.focus();\n        },\n        type: toolbarMode,\n        lazyToolbar: lazyToolbar,\n        lazyHeader: function () {\n          return lazyHeader().getOrDie('Could not find header element');\n        }\n      }, verticalDirAttributes));\n      var partMultipleToolbar = OuterContainer.parts['multiple-toolbar']({\n        dom: {\n          tag: 'div',\n          classes: ['tox-toolbar-overlord']\n        },\n        providers: backstage.shared.providers,\n        onEscape: function () {\n          editor.focus();\n        },\n        type: toolbarMode\n      });\n      var partSocket = OuterContainer.parts.socket({\n        dom: {\n          tag: 'div',\n          classes: ['tox-edit-area']\n        }\n      });\n      var partSidebar = OuterContainer.parts.sidebar({\n        dom: {\n          tag: 'div',\n          classes: ['tox-sidebar']\n        }\n      });\n      var partThrobber = OuterContainer.parts.throbber({\n        dom: {\n          tag: 'div',\n          classes: ['tox-throbber']\n        },\n        backstage: backstage\n      });\n      var sb = editor.getParam('statusbar', true, 'boolean');\n      var statusbar = sb && !isInline ? Optional.some(renderStatusbar(editor, backstage.shared.providers)) : Optional.none();\n      var socketSidebarContainer = {\n        dom: {\n          tag: 'div',\n          classes: ['tox-sidebar-wrap']\n        },\n        components: [\n          partSocket,\n          partSidebar\n        ]\n      };\n      var hasMultipleToolbar = isMultipleToolbars(editor);\n      var hasToolbar = isToolbarEnabled(editor);\n      var hasMenubar = isMenubarEnabled(editor);\n      var getPartToolbar = function () {\n        if (hasMultipleToolbar) {\n          return [partMultipleToolbar];\n        } else if (hasToolbar) {\n          return [partToolbar];\n        } else {\n          return [];\n        }\n      };\n      var partHeader = OuterContainer.parts.header({\n        dom: __assign({\n          tag: 'div',\n          classes: ['tox-editor-header']\n        }, verticalDirAttributes),\n        components: flatten([\n          hasMenubar ? [partMenubar] : [],\n          getPartToolbar(),\n          useFixedContainer(editor) ? [] : [memAnchorBar.asSpec()]\n        ]),\n        sticky: isStickyToolbar(editor),\n        editor: editor,\n        sharedBackstage: backstage.shared\n      });\n      var editorComponents = flatten([\n        isToolbarBottom ? [] : [partHeader],\n        isInline ? [] : [socketSidebarContainer],\n        isToolbarBottom ? [partHeader] : []\n      ]);\n      var editorContainer = {\n        dom: {\n          tag: 'div',\n          classes: ['tox-editor-container']\n        },\n        components: editorComponents\n      };\n      var containerComponents = flatten([\n        [editorContainer],\n        isInline ? [] : statusbar.toArray(),\n        [partThrobber]\n      ]);\n      var isHidden = isDistractionFree(editor);\n      var attributes = __assign(__assign({ role: 'application' }, global$6.isRtl() ? { dir: 'rtl' } : {}), isHidden ? { 'aria-hidden': 'true' } : {});\n      var outerContainer = build$1(OuterContainer.sketch({\n        dom: {\n          tag: 'div',\n          classes: [\n            'tox',\n            'tox-tinymce'\n          ].concat(isInline ? ['tox-tinymce-inline'] : []).concat(isToolbarBottom ? ['tox-tinymce--toolbar-bottom'] : []).concat(deviceClasses).concat(platformClasses),\n          styles: __assign({ visibility: 'hidden' }, isHidden ? {\n            opacity: '0',\n            border: '0'\n          } : {}),\n          attributes: attributes\n        },\n        components: containerComponents,\n        behaviours: derive$1([\n          receivingConfig(),\n          Disabling.config({ disableClass: 'tox-tinymce--disabled' }),\n          Keying.config({\n            mode: 'cyclic',\n            selector: '.tox-menubar, .tox-toolbar, .tox-toolbar__primary, .tox-toolbar__overflow--open, .tox-sidebar__overflow--open, .tox-statusbar__path, .tox-statusbar__wordcount, .tox-statusbar__branding a, .tox-statusbar__resize-handle'\n          })\n        ])\n      }));\n      lazyOuterContainer = Optional.some(outerContainer);\n      editor.shortcuts.add('alt+F9', 'focus menubar', function () {\n        OuterContainer.focusMenubar(outerContainer);\n      });\n      editor.shortcuts.add('alt+F10', 'focus toolbar', function () {\n        OuterContainer.focusToolbar(outerContainer);\n      });\n      editor.addCommand('ToggleToolbarDrawer', function () {\n        OuterContainer.toggleToolbarDrawer(outerContainer);\n      });\n      editor.addQueryStateHandler('ToggleToolbarDrawer', function () {\n        return OuterContainer.isToolbarDrawerToggled(outerContainer);\n      });\n      var mothership = takeover(outerContainer);\n      var uiMothership = takeover(sink);\n      setup$3(editor, mothership, uiMothership);\n      var getUi = function () {\n        var channels = {\n          broadcastAll: uiMothership.broadcast,\n          broadcastOn: uiMothership.broadcastOn,\n          register: noop\n        };\n        return { channels: channels };\n      };\n      var setEditorSize = function () {\n        var parsedHeight = numToPx(getHeightWithFallback(editor));\n        var parsedWidth = numToPx(getWidthWithFallback(editor));\n        if (!editor.inline) {\n          if (isValidValue('div', 'width', parsedWidth)) {\n            set$2(outerContainer.element, 'width', parsedWidth);\n          }\n          if (isValidValue('div', 'height', parsedHeight)) {\n            set$2(outerContainer.element, 'height', parsedHeight);\n          } else {\n            set$2(outerContainer.element, 'height', '200px');\n          }\n        }\n        return parsedHeight;\n      };\n      var renderUI = function () {\n        header.setup(editor, backstage.shared, lazyHeader);\n        setup$8(editor, backstage);\n        setup$9(editor, lazySink, backstage);\n        setup$6(editor);\n        setup$7(editor, lazyThrobber, backstage.shared);\n        map$2(getToolbarGroups(editor), function (toolbarGroupButtonConfig, name) {\n          editor.ui.registry.addGroupToolbarButton(name, toolbarGroupButtonConfig);\n        });\n        var _a = editor.ui.registry.getAll(), buttons = _a.buttons, menuItems = _a.menuItems, contextToolbars = _a.contextToolbars, sidebars = _a.sidebars;\n        var toolbarOpt = getMultipleToolbarsSetting(editor);\n        var rawUiConfig = {\n          menuItems: menuItems,\n          menus: getMenus(editor),\n          menubar: getMenubar(editor),\n          toolbar: toolbarOpt.getOrThunk(function () {\n            return getToolbar(editor);\n          }),\n          allowToolbarGroups: toolbarMode === ToolbarMode.floating,\n          buttons: buttons,\n          sidebar: sidebars\n        };\n        register$4(editor, contextToolbars, sink, { backstage: backstage });\n        setup$a(editor, sink);\n        var elm = editor.getElement();\n        var height = setEditorSize();\n        var uiComponents = {\n          mothership: mothership,\n          uiMothership: uiMothership,\n          outerContainer: outerContainer\n        };\n        var args = {\n          targetNode: elm,\n          height: height\n        };\n        return mode.render(editor, uiComponents, rawUiConfig, backstage, args);\n      };\n      return {\n        mothership: mothership,\n        uiMothership: uiMothership,\n        backstage: backstage,\n        renderUI: renderUI,\n        getUi: getUi\n      };\n    };\n\n    var describedBy = function (describedElement, describeElement) {\n      var describeId = Optional.from(get$3(describedElement, 'id')).fold(function () {\n        var id = generate$1('dialog-describe');\n        set$1(describeElement, 'id', id);\n        return id;\n      }, identity);\n      set$1(describedElement, 'aria-describedby', describeId);\n    };\n\n    var labelledBy = function (labelledElement, labelElement) {\n      var labelId = getOpt(labelledElement, 'id').fold(function () {\n        var id = generate$1('dialog-label');\n        set$1(labelElement, 'id', id);\n        return id;\n      }, identity);\n      set$1(labelledElement, 'aria-labelledby', labelId);\n    };\n\n    var schema$x = constant([\n      strict$1('lazySink'),\n      option('dragBlockClass'),\n      defaultedFunction('getBounds', win),\n      defaulted$1('useTabstopAt', always),\n      defaulted$1('eventOrder', {}),\n      field$1('modalBehaviours', [Keying]),\n      onKeyboardHandler('onExecute'),\n      onStrictKeyboardHandler('onEscape')\n    ]);\n    var basic = { sketch: identity };\n    var parts$f = constant([\n      optional({\n        name: 'draghandle',\n        overrides: function (detail, spec) {\n          return {\n            behaviours: derive$1([Dragging.config({\n                mode: 'mouse',\n                getTarget: function (handle) {\n                  return ancestor$2(handle, '[role=\"dialog\"]').getOr(handle);\n                },\n                blockerClass: detail.dragBlockClass.getOrDie(new Error('The drag blocker class was not specified for a dialog with a drag handle: \\n' + JSON.stringify(spec, null, 2)).message),\n                getBounds: detail.getDragBounds\n              })])\n          };\n        }\n      }),\n      required({\n        schema: [strict$1('dom')],\n        name: 'title'\n      }),\n      required({\n        factory: basic,\n        schema: [strict$1('dom')],\n        name: 'close'\n      }),\n      required({\n        factory: basic,\n        schema: [strict$1('dom')],\n        name: 'body'\n      }),\n      optional({\n        factory: basic,\n        schema: [strict$1('dom')],\n        name: 'footer'\n      }),\n      external$1({\n        factory: {\n          sketch: function (spec, detail) {\n            return __assign(__assign({}, spec), {\n              dom: detail.dom,\n              components: detail.components\n            });\n          }\n        },\n        schema: [\n          defaulted$1('dom', {\n            tag: 'div',\n            styles: {\n              position: 'fixed',\n              left: '0px',\n              top: '0px',\n              right: '0px',\n              bottom: '0px'\n            }\n          }),\n          defaulted$1('components', [])\n        ],\n        name: 'blocker'\n      })\n    ]);\n\n    var block = function (component, config, state, getBusySpec) {\n      set$1(component.element, 'aria-busy', true);\n      var root = config.getRoot(component).getOr(component);\n      var blockerBehaviours = derive$1([\n        Keying.config({\n          mode: 'special',\n          onTab: function () {\n            return Optional.some(true);\n          },\n          onShiftTab: function () {\n            return Optional.some(true);\n          }\n        }),\n        Focusing.config({})\n      ]);\n      var blockSpec = getBusySpec(root, blockerBehaviours);\n      var blocker = root.getSystem().build(blockSpec);\n      Replacing.append(root, premade$1(blocker));\n      if (blocker.hasConfigured(Keying)) {\n        Keying.focusIn(blocker);\n      }\n      if (!state.isBlocked()) {\n        config.onBlock(component);\n      }\n      state.blockWith(function () {\n        return Replacing.remove(root, blocker);\n      });\n    };\n    var unblock = function (component, config, state) {\n      remove$1(component.element, 'aria-busy');\n      if (state.isBlocked()) {\n        config.onUnblock(component);\n      }\n      state.clear();\n    };\n\n    var BlockingApis = /*#__PURE__*/Object.freeze({\n        __proto__: null,\n        block: block,\n        unblock: unblock\n    });\n\n    var BlockingSchema = [\n      defaultedFunction('getRoot', Optional.none),\n      onHandler('onBlock'),\n      onHandler('onUnblock')\n    ];\n\n    var init$f = function () {\n      var blocker = destroyable();\n      var blockWith = function (destroy) {\n        blocker.set({ destroy: destroy });\n      };\n      return nu$5({\n        readState: blocker.isSet,\n        blockWith: blockWith,\n        clear: blocker.clear,\n        isBlocked: blocker.isSet\n      });\n    };\n\n    var BlockingState = /*#__PURE__*/Object.freeze({\n        __proto__: null,\n        init: init$f\n    });\n\n    var Blocking = create$1({\n      fields: BlockingSchema,\n      name: 'blocking',\n      apis: BlockingApis,\n      state: BlockingState\n    });\n\n    var factory$i = function (detail, components, spec, externals) {\n      var _a;\n      var dialogComp = Cell(Optional.none());\n      var showDialog = function (dialog) {\n        dialogComp.set(Optional.some(dialog));\n        var sink = detail.lazySink(dialog).getOrDie();\n        var externalBlocker = externals.blocker();\n        var blocker = sink.getSystem().build(__assign(__assign({}, externalBlocker), {\n          components: externalBlocker.components.concat([premade$1(dialog)]),\n          behaviours: derive$1([\n            Focusing.config({}),\n            config('dialog-blocker-events', [runOnSource(focusin(), function () {\n                Keying.focusIn(dialog);\n              })])\n          ])\n        }));\n        attach$1(sink, blocker);\n        Keying.focusIn(dialog);\n      };\n      var hideDialog = function (dialog) {\n        dialogComp.set(Optional.none());\n        parent(dialog.element).each(function (blockerDom) {\n          dialog.getSystem().getByDom(blockerDom).each(function (blocker) {\n            detach(blocker);\n          });\n        });\n      };\n      var getDialogBody = function (dialog) {\n        return getPartOrDie(dialog, detail, 'body');\n      };\n      var getDialogFooter = function (dialog) {\n        return getPartOrDie(dialog, detail, 'footer');\n      };\n      var setBusy = function (dialog, getBusySpec) {\n        Blocking.block(dialog, getBusySpec);\n      };\n      var setIdle = function (dialog) {\n        Blocking.unblock(dialog);\n      };\n      var modalEventsId = generate$1('modal-events');\n      var eventOrder = __assign(__assign({}, detail.eventOrder), (_a = {}, _a[attachedToDom()] = [modalEventsId].concat(detail.eventOrder['alloy.system.attached'] || []), _a));\n      return {\n        uid: detail.uid,\n        dom: detail.dom,\n        components: components,\n        apis: {\n          show: showDialog,\n          hide: hideDialog,\n          getBody: getDialogBody,\n          getFooter: getDialogFooter,\n          setIdle: setIdle,\n          setBusy: setBusy\n        },\n        eventOrder: eventOrder,\n        domModification: {\n          attributes: {\n            'role': 'dialog',\n            'aria-modal': 'true'\n          }\n        },\n        behaviours: augment(detail.modalBehaviours, [\n          Replacing.config({}),\n          Keying.config({\n            mode: 'cyclic',\n            onEnter: detail.onExecute,\n            onEscape: detail.onEscape,\n            useTabstopAt: detail.useTabstopAt\n          }),\n          Blocking.config({ getRoot: dialogComp.get }),\n          config(modalEventsId, [runOnAttached(function (c) {\n              labelledBy(c.element, getPartOrDie(c, detail, 'title').element);\n              describedBy(c.element, getPartOrDie(c, detail, 'body').element);\n            })])\n        ])\n      };\n    };\n    var ModalDialog = composite$1({\n      name: 'ModalDialog',\n      configFields: schema$x(),\n      partFields: parts$f(),\n      factory: factory$i,\n      apis: {\n        show: function (apis, dialog) {\n          apis.show(dialog);\n        },\n        hide: function (apis, dialog) {\n          apis.hide(dialog);\n        },\n        getBody: function (apis, dialog) {\n          return apis.getBody(dialog);\n        },\n        getFooter: function (apis, dialog) {\n          return apis.getFooter(dialog);\n        },\n        setBusy: function (apis, dialog, getBusySpec) {\n          apis.setBusy(dialog, getBusySpec);\n        },\n        setIdle: function (apis, dialog) {\n          apis.setIdle(dialog);\n        }\n      }\n    });\n\n    var dialogToggleMenuItemSchema = objOf([\n      strictString('type'),\n      strictString('name')\n    ].concat(commonMenuItemFields));\n    var dialogToggleMenuItemDataProcessor = boolean;\n\n    var baseFooterButtonFields = [\n      field('name', 'name', defaultedThunk(function () {\n        return generate$1('button-name');\n      }), string),\n      optionString('icon'),\n      defaultedStringEnum('align', 'end', [\n        'start',\n        'end'\n      ]),\n      defaultedBoolean('primary', false),\n      defaultedBoolean('disabled', false)\n    ];\n    var dialogFooterButtonFields = __spreadArrays(baseFooterButtonFields, [strictString('text')]);\n    var normalFooterButtonFields = __spreadArrays([strictStringEnum('type', [\n        'submit',\n        'cancel',\n        'custom'\n      ])], dialogFooterButtonFields);\n    var menuFooterButtonFields = __spreadArrays([\n      strictStringEnum('type', ['menu']),\n      optionString('text'),\n      optionString('tooltip'),\n      optionString('icon'),\n      strictArrayOf('items', dialogToggleMenuItemSchema)\n    ], baseFooterButtonFields);\n    var dialogFooterButtonSchema = choose$1('type', {\n      submit: normalFooterButtonFields,\n      cancel: normalFooterButtonFields,\n      custom: normalFooterButtonFields,\n      menu: menuFooterButtonFields\n    });\n\n    var alertBannerFields = [\n      strictString('type'),\n      strictString('text'),\n      strictStringEnum('level', [\n        'info',\n        'warn',\n        'error',\n        'success'\n      ]),\n      strictString('icon'),\n      defaulted$1('url', '')\n    ];\n    var alertBannerSchema = objOf(alertBannerFields);\n\n    var createBarFields = function (itemsField) {\n      return [\n        strictString('type'),\n        itemsField\n      ];\n    };\n\n    var buttonFields = [\n      strictString('type'),\n      strictString('text'),\n      defaultedBoolean('disabled', false),\n      defaultedBoolean('primary', false),\n      field('name', 'name', defaultedThunk(function () {\n        return generate$1('button-name');\n      }), string),\n      optionString('icon'),\n      defaultedBoolean('borderless', false)\n    ];\n    var buttonSchema = objOf(buttonFields);\n\n    var checkboxFields = [\n      strictString('type'),\n      strictString('name'),\n      strictString('label'),\n      defaultedBoolean('disabled', false)\n    ];\n    var checkboxSchema = objOf(checkboxFields);\n    var checkboxDataProcessor = boolean;\n\n    var formComponentFields = [\n      strictString('type'),\n      strictString('name')\n    ];\n    var formComponentWithLabelFields = formComponentFields.concat([optionString('label')]);\n\n    var collectionFields = formComponentWithLabelFields.concat([defaulted$1('columns', 'auto')]);\n    var collectionSchema = objOf(collectionFields);\n    var collectionDataProcessor = arrOfObj$1([\n      strictString('value'),\n      strictString('text'),\n      strictString('icon')\n    ]);\n\n    var colorInputFields = formComponentWithLabelFields;\n    var colorInputSchema = objOf(colorInputFields);\n    var colorInputDataProcessor = string;\n\n    var colorPickerFields = formComponentWithLabelFields;\n    var colorPickerSchema = objOf(colorPickerFields);\n    var colorPickerDataProcessor = string;\n\n    var customEditorFields = formComponentFields.concat([\n      defaultedString('tag', 'textarea'),\n      strictString('scriptId'),\n      strictString('scriptUrl'),\n      defaultedPostMsg('settings', undefined)\n    ]);\n    var customEditorFieldsOld = formComponentFields.concat([\n      defaultedString('tag', 'textarea'),\n      strictFunction('init')\n    ]);\n    var customEditorSchema = valueOf(function (v) {\n      return asRaw('customeditor.old', objOfOnly(customEditorFieldsOld), v).orThunk(function () {\n        return asRaw('customeditor.new', objOfOnly(customEditorFields), v);\n      });\n    });\n    var customEditorDataProcessor = string;\n\n    var dropZoneFields = formComponentWithLabelFields;\n    var dropZoneSchema = objOf(dropZoneFields);\n    var dropZoneDataProcessor = arrOfVal();\n\n    var createGridFields = function (itemsField) {\n      return [\n        strictString('type'),\n        strictNumber('columns'),\n        itemsField\n      ];\n    };\n\n    var htmlPanelFields = [\n      strictString('type'),\n      strictString('html'),\n      defaultedStringEnum('presets', 'presentation', [\n        'presentation',\n        'document'\n      ])\n    ];\n    var htmlPanelSchema = objOf(htmlPanelFields);\n\n    var iframeFields = formComponentWithLabelFields.concat([defaultedBoolean('sandboxed', true)]);\n    var iframeSchema = objOf(iframeFields);\n    var iframeDataProcessor = string;\n\n    var imageToolsFields = formComponentWithLabelFields.concat([strictOf('currentState', objOf([\n        strict$1('blob'),\n        strictString('url')\n      ]))]);\n    var imageToolsSchema = objOf(imageToolsFields);\n\n    var inputFields = formComponentWithLabelFields.concat([\n      optionString('inputMode'),\n      optionString('placeholder'),\n      defaultedBoolean('maximized', false),\n      defaultedBoolean('disabled', false)\n    ]);\n    var inputSchema = objOf(inputFields);\n    var inputDataProcessor = string;\n\n    var createLabelFields = function (itemsField) {\n      return [\n        strictString('type'),\n        strictString('label'),\n        itemsField\n      ];\n    };\n\n    var listBoxSingleItemFields = [\n      strictString('text'),\n      strictString('value')\n    ];\n    var listBoxNestedItemFields = [\n      strictString('text'),\n      strictArrayOf('items', thunkOf('items', function () {\n        return listBoxItemSchema;\n      }))\n    ];\n    var listBoxItemSchema = oneOf([\n      objOf(listBoxSingleItemFields),\n      objOf(listBoxNestedItemFields)\n    ]);\n    var listBoxFields = formComponentWithLabelFields.concat([\n      strictArrayOf('items', listBoxItemSchema),\n      defaultedBoolean('disabled', false)\n    ]);\n    var listBoxSchema = objOf(listBoxFields);\n    var listBoxDataProcessor = string;\n\n    var selectBoxFields = formComponentWithLabelFields.concat([\n      strictArrayOfObj('items', [\n        strictString('text'),\n        strictString('value')\n      ]),\n      defaultedNumber('size', 1),\n      defaultedBoolean('disabled', false)\n    ]);\n    var selectBoxSchema = objOf(selectBoxFields);\n    var selectBoxDataProcessor = string;\n\n    var sizeInputFields = formComponentWithLabelFields.concat([\n      defaultedBoolean('constrain', true),\n      defaultedBoolean('disabled', false)\n    ]);\n    var sizeInputSchema = objOf(sizeInputFields);\n    var sizeInputDataProcessor = objOf([\n      strictString('width'),\n      strictString('height')\n    ]);\n\n    var tableFields = [\n      strictString('type'),\n      strictArrayOf('header', string),\n      strictArrayOf('cells', arrOf(string))\n    ];\n    var tableSchema = objOf(tableFields);\n\n    var textAreaFields = formComponentWithLabelFields.concat([\n      optionString('placeholder'),\n      defaultedBoolean('maximized', false),\n      defaultedBoolean('disabled', false)\n    ]);\n    var textAreaSchema = objOf(textAreaFields);\n    var textAreaDataProcessor = string;\n\n    var urlInputFields = formComponentWithLabelFields.concat([\n      defaultedStringEnum('filetype', 'file', [\n        'image',\n        'media',\n        'file'\n      ]),\n      defaulted$1('disabled', false)\n    ]);\n    var urlInputSchema = objOf(urlInputFields);\n    var urlInputDataProcessor = objOf([\n      strictString('value'),\n      defaulted$1('meta', {})\n    ]);\n\n    var createItemsField = function (name) {\n      return field('items', 'items', strict(), arrOf(valueOf(function (v) {\n        return asRaw('Checking item of ' + name, itemSchema$3, v).fold(function (sErr) {\n          return Result.error(formatError(sErr));\n        }, function (passValue) {\n          return Result.value(passValue);\n        });\n      })));\n    };\n    var itemSchema$3 = valueThunkOf(function () {\n      return chooseProcessor('type', {\n        alertbanner: alertBannerSchema,\n        bar: objOf(createBarFields(createItemsField('bar'))),\n        button: buttonSchema,\n        checkbox: checkboxSchema,\n        colorinput: colorInputSchema,\n        colorpicker: colorPickerSchema,\n        dropzone: dropZoneSchema,\n        grid: objOf(createGridFields(createItemsField('grid'))),\n        iframe: iframeSchema,\n        input: inputSchema,\n        listbox: listBoxSchema,\n        selectbox: selectBoxSchema,\n        sizeinput: sizeInputSchema,\n        textarea: textAreaSchema,\n        urlinput: urlInputSchema,\n        customeditor: customEditorSchema,\n        htmlpanel: htmlPanelSchema,\n        imagetools: imageToolsSchema,\n        collection: collectionSchema,\n        label: objOf(createLabelFields(createItemsField('label'))),\n        table: tableSchema,\n        panel: panelSchema\n      });\n    });\n    var panelFields = [\n      strictString('type'),\n      defaulted$1('classes', []),\n      strictArrayOf('items', itemSchema$3)\n    ];\n    var panelSchema = objOf(panelFields);\n\n    var tabFields = [\n      field('name', 'name', defaultedThunk(function () {\n        return generate$1('tab-name');\n      }), string),\n      strictString('title'),\n      strictArrayOf('items', itemSchema$3)\n    ];\n    var tabPanelFields = [\n      strictString('type'),\n      strictArrayOfObj('tabs', tabFields)\n    ];\n    var tabPanelSchema = objOf(tabPanelFields);\n\n    var dialogButtonFields = dialogFooterButtonFields;\n    var dialogButtonSchema = dialogFooterButtonSchema;\n    var dialogSchema = objOf([\n      strictString('title'),\n      strictOf('body', chooseProcessor('type', {\n        panel: panelSchema,\n        tabpanel: tabPanelSchema\n      })),\n      defaultedString('size', 'normal'),\n      strictArrayOf('buttons', dialogButtonSchema),\n      defaulted$1('initialData', {}),\n      defaultedFunction('onAction', noop),\n      defaultedFunction('onChange', noop),\n      defaultedFunction('onSubmit', noop),\n      defaultedFunction('onClose', noop),\n      defaultedFunction('onCancel', noop),\n      defaulted$1('onTabChange', noop)\n    ]);\n    var createDialog = function (spec) {\n      return asRaw('dialog', dialogSchema, spec);\n    };\n\n    var urlDialogButtonSchema = objOf(__spreadArrays([strictStringEnum('type', [\n        'cancel',\n        'custom'\n      ])], dialogButtonFields));\n    var urlDialogSchema = objOf([\n      strictString('title'),\n      strictString('url'),\n      optionNumber('height'),\n      optionNumber('width'),\n      optionArrayOf('buttons', urlDialogButtonSchema),\n      defaultedFunction('onAction', noop),\n      defaultedFunction('onCancel', noop),\n      defaultedFunction('onClose', noop),\n      defaultedFunction('onMessage', noop)\n    ]);\n    var createUrlDialog = function (spec) {\n      return asRaw('dialog', urlDialogSchema, spec);\n    };\n\n    var getAllObjects = function (obj) {\n      if (isObject(obj)) {\n        return [obj].concat(bind(values(obj), getAllObjects));\n      } else if (isArray(obj)) {\n        return bind(obj, getAllObjects);\n      } else {\n        return [];\n      }\n    };\n\n    var isNamedItem = function (obj) {\n      return isString(obj.type) && isString(obj.name);\n    };\n    var dataProcessors = {\n      checkbox: checkboxDataProcessor,\n      colorinput: colorInputDataProcessor,\n      colorpicker: colorPickerDataProcessor,\n      dropzone: dropZoneDataProcessor,\n      input: inputDataProcessor,\n      iframe: iframeDataProcessor,\n      sizeinput: sizeInputDataProcessor,\n      selectbox: selectBoxDataProcessor,\n      listbox: listBoxDataProcessor,\n      size: sizeInputDataProcessor,\n      textarea: textAreaDataProcessor,\n      urlinput: urlInputDataProcessor,\n      customeditor: customEditorDataProcessor,\n      collection: collectionDataProcessor,\n      togglemenuitem: dialogToggleMenuItemDataProcessor\n    };\n    var getDataProcessor = function (item) {\n      return Optional.from(dataProcessors[item.type]);\n    };\n    var getNamedItems = function (structure) {\n      return filter(getAllObjects(structure), isNamedItem);\n    };\n\n    var createDataValidator = function (structure) {\n      var namedItems = getNamedItems(structure);\n      var fields = bind(namedItems, function (item) {\n        return getDataProcessor(item).fold(function () {\n          return [];\n        }, function (schema) {\n          return [strictOf(item.name, schema)];\n        });\n      });\n      return objOf(fields);\n    };\n\n    var extract$1 = function (structure) {\n      var internalDialog = getOrDie(createDialog(structure));\n      var dataValidator = createDataValidator(structure);\n      var initialData = structure.initialData;\n      return {\n        internalDialog: internalDialog,\n        dataValidator: dataValidator,\n        initialData: initialData\n      };\n    };\n    var DialogManager = {\n      open: function (factory, structure) {\n        var extraction = extract$1(structure);\n        return factory(extraction.internalDialog, extraction.initialData, extraction.dataValidator);\n      },\n      openUrl: function (factory, structure) {\n        var internalDialog = getOrDie(createUrlDialog(structure));\n        return factory(internalDialog);\n      },\n      redial: function (structure) {\n        return extract$1(structure);\n      }\n    };\n\n    var toValidValues = function (values) {\n      var errors = [];\n      var result = {};\n      each$1(values, function (value, name) {\n        value.fold(function () {\n          errors.push(name);\n        }, function (v) {\n          result[name] = v;\n        });\n      });\n      return errors.length > 0 ? Result.error(errors) : Result.value(result);\n    };\n\n    var renderBodyPanel = function (spec, backstage) {\n      var memForm = record(Form.sketch(function (parts) {\n        return {\n          dom: {\n            tag: 'div',\n            classes: ['tox-form'].concat(spec.classes)\n          },\n          components: map(spec.items, function (item) {\n            return interpretInForm(parts, item, backstage);\n          })\n        };\n      }));\n      return {\n        dom: {\n          tag: 'div',\n          classes: ['tox-dialog__body']\n        },\n        components: [{\n            dom: {\n              tag: 'div',\n              classes: ['tox-dialog__body-content']\n            },\n            components: [memForm.asSpec()]\n          }],\n        behaviours: derive$1([\n          Keying.config({\n            mode: 'acyclic',\n            useTabstopAt: not(isPseudoStop)\n          }),\n          ComposingConfigs.memento(memForm),\n          RepresentingConfigs.memento(memForm, {\n            postprocess: function (formValue) {\n              return toValidValues(formValue).fold(function (err) {\n                console.error(err);\n                return {};\n              }, function (vals) {\n                return vals;\n              });\n            }\n          })\n        ])\n      };\n    };\n\n    var factory$j = function (detail, _spec) {\n      return {\n        uid: detail.uid,\n        dom: detail.dom,\n        components: detail.components,\n        events: events$7(detail.action),\n        behaviours: augment(detail.tabButtonBehaviours, [\n          Focusing.config({}),\n          Keying.config({\n            mode: 'execution',\n            useSpace: true,\n            useEnter: true\n          }),\n          Representing.config({\n            store: {\n              mode: 'memory',\n              initialValue: detail.value\n            }\n          })\n        ]),\n        domModification: detail.domModification\n      };\n    };\n    var TabButton = single$2({\n      name: 'TabButton',\n      configFields: [\n        defaulted$1('uid', undefined),\n        strict$1('value'),\n        field('dom', 'dom', mergeWithThunk(function () {\n          return {\n            attributes: {\n              'role': 'tab',\n              'id': generate$1('aria'),\n              'aria-selected': 'false'\n            }\n          };\n        }), anyValue$1()),\n        option('action'),\n        defaulted$1('domModification', {}),\n        field$1('tabButtonBehaviours', [\n          Focusing,\n          Keying,\n          Representing\n        ]),\n        strict$1('view')\n      ],\n      factory: factory$j\n    });\n\n    var schema$y = constant([\n      strict$1('tabs'),\n      strict$1('dom'),\n      defaulted$1('clickToDismiss', false),\n      field$1('tabbarBehaviours', [\n        Highlighting,\n        Keying\n      ]),\n      markers([\n        'tabClass',\n        'selectedClass'\n      ])\n    ]);\n    var tabsPart = group({\n      factory: TabButton,\n      name: 'tabs',\n      unit: 'tab',\n      overrides: function (barDetail) {\n        var dismissTab$1 = function (tabbar, button) {\n          Highlighting.dehighlight(tabbar, button);\n          emitWith(tabbar, dismissTab(), {\n            tabbar: tabbar,\n            button: button\n          });\n        };\n        var changeTab$1 = function (tabbar, button) {\n          Highlighting.highlight(tabbar, button);\n          emitWith(tabbar, changeTab(), {\n            tabbar: tabbar,\n            button: button\n          });\n        };\n        return {\n          action: function (button) {\n            var tabbar = button.getSystem().getByUid(barDetail.uid).getOrDie();\n            var activeButton = Highlighting.isHighlighted(tabbar, button);\n            var response = function () {\n              if (activeButton && barDetail.clickToDismiss) {\n                return dismissTab$1;\n              } else if (!activeButton) {\n                return changeTab$1;\n              } else {\n                return noop;\n              }\n            }();\n            response(tabbar, button);\n          },\n          domModification: { classes: [barDetail.markers.tabClass] }\n        };\n      }\n    });\n    var parts$g = constant([tabsPart]);\n\n    var factory$k = function (detail, components, _spec, _externals) {\n      return {\n        'uid': detail.uid,\n        'dom': detail.dom,\n        components: components,\n        'debug.sketcher': 'Tabbar',\n        'domModification': { attributes: { role: 'tablist' } },\n        'behaviours': augment(detail.tabbarBehaviours, [\n          Highlighting.config({\n            highlightClass: detail.markers.selectedClass,\n            itemClass: detail.markers.tabClass,\n            onHighlight: function (tabbar, tab) {\n              set$1(tab.element, 'aria-selected', 'true');\n            },\n            onDehighlight: function (tabbar, tab) {\n              set$1(tab.element, 'aria-selected', 'false');\n            }\n          }),\n          Keying.config({\n            mode: 'flow',\n            getInitial: function (tabbar) {\n              return Highlighting.getHighlighted(tabbar).map(function (tab) {\n                return tab.element;\n              });\n            },\n            selector: '.' + detail.markers.tabClass,\n            executeOnMove: true\n          })\n        ])\n      };\n    };\n    var Tabbar = composite$1({\n      name: 'Tabbar',\n      configFields: schema$y(),\n      partFields: parts$g(),\n      factory: factory$k\n    });\n\n    var factory$l = function (detail, _spec) {\n      return {\n        uid: detail.uid,\n        dom: detail.dom,\n        behaviours: augment(detail.tabviewBehaviours, [Replacing.config({})]),\n        domModification: { attributes: { role: 'tabpanel' } }\n      };\n    };\n    var Tabview = single$2({\n      name: 'Tabview',\n      configFields: [field$1('tabviewBehaviours', [Replacing])],\n      factory: factory$l\n    });\n\n    var schema$z = constant([\n      defaulted$1('selectFirst', true),\n      onHandler('onChangeTab'),\n      onHandler('onDismissTab'),\n      defaulted$1('tabs', []),\n      field$1('tabSectionBehaviours', [])\n    ]);\n    var barPart = required({\n      factory: Tabbar,\n      schema: [\n        strict$1('dom'),\n        strictObjOf('markers', [\n          strict$1('tabClass'),\n          strict$1('selectedClass')\n        ])\n      ],\n      name: 'tabbar',\n      defaults: function (detail) {\n        return { tabs: detail.tabs };\n      }\n    });\n    var viewPart = required({\n      factory: Tabview,\n      name: 'tabview'\n    });\n    var parts$h = constant([\n      barPart,\n      viewPart\n    ]);\n\n    var factory$m = function (detail, components, _spec, _externals) {\n      var changeTab$1 = function (button) {\n        var tabValue = Representing.getValue(button);\n        getPart(button, detail, 'tabview').each(function (tabview) {\n          var tabWithValue = find(detail.tabs, function (t) {\n            return t.value === tabValue;\n          });\n          tabWithValue.each(function (tabData) {\n            var panel = tabData.view();\n            getOpt(button.element, 'id').each(function (id) {\n              set$1(tabview.element, 'aria-labelledby', id);\n            });\n            Replacing.set(tabview, panel);\n            detail.onChangeTab(tabview, button, panel);\n          });\n        });\n      };\n      var changeTabBy = function (section, byPred) {\n        getPart(section, detail, 'tabbar').each(function (tabbar) {\n          byPred(tabbar).each(emitExecute);\n        });\n      };\n      return {\n        uid: detail.uid,\n        dom: detail.dom,\n        components: components,\n        behaviours: get$d(detail.tabSectionBehaviours),\n        events: derive(flatten([\n          detail.selectFirst ? [runOnAttached(function (section, _simulatedEvent) {\n              changeTabBy(section, Highlighting.getFirst);\n            })] : [],\n          [\n            run(changeTab(), function (section, simulatedEvent) {\n              var button = simulatedEvent.event.button;\n              changeTab$1(button);\n            }),\n            run(dismissTab(), function (section, simulatedEvent) {\n              var button = simulatedEvent.event.button;\n              detail.onDismissTab(section, button);\n            })\n          ]\n        ])),\n        apis: {\n          getViewItems: function (section) {\n            return getPart(section, detail, 'tabview').map(function (tabview) {\n              return Replacing.contents(tabview);\n            }).getOr([]);\n          },\n          showTab: function (section, tabKey) {\n            var getTabIfNotActive = function (tabbar) {\n              var candidates = Highlighting.getCandidates(tabbar);\n              var optTab = find(candidates, function (c) {\n                return Representing.getValue(c) === tabKey;\n              });\n              return optTab.filter(function (tab) {\n                return !Highlighting.isHighlighted(tabbar, tab);\n              });\n            };\n            changeTabBy(section, getTabIfNotActive);\n          }\n        }\n      };\n    };\n    var TabSection = composite$1({\n      name: 'TabSection',\n      configFields: schema$z(),\n      partFields: parts$h(),\n      factory: factory$m,\n      apis: {\n        getViewItems: function (apis, component) {\n          return apis.getViewItems(component);\n        },\n        showTab: function (apis, component, tabKey) {\n          apis.showTab(component, tabKey);\n        }\n      }\n    });\n\n    var measureHeights = function (allTabs, tabview, tabviewComp) {\n      return map(allTabs, function (_tab, i) {\n        Replacing.set(tabviewComp, allTabs[i].view());\n        var rect = tabview.dom.getBoundingClientRect();\n        Replacing.set(tabviewComp, []);\n        return rect.height;\n      });\n    };\n    var getMaxHeight = function (heights) {\n      return head(sort(heights, function (a, b) {\n        if (a > b) {\n          return -1;\n        } else if (a < b) {\n          return +1;\n        } else {\n          return 0;\n        }\n      }));\n    };\n    var getMaxTabviewHeight = function (dialog, tabview, tablist) {\n      var documentElement$1 = documentElement(dialog).dom;\n      var rootElm = ancestor$2(dialog, '.tox-dialog-wrap').getOr(dialog);\n      var isFixed = get$5(rootElm, 'position') === 'fixed';\n      var maxHeight;\n      if (isFixed) {\n        maxHeight = Math.max(documentElement$1.clientHeight, window.innerHeight);\n      } else {\n        maxHeight = Math.max(documentElement$1.offsetHeight, documentElement$1.scrollHeight);\n      }\n      var tabviewHeight = get$7(tabview);\n      var isTabListBeside = tabview.dom.offsetLeft >= tablist.dom.offsetLeft + get$8(tablist);\n      var currentTabHeight = isTabListBeside ? Math.max(get$7(tablist), tabviewHeight) : tabviewHeight;\n      var dialogTopMargin = parseInt(get$5(dialog, 'margin-top'), 10) || 0;\n      var dialogBottomMargin = parseInt(get$5(dialog, 'margin-bottom'), 10) || 0;\n      var dialogHeight = get$7(dialog) + dialogTopMargin + dialogBottomMargin;\n      var chromeHeight = dialogHeight - currentTabHeight;\n      return maxHeight - chromeHeight;\n    };\n    var showTab = function (allTabs, comp) {\n      head(allTabs).each(function (tab) {\n        return TabSection.showTab(comp, tab.value);\n      });\n    };\n    var setTabviewHeight = function (tabview, height) {\n      set$2(tabview, 'height', height + 'px');\n      if (!detect$3().browser.isIE()) {\n        set$2(tabview, 'flex-basis', height + 'px');\n      } else {\n        remove$6(tabview, 'flex-basis');\n      }\n    };\n    var updateTabviewHeight = function (dialogBody, tabview, maxTabHeight) {\n      ancestor$2(dialogBody, '[role=\"dialog\"]').each(function (dialog) {\n        descendant$1(dialog, '[role=\"tablist\"]').each(function (tablist) {\n          maxTabHeight.get().map(function (height) {\n            set$2(tabview, 'height', '0');\n            set$2(tabview, 'flex-basis', '0');\n            return Math.min(height, getMaxTabviewHeight(dialog, tabview, tablist));\n          }).each(function (height) {\n            setTabviewHeight(tabview, height);\n          });\n        });\n      });\n    };\n    var getTabview = function (dialog) {\n      return descendant$1(dialog, '[role=\"tabpanel\"]');\n    };\n    var setMode = function (allTabs) {\n      var smartTabHeight = function () {\n        var maxTabHeight = Cell(Optional.none());\n        var extraEvents = [\n          runOnAttached(function (comp) {\n            var dialog = comp.element;\n            getTabview(dialog).each(function (tabview) {\n              set$2(tabview, 'visibility', 'hidden');\n              comp.getSystem().getByDom(tabview).toOptional().each(function (tabviewComp) {\n                var heights = measureHeights(allTabs, tabview, tabviewComp);\n                var maxTabHeightOpt = getMaxHeight(heights);\n                maxTabHeight.set(maxTabHeightOpt);\n              });\n              updateTabviewHeight(dialog, tabview, maxTabHeight);\n              remove$6(tabview, 'visibility');\n              showTab(allTabs, comp);\n              global$2.requestAnimationFrame(function () {\n                updateTabviewHeight(dialog, tabview, maxTabHeight);\n              });\n            });\n          }),\n          run(windowResize(), function (comp) {\n            var dialog = comp.element;\n            getTabview(dialog).each(function (tabview) {\n              updateTabviewHeight(dialog, tabview, maxTabHeight);\n            });\n          }),\n          run(formResizeEvent, function (comp, _se) {\n            var dialog = comp.element;\n            getTabview(dialog).each(function (tabview) {\n              var oldFocus = active(getRootNode(tabview));\n              set$2(tabview, 'visibility', 'hidden');\n              var oldHeight = getRaw(tabview, 'height').map(function (h) {\n                return parseInt(h, 10);\n              });\n              remove$6(tabview, 'height');\n              remove$6(tabview, 'flex-basis');\n              var newHeight = tabview.dom.getBoundingClientRect().height;\n              var hasGrown = oldHeight.forall(function (h) {\n                return newHeight > h;\n              });\n              if (hasGrown) {\n                maxTabHeight.set(Optional.from(newHeight));\n                updateTabviewHeight(dialog, tabview, maxTabHeight);\n              } else {\n                oldHeight.each(function (h) {\n                  setTabviewHeight(tabview, h);\n                });\n              }\n              remove$6(tabview, 'visibility');\n              oldFocus.each(focus$1);\n            });\n          })\n        ];\n        var selectFirst = false;\n        return {\n          extraEvents: extraEvents,\n          selectFirst: selectFirst\n        };\n      }();\n      var naiveTabHeight = function () {\n        var extraEvents = [];\n        var selectFirst = true;\n        return {\n          extraEvents: extraEvents,\n          selectFirst: selectFirst\n        };\n      }();\n      return {\n        smartTabHeight: smartTabHeight,\n        naiveTabHeight: naiveTabHeight\n      };\n    };\n\n    var SendDataToSectionChannel = 'send-data-to-section';\n    var SendDataToViewChannel = 'send-data-to-view';\n    var renderTabPanel = function (spec, backstage) {\n      var storedValue = Cell({});\n      var updateDataWithForm = function (form) {\n        var formData = Representing.getValue(form);\n        var validData = toValidValues(formData).getOr({});\n        var currentData = storedValue.get();\n        var newData = deepMerge(currentData, validData);\n        storedValue.set(newData);\n      };\n      var setDataOnForm = function (form) {\n        var tabData = storedValue.get();\n        Representing.setValue(form, tabData);\n      };\n      var oldTab = Cell(null);\n      var allTabs = map(spec.tabs, function (tab) {\n        return {\n          value: tab.name,\n          dom: {\n            tag: 'div',\n            classes: ['tox-dialog__body-nav-item'],\n            innerHtml: backstage.shared.providers.translate(tab.title)\n          },\n          view: function () {\n            return [Form.sketch(function (parts) {\n                return {\n                  dom: {\n                    tag: 'div',\n                    classes: ['tox-form']\n                  },\n                  components: map(tab.items, function (item) {\n                    return interpretInForm(parts, item, backstage);\n                  }),\n                  formBehaviours: derive$1([\n                    Keying.config({\n                      mode: 'acyclic',\n                      useTabstopAt: not(isPseudoStop)\n                    }),\n                    config('TabView.form.events', [\n                      runOnAttached(setDataOnForm),\n                      runOnDetached(updateDataWithForm)\n                    ]),\n                    Receiving.config({\n                      channels: wrapAll$1([\n                        {\n                          key: SendDataToSectionChannel,\n                          value: { onReceive: updateDataWithForm }\n                        },\n                        {\n                          key: SendDataToViewChannel,\n                          value: { onReceive: setDataOnForm }\n                        }\n                      ])\n                    })\n                  ])\n                };\n              })];\n          }\n        };\n      });\n      var tabMode = setMode(allTabs).smartTabHeight;\n      return TabSection.sketch({\n        dom: {\n          tag: 'div',\n          classes: ['tox-dialog__body']\n        },\n        onChangeTab: function (section, button, _viewItems) {\n          var name = Representing.getValue(button);\n          emitWith(section, formTabChangeEvent, {\n            name: name,\n            oldName: oldTab.get()\n          });\n          oldTab.set(name);\n        },\n        tabs: allTabs,\n        components: [\n          TabSection.parts.tabbar({\n            dom: {\n              tag: 'div',\n              classes: ['tox-dialog__body-nav']\n            },\n            components: [Tabbar.parts.tabs({})],\n            markers: {\n              tabClass: 'tox-tab',\n              selectedClass: 'tox-dialog__body-nav-item--active'\n            },\n            tabbarBehaviours: derive$1([Tabstopping.config({})])\n          }),\n          TabSection.parts.tabview({\n            dom: {\n              tag: 'div',\n              classes: ['tox-dialog__body-content']\n            }\n          })\n        ],\n        selectFirst: tabMode.selectFirst,\n        tabSectionBehaviours: derive$1([\n          config('tabpanel', tabMode.extraEvents),\n          Keying.config({ mode: 'acyclic' }),\n          Composing.config({\n            find: function (comp) {\n              return head(TabSection.getViewItems(comp));\n            }\n          }),\n          Representing.config({\n            store: {\n              mode: 'manual',\n              getValue: function (tsection) {\n                tsection.getSystem().broadcastOn([SendDataToSectionChannel], {});\n                return storedValue.get();\n              },\n              setValue: function (tsection, value) {\n                storedValue.set(value);\n                tsection.getSystem().broadcastOn([SendDataToViewChannel], {});\n              }\n            }\n          })\n        ])\n      });\n    };\n\n    var dialogChannel = generate$1('update-dialog');\n    var titleChannel = generate$1('update-title');\n    var bodyChannel = generate$1('update-body');\n    var footerChannel = generate$1('update-footer');\n    var bodySendMessageChannel = generate$1('body-send-message');\n\n    var renderBody = function (spec, id, backstage, ariaAttrs) {\n      var renderComponents = function (incoming) {\n        switch (incoming.body.type) {\n        case 'tabpanel': {\n            return [renderTabPanel(incoming.body, backstage)];\n          }\n        default: {\n            return [renderBodyPanel(incoming.body, backstage)];\n          }\n        }\n      };\n      var updateState = function (_comp, incoming) {\n        return Optional.some({\n          isTabPanel: function () {\n            return incoming.body.type === 'tabpanel';\n          }\n        });\n      };\n      var ariaAttributes = { 'aria-live': 'polite' };\n      return {\n        dom: {\n          tag: 'div',\n          classes: ['tox-dialog__content-js'],\n          attributes: __assign(__assign({}, id.map(function (x) {\n            return { id: x };\n          }).getOr({})), ariaAttrs ? ariaAttributes : {})\n        },\n        components: [],\n        behaviours: derive$1([\n          ComposingConfigs.childAt(0),\n          Reflecting.config({\n            channel: bodyChannel,\n            updateState: updateState,\n            renderComponents: renderComponents,\n            initialData: spec\n          })\n        ])\n      };\n    };\n    var renderInlineBody = function (spec, contentId, backstage, ariaAttrs) {\n      return renderBody(spec, Optional.some(contentId), backstage, ariaAttrs);\n    };\n    var renderModalBody = function (spec, backstage) {\n      var bodySpec = renderBody(spec, Optional.none(), backstage, false);\n      return ModalDialog.parts.body(bodySpec);\n    };\n    var renderIframeBody = function (spec) {\n      var bodySpec = {\n        dom: {\n          tag: 'div',\n          classes: ['tox-dialog__content-js']\n        },\n        components: [{\n            dom: {\n              tag: 'div',\n              classes: ['tox-dialog__body-iframe']\n            },\n            components: [craft({\n                dom: {\n                  tag: 'iframe',\n                  attributes: { src: spec.url }\n                },\n                behaviours: derive$1([\n                  Tabstopping.config({}),\n                  Focusing.config({})\n                ])\n              })]\n          }],\n        behaviours: derive$1([Keying.config({\n            mode: 'acyclic',\n            useTabstopAt: not(isPseudoStop)\n          })])\n      };\n      return ModalDialog.parts.body(bodySpec);\n    };\n\n    var isTouch = global$8.deviceType.isTouch();\n    var hiddenHeader = function (title, close) {\n      return {\n        dom: {\n          tag: 'div',\n          styles: { display: 'none' },\n          classes: ['tox-dialog__header']\n        },\n        components: [\n          title,\n          close\n        ]\n      };\n    };\n    var pClose = function (onClose, providersBackstage) {\n      return ModalDialog.parts.close(Button.sketch({\n        dom: {\n          tag: 'button',\n          classes: [\n            'tox-button',\n            'tox-button--icon',\n            'tox-button--naked'\n          ],\n          attributes: {\n            'type': 'button',\n            'aria-label': providersBackstage.translate('Close')\n          }\n        },\n        action: onClose,\n        buttonBehaviours: derive$1([Tabstopping.config({})])\n      }));\n    };\n    var pUntitled = function () {\n      return ModalDialog.parts.title({\n        dom: {\n          tag: 'div',\n          classes: ['tox-dialog__title'],\n          innerHtml: '',\n          styles: { display: 'none' }\n        }\n      });\n    };\n    var pBodyMessage = function (message, providersBackstage) {\n      return ModalDialog.parts.body({\n        dom: {\n          tag: 'div',\n          classes: ['tox-dialog__body']\n        },\n        components: [{\n            dom: {\n              tag: 'div',\n              classes: ['tox-dialog__body-content']\n            },\n            components: [{ dom: fromHtml$2('<p>' + providersBackstage.translate(message) + '</p>') }]\n          }]\n      });\n    };\n    var pFooter = function (buttons) {\n      return ModalDialog.parts.footer({\n        dom: {\n          tag: 'div',\n          classes: ['tox-dialog__footer']\n        },\n        components: buttons\n      });\n    };\n    var pFooterGroup = function (startButtons, endButtons) {\n      return [\n        Container.sketch({\n          dom: {\n            tag: 'div',\n            classes: ['tox-dialog__footer-start']\n          },\n          components: startButtons\n        }),\n        Container.sketch({\n          dom: {\n            tag: 'div',\n            classes: ['tox-dialog__footer-end']\n          },\n          components: endButtons\n        })\n      ];\n    };\n    var renderDialog = function (spec) {\n      var _a;\n      var dialogClass = 'tox-dialog';\n      var blockerClass = dialogClass + '-wrap';\n      var blockerBackdropClass = blockerClass + '__backdrop';\n      var scrollLockClass = dialogClass + '__disable-scroll';\n      return ModalDialog.sketch({\n        lazySink: spec.lazySink,\n        onEscape: function (comp) {\n          spec.onEscape(comp);\n          return Optional.some(true);\n        },\n        useTabstopAt: function (elem) {\n          return !isPseudoStop(elem);\n        },\n        dom: {\n          tag: 'div',\n          classes: [dialogClass].concat(spec.extraClasses),\n          styles: __assign({ position: 'relative' }, spec.extraStyles)\n        },\n        components: __spreadArrays([\n          spec.header,\n          spec.body\n        ], spec.footer.toArray()),\n        parts: {\n          blocker: {\n            dom: fromHtml$2('<div class=\"' + blockerClass + '\"></div>'),\n            components: [{\n                dom: {\n                  tag: 'div',\n                  classes: isTouch ? [\n                    blockerBackdropClass,\n                    blockerBackdropClass + '--opaque'\n                  ] : [blockerBackdropClass]\n                }\n              }]\n          }\n        },\n        dragBlockClass: blockerClass,\n        modalBehaviours: derive$1(__spreadArrays([\n          Focusing.config({}),\n          config('dialog-events', spec.dialogEvents.concat([runOnSource(focusin(), function (comp, _se) {\n              Keying.focusIn(comp);\n            })])),\n          config('scroll-lock', [\n            runOnAttached(function () {\n              add$2(body(), scrollLockClass);\n            }),\n            runOnDetached(function () {\n              remove$4(body(), scrollLockClass);\n            })\n          ])\n        ], spec.extraBehaviours)),\n        eventOrder: __assign((_a = {}, _a[execute()] = ['dialog-events'], _a[attachedToDom()] = [\n          'scroll-lock',\n          'dialog-events',\n          'alloy.base.behaviour'\n        ], _a[detachedFromDom()] = [\n          'alloy.base.behaviour',\n          'dialog-events',\n          'scroll-lock'\n        ], _a), spec.eventOrder)\n      });\n    };\n\n    var renderClose = function (providersBackstage) {\n      return Button.sketch({\n        dom: {\n          tag: 'button',\n          classes: [\n            'tox-button',\n            'tox-button--icon',\n            'tox-button--naked'\n          ],\n          attributes: {\n            'type': 'button',\n            'aria-label': providersBackstage.translate('Close'),\n            'title': providersBackstage.translate('Close')\n          }\n        },\n        components: [{\n            dom: {\n              tag: 'div',\n              classes: ['tox-icon'],\n              innerHtml: get$e('close', providersBackstage.icons)\n            }\n          }],\n        action: function (comp) {\n          emit(comp, formCancelEvent);\n        }\n      });\n    };\n    var renderTitle = function (spec, id, providersBackstage) {\n      var renderComponents = function (data) {\n        return [text(providersBackstage.translate(data.title))];\n      };\n      return {\n        dom: {\n          tag: 'div',\n          classes: ['tox-dialog__title'],\n          attributes: __assign({}, id.map(function (x) {\n            return { id: x };\n          }).getOr({}))\n        },\n        components: renderComponents(spec),\n        behaviours: derive$1([Reflecting.config({\n            channel: titleChannel,\n            renderComponents: renderComponents\n          })])\n      };\n    };\n    var renderDragHandle = function () {\n      return { dom: fromHtml$2('<div class=\"tox-dialog__draghandle\"></div>') };\n    };\n    var renderInlineHeader = function (spec, titleId, providersBackstage) {\n      return Container.sketch({\n        dom: fromHtml$2('<div class=\"tox-dialog__header\"></div>'),\n        components: [\n          renderTitle(spec, Optional.some(titleId), providersBackstage),\n          renderDragHandle(),\n          renderClose(providersBackstage)\n        ],\n        containerBehaviours: derive$1([Dragging.config({\n            mode: 'mouse',\n            blockerClass: 'blocker',\n            getTarget: function (handle) {\n              return closest$3(handle, '[role=\"dialog\"]').getOrDie();\n            },\n            snaps: {\n              getSnapPoints: function () {\n                return [];\n              },\n              leftAttr: 'data-drag-left',\n              topAttr: 'data-drag-top'\n            }\n          })])\n      });\n    };\n    var renderModalHeader = function (spec, providersBackstage) {\n      var pTitle = ModalDialog.parts.title(renderTitle(spec, Optional.none(), providersBackstage));\n      var pHandle = ModalDialog.parts.draghandle(renderDragHandle());\n      var pClose = ModalDialog.parts.close(renderClose(providersBackstage));\n      var components = [pTitle].concat(spec.draggable ? [pHandle] : []).concat([pClose]);\n      return Container.sketch({\n        dom: fromHtml$2('<div class=\"tox-dialog__header\"></div>'),\n        components: components\n      });\n    };\n\n    var getHeader = function (title, backstage) {\n      return renderModalHeader({\n        title: backstage.shared.providers.translate(title),\n        draggable: backstage.dialog.isDraggableModal()\n      }, backstage.shared.providers);\n    };\n    var getBusySpec = function (message, bs, providers) {\n      return {\n        dom: {\n          tag: 'div',\n          classes: ['tox-dialog__busy-spinner'],\n          attributes: { 'aria-label': providers.translate(message) },\n          styles: {\n            left: '0px',\n            right: '0px',\n            bottom: '0px',\n            top: '0px',\n            position: 'absolute'\n          }\n        },\n        behaviours: bs,\n        components: [{ dom: fromHtml$2('<div class=\"tox-spinner\"><div></div><div></div><div></div></div>') }]\n      };\n    };\n    var getEventExtras = function (lazyDialog, providers, extra) {\n      return {\n        onClose: function () {\n          return extra.closeWindow();\n        },\n        onBlock: function (blockEvent) {\n          ModalDialog.setBusy(lazyDialog(), function (_comp, bs) {\n            return getBusySpec(blockEvent.message, bs, providers);\n          });\n        },\n        onUnblock: function () {\n          ModalDialog.setIdle(lazyDialog());\n        }\n      };\n    };\n    var renderModalDialog = function (spec, initialData, dialogEvents, backstage) {\n      var _a;\n      var updateState = function (_comp, incoming) {\n        return Optional.some(incoming);\n      };\n      return build$1(renderDialog(__assign(__assign({}, spec), {\n        lazySink: backstage.shared.getSink,\n        extraBehaviours: __spreadArrays([\n          Reflecting.config({\n            channel: dialogChannel,\n            updateState: updateState,\n            initialData: initialData\n          }),\n          RepresentingConfigs.memory({})\n        ], spec.extraBehaviours),\n        onEscape: function (comp) {\n          emit(comp, formCancelEvent);\n        },\n        dialogEvents: dialogEvents,\n        eventOrder: (_a = {}, _a[receive()] = [\n          Reflecting.name(),\n          Receiving.name()\n        ], _a[attachedToDom()] = [\n          'scroll-lock',\n          Reflecting.name(),\n          'messages',\n          'dialog-events',\n          'alloy.base.behaviour'\n        ], _a[detachedFromDom()] = [\n          'alloy.base.behaviour',\n          'dialog-events',\n          'messages',\n          Reflecting.name(),\n          'scroll-lock'\n        ], _a)\n      })));\n    };\n    var mapMenuButtons = function (buttons) {\n      var mapItems = function (button) {\n        var items = map(button.items, function (item) {\n          var cell = Cell(false);\n          return __assign(__assign({}, item), { storage: cell });\n        });\n        return __assign(__assign({}, button), { items: items });\n      };\n      return map(buttons, function (button) {\n        if (button.type === 'menu') {\n          return mapItems(button);\n        }\n        return button;\n      });\n    };\n    var extractCellsToObject = function (buttons) {\n      return foldl(buttons, function (acc, button) {\n        if (button.type === 'menu') {\n          var menuButton = button;\n          return foldl(menuButton.items, function (innerAcc, item) {\n            innerAcc[item.name] = item.storage;\n            return innerAcc;\n          }, acc);\n        }\n        return acc;\n      }, {});\n    };\n\n    var initCommonEvents = function (fireApiEvent, extras) {\n      return [\n        runWithTarget(focusin(), onFocus$1),\n        fireApiEvent(formCloseEvent, function (_api, spec) {\n          extras.onClose();\n          spec.onClose();\n        }),\n        fireApiEvent(formCancelEvent, function (api, spec, _event, self) {\n          spec.onCancel(api);\n          emit(self, formCloseEvent);\n        }),\n        run(formUnblockEvent, function (_c, _se) {\n          return extras.onUnblock();\n        }),\n        run(formBlockEvent, function (_c, se) {\n          return extras.onBlock(se.event);\n        })\n      ];\n    };\n    var initUrlDialog = function (getInstanceApi, extras) {\n      var fireApiEvent = function (eventName, f) {\n        return run(eventName, function (c, se) {\n          withSpec(c, function (spec, _c) {\n            f(getInstanceApi(), spec, se.event, c);\n          });\n        });\n      };\n      var withSpec = function (c, f) {\n        Reflecting.getState(c).get().each(function (currentDialog) {\n          f(currentDialog, c);\n        });\n      };\n      return __spreadArrays(initCommonEvents(fireApiEvent, extras), [fireApiEvent(formActionEvent, function (api, spec, event) {\n          spec.onAction(api, { name: event.name });\n        })]);\n    };\n    var initDialog = function (getInstanceApi, extras, getSink) {\n      var fireApiEvent = function (eventName, f) {\n        return run(eventName, function (c, se) {\n          withSpec(c, function (spec, _c) {\n            f(getInstanceApi(), spec, se.event, c);\n          });\n        });\n      };\n      var withSpec = function (c, f) {\n        Reflecting.getState(c).get().each(function (currentDialogInit) {\n          f(currentDialogInit.internalDialog, c);\n        });\n      };\n      return __spreadArrays(initCommonEvents(fireApiEvent, extras), [\n        fireApiEvent(formSubmitEvent, function (api, spec) {\n          return spec.onSubmit(api);\n        }),\n        fireApiEvent(formChangeEvent, function (api, spec, event) {\n          spec.onChange(api, { name: event.name });\n        }),\n        fireApiEvent(formActionEvent, function (api, spec, event, component) {\n          var focusIn = function () {\n            return Keying.focusIn(component);\n          };\n          var isDisabled = function (focused) {\n            return has$1(focused, 'disabled') || getOpt(focused, 'aria-disabled').exists(function (val) {\n              return val === 'true';\n            });\n          };\n          var rootNode = getRootNode(component.element);\n          var current = active(rootNode);\n          spec.onAction(api, {\n            name: event.name,\n            value: event.value\n          });\n          active(rootNode).fold(focusIn, function (focused) {\n            if (isDisabled(focused)) {\n              focusIn();\n            } else if (current.exists(function (cur) {\n                return contains$2(focused, cur) && isDisabled(cur);\n              })) {\n              focusIn();\n            } else {\n              getSink().toOptional().filter(function (sink) {\n                return !contains$2(sink.element, focused);\n              }).each(focusIn);\n            }\n          });\n        }),\n        fireApiEvent(formTabChangeEvent, function (api, spec, event) {\n          spec.onTabChange(api, {\n            newTabName: event.name,\n            oldTabName: event.oldName\n          });\n        }),\n        runOnDetached(function (component) {\n          var api = getInstanceApi();\n          Representing.setValue(component, api.getData());\n        })\n      ]);\n    };\n    var SilverDialogEvents = {\n      initUrlDialog: initUrlDialog,\n      initDialog: initDialog\n    };\n\n    var makeButton = function (button, backstage) {\n      return renderFooterButton(button, button.type, backstage);\n    };\n    var lookup$2 = function (compInSystem, footerButtons, buttonName) {\n      return find(footerButtons, function (button) {\n        return button.name === buttonName;\n      }).bind(function (memButton) {\n        return memButton.memento.getOpt(compInSystem);\n      });\n    };\n    var renderComponents = function (_data, state) {\n      var footerButtons = state.map(function (s) {\n        return s.footerButtons;\n      }).getOr([]);\n      var buttonGroups = partition(footerButtons, function (button) {\n        return button.align === 'start';\n      });\n      var makeGroup = function (edge, buttons) {\n        return Container.sketch({\n          dom: {\n            tag: 'div',\n            classes: ['tox-dialog__footer-' + edge]\n          },\n          components: map(buttons, function (button) {\n            return button.memento.asSpec();\n          })\n        });\n      };\n      var startButtons = makeGroup('start', buttonGroups.pass);\n      var endButtons = makeGroup('end', buttonGroups.fail);\n      return [\n        startButtons,\n        endButtons\n      ];\n    };\n    var renderFooter = function (initSpec, backstage) {\n      var updateState = function (_comp, data) {\n        var footerButtons = map(data.buttons, function (button) {\n          var memButton = record(makeButton(button, backstage));\n          return {\n            name: button.name,\n            align: button.align,\n            memento: memButton\n          };\n        });\n        var lookupByName = function (compInSystem, buttonName) {\n          return lookup$2(compInSystem, footerButtons, buttonName);\n        };\n        return Optional.some({\n          lookupByName: lookupByName,\n          footerButtons: footerButtons\n        });\n      };\n      return {\n        dom: fromHtml$2('<div class=\"tox-dialog__footer\"></div>'),\n        components: [],\n        behaviours: derive$1([Reflecting.config({\n            channel: footerChannel,\n            initialData: initSpec,\n            updateState: updateState,\n            renderComponents: renderComponents\n          })])\n      };\n    };\n    var renderInlineFooter = function (initSpec, backstage) {\n      return renderFooter(initSpec, backstage);\n    };\n    var renderModalFooter = function (initSpec, backstage) {\n      return ModalDialog.parts.footer(renderFooter(initSpec, backstage));\n    };\n\n    var getCompByName = function (access, name) {\n      var root = access.getRoot();\n      if (root.getSystem().isConnected()) {\n        var form_1 = Composing.getCurrent(access.getFormWrapper()).getOr(access.getFormWrapper());\n        return Form.getField(form_1, name).fold(function () {\n          var footer = access.getFooter();\n          var footerState = Reflecting.getState(footer);\n          return footerState.get().bind(function (f) {\n            return f.lookupByName(form_1, name);\n          });\n        }, function (comp) {\n          return Optional.some(comp);\n        });\n      } else {\n        return Optional.none();\n      }\n    };\n    var validateData = function (access, data) {\n      var root = access.getRoot();\n      return Reflecting.getState(root).get().map(function (dialogState) {\n        return getOrDie(asRaw('data', dialogState.dataValidator, data));\n      }).getOr(data);\n    };\n    var getDialogApi = function (access, doRedial, menuItemStates) {\n      var withRoot = function (f) {\n        var root = access.getRoot();\n        if (root.getSystem().isConnected()) {\n          f(root);\n        }\n      };\n      var getData = function () {\n        var root = access.getRoot();\n        var valueComp = root.getSystem().isConnected() ? access.getFormWrapper() : root;\n        var representedValues = Representing.getValue(valueComp);\n        var menuItemCurrentState = map$2(menuItemStates, function (cell) {\n          return cell.get();\n        });\n        return __assign(__assign({}, representedValues), menuItemCurrentState);\n      };\n      var setData = function (newData) {\n        withRoot(function (_) {\n          var prevData = instanceApi.getData();\n          var mergedData = __assign(__assign({}, prevData), newData);\n          var newInternalData = validateData(access, mergedData);\n          var form = access.getFormWrapper();\n          Representing.setValue(form, newInternalData);\n          each$1(menuItemStates, function (v, k) {\n            if (has(mergedData, k)) {\n              v.set(mergedData[k]);\n            }\n          });\n        });\n      };\n      var disable = function (name) {\n        getCompByName(access, name).each(Disabling.disable);\n      };\n      var enable = function (name) {\n        getCompByName(access, name).each(Disabling.enable);\n      };\n      var focus = function (name) {\n        getCompByName(access, name).each(Focusing.focus);\n      };\n      var block = function (message) {\n        if (!isString(message)) {\n          throw new Error('The dialogInstanceAPI.block function should be passed a blocking message of type string as an argument');\n        }\n        withRoot(function (root) {\n          emitWith(root, formBlockEvent, { message: message });\n        });\n      };\n      var unblock = function () {\n        withRoot(function (root) {\n          emit(root, formUnblockEvent);\n        });\n      };\n      var showTab = function (name) {\n        withRoot(function (_) {\n          var body = access.getBody();\n          var bodyState = Reflecting.getState(body);\n          if (bodyState.get().exists(function (b) {\n              return b.isTabPanel();\n            })) {\n            Composing.getCurrent(body).each(function (tabSection) {\n              TabSection.showTab(tabSection, name);\n            });\n          }\n        });\n      };\n      var redial = function (d) {\n        withRoot(function (root) {\n          var dialogInit = doRedial(d);\n          root.getSystem().broadcastOn([dialogChannel], dialogInit);\n          root.getSystem().broadcastOn([titleChannel], dialogInit.internalDialog);\n          root.getSystem().broadcastOn([bodyChannel], dialogInit.internalDialog);\n          root.getSystem().broadcastOn([footerChannel], dialogInit.internalDialog);\n          instanceApi.setData(dialogInit.initialData);\n        });\n      };\n      var close = function () {\n        withRoot(function (root) {\n          emit(root, formCloseEvent);\n        });\n      };\n      var instanceApi = {\n        getData: getData,\n        setData: setData,\n        disable: disable,\n        enable: enable,\n        focus: focus,\n        block: block,\n        unblock: unblock,\n        showTab: showTab,\n        redial: redial,\n        close: close\n      };\n      return instanceApi;\n    };\n\n    var getDialogSizeClasses = function (size) {\n      switch (size) {\n      case 'large':\n        return ['tox-dialog--width-lg'];\n      case 'medium':\n        return ['tox-dialog--width-md'];\n      default:\n        return [];\n      }\n    };\n    var renderDialog$1 = function (dialogInit, extra, backstage) {\n      var header = getHeader(dialogInit.internalDialog.title, backstage);\n      var body = renderModalBody({ body: dialogInit.internalDialog.body }, backstage);\n      var storagedMenuButtons = mapMenuButtons(dialogInit.internalDialog.buttons);\n      var objOfCells = extractCellsToObject(storagedMenuButtons);\n      var footer = renderModalFooter({ buttons: storagedMenuButtons }, backstage);\n      var dialogEvents = SilverDialogEvents.initDialog(function () {\n        return instanceApi;\n      }, getEventExtras(function () {\n        return dialog;\n      }, backstage.shared.providers, extra), backstage.shared.getSink);\n      var dialogSize = getDialogSizeClasses(dialogInit.internalDialog.size);\n      var spec = {\n        header: header,\n        body: body,\n        footer: Optional.some(footer),\n        extraClasses: dialogSize,\n        extraBehaviours: [],\n        extraStyles: {}\n      };\n      var dialog = renderModalDialog(spec, dialogInit, dialogEvents, backstage);\n      var modalAccess = function () {\n        var getForm = function () {\n          var outerForm = ModalDialog.getBody(dialog);\n          return Composing.getCurrent(outerForm).getOr(outerForm);\n        };\n        return {\n          getRoot: function () {\n            return dialog;\n          },\n          getBody: function () {\n            return ModalDialog.getBody(dialog);\n          },\n          getFooter: function () {\n            return ModalDialog.getFooter(dialog);\n          },\n          getFormWrapper: getForm\n        };\n      }();\n      var instanceApi = getDialogApi(modalAccess, extra.redial, objOfCells);\n      return {\n        dialog: dialog,\n        instanceApi: instanceApi\n      };\n    };\n\n    var renderInlineDialog = function (dialogInit, extra, backstage, ariaAttrs) {\n      var _a, _b;\n      var dialogLabelId = generate$1('dialog-label');\n      var dialogContentId = generate$1('dialog-content');\n      var updateState = function (_comp, incoming) {\n        return Optional.some(incoming);\n      };\n      var memHeader = record(renderInlineHeader({\n        title: dialogInit.internalDialog.title,\n        draggable: true\n      }, dialogLabelId, backstage.shared.providers));\n      var memBody = record(renderInlineBody({ body: dialogInit.internalDialog.body }, dialogContentId, backstage, ariaAttrs));\n      var storagedMenuButtons = mapMenuButtons(dialogInit.internalDialog.buttons);\n      var objOfCells = extractCellsToObject(storagedMenuButtons);\n      var memFooter = record(renderInlineFooter({ buttons: storagedMenuButtons }, backstage));\n      var dialogEvents = SilverDialogEvents.initDialog(function () {\n        return instanceApi;\n      }, {\n        onBlock: function (event) {\n          Blocking.block(dialog, function (_comp, bs) {\n            return getBusySpec(event.message, bs, backstage.shared.providers);\n          });\n        },\n        onUnblock: function () {\n          Blocking.unblock(dialog);\n        },\n        onClose: function () {\n          return extra.closeWindow();\n        }\n      }, backstage.shared.getSink);\n      var dialog = build$1({\n        dom: {\n          tag: 'div',\n          classes: [\n            'tox-dialog',\n            'tox-dialog-inline'\n          ],\n          attributes: (_a = { role: 'dialog' }, _a['aria-labelledby'] = dialogLabelId, _a['aria-describedby'] = '' + dialogContentId, _a)\n        },\n        eventOrder: (_b = {}, _b[receive()] = [\n          Reflecting.name(),\n          Receiving.name()\n        ], _b[execute()] = ['execute-on-form'], _b[attachedToDom()] = [\n          'reflecting',\n          'execute-on-form'\n        ], _b),\n        behaviours: derive$1([\n          Keying.config({\n            mode: 'cyclic',\n            onEscape: function (c) {\n              emit(c, formCloseEvent);\n              return Optional.some(true);\n            },\n            useTabstopAt: function (elem) {\n              return !isPseudoStop(elem) && (name(elem) !== 'button' || get$3(elem, 'disabled') !== 'disabled');\n            }\n          }),\n          Reflecting.config({\n            channel: dialogChannel,\n            updateState: updateState,\n            initialData: dialogInit\n          }),\n          Focusing.config({}),\n          config('execute-on-form', dialogEvents.concat([runOnSource(focusin(), function (comp, _se) {\n              Keying.focusIn(comp);\n            })])),\n          Blocking.config({\n            getRoot: function () {\n              return Optional.some(dialog);\n            }\n          }),\n          Replacing.config({}),\n          RepresentingConfigs.memory({})\n        ]),\n        components: [\n          memHeader.asSpec(),\n          memBody.asSpec(),\n          memFooter.asSpec()\n        ]\n      });\n      var instanceApi = getDialogApi({\n        getRoot: function () {\n          return dialog;\n        },\n        getFooter: function () {\n          return memFooter.get(dialog);\n        },\n        getBody: function () {\n          return memBody.get(dialog);\n        },\n        getFormWrapper: function () {\n          var body = memBody.get(dialog);\n          return Composing.getCurrent(body).getOr(body);\n        }\n      }, extra.redial, objOfCells);\n      return {\n        dialog: dialog,\n        instanceApi: instanceApi\n      };\n    };\n\n    var global$h = tinymce.util.Tools.resolve('tinymce.util.URI');\n\n    var getUrlDialogApi = function (root) {\n      var withRoot = function (f) {\n        if (root.getSystem().isConnected()) {\n          f(root);\n        }\n      };\n      var block = function (message) {\n        if (!isString(message)) {\n          throw new Error('The urlDialogInstanceAPI.block function should be passed a blocking message of type string as an argument');\n        }\n        withRoot(function (root) {\n          emitWith(root, formBlockEvent, { message: message });\n        });\n      };\n      var unblock = function () {\n        withRoot(function (root) {\n          emit(root, formUnblockEvent);\n        });\n      };\n      var close = function () {\n        withRoot(function (root) {\n          emit(root, formCloseEvent);\n        });\n      };\n      var sendMessage = function (data) {\n        withRoot(function (root) {\n          root.getSystem().broadcastOn([bodySendMessageChannel], data);\n        });\n      };\n      return {\n        block: block,\n        unblock: unblock,\n        close: close,\n        sendMessage: sendMessage\n      };\n    };\n\n    var SUPPORTED_MESSAGE_ACTIONS = [\n      'insertContent',\n      'setContent',\n      'execCommand',\n      'close',\n      'block',\n      'unblock'\n    ];\n    var isSupportedMessage = function (data) {\n      return isObject(data) && SUPPORTED_MESSAGE_ACTIONS.indexOf(data.mceAction) !== -1;\n    };\n    var isCustomMessage = function (data) {\n      return !isSupportedMessage(data) && isObject(data) && has(data, 'mceAction');\n    };\n    var handleMessage = function (editor, api, data) {\n      switch (data.mceAction) {\n      case 'insertContent':\n        editor.insertContent(data.content);\n        break;\n      case 'setContent':\n        editor.setContent(data.content);\n        break;\n      case 'execCommand':\n        var ui = isBoolean(data.ui) ? data.ui : false;\n        editor.execCommand(data.cmd, ui, data.value);\n        break;\n      case 'close':\n        api.close();\n        break;\n      case 'block':\n        api.block(data.message);\n        break;\n      case 'unblock':\n        api.unblock();\n        break;\n      }\n    };\n    var renderUrlDialog = function (internalDialog, extra, editor, backstage) {\n      var _a;\n      var header = getHeader(internalDialog.title, backstage);\n      var body = renderIframeBody(internalDialog);\n      var footer = internalDialog.buttons.bind(function (buttons) {\n        if (buttons.length === 0) {\n          return Optional.none();\n        } else {\n          return Optional.some(renderModalFooter({ buttons: buttons }, backstage));\n        }\n      });\n      var dialogEvents = SilverDialogEvents.initUrlDialog(function () {\n        return instanceApi;\n      }, getEventExtras(function () {\n        return dialog;\n      }, backstage.shared.providers, extra));\n      var styles = __assign(__assign({}, internalDialog.height.fold(function () {\n        return {};\n      }, function (height) {\n        return {\n          'height': height + 'px',\n          'max-height': height + 'px'\n        };\n      })), internalDialog.width.fold(function () {\n        return {};\n      }, function (width) {\n        return {\n          'width': width + 'px',\n          'max-width': width + 'px'\n        };\n      }));\n      var classes = internalDialog.width.isNone() && internalDialog.height.isNone() ? ['tox-dialog--width-lg'] : [];\n      var iframeUri = new global$h(internalDialog.url, { base_uri: new global$h(window.location.href) });\n      var iframeDomain = iframeUri.protocol + '://' + iframeUri.host + (iframeUri.port ? ':' + iframeUri.port : '');\n      var messageHandlerUnbinder = Cell(Optional.none());\n      var extraBehaviours = [\n        config('messages', [\n          runOnAttached(function () {\n            var unbind = bind$3(SugarElement.fromDom(window), 'message', function (e) {\n              if (iframeUri.isSameOrigin(new global$h(e.raw.origin))) {\n                var data = e.raw.data;\n                if (isSupportedMessage(data)) {\n                  handleMessage(editor, instanceApi, data);\n                } else if (isCustomMessage(data)) {\n                  internalDialog.onMessage(instanceApi, data);\n                }\n              }\n            });\n            messageHandlerUnbinder.set(Optional.some(unbind));\n          }),\n          runOnDetached(function () {\n            messageHandlerUnbinder.get().each(function (unbinder) {\n              return unbinder.unbind();\n            });\n          })\n        ]),\n        Receiving.config({\n          channels: (_a = {}, _a[bodySendMessageChannel] = {\n            onReceive: function (comp, data) {\n              descendant$1(comp.element, 'iframe').each(function (iframeEle) {\n                var iframeWin = iframeEle.dom.contentWindow;\n                iframeWin.postMessage(data, iframeDomain);\n              });\n            }\n          }, _a)\n        })\n      ];\n      var spec = {\n        header: header,\n        body: body,\n        footer: footer,\n        extraClasses: classes,\n        extraBehaviours: extraBehaviours,\n        extraStyles: styles\n      };\n      var dialog = renderModalDialog(spec, internalDialog, dialogEvents, backstage);\n      var instanceApi = getUrlDialogApi(dialog);\n      return {\n        dialog: dialog,\n        instanceApi: instanceApi\n      };\n    };\n\n    var setup$c = function (extras) {\n      var sharedBackstage = extras.backstage.shared;\n      var open = function (message, callback) {\n        var closeDialog = function () {\n          ModalDialog.hide(alertDialog);\n          callback();\n        };\n        var memFooterClose = record(renderFooterButton({\n          name: 'close-alert',\n          text: 'OK',\n          primary: true,\n          align: 'end',\n          disabled: false,\n          icon: Optional.none()\n        }, 'cancel', extras.backstage));\n        var titleSpec = pUntitled();\n        var closeSpec = pClose(closeDialog, sharedBackstage.providers);\n        var alertDialog = build$1(renderDialog({\n          lazySink: function () {\n            return sharedBackstage.getSink();\n          },\n          header: hiddenHeader(titleSpec, closeSpec),\n          body: pBodyMessage(message, sharedBackstage.providers),\n          footer: Optional.some(pFooter(pFooterGroup([], [memFooterClose.asSpec()]))),\n          onEscape: closeDialog,\n          extraClasses: ['tox-alert-dialog'],\n          extraBehaviours: [],\n          extraStyles: {},\n          dialogEvents: [run(formCancelEvent, closeDialog)],\n          eventOrder: {}\n        }));\n        ModalDialog.show(alertDialog);\n        var footerCloseButton = memFooterClose.get(alertDialog);\n        Focusing.focus(footerCloseButton);\n      };\n      return { open: open };\n    };\n\n    var setup$d = function (extras) {\n      var sharedBackstage = extras.backstage.shared;\n      var open = function (message, callback) {\n        var closeDialog = function (state) {\n          ModalDialog.hide(confirmDialog);\n          callback(state);\n        };\n        var memFooterYes = record(renderFooterButton({\n          name: 'yes',\n          text: 'Yes',\n          primary: true,\n          align: 'end',\n          disabled: false,\n          icon: Optional.none()\n        }, 'submit', extras.backstage));\n        var footerNo = renderFooterButton({\n          name: 'no',\n          text: 'No',\n          primary: false,\n          align: 'end',\n          disabled: false,\n          icon: Optional.none()\n        }, 'cancel', extras.backstage);\n        var titleSpec = pUntitled();\n        var closeSpec = pClose(function () {\n          return closeDialog(false);\n        }, sharedBackstage.providers);\n        var confirmDialog = build$1(renderDialog({\n          lazySink: function () {\n            return sharedBackstage.getSink();\n          },\n          header: hiddenHeader(titleSpec, closeSpec),\n          body: pBodyMessage(message, sharedBackstage.providers),\n          footer: Optional.some(pFooter(pFooterGroup([], [\n            footerNo,\n            memFooterYes.asSpec()\n          ]))),\n          onEscape: function () {\n            return closeDialog(false);\n          },\n          extraClasses: ['tox-confirm-dialog'],\n          extraBehaviours: [],\n          extraStyles: {},\n          dialogEvents: [\n            run(formCancelEvent, function () {\n              return closeDialog(false);\n            }),\n            run(formSubmitEvent, function () {\n              return closeDialog(true);\n            })\n          ],\n          eventOrder: {}\n        }));\n        ModalDialog.show(confirmDialog);\n        var footerYesButton = memFooterYes.get(confirmDialog);\n        Focusing.focus(footerYesButton);\n      };\n      return { open: open };\n    };\n\n    var validateData$1 = function (data, validator) {\n      return getOrDie(asRaw('data', validator, data));\n    };\n    var isAlertOrConfirmDialog = function (target) {\n      return closest$4(target, '.tox-alert-dialog') || closest$4(target, '.tox-confirm-dialog');\n    };\n    var inlineAdditionalBehaviours = function (editor, isStickyToolbar, isToolbarLocationTop) {\n      if (isStickyToolbar && isToolbarLocationTop) {\n        return [];\n      } else {\n        return [Docking.config({\n            contextual: {\n              lazyContext: function () {\n                return Optional.some(box(SugarElement.fromDom(editor.getContentAreaContainer())));\n              },\n              fadeInClass: 'tox-dialog-dock-fadein',\n              fadeOutClass: 'tox-dialog-dock-fadeout',\n              transitionClass: 'tox-dialog-dock-transition'\n            },\n            modes: ['top']\n          })];\n      }\n    };\n    var setup$e = function (extras) {\n      var backstage = extras.backstage;\n      var editor = extras.editor;\n      var isStickyToolbar$1 = isStickyToolbar(editor);\n      var alertDialog = setup$c(extras);\n      var confirmDialog = setup$d(extras);\n      var open = function (config, params, closeWindow) {\n        if (params !== undefined && params.inline === 'toolbar') {\n          return openInlineDialog(config, backstage.shared.anchors.inlineDialog(), closeWindow, params.ariaAttrs);\n        } else if (params !== undefined && params.inline === 'cursor') {\n          return openInlineDialog(config, backstage.shared.anchors.cursor(), closeWindow, params.ariaAttrs);\n        } else {\n          return openModalDialog(config, closeWindow);\n        }\n      };\n      var openUrl = function (config, closeWindow) {\n        return openModalUrlDialog(config, closeWindow);\n      };\n      var openModalUrlDialog = function (config, closeWindow) {\n        var factory = function (contents) {\n          var dialog = renderUrlDialog(contents, {\n            closeWindow: function () {\n              ModalDialog.hide(dialog.dialog);\n              closeWindow(dialog.instanceApi);\n            }\n          }, editor, backstage);\n          ModalDialog.show(dialog.dialog);\n          return dialog.instanceApi;\n        };\n        return DialogManager.openUrl(factory, config);\n      };\n      var openModalDialog = function (config, closeWindow) {\n        var factory = function (contents, internalInitialData, dataValidator) {\n          var initialData = internalInitialData;\n          var dialogInit = {\n            dataValidator: dataValidator,\n            initialData: initialData,\n            internalDialog: contents\n          };\n          var dialog = renderDialog$1(dialogInit, {\n            redial: DialogManager.redial,\n            closeWindow: function () {\n              ModalDialog.hide(dialog.dialog);\n              closeWindow(dialog.instanceApi);\n            }\n          }, backstage);\n          ModalDialog.show(dialog.dialog);\n          dialog.instanceApi.setData(initialData);\n          return dialog.instanceApi;\n        };\n        return DialogManager.open(factory, config);\n      };\n      var openInlineDialog = function (config$1, anchor, closeWindow, ariaAttrs) {\n        var factory = function (contents, internalInitialData, dataValidator) {\n          var initialData = validateData$1(internalInitialData, dataValidator);\n          var inlineDialog = value$3();\n          var isToolbarLocationTop = backstage.shared.header.isPositionedAtTop();\n          var dialogInit = {\n            dataValidator: dataValidator,\n            initialData: initialData,\n            internalDialog: contents\n          };\n          var refreshDocking = function () {\n            return inlineDialog.on(function (dialog) {\n              InlineView.reposition(dialog);\n              Docking.refresh(dialog);\n            });\n          };\n          var dialogUi = renderInlineDialog(dialogInit, {\n            redial: DialogManager.redial,\n            closeWindow: function () {\n              inlineDialog.on(InlineView.hide);\n              editor.off('ResizeEditor', refreshDocking);\n              inlineDialog.clear();\n              closeWindow(dialogUi.instanceApi);\n            }\n          }, backstage, ariaAttrs);\n          var inlineDialogComp = build$1(InlineView.sketch(__assign(__assign({\n            lazySink: backstage.shared.getSink,\n            dom: {\n              tag: 'div',\n              classes: []\n            },\n            fireDismissalEventInstead: {}\n          }, isToolbarLocationTop ? {} : { fireRepositionEventInstead: {} }), {\n            inlineBehaviours: derive$1(__spreadArrays([config('window-manager-inline-events', [run(dismissRequested(), function (_comp, _se) {\n                  emit(dialogUi.dialog, formCancelEvent);\n                })])], inlineAdditionalBehaviours(editor, isStickyToolbar$1, isToolbarLocationTop))),\n            isExtraPart: function (_comp, target) {\n              return isAlertOrConfirmDialog(target);\n            }\n          })));\n          inlineDialog.set(inlineDialogComp);\n          InlineView.showWithin(inlineDialogComp, anchor, premade$1(dialogUi.dialog), Optional.some(body()));\n          if (!isStickyToolbar$1 || !isToolbarLocationTop) {\n            Docking.refresh(inlineDialogComp);\n            editor.on('ResizeEditor', refreshDocking);\n          }\n          dialogUi.instanceApi.setData(initialData);\n          Keying.focusIn(dialogUi.dialog);\n          return dialogUi.instanceApi;\n        };\n        return DialogManager.open(factory, config$1);\n      };\n      var confirm = function (message, callback) {\n        confirmDialog.open(message, function (state) {\n          callback(state);\n        });\n      };\n      var alert = function (message, callback) {\n        alertDialog.open(message, function () {\n          callback();\n        });\n      };\n      var close = function (instanceApi) {\n        instanceApi.close();\n      };\n      return {\n        open: open,\n        openUrl: openUrl,\n        alert: alert,\n        close: close,\n        confirm: confirm\n      };\n    };\n\n    function Theme () {\n      global$1.add('silver', function (editor) {\n        var _a = setup$b(editor), uiMothership = _a.uiMothership, backstage = _a.backstage, renderUI = _a.renderUI, getUi = _a.getUi;\n        Autocompleter.register(editor, backstage.shared);\n        var windowMgr = setup$e({\n          editor: editor,\n          backstage: backstage\n        });\n        return {\n          renderUI: renderUI,\n          getWindowManagerImpl: constant(windowMgr),\n          getNotificationManagerImpl: function () {\n            return NotificationManagerImpl(editor, { backstage: backstage }, uiMothership);\n          },\n          ui: getUi()\n        };\n      });\n    }\n\n    Theme();\n\n}());\n"]},"metadata":{},"sourceType":"script"}